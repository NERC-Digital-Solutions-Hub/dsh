const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/D2R8NS53.js","../chunks/CBds6lNF.js","../chunks/waHvktcX.js","../chunks/hffy0Rzx.js","../chunks/BJzXsikh.js","../chunks/PPVm8Dsz.js","../chunks/CzZNEXbc.js","../chunks/PYsgr6Cv.js","../chunks/CXWgbL7n.js","../chunks/BK_j0vCJ.js","../chunks/BtvBu1eD.js","../chunks/C6w_XvRs.js","../chunks/CSc29kAG.js","../chunks/31lkbN3K.js","../chunks/Cm-vM7rO.js","../chunks/BLADGlsv.js","../chunks/Bu5rTcQm.js","../chunks/DAO_oeHl.js","../chunks/BCOEBfat.js","../chunks/DUv5Dx4o.js","../chunks/CwloaeUQ.js","../chunks/D6wORzA5.js","../chunks/D6KPPgz5.js","../chunks/B5AOUoSS.js","../chunks/SroC6Bde.js","../chunks/BAFEnjrE.js","../chunks/Cl5lrJ4c.js","../chunks/Ws9fzjq4.js","../chunks/MtSiOt06.js","../chunks/C0wm8_Yw.js","../chunks/DjDSr30s.js","../chunks/BFqSaRmx.js","../chunks/Bl2MZOXM.js","../chunks/Cf-tPqwv.js","../chunks/Djp3mnm5.js","../chunks/sZon5vxQ.js","../chunks/DQOJ18NT.js","../chunks/FH_B4Icp.js","../chunks/B4vD1BGx.js","../chunks/BdbjiLX5.js","../chunks/7w27tvP3.js","../chunks/i7Vcu2FR.js","../chunks/EzLf78vY.js","../chunks/DVFGfKmI.js","../chunks/j4iyJSzk.js","../chunks/DmgVh9QE.js","../chunks/CyiwMQYc.js","../chunks/BQDMsGT7.js","../chunks/DNJQAMPv.js","../chunks/DZd6gJy7.js","../chunks/DWl14dtb.js","../chunks/C8BmVxiO.js","../chunks/BKffokcL.js","../chunks/DCHVU35a.js","../chunks/Brd_Ewaw.js","../chunks/D7uDWCVN.js","../chunks/e987Hnua.js","../chunks/Csib0GOI.js","../chunks/9YvG7tFv.js","../chunks/2YxIXFDc.js","../chunks/BPgNQXYv.js","../chunks/aQeO9QTD.js","../chunks/DzeofJVl.js","../chunks/CB6g2oAF.js","../chunks/ZQfxN_Vg.js","../chunks/BQoOJzxz.js","../chunks/B9S5MMOh.js","../chunks/C8QJtdR6.js","../chunks/D-hDIZ0E.js","../chunks/BBku-UyD.js","../chunks/CKpFtwNl.js","../chunks/DQxgXym9.js","../chunks/Chk7YAAL.js","../chunks/C4eyRFHZ.js","../chunks/Cgb6qxNH.js","../chunks/DpDKDQMu.js","../chunks/BvLLmmHM.js","../chunks/QQC62dOK.js","../chunks/CHxOJSSo.js","../chunks/D5lt-24V.js","../chunks/0ZOWt6Zk.js","../chunks/DWdn-gc2.js","../chunks/DKpmsPfl.js","../chunks/CaVKkSa6.js","../chunks/Blc53ifB.js","../chunks/BCJJJeSu.js","../chunks/B1N-tmtC.js","../chunks/CASyCajO.js","../chunks/BiphejqT.js","../chunks/CFVhRMoI.js","../chunks/pDuGEAnG.js","../chunks/BxoBi4Vr.js","../chunks/BrScpkSj.js","../chunks/rxpTDz6e.js","../chunks/DwW2UUp6.js","../chunks/BCEvhry1.js","../chunks/C0D_VUqv.js","../chunks/CL2NbQte.js","../chunks/E_1-hsoR.js","../chunks/DvXX8WIZ.js","../chunks/CMalCdhA.js","../chunks/Gr_8PAej.js","../chunks/C5CzMsLd.js","../chunks/BWvgoYxN.js","../chunks/BUO7EZ2F.js","../chunks/LLNOmjKF.js","../chunks/D9iY8ysW.js","../chunks/DfVx0eoU.js","../chunks/Dzyladvh.js","../chunks/Dhrc7yKo.js","../chunks/CT9P9gRy.js","../chunks/BnwZMyBt.js","../chunks/Bw1Xc39c.js","../chunks/ClT5rdFr.js","../chunks/CekyKNrS.js","../chunks/6ixYhqY9.js","../chunks/GKolV7NZ.js","../chunks/BGUToqAW.js","../chunks/ghO7NOkz.js","../chunks/BEjhG6Sy.js","../chunks/DlxexayN.js","../chunks/CFVJohAM.js","../chunks/14dRiZGb.js","../chunks/DVzHbREE.js","../chunks/Bd3_ZfdX.js","../chunks/DRttsIKn.js","../chunks/VMSlSy0z.js","../chunks/Bs5fg73K.js","../chunks/BKAg0lpL.js","../chunks/Ch0BYLJI.js","../chunks/Ct0Nj1xZ.js","../chunks/BfZw7KJz.js","../chunks/B6mzu30i.js","../chunks/ByeNFe0R.js","../chunks/C7QU6z39.js","../chunks/D8r07A2E.js","../chunks/kVHjtxxS.js","../chunks/BCeqIfCJ.js","../chunks/Q8s0ONkO.js","../chunks/DCeYhTVW.js","../chunks/C-smYul6.js","../chunks/CGoHglTy.js","../chunks/DnIh3bbk.js","../chunks/mJy9NcTm.js","../chunks/JIOXkdc4.js","../chunks/B9tr4TTr.js","../chunks/tYXWvceD.js","../chunks/B7YVx5oT.js","../chunks/KcazVFlU.js","../chunks/CYsUaMUi.js","../chunks/DZfQUPTe.js","../chunks/CmLACV7b.js","../chunks/BTMtU5rF.js","../chunks/CSfkM0wj.js","../chunks/l6udcEZM.js","../chunks/eOHKmrdd.js","../chunks/BgtvC5K-.js","../chunks/BqMYqny5.js","../chunks/DCdj6Lab.js","../chunks/BXfupK_G.js","../chunks/BkQcsSCB.js","../chunks/DPb6J-GU.js","../chunks/BRoOABDY.js","../chunks/CEGcqm_w.js","../chunks/ECjZiOqE.js","../chunks/DTBfAEhl.js","../chunks/DdZhAKYH.js","../chunks/CBRKO9Cc.js","../chunks/B9tTPdJp.js","../chunks/DmqXrNbN.js","../chunks/CzUeZMxz.js","../chunks/MU2HK4QQ.js","../chunks/DbxqHIPK.js","../chunks/lskWu88S.js","../chunks/D9YC7l4A.js","../chunks/Bk3ngthF.js","../chunks/C6Du7acc.js","../chunks/X0qAyRpB.js","../chunks/DsHDw-MJ.js"])))=>i.map(i=>d[i]);
import{p as ro,c as le,a as F,f as se,t as Cn}from"../chunks/Cp6gagLc.js";import{o as kn,a as ya}from"../chunks/BEugbry3.js";import{C as io,E as ao,b8 as oo,b9 as so,L as lo,t as uo,ba as co,bb as fo,bc as ho,Z as ba,am as vo,N as po,a as Qe,ay as ge,x as u,ab as z,p as Re,f as $,b as He,c as Q,r as U,aw as ie,ag as Je,u as ot,B as ut,a4 as fe,n as dn}from"../chunks/CGuDK3cH.js";import{p as Ee,i as me,r as Dt,l as Pn,s as It}from"../chunks/CYzw9kj_.js";import{c as De}from"../chunks/BQask9zx.js";import{b as Mt}from"../chunks/CGMUYGDS.js";import{b as go,s as Ot}from"../chunks/CGgxIKi_.js";import{a as Ar,e as In,s as mi,d as en,b as mo}from"../chunks/C52hcmTJ.js";import{I as Tn,n as En,d as Or,c as Pr,S as wa,s as yo,X as bo,e as wo,f as _o,g as So,h as xo,i as Co,j as ko,C as Io,k as Ao}from"../chunks/CjpR7xtx.js";import{C as Oo,D as Po,l as To,o as Eo,z as Fo,b as gr,B as Do,p as jt,$ as Lo,a0 as Mo,c as No}from"../chunks/VT3kn57n.js";import{t as fn,k as Ro,l as Ho,m as jo,n as zo,L as Ko,o as Vo,h as Bo,i as qo,S as xn,C as Xi,j as $o,I as Uo,G as Zi,F as ea,b as Go,O as _a,a as Wo,d as Sa,c as mr,p as Yo,r as Jo,M as Qo,V as ta,f as Xo,e as Zo,g as es,s as ts,q as ns}from"../chunks/DuXThK92.js";import{s as $e,I as Fn,a as zt,i as An}from"../chunks/Cl7Mgxd0.js";import{g as rs,d as Tr}from"../chunks/CU0SCnmu.js";import{c as Er,B as At}from"../chunks/CGsbJcZG.js";import{I as is,C as as}from"../chunks/B2RY59w3.js";import"../chunks/C6a1hWam.js";import{b as os}from"../chunks/FDOliuoY.js";import"../chunks/fuL_5N5w.js";import ss from"../chunks/Gr_8PAej.js";import{j as ls}from"../chunks/DwW2UUp6.js";import us from"../chunks/Bu5rTcQm.js";import{s as na}from"../chunks/waHvktcX.js";import{O as cs}from"../chunks/PYsgr6Cv.js";import{h as qn}from"../chunks/yDTRCkMh.js";import{_ as yr}from"../chunks/PPVm8Dsz.js";import"../chunks/Dhrc7yKo.js";import{j as ra}from"../chunks/B7YVx5oT.js";import{m as ia}from"../chunks/Dzyladvh.js";import{a as aa,m as oa}from"../chunks/BPgNQXYv.js";import{l as br}from"../chunks/CwloaeUQ.js";import{C as ds}from"../chunks/C7OPQEgL.js";const fs=()=>performance.now(),$t={tick:x=>requestAnimationFrame(x),now:()=>fs(),tasks:new Set};function xa(){const x=$t.now();$t.tasks.forEach(n=>{n.c(x)||($t.tasks.delete(n),n.f())}),$t.tasks.size!==0&&$t.tick(xa)}function hs(x){let n;return $t.tasks.size===0&&$t.tick(xa),{promise:new Promise(o=>{$t.tasks.add(n={c:x,f:o})}),abort(){$t.tasks.delete(n)}}}function wr(x,n){ba(()=>{x.dispatchEvent(new CustomEvent(n))})}function vs(x){if(x==="float")return"cssFloat";if(x==="offset")return"cssOffset";if(x.startsWith("--"))return x;const n=x.split("-");return n.length===1?n[0]:n[0]+n.slice(1).map(o=>o[0].toUpperCase()+o.slice(1)).join("")}function sa(x){const n={},o=x.split(";");for(const s of o){const[c,h]=s.split(":");if(!c||h===void 0)break;const d=vs(c.trim());n[d]=h.trim()}return n}const ps=x=>x;function kr(x,n,o,s){var c=(x&fo)!==0,h=(x&ho)!==0,d=c&&h,m=(x&co)!==0,T=d?"both":c?"in":"out",k,A=n.inert,D=n.style.overflow,E,G;function N(){return ba(()=>k??=o()(n,s?.()??{},{direction:T}))}var M={is_global:m,in(){if(n.inert=A,!c){G?.abort(),G?.reset?.();return}h||E?.abort(),wr(n,"introstart"),E=ci(n,N(),G,1,()=>{wr(n,"introend"),E?.abort(),E=k=void 0,n.style.overflow=D})},out(V){if(!h){V?.(),k=void 0;return}n.inert=!0,wr(n,"outrostart"),G=ci(n,N(),E,0,()=>{wr(n,"outroend"),V?.()})},stop:()=>{E?.abort(),G?.abort()}},H=io;if((H.transitions??=[]).push(M),c&&go){var j=m;if(!j){for(var B=H.parent;B&&(B.f&ao)!==0;)for(;(B=B.parent)&&(B.f&oo)===0;);j=!B||(B.f&so)!==0}j&&lo(()=>{uo(()=>M.in())})}}function ci(x,n,o,s,c){var h=s===1;if(vo(n)){var d,m=!1;return po(()=>{if(!m){var H=n({direction:h?"in":"out"});d=ci(x,H,o,s,c)}}),{abort:()=>{m=!0,d?.abort()},deactivate:()=>d.deactivate(),reset:()=>d.reset(),t:()=>d.t()}}if(o?.deactivate(),!n?.duration)return c(),{abort:Qe,deactivate:Qe,reset:Qe,t:()=>s};const{delay:T=0,css:k,tick:A,easing:D=ps}=n;var E=[];if(h&&o===void 0&&(A&&A(0,1),k)){var G=sa(k(0,1));E.push(G,G)}var N=()=>1-s,M=x.animate(E,{duration:T,fill:"forwards"});return M.onfinish=()=>{M.cancel();var H=o?.t()??1-s;o?.abort();var j=s-H,B=n.duration*Math.abs(j),V=[];if(B>0){var Y=!1;if(k)for(var ve=Math.ceil(B/16.666666666666668),te=0;te<=ve;te+=1){var ce=H+j*D(te/ve),_e=sa(k(ce,1-ce));V.push(_e),Y||=_e.overflow==="hidden"}Y&&(x.style.overflow="hidden"),N=()=>{var Ae=M.currentTime;return H+j*D(Ae/B)},A&&hs(()=>{if(M.playState!=="running")return!1;var Ae=N();return A(Ae,1-Ae),!0})}M=x.animate(V,{duration:B,fill:"forwards"}),M.onfinish=()=>{N=()=>s,A?.(s,1-s),c()}},{abort:()=>{M&&(M.cancel(),M.effect=null,M.onfinish=Qe)},deactivate:()=>{c=Qe},reset:()=>{s===0&&A?.(1,0)},t:()=>N()}}const gs=Eo({component:"avatar",parts:["root","image","fallback"]}),ms=new Oo("Avatar.Root");class yi{static create(n){return ms.set(new yi(n))}opts;domContext;attachment;constructor(n){this.opts=n,this.domContext=new Po(this.opts.ref),this.loadImage=this.loadImage.bind(this),this.attachment=To(this.opts.ref)}loadImage(n,o,s){if(this.opts.loadingStatus.current==="loaded")return;let c;const h=new Image;return h.src=n,o!==void 0&&(h.crossOrigin=o),s&&(h.referrerPolicy=s),this.opts.loadingStatus.current="loading",h.onload=()=>{c=this.domContext.setTimeout(()=>{this.opts.loadingStatus.current="loaded"},this.opts.delayMs.current)},h.onerror=()=>{this.opts.loadingStatus.current="error"},()=>{c&&this.domContext.clearTimeout(c)}}#e=ge(()=>({id:this.opts.id.current,[gs.root]:"","data-status":this.opts.loadingStatus.current,...this.attachment}));get props(){return u(this.#e)}set props(n){z(this.#e,n)}}var ys=se("<div><!></div>");function bs(x,n){const o=ro();Re(n,!0);let s=Ee(n,"delayMs",3,0),c=Ee(n,"loadingStatus",15,"loading"),h=Ee(n,"id",19,()=>Fo(o)),d=Ee(n,"ref",15,null),m=Dt(n,["$$slots","$$events","$$legacy","delayMs","loadingStatus","onLoadingStatusChange","child","children","id","ref"]);const T=yi.create({delayMs:gr(()=>s()),loadingStatus:gr(()=>c(),N=>{c()!==N&&(c(N),n.onLoadingStatusChange?.(N))}),id:gr(()=>h()),ref:gr(()=>d(),N=>d(N))}),k=ge(()=>Do(m,T.props));var A=le(),D=$(A);{var E=N=>{var M=le(),H=$(M);$e(H,()=>n.child,()=>({props:u(k)})),F(N,M)},G=N=>{var M=ys();Ar(M,()=>({...u(k)}));var H=Q(M);$e(H,()=>n.children??Qe),U(M),F(N,M)};me(D,N=>{n.child?N(E):N(G,!1)})}F(x,A),He()}function ws(x,n){const o=Pn(n,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"m6 9 6 6 6-6"}]];Tn(x,It({name:"chevron-down"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=le(),m=$(d);En(m,n,"default",{}),F(c,d)},$$slots:{default:!0}}))}function _s(x,n){const o=Pn(n,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"m15 18-6-6 6-6"}]];Tn(x,It({name:"chevron-left"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=le(),m=$(d);En(m,n,"default",{}),F(c,d)},$$slots:{default:!0}}))}function Ss(x,n){const o=Pn(n,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"m18 15-6-6-6 6"}]];Tn(x,It({name:"chevron-up"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=le(),m=$(d);En(m,n,"default",{}),F(c,d)},$$slots:{default:!0}}))}function xs(x,n){const o=Pn(n,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"M12 15V3"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}],["path",{d:"m7 10 5 5 5-5"}]];Tn(x,It({name:"download"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=le(),m=$(d);En(m,n,"default",{}),F(c,d)},$$slots:{default:!0}}))}function Cs(x,n){const o=Pn(n,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"M4 5h16"}],["path",{d:"M4 12h16"}],["path",{d:"M4 19h16"}]];Tn(x,It({name:"menu"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=le(),m=$(d);En(m,n,"default",{}),F(c,d)},$$slots:{default:!0}}))}function ks(x,n){const o=Pn(n,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}],["path",{d:"M3 6h18"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}]];Tn(x,It({name:"trash"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=le(),m=$(d);En(m,n,"default",{}),F(c,d)},$$slots:{default:!0}}))}function Is(x,n){Re(n,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let o=Dt(n,["$$slots","$$events","$$legacy"]);const s=[["path",{d:"M12 17V3"}],["path",{d:"m6 11 6 6 6-6"}],["path",{d:"M19 21H5"}]];Fn(x,It({name:"arrow-down-to-line"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=le(),m=$(d);$e(m,()=>n.children??Qe),F(c,d)},$$slots:{default:!0}})),He()}function As(x,n){Re(n,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let o=Dt(n,["$$slots","$$events","$$legacy"]);const s=[["path",{d:"M12 5v14"}],["path",{d:"m19 12-7 7-7-7"}]];Fn(x,It({name:"arrow-down"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=le(),m=$(d);$e(m,()=>n.children??Qe),F(c,d)},$$slots:{default:!0}})),He()}function Os(x,n){Re(n,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let o=Dt(n,["$$slots","$$events","$$legacy"]);const s=[["path",{d:"m18 15-6-6-6 6"}]];Fn(x,It({name:"chevron-up"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=le(),m=$(d);$e(m,()=>n.children??Qe),F(c,d)},$$slots:{default:!0}})),He()}function Ps(x,n){Re(n,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let o=Dt(n,["$$slots","$$events","$$legacy"]);const s=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3"}]];Fn(x,It({name:"maximize"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=le(),m=$(d);$e(m,()=>n.children??Qe),F(c,d)},$$slots:{default:!0}})),He()}function Ts(x,n){Re(n,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let o=Dt(n,["$$slots","$$events","$$legacy"]);const s=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3"}]];Fn(x,It({name:"minimize"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=le(),m=$(d);$e(m,()=>n.children??Qe),F(c,d)},$$slots:{default:!0}})),He()}function Es(x,n){Re(n,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let o=Dt(n,["$$slots","$$events","$$legacy"]);const s=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"}],["path",{d:"m21.854 2.147-10.94 10.939"}]];Fn(x,It({name:"send"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=le(),m=$(d);$e(m,()=>n.children??Qe),F(c,d)},$$slots:{default:!0}})),He()}class Fs{#e=ie(Je({featureLayerView:null,areaInfos:[]}));get layerHighlightState(){return u(this.#e)}set layerHighlightState(n){z(this.#e,n,!0)}#t=ie(null);get lastAddedArea(){return u(this.#t)}set lastAddedArea(n){z(this.#t,n,!0)}#r=ie(null);get lastRemovedArea(){return u(this.#r)}set lastRemovedArea(n){z(this.#r,n,!0)}#i=ie(null);get currentHoveredArea(){return u(this.#i)}set currentHoveredArea(n){z(this.#i,n,!0)}#n=[];#a=new jt;setFieldInfo(n){console.log("Setting field info:",n),this.#n=n}setSelectedLayerView(n){this.layerHighlightState?.featureLayerView!==n&&(this.layerHighlightState&&this.layerHighlightState.areaInfos.forEach(o=>{o.handle.remove()}),this.layerHighlightState={featureLayerView:n,areaInfos:[]})}clearSelectedLayerView(){this.layerHighlightState.featureLayerView!==null&&(this.resetSelectedAreas(),this.layerHighlightState.featureLayerView=null)}resetSelectedAreas(){!this.layerHighlightState.featureLayerView&&this.layerHighlightState.areaInfos.length===0||(this.layerHighlightState&&this.layerHighlightState.areaInfos.forEach(n=>{n.handle.remove()}),this.layerHighlightState={featureLayerView:null,areaInfos:[]})}addSelectedArea(n,o){if(!this.layerHighlightState){console.warn("SelectedAreasStore: No feature layer view is set.");return}const s={id:n,handle:o};this.layerHighlightState.areaInfos.push(s),this.lastAddedArea=s}removeSelectedArea(n){if(!this.layerHighlightState){console.warn("SelectedAreasStore: No feature layer view is set.");return}const o=this.layerHighlightState.areaInfos.findIndex(s=>s.id===n);o!==-1&&(this.lastRemovedArea={id:n,handle:this.layerHighlightState.areaInfos[o].handle},this.layerHighlightState.areaInfos[o].handle.remove(),this.layerHighlightState.areaInfos.splice(o,1))}async getAreaNamesById(n){if(!this.layerHighlightState?.featureLayerView)return[];const o=this.getNameFieldForCurrentLayer();if(!o)return[];const s=this.layerHighlightState.featureLayerView.layer;let c=this.#a.get(s.uid);c||(c=new jt,this.#a.set(s.uid,c));const h=new Array(n.length),d=new jt,m=[];if(n.forEach((A,D)=>{d.set(A,D);const E=c.get(A);E!==void 0?h[D]=E:m.push(A)}),m.length===0)return h.map(A=>A??"");const T=s.objectIdField,k=await s.queryFeatures({objectIds:m,outFields:[o,T],returnGeometry:!1});for(const A of k.features){const D=A.attributes[T],E=A.attributes[o],G=d.get(D);G!==void 0&&(h[G]=E??"",c.set(D,E??""))}return h.map(A=>A??"")}async getAreaCodesById(n){if(!this.layerHighlightState?.featureLayerView)return[];const o=this.getCodeFieldForCurrentLayer();if(!o)return[];const s=this.layerHighlightState.featureLayerView.layer,c=s.objectIdField,h=await s.queryFeatures({objectIds:n,outFields:[o,c],returnGeometry:!1}),d=new Array(n.length);for(const m of h.features){const T=m.attributes[c],k=m.attributes[o],A=n.indexOf(T);A!==-1&&(d[A]=k??"")}return d.map(m=>m??"")}setHoveredArea(n,o){this.currentHoveredArea&&this.clearHoveredArea(),this.currentHoveredArea={id:n,handle:o}}clearHoveredArea(){this.currentHoveredArea&&(this.currentHoveredArea?.handle.remove(),this.currentHoveredArea=null)}getNameFieldForCurrentLayer(){if(!this.layerHighlightState||!this.layerHighlightState.featureLayerView||!this.layerHighlightState.featureLayerView.layer)return null;const n=this.#n.find(o=>o.layerName===this.layerHighlightState?.featureLayerView?.layer?.title)?.nameField;return n||(console.warn(`SelectedAreasStore: No name field configured for layer ${this.layerHighlightState.featureLayerView.layer.title}`,this.#n),null)}getCodeFieldForCurrentLayer(){if(!this.layerHighlightState||!this.layerHighlightState.featureLayerView||!this.layerHighlightState.featureLayerView.layer)return null;const n=this.#n.find(o=>o.layerName===this.layerHighlightState?.featureLayerView?.layer?.title)?.codeField;return n||(console.warn(`SelectedAreasStore: No code field configured for layer ${this.layerHighlightState.featureLayerView.layer.title}`,this.#n),null)}clearSelections(){this.resetSelectedAreas(),this.clearHoveredArea(),this.lastAddedArea=null,this.lastRemovedArea=null,this.currentHoveredArea=null,console.log("[area-selection-store] selections cleared.")}cleanup(){this.resetSelectedAreas(),this.clearHoveredArea(),this.lastAddedArea=null,this.lastRemovedArea=null,this.currentHoveredArea=null,this.#a.clear(),this.#n=[],console.log("[area-selection-store] cleaned up.")}}const Ne=new Fs;var Ds=se('<p class="text-sm font-medium"> </p>'),Ls=se('<div class="pointer-events-none fixed z-50 transition-opacity duration-200"><!></div>');function Ms(x,n){Re(n,!0);let o=ie(null),s=ie(Je({x:0,y:0})),c=0;const h=k=>{z(s,{x:k.clientX,y:k.clientY},!0)};ot(()=>(document.addEventListener("mousemove",h),()=>{document.removeEventListener("mousemove",h)})),ot(()=>{const k=Ne.currentHoveredArea?.id,A=++c;if(!k){z(o,null);return}(async()=>{const D=await Ne.getAreaNamesById([k]);A===c&&Ne.currentHoveredArea?.id===k&&z(o,D[0]??null,!0)})()});var d=le(),m=$(d);{var T=k=>{var A=Ls(),D=Q(A);De(D,()=>Pr,(E,G)=>{G(E,{class:"max-w-xs border !py-2 shadow-lg",children:(N,M)=>{var H=le(),j=$(H);De(j,()=>Or,(B,V)=>{V(B,{class:"!px-3 !py-0",children:(Y,ve)=>{var te=Ds(),ce=Q(te,!0);U(te),ut(()=>Ot(ce,u(o))),F(Y,te)},$$slots:{default:!0}})}),F(N,H)},$$slots:{default:!0}})}),U(A),ut(()=>In(A,`left: ${u(s).x+10}px; top: ${u(s).y-10}px;`)),F(k,A)};me(m,k=>{u(o)&&k(T)})}F(x,d),He()}function Ns(x,n){Re(n,!0);async function o(s,c){const h=await Ne.getAreaNamesById([s]);if(!h||h.length===0||!h[0])return;const d=`Area ${c}: ${h[0]}`;fn.success(d)}ot(()=>{Ne.lastAddedArea&&o(Ne.lastAddedArea.id,"added")}),ot(()=>{Ne.lastRemovedArea&&o(Ne.lastRemovedArea.id,"removed")}),He()}var Rs=se("<div><!></div>");function la(x,n){Re(n,!0);let o=Ee(n,"ref",15,null),s=Dt(n,["$$slots","$$events","$$legacy","ref","variant","children"]);var c=Rs();Ar(c,()=>({...s,class:"group/chat-bubble flex max-w-[80%] flex-row place-items-end gap-2 data-[variant='sent']:place-self-end","data-variant":n.variant}));var h=Q(c);$e(h,()=>n.children??Qe),U(c),Mt(c,d=>o(d),()=>o()),F(x,c),He()}var Hs=se('<span class="inline-block size-(--loading-dots-size) rounded-full bg-primary svelte-k2x6sv"></span>'),js=se('<div class="inline-flex items-center gap-1 svelte-k2x6sv"></div>');function zs(x,n){let o=Ee(n,"size",3,4);var s=js();let c;zt(s,20,()=>({length:3}),An,(h,d)=>{var m=Hs();F(h,m)}),U(s),ut(h=>c=In(s,"",c,h),[()=>({"--loading-dots-size":`${o()??""}px`})]),F(x,s)}var Ks=se('<div class="flex size-full place-items-center justify-center"><!></div>'),Vs=se("<div><!></div>");function ui(x,n){Re(n,!0);let o=Ee(n,"ref",15,null),s=Ee(n,"typing",3,!1),c=Dt(n,["$$slots","$$events","$$legacy","ref","typing","class","children"]);var h=Vs();Ar(h,k=>({...c,class:k}),[()=>Er("order-2 rounded-lg bg-secondary p-4 text-sm group-data-[variant='received']/chat-bubble:rounded-bl-none group-data-[variant='sent']/chat-bubble:order-1 group-data-[variant='sent']/chat-bubble:rounded-br-none group-data-[variant='sent']/chat-bubble:bg-primary group-data-[variant='sent']/chat-bubble:text-primary-foreground",n.class)]);var d=Q(h);{var m=k=>{var A=Ks(),D=Q(A);zs(D,{}),U(A),F(k,A)},T=k=>{var A=le(),D=$(A);$e(D,()=>n.children??Qe),F(k,A)};me(d,k=>{s()?k(m):k(T,!1)})}U(h),Mt(h,k=>o(k),()=>o()),F(x,h),He()}function Bs(x,n){Re(n,!0);let o=Ee(n,"ref",15,null),s=Dt(n,["$$slots","$$events","$$legacy","ref","class"]);var c=le(),h=$(c);{let d=ge(()=>Er("relative flex size-8 shrink-0 overflow-hidden rounded-full",n.class));De(h,()=>bs,(m,T)=>{T(m,It({"data-slot":"avatar",get class(){return u(d)}},()=>s,{get ref(){return o()},set ref(k){o(k)}}))})}F(x,c),He()}function ua(x,n){Re(n,!0);let o=Ee(n,"ref",15,null),s=Dt(n,["$$slots","$$events","$$legacy","ref","class"]);{let c=ge(()=>Er("order-1 group-data-[variant='sent']/chat-bubble:order-2",n.class));Bs(x,It({get class(){return u(c)}},()=>s,{get ref(){return o()},set ref(h){o(h)}}))}He()}function Ca(x){const n=x-1;return n*n*n+1}function ca(x,{delay:n=0,duration:o=400,easing:s=Ca,axis:c="y"}={}){const h=getComputedStyle(x),d=+h.opacity,m=c==="y"?"height":"width",T=parseFloat(h[m]),k=c==="y"?["top","bottom"]:["left","right"],A=k.map(j=>`${j[0].toUpperCase()}${j.slice(1)}`),D=parseFloat(h[`padding${A[0]}`]),E=parseFloat(h[`padding${A[1]}`]),G=parseFloat(h[`margin${A[0]}`]),N=parseFloat(h[`margin${A[1]}`]),M=parseFloat(h[`border${A[0]}Width`]),H=parseFloat(h[`border${A[1]}Width`]);return{delay:n,duration:o,easing:s,css:j=>`overflow: hidden;opacity: ${Math.min(j*20,1)*d};${m}: ${j*T}px;padding-${k[0]}: ${j*D}px;padding-${k[1]}: ${j*E}px;margin-${k[0]}: ${j*G}px;margin-${k[1]}: ${j*N}px;border-${k[0]}-width: ${j*M}px;border-${k[1]}-width: ${j*H}px;min-${m}: 0`}}function da(x,{delay:n=0,duration:o=400,easing:s=Ca,start:c=0,opacity:h=0}={}){const d=getComputedStyle(x),m=+d.opacity,T=d.transform==="none"?"":d.transform,k=1-c,A=m*(1-h);return{delay:n,duration:o,easing:s,css:(D,E)=>`
			transform: ${T} scale(${1-k*E});
			opacity: ${m-A*E}
		`}}class qs{#e=ie();#t=ie(0);#r=ie(!1);lastScrollHeight=0;set ref(n){if(z(this.#e,n,!0),!u(this.#e))return;this.lastScrollHeight=u(this.#e).scrollHeight,u(this.#e).scrollTo(0,u(this.#t)?u(this.#t):u(this.#e).scrollHeight),u(this.#e).addEventListener("scroll",()=>{u(this.#e)&&(z(this.#t,u(this.#e).scrollTop,!0),this.disableAutoScroll())}),window.addEventListener("resize",()=>{this.scrollToBottom(!0)}),new MutationObserver(()=>{u(this.#e)&&(u(this.#e).scrollHeight!==this.lastScrollHeight&&this.scrollToBottom(!0),this.lastScrollHeight=u(this.#e).scrollHeight)}).observe(u(this.#e),{childList:!0,subtree:!0})}get ref(){return u(this.#e)}get scrollY(){return u(this.#t)}get isAtBottom(){return u(this.#e)?u(this.#t)+u(this.#e).offsetHeight>=u(this.#e).scrollHeight:!0}disableAutoScroll(){this.isAtBottom?z(this.#r,!1):z(this.#r,!0)}scrollToBottom(n=!1){u(this.#e)&&(n&&u(this.#r)||u(this.#e).scrollTo(0,u(this.#e).scrollHeight))}}var $s=se("<div><!></div>"),Us=se('<div class="relative"><div><!></div> <!></div>');function Gs(x,n){Re(n,!0);let o=Ee(n,"ref",15,null),s=Dt(n,["$$slots","$$events","$$legacy","ref","children","class"]),c=ie(!1);const h=new qs;kn(()=>{z(c,!0)});var d=Us(),m=Q(d);Ar(m,D=>({...s,class:D}),[()=>Er("no-scrollbar flex h-full w-full flex-col gap-4 overflow-y-auto p-4",n.class,{"scroll-smooth":u(c)})]);var T=Q(m);$e(T,()=>n.children??Qe),U(m),Mt(m,D=>o(D),()=>o()),Mt(m,D=>h.ref=D,()=>h?.ref);var k=fe(m,2);{var A=D=>{var E=$s(),G=Q(E);At(G,{onclick:()=>h.scrollToBottom(),variant:"outline",size:"icon",class:"absolute bottom-2 left-1/2 inline-flex -translate-x-1/2 transform rounded-full shadow-md",children:(N,M)=>{As(N,{})},$$slots:{default:!0}}),U(E),kr(1,E,()=>da,()=>({start:.85,duration:100,delay:250})),kr(2,E,()=>da,()=>({start:.85,duration:100})),F(D,E)};me(k,D=>{h.isAtBottom||D(A)})}U(d),F(x,d),He()}var Ws=se(`<p class="break-words whitespace-pre-wrap"> </p> <div class="w-full text-xs group-data-[variant='sent']/chat-bubble:text-end"> </div>`,1),Ys=se("<!> <!>",1),Js=se('<p class="break-words whitespace-pre-wrap"> </p>'),Qs=se("<!> <!>",1),Xs=se("<!> <!>",1),Zs=se('<div class="chat-container h-full w-full border border-border svelte-1osgd7m"><div class="message-wrapper svelte-1osgd7m"><!></div> <div class="input-wrapper svelte-1osgd7m"><form class="flex shrink-0 items-center gap-2 border-t border-border bg-background p-2"><!> <!></form></div></div>');function el(x,n){Re(n,!0);const o=1,s=2,c="Sorry, I encountered an error processing your request.",h="How can I help?";let d=ie(""),m=ie(!1),T=ie(""),k=ie(null),A=ie(null),D=ie(null);const E=Je([{senderId:o,message:h,sentAt:G(new Date)}]);ot(()=>{if(u(A)&&u(D)){const de=u(A),Se=u(D),X=()=>{const xe=de.offsetHeight;Se.style.paddingBottom=`${xe}px`};X();const ue=new ResizeObserver(X);return ue.observe(de),()=>{ue.disconnect()}}}),ot(()=>{E.length,u(T),u(k)&&setTimeout(()=>{const de=u(k)?.querySelector('[data-slot="scroll-area-viewport"]');de&&(de.scrollTop=de.scrollHeight)},0)});function G(de){const Se=de.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),X=de.getHours()>=12?"PM":"AM";return`${Se} ${X}`}function N(de,Se){return{message:de,senderId:Se,sentAt:G(new Date)}}function M(de,Se){E.push(N(de,Se))}function H(){z(m,!1),z(T,"")}function j(de){z(T,u(T)+de)}async function B(de){if(de.preventDefault(),!u(d).trim()||u(m))return;const Se=u(d).trim();z(d,""),M(Se,s),z(m,!0),z(T,"");try{await n.aiUprnChatbotService.chatStream(Se,j)&&u(T)?M(u(T),o):M(c,o)}catch(X){console.error("Chat error:",X),M(c,o)}finally{H()}}var V=Zs(),Y=Q(V),ve=Q(Y);wa(ve,{class:"h-full w-full",get ref(){return u(k)},set ref(de){z(k,de,!0)},children:(de,Se)=>{var X=le(),ue=$(X);De(ue,()=>Gs,(xe,Le)=>{Le(xe,{children:(ae,we)=>{var ke=Xs(),pe=$(ke);zt(pe,16,()=>E,et=>et,(et,Ze)=>{var it=le(),ye=$(it);{let Ce=ge(()=>Ze.senderId===s?"sent":"received");De(ye,()=>la,(je,tt)=>{tt(je,{get variant(){return u(Ce)},children:(ne,Ge)=>{var qe=Ys(),be=$(qe);De(be,()=>ua,(wt,We)=>{We(wt,{})});var Ue=fe(be,2);De(Ue,()=>ui,(wt,We)=>{We(wt,{class:"flex flex-col gap-1",children:(_t,ht)=>{var vt=Ws(),Ve=$(vt),at=Q(Ve,!0);U(Ve);var Ke=fe(Ve,2),pt=Q(Ke,!0);U(Ke),ut(()=>{Ot(at,Ze.message),Ot(pt,Ze.sentAt)}),F(_t,vt)},$$slots:{default:!0}})}),F(ne,qe)},$$slots:{default:!0}})})}F(et,it)});var Fe=fe(pe,2);{var Xe=et=>{var Ze=le(),it=$(Ze);De(it,()=>la,(ye,Ce)=>{Ce(ye,{variant:"received",children:(je,tt)=>{var ne=Qs(),Ge=$(ne);De(Ge,()=>ua,(be,Ue)=>{Ue(be,{})});var qe=fe(Ge,2);De(qe,()=>ui,(be,Ue)=>{Ue(be,{class:"flex flex-col gap-1",children:(wt,We)=>{var _t=le(),ht=$(_t);{var vt=at=>{var Ke=Js(),pt=Q(Ke,!0);U(Ke),ut(()=>Ot(pt,u(T))),F(at,Ke)},Ve=at=>{var Ke=le(),pt=$(Ke);De(pt,()=>ui,(St,gt)=>{gt(St,{typing:!0})}),F(at,Ke)};me(ht,at=>{u(T)?at(vt):at(Ve,!1)})}F(wt,_t)},$$slots:{default:!0}})}),F(je,ne)},$$slots:{default:!0}})}),F(et,Ze)};me(Fe,et=>{u(m)&&et(Xe)})}F(ae,ke)},$$slots:{default:!0}})}),F(de,X)},$$slots:{default:!0}}),U(Y),Mt(Y,de=>z(D,de),()=>u(D));var te=fe(Y,2),ce=Q(te),_e=Q(ce);is(_e,{class:"rounded-full",placeholder:"Type a message...",get disabled(){return u(m)},get value(){return u(d)},set value(de){z(d,de,!0)}});var Ae=fe(_e,2);{let de=ge(()=>u(d).trim()===""||u(m));At(Ae,{type:"submit",variant:"default",size:"icon",class:"shrink-0 rounded-full",get disabled(){return u(de)},children:(Se,X)=>{Es(Se,{})},$$slots:{default:!0}})}U(ce),Mt(ce,de=>z(A,de),()=>u(A)),U(te),U(V),rs("submit",ce,B),F(x,V),He()}const Zt=Object.freeze({Pending:"pending",InProgress:"in-progress",Completed:"completed",Failed:"failed"}),_r=Object.freeze({Submitted:"SUBMITTED",Queued:"QUEUED",Processing:"IN_PROGRESS",Completed:"COMPLETED",Error:"ERROR"}),tl=Object.freeze({Success:"success",Error:"error"});var xr={exports:{}},nl=xr.exports,fa;function rl(){return fa||(fa=1,(function(x,n){(function(o,s){x.exports=s()})(nl,function(){var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(r[a]=i[a])})(e,t)},s=function(){return(s=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function c(e,t,r){for(var i,a=0,l=t.length;a<l;a++)!i&&a in t||((i=i||Array.prototype.slice.call(t,0,a))[a]=t[a]);return e.concat(i||Array.prototype.slice.call(t))}var h=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Lo,d=Object.keys,m=Array.isArray;function T(e,t){return typeof t!="object"||d(t).forEach(function(r){e[r]=t[r]}),e}typeof Promise>"u"||h.Promise||(h.Promise=Promise);var k=Object.getPrototypeOf,A={}.hasOwnProperty;function D(e,t){return A.call(e,t)}function E(e,t){typeof t=="function"&&(t=t(k(e))),(typeof Reflect>"u"?d:Reflect.ownKeys)(t).forEach(function(r){N(e,r,t[r])})}var G=Object.defineProperty;function N(e,t,r,i){G(e,t,T(r&&D(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},i))}function M(e){return{from:function(t){return e.prototype=Object.create(t.prototype),N(e.prototype,"constructor",e),{extend:E.bind(null,e.prototype)}}}}var H=Object.getOwnPropertyDescriptor,j=[].slice;function B(e,t,r){return j.call(e,t,r)}function V(e,t){return t(e)}function Y(e){if(!e)throw new Error("Assertion Failed")}function ve(e){h.setImmediate?setImmediate(e):setTimeout(e,0)}function te(e,t){if(typeof t=="string"&&D(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var r=[],i=0,a=t.length;i<a;++i){var l=te(e,t[i]);r.push(l)}return r}var f=t.indexOf(".");if(f!==-1){var v=e[t.substr(0,f)];return v==null?void 0:te(v,t.substr(f+1))}}function ce(e,t,r){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){Y(typeof r!="string"&&"length"in r);for(var i=0,a=t.length;i<a;++i)ce(e,t[i],r[i])}else{var l,f,v=t.indexOf(".");v!==-1?(l=t.substr(0,v),(f=t.substr(v+1))===""?r===void 0?m(e)&&!isNaN(parseInt(l))?e.splice(l,1):delete e[l]:e[l]=r:ce(v=!(v=e[l])||!D(e,l)?e[l]={}:v,f,r)):r===void 0?m(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function _e(e){var t,r={};for(t in e)D(e,t)&&(r[t]=e[t]);return r}var Ae=[].concat;function de(e){return Ae.apply([],e)}var Pt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(de([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return h[e]}),Se=new Set(Pt.map(function(e){return h[e]})),X=null;function ue(e){return X=new WeakMap,e=(function t(r){if(!r||typeof r!="object")return r;var i=X.get(r);if(i)return i;if(m(r)){i=[],X.set(r,i);for(var a=0,l=r.length;a<l;++a)i.push(t(r[a]))}else if(Se.has(r.constructor))i=r;else{var f,v=k(r);for(f in i=v===Object.prototype?{}:Object.create(v),X.set(r,i),r)D(r,f)&&(i[f]=t(r[f]))}return i})(e),X=null,e}var xe={}.toString;function Le(e){return xe.call(e).slice(8,-1)}var ae=typeof Symbol<"u"?Symbol.iterator:"@@iterator",we=typeof ae=="symbol"?function(e){var t;return e!=null&&(t=e[ae])&&t.apply(e)}:function(){return null};function ke(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var pe={};function Fe(e){var t,r,i,a;if(arguments.length===1){if(m(e))return e.slice();if(this===pe&&typeof e=="string")return[e];if(a=we(e)){for(r=[];!(i=a.next()).done;)r.push(i.value);return r}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(r=new Array(t);t--;)r[t]=e[t];return r}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}var Xe=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},xt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Lt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(xt),et={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ze(e,t){this.name=e,this.message=t}function it(e,t){return e+". Errors: "+Object.keys(t).map(function(r){return t[r].toString()}).filter(function(r,i,a){return a.indexOf(r)===i}).join(`
`)}function ye(e,t,r,i){this.failures=t,this.failedKeys=i,this.successCount=r,this.message=it(e,t)}function Ce(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(r){return t[r]}),this.failuresByPos=t,this.message=it(e,this.failures)}M(Ze).from(Error).extend({toString:function(){return this.name+": "+this.message}}),M(ye).from(Ze),M(Ce).from(Ze);var je=Lt.reduce(function(e,t){return e[t]=t+"Error",e},{}),tt=Ze,ne=Lt.reduce(function(e,t){var r=t+"Error";function i(a,l){this.name=r,a?typeof a=="string"?(this.message="".concat(a).concat(l?`
 `+l:""),this.inner=l||null):typeof a=="object"&&(this.message="".concat(a.name," ").concat(a.message),this.inner=a):(this.message=et[t]||r,this.inner=null)}return M(i).from(tt),e[t]=i,e},{});ne.Syntax=SyntaxError,ne.Type=TypeError,ne.Range=RangeError;var Ge=xt.reduce(function(e,t){return e[t+"Error"]=ne[t],e},{}),qe=Lt.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=ne[t]),e},{});function be(){}function Ue(e){return e}function wt(e,t){return e==null||e===Ue?t:function(r){return t(e(r))}}function We(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function _t(e,t){return e===be?t:function(){var r=e.apply(this,arguments);r!==void 0&&(arguments[0]=r);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var l=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?We(i,this.onsuccess):i),a&&(this.onerror=this.onerror?We(a,this.onerror):a),l!==void 0?l:r}}function ht(e,t){return e===be?t:function(){e.apply(this,arguments);var r=this.onsuccess,i=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?We(r,this.onsuccess):r),i&&(this.onerror=this.onerror?We(i,this.onerror):i)}}function vt(e,t){return e===be?t:function(r){var i=e.apply(this,arguments);T(r,i);var a=this.onsuccess,l=this.onerror;return this.onsuccess=null,this.onerror=null,r=t.apply(this,arguments),a&&(this.onsuccess=this.onsuccess?We(a,this.onsuccess):a),l&&(this.onerror=this.onerror?We(l,this.onerror):l),i===void 0?r===void 0?void 0:r:T(i,r)}}function Ve(e,t){return e===be?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function at(e,t){return e===be?t:function(){var r=e.apply(this,arguments);if(r&&typeof r.then=="function"){for(var i=this,a=arguments.length,l=new Array(a);a--;)l[a]=arguments[a];return r.then(function(){return t.apply(i,l)})}return t.apply(this,arguments)}}qe.ModifyError=ye,qe.DexieError=Ze,qe.BulkError=Ce;var Ke=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function pt(e){Ke=e}var St={},gt=100,Pt=typeof Promise>"u"?[]:(function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,k(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,k(t),e]})(),xt=Pt[0],Lt=Pt[1],Pt=Pt[2],Lt=Lt&&Lt.then,Nt=xt&&xt.constructor,tn=!!Pt,Ut=function(e,t){Dn.push([e,t]),hn&&(queueMicrotask(Da),hn=!1)},nn=!0,hn=!0,Kt=[],vn=[],Vt=Ue,Tt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:be,pgp:!1,env:{},finalize:be},he=Tt,Dn=[],rn=0,Un=[];function re(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=he;if(typeof e!="function"){if(e!==St)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Dr(this,this._value))}this._state=null,this._value=null,++t.ref,(function r(i,a){try{a(function(l){if(i._state===null){if(l===i)throw new TypeError("A promise cannot be resolved with itself.");var f=i._lib&&pn();l&&typeof l.then=="function"?r(i,function(v,g){l instanceof re?l._then(v,g):l.then(v,g)}):(i._state=!0,i._value=l,wi(i)),f&&gn()}},Dr.bind(null,i))}catch(l){Dr(i,l)}})(this,e)}var Fr={get:function(){var e=he,t=Jn;function r(i,a){var l=this,f=!e.global&&(e!==he||t!==Jn),v=f&&!Wt(),g=new re(function(y,S){Lr(l,new bi(Si(i,e,f,v),Si(a,e,f,v),y,S,e))});return this._consoleTask&&(g._consoleTask=this._consoleTask),g}return r.prototype=St,r},set:function(e){N(this,"then",e&&e.prototype===St?Fr:{get:function(){return e},set:Fr.set})}};function bi(e,t,r,i,a){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=r,this.reject=i,this.psd=a}function Dr(e,t){var r,i;vn.push(t),e._state===null&&(r=e._lib&&pn(),t=Vt(t),e._state=!1,e._value=t,i=e,Kt.some(function(a){return a._value===i._value})||Kt.push(i),wi(e),r&&gn())}function wi(e){var t=e._listeners;e._listeners=[];for(var r=0,i=t.length;r<i;++r)Lr(e,t[r]);var a=e._PSD;--a.ref||a.finalize(),rn===0&&(++rn,Ut(function(){--rn==0&&Mr()},[]))}function Lr(e,t){if(e._state!==null){var r=e._state?t.onFulfilled:t.onRejected;if(r===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++rn,Ut(Fa,[r,e,t])}else e._listeners.push(t)}function Fa(e,t,r){try{var i,a=t._value;!t._state&&vn.length&&(vn=[]),i=Ke&&t._consoleTask?t._consoleTask.run(function(){return e(a)}):e(a),t._state||vn.indexOf(a)!==-1||(function(l){for(var f=Kt.length;f;)if(Kt[--f]._value===l._value)return Kt.splice(f,1)})(t),r.resolve(i)}catch(l){r.reject(l)}finally{--rn==0&&Mr(),--r.psd.ref||r.psd.finalize()}}function Da(){an(Tt,function(){pn()&&gn()})}function pn(){var e=nn;return hn=nn=!1,e}function gn(){var e,t,r;do for(;0<Dn.length;)for(e=Dn,Dn=[],r=e.length,t=0;t<r;++t){var i=e[t];i[0].apply(null,i[1])}while(0<Dn.length);hn=nn=!0}function Mr(){var e=Kt;Kt=[],e.forEach(function(i){i._PSD.onunhandled.call(null,i._value,i)});for(var t=Un.slice(0),r=t.length;r;)t[--r]()}function Gn(e){return new re(St,!1,e)}function nt(e,t){var r=he;return function(){var i=pn(),a=he;try{return Yt(r,!0),e.apply(this,arguments)}catch(l){t&&t(l)}finally{Yt(a,!1),i&&gn()}}}E(re.prototype,{then:Fr,_then:function(e,t){Lr(this,new bi(null,null,e,t,he))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,r=arguments[1];return typeof t=="function"?this.then(null,function(i){return(i instanceof t?r:Gn)(i)}):this.then(null,function(i){return(i&&i.name===t?r:Gn)(i)})},finally:function(e){return this.then(function(t){return re.resolve(e()).then(function(){return t})},function(t){return re.resolve(e()).then(function(){return Gn(t)})})},timeout:function(e,t){var r=this;return e<1/0?new re(function(i,a){var l=setTimeout(function(){return a(new ne.Timeout(t))},e);r.then(i,a).finally(clearTimeout.bind(null,l))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&N(re.prototype,Symbol.toStringTag,"Dexie.Promise"),Tt.env=_i(),E(re,{all:function(){var e=Fe.apply(null,arguments).map(Qn);return new re(function(t,r){e.length===0&&t([]);var i=e.length;e.forEach(function(a,l){return re.resolve(a).then(function(f){e[l]=f,--i||t(e)},r)})})},resolve:function(e){return e instanceof re?e:e&&typeof e.then=="function"?new re(function(t,r){e.then(t,r)}):new re(St,!0,e)},reject:Gn,race:function(){var e=Fe.apply(null,arguments).map(Qn);return new re(function(t,r){e.map(function(i){return re.resolve(i).then(t,r)})})},PSD:{get:function(){return he},set:function(e){return he=e}},totalEchoes:{get:function(){return Jn}},newPSD:Gt,usePSD:an,scheduler:{get:function(){return Ut},set:function(e){Ut=e}},rejectionMapper:{get:function(){return Vt},set:function(e){Vt=e}},follow:function(e,t){return new re(function(r,i){return Gt(function(a,l){var f=he;f.unhandleds=[],f.onunhandled=l,f.finalize=We(function(){var v,g=this;v=function(){g.unhandleds.length===0?a():l(g.unhandleds[0])},Un.push(function y(){v(),Un.splice(Un.indexOf(y),1)}),++rn,Ut(function(){--rn==0&&Mr()},[])},f.finalize),e()},t,r,i)})}}),Nt&&(Nt.allSettled&&N(re,"allSettled",function(){var e=Fe.apply(null,arguments).map(Qn);return new re(function(t){e.length===0&&t([]);var r=e.length,i=new Array(r);e.forEach(function(a,l){return re.resolve(a).then(function(f){return i[l]={status:"fulfilled",value:f}},function(f){return i[l]={status:"rejected",reason:f}}).then(function(){return--r||t(i)})})})}),Nt.any&&typeof AggregateError<"u"&&N(re,"any",function(){var e=Fe.apply(null,arguments).map(Qn);return new re(function(t,r){e.length===0&&r(new AggregateError([]));var i=e.length,a=new Array(i);e.forEach(function(l,f){return re.resolve(l).then(function(v){return t(v)},function(v){a[f]=v,--i||r(new AggregateError(a))})})})}),Nt.withResolvers&&(re.withResolvers=Nt.withResolvers));var dt={awaits:0,echoes:0,id:0},La=0,Wn=[],Yn=0,Jn=0,Ma=0;function Gt(e,t,r,i){var a=he,l=Object.create(a);return l.parent=a,l.ref=0,l.global=!1,l.id=++Ma,Tt.env,l.env=tn?{Promise:re,PromiseProp:{value:re,configurable:!0,writable:!0},all:re.all,race:re.race,allSettled:re.allSettled,any:re.any,resolve:re.resolve,reject:re.reject}:{},t&&T(l,t),++a.ref,l.finalize=function(){--this.parent.ref||this.parent.finalize()},i=an(l,e,r,i),l.ref===0&&l.finalize(),i}function mn(){return dt.id||(dt.id=++La),++dt.awaits,dt.echoes+=gt,dt.id}function Wt(){return!!dt.awaits&&(--dt.awaits==0&&(dt.id=0),dt.echoes=dt.awaits*gt,!0)}function Qn(e){return dt.echoes&&e&&e.constructor===Nt?(mn(),e.then(function(t){return Wt(),t},function(t){return Wt(),st(t)})):e}function Na(){var e=Wn[Wn.length-1];Wn.pop(),Yt(e,!1)}function Yt(e,t){var r,i=he;(t?!dt.echoes||Yn++&&e===he:!Yn||--Yn&&e===he)||queueMicrotask(t?(function(a){++Jn,dt.echoes&&--dt.echoes!=0||(dt.echoes=dt.awaits=dt.id=0),Wn.push(he),Yt(a,!0)}).bind(null,e):Na),e!==he&&(he=e,i===Tt&&(Tt.env=_i()),tn&&(r=Tt.env.Promise,t=e.env,(i.global||e.global)&&(Object.defineProperty(h,"Promise",t.PromiseProp),r.all=t.all,r.race=t.race,r.resolve=t.resolve,r.reject=t.reject,t.allSettled&&(r.allSettled=t.allSettled),t.any&&(r.any=t.any))))}function _i(){var e=h.Promise;return tn?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(h,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function an(e,t,r,i,a){var l=he;try{return Yt(e,!0),t(r,i,a)}finally{Yt(l,!1)}}function Si(e,t,r,i){return typeof e!="function"?e:function(){var a=he;r&&mn(),Yt(t,!0);try{return e.apply(this,arguments)}finally{Yt(a,!1),i&&queueMicrotask(Wt)}}}function Nr(e){Promise===Nt&&dt.echoes===0?Yn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+Lt).indexOf("[native code]")===-1&&(mn=Wt=be);var st=re.reject,on="",Bt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",xi="String expected.",yn=[],Xn="__dbnames",Rr="readonly",Hr="readwrite";function sn(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Ci={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Zn(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=ue(t))[e],t}}function ki(){throw ne.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Me(e,t){try{var r=Ii(e),i=Ii(t);if(r!==i)return r==="Array"?1:i==="Array"?-1:r==="binary"?1:i==="binary"?-1:r==="string"?1:i==="string"?-1:r==="Date"?1:i!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return(function(a,l){for(var f=a.length,v=l.length,g=f<v?f:v,y=0;y<g;++y)if(a[y]!==l[y])return a[y]<l[y]?-1:1;return f===v?0:f<v?-1:1})(Ai(e),Ai(t));case"Array":return(function(a,l){for(var f=a.length,v=l.length,g=f<v?f:v,y=0;y<g;++y){var S=Me(a[y],l[y]);if(S!==0)return S}return f===v?0:f<v?-1:1})(e,t)}}catch{}return NaN}function Ii(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=Le(e),e==="ArrayBuffer"?"binary":e)}function Ai(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function er(e,t,r){var i=e.schema.yProps;return i?(t&&0<r.numFailures&&(t=t.filter(function(a,l){return!r.failures[l]})),Promise.all(i.map(function(a){return a=a.updatesTable,t?e.db.table(a).where("k").anyOf(t).delete():e.db.table(a).clear()})).then(function(){return r})):r}var Ln=(Oi.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var r=t.add;if(m(r))return c(c([],m(e)?e:[],!0),r).sort();if(typeof r=="number")return(Number(e)||0)+r;if(typeof r=="bigint")try{return BigInt(e)+r}catch{return BigInt(0)+r}throw new TypeError("Invalid term ".concat(r))}if(t.remove!==void 0){var i=t.remove;if(m(i))return m(e)?e.filter(function(a){return!i.includes(a)}).sort():[];if(typeof i=="number")return Number(e)-i;if(typeof i=="bigint")try{return BigInt(e)-i}catch{return BigInt(0)-i}throw new TypeError("Invalid subtrahend ".concat(i))}return r=(r=t.replacePrefix)===null||r===void 0?void 0:r[0],r&&typeof e=="string"&&e.startsWith(r)?t.replacePrefix[1]+e.substring(r.length):e},Oi);function Oi(e){this["@@propmod"]=e}function Pi(e,t){for(var r=d(t),i=r.length,a=!1,l=0;l<i;++l){var f=r[l],v=t[f],g=te(e,f);v instanceof Ln?(ce(e,f,v.execute(g)),a=!0):g!==v&&(ce(e,f,v),a=!0)}return a}var Ti=(Ye.prototype._trans=function(e,t,r){var i=this._tx||he.trans,a=this.name,l=Ke&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function f(y,S,p){if(!p.schema[a])throw new ne.NotFound("Table "+a+" not part of transaction");return t(p.idbtrans,p)}var v=pn();try{var g=i&&i.db._novip===this.db._novip?i===he.trans?i._promise(e,f,r):Gt(function(){return i._promise(e,f,r)},{trans:i,transless:he.transless||he}):(function y(S,p,I,b){if(S.idbdb&&(S._state.openComplete||he.letThrough||S._vip)){var w=S._createTransaction(p,I,S._dbSchema);try{w.create(),S._state.PR1398_maxLoop=3}catch(_){return _.name===je.InvalidState&&S.isOpen()&&0<--S._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),S.close({disableAutoOpen:!1}),S.open().then(function(){return y(S,p,I,b)})):st(_)}return w._promise(p,function(_,C){return Gt(function(){return he.trans=w,b(_,C,w)})}).then(function(_){if(p==="readwrite")try{w.idbtrans.commit()}catch{}return p==="readonly"?_:w._completion.then(function(){return _})})}if(S._state.openComplete)return st(new ne.DatabaseClosed(S._state.dbOpenError));if(!S._state.isBeingOpened){if(!S._state.autoOpen)return st(new ne.DatabaseClosed);S.open().catch(be)}return S._state.dbReadyPromise.then(function(){return y(S,p,I,b)})})(this.db,e,[this.name],f);return l&&(g._consoleTask=l,g=g.catch(function(y){return console.trace(y),st(y)})),g}finally{v&&gn()}},Ye.prototype.get=function(e,t){var r=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?st(new ne.Type("Invalid argument to Table.get()")):this._trans("readonly",function(i){return r.core.get({trans:i,key:e}).then(function(a){return r.hook.reading.fire(a)})}).then(t)},Ye.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(m(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=d(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(v){if(v.compound&&t.every(function(y){return 0<=v.keyPath.indexOf(y)})){for(var g=0;g<t.length;++g)if(t.indexOf(v.keyPath[g])===-1)return!1;return!0}return!1}).sort(function(v,g){return v.keyPath.length-g.keyPath.length})[0];if(r&&this.db._maxKey!==on){var l=r.keyPath.slice(0,t.length);return this.where(l).equals(l.map(function(g){return e[g]}))}!r&&Ke&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var i=this.schema.idxByName;function a(v,g){return Me(v,g)===0}var f=t.reduce(function(p,g){var y=p[0],S=p[1],p=i[g],I=e[g];return[y||p,y||!p?sn(S,p&&p.multi?function(b){return b=te(b,g),m(b)&&b.some(function(w){return a(I,w)})}:function(b){return a(I,te(b,g))}):S]},[null,null]),l=f[0],f=f[1];return l?this.where(l.name).equals(e[l.keyPath]).filter(f):r?this.filter(f):this.where(t).equals("")},Ye.prototype.filter=function(e){return this.toCollection().and(e)},Ye.prototype.count=function(e){return this.toCollection().count(e)},Ye.prototype.offset=function(e){return this.toCollection().offset(e)},Ye.prototype.limit=function(e){return this.toCollection().limit(e)},Ye.prototype.each=function(e){return this.toCollection().each(e)},Ye.prototype.toArray=function(e){return this.toCollection().toArray(e)},Ye.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Ye.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,m(e)?"[".concat(e.join("+"),"]"):e))},Ye.prototype.reverse=function(){return this.toCollection().reverse()},Ye.prototype.mapToClass=function(e){var t,r=this.db,i=this.name;function a(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof ki&&((function(g,y){if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");function S(){this.constructor=g}o(g,y),g.prototype=y===null?Object.create(y):(S.prototype=y.prototype,new S)})(a,t=e),Object.defineProperty(a.prototype,"db",{get:function(){return r},enumerable:!1,configurable:!0}),a.prototype.table=function(){return i},e=a);for(var l=new Set,f=e.prototype;f;f=k(f))Object.getOwnPropertyNames(f).forEach(function(g){return l.add(g)});function v(g){if(!g)return g;var y,S=Object.create(e.prototype);for(y in g)if(!l.has(y))try{S[y]=g[y]}catch{}return S}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=v,this.hook("reading",v),e},Ye.prototype.defineClass=function(){return this.mapToClass(function(e){T(this,e)})},Ye.prototype.add=function(e,t){var r=this,i=this.schema.primKey,a=i.auto,l=i.keyPath,f=e;return l&&a&&(f=Zn(l)(e)),this._trans("readwrite",function(v){return r.core.mutate({trans:v,type:"add",keys:t!=null?[t]:null,values:[f]})}).then(function(v){return v.numFailures?re.reject(v.failures[0]):v.lastResult}).then(function(v){if(l)try{ce(e,l,v)}catch{}return v})},Ye.prototype.upsert=function(e,t){var r=this,i=this.schema.primKey.keyPath;return this._trans("readwrite",function(a){return r.core.get({trans:a,key:e}).then(function(l){var f=l??{};return Pi(f,t),i&&ce(f,i,e),r.core.mutate({trans:a,type:"put",values:[f],keys:[e],upsert:!0,updates:{keys:[e],changeSpecs:[t]}}).then(function(v){return v.numFailures?re.reject(v.failures[0]):!!l})})})},Ye.prototype.update=function(e,t){return typeof e!="object"||m(e)?this.where(":id").equals(e).modify(t):(e=te(e,this.schema.primKey.keyPath),e===void 0?st(new ne.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},Ye.prototype.put=function(e,t){var r=this,i=this.schema.primKey,a=i.auto,l=i.keyPath,f=e;return l&&a&&(f=Zn(l)(e)),this._trans("readwrite",function(v){return r.core.mutate({trans:v,type:"put",values:[f],keys:t!=null?[t]:null})}).then(function(v){return v.numFailures?re.reject(v.failures[0]):v.lastResult}).then(function(v){if(l)try{ce(e,l,v)}catch{}return v})},Ye.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:[e]}).then(function(i){return er(t,[e],i)}).then(function(i){return i.numFailures?re.reject(i.failures[0]):void 0})})},Ye.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Ci}).then(function(r){return er(e,null,r)})}).then(function(t){return t.numFailures?re.reject(t.failures[0]):void 0})},Ye.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(r){return t.core.getMany({keys:e,trans:r}).then(function(i){return i.map(function(a){return t.hook.reading.fire(a)})})})},Ye.prototype.bulkAdd=function(e,t,r){var i=this,a=Array.isArray(t)?t:void 0,l=(r=r||(a?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",function(f){var y=i.schema.primKey,v=y.auto,y=y.keyPath;if(y&&a)throw new ne.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new ne.InvalidArgument("Arguments objects and keys must have the same length");var g=e.length,y=y&&v?e.map(Zn(y)):e;return i.core.mutate({trans:f,type:"add",keys:a,values:y,wantResults:l}).then(function(w){var p=w.numFailures,I=w.results,b=w.lastResult,w=w.failures;if(p===0)return l?I:b;throw new Ce("".concat(i.name,".bulkAdd(): ").concat(p," of ").concat(g," operations failed"),w)})})},Ye.prototype.bulkPut=function(e,t,r){var i=this,a=Array.isArray(t)?t:void 0,l=(r=r||(a?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",function(f){var y=i.schema.primKey,v=y.auto,y=y.keyPath;if(y&&a)throw new ne.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new ne.InvalidArgument("Arguments objects and keys must have the same length");var g=e.length,y=y&&v?e.map(Zn(y)):e;return i.core.mutate({trans:f,type:"put",keys:a,values:y,wantResults:l}).then(function(w){var p=w.numFailures,I=w.results,b=w.lastResult,w=w.failures;if(p===0)return l?I:b;throw new Ce("".concat(i.name,".bulkPut(): ").concat(p," of ").concat(g," operations failed"),w)})})},Ye.prototype.bulkUpdate=function(e){var t=this,r=this.core,i=e.map(function(f){return f.key}),a=e.map(function(f){return f.changes}),l=[];return this._trans("readwrite",function(f){return r.getMany({trans:f,keys:i,cache:"clone"}).then(function(v){var g=[],y=[];e.forEach(function(p,I){var b=p.key,w=p.changes,_=v[I];if(_){for(var C=0,O=Object.keys(w);C<O.length;C++){var P=O[C],L=w[P];if(P===t.schema.primKey.keyPath){if(Me(L,b)!==0)throw new ne.Constraint("Cannot update primary key in bulkUpdate()")}else ce(_,P,L)}l.push(I),g.push(b),y.push(_)}});var S=g.length;return r.mutate({trans:f,type:"put",keys:g,values:y,updates:{keys:i,changeSpecs:a}}).then(function(p){var I=p.numFailures,b=p.failures;if(I===0)return S;for(var w=0,_=Object.keys(b);w<_.length;w++){var C,O=_[w],P=l[Number(O)];P!=null&&(C=b[O],delete b[O],b[P]=C)}throw new Ce("".concat(t.name,".bulkUpdate(): ").concat(I," of ").concat(S," operations failed"),b)})})})},Ye.prototype.bulkDelete=function(e){var t=this,r=e.length;return this._trans("readwrite",function(i){return t.core.mutate({trans:i,type:"delete",keys:e}).then(function(a){return er(t,e,a)})}).then(function(f){var a=f.numFailures,l=f.lastResult,f=f.failures;if(a===0)return l;throw new Ce("".concat(t.name,".bulkDelete(): ").concat(a," of ").concat(r," operations failed"),f)})},Ye);function Ye(){}function Mn(e){function t(f,v){if(v){for(var g=arguments.length,y=new Array(g-1);--g;)y[g-1]=arguments[g];return r[f].subscribe.apply(null,y),e}if(typeof f=="string")return r[f]}var r={};t.addEventType=l;for(var i=1,a=arguments.length;i<a;++i)l(arguments[i]);return t;function l(f,v,g){if(typeof f!="object"){var y;v=v||Ve;var S={subscribers:[],fire:g=g||be,subscribe:function(p){S.subscribers.indexOf(p)===-1&&(S.subscribers.push(p),S.fire=v(S.fire,p))},unsubscribe:function(p){S.subscribers=S.subscribers.filter(function(I){return I!==p}),S.fire=S.subscribers.reduce(v,g)}};return r[f]=t[f]=S}d(y=f).forEach(function(p){var I=y[p];if(m(I))l(p,y[p][0],y[p][1]);else{if(I!=="asap")throw new ne.InvalidArgument("Invalid event config");var b=l(p,Ue,function(){for(var w=arguments.length,_=new Array(w);w--;)_[w]=arguments[w];b.subscribers.forEach(function(C){ve(function(){C.apply(null,_)})})})}})}}function Nn(e,t){return M(t).from({prototype:e}),t}function bn(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function jr(e,t){e.filter=sn(e.filter,t)}function zr(e,t,r){var i=e.replayFilter;e.replayFilter=i?function(){return sn(i(),t())}:t,e.justLimit=r&&!i}function tr(e,t){if(e.isPrimKey)return t.primaryKey;var r=t.getIndexByKeyPath(e.index);if(!r)throw new ne.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function Ei(e,t,r){var i=tr(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:i,range:e.range}})}function nr(e,t,r,i){var a=e.replayFilter?sn(e.filter,e.replayFilter()):e.filter;if(e.or){var l={},f=function(v,g,y){var S,p;a&&!a(g,y,function(I){return g.stop(I)},function(I){return g.fail(I)})||((p=""+(S=g.primaryKey))=="[object ArrayBuffer]"&&(p=""+new Uint8Array(S)),D(l,p)||(l[p]=!0,t(v,g,y)))};return Promise.all([e.or._iterate(f,r),Fi(Ei(e,i,r),e.algorithm,f,!e.keysOnly&&e.valueMapper)])}return Fi(Ei(e,i,r),sn(e.algorithm,a),t,!e.keysOnly&&e.valueMapper)}function Fi(e,t,r,i){var a=nt(i?function(l,f,v){return r(i(l),f,v)}:r);return e.then(function(l){if(l)return l.start(function(){var f=function(){return l.continue()};t&&!t(l,function(v){return f=v},function(v){l.stop(v),f=be},function(v){l.fail(v),f=be})||a(l.value,l,function(v){return f=v}),f()})})}var Ra=(ze.prototype._read=function(e,t){var r=this._ctx;return r.error?r.table._trans(null,st.bind(null,r.error)):r.table._trans("readonly",e).then(t)},ze.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,st.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},ze.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=sn(t.algorithm,e)},ze.prototype._iterate=function(e,t){return nr(this._ctx,e,t,this._ctx.table.core)},ze.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&T(r,e),t._ctx=r,t},ze.prototype.raw=function(){return this._ctx.valueMapper=null,this},ze.prototype.each=function(e){var t=this._ctx;return this._read(function(r){return nr(t,e,r,t.table.core)})},ze.prototype.count=function(e){var t=this;return this._read(function(r){var i=t._ctx,a=i.table.core;if(bn(i,!0))return a.count({trans:r,query:{index:tr(i,a.schema),range:i.range}}).then(function(f){return Math.min(f,i.limit)});var l=0;return nr(i,function(){return++l,!1},r,a).then(function(){return l})}).then(e)},ze.prototype.sortBy=function(e,t){var r=e.split(".").reverse(),i=r[0],a=r.length-1;function l(g,y){return y?l(g[r[y]],y-1):g[i]}var f=this._ctx.dir==="next"?1:-1;function v(g,y){return Me(l(g,a),l(y,a))*f}return this.toArray(function(g){return g.sort(v)}).then(t)},ze.prototype.toArray=function(e){var t=this;return this._read(function(r){var i=t._ctx;if(i.dir==="next"&&bn(i,!0)&&0<i.limit){var a=i.valueMapper,l=tr(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:l,range:i.range}}).then(function(v){return v=v.result,a?v.map(a):v})}var f=[];return nr(i,function(v){return f.push(v)},r,i.table.core).then(function(){return f})},e)},ze.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,bn(t)?zr(t,function(){var r=e;return function(i,a){return r===0||(r===1?--r:a(function(){i.advance(r),r=0}),!1)}}):zr(t,function(){var r=e;return function(){return--r<0}})),this},ze.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),zr(this._ctx,function(){var t=e;return function(r,i,a){return--t<=0&&i(a),0<=t}},!0),this},ze.prototype.until=function(e,t){return jr(this._ctx,function(r,i,a){return!e(r.value)||(i(a),t)}),this},ze.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},ze.prototype.last=function(e){return this.reverse().first(e)},ze.prototype.filter=function(e){var t;return jr(this._ctx,function(r){return e(r.value)}),(t=this._ctx).isMatch=sn(t.isMatch,e),this},ze.prototype.and=function(e){return this.filter(e)},ze.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},ze.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ze.prototype.desc=function(){return this.reverse()},ze.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,i){e(i.key,i)})},ze.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},ze.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,i){e(i.primaryKey,i)})},ze.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var r=[];return this.each(function(i,a){r.push(a.key)}).then(function(){return r}).then(e)},ze.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&bn(t,!0)&&0<t.limit)return this._read(function(i){var a=tr(t,t.table.core.schema);return t.table.core.query({trans:i,values:!1,limit:t.limit,query:{index:a,range:t.range}})}).then(function(i){return i.result}).then(e);t.keysOnly=!t.isMatch;var r=[];return this.each(function(i,a){r.push(a.primaryKey)}).then(function(){return r}).then(e)},ze.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},ze.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},ze.prototype.lastKey=function(e){return this.reverse().firstKey(e)},ze.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return jr(this._ctx,function(a){var i=a.primaryKey.toString(),a=D(t,i);return t[i]=!0,!a}),this},ze.prototype.modify=function(e){var t=this,r=this._ctx;return this._write(function(i){var a=typeof e=="function"?e:function(_){return Pi(_,e)},l=r.table.core,y=l.schema.primaryKey,f=y.outbound,v=y.extractKey,g=200,y=t.db._options.modifyChunkSize;y&&(g=typeof y=="object"?y[l.name]||y["*"]||200:y);function S(_,P){var O=P.failures,P=P.numFailures;I+=_-P;for(var L=0,R=d(O);L<R.length;L++){var q=R[L];p.push(O[q])}}var p=[],I=0,b=[],w=e===Di;return t.clone().primaryKeys().then(function(_){function C(P){var L=Math.min(g,_.length-P),R=_.slice(P,P+L);return(w?Promise.resolve([]):l.getMany({trans:i,keys:R,cache:"immutable"})).then(function(q){var Z=[],K=[],W=f?[]:null,ee=w?R:[];if(!w)for(var J=0;J<L;++J){var oe=q[J],Oe={value:ue(oe),primKey:_[P+J]};a.call(Oe,Oe.value,Oe)!==!1&&(Oe.value==null?ee.push(_[P+J]):f||Me(v(oe),v(Oe.value))===0?(K.push(Oe.value),f&&W.push(_[P+J])):(ee.push(_[P+J]),Z.push(Oe.value)))}return Promise.resolve(0<Z.length&&l.mutate({trans:i,type:"add",values:Z}).then(function(Pe){for(var Te in Pe.failures)ee.splice(parseInt(Te),1);S(Z.length,Pe)})).then(function(){return(0<K.length||O&&typeof e=="object")&&l.mutate({trans:i,type:"put",keys:W,values:K,criteria:O,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<P}).then(function(Pe){return S(K.length,Pe)})}).then(function(){return(0<ee.length||O&&w)&&l.mutate({trans:i,type:"delete",keys:ee,criteria:O,isAdditionalChunk:0<P}).then(function(Pe){return er(r.table,ee,Pe)}).then(function(Pe){return S(ee.length,Pe)})}).then(function(){return _.length>P+L&&C(P+g)})})}var O=bn(r)&&r.limit===1/0&&(typeof e!="function"||w)&&{index:r.index,range:r.range};return C(0).then(function(){if(0<p.length)throw new ye("Error modifying one or more objects",p,I,b);return _.length})})})},ze.prototype.delete=function(){var e=this._ctx,t=e.range;return!bn(e)||e.table.schema.yProps||!e.isPrimKey&&t.type!==3?this.modify(Di):this._write(function(r){var i=e.table.core.schema.primaryKey,a=t;return e.table.core.count({trans:r,query:{index:i,range:a}}).then(function(l){return e.table.core.mutate({trans:r,type:"deleteRange",range:a}).then(function(g){var v=g.failures,g=g.numFailures;if(g)throw new ye("Could not delete some values",Object.keys(v).map(function(y){return v[y]}),l-g);return l-g})})})},ze);function ze(){}var Di=function(e,t){return t.value=null};function Ha(e,t){return e<t?-1:e===t?0:1}function ja(e,t){return t<e?-1:e===t?0:1}function Et(e,t,r){return e=e instanceof Mi?new e.Collection(e):e,e._ctx.error=new(r||TypeError)(t),e}function wn(e){return new e.Collection(e,function(){return Li("")}).limit(0)}function rr(e,t,r,i){var a,l,f,v,g,y,S,p=r.length;if(!r.every(function(w){return typeof w=="string"}))return Et(e,xi);function I(w){a=w==="next"?function(C){return C.toUpperCase()}:function(C){return C.toLowerCase()},l=w==="next"?function(C){return C.toLowerCase()}:function(C){return C.toUpperCase()},f=w==="next"?Ha:ja;var _=r.map(function(C){return{lower:l(C),upper:a(C)}}).sort(function(C,O){return f(C.lower,O.lower)});v=_.map(function(C){return C.upper}),g=_.map(function(C){return C.lower}),S=(y=w)==="next"?"":i}I("next"),e=new e.Collection(e,function(){return Jt(v[0],g[p-1]+i)}),e._ondirectionchange=function(w){I(w)};var b=0;return e._addAlgorithm(function(w,_,C){var O=w.key;if(typeof O!="string")return!1;var P=l(O);if(t(P,g,b))return!0;for(var L=null,R=b;R<p;++R){var q=(function(Z,K,W,ee,J,oe){for(var Oe=Math.min(Z.length,ee.length),Pe=-1,Te=0;Te<Oe;++Te){var Ft=K[Te];if(Ft!==ee[Te])return J(Z[Te],W[Te])<0?Z.substr(0,Te)+W[Te]+W.substr(Te+1):J(Z[Te],ee[Te])<0?Z.substr(0,Te)+ee[Te]+W.substr(Te+1):0<=Pe?Z.substr(0,Pe)+K[Pe]+W.substr(Pe+1):null;J(Z[Te],Ft)<0&&(Pe=Te)}return Oe<ee.length&&oe==="next"?Z+W.substr(Z.length):Oe<Z.length&&oe==="prev"?Z.substr(0,W.length):Pe<0?null:Z.substr(0,Pe)+ee[Pe]+W.substr(Pe+1)})(O,P,v[R],g[R],f,y);q===null&&L===null?b=R+1:(L===null||0<f(L,q))&&(L=q)}return _(L!==null?function(){w.continue(L+S)}:C),!1}),e}function Jt(e,t,r,i){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:i}}function Li(e){return{type:1,lower:e,upper:e}}var Mi=(Object.defineProperty(ft.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),ft.prototype.between=function(e,t,r,i){r=r!==!1,i=i===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(r||i)&&(!r||!i)?wn(this):new this.Collection(this,function(){return Jt(e,t,!r,!i)})}catch{return Et(this,Bt)}},ft.prototype.equals=function(e){return e==null?Et(this,Bt):new this.Collection(this,function(){return Li(e)})},ft.prototype.above=function(e){return e==null?Et(this,Bt):new this.Collection(this,function(){return Jt(e,void 0,!0)})},ft.prototype.aboveOrEqual=function(e){return e==null?Et(this,Bt):new this.Collection(this,function(){return Jt(e,void 0,!1)})},ft.prototype.below=function(e){return e==null?Et(this,Bt):new this.Collection(this,function(){return Jt(void 0,e,!1,!0)})},ft.prototype.belowOrEqual=function(e){return e==null?Et(this,Bt):new this.Collection(this,function(){return Jt(void 0,e)})},ft.prototype.startsWith=function(e){return typeof e!="string"?Et(this,xi):this.between(e,e+on,!0,!0)},ft.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):rr(this,function(t,r){return t.indexOf(r[0])===0},[e],on)},ft.prototype.equalsIgnoreCase=function(e){return rr(this,function(t,r){return t===r[0]},[e],"")},ft.prototype.anyOfIgnoreCase=function(){var e=Fe.apply(pe,arguments);return e.length===0?wn(this):rr(this,function(t,r){return r.indexOf(t)!==-1},e,"")},ft.prototype.startsWithAnyOfIgnoreCase=function(){var e=Fe.apply(pe,arguments);return e.length===0?wn(this):rr(this,function(t,r){return r.some(function(i){return t.indexOf(i)===0})},e,on)},ft.prototype.anyOf=function(){var e=this,t=Fe.apply(pe,arguments),r=this._cmp;try{t.sort(r)}catch{return Et(this,Bt)}if(t.length===0)return wn(this);var i=new this.Collection(this,function(){return Jt(t[0],t[t.length-1])});i._ondirectionchange=function(l){r=l==="next"?e._ascending:e._descending,t.sort(r)};var a=0;return i._addAlgorithm(function(l,f,v){for(var g=l.key;0<r(g,t[a]);)if(++a===t.length)return f(v),!1;return r(g,t[a])===0||(f(function(){l.continue(t[a])}),!1)}),i},ft.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},ft.prototype.noneOf=function(){var e=Fe.apply(pe,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Et(this,Bt)}var t=e.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[-1/0,i]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},ft.prototype.inAnyRange=function(O,t){var r=this,i=this._cmp,a=this._ascending,l=this._descending,f=this._min,v=this._max;if(O.length===0)return wn(this);if(!O.every(function(P){return P[0]!==void 0&&P[1]!==void 0&&a(P[0],P[1])<=0}))return Et(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ne.InvalidArgument);var g=!t||t.includeLowers!==!1,y=t&&t.includeUppers===!0,S,p=a;function I(P,L){return p(P[0],L[0])}try{(S=O.reduce(function(P,L){for(var R=0,q=P.length;R<q;++R){var Z=P[R];if(i(L[0],Z[1])<0&&0<i(L[1],Z[0])){Z[0]=f(Z[0],L[0]),Z[1]=v(Z[1],L[1]);break}}return R===q&&P.push(L),P},[])).sort(I)}catch{return Et(this,Bt)}var b=0,w=y?function(P){return 0<a(P,S[b][1])}:function(P){return 0<=a(P,S[b][1])},_=g?function(P){return 0<l(P,S[b][0])}:function(P){return 0<=l(P,S[b][0])},C=w,O=new this.Collection(this,function(){return Jt(S[0][0],S[S.length-1][1],!g,!y)});return O._ondirectionchange=function(P){p=P==="next"?(C=w,a):(C=_,l),S.sort(I)},O._addAlgorithm(function(P,L,R){for(var q,Z=P.key;C(Z);)if(++b===S.length)return L(R),!1;return!w(q=Z)&&!_(q)||(r._cmp(Z,S[b][1])===0||r._cmp(Z,S[b][0])===0||L(function(){p===a?P.continue(S[b][0]):P.continue(S[b][1])}),!1)}),O},ft.prototype.startsWithAnyOf=function(){var e=Fe.apply(pe,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?wn(this):this.inAnyRange(e.map(function(t){return[t,t+on]})):Et(this,"startsWithAnyOf() only works with strings")},ft);function ft(){}function Rt(e){return nt(function(t){return Rn(t),e(t.target.error),!1})}function Rn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Hn="storagemutated",Kr="x-storagemutated-1",Qt=Mn(null,Hn),za=(Ht.prototype._lock=function(){return Y(!he.global),++this._reculock,this._reculock!==1||he.global||(he.lockOwnerFor=this),this},Ht.prototype._unlock=function(){if(Y(!he.global),--this._reculock==0)for(he.global||(he.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{an(e[1],e[0])}catch{}}return this},Ht.prototype._locked=function(){return this._reculock&&he.lockOwnerFor!==this},Ht.prototype.create=function(e){var t=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(Y(!this.idbtrans),!e&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new ne.DatabaseClosed(i);case"MissingAPIError":throw new ne.MissingAPI(i.message,i);default:throw new ne.OpenFailed(i)}if(!this.active)throw new ne.TransactionInactive;return Y(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||r).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=nt(function(a){Rn(a),t._reject(e.error)}),e.onabort=nt(function(a){Rn(a),t.active&&t._reject(new ne.Abort(e.error)),t.active=!1,t.on("abort").fire(a)}),e.oncomplete=nt(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&Qt.storagemutated.fire(e.mutatedParts)}),this},Ht.prototype._promise=function(e,t,r){var i=this;if(e==="readwrite"&&this.mode!=="readwrite")return st(new ne.ReadOnly("Transaction is readonly"));if(!this.active)return st(new ne.TransactionInactive);if(this._locked())return new re(function(l,f){i._blockedFuncs.push([function(){i._promise(e,t,r).then(l,f)},he])});if(r)return Gt(function(){var l=new re(function(f,v){i._lock();var g=t(f,v,i);g&&g.then&&g.then(f,v)});return l.finally(function(){return i._unlock()}),l._lib=!0,l});var a=new re(function(l,f){var v=t(l,f,i);v&&v.then&&v.then(l,f)});return a._lib=!0,a},Ht.prototype._root=function(){return this.parent?this.parent._root():this},Ht.prototype.waitFor=function(e){var t,r=this._root(),i=re.resolve(e);r._waitingFor?r._waitingFor=r._waitingFor.then(function(){return i}):(r._waitingFor=i,r._waitingQueue=[],t=r.idbtrans.objectStore(r.storeNames[0]),(function l(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(t.get(-1/0).onsuccess=l)})());var a=r._waitingFor;return new re(function(l,f){i.then(function(v){return r._waitingQueue.push(nt(l.bind(null,v)))},function(v){return r._waitingQueue.push(nt(f.bind(null,v)))}).finally(function(){r._waitingFor===a&&(r._waitingFor=null)})})},Ht.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ne.Abort))},Ht.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(D(t,e))return t[e];var r=this.schema[e];if(!r)throw new ne.NotFound("Table "+e+" not part of transaction");return r=new this.db.Table(e,r,this),r.core=this.db.core.table(e),t[e]=r},Ht);function Ht(){}function Vr(e,t,r,i,a,l,f,v){return{name:e,keyPath:t,unique:r,multi:i,auto:a,compound:l,src:(r&&!f?"&":"")+(i?"*":"")+(a?"++":"")+Ni(t),type:v}}function Ni(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function Br(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:(i=function(a){return[a.name,a]},r.reduce(function(a,l,f){return f=i(l,f),f&&(a[f[0]]=f[1]),a},{}))};var i}var jn=function(e){try{return e.only([[]]),jn=function(){return[[]]},[[]]}catch{return jn=function(){return on},on}};function qr(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(r){return r[t]}:function(r){return te(r,t)}:function(r){return te(r,e)};var t}function Ri(e){return[].slice.call(e)}var Ka=0;function zn(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Va(e,t,g){function i(C){if(C.type===3)return null;if(C.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var b=C.lower,w=C.upper,_=C.lowerOpen,C=C.upperOpen;return b===void 0?w===void 0?null:t.upperBound(w,!!C):w===void 0?t.lowerBound(b,!!_):t.bound(b,w,!!_,!!C)}function a(I){var b,w=I.name;return{name:w,schema:I,mutate:function(_){var C=_.trans,O=_.type,P=_.keys,L=_.values,R=_.range;return new Promise(function(q,Z){q=nt(q);var K=C.objectStore(w),W=K.keyPath==null,ee=O==="put"||O==="add";if(!ee&&O!=="delete"&&O!=="deleteRange")throw new Error("Invalid operation type: "+O);var J,oe=(P||L||{length:1}).length;if(P&&L&&P.length!==L.length)throw new Error("Given keys array must have same length as given values array.");if(oe===0)return q({numFailures:0,failures:{},results:[],lastResult:void 0});function Oe(Ct){++Ft,Rn(Ct)}var Pe=[],Te=[],Ft=0;if(O==="deleteRange"){if(R.type===4)return q({numFailures:Ft,failures:Te,results:[],lastResult:void 0});R.type===3?Pe.push(J=K.clear()):Pe.push(J=K.delete(i(R)))}else{var W=ee?W?[L,P]:[L,null]:[P,null],Ie=W[0],yt=W[1];if(ee)for(var bt=0;bt<oe;++bt)Pe.push(J=yt&&yt[bt]!==void 0?K[O](Ie[bt],yt[bt]):K[O](Ie[bt])),J.onerror=Oe;else for(bt=0;bt<oe;++bt)Pe.push(J=K[O](Ie[bt])),J.onerror=Oe}function pr(Ct){Ct=Ct.target.result,Pe.forEach(function(cn,li){return cn.error!=null&&(Te[li]=cn.error)}),q({numFailures:Ft,failures:Te,results:O==="delete"?P:Pe.map(function(cn){return cn.result}),lastResult:Ct})}J.onerror=function(Ct){Oe(Ct),pr(Ct)},J.onsuccess=pr})},getMany:function(_){var C=_.trans,O=_.keys;return new Promise(function(P,L){P=nt(P);for(var R,q=C.objectStore(w),Z=O.length,K=new Array(Z),W=0,ee=0,J=function(Pe){Pe=Pe.target,K[Pe._pos]=Pe.result,++ee===W&&P(K)},oe=Rt(L),Oe=0;Oe<Z;++Oe)O[Oe]!=null&&((R=q.get(O[Oe]))._pos=Oe,R.onsuccess=J,R.onerror=oe,++W);W===0&&P(K)})},get:function(_){var C=_.trans,O=_.key;return new Promise(function(P,L){P=nt(P);var R=C.objectStore(w).get(O);R.onsuccess=function(q){return P(q.target.result)},R.onerror=Rt(L)})},query:(b=y,function(_){return new Promise(function(C,O){C=nt(C);var P,L,R,W=_.trans,q=_.values,Z=_.limit,J=_.query,K=Z===1/0?void 0:Z,ee=J.index,J=J.range,W=W.objectStore(w),ee=ee.isPrimaryKey?W:W.index(ee.name),J=i(J);if(Z===0)return C({result:[]});b?((K=q?ee.getAll(J,K):ee.getAllKeys(J,K)).onsuccess=function(oe){return C({result:oe.target.result})},K.onerror=Rt(O)):(P=0,L=!q&&"openKeyCursor"in ee?ee.openKeyCursor(J):ee.openCursor(J),R=[],L.onsuccess=function(oe){var Oe=L.result;return Oe?(R.push(q?Oe.value:Oe.primaryKey),++P===Z?C({result:R}):void Oe.continue()):C({result:R})},L.onerror=Rt(O))})}),openCursor:function(_){var C=_.trans,O=_.values,P=_.query,L=_.reverse,R=_.unique;return new Promise(function(q,Z){q=nt(q);var ee=P.index,K=P.range,W=C.objectStore(w),W=ee.isPrimaryKey?W:W.index(ee.name),ee=L?R?"prevunique":"prev":R?"nextunique":"next",J=!O&&"openKeyCursor"in W?W.openKeyCursor(i(K),ee):W.openCursor(i(K),ee);J.onerror=Rt(Z),J.onsuccess=nt(function(oe){var Oe,Pe,Te,Ft,Ie=J.result;Ie?(Ie.___id=++Ka,Ie.done=!1,Oe=Ie.continue.bind(Ie),Pe=(Pe=Ie.continuePrimaryKey)&&Pe.bind(Ie),Te=Ie.advance.bind(Ie),Ft=function(){throw new Error("Cursor not stopped")},Ie.trans=C,Ie.stop=Ie.continue=Ie.continuePrimaryKey=Ie.advance=function(){throw new Error("Cursor not started")},Ie.fail=nt(Z),Ie.next=function(){var yt=this,bt=1;return this.start(function(){return bt--?yt.continue():yt.stop()}).then(function(){return yt})},Ie.start=function(yt){function bt(){if(J.result)try{yt()}catch(Ct){Ie.fail(Ct)}else Ie.done=!0,Ie.start=function(){throw new Error("Cursor behind last entry")},Ie.stop()}var pr=new Promise(function(Ct,cn){Ct=nt(Ct),J.onerror=Rt(cn),Ie.fail=cn,Ie.stop=function(li){Ie.stop=Ie.continue=Ie.continuePrimaryKey=Ie.advance=Ft,Ct(li)}});return J.onsuccess=nt(function(Ct){J.onsuccess=bt,bt()}),Ie.continue=Oe,Ie.continuePrimaryKey=Pe,Ie.advance=Te,bt(),pr},q(Ie)):q(null)},Z)})},count:function(_){var C=_.query,O=_.trans,P=C.index,L=C.range;return new Promise(function(R,q){var Z=O.objectStore(w),K=P.isPrimaryKey?Z:Z.index(P.name),Z=i(L),K=Z?K.count(Z):K.count();K.onsuccess=nt(function(W){return R(W.target.result)}),K.onerror=Rt(q)})}}}var l,f,v,S=(f=g,v=Ri((l=e).objectStoreNames),{schema:{name:l.name,tables:v.map(function(I){return f.objectStore(I)}).map(function(I){var b=I.keyPath,C=I.autoIncrement,w=m(b),_={},C={name:I.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:b==null,compound:w,keyPath:b,autoIncrement:C,unique:!0,extractKey:qr(b)},indexes:Ri(I.indexNames).map(function(O){return I.index(O)}).map(function(R){var P=R.name,L=R.unique,q=R.multiEntry,R=R.keyPath,q={name:P,compound:m(R),keyPath:R,unique:L,multiEntry:q,extractKey:qr(R)};return _[zn(R)]=q}),getIndexByKeyPath:function(O){return _[zn(O)]}};return _[":id"]=C.primaryKey,b!=null&&(_[zn(b)]=C.primaryKey),C})},hasGetAll:0<v.length&&"getAll"in f.objectStore(v[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),g=S.schema,y=S.hasGetAll,S=g.tables.map(a),p={};return S.forEach(function(I){return p[I.name]=I}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(I){if(!p[I])throw new Error("Table '".concat(I,"' not found"));return p[I]},MIN_KEY:-1/0,MAX_KEY:jn(t),schema:g}}function Ba(e,t,r,i){var a=r.IDBKeyRange;return r.indexedDB,{dbcore:(i=Va(t,a,i),e.dbcore.reduce(function(l,f){return f=f.create,s(s({},l),f(l))},i))}}function ir(e,i){var r=i.db,i=Ba(e._middlewares,r,e._deps,i);e.core=i.dbcore,e.tables.forEach(function(a){var l=a.name;e.core.schema.tables.some(function(f){return f.name===l})&&(a.core=e.core.table(l),e[l]instanceof e.Table&&(e[l].core=a.core))})}function ar(e,t,r,i){r.forEach(function(a){var l=i[a];t.forEach(function(f){var v=(function g(y,S){return H(y,S)||(y=k(y))&&g(y,S)})(f,a);(!v||"value"in v&&v.value===void 0)&&(f===e.Transaction.prototype||f instanceof e.Transaction?N(f,a,{get:function(){return this.table(a)},set:function(g){G(this,a,{value:g,writable:!0,configurable:!0,enumerable:!0})}}):f[a]=new e.Table(a,l))})})}function $r(e,t){t.forEach(function(r){for(var i in r)r[i]instanceof e.Table&&delete r[i]})}function qa(e,t){return e._cfg.version-t._cfg.version}function $a(e,t,r,i){var a=e._dbSchema;r.objectStoreNames.contains("$meta")&&!a.$meta&&(a.$meta=Br("$meta",ji("")[0],[]),e._storeNames.push("$meta"));var l=e._createTransaction("readwrite",e._storeNames,a);l.create(r),l._completion.catch(i);var f=l._reject.bind(l),v=he.transless||he;Gt(function(){return he.trans=l,he.transless=v,t!==0?(ir(e,r),y=t,((g=l).storeNames.includes("$meta")?g.table("$meta").get("version").then(function(S){return S??y}):re.resolve(y)).then(function(S){return I=S,b=l,w=r,_=[],S=(p=e)._versions,C=p._dbSchema=sr(0,p.idbdb,w),(S=S.filter(function(O){return O._cfg.version>=I})).length!==0?(S.forEach(function(O){_.push(function(){var P=C,L=O._cfg.dbschema;lr(p,P,w),lr(p,L,w),C=p._dbSchema=L;var R=Ur(P,L);R.add.forEach(function(ee){Gr(w,ee[0],ee[1].primKey,ee[1].indexes)}),R.change.forEach(function(ee){if(ee.recreate)throw new ne.Upgrade("Not yet support for changing primary key");var J=w.objectStore(ee.name);ee.add.forEach(function(oe){return or(J,oe)}),ee.change.forEach(function(oe){J.deleteIndex(oe.name),or(J,oe)}),ee.del.forEach(function(oe){return J.deleteIndex(oe)})});var q=O._cfg.contentUpgrade;if(q&&O._cfg.version>I){ir(p,w),b._memoizedTables={};var Z=_e(L);R.del.forEach(function(ee){Z[ee]=P[ee]}),$r(p,[p.Transaction.prototype]),ar(p,[p.Transaction.prototype],d(Z),Z),b.schema=Z;var K,W=Xe(q);return W&&mn(),R=re.follow(function(){var ee;(K=q(b))&&W&&(ee=Wt.bind(null,null),K.then(ee,ee))}),K&&typeof K.then=="function"?re.resolve(K):R.then(function(){return K})}}),_.push(function(P){var L,R,q=O._cfg.dbschema;L=q,R=P,[].slice.call(R.db.objectStoreNames).forEach(function(Z){return L[Z]==null&&R.db.deleteObjectStore(Z)}),$r(p,[p.Transaction.prototype]),ar(p,[p.Transaction.prototype],p._storeNames,p._dbSchema),b.schema=p._dbSchema}),_.push(function(P){p.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(p.idbdb.version/10)===O._cfg.version?(p.idbdb.deleteObjectStore("$meta"),delete p._dbSchema.$meta,p._storeNames=p._storeNames.filter(function(L){return L!=="$meta"})):P.objectStore("$meta").put(O._cfg.version,"version"))})}),(function O(){return _.length?re.resolve(_.shift()(b.idbtrans)).then(O):re.resolve()})().then(function(){Hi(C,w)})):re.resolve();var p,I,b,w,_,C}).catch(f)):(d(a).forEach(function(S){Gr(r,S,a[S].primKey,a[S].indexes)}),ir(e,r),void re.follow(function(){return e.on.populate.fire(l)}).catch(f));var g,y})}function Ua(e,t){Hi(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var r=sr(0,e.idbdb,t);lr(e,e._dbSchema,t);for(var i=0,a=Ur(r,e._dbSchema).change;i<a.length;i++){var l=(function(f){if(f.change.length||f.recreate)return console.warn("Unable to patch indexes of table ".concat(f.name," because it has changes on the type of index or primary key.")),{value:void 0};var v=t.objectStore(f.name);f.add.forEach(function(g){Ke&&console.debug("Dexie upgrade patch: Creating missing index ".concat(f.name,".").concat(g.src)),or(v,g)})})(a[i]);if(typeof l=="object")return l.value}}function Ur(e,t){var r,i={del:[],add:[],change:[]};for(r in e)t[r]||i.del.push(r);for(r in t){var a=e[r],l=t[r];if(a){var f={name:r,def:l,recreate:!1,del:[],add:[],change:[]};if(""+(a.primKey.keyPath||"")!=""+(l.primKey.keyPath||"")||a.primKey.auto!==l.primKey.auto)f.recreate=!0,i.change.push(f);else{var v=a.idxByName,g=l.idxByName,y=void 0;for(y in v)g[y]||f.del.push(y);for(y in g){var S=v[y],p=g[y];S?S.src!==p.src&&f.change.push(p):f.add.push(p)}(0<f.del.length||0<f.add.length||0<f.change.length)&&i.change.push(f)}}else i.add.push([r,l])}return i}function Gr(e,t,r,i){var a=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return i.forEach(function(l){return or(a,l)}),a}function Hi(e,t){d(e).forEach(function(r){t.db.objectStoreNames.contains(r)||(Ke&&console.debug("Dexie: Creating missing table",r),Gr(t,r,e[r].primKey,e[r].indexes))})}function or(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function sr(e,t,r){var i={};return B(t.objectStoreNames,0).forEach(function(a){for(var l=r.objectStore(a),f=Vr(Ni(y=l.keyPath),y||"",!0,!1,!!l.autoIncrement,y&&typeof y!="string",!0),v=[],g=0;g<l.indexNames.length;++g){var S=l.index(l.indexNames[g]),y=S.keyPath,S=Vr(S.name,y,!!S.unique,!!S.multiEntry,!1,y&&typeof y!="string",!1);v.push(S)}i[a]=Br(a,f,v)}),i}function lr(e,t,r){for(var i=r.db.objectStoreNames,a=0;a<i.length;++a){var l=i[a],f=r.objectStore(l);e._hasGetAll="getAll"in f;for(var v=0;v<f.indexNames.length;++v){var g=f.indexNames[v],y=f.index(g).keyPath,S=typeof y=="string"?y:"["+B(y).join("+")+"]";!t[l]||(y=t[l].idxByName[S])&&(y.name=g,delete t[l].idxByName[S],t[l].idxByName[g]=y)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&h.WorkerGlobalScope&&h instanceof h.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function ji(e){return e.split(",").map(function(t,r){var l=t.split(":"),i=(a=l[1])===null||a===void 0?void 0:a.trim(),a=(t=l[0].trim()).replace(/([&*]|\+\+)/g,""),l=/^\[/.test(a)?a.match(/^\[(.*)\]$/)[1].split("+"):a;return Vr(a,l||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),m(l),r===0,i)})}var Ga=(_n.prototype._createTableSchema=Br,_n.prototype._parseIndexSyntax=ji,_n.prototype._parseStoresSpec=function(e,t){var r=this;d(e).forEach(function(i){if(e[i]!==null){var a=r._parseIndexSyntax(e[i]),l=a.shift();if(!l)throw new ne.Schema("Invalid schema for table "+i+": "+e[i]);if(l.unique=!0,l.multi)throw new ne.Schema("Primary key cannot be multiEntry*");a.forEach(function(f){if(f.auto)throw new ne.Schema("Only primary key can be marked as autoIncrement (++)");if(!f.keyPath)throw new ne.Schema("Index must have a name and cannot be an empty string")}),a=r._createTableSchema(i,l,a),t[i]=a}})},_n.prototype.stores=function(r){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?T(this._cfg.storesSource,r):r;var r=t._versions,i={},a={};return r.forEach(function(l){T(i,l._cfg.storesSource),a=l._cfg.dbschema={},l._parseStoresSpec(i,a)}),t._dbSchema=a,$r(t,[t._allTables,t,t.Transaction.prototype]),ar(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],d(a),a),t._storeNames=d(a),this},_n.prototype.upgrade=function(e){return this._cfg.contentUpgrade=at(this._cfg.contentUpgrade||be,e),this},_n);function _n(){}function Wr(e,t){var r=e._dbNamesDB;return r||(r=e._dbNamesDB=new qt(Xn,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),r.table("dbnames")}function Yr(e){return e&&typeof e.databases=="function"}function Jr(e){return Gt(function(){return he.letThrough=!0,e()})}function Qr(e){return!("from"in e)}var mt=function(e,t){if(!this){var r=new mt;return e&&"d"in e&&T(r,e),r}T(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function Kn(e,t,r){var i=Me(t,r);if(!isNaN(i)){if(0<i)throw RangeError();if(Qr(e))return T(e,{from:t,to:r,d:1});var a=e.l,i=e.r;if(Me(r,e.from)<0)return a?Kn(a,t,r):e.l={from:t,to:r,d:1,l:null,r:null},Ki(e);if(0<Me(t,e.to))return i?Kn(i,t,r):e.r={from:t,to:r,d:1,l:null,r:null},Ki(e);Me(t,e.from)<0&&(e.from=t,e.l=null,e.d=i?i.d+1:1),0<Me(r,e.to)&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1),r=!e.r,a&&!e.l&&Vn(e,a),i&&r&&Vn(e,i)}}function Vn(e,t){Qr(t)||(function r(i,g){var l=g.from,f=g.to,v=g.l,g=g.r;Kn(i,l,f),v&&r(i,v),g&&r(i,g)})(e,t)}function zi(e,t){var r=ur(t),i=r.next();if(i.done)return!1;for(var a=i.value,l=ur(e),f=l.next(a.from),v=f.value;!i.done&&!f.done;){if(Me(v.from,a.to)<=0&&0<=Me(v.to,a.from))return!0;Me(a.from,v.from)<0?a=(i=r.next(v.from)).value:v=(f=l.next(a.from)).value}return!1}function ur(e){var t=Qr(e)?null:{s:0,n:e};return{next:function(r){for(var i=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,i)for(;t.n.l&&Me(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!i||Me(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Ki(e){var t,r,i=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((r=e.l)===null||r===void 0?void 0:r.d)||0),a=1<i?"r":i<-1?"l":"";a&&(t=a=="r"?"l":"r",r=s({},e),i=e[a],e.from=i.from,e.to=i.to,e[a]=i[a],r[a]=i[t],(e[t]=r).d=Vi(r)),e.d=Vi(e)}function Vi(r){var t=r.r,r=r.l;return(t?r?Math.max(t.d,r.d):t.d:r?r.d:0)+1}function cr(e,t){return d(t).forEach(function(r){e[r]?Vn(e[r],t[r]):e[r]=(function i(a){var l,f,v={};for(l in a)D(a,l)&&(f=a[l],v[l]=!f||typeof f!="object"||Se.has(f.constructor)?f:i(f));return v})(t[r])}),e}function Xr(e,t){return e.all||t.all||Object.keys(e).some(function(r){return t[r]&&zi(t[r],e[r])})}E(mt.prototype,((Lt={add:function(e){return Vn(this,e),this},addKey:function(e){return Kn(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(r){return Kn(t,r,r)}),this},hasKey:function(e){var t=ur(this).next(e).value;return t&&Me(t.from,e)<=0&&0<=Me(t.to,e)}})[ae]=function(){return ur(this)},Lt));var ln={},Zr={},ei=!1;function dr(e){cr(Zr,e),ei||(ei=!0,setTimeout(function(){ei=!1,ti(Zr,!(Zr={}))},0))}function ti(e,t){t===void 0&&(t=!1);var r=new Set;if(e.all)for(var i=0,a=Object.values(ln);i<a.length;i++)Bi(f=a[i],e,r,t);else for(var l in e){var f,v=/^idb\:\/\/(.*)\/(.*)\//.exec(l);v&&(l=v[1],v=v[2],(f=ln["idb://".concat(l,"/").concat(v)])&&Bi(f,e,r,t))}r.forEach(function(g){return g()})}function Bi(e,t,r,i){for(var a=[],l=0,f=Object.entries(e.queries.query);l<f.length;l++){for(var v=f[l],g=v[0],y=[],S=0,p=v[1];S<p.length;S++){var I=p[S];Xr(t,I.obsSet)?I.subscribers.forEach(function(C){return r.add(C)}):i&&y.push(I)}i&&a.push([g,y])}if(i)for(var b=0,w=a;b<w.length;b++){var _=w[b],g=_[0],y=_[1];e.queries.query[g]=y}}function Wa(e){var t=e._state,r=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?st(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var i=t.openCanceller,a=Math.round(10*e.verno),l=!1;function f(){if(t.openCanceller!==i)throw new ne.DatabaseClosed("db.open() was cancelled")}function v(){return new re(function(I,b){if(f(),!r)throw new ne.MissingAPI;var w=e.name,_=t.autoSchema||!a?r.open(w):r.open(w,a);if(!_)throw new ne.MissingAPI;_.onerror=Rt(b),_.onblocked=nt(e._fireOnBlocked),_.onupgradeneeded=nt(function(C){var O;S=_.transaction,t.autoSchema&&!e._options.allowEmptyDB?(_.onerror=Rn,S.abort(),_.result.close(),(O=r.deleteDatabase(w)).onsuccess=O.onerror=nt(function(){b(new ne.NoSuchDatabase("Database ".concat(w," doesnt exist")))})):(S.onerror=Rt(b),C=C.oldVersion>Math.pow(2,62)?0:C.oldVersion,p=C<1,e.idbdb=_.result,l&&Ua(e,S),$a(e,C/10,S,b))},b),_.onsuccess=nt(function(){S=null;var C,O,P,L,R,q=e.idbdb=_.result,Z=B(q.objectStoreNames);if(0<Z.length)try{var K=q.transaction((L=Z).length===1?L[0]:L,"readonly");if(t.autoSchema)O=q,P=K,(C=e).verno=O.version/10,P=C._dbSchema=sr(0,O,P),C._storeNames=B(O.objectStoreNames,0),ar(C,[C._allTables],d(P),P);else if(lr(e,e._dbSchema,K),((R=Ur(sr(0,(R=e).idbdb,K),R._dbSchema)).add.length||R.change.some(function(W){return W.add.length||W.change.length}))&&!l)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),q.close(),a=q.version+1,l=!0,I(v());ir(e,K)}catch{}yn.push(e),q.onversionchange=nt(function(W){t.vcFired=!0,e.on("versionchange").fire(W)}),q.onclose=nt(function(){e.close({disableAutoOpen:!1})}),p&&(R=e._deps,K=w,q=R.indexedDB,R=R.IDBKeyRange,Yr(q)||K===Xn||Wr(q,R).put({name:K}).catch(be)),I()},b)}).catch(function(I){switch(I?.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),v();break;case"VersionError":if(0<a)return a=0,v()}return re.reject(I)})}var g,y=t.dbReadyResolve,S=null,p=!1;return re.race([i,(typeof navigator>"u"?re.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(I){function b(){return indexedDB.databases().finally(I)}g=setInterval(b,100),b()}).finally(function(){return clearInterval(g)}):Promise.resolve()).then(v)]).then(function(){return f(),t.onReadyBeingFired=[],re.resolve(Jr(function(){return e.on.ready.fire(e.vip)})).then(function I(){if(0<t.onReadyBeingFired.length){var b=t.onReadyBeingFired.reduce(at,be);return t.onReadyBeingFired=[],re.resolve(Jr(function(){return b(e.vip)})).then(I)}})}).finally(function(){t.openCanceller===i&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(I){t.dbOpenError=I;try{S&&S.abort()}catch{}return i===t.openCanceller&&e._close(),st(I)}).finally(function(){t.openComplete=!0,y()}).then(function(){var I;return p&&(I={},e.tables.forEach(function(b){b.schema.indexes.forEach(function(w){w.name&&(I["idb://".concat(e.name,"/").concat(b.name,"/").concat(w.name)]=new mt(-1/0,[[[]]]))}),I["idb://".concat(e.name,"/").concat(b.name,"/")]=I["idb://".concat(e.name,"/").concat(b.name,"/:dels")]=new mt(-1/0,[[[]]])}),Qt(Hn).fire(I),ti(I,!0)),e})}function ni(e){function t(l){return e.next(l)}var r=a(t),i=a(function(l){return e.throw(l)});function a(l){return function(g){var v=l(g),g=v.value;return v.done?g:g&&typeof g.then=="function"?g.then(r,i):m(g)?Promise.all(g).then(r,i):r(g)}}return a(t)()}function fr(e,t,r){for(var i=m(e)?e.slice():[e],a=0;a<r;++a)i.push(t);return i}var Ya={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return s(s({},e),{table:function(t){var r=e.table(t),i=r.schema,a={},l=[];function f(p,I,b){var w=zn(p),_=a[w]=a[w]||[],C=p==null?0:typeof p=="string"?1:p.length,O=0<I,O=s(s({},b),{name:O?"".concat(w,"(virtual-from:").concat(b.name,")"):b.name,lowLevelIndex:b,isVirtual:O,keyTail:I,keyLength:C,extractKey:qr(p),unique:!O&&b.unique});return _.push(O),O.isPrimaryKey||l.push(O),1<C&&f(C===2?p[0]:p.slice(0,C-1),I+1,b),_.sort(function(P,L){return P.keyTail-L.keyTail}),O}t=f(i.primaryKey.keyPath,0,i.primaryKey),a[":id"]=[t];for(var v=0,g=i.indexes;v<g.length;v++){var y=g[v];f(y.keyPath,0,y)}function S(p){var I,b=p.query.index;return b.isVirtual?s(s({},p),{query:{index:b.lowLevelIndex,range:(I=p.query.range,b=b.keyTail,{type:I.type===1?2:I.type,lower:fr(I.lower,I.lowerOpen?e.MAX_KEY:e.MIN_KEY,b),lowerOpen:!0,upper:fr(I.upper,I.upperOpen?e.MIN_KEY:e.MAX_KEY,b),upperOpen:!0})}}):p}return s(s({},r),{schema:s(s({},i),{primaryKey:t,indexes:l,getIndexByKeyPath:function(p){return(p=a[zn(p)])&&p[0]}}),count:function(p){return r.count(S(p))},query:function(p){return r.query(S(p))},openCursor:function(p){var I=p.query.index,b=I.keyTail,w=I.isVirtual,_=I.keyLength;return w?r.openCursor(S(p)).then(function(O){return O&&C(O)}):r.openCursor(p);function C(O){return Object.create(O,{continue:{value:function(P){P!=null?O.continue(fr(P,p.reverse?e.MAX_KEY:e.MIN_KEY,b)):p.unique?O.continue(O.key.slice(0,_).concat(p.reverse?e.MIN_KEY:e.MAX_KEY,b)):O.continue()}},continuePrimaryKey:{value:function(P,L){O.continuePrimaryKey(fr(P,e.MAX_KEY,b),L)}},primaryKey:{get:function(){return O.primaryKey}},key:{get:function(){var P=O.key;return _===1?P[0]:P.slice(0,_)}},value:{get:function(){return O.value}}})}}})}})}};function ri(e,t,r,i){return r=r||{},i=i||"",d(e).forEach(function(a){var l,f,v;D(t,a)?(l=e[a],f=t[a],typeof l=="object"&&typeof f=="object"&&l&&f?(v=Le(l))!==Le(f)?r[i+a]=t[a]:v==="Object"?ri(l,f,r,i+a+"."):l!==f&&(r[i+a]=t[a]):l!==f&&(r[i+a]=t[a])):r[i+a]=void 0}),d(t).forEach(function(a){D(e,a)||(r[i+a]=t[a])}),r}function ii(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Ja={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return s(s({},e),{table:function(t){var r=e.table(t),i=r.schema.primaryKey;return s(s({},r),{mutate:function(a){var l=he.trans,f=l.table(t).hook,v=f.deleting,g=f.creating,y=f.updating;switch(a.type){case"add":if(g.fire===be)break;return l._promise("readwrite",function(){return S(a)},!0);case"put":if(g.fire===be&&y.fire===be)break;return l._promise("readwrite",function(){return S(a)},!0);case"delete":if(v.fire===be)break;return l._promise("readwrite",function(){return S(a)},!0);case"deleteRange":if(v.fire===be)break;return l._promise("readwrite",function(){return(function p(I,b,w){return r.query({trans:I,values:!1,query:{index:i,range:b},limit:w}).then(function(_){var C=_.result;return S({type:"delete",keys:C,trans:I}).then(function(O){return 0<O.numFailures?Promise.reject(O.failures[0]):C.length<w?{failures:[],numFailures:0,lastResult:void 0}:p(I,s(s({},b),{lower:C[C.length-1],lowerOpen:!0}),w)})})})(a.trans,a.range,1e4)},!0)}return r.mutate(a);function S(p){var I,b,w,_=he.trans,C=p.keys||ii(i,p);if(!C)throw new Error("Keys missing");return(p=p.type==="add"||p.type==="put"?s(s({},p),{keys:C}):s({},p)).type!=="delete"&&(p.values=c([],p.values)),p.keys&&(p.keys=c([],p.keys)),I=r,w=C,((b=p).type==="add"?Promise.resolve([]):I.getMany({trans:b.trans,keys:w,cache:"immutable"})).then(function(O){var P=C.map(function(L,R){var q,Z,K,W=O[R],ee={onerror:null,onsuccess:null};return p.type==="delete"?v.fire.call(ee,L,W,_):p.type==="add"||W===void 0?(q=g.fire.call(ee,L,p.values[R],_),L==null&&q!=null&&(p.keys[R]=L=q,i.outbound||ce(p.values[R],i.keyPath,L))):(q=ri(W,p.values[R]),(Z=y.fire.call(ee,q,L,W,_))&&(K=p.values[R],Object.keys(Z).forEach(function(J){D(K,J)?K[J]=Z[J]:ce(K,J,Z[J])}))),ee});return r.mutate(p).then(function(L){for(var R=L.failures,q=L.results,Z=L.numFailures,L=L.lastResult,K=0;K<C.length;++K){var W=(q||C)[K],ee=P[K];W==null?ee.onerror&&ee.onerror(R[K]):ee.onsuccess&&ee.onsuccess(p.type==="put"&&O[K]?p.values[K]:W)}return{failures:R,results:q,numFailures:Z,lastResult:L}}).catch(function(L){return P.forEach(function(R){return R.onerror&&R.onerror(L)}),Promise.reject(L)})})}}})}})}};function qi(e,t,r){try{if(!t||t.keys.length<e.length)return null;for(var i=[],a=0,l=0;a<t.keys.length&&l<e.length;++a)Me(t.keys[a],e[l])===0&&(i.push(r?ue(t.values[a]):t.values[a]),++l);return i.length===e.length?i:null}catch{return null}}var Qa={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var r=e.table(t);return s(s({},r),{getMany:function(i){if(!i.cache)return r.getMany(i);var a=qi(i.keys,i.trans._cache,i.cache==="clone");return a?re.resolve(a):r.getMany(i).then(function(l){return i.trans._cache={keys:i.keys,values:i.cache==="clone"?ue(l):l},l})},mutate:function(i){return i.type!=="add"&&(i.trans._cache=null),r.mutate(i)}})}}}};function $i(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function Ui(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Xa={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,r=new mt(e.MIN_KEY,e.MAX_KEY);return s(s({},e),{transaction:function(i,a,l){if(he.subscr&&a!=="readonly")throw new ne.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(he.querier));return e.transaction(i,a,l)},table:function(i){var a=e.table(i),l=a.schema,f=l.primaryKey,p=l.indexes,v=f.extractKey,g=f.outbound,y=f.autoIncrement&&p.filter(function(b){return b.compound&&b.keyPath.includes(f.keyPath)}),S=s(s({},a),{mutate:function(b){function w(J){return J="idb://".concat(t,"/").concat(i,"/").concat(J),L[J]||(L[J]=new mt)}var _,C,O,P=b.trans,L=b.mutatedParts||(b.mutatedParts={}),R=w(""),q=w(":dels"),Z=b.type,ee=b.type==="deleteRange"?[b.range]:b.type==="delete"?[b.keys]:b.values.length<50?[ii(f,b).filter(function(J){return J}),b.values]:[],K=ee[0],W=ee[1],ee=b.trans._cache;return m(K)?(R.addKeys(K),(ee=Z==="delete"||K.length===W.length?qi(K,ee):null)||q.addKeys(K),(ee||W)&&(_=w,C=ee,O=W,l.indexes.forEach(function(J){var oe=_(J.name||"");function Oe(Te){return Te!=null?J.extractKey(Te):null}function Pe(Te){return J.multiEntry&&m(Te)?Te.forEach(function(Ft){return oe.addKey(Ft)}):oe.addKey(Te)}(C||O).forEach(function(Te,yt){var Ie=C&&Oe(C[yt]),yt=O&&Oe(O[yt]);Me(Ie,yt)!==0&&(Ie!=null&&Pe(Ie),yt!=null&&Pe(yt))})}))):K?(W={from:(W=K.lower)!==null&&W!==void 0?W:e.MIN_KEY,to:(W=K.upper)!==null&&W!==void 0?W:e.MAX_KEY},q.add(W),R.add(W)):(R.add(r),q.add(r),l.indexes.forEach(function(J){return w(J.name).add(r)})),a.mutate(b).then(function(J){return!K||b.type!=="add"&&b.type!=="put"||(R.addKeys(J.results),y&&y.forEach(function(oe){for(var Oe=b.values.map(function(Ie){return oe.extractKey(Ie)}),Pe=oe.keyPath.findIndex(function(Ie){return Ie===f.keyPath}),Te=0,Ft=J.results.length;Te<Ft;++Te)Oe[Te][Pe]=J.results[Te];w(oe.name).addKeys(Oe)})),P.mutatedParts=cr(P.mutatedParts||{},L),J})}}),p=function(w){var _=w.query,w=_.index,_=_.range;return[w,new mt((w=_.lower)!==null&&w!==void 0?w:e.MIN_KEY,(_=_.upper)!==null&&_!==void 0?_:e.MAX_KEY)]},I={get:function(b){return[f,new mt(b.key)]},getMany:function(b){return[f,new mt().addKeys(b.keys)]},count:p,query:p,openCursor:p};return d(I).forEach(function(b){S[b]=function(w){var _=he.subscr,C=!!_,O=$i(he,a)&&Ui(b,w)?w.obsSet={}:_;if(C){var P=function(W){return W="idb://".concat(t,"/").concat(i,"/").concat(W),O[W]||(O[W]=new mt)},L=P(""),R=P(":dels"),_=I[b](w),C=_[0],_=_[1];if((b==="query"&&C.isPrimaryKey&&!w.values?R:P(C.name||"")).add(_),!C.isPrimaryKey){if(b!=="count"){var q=b==="query"&&g&&w.values&&a.query(s(s({},w),{values:!1}));return a[b].apply(this,arguments).then(function(W){if(b==="query"){if(g&&w.values)return q.then(function(Oe){return Oe=Oe.result,L.addKeys(Oe),W});var ee=w.values?W.result.map(v):W.result;(w.values?L:R).addKeys(ee)}else if(b==="openCursor"){var J=W,oe=w.values;return J&&Object.create(J,{key:{get:function(){return R.addKey(J.primaryKey),J.key}},primaryKey:{get:function(){var Oe=J.primaryKey;return R.addKey(Oe),Oe}},value:{get:function(){return oe&&L.addKey(J.primaryKey),J.value}}})}return W})}R.add(r)}}return a[b].apply(this,arguments)}}),S}})}};function Gi(e,t,r){if(r.numFailures===0)return t;if(t.type==="deleteRange")return null;var i=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return r.numFailures===i?null:(t=s({},t),m(t.keys)&&(t.keys=t.keys.filter(function(a,l){return!(l in r.failures)})),"values"in t&&m(t.values)&&(t.values=t.values.filter(function(a,l){return!(l in r.failures)})),t)}function ai(e,t){return r=e,((i=t).lower===void 0||(i.lowerOpen?0<Me(r,i.lower):0<=Me(r,i.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?Me(e,t.upper)<0:Me(e,t.upper)<=0));var r,i}function Wi(e,t,I,i,a,l){if(!I||I.length===0)return e;var f=t.query.index,v=f.multiEntry,g=t.query.range,y=i.schema.primaryKey.extractKey,S=f.extractKey,p=(f.lowLevelIndex||f).extractKey,I=I.reduce(function(b,w){var _=b,C=[];if(w.type==="add"||w.type==="put")for(var O=new mt,P=w.values.length-1;0<=P;--P){var L,R=w.values[P],q=y(R);O.hasKey(q)||(L=S(R),(v&&m(L)?L.some(function(J){return ai(J,g)}):ai(L,g))&&(O.addKey(q),C.push(R)))}switch(w.type){case"add":var Z=new mt().addKeys(t.values?b.map(function(oe){return y(oe)}):b),_=b.concat(t.values?C.filter(function(oe){return oe=y(oe),!Z.hasKey(oe)&&(Z.addKey(oe),!0)}):C.map(function(oe){return y(oe)}).filter(function(oe){return!Z.hasKey(oe)&&(Z.addKey(oe),!0)}));break;case"put":var K=new mt().addKeys(w.values.map(function(oe){return y(oe)}));_=b.filter(function(oe){return!K.hasKey(t.values?y(oe):oe)}).concat(t.values?C:C.map(function(oe){return y(oe)}));break;case"delete":var W=new mt().addKeys(w.keys);_=b.filter(function(oe){return!W.hasKey(t.values?y(oe):oe)});break;case"deleteRange":var ee=w.range;_=b.filter(function(oe){return!ai(y(oe),ee)})}return _},e);return I===e?e:(I.sort(function(b,w){return Me(p(b),p(w))||Me(y(b),y(w))}),t.limit&&t.limit<1/0&&(I.length>t.limit?I.length=t.limit:e.length===t.limit&&I.length<t.limit&&(a.dirty=!0)),l?Object.freeze(I):I)}function Yi(e,t){return Me(e.lower,t.lower)===0&&Me(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Za(e,t){return(function(r,i,a,l){if(r===void 0)return i!==void 0?-1:0;if(i===void 0)return 1;if((i=Me(r,i))===0){if(a&&l)return 0;if(a)return 1;if(l)return-1}return i})(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=(function(r,i,a,l){if(r===void 0)return i!==void 0?1:0;if(i===void 0)return-1;if((i=Me(r,i))===0){if(a&&l)return 0;if(a)return-1;if(l)return 1}return i})(e.upper,t.upper,e.upperOpen,t.upperOpen)}function eo(e,t,r,i){e.subscribers.add(r),i.addEventListener("abort",function(){var a,l;e.subscribers.delete(r),e.subscribers.size===0&&(a=e,l=t,setTimeout(function(){a.subscribers.size===0&&ke(l,a)},3e3))})}var to={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return s(s({},e),{transaction:function(r,i,a){var l,f,v=e.transaction(r,i,a);return i==="readwrite"&&(f=(l=new AbortController).signal,a=function(g){return function(){if(l.abort(),i==="readwrite"){for(var y=new Set,S=0,p=r;S<p.length;S++){var I=p[S],b=ln["idb://".concat(t,"/").concat(I)];if(b){var w=e.table(I),_=b.optimisticOps.filter(function(oe){return oe.trans===v});if(v._explicit&&g&&v.mutatedParts)for(var C=0,O=Object.values(b.queries.query);C<O.length;C++)for(var P=0,L=(Z=O[C]).slice();P<L.length;P++)Xr((K=L[P]).obsSet,v.mutatedParts)&&(ke(Z,K),K.subscribers.forEach(function(oe){return y.add(oe)}));else if(0<_.length){b.optimisticOps=b.optimisticOps.filter(function(oe){return oe.trans!==v});for(var R=0,q=Object.values(b.queries.query);R<q.length;R++)for(var Z,K,W,ee=0,J=(Z=q[R]).slice();ee<J.length;ee++)(K=J[ee]).res!=null&&v.mutatedParts&&(g&&!K.dirty?(W=Object.isFrozen(K.res),W=Wi(K.res,K.req,_,w,K,W),K.dirty?(ke(Z,K),K.subscribers.forEach(function(oe){return y.add(oe)})):W!==K.res&&(K.res=W,K.promise=re.resolve({result:W}))):(K.dirty&&ke(Z,K),K.subscribers.forEach(function(oe){return y.add(oe)})))}}}y.forEach(function(oe){return oe()})}}},v.addEventListener("abort",a(!1),{signal:f}),v.addEventListener("error",a(!1),{signal:f}),v.addEventListener("complete",a(!0),{signal:f})),v},table:function(r){var i=e.table(r),a=i.schema.primaryKey;return s(s({},i),{mutate:function(l){var f=he.trans;if(a.outbound||f.db._options.cache==="disabled"||f.explicit||f.idbtrans.mode!=="readwrite")return i.mutate(l);var v=ln["idb://".concat(t,"/").concat(r)];return v?(f=i.mutate(l),l.type!=="add"&&l.type!=="put"||!(50<=l.values.length||ii(a,l).some(function(g){return g==null}))?(v.optimisticOps.push(l),l.mutatedParts&&dr(l.mutatedParts),f.then(function(g){0<g.numFailures&&(ke(v.optimisticOps,l),(g=Gi(0,l,g))&&v.optimisticOps.push(g),l.mutatedParts&&dr(l.mutatedParts))}),f.catch(function(){ke(v.optimisticOps,l),l.mutatedParts&&dr(l.mutatedParts)})):f.then(function(g){var y=Gi(0,s(s({},l),{values:l.values.map(function(S,p){var I;return g.failures[p]?S:(S=(I=a.keyPath)!==null&&I!==void 0&&I.includes(".")?ue(S):s({},S),ce(S,a.keyPath,g.results[p]),S)})}),g);v.optimisticOps.push(y),queueMicrotask(function(){return l.mutatedParts&&dr(l.mutatedParts)})}),f):i.mutate(l)},query:function(l){if(!$i(he,i)||!Ui("query",l))return i.query(l);var f=((y=he.trans)===null||y===void 0?void 0:y.db._options.cache)==="immutable",p=he,v=p.requery,g=p.signal,y=(function(w,_,C,O){var P=ln["idb://".concat(w,"/").concat(_)];if(!P)return[];if(!(_=P.queries[C]))return[null,!1,P,null];var L=_[(O.query?O.query.index.name:null)||""];if(!L)return[null,!1,P,null];switch(C){case"query":var R=L.find(function(q){return q.req.limit===O.limit&&q.req.values===O.values&&Yi(q.req.query.range,O.query.range)});return R?[R,!0,P,L]:[L.find(function(q){return("limit"in q.req?q.req.limit:1/0)>=O.limit&&(!O.values||q.req.values)&&Za(q.req.query.range,O.query.range)}),!1,P,L];case"count":return R=L.find(function(q){return Yi(q.req.query.range,O.query.range)}),[R,!!R,P,L]}})(t,r,"query",l),S=y[0],p=y[1],I=y[2],b=y[3];return S&&p?S.obsSet=l.obsSet:(p=i.query(l).then(function(w){var _=w.result;if(S&&(S.res=_),f){for(var C=0,O=_.length;C<O;++C)Object.freeze(_[C]);Object.freeze(_)}else w.result=ue(_);return w}).catch(function(w){return b&&S&&ke(b,S),Promise.reject(w)}),S={obsSet:l.obsSet,promise:p,subscribers:new Set,type:"query",req:l,dirty:!1},b?b.push(S):(b=[S],(I=I||(ln["idb://".concat(t,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[l.query.index.name||""]=b)),eo(S,b,v,g),S.promise.then(function(w){return{result:Wi(w.result,l,I?.optimisticOps,i,S,f)}})}})}})}};function hr(e,t){return new Proxy(e,{get:function(r,i,a){return i==="db"?t:Reflect.get(r,i,a)}})}var qt=(lt.prototype.version=function(e){if(isNaN(e)||e<.1)throw new ne.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new ne.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,r=t.filter(function(i){return i._cfg.version===e})[0];return r||(r=new this.Version(e),t.push(r),t.sort(qa),r.stores({}),this._state.autoSchema=!1,r)},lt.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||he.letThrough||this._vip)?e():new re(function(r,i){if(t._state.openComplete)return i(new ne.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void i(new ne.DatabaseClosed);t.open().catch(be)}t._state.dbReadyPromise.then(r,i)}).then(e)},lt.prototype.use=function(e){var t=e.stack,r=e.create,i=e.level,a=e.name;return a&&this.unuse({stack:t,name:a}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:r,level:i??10,name:a}),e.sort(function(l,f){return l.level-f.level}),this},lt.prototype.unuse=function(e){var t=e.stack,r=e.name,i=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(a){return i?a.create!==i:!!r&&a.name!==r})),this},lt.prototype.open=function(){var e=this;return an(Tt,function(){return Wa(e)})},lt.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var e=this._state,t=yn.indexOf(this);if(0<=t&&yn.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new re(function(r){e.dbReadyResolve=r}),e.openCanceller=new re(function(r,i){e.cancelOpen=i}))},lt.prototype.close=function(r){var t=(r===void 0?{disableAutoOpen:!0}:r).disableAutoOpen,r=this._state;t?(r.isBeingOpened&&r.cancelOpen(new ne.DatabaseClosed),this._close(),r.autoOpen=!1,r.dbOpenError=new ne.DatabaseClosed):(this._close(),r.autoOpen=this._options.autoOpen||r.isBeingOpened,r.openComplete=!1,r.dbOpenError=null)},lt.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var r=0<arguments.length&&typeof arguments[0]!="object",i=this._state;return new re(function(a,l){function f(){t.close(e);var v=t._deps.indexedDB.deleteDatabase(t.name);v.onsuccess=nt(function(){var g,y,S;g=t._deps,y=t.name,S=g.indexedDB,g=g.IDBKeyRange,Yr(S)||y===Xn||Wr(S,g).delete(y).catch(be),a()}),v.onerror=Rt(l),v.onblocked=t._fireOnBlocked}if(r)throw new ne.InvalidArgument("Invalid closeOptions argument to db.delete()");i.isBeingOpened?i.dbReadyPromise.then(f):f()})},lt.prototype.backendDB=function(){return this.idbdb},lt.prototype.isOpen=function(){return this.idbdb!==null},lt.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},lt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},lt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(lt.prototype,"tables",{get:function(){var e=this;return d(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),lt.prototype.transaction=function(){var e=(function(t,r,i){var a=arguments.length;if(a<2)throw new ne.InvalidArgument("Too few arguments");for(var l=new Array(a-1);--a;)l[a-1]=arguments[a];return i=l.pop(),[t,de(l),i]}).apply(this,arguments);return this._transaction.apply(this,e)},lt.prototype._transaction=function(e,t,r){var i=this,a=he.trans;a&&a.db===this&&e.indexOf("!")===-1||(a=null);var l,f,v=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(f=t.map(function(y){if(y=y instanceof i.Table?y.name:y,typeof y!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return y}),e=="r"||e===Rr)l=Rr;else{if(e!="rw"&&e!=Hr)throw new ne.InvalidArgument("Invalid transaction mode: "+e);l=Hr}if(a){if(a.mode===Rr&&l===Hr){if(!v)throw new ne.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a=null}a&&f.forEach(function(y){if(a&&a.storeNames.indexOf(y)===-1){if(!v)throw new ne.SubTransaction("Table "+y+" not included in parent transaction.");a=null}}),v&&a&&!a.active&&(a=null)}}catch(y){return a?a._promise(null,function(S,p){p(y)}):st(y)}var g=(function y(S,p,I,b,w){return re.resolve().then(function(){var _=he.transless||he,C=S._createTransaction(p,I,S._dbSchema,b);if(C.explicit=!0,_={trans:C,transless:_},b)C.idbtrans=b.idbtrans;else try{C.create(),C.idbtrans._explicit=!0,S._state.PR1398_maxLoop=3}catch(L){return L.name===je.InvalidState&&S.isOpen()&&0<--S._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),S.close({disableAutoOpen:!1}),S.open().then(function(){return y(S,p,I,null,w)})):st(L)}var O,P=Xe(w);return P&&mn(),_=re.follow(function(){var L;(O=w.call(C,C))&&(P?(L=Wt.bind(null,null),O.then(L,L)):typeof O.next=="function"&&typeof O.throw=="function"&&(O=ni(O)))},_),(O&&typeof O.then=="function"?re.resolve(O).then(function(L){return C.active?L:st(new ne.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):_.then(function(){return O})).then(function(L){return b&&C._resolve(),C._completion.then(function(){return L})}).catch(function(L){return C._reject(L),st(L)})})}).bind(null,this,l,f,a,r);return a?a._promise(l,g,"lock"):he.trans?an(he.transless,function(){return i._whenReady(g)}):this._whenReady(g)},lt.prototype.table=function(e){if(!D(this._allTables,e))throw new ne.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},lt);function lt(e,t){var r=this;this._middlewares={},this.verno=0;var i=lt.dependencies;this._options=t=s({addons:lt.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},i=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a,l,f,v,g,y={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:be,dbReadyPromise:null,cancelOpen:be,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};y.dbReadyPromise=new re(function(p){y.dbReadyResolve=p}),y.openCanceller=new re(function(p,I){y.cancelOpen=I}),this._state=y,this.name=e,this.on=Mn(this,"populate","blocked","versionchange","close",{ready:[at,be]}),this.once=function(p,I){var b=function(){for(var w=[],_=0;_<arguments.length;_++)w[_]=arguments[_];r.on(p).unsubscribe(b),I.apply(r,w)};return r.on(p,b)},this.on.ready.subscribe=V(this.on.ready.subscribe,function(p){return function(I,b){lt.vip(function(){var w,_=r._state;_.openComplete?(_.dbOpenError||re.resolve().then(I),b&&p(I)):_.onReadyBeingFired?(_.onReadyBeingFired.push(I),b&&p(I)):(p(I),w=r,b||p(function C(){w.on.ready.unsubscribe(I),w.on.ready.unsubscribe(C)}))})}}),this.Collection=(a=this,Nn(Ra.prototype,function(O,C){this.db=a;var b=Ci,w=null;if(C)try{b=C()}catch(P){w=P}var _=O._ctx,C=_.table,O=C.hook.reading.fire;this._ctx={table:C,index:_.index,isPrimKey:!_.index||C.schema.primKey.keyPath&&_.index===C.schema.primKey.name,range:b,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:w,or:_.or,valueMapper:O!==Ue?O:null}})),this.Table=(l=this,Nn(Ti.prototype,function(p,I,b){this.db=l,this._tx=b,this.name=p,this.schema=I,this.hook=l._allTables[p]?l._allTables[p].hook:Mn(null,{creating:[_t,be],reading:[wt,Ue],updating:[vt,be],deleting:[ht,be]})})),this.Transaction=(f=this,Nn(za.prototype,function(p,I,b,w,_){var C=this;p!=="readonly"&&I.forEach(function(O){O=(O=b[O])===null||O===void 0?void 0:O.yProps,O&&(I=I.concat(O.map(function(P){return P.updatesTable})))}),this.db=f,this.mode=p,this.storeNames=I,this.schema=b,this.chromeTransactionDurability=w,this.idbtrans=null,this.on=Mn(this,"complete","error","abort"),this.parent=_||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new re(function(O,P){C._resolve=O,C._reject=P}),this._completion.then(function(){C.active=!1,C.on.complete.fire()},function(O){var P=C.active;return C.active=!1,C.on.error.fire(O),C.parent?C.parent._reject(O):P&&C.idbtrans&&C.idbtrans.abort(),st(O)})})),this.Version=(v=this,Nn(Ga.prototype,function(p){this.db=v,this._cfg={version:p,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(g=this,Nn(Mi.prototype,function(p,I,b){if(this.db=g,this._ctx={table:p,index:I===":id"?null:I,or:b},this._cmp=this._ascending=Me,this._descending=function(w,_){return Me(_,w)},this._max=function(w,_){return 0<Me(w,_)?w:_},this._min=function(w,_){return Me(w,_)<0?w:_},this._IDBKeyRange=g._deps.IDBKeyRange,!this._IDBKeyRange)throw new ne.MissingAPI})),this.on("versionchange",function(p){0<p.newVersion?console.warn("Another connection wants to upgrade database '".concat(r.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(r.name,"'. Closing db now to resume the delete request.")),r.close({disableAutoOpen:!1})}),this.on("blocked",function(p){!p.newVersion||p.newVersion<p.oldVersion?console.warn("Dexie.delete('".concat(r.name,"') was blocked")):console.warn("Upgrade '".concat(r.name,"' blocked by other connection holding version ").concat(p.oldVersion/10))}),this._maxKey=jn(t.IDBKeyRange),this._createTransaction=function(p,I,b,w){return new r.Transaction(p,I,b,r._options.chromeTransactionDurability,w)},this._fireOnBlocked=function(p){r.on("blocked").fire(p),yn.filter(function(I){return I.name===r.name&&I!==r&&!I._state.vcFired}).map(function(I){return I.on("versionchange").fire(p)})},this.use(Qa),this.use(to),this.use(Xa),this.use(Ya),this.use(Ja);var S=new Proxy(this,{get:function(p,I,b){if(I==="_vip")return!0;if(I==="table")return function(_){return hr(r.table(_),S)};var w=Reflect.get(p,I,b);return w instanceof Ti?hr(w,S):I==="tables"?w.map(function(_){return hr(_,S)}):I==="_createTransaction"?function(){return hr(w.apply(this,arguments),S)}:w}});this.vip=S,i.forEach(function(p){return p(r)})}var vr,Lt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",no=(oi.prototype.subscribe=function(e,t,r){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:r})},oi.prototype[Lt]=function(){return this},oi);function oi(e){this._subscribe=e}try{vr={indexedDB:h.indexedDB||h.mozIndexedDB||h.webkitIndexedDB||h.msIndexedDB,IDBKeyRange:h.IDBKeyRange||h.webkitIDBKeyRange}}catch{vr={indexedDB:null,IDBKeyRange:null}}function Ji(e){var t,r=!1,i=new no(function(a){var l=Xe(e),f,v=!1,g={},y={},S={get closed(){return v},unsubscribe:function(){v||(v=!0,f&&f.abort(),p&&Qt.storagemutated.unsubscribe(b))}};a.start&&a.start(S);var p=!1,I=function(){return Nr(w)},b=function(_){cr(g,_),Xr(y,g)&&I()},w=function(){var _,C,O;!v&&vr.indexedDB&&(g={},_={},f&&f.abort(),f=new AbortController,O=(function(P){var L=pn();try{l&&mn();var R=Gt(e,P);return R=l?R.finally(Wt):R}finally{L&&gn()}})(C={subscr:_,signal:f.signal,requery:I,querier:e,trans:null}),Promise.resolve(O).then(function(P){r=!0,t=P,v||C.signal.aborted||(g={},(function(L){for(var R in L)if(D(L,R))return;return 1})(y=_)||p||(Qt(Hn,b),p=!0),Nr(function(){return!v&&a.next&&a.next(P)}))},function(P){r=!1,["DatabaseClosedError","AbortError"].includes(P?.name)||v||Nr(function(){v||a.error&&a.error(P)})}))};return setTimeout(I,0),S});return i.hasValue=function(){return r},i.getValue=function(){return t},i}var un=qt;function si(e){var t=Xt;try{Xt=!0,Qt.storagemutated.fire(e),ti(e,!0)}finally{Xt=t}}E(un,s(s({},qe),{delete:function(e){return new un(e,{addons:[]}).delete()},exists:function(e){return new un(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=un.dependencies,r=t.indexedDB,t=t.IDBKeyRange,(Yr(r)?Promise.resolve(r.databases()).then(function(i){return i.map(function(a){return a.name}).filter(function(a){return a!==Xn})}):Wr(r,t).toCollection().primaryKeys()).then(e)}catch{return st(new ne.MissingAPI)}var t,r},defineClass:function(){return function(e){T(this,e)}},ignoreTransaction:function(e){return he.trans?an(he.transless,e):e()},vip:Jr,async:function(e){return function(){try{var t=ni(e.apply(this,arguments));return t&&typeof t.then=="function"?t:re.resolve(t)}catch(r){return st(r)}}},spawn:function(e,t,r){try{var i=ni(e.apply(r,t||[]));return i&&typeof i.then=="function"?i:re.resolve(i)}catch(a){return st(a)}},currentTransaction:{get:function(){return he.trans||null}},waitFor:function(e,t){return t=re.resolve(typeof e=="function"?un.ignoreTransaction(e):e).timeout(t||6e4),he.trans?he.trans.waitFor(t):t},Promise:re,debug:{get:function(){return Ke},set:function(e){pt(e)}},derive:M,extend:T,props:E,override:V,Events:Mn,on:Qt,liveQuery:Ji,extendObservabilitySet:cr,getByKeyPath:te,setByKeyPath:ce,delByKeyPath:function(e,t){typeof t=="string"?ce(e,t,void 0):"length"in t&&[].map.call(t,function(r){ce(e,r,void 0)})},shallowClone:_e,deepClone:ue,getObjectDiff:ri,cmp:Me,asap:ve,minKey:-1/0,addons:[],connections:yn,errnames:je,dependencies:vr,cache:ln,semVer:"4.2.1",version:"4.2.1".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,r){return e+t/Math.pow(10,2*r)})})),un.maxKey=jn(un.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Qt(Hn,function(e){Xt||(e=new CustomEvent(Kr,{detail:e}),Xt=!0,dispatchEvent(e),Xt=!1)}),addEventListener(Kr,function(e){e=e.detail,Xt||si(e)}));var Sn,Xt=!1,Qi=function(){};return typeof BroadcastChannel<"u"&&((Qi=function(){(Sn=new BroadcastChannel(Kr)).onmessage=function(e){return e.data&&si(e.data)}})(),typeof Sn.unref=="function"&&Sn.unref(),Qt(Hn,function(e){Xt||Sn.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!qt.disableBfCache&&e.persisted){Ke&&console.debug("Dexie: handling persisted pagehide"),Sn?.close();for(var t=0,r=yn;t<r.length;t++)r[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!qt.disableBfCache&&e.persisted&&(Ke&&console.debug("Dexie: handling persisted pageshow"),Qi(),si({all:new mt(-1/0,[[]])}))})),re.rejectionMapper=function(e,t){return!e||e instanceof Ze||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Ge[e.name]?e:(t=new Ge[e.name](t||e.message,e),"stack"in e&&N(t,"stack",{get:function(){return this.inner.stack}}),t)},pt(Ke),s(qt,Object.freeze({__proto__:null,Dexie:qt,liveQuery:Ji,Entity:ki,cmp:Me,PropModification:Ln,replacePrefix:function(e,t){return new Ln({replacePrefix:[e,t]})},add:function(e){return new Ln({add:e})},remove:function(e){return new Ln({remove:e})},default:qt,RangeSet:mt,mergeRanges:Vn,rangesOverlap:zi}),{default:qt}),qt})})(xr)),xr.exports}var il=rl();const di=Mo(il),ha=Symbol.for("Dexie"),Ir=globalThis[ha]||(globalThis[ha]=di);if(di.semVer!==Ir.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${di.semVer} and ${Ir.semVer}`);const{liveQuery:Oc,mergeRanges:Pc,rangesOverlap:Tc,RangeSet:Ec,cmp:Fc,Entity:Dc,PropModification:Lc,replacePrefix:Mc,add:Nc,remove:Rc,DexieYProvider:Hc}=Ir;class al extends Ir{uprnSelections;areaSelections;dataSelections;userDownloads;constructor(){super("app-db"),this.version(1).stores({uprnSelections:"++id, createdAt",areaSelections:"++id, layerId, *areaIds",dataSelections:"++id, layerId, *fields",userDownloads:"++id, &localId, createdAt"})}}const $n=new al,ol=async()=>await $n.uprnSelections.clear(),sl=async(x,n,o)=>await $n.userDownloads.add({localId:x,areaSelection:n,dataSelections:o,status:Zt.Pending,createdAt:Date.now()}),ll=async(x,n,o,s)=>{const c={};n!==void 0&&(c.externalId=n),o!==void 0&&(c.areaSelection=o),s!==void 0&&(c.dataSelections=s),Object.keys(c).length!==0&&await $n.userDownloads.where("localId").equals(x).modify(c)},ul=async()=>await $n.userDownloads.orderBy("createdAt").reverse().toArray(),cl=async x=>await $n.userDownloads.where("localId").equals(x).delete();class dl{#e=ie(Je(new jt));constructor(){this.#t()}addDownload(n){console.log("[downloads-store] Adding download:",n),u(this.#e).set(n.localId,n),sl(n.localId,n.areaSelection,n.dataSelections)}updateDownloadStatus(n){console.log("[downloads-store] Updating download status:",n),u(this.#e).set(n.localId,{...n}),ll(n.localId,n.externalId,n.areaSelection,n.dataSelections)}removeDownload(n){u(this.#e).delete(n),cl(n)}getDownloads(){return Array.from(u(this.#e).values())}async#t(){const n=await ul();!n||n.length===0||(console.log("Loaded downloads from DB:",n),n.forEach(o=>{u(this.#e).set(o.localId,{localId:o.localId,status:Zt.Pending,areaSelection:o.areaSelection,dataSelections:o.dataSelections})}))}}const Bn=new dl;var fl=se('<div class="data-item svelte-v4uih6"><span class="data-name svelte-v4uih6"> </span> <div class="data-actions svelte-v4uih6"><!></div></div>');function fi(x,n){const o=Ee(n,"title",3,"");Pr(x,{class:"data-item-card",children:(s,c)=>{var h=fl(),d=Q(h),m=Q(d,!0);U(d);var T=fe(d,2),k=Q(T);$e(k,()=>n.children??Qe),U(T),U(h),ut(()=>{mi(d,"title",o()),Ot(m,o())}),F(s,h)},$$slots:{default:!0}})}var hl=se("<!> <!> <!> <!>",1),vl=se('<ul class="selected-list svelte-vgw5fc"></ul> <p class="count svelte-vgw5fc"> </p>',1),pl=se('<p class="no-selection svelte-vgw5fc">No downloads in queue</p>'),gl=se('<div class="section svelte-vgw5fc"><h4 class="svelte-vgw5fc">Download Queue</h4> <!></div>');function ml(x,n){Re(n,!0);let o=ie(Je(new Set));const s=ge(()=>Bn.getDownloads()),c={completed:{color:"#059669",text:"Completed",icon:Vo},"in-progress":{color:"#2563eb",text:"In Progress",icon:Ko},failed:{color:"#dc2626",text:"Failed",icon:zo},pending:{color:"#6b7280",text:"Pending",icon:jo}};kn(()=>{const H=setInterval(()=>{h()},5e3);return()=>{clearInterval(H)}}),ot(()=>{if(!u(s)||u(s).length<=0||!n.uprnDownloadService)return;(async()=>{for(const j of u(s)){if(j.externalId||j.status!==Zt.Pending)continue;const B={exports:{areaSelectionLayer:{remoteId:j.areaSelection.layerId,areas:j.areaSelection.areas},dataSelectionLayers:j.dataSelections.map(Y=>({remoteId:Y.layerId,fields:Y.fields.filter(ve=>!n.fieldsToHide||!n.fieldsToHide.has(ve))}))}};console.log("[downloads-menu] Submitting download request:",B);const V=await n.uprnDownloadService.requestJob(B);if(!V||V.type===tl.Error){console.error("[downloads-menu] Failed to submit download request.",V);continue}j.externalId=V.guid,j.status=Zt.InProgress,Bn.updateDownloadStatus(j)}})()});async function h(){if(u(s).length<=0||!n.uprnDownloadService)return;const H={jobs:u(s).filter(B=>B.externalId).map(B=>B.externalId)},j=await n.uprnDownloadService.requestJobStatuses(H);if(!j){console.error("[downloads-menu] Failed to get job statuses.",j);return}for(const B of j.jobs){const V=u(s).find(Y=>Y.externalId===B.guid);if(!V){console.warn("[downloads-menu] Received job status for unknown download:",B.guid);continue}switch(B.status.type){case _r.Submitted:case _r.Processing:V.status=Zt.InProgress;break;case _r.Completed:V.status=Zt.Completed;break;case _r.Error:V.status=Zt.Failed;break;default:console.warn("[downloads-menu] Unknown job status type:",B.status.type);break}Bn.updateDownloadStatus(V)}}function d(H){Bn.removeDownload(H)}async function m(H){try{await navigator.clipboard.writeText(H),z(o,new Set(u(o)).add(H),!0),fn.success("URL copied to clipboard"),setTimeout(()=>{const j=new Set(u(o));j.delete(H),z(o,j,!0)},2e3)}catch(j){console.error("Failed to copy URL:",j),fn.error("Failed to copy URL to clipboard")}}function T(H){return c[H]?.color??c.pending.color}function k(H){return c[H]?.text??c.pending.text}function A(H){return c[H]?.icon??c.pending.icon}function D(H){return n.uprnDownloadService.getDownloadUrl(H)}var E=gl(),G=fe(Q(E),2);{var N=H=>{var j=vl(),B=$(j);zt(B,21,()=>u(s),An,(ve,te)=>{{let ce=ge(()=>u(te).externalId?u(te).externalId:"Pending...");fi(ve,{get title(){return u(ce)},children:(_e,Ae)=>{var de=hl(),Se=$(de);{let we=ge(()=>T(u(te).status)),ke=ge(()=>k(u(te).status));At(Se,{variant:"ghost",size:"sm",class:"download-status-btn",get style(){return`color: ${u(we)??""}`},get title(){return u(ke)},disabled:!0,children:(pe,Fe)=>{const Xe=ge(()=>A(u(te).status));var et=le(),Ze=$(et);{let it=ge(()=>u(te).status==="in-progress"?"spinning":"");De(Ze,()=>u(Xe),(ye,Ce)=>{Ce(ye,{size:14,get class(){return u(it)}})})}F(pe,et)},$$slots:{default:!0}})}var X=fe(Se,2);{var ue=we=>{At(we,{variant:"ghost",size:"sm",class:"download-clipboard-btn",onclick:()=>m(D(u(te).externalId)),title:"Copy URL to clipboard",children:(ke,pe)=>{var Fe=le(),Xe=$(Fe);{var et=it=>{Ro(it,{size:14})},Ze=it=>{Ho(it,{size:14})};me(Xe,it=>{u(o).has(D(u(te).externalId))?it(et):it(Ze,!1)})}F(ke,Fe)},$$slots:{default:!0}})};me(X,we=>{u(te).externalId&&we(ue)})}var xe=fe(X,2);{var Le=we=>{At(we,{variant:"ghost",size:"sm",class:"download-action-btn",onclick:()=>window.open(D(u(te).externalId),"_blank"),title:"Open download",children:(ke,pe)=>{xs(ke,{})},$$slots:{default:!0}})};me(xe,we=>{u(te).externalId&&u(te).status==="completed"&&we(Le)})}var ae=fe(xe,2);At(ae,{variant:"ghost",size:"sm",class:"download-remove-btn",onclick:()=>d(u(te).localId),title:"Remove from queue",children:(we,ke)=>{dn();var pe=Cn("");F(we,pe)},$$slots:{default:!0}}),F(_e,de)},$$slots:{default:!0}})}}),U(B);var V=fe(B,2),Y=Q(V);U(V),ut(()=>Ot(Y,`${u(s).length??""} download(s) in queue`)),F(H,j)},M=H=>{var j=pl();F(H,j)};me(G,H=>{u(s).length>0?H(N):H(M,!1)})}U(E),F(x,E),He()}class yl{#e=ie(Je(new jt));addSelection(n){u(this.#e).set(n.layerId,n),fn.success(`'${n.layer.title}' Added`)}removeSelection(n){const o=u(this.#e).get(n);u(this.#e).delete(n),fn.success(`'${o?.layer.title}' Removed`)}getSelection(n){return u(this.#e).get(n)}getAllSelections(){return Array.from(u(this.#e).values())}clearSelections(){u(this.#e).clear(),console.log("[data-selection-store] selections cleared.")}cleanup(){u(this.#e).clear()}}const kt=new yl;var bl=se('<div class="export-footer svelte-10dgoyk"><div class="export-footer__left svelte-10dgoyk"><p class="text-sm text-muted-foreground svelte-10dgoyk">Click "Export" to begin the download.</p></div> <div class="export-footer__right svelte-10dgoyk"><!></div></div>');function wl(x,n){Re(n,!0);function o(){if(Ne.layerHighlightState.areaInfos.length<=0){fn.error("Please select at least one area to export.");return}if(kt.getAllSelections().length<=0){fn.error("Please select at least one data layer to export.");return}console.log("Starting export..."),(async()=>{const m={layerId:Ne.layerHighlightState.featureLayerView?.layer.id||"",layerIndex:Ne.layerHighlightState.featureLayerView?.layer.layerId||0,areas:await Ne.getAreaCodesById(Ne.layerHighlightState.areaInfos.map(A=>A.id))},T=kt.getAllSelections().map(A=>({layerId:A.layerId,layerIndex:A.layer instanceof ss?A.layer.layerId:-1,fields:Array.from(A.fields)})),k=crypto.randomUUID();Bn.addDownload({localId:k,status:Zt.Pending,areaSelection:m,dataSelections:T}),n.onExportSuccess?.()})()}var s=bl(),c=fe(Q(s),2),h=Q(c);At(h,{onclick:o,children:(d,m)=>{dn();var T=Cn("Export");F(d,T)},$$slots:{default:!0}}),U(c),U(s),F(x,s),He()}class _l{#e=ie(null);get ActiveLayer(){return u(this.#e)}set ActiveLayer(n){z(this.#e,n,!0)}}class Sl{#e=ie(!1);get isLoaded(){return u(this.#e)}set isLoaded(n){z(this.#e,n,!0)}#t=ie(null);get data(){return u(this.#t)}set data(n){z(this.#t,n,!0)}#r=ge(()=>{const n=new jt;function o(s){n.set(s.id,s),s.type==="group"&&s.layers.forEach(h=>{o(h)})}return this.data&&this.data.layers.forEach(s=>{o(s)}),n});get dataLookup(){return u(this.#r)}set dataLookup(n){z(this.#r,n)}#i=ie(!1);get loading(){return u(this.#i)}set loading(n){z(this.#i,n,!0)}#n=ie(null);get error(){return u(this.#n)}set error(n){z(this.#n,n,!0)}async initializeAsync(n){if(!this.data){this.loading=!0,this.error=null;try{const{portalUrl:o,itemId:s,proxy:c}=n;await this.configurePortalAsync(o,c),await this.loadwebmapAsync(s)}catch(o){console.error("Error initializing webmap:",o),this.error=o.message}finally{this.loading=!1}}}async configurePortalAsync(n,o){if(!n||(na.portalUrl=n,console.log(na),!o))return;const{addProxyRule:s}=cs;console.log("Adding proxy rule for portal traffic"),s({urlPrefix:o?.urlPrefix,proxyUrl:o?.proxyUrl})}async loadwebmapAsync(n){if(this.data)return;const o=new us({id:n}),s=new ls({portalItem:o});this.data=s,await this.data.when(),this.data.loaded&&(this.isLoaded=!0)}clear(){this.data=null,this.loading=!1,this.error=null}clearError(){this.error=null}getWebmap(){return this.data}}function xl(x,n){x.stopPropagation(),n.onFilterClicked?.(n.layerId)}var Cl=se('<button title="Filter"><!></button>');function kl(x,n){Re(n,!0);let o=ie(Je(n.hasFiltersApplied?.(n.layerId)??!1));ot(()=>{z(o,n.hasFiltersApplied?.(n.layerId)??!1,!0)});const s=ge(()=>u(o)?Bo:qo);var c=Cl();let h;c.__click=[xl,n];var d=Q(c);qn(d,()=>u(s)),U(c),ut(m=>{h=en(c,1,"filter-btn svelte-k95pvd",null,h,m),mi(c,"aria-pressed",u(o))},[()=>({active:u(o)})]),F(x,c),He()}Tr(["click"]);var Il=se('<ul class="selected-list"></ul> <p class="count svelte-81yb5c"> </p>',1),Al=se('<p class="no-selection svelte-81yb5c">No areas selected</p>'),Ol=se("<!> <!>",1),Pl=se('<ul></ul> <p class="count svelte-81yb5c"> </p>',1),Tl=se('<p class="no-selection svelte-81yb5c">No data selected</p>'),El=se('<h2 class="svelte-81yb5c">Export Options</h2> <div class="section svelte-81yb5c"><h3 class="svelte-81yb5c"> </h3> <h4 class="svelte-81yb5c">Selected Areas</h4> <!></div> <div class="section svelte-81yb5c"><h4 class="svelte-81yb5c">Selected Data</h4> <!></div>',1);function Fl(x,n){Re(n,!0);const o=Ee(n,"fieldFilterMenuStore",7);let s=ie(Je([]));ot(()=>{if(!Ne.layerHighlightState.areaInfos.length){z(s,[],!0);return}(async()=>{const Y=await Ne.getAreaNamesById(Ne.layerHighlightState.areaInfos.map(te=>te.id)),ve=[];for(let te=0;te<Y.length;te++)ve.push({name:Y[te]||"Unknown Area",HighlightAreaInfo:Ne.layerHighlightState.areaInfos[te]});z(s,ve,!0)})()});function c(V){const Y=u(s).findIndex(ve=>ve.name===V);Y!==-1&&Ne.removeSelectedArea(u(s)[Y]?.HighlightAreaInfo.id)}function h(V){console.log("[export-menu] Removing data selection for layerId:",V),kt.removeSelection(V),console.log("[export-menu] Current SelectedData:",yo(kt.getAllSelections()))}function d(V){if(o().ActiveLayer?.id===V){o().ActiveLayer=null;return}const Y=n.webMapStore.dataLookup.get(V);if(!Y){console.warn(`[export-menu] Layer with ID ${V} not found in web map store.`);return}o().ActiveLayer=Y}function m(V){const Y=kt.getSelection(V);return!(!Y||!Y.fields||Y.fields.size===0||Y.fields.size===n.webMapStore.dataLookup.get(V)?.fields?.length)}var T=El(),k=fe($(T),2),A=Q(k),D=Q(A,!0);U(A);var E=fe(A,4);{var G=V=>{var Y=Il(),ve=$(Y);zt(ve,21,()=>u(s),An,(_e,Ae)=>{fi(_e,{get title(){return u(Ae).name},children:(de,Se)=>{At(de,{variant:"ghost",size:"sm",class:"area-remove-btn",title:"Remove area",onclick:()=>c(u(Ae).name),children:(X,ue)=>{dn();var xe=Cn("");F(X,xe)},$$slots:{default:!0}})},$$slots:{default:!0}})}),U(ve);var te=fe(ve,2),ce=Q(te);U(te),ut(()=>Ot(ce,`${u(s).length??""} area(s) selected`)),F(V,Y)},N=V=>{var Y=Al();F(V,Y)};me(E,V=>{u(s).length>0?V(G):V(N,!1)})}U(k);var M=fe(k,2),H=fe(Q(M),2);{var j=V=>{var Y=Pl(),ve=$(Y);zt(ve,21,()=>kt.getAllSelections(),An,(_e,Ae)=>{{let de=ge(()=>u(Ae).layer.title??"");fi(_e,{get title(){return u(de)},children:(Se,X)=>{var ue=Ol(),xe=$(ue);{var Le=we=>{kl(we,{get layerId(){return u(Ae).layerId},onFilterClicked:d,hasFiltersApplied:m})};me(xe,we=>{n.dataSelectionTreeviewConfig?.getItemConfig(u(Ae).layerId)?.showFields&&we(Le)})}var ae=fe(xe,2);At(ae,{variant:"ghost",size:"sm",class:"data-remove-btn",title:"Remove data selection",onclick:()=>h(u(Ae).layerId),children:(we,ke)=>{dn();var pe=Cn("");F(we,pe)},$$slots:{default:!0}}),F(Se,ue)},$$slots:{default:!0}})}}),U(ve);var te=fe(ve,2),ce=Q(te);U(te),ut(_e=>Ot(ce,`${_e??""} data layer(s) selected`),[()=>kt.getAllSelections().length]),F(V,Y)},B=V=>{var Y=Tl();F(V,Y)};me(H,V=>{kt.getAllSelections().length>0?V(j):V(B,!1)})}U(M),ut(V=>Ot(D,V),[()=>n.areaSelectionTreeviewStore.initialized?n.areaSelectionTreeviewStore.getVisibleNodes()[0]?.name:"Loading..."]),F(x,T),He()}function Dl(x,n){x.target===x.currentTarget&&n()}var Ll=(x,n)=>x.key==="Escape"&&n(),Ml=(x,n,o)=>n(u(o).name),Nl=se('<div class="info-icon-container svelte-fp5rsc"><!></div>'),Rl=se('<div class="field-content-wrapper svelte-fp5rsc"><!> <button class="field-content svelte-fp5rsc" tabindex="0"><div class="field-name-container svelte-fp5rsc"><span class="field-name svelte-fp5rsc"> </span> <!></div></button></div>'),Hl=se('<div class="master-checkbox-container svelte-fp5rsc"><!> <span class="master-checkbox-label svelte-fp5rsc">Select All Fields</span></div> <!> <!>',1),jl=se("<!> <!>",1),zl=se("<!> <!>",1),Kl=se('<button class="close-button svelte-fp5rsc" aria-label="Close"><!></button> <!>',1),Vl=se('<div class="card-container svelte-fp5rsc" role="dialog" aria-modal="true" tabindex="-1"><!></div>');function Bl(x,n){Re(n,!0);const o=Ee(n,"fieldFilterMenuStore",7);let s=ie(null),c=ie(Je(new xn)),h=ge(()=>{if(!u(s)||!u(s).fields)return{checked:!1,indeterminate:!1};const N=u(s).fields.length,M=u(c)?.size||0;return M===0?{checked:!1,indeterminate:!1}:M===N?{checked:!0,indeterminate:!1}:{checked:!1,indeterminate:!0}});ot(()=>{const N=o().ActiveLayer;if(!N){z(s,null),z(c,new xn,!0);return}z(s,N,!0);const M=kt.getSelection(N.id);M?.fields?z(c,new xn([...M.fields]),!0):z(c,new xn,!0)});function d(){m(),o().ActiveLayer=null}function m(){if(!u(s))return;let N=kt.getSelection(u(s).id);if(N){if((N.fields===void 0||N.fields===null)&&(N.fields=new xn),u(c).size===0){kt.removeSelection(u(s).id);return}N.fields.clear(),u(c).forEach(M=>{N.fields?.add(M)})}}function T(N){u(s)&&(u(c).has(N)?u(c).delete(N):u(c).add(N))}function k(){if(!u(s)?.fields)return;(u(c)?.size||0)===0?u(s).fields.forEach(M=>{u(c).add(M.name)}):u(c).clear()}function A(){if(!u(s)?.fields)return[];const N=u(s).fields.filter(M=>!n.fieldsToHide.has(M.name.toLowerCase()));return console.log("Filtered fields to show:",N,n.fieldsToHide,u(s).fields),N}var D=le(),E=$(D);{var G=N=>{var M=Vl();M.__click=[Dl,d],M.__keydown=[Ll,d];var H=Q(M);De(H,()=>Pr,(j,B)=>{B(j,{class:"command-card",children:(V,Y)=>{var ve=Kl(),te=$(ve);te.__click=d;var ce=Q(te);bo(ce,{size:20}),U(te);var _e=fe(te,2);De(_e,()=>Or,(Ae,de)=>{de(Ae,{class:"card-content",children:(Se,X)=>{var ue=le(),xe=$(ue);De(xe,()=>wo,(Le,ae)=>{ae(Le,{children:(we,ke)=>{var pe=zl(),Fe=$(pe);De(Fe,()=>_o,(et,Ze)=>{Ze(et,{placeholder:"Search for fields..."})});var Xe=fe(Fe,2);De(Xe,()=>So,(et,Ze)=>{Ze(et,{children:(it,ye)=>{var Ce=jl(),je=$(Ce);De(je,()=>xo,(ne,Ge)=>{Ge(ne,{children:(qe,be)=>{dn();var Ue=Cn("No results found.");F(qe,Ue)},$$slots:{default:!0}})});var tt=fe(je,2);De(tt,()=>Co,(ne,Ge)=>{Ge(ne,{heading:"Fields",children:(qe,be)=>{var Ue=Hl(),wt=$(Ue),We=Q(wt);Xi(We,{get checked(){return u(h).checked},get indeterminate(){return u(h).indeterminate},onCheckedChange:k}),dn(2),U(wt);var _t=fe(wt,2);De(_t,()=>$o,(vt,Ve)=>{Ve(vt,{})});var ht=fe(_t,2);zt(ht,17,A,An,(vt,Ve)=>{var at=le(),Ke=$(at);De(Ke,()=>ko,(pt,St)=>{St(pt,{class:"field-item",onselect:()=>T(u(Ve).name),children:(gt,xt)=>{var Pt=Rl(),Nt=Q(Pt);{let Vt=ge(()=>u(c)?.has(u(Ve).name)??!1);Xi(Nt,{class:"field-checkbox",get checked(){return u(Vt)},onCheckedChange:()=>T(u(Ve).name)})}var tn=fe(Nt,2);tn.__click=[Ml,T,Ve];var Ut=Q(tn),nn=Q(Ut),hn=Q(nn,!0);U(nn);var Kt=fe(nn,2);{var vn=Vt=>{var Tt=Nl(),he=Q(Tt);qn(he,()=>Uo),U(Tt),ut(()=>mi(Tt,"title",u(Ve).description)),F(Vt,Tt)};me(Kt,Vt=>{u(Ve).description&&Vt(vn)})}U(Ut),U(tn),U(Pt),ut(()=>Ot(hn,u(Ve).alias||u(Ve).name)),F(gt,Pt)},$$slots:{default:!0}})}),F(vt,at)}),F(qe,Ue)},$$slots:{default:!0}})}),F(it,Ce)},$$slots:{default:!0}})}),F(we,pe)},$$slots:{default:!0}})}),F(Se,ue)},$$slots:{default:!0}})}),F(V,ve)},$$slots:{default:!0}})}),U(M),F(N,M)};me(E,N=>{u(s)&&N(G)})}F(x,D),He()}Tr(["click","keydown"]);class ka{id;name;children;parent;constructor(n,o,s=[],c=null){this.id=n,this.name=o,this.children=s,this.parent=c}}class ct extends ka{layer;constructor(n,o,s,c=[],h=null){super(n,o,c,h),this.layer=s}}class On extends ct{featureLayer;field;constructor(n,o,s,c,h=[],d=null){super(n,o,s,h,d),this.field=c,this.featureLayer=s}}var rt=(x=>(x.Inactive="inactive",x.Indeterminate="indeterminate",x.Active="active",x))(rt||{});class Ia{#e=ie(!1);get initialized(){return u(this.#e)}set initialized(n){z(this.#e,n,!0)}#t=null;#r=ie(Je([]));#i=ge(()=>{const n=new jt;return this.#b(u(this.#r),n),n});#n=ie(Je(new jt));#a=ie(Je(new jt));#l=ie(Je(new jt));#s=null;initialize(n,o,s,c){if(this.initialized)throw new Error("TreeviewStore is already initialized.");if(this.initialized=!0,!o)throw new Error("TreeviewStore requires a valid TreeviewConfigStore to initialize.");if(this.#t=o,s)for(const h of s)u(this.#l).set(h.id,h);if(c&&(this.#s=c),!n)throw new Error("TreeviewStore requires a valid array of layers to initialize.");this.#g(n),z(this.#r,this.#m(n),!0)}getNodeById(n){return this.#f(),u(this.#i).get(n)}getNodes(){return this.#f(),u(this.#r)}getVisibleNodes(){this.#f();const n=[];for(const[o,s]of u(this.#n)){if(!s)continue;const c=u(this.#i).get(o);c&&n.push(c)}return n}getNonHiddenNodes(){return this.#f(),this.#u(u(this.#r))}clearSelections(){this.#f();for(const n of u(this.#n).keys()){u(this.#n).set(n,!1);const o=u(this.#i).get(n);o&&o instanceof ct&&(o.layer.visible=!1)}u(this.#a).clear()}#u(n){this.#f();const o=[];for(const s of n){const c=this.#d(s.id);if(!(c&&c.isHidden)&&(o.push(s),s.children?.length)){const h=this.#u(s.children);o.push(...h)}}return o}getVisibilityState(n){return this.#f(),u(this.#n).get(n)??!1}setVisibilityState(n,o){this.#f();const s=u(this.#i).get(n);if(!s)throw new Error(`Tree node not found for ID: ${n}`);if(!(s instanceof ct))throw new Error(`Tree node is not a layer node: ${n}`);const c=this.#d(n);if(c?.disableVisibilityToggle||(u(this.#n).set(n,o),s.layer.visible=o,s instanceof On&&(s.featureLayer.displayField=o?s.field.name:"",o&&this.#s&&(console.log("[TreeviewStore] Applying custom renderer for field:",s.field.name),this.#s.applyCustomRenderer(s.featureLayer,s.field.name))),this.#c(s,o),!c||c.isHidden)||(c.visibilityDependencyIds?.length&&this.#h(s,o),!c.visibilityGroupId))return;const h=c.visibilityGroupId;let d=u(this.#a).get(h);d||(d=[],u(this.#a).set(h,d));const m=this.#o(h);if(!m)throw new Error(`Visibility group config not found for group ID: ${h}`);if(!o){const k=d.indexOf(n);d.splice(k,1);return}const T=k=>{u(this.#n).set(k,!1);const A=u(this.#i).get(k);if(A&&A instanceof ct){A.layer.visible=!1,this.#c(A,!1);const E=this.#d(k);E&&E.visibilityDependencyIds?.length&&this.#h(A,!1)}const D=d.indexOf(k);D>=0&&d.splice(D,1)};for(;d.length>=m.maxVisibleLayers;){const k=d[0];T(k)}d.push(n),this.#c(s,o),c.visibilityDependencyIds?.length&&this.#h(s,o)}cleanup(){this.initialized=!1,u(this.#n).clear(),u(this.#a).clear(),u(this.#l).clear(),z(this.#r,[],!0),u(this.#i).clear()}#c(n,o){const s=n.parent;if(s){if(!(s instanceof ct)){this.#c(s,o);return}u(this.#n).set(s.id,o),s.layer.visible=o,this.#c(s,o)}}#h(n,o){const s=this.#d(n.id);if(s&&s.visibilityDependencyIds?.length)for(const c of s.visibilityDependencyIds){const h=u(this.#i).get(c);h&&h instanceof ct&&(u(this.#n).set(c,o),h.layer.visible=o,this.#c(h,o))}}#o(n){if(n&&this.#t)return this.#t.getVisibilityGroupConfig(n)}#g(n){this.#t&&this.#t.resolveInheritance(n)}#m(n){const o=n.map(s=>this.#p(s,void 0));return this.#v([...o])}#d(n){if(n&&this.#t)return this.#t.getItemConfig(n)}#v(n){n.reverse();for(const o of n)o.children?.length&&this.#v(o.children);return n}#p(n,o){const s=this.#d(n.id);if(s&&s.customConverterId){if(!u(this.#l).has(s.customConverterId))throw new Error(`Custom converter not found: ${s.customConverterId}`);const h=u(this.#l).get(s.customConverterId);if(!h)throw new Error(`Custom converter not found: ${s.customConverterId}`);return h.layerToNode(n,o??null)}const c=new ct(n.id,n.title,n,[],o);if(n.visible=s?.disableVisibilityToggle?n.visible:s?.isHidden?!1:s?.isVisibleOnInit??!1,u(this.#n).set(n.id,n.visible),this.#C(n)&&s?.showFields){const h=n;h.loaded||console.warn(`Layer not loaded: ${n.id}`);for(const d of h.fields??[]){const m=this.#w(d,c);c.children.push(m)}}if(this.#x(n)){const h=n;return c.children=h.layers.toArray().map(d=>this.#p(d,c)),c}if(this.#_(n)){const h=n;if(h.sublayers&&h.sublayers.length>0){const d=h.sublayers;c.children=d.toArray().map(this.#y)}}return c}#w(n,o){const s=this.#S(o.id,n.name),c=new On(s,n.alias||n.name,o.layer,n,[],o),h=this.#d(s);return u(this.#n).set(s,h?.isVisibleOnInit??!1),c}#_(n){return n.type==="map-image"||n.type==="wms"}#y(n){const o=new ct(n.uid,n.title,n);return n.sublayers?.length&&(o.children=n.sublayers.toArray().map(this.#y)),o}#b(n,o){for(const s of n)o.set(s.id,s),s.children?.length&&this.#b(s.children,o)}#S(n,o){return`${n}-${o}`}#x(n){return n.type==="group"}#C(n){return n.type==="feature"}#f(){if(!this.initialized)throw new Error("TreeviewStore is not initialized. Call initialize() first.")}}const ql='<path d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/>',$l='<path d="M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/>',Ul='<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14,2 14,8 20,8"/>',Aa=(x,n,o,s)=>n?Gl(x,o):o?s?ql:$l:Ul,Gl=(x,n)=>{switch(x.type){case"group":return Zi;case"feature":return ea;case"tile":return Go;default:return n?Zi:ea}};function Wl(x){const n=x-1;return n*n*n+1}var Yl=se('<div class="relative ml-4 w-full"><div class="tree-guide-line svelte-1y72o5r"></div> <div class="tree-children svelte-1y72o5r"></div></div>'),Jl=se('<div class="w-full"><!> <!></div>');function Oa(x,n){const o=Ee(n,"isOpen",3,!1),s=Ee(n,"childNodes",3,null),c=Ee(n,"duration",3,300);var h=Jl(),d=Q(h);$e(d,()=>n.content??Qe);var m=fe(d,2);{var T=k=>{var A=Yl(),D=fe(Q(A),2);zt(D,21,()=>s()??[],E=>E.id,(E,G)=>{var N=le(),M=$(N);$e(M,()=>n.childNode??Qe,()=>u(G)),F(E,N)}),U(D),U(A),kr(1,D,()=>ca,()=>({duration:c(),easing:Wl})),kr(2,D,()=>ca,()=>({duration:c()})),F(k,A)};me(m,k=>{o()&&s()&&k(T)})}U(h),F(x,h)}const hi="mb-1 cursor-pointer rounded-md border border-border p-2 text-left",vi="transform-gpu transition-all duration-150 ease-out hover:border-border/50 hover:bg-gray-100 hover:shadow-sm",Ql="transition-colors hover:bg-blue-500",pi="text-sm font-normal",gi="bg-card",Pa="bg-accent text-accent-foreground",Xl="!h-auto !min-h-9 !whitespace-normal data-[state=on]:!bg-accent data-[state=on]:!text-accent-foreground data-[state=on]:hover:!bg-accent data-[state=on]:hover:!text-accent-foreground";function Zl(x={}){const{enhancedHover:n=!1,includeFont:o=!1,pressed:s=!1}=x;let c=hi;return n?c+=" "+vi:c+=" "+Ql,o&&(c+=" "+pi),s?c+=" "+Pa:c+=" "+gi,c}var eu=se('<div class="flex w-full !items-center !justify-between gap-2"><div class="pointer-events-none !flex min-w-0 flex-1 !items-center gap-1"><span class="inline-block size-4" aria-hidden="true"><!></span> <span class="block w-full text-left break-words"> </span></div> <!></div>'),tu=se('<button><div class="flex w-full items-center justify-between gap-2"><div class="pointer-events-none flex min-w-0 flex-1 items-center gap-1"><!> <span class="inline-block size-4" aria-hidden="true"><!></span> <span class="block w-full text-left break-words"> </span></div> <!></div></button>');function va(x,n){const o=`calc(100% - ${n.depth*1}rem)`,s=`${hi} ${vi} ${Xl} ${gi} ${pi}`,c=`${hi} ${vi} ${pi}`;var h=le(),d=$(h);{var m=k=>{Wo(k,{get pressed(){return n.pressed},get class(){return s},variant:"outline",get style(){return`width: ${o};`},get onPressedChange(){return n.onclick},children:(A,D)=>{var E=eu(),G=Q(E),N=Q(G),M=Q(N);qn(M,()=>n.icon),U(N);var H=fe(N,2),j=Q(H,!0);U(H),U(G);var B=fe(G,2);$e(B,()=>n.children??Qe),U(E),ut(()=>Ot(j,n.name)),F(A,E)},$$slots:{default:!0}})},T=k=>{var A=tu();A.__click=function(...V){n.onclick?.apply(this,V)};var D=Q(A),E=Q(D),G=Q(E);_a(G,{get isOpen(){return n.isOpen}});var N=fe(G,2),M=Q(N);qn(M,()=>n.icon),U(N);var H=fe(N,2),j=Q(H,!0);U(H),U(E);var B=fe(E,2);$e(B,()=>n.children??Qe),U(D),U(A),ut(()=>{en(A,1,`${c} ${n.pressed?Pa:gi}`),In(A,`width: ${o};`),Ot(j,n.name)}),F(k,A)};me(d,k=>{n.isTogglable?k(m):k(T,!1)})}F(x,h)}Tr(["click"]);function Ta(x,n){Re(n,!0);const o=M=>{var H=le(),j=$(H);{var B=V=>{var Y=le(),ve=$(Y);{var te=_e=>{va(_e,{isTogglable:!1,get pressed(){return u(k)},get icon(){return u(A)},get name(){return n.node.name},get depth(){return c()},onclick:N,get isOpen(){return u(T)}})},ce=_e=>{va(_e,{isTogglable:!0,get pressed(){return u(k)},get icon(){return u(A)},get name(){return n.node.name},get depth(){return c()},onclick:G,get isOpen(){return u(T)}})};me(ve,_e=>{d?_e(te):_e(ce,!1)})}F(V,Y)};me(j,V=>{n.treeviewConfigStore.getItemConfig(n.node.id)?.isHidden||V(B)})}F(M,H)},s=(M,H=Qe)=>{var j=le(),B=$(j);{var V=Y=>{{let ve=ge(()=>c()+1);Ta(Y,{get treeviewConfigStore(){return n.treeviewConfigStore},get node(){return H()},get onNodeClick(){return n.onNodeClick},get onNodeVisibilityChange(){return n.onNodeVisibilityChange},get getNodeVisibility(){return n.getNodeVisibility},get depth(){return u(ve)},get useLayerTypeIcon(){return h()}})}};me(B,Y=>{d&&u(T)&&!n.treeviewConfigStore.getItemConfig(H().id)?.isHidden&&Y(V)})}F(M,j)},c=Ee(n,"depth",3,0),h=Ee(n,"useLayerTypeIcon",3,!1),d=!!(n.node.children&&n.node.children.length),m=!d;let T=ie(!1),k=ie(!1),A=ie("");function D(){return!n.node.children||!n.getNodeVisibility?!1:n.node.children.some(M=>{const H=n.getNodeVisibility(M.id);return H!==void 0?H:M instanceof ct?M.layer.visible:!1})}ot(()=>{if(!(!n.node||!(n.node instanceof ct))){if(d)z(k,D(),!0);else{const M=n.getNodeVisibility?n.getNodeVisibility(n.node.id):void 0;z(k,M!==void 0?M:n.node.layer.visible,!0)}z(A,Aa(n.node.layer,h(),d,u(T)),!0)}});function E(){!m||!n.onNodeVisibilityChange||d||(z(k,!u(k)),n.onNodeVisibilityChange(n.node,u(k)))}function G(){d||E(),n.onNodeClick?.(n.node)}function N(){z(T,!u(T)),n.onNodeClick?.(n.node)}{let M=ge(()=>d?n.node.children:null);Oa(x,{get isOpen(){return u(T)},get content(){return o},get childNodes(){return u(M)},get childNode(){return s}})}He()}function nu(x,n){Re(n,!0);const o=Ee(n,"webMap",3,null);ot(()=>{!o()||n.treeviewStore.initialized||n.treeviewStore.initialize(o().layers.toArray(),n.treeviewConfigStore)});var s=le(),c=$(s);{var h=d=>{var m=le(),T=$(m);De(T,()=>Sa,(k,A)=>{A(k,{children:(D,E)=>{var G=le(),N=$(G);zt(N,17,()=>n.treeviewStore.getNodes(),M=>M.id,(M,H)=>{Ta(M,{get treeviewConfigStore(){return n.treeviewConfigStore},get node(){return u(H)},onNodeClick:()=>{},onNodeVisibilityChange:(j,B)=>n.treeviewStore.setVisibilityState(j.id,B),getNodeVisibility:j=>n.treeviewStore.getVisibilityState(j),depth:0,useLayerTypeIcon:!0})}),F(D,G)},$$slots:{default:!0}})}),F(d,m)};me(c,d=>{n.treeviewStore.initialized&&d(h)})}F(x,s),He()}class ru{configStore;constructor(n){this.configStore=n}}function iu(x){return x.replace(/&deg;/gi,"").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&lt;/gi,"<").replace(/&gt;/gi,">")}class au extends ru{id="aliasPath";layerToNode(n,o){const s=new ct(n.id,n.title,n,[],o),c=this.configStore.getItemConfig(n.id);if(this.#r(n)&&c?.showFields){const h=n;h.loaded||console.warn(`Layer not loaded: ${n.id}`);const d=new Map;for(const m of h.fields??[]){const T=this.configStore.getItemConfig(this.#t(n.id,m.name));!T||T.isHidden||this.#e(m,s,d)}s.children.sort((m,T)=>m.children.length>0&&T.children.length===0?1:m.children.length===0&&T.children.length>0?-1:0)}return s}#e(n,o,s=new Map){const c=this.#t(o.id,n.name),d=iu(n.alias||"")?.split("|").map(E=>E.trim()).filter(Boolean)??[];if(d.length===0){const E=new On(c,n.alias||n.name,o.layer,n,[],o);return o.children.push(E),E}const m=d.slice(0,-1),T=d[d.length-1];let k=o;const A=(E,G)=>{E.children??=[],E.children.includes(G)||E.children.push(G)};for(let E=0;E<m.length;E++){const G=m[E],N=d.slice(0,E+1).join("::"),M=`${o.id}::${N}`;let H=s.get(M);H||(H=new ka(M,G,[],k),s.set(M,H),A(k,H)),k=H}const D=new On(c,T||n.name,o.layer,n,[],k);return A(k,D),D}#t(n,o){return`${n}-${o}`}#r(n){return n.type==="feature"}}class pa{#e=[];#t=new Map;#r=[];#i=new Map;#n=[];#a=new Map;#l=new Set;constructor(n){if(!n)throw new Error("TreeviewConfigStore requires a valid configuration object.");this.#e=n.items??[],this.#t=new Map(this.#e.map(o=>[o.id,o])),this.#r=n.visibilityGroups??[],this.#i=new Map(this.#r.map(o=>[o.id,o])),this.#n=n.inheritanceGroups??[],this.#a=new Map(this.#n.map(o=>[o.id,o])),n.fieldsToHide&&(this.#l=new Set(n.fieldsToHide.map(o=>o.trim().toLowerCase())))}getItemConfig(n){return this.#t.get(n)}getVisibilityGroupConfig(n){return this.#i.get(n)}getInheritanceGroupConfig(n){return this.#a.get(n)}resolveInheritance(n){if(!(n.length===0||!this.#e||this.#e.length===0))for(const o of n){const s=this.getItemConfig(o.id);this.#s(o,s)}}#s(n,o){const s=this.#u(n,o);if(this.#p(n)&&s.showFields){const c=n;c.loaded||console.warn(`Layer not loaded: ${n.id}`);for(const h of c.fields??[])this.#c(this.#d(n.id,h.name),h.alias||h.name,s)}if(this.#v(n)){const c=n;for(const h of c.layers.toArray())this.#s(h,s)}}#u(n,o){const s=this.#h(n.id,o);return s.type===mr.None&&(s.type=Yo(n)),s}#c(n,o,s){const c=this.#h(n,s);return c.type===mr.None&&(c.type=mr.Field),this.#l.has(o.trim().toLowerCase())&&(c.isHidden=!0),c}#h(n,o){let s=this.getItemConfig(n);const c=s?.inheritanceGroupId?this.getInheritanceGroupConfig(s.inheritanceGroupId):this.getInheritanceGroupConfig(o?.inheritanceGroupId??"");return s={id:n,type:mr.None,isDownloadable:this.#o(c,"isDownloadable",s,o,!0),isVisibleOnInit:this.#o(c,"isVisibleOnInit",s,o,!1),isHidden:this.#o(c,"isHidden",s,o,!1),disableVisibilityToggle:this.#o(c,"disableVisibilityToggle",s,o,!1),isOpenOnInit:this.#o(c,"isOpenOnInit",s,o,!1),showFields:this.#o(c,"showFields",s,o,!1),visibilityDependencyIds:this.#o(c,"visibilityDependencyIds",s,o,[]),visibilityGroupId:this.#o(c,"visibilityGroupId",s,o,void 0),customConverterId:this.#o(c,"customConverterId",s,o,void 0),inheritanceGroupId:this.#o(c,"inheritanceGroupId",s,o,void 0)},this.#m(s),this.#g(s),s}#o(n,o,s,c,h){const d=s?.[o];return d!==void 0?d:n?.inheritedProperties.includes(o)&&c?c[o]??h:h}#g(n){if(this.#t.has(n.id))throw new Error(`Item with id ${n.id} already exists.`);this.#e.push(n),this.#t.set(n.id,n)}#m(n){this.#t.has(n.id)&&(this.#e=this.#e.filter(o=>o.id!==n.id),this.#t.delete(n.id))}#d(n,o){return`${n}-${o}`}#v(n){return n.type==="group"}#p(n){return n.type==="feature"}}var ou=se('<div data-slot="checkbox-indicator" class="text-current transition-none"><!></div>');function su(x,n){Re(n,!0);let o=Ee(n,"ref",15,null),s=Ee(n,"checked",11,!1),c=Ee(n,"indeterminate",11,!1),h=Dt(n,["$$slots","$$events","$$legacy","ref","checked","indeterminate","class"]),d=ie(Je(s())),m=ie(Je(c()));ot(()=>{z(d,s())}),ot(()=>{z(m,c())});var T=le(),k=$(T);{const A=(E,G)=>{let N=()=>G?.().checked,M=()=>G?.().indeterminate;var H=ou(),j=Q(H);{var B=Y=>{Is(Y,{class:"size-3.5"})},V=Y=>{var ve=le(),te=$(ve);{var ce=_e=>{Qo(_e,{class:"size-3.5"})};me(te,_e=>{M()&&_e(ce)},!0)}F(Y,ve)};me(j,Y=>{N()?Y(B):Y(V,!1)})}U(H),F(E,H)};let D=ge(()=>No("peer flex size-4 shrink-0 items-center justify-center rounded-[4px] border border-input shadow-xs transition-shadow outline-none focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50 disabled:cursor-not-allowed disabled:opacity-50 aria-invalid:border-destructive aria-invalid:ring-destructive/20 data-[state=checked]:border-primary data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:bg-input/30 dark:aria-invalid:ring-destructive/40 dark:data-[state=checked]:bg-primary",n.class));De(k,()=>Jo,(E,G)=>{G(E,It({"data-slot":"checkbox",get class(){return u(D)}},()=>h,{get ref(){return o()},set ref(N){o(N)},get checked(){return u(d)},set checked(N){z(d,N,!0)},get indeterminate(){return u(m)},set indeterminate(N){z(m,N,!0)},children:A,$$slots:{default:!0}}))})}F(x,T),He()}var lu=se("<div><!></div>");function ga(x,n){Re(n,!0);let o=ge(()=>n.getDownloadState?.(n.node)??rt.Inactive),s=ge(()=>u(o)===rt.Active),c=ge(()=>u(o)===rt.Indeterminate);function h(T){T.stopPropagation();const k=u(o)===rt.Active?rt.Inactive:rt.Active;n.onDownloadStateChanged?.(n.node,k)}var d=lu(),m=Q(d);su(m,{get checked(){return u(s)},get indeterminate(){return u(c)},onclick:h,title:"Download"}),U(d),F(x,d),He()}var uu=se('<button><div class="flex w-full items-center justify-between gap-2"><div class="pointer-events-none flex min-w-0 flex-1 items-center gap-1"><!> <span class="inline-block size-4" aria-hidden="true"><!></span> <span class="block w-full text-left break-words"> </span></div> <!></div></button>');function ma(x,n){Re(n,!0);const o=Ee(n,"isFolder",3,!1),s=Ee(n,"isOpen",3,!1),c=`calc(100% - ${n.depth*1}rem)`;var h=uu();h.__click=function(...M){n.onclick?.apply(this,M)};var d=Q(h),m=Q(d),T=Q(m);{var k=M=>{_a(M,{get isOpen(){return s()}})};me(T,M=>{o()&&M(k)})}var A=fe(T,2),D=Q(A);qn(D,()=>n.icon),U(A);var E=fe(A,2),G=Q(E,!0);U(E),U(m);var N=fe(m,2);$e(N,()=>n.children??Qe),U(d),U(h),ut(M=>{en(h,1,M),In(h,`width: ${c};`),Ot(G,n.name)},[()=>mo(Zl({enhancedHover:!0,includeFont:!0}))]),F(x,h),He()}Tr(["click"]);var cu=se('<div class="flex items-center gap-2"><!> <!></div>'),du=se('<div class="flex items-center gap-2"><!> <!></div>');function Ea(x,n){Re(n,!0);const o=B=>{var V=le(),Y=$(V);{var ve=te=>{var ce=le(),_e=$(ce);{var Ae=Se=>{ma(Se,{get icon(){return u(E)},get name(){return n.node.name},get depth(){return h()},onclick:j,get isFolder(){return m},get isOpen(){return u(A)},children:ue=>{var xe=cu(),Le=Q(xe);{var ae=pe=>{ga(pe,{get node(){return n.node},get onDownloadStateChanged(){return n.onDownloadStateChanged},get getDownloadState(){return n.getDownloadState}})};me(Le,pe=>{n.isDownloadable&&pe(ae)})}var we=fe(Le,2);{var ke=pe=>{ta(pe,{get checked(){return u(D)},onCheckedChange:M})};me(we,pe=>{T&&pe(ke)})}U(xe),F(ue,xe)},$$slots:{default:!0}})},de=Se=>{ma(Se,{get icon(){return u(E)},get name(){return n.node.name},get depth(){return h()},onclick:H,get isFolder(){return m},children:ue=>{var xe=du(),Le=Q(xe);{var ae=pe=>{ga(pe,{get node(){return n.node},get onDownloadStateChanged(){return n.onDownloadStateChanged},get getDownloadState(){return n.getDownloadState}})};me(Le,pe=>{n.isDownloadable&&pe(ae)})}var we=fe(Le,2);{var ke=pe=>{ta(pe,{get checked(){return u(D)},onCheckedChange:M})};me(we,pe=>{T&&pe(ke)})}U(xe),F(ue,xe)},$$slots:{default:!0}})};me(_e,Se=>{m?Se(Ae):Se(de,!1)})}F(te,ce)};me(Y,te=>{c()?.getItemConfig(n.node.id)?.isHidden||te(ve)})}F(B,V)},s=(B,V=Qe)=>{var Y=le(),ve=$(Y);{var te=ce=>{{let _e=ge(()=>c()?.getItemConfig(V().id)?.isDownloadable??!0),Ae=ge(()=>h()+1);Ea(ce,{get treeviewConfigStore(){return c()},get node(){return V()},get isDownloadable(){return u(_e)},get onNodeClick(){return n.onNodeClick},get onNodeVisibilityChange(){return n.onNodeVisibilityChange},get onDownloadStateChanged(){return n.onDownloadStateChanged},get getDownloadState(){return n.getDownloadState},get onFilterClicked(){return n.onFilterClicked},get hasFiltersApplied(){return n.hasFiltersApplied},get getNodeVisibility(){return n.getNodeVisibility},get depth(){return u(Ae)},get useLayerTypeIcon(){return d()}})}};me(ve,ce=>{m&&u(A)&&!c()?.getItemConfig(V().id)?.isHidden&&ce(te)})}F(B,Y)},c=Ee(n,"treeviewConfigStore",3,null),h=Ee(n,"depth",3,0),d=Ee(n,"useLayerTypeIcon",3,!1),m=!!(n.node.children&&n.node.children.length),T=!m;let k=!1,A=ie(!1),D=ie(!1),E=ie(""),G=ie(!1),N=ie(!1);ot(()=>{k||(z(A,c()?.getItemConfig(n.node.id)?.isOpenOnInit??!1,!0),k=!0)}),ot(()=>{if(!n.node)return;const B=n.getNodeVisibility?n.getNodeVisibility(n.node.id):!1;z(D,B??!1,!0),n.node instanceof ct&&z(E,Aa(n.node.layer,d(),m,u(A)),!0)}),ot(()=>{if(!(n.node instanceof ct))return;const B=(n.getDownloadState?.(n.node)===rt.Active&&n.node.layer.type==="feature")??!1;B&&!u(G)?(z(G,!0),z(N,!1)):!B&&u(G)&&(z(N,!0),setTimeout(()=>{z(G,!1),z(N,!1)},180))});function M(){!T||!n.onNodeVisibilityChange||(z(D,!u(D)),n.onNodeVisibilityChange(n.node,u(D)))}function H(){n.onNodeClick?.(n.node)}function j(){z(A,!u(A)),n.onNodeClick?.(n.node)}{let B=ge(()=>m?n.node.children:null);Oa(x,{get isOpen(){return u(A)},get content(){return o},get childNodes(){return u(B)},get childNode(){return s}})}He()}class fu{#e;#t;constructor(n,o){this.#e=n,this.#t=o}updateSelection(n,o){if(!this.#t.getItemConfig(n.id)?.isHidden){if(!(n instanceof ct)){this.updateChildrenSelection(n,o);return}if(n instanceof On){this.updateFieldSelection(n,o);return}this.updateLayerSelection(n,o)}}getSelectionState(n){if(!(n instanceof ct))return this.determineSelectionStateFromChildren(n);if(this.isGroupLayer(n))return this.determineSelectionStateFromChildren(n);let o;return n instanceof On?(o=this.#e.getSelection(n.featureLayer.id),o&&o.fields.has(n.field.name)?rt.Active:rt.Inactive):(o=this.#e.getSelection(n.id),o?this.isFeatureLayer(n)&&n.children&&n.children.length>0?this.determineSelectionStateFromChildren(n):rt.Active:rt.Inactive)}updateLayerSelection(n,o){let s=this.#e.getSelection(n.id);switch(o){case rt.Active:!s&&!this.isGroupLayer(n)&&(s=this.createAndAddDataSelection(n.id,n.layer));for(const c of n.children||[])this.updateSelection(c,o);break;case rt.Inactive:s&&!this.isGroupLayer(n)&&this.#e.removeSelection(n.id),this.updateChildrenSelection(n,o);break}}updateFieldSelection(n,o){let s=this.#e.getSelection(n.featureLayer.id);switch(o){case rt.Active:s||(s=this.createAndAddDataSelection(n.featureLayer.id,n.featureLayer)),s.fields.add(n.field.name);break;case rt.Inactive:if(!s)break;s.fields.delete(n.field.name),s.fields.size===0&&this.#e.removeSelection(s.layerId);break}}updateChildrenSelection(n,o){for(const s of n.children||[])this.updateSelection(s,o)}determineSelectionStateFromChildren(n){let o=0,s=0;for(const c of n.children||[]){if(this.#t.getItemConfig(c.id)?.isHidden)continue;s++;const d=this.getSelectionState(c);if(d===rt.Active||this.isFeatureLayer(c)&&d!==rt.Inactive)o++;else if(d===rt.Indeterminate)return rt.Indeterminate}return o===0?rt.Inactive:o===s?rt.Active:rt.Indeterminate}createAndAddDataSelection(n,o){const s={layerId:n,layer:o,fields:new xn};return this.#e.addSelection(s),s}isGroupLayer(n){return n instanceof ct&&n.layer.type==="group"}isFeatureLayer(n){return n instanceof ct&&n.layer.type==="feature"}}function hu(x,n){Re(n,!0);const o=Ee(n,"webMap",3,null),s=Ee(n,"fieldFilterMenuStore",7);function c(){h.clearSelections()}const h=new Ia,d=new fu(kt,n.treeviewConfigStore);ot(()=>{if(!o()||h.initialized)return;(async()=>{await o().when(),await m(o().layers.toArray());const j=new au(n.treeviewConfigStore);h.initialize(o().layers.toArray(),n.treeviewConfigStore,[j],n.customRendererService)})()});async function m(H){for(const j of H)j.type==="feature"&&!j.loaded&&(await j.load(),console.log("Loaded feature layer:",j.title)),j.type==="group"&&await m(j.layers.toArray())}function T(H,j){d.updateSelection(H,j)}function k(H){return d.getSelectionState(H)}function A(H){if(s().ActiveLayer?.uid===H){s().ActiveLayer=null;return}const B=h.getNodeById(H);!B||!(B instanceof ct)||(s().ActiveLayer=B.layer)}function D(H){const j=kt.getSelection(H);if(!j?.fields)return!1;const B=h.getNodeById(H);if(!B||!(B instanceof ct))return!1;const V=B.layer.fields?.length||0,Y=j.fields.size;return Y>0&&Y!==V}var E={clearSelections:c},G=le(),N=$(G);{var M=H=>{var j=le(),B=$(j);De(B,()=>Sa,(V,Y)=>{Y(V,{children:(ve,te)=>{var ce=le(),_e=$(ce);zt(_e,17,()=>h.getNodes(),Ae=>Ae.id,(Ae,de)=>{{let Se=ge(()=>n.treeviewConfigStore.getItemConfig(u(de).id)?.isDownloadable??!0);Ea(Ae,{get treeviewConfigStore(){return n.treeviewConfigStore},get node(){return u(de)},get isDownloadable(){return u(Se)},onNodeClick:()=>{},onNodeVisibilityChange:(X,ue)=>h.setVisibilityState(X.id,ue),getNodeVisibility:X=>h.getVisibilityState(X),onDownloadStateChanged:T,getDownloadState:k,onFilterClicked:A,hasFiltersApplied:D,depth:0,useLayerTypeIcon:!0})}}),F(ve,ce)},$$slots:{default:!0}})}),F(H,j)};me(N,H=>{h.initialized&&H(M)})}return F(x,G),He(E)}class vu{#e=ie(null);get mapView(){return u(this.#e)}set mapView(n){z(this.#e,n,!0)}#t=ie(Je(new Set));get interactableLayers(){return u(this.#t)}set interactableLayers(n){z(this.#t,n,!0)}pointerMoveHandle=null;clickHandle=null;leaveHandle=null;enterHandle=null;#r=ie(!1);get isInitialized(){return u(this.#r)}set isInitialized(n){z(this.#r,n,!0)}#i=ie(!0);get pointerInsideMap(){return u(this.#i)}set pointerInsideMap(n){z(this.#i,n,!0)}initializationInProgress=!1;async initializeAsync(n,o){if(console.log("[map-interaction-store] Initializing with MapView"),this.mapView===n&&this.isInitialized){console.log("[map-interaction-store] MapView is already initialized"),this.interactableLayers=o;return}if(this.initializationInProgress){console.log("[map-interaction-store] Initialization already in progress");return}this.initializationInProgress=!0,console.log("[map-interaction-store] Cleaning up previous MapView if any"),this.cleanup(),this.mapView=n,this.interactableLayers=o,await n.when(),this.setupHighlights(n),this.setupPointerMoveHandler(n),this.setupClickHandler(n),this.setupLeaveHandler(n),this.setupEnterHandler(n),this.isInitialized=!0,console.log("[map-interaction-store] Initialized with MapView"),this.initializationInProgress=!1}updateInteractableLayers(n){this.interactableLayers=n}setupHighlights(n){const o={name:"hover",color:"lightgreen",haloOpacity:1,fillOpacity:.2},s={name:"selected",color:"green",haloOpacity:1,fillOpacity:.3};n.highlights.push(o),n.highlights.push(s)}setupPointerMoveHandler(n){this.pointerMoveHandle=n.on("pointer-move",async o=>{if(!this.pointerInsideMap)return;const{results:s}=await n.hitTest(o),c=s[0];if(!c){this.clearHoverHighlight();return}const h=c.graphic,d=h.layer;if(!h||!d||!this.isLayerInteractable(d.id)||h.attributes?.[d.objectIdField]===void 0){this.clearHoverHighlight();return}const m=h.attributes?.[d.objectIdField];if(!(Ne.currentHoveredArea&&Ne.currentHoveredArea.id===m))try{const T=await n.whenLayerView(d);Ne.layerHighlightState.featureLayerView!==T&&Ne.setSelectedLayerView(T),this.clearHoverHighlight();const k=T;if(!k){console.warn("LayerView is not a FeatureLayerView");return}if(!this.pointerInsideMap)return;const A=k.highlight(h,{name:"hover"});Ne.setHoveredArea(m,A)}catch(T){console.error("Error in pointer-move handler:",T),this.clearHoverHighlight()}})}setupClickHandler(n){this.clickHandle=n.on("click",async o=>{const{results:s}=await n.hitTest(o),c=s[0];if(!c)return;const h=c.graphic,d=h.layer;if(!h||!d||!this.isLayerInteractable(d.id)||h.attributes?.[d.objectIdField]===void 0)return;const m=h.attributes?.[d.objectIdField];try{const T=await n.whenLayerView(d),k=T;if(!k){console.warn("Layer is not a FeatureLayerView");return}Ne.layerHighlightState.featureLayerView!==T&&Ne.setSelectedLayerView(T);const D=(Ne.layerHighlightState.areaInfos||[]).find(E=>E.id===m);if(D)Ne.removeSelectedArea(D.id);else{const E=k.highlight(h,{name:"selected"});Ne.addSelectedArea(m,E)}}catch(T){console.error("Error in click handler:",T)}})}setupLeaveHandler(n){this.leaveHandle=n.on("pointer-leave",()=>{this.pointerInsideMap=!1,this.clearHoverHighlight()})}setupEnterHandler(n){this.enterHandle=n.on("pointer-enter",()=>{this.pointerInsideMap=!0})}isLayerInteractable(n){return this.interactableLayers.has(n)}clearHoverHighlight(){Ne.currentHoveredArea&&Ne.clearHoveredArea()}cleanup(){this.pointerMoveHandle&&(this.pointerMoveHandle.remove(),this.pointerMoveHandle=null),this.clickHandle&&(this.clickHandle.remove(),this.clickHandle=null),this.leaveHandle&&(this.leaveHandle.remove(),this.leaveHandle=null),this.enterHandle&&(this.enterHandle.remove(),this.enterHandle=null),this.clearHoverHighlight(),this.isInitialized=!1,this.mapView=null,this.pointerInsideMap=!0,this.interactableLayers=new Set,console.log("[map-interaction-store] cleaned up")}get currentMapView(){return this.mapView}get initialized(){return this.isInitialized}}const Cr=new vu;var pu=se('<div class="esri-ui-element svelte-i0p9uk"><!></div>'),gu=se('<div class="esri-ui-element svelte-i0p9uk"><!></div>'),mu=se('<div class="map-view svelte-i0p9uk"></div> <!> <!>',1);function yu(x,n){Re(n,!0);const o=Ee(n,"webMap",3,null),s=Ee(n,"panelPosition",3,"top-left"),c=Ee(n,"menuPosition",3,"top-right");let h=null,d=ie(null),m=ie(null),T=ie(null),k=ie(!1);const A="streets-vector";let D,E;kn(async()=>{await G(),await B()});async function G(){if(!E){const[{default:X},{default:ue},{default:xe},{default:Le}]=await Promise.all([yr(()=>import("../chunks/D2R8NS53.js").then(ae=>ae.M),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39]),import.meta.url),yr(()=>import("../chunks/7w27tvP3.js").then(ae=>ae.a3),__vite__mapDeps([40,1,2,3,5,41,24,42,22,6,7,43,32,44,20,21,45,8,9,10,11,25,46,47,17,33,48,49,50,26,51,52,15,53,0,4,12,13,14,16,18,19,23,27,28,29,30,31,34,35,36,37,38,39,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93]),import.meta.url),yr(()=>import("../chunks/DwW2UUp6.js").then(ae=>ae.W),__vite__mapDeps([94,1,2,3,5,6,7,0,4,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,95,96,97,98,67,99,100,80,81,71,55,56,57,58,59,60,61,62,63,64,65,101,102,103,70,66,104,105,106,107,69,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,46,47,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178]),import.meta.url),yr(()=>import("../chunks/Gr_8PAej.js"),__vite__mapDeps([101,5,1,2,3,56,24,8,9,10,11,7,6,57,23,20,21,22,39,95,102,103,70,71,66,104,105,106,38,13,67,107,15,26,69,43,32,44,19,108,109,110,111,61,112,55,58,59,60,12,62,63,64,65,113,114,115,116,117,118,119,120,121,122,123,124,125,126,96,33,46,47,17,127,128,129,130,131,132,133,134,34,35,36,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,45,151,152,153,154,155,156,157,158,159,160,161,28,162,163,164,16,165,166,167,98,168,169,170,171,172,173,174,175,97]),import.meta.url)]);D=X,E=ue}}async function N(X,ue){const xe=new E({container:ue,popupEnabled:!1,map:X});return await xe.when(),xe}function M(X){X.ui.move("zoom","top-right"),u(m)&&s()&&X.ui.add(u(m),s()),u(T)&&c()&&X.ui.add(u(T),c()),z(k,!0)}async function H(){return new D({basemap:A})}async function j(){if(o())try{if(await G(),await B(),!u(d)){console.error("MapView is not initialized");return}u(d).map=o(),console.log("[uprn-map-view] MapView updated with new webMap")}catch(X){console.error("Error updating MapView with new webMap:",X)}}async function B(){if(!h){console.error("Map container element was not found");return}try{z(d,await N(o()??void 0,h),!0),M(u(d)),console.log("[uprn-map-view] Map loaded successfully")}catch(X){console.error("Error loading map:",X),await V()}}async function V(){try{const X=await H();z(d,await N(X,h),!0),M(u(d)),console.log("[uprn-map-view] Fallback map loaded")}catch(X){console.error("Error loading fallback map:",X)}}ot(()=>{o()&&j()}),ot(()=>{if(!u(d)||!n.areaSelectionTreeviewStore.initialized)return;const X=n.areaSelectionTreeviewStore.getNonHiddenNodes().map(ue=>ue.id);Cr.initialized?Cr.updateInteractableLayers(new Set(X)):Cr.initializeAsync(u(d),new Set(X))}),ot(()=>{if(!n.areaSelectionTreeviewStore.initialized)return;if(!n.areaSelectionTreeviewStore.getVisibleNodes().length){Ne.resetSelectedAreas();return}const X=n.areaSelectionTreeviewStore.getVisibleNodes()[0];if(!X||!(X instanceof ct)){console.warn("Visible node is not a FeatureLayer");return}if(!X.layer){console.warn("Visible node layer is not a FeatureLayer");return}Y(X.layer)});async function Y(X){if(!u(d))return;const ue=await u(d).whenLayerView(X);if(!ue){console.warn("Could not get LayerView for the visible node layer");return}Ne.setSelectedLayerView(ue)}function ve(){u(d)&&u(d).destroy()}ya(()=>{ve()});var te=mu(),ce=$(te);Mt(ce,X=>h=X,()=>h);var _e=fe(ce,2);{var Ae=X=>{var ue=pu(),xe=Q(ue);{var Le=ae=>{var we=le(),ke=$(we);$e(ke,()=>n.panel),F(ae,we)};me(xe,ae=>{u(k)&&ae(Le)})}U(ue),Mt(ue,ae=>z(m,ae),()=>u(m)),F(X,ue)};me(_e,X=>{n.panel&&X(Ae)})}var de=fe(_e,2);{var Se=X=>{var ue=gu(),xe=Q(ue);{var Le=ae=>{var we=le(),ke=$(we);$e(ke,()=>n.menu),F(ae,we)};me(xe,ae=>{u(k)&&ae(Le)})}U(ue),Mt(ue,ae=>z(T,ae),()=>u(T)),F(X,ue)};me(de,X=>{n.menu&&X(Se)})}F(x,te),He()}var bu=se('<div class="min-w-0 space-y-2 overflow-hidden p-4"><!></div>'),wu=se('<div class="flex min-h-0 flex-1 flex-col"><!></div>');function Sr(x,n){var o=wu(),s=Q(o);De(s,()=>Or,(c,h)=>{h(c,{class:"card-content flex min-h-0 flex-1 flex-col overflow-hidden p-0",children:(d,m)=>{var T=bu(),k=Q(T);$e(k,()=>n.children??Qe),U(T),F(d,T)},$$slots:{default:!0}})}),U(o),F(x,o)}var _u=se("<!> <!>",1),Su=se('<div class="tab-list-wrapper flex-shrink-0 svelte-rohqkk"><!></div> <!>',1);function xu(x,n){Re(n,!0);const o=Ee(n,"triggers",19,()=>[]);var s=le(),c=$(s);De(c,()=>Xo,(h,d)=>{d(h,{get value(){return n.value},get onValueChange(){return n.onValueChange},class:"flex h-full w-full flex-col",children:(m,T)=>{var k=Su(),A=$(k),D=Q(A);De(D,()=>Zo,(G,N)=>{N(G,{class:"tab-list",children:(M,H)=>{var j=le(),B=$(j);zt(B,17,o,An,(V,Y,ve,te)=>{let ce=()=>u(Y).value,_e=()=>u(Y).label;var Ae=_u(),de=$(Ae);De(de,()=>es,(ue,xe)=>{xe(ue,{get value(){return ce()},class:"tab-trigger",children:(Le,ae)=>{dn();var we=Cn();ut(()=>Ot(we,_e())),F(Le,we)},$$slots:{default:!0}})});var Se=fe(de,2);{var X=ue=>{Io(ue,{class:"separator"})};me(Se,ue=>{ce()!==o()[o().length-1]?.value&&ue(X)})}F(V,Ae)}),F(M,j)},$$slots:{default:!0}})}),U(A);var E=fe(A,2);$e(E,()=>n.children??Qe),F(m,k)},$$slots:{default:!0}})}),F(x,s),He()}const Be=Object.freeze({LEFT:"left",RIGHT:"right",TOP:"top",BOTTOM:"bottom"});var Cu=se("<!> <div><aside><div><div><!></div></div></aside></div> <!>",1);function ku(x,n){Re(n,!0);const o=Ee(n,"position",19,()=>Be.LEFT),s=Ee(n,"openIcon",3,Cs),c=8,h="500px",d="var(--header-height, 64px)";let m,T=ie(0),k=ie(Je(n.originalSize??h)),A=ie(!1),D=ie(!1);const E=ge(()=>o()===Be.LEFT||o()===Be.RIGHT),G=ge(()=>o()===Be.LEFT||o()===Be.TOP),N=ge(()=>u(E)?"500px":"100px"),M=ge(()=>n.minSize??u(N)),H=ge(()=>parseFloat(u(M))),j=ge(()=>u(E)?"width":"height"),B=ge(()=>u(E)?"ew-resize":"ns-resize");ot(()=>{u(D)||(z(k,n.originalSize??u(M),!0),console.log("Sidebar size updated due to minSize/originalSize change:",u(k),n.originalSize))}),kn(()=>{if(!m)return;const ye=new ResizeObserver(Ce=>{for(const je of Ce)z(T,u(E)?je.contentRect.width:je.contentRect.height,!0)});return ye.observe(m),()=>ye.disconnect()});function V(ye){if(!n.isOpen)return;z(A,!0),ye.preventDefault();const Ce=u(E)?ye.clientX:ye.clientY,je=parseFloat(u(k));function tt(Ge){const qe=u(E)?Ge.clientX:Ge.clientY,be=u(G)?qe-Ce:Ce-qe,Ue=Math.max(u(H),je+be);z(k,`${Ue}px`),z(D,!0)}function ne(){z(A,!1),document.removeEventListener("mousemove",tt),document.removeEventListener("mouseup",ne),document.body.style.cursor="",document.body.style.userSelect=""}document.addEventListener("mousemove",tt),document.addEventListener("mouseup",ne),document.body.style.cursor=u(B),document.body.style.userSelect="none"}const Y=ge(()=>()=>{const ye=n.isOpen?u(k):"0px";return{[Be.LEFT]:{top:d,left:ye},[Be.RIGHT]:{top:d,right:ye},[Be.TOP]:{top:ye},[Be.BOTTOM]:{bottom:ye}}[o()]}),ve=ge(()=>()=>({[Be.LEFT]:_s,[Be.RIGHT]:ts,[Be.TOP]:Ss,[Be.BOTTOM]:ws})[o()]),te=ge(()=>()=>{if(!n.isOpen)return{};const ye=`${c}px`,Ce=n.isOpen?`calc(${u(k)} + ${-c/2}px)`:"0px";return{[Be.LEFT]:{left:Ce,top:"0",width:ye,height:"100%"},[Be.RIGHT]:{right:Ce,top:"0",width:ye,height:"100%"},[Be.TOP]:{top:Ce,left:"0",height:ye,width:"100%"},[Be.BOTTOM]:{bottom:Ce,left:"0",height:ye,width:"100%"}}[o()]});function ce(ye){return Object.entries(ye).map(([Ce,je])=>`${Ce}: ${je}`).join("; ")}const _e=ge(()=>u(G)?0:1),Ae=ge(()=>()=>n.isOpen?"translate(0, 0)":{[Be.LEFT]:`translate(-${u(k)}, 0)`,[Be.RIGHT]:`translate(${u(k)}, 0)`,[Be.TOP]:`translate(0, -${u(k)})`,[Be.BOTTOM]:`translate(0, ${u(k)})`}[o()]),de=ge(()=>()=>{const ye=n.isOpen?u(k):"0px";return{[u(j)]:ye,order:`${u(_e)}`}});var Se=Cu(),X=$(Se);{let ye=ge(()=>u(A)?"":"transition-all duration-300"),Ce=ge(()=>ce(u(Y)())),je=ge(()=>u(A)?"transition: none !important;":""),tt=ge(()=>n.isOpen?"Close sidebar":"Open sidebar");At(X,{get onclick(){return n.onToggle},variant:"default",size:"icon",get class(){return`fixed z-2 -ml-1 inline-flex size-7 
	shrink-0 items-center justify-center gap-2 overflow-hidden rounded-md bg-background text-sm
	font-medium whitespace-nowrap shadow-none outline-hidden transition-all select-none hover:bg-accent focus-visible:border-ring 
	focus-visible:ring-[3px] focus-visible:ring-ring/50 disabled:pointer-events-none disabled:opacity-50 aria-invalid:border-destructive aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 ${u(ye)??""}`},get style(){return`${u(Ce)??""}; pointer-events: auto; ${u(je)??""}`},get"aria-label"(){return u(tt)},get"aria-expanded"(){return n.isOpen},children:(ne,Ge)=>{var qe=le(),be=$(qe);{var Ue=We=>{const _t=ge(()=>u(ve)());var ht=le(),vt=$(ht);De(vt,()=>u(_t),(Ve,at)=>{at(Ve,{class:"h-6 w-6 text-primary"})}),F(We,ht)},wt=We=>{const _t=ge(s);var ht=le(),vt=$(ht);De(vt,()=>u(_t),(Ve,at)=>{at(Ve,{class:"h-6 w-6 text-primary"})}),F(We,ht)};me(be,We=>{n.isOpen?We(Ue):We(wt,!1)})}F(ne,qe)},$$slots:{default:!0}})}var ue=fe(X,2);let xe;var Le=Q(ue);let ae;var we=Q(Le);let ke;var pe=Q(we);let Fe;var Xe=Q(pe);{var et=ye=>{var Ce=le(),je=$(Ce);$e(je,()=>n.children),F(ye,Ce)};me(Xe,ye=>{n.children&&ye(et)})}U(pe),U(we),U(Le),Mt(Le,ye=>m=ye,()=>m),U(ue);var Ze=fe(ue,2);{var it=ye=>{{let Ce=ge(()=>u(E)?"cursor-ew-resize":"cursor-ns-resize"),je=ge(()=>u(A)?"":"transition-all duration-300"),tt=ge(()=>ce(u(te)()));At(ye,{get class(){return`fixed z-40 border-0 bg-transparent p-0 ring-0 transition-colors outline-none hover:!bg-primary/50 focus-visible:ring-0 ${u(Ce)??""} ${u(je)??""}`},onmousedown:V,"aria-label":"Resize sidebar by dragging",get style(){return`${u(tt)??""}; outline: none !important; box-shadow: none !important; border: none !important;`}})}};me(Ze,ye=>{n.isOpen&&ye(it)})}ut((ye,Ce,je,tt,ne,Ge)=>{xe=en(ue,1,"relative z-3 h-full w-full overflow-hidden transition-all duration-300",null,xe,ye),In(ue,Ce),ae=en(Le,1,"border-r-bg-sidebar-border relative flex border-r-1 bg-sidebar text-sidebar-foreground shadow-lg",null,ae,je),In(Le,`${u(j)??""}: ${u(k)??""}; transform: ${tt??""};`),ke=en(we,1,"flex overflow-hidden",null,ke,ne),Fe=en(pe,1,"flex overflow-hidden",null,Fe,Ge)},[()=>({"h-full":u(E),"w-full":!u(E),"transition-all":!u(A),"duration-300":!u(A)}),()=>ce(u(de)()),()=>({"flex-col":u(E),"flex-row":!u(E),"h-full":u(E),"w-full":!u(E),"border-r":o()===Be.LEFT,"border-l":o()===Be.RIGHT,"border-b":o()===Be.TOP,"border-t":o()===Be.BOTTOM,"border-sidebar-border":!0,"transition-transform":!u(A),"duration-300":!u(A)}),()=>u(Ae)(),()=>({"flex-col":u(E),"flex-row":!u(E),"h-full":u(E),"w-full":!u(E)}),()=>({"flex-col":u(E),"flex-row":!u(E),"h-full":u(E),"w-full":!u(E)})]),F(x,Se),He()}var Iu=se('<div><!> <div class="main-content svelte-f4u9lw"><!></div></div>');function Au(x,n){Re(n,!0);const o=Ee(n,"position",19,()=>Be.LEFT),s=ge(()=>o()===Be.TOP||o()===Be.BOTTOM);var c=Iu();let h;var d=Q(c);ku(d,{get isOpen(){return n.isOpen},get onToggle(){return n.onToggle},get position(){return o()},get originalSize(){return n.originalSize},get minSize(){return n.minSize},get openIcon(){return n.openIcon},children:(A,D)=>{var E=le(),G=$(E);{var N=M=>{var H=le(),j=$(H);$e(j,()=>n.sidebarContent),F(M,H)};me(G,M=>{n.sidebarContent&&M(N)})}F(A,E)},$$slots:{default:!0}});var m=fe(d,2),T=Q(m);{var k=A=>{var D=le(),E=$(D);$e(E,()=>n.mainContent),F(A,D)};me(T,A=>{n.mainContent&&A(k)})}U(m),U(c),ut(A=>h=en(c,1,"sidebar-layout svelte-f4u9lw",null,h,A),[()=>({vertical:u(s)})]),F(x,c),He()}var Ou=se('<div class="min-w-0 space-y-2 overflow-hidden"><!></div>'),Pu=se('<div class="w-full flex-1 overflow-hidden pr-1.5 pl-1.5"><!></div>');function Tu(x,n){var o=Pu(),s=Q(o);wa(s,{class:"h-full w-full",children:(c,h)=>{var d=Ou(),m=Q(d);{var T=k=>{var A=le(),D=$(A);$e(D,()=>n.children),F(k,A)};me(m,k=>{n.children&&k(T)})}U(d),F(c,d)},$$slots:{default:!0}}),U(o),F(x,o)}var Eu=se('<div class="w-full flex-shrink-0"><!></div>');function Fu(x,n){var o=Eu(),s=Q(o);{var c=h=>{var d=le(),m=$(d);$e(m,()=>n.children),F(h,d)};me(s,h=>{n.children&&h(c)})}U(o),F(x,o)}var Du=se('<div class="w-full flex-shrink-0"><!></div>');function Lu(x,n){var o=Du(),s=Q(o);{var c=h=>{var d=le(),m=$(d);$e(m,()=>n.children),F(h,d)};me(s,h=>{n.children&&h(c)})}U(o),F(x,o)}const Mu=[{value:"define-areas",label:"Define Areas"},{value:"select-data",label:"Select Data"},{value:"export",label:"Export"},{value:"downloads",label:"Download"}];class Nu{#e;constructor(n){if(!n)throw new Error("UprnDownloadService endpoints configuration is required");if(!n.baseUrl||!n.healthRoute||!n.requestJobRoute||!n.requestJobStatusesRoute||!n.getAreaSelectionLimitsRoute||!n.fetchDownloadRoute)throw new Error("UprnDownloadService endpoints configuration is incomplete");this.#e=n}async getHealth(){try{const n=`${this.#e.baseUrl}${this.#e.healthRoute}`,o=await fetch(n);return o.ok?(await o.json()).status==="ok":!1}catch(n){return console.error("Health check failed:",n),!1}}async requestJob(n){try{console.log("[uprn-download-service] requesting job with request:",n);const o=`${this.#e.baseUrl}${this.#e.requestJobRoute}`,s=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!s.ok){console.error("Failed to request job:",s.statusText,"request:",JSON.stringify(n));return}return await s.json()}catch(o){console.error("Error requesting job:",o);return}}async requestJobStatuses(n){try{const o=`${this.#e.baseUrl}${this.#e.requestJobStatusesRoute}`,s=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!s.ok){console.error("Failed to get job statuses:",s.statusText);return}return await s.json()}catch(o){console.error("Error getting job statuses:",o);return}}async getSelectionAreaLimits(){try{const n=`${this.#e.baseUrl}${this.#e.getAreaSelectionLimitsRoute}`,o=await fetch(n);if(!o.ok){console.error("Failed to get area selection limits:",o.statusText);return}return await o.json()}catch(n){console.error("Error getting selection area limits:",n);return}}getDownloadUrl(n){const o=this.#e.baseUrl.replace(/\/+$/,""),s=this.#e.fetchDownloadRoute.replace(/\/+$/,"");return`${o}${s}/${encodeURIComponent(n)}`}}class Ru{#e;constructor(n){this.#e=n}async getHealth(){try{const n=`${this.#e.baseUrl}${this.#e.healthRoute}`,o=await fetch(n);return o.ok?(await o.json()).status==="ok":!1}catch(n){return console.error("Health check failed:",n),!1}}async chat(n){try{const o=`${this.#e.baseUrl}${this.#e.chatRoute}`,c=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:n})});if(!c.ok){console.error("Failed to send chat query:",c.statusText);return}return await c.json()}catch(o){console.error("Error sending chat query:",o);return}}async chatStream(n,o){try{const s=`${this.#e.baseUrl}${this.#e.chatStreamRoute}`,h=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:n})});if(!h.ok)return console.error("Failed to start chat stream:",h.statusText),!1;const d=h.body?.getReader();if(!d)return console.error("No response body reader available"),!1;const m=new TextDecoder;let T=!1;for(;!T;){const{value:k,done:A}=await d.read();if(T=A,k){const D=m.decode(k,{stream:!T});o(D)}}return!0}catch(s){return console.error("Error during chat stream:",s),!1}}}const Hu=Object.freeze({lod00World:{lod:0,scale:591657527591555e-6},lod01World:{lod:1,scale:295828763795777e-6},lod02World:{lod:2,scale:147914381897889e-6},lod03Continent:{lod:3,scale:73957190948944e-6},lod04Continent:{lod:4,scale:36978595474472e-6},lod05Countries:{lod:5,scale:18489297737236e-6},lod06Country:{lod:6,scale:9244648868618e-6},lod07StatesProvinces:{lod:7,scale:4622324434309e-6},lod08Counties:{lod:8,scale:2311162217155e-6},lod09Counties:{lod:9,scale:1155581108577e-6},lod10Country:{lod:10,scale:577790.554289},lod11MetropolitanArea:{lod:11,scale:288895.277144},lod12Cities:{lod:12,scale:144447.638572},lod13City:{lod:13,scale:72223.819286},lod14Town:{lod:14,scale:36111.909643},lod15Neighborhood:{lod:15,scale:18055.954822},lod16Streets:{lod:16,scale:9027.977411},lod17CityBlock:{lod:17,scale:4513.988705},lod18Buildings:{lod:18,scale:2256.994353},lod19Building:{lod:19,scale:1128.497176},lod20Houses:{lod:20,scale:564.248588},lod21Houses:{lod:21,scale:282.124294},lod22Houses:{lod:22,scale:141.062147},lod23HouseProperty:{lod:23,scale:70.5310735}});class ju{#e=null;#t=!1;async init(n){this.#t||(await this.#r(n),this.#t=!0)}async#r(n){const s=await(await fetch(n)).json();this.#e=s}doesFieldHaveCustomRenderer(n,o){this.#u();const s=this.#e.FeatureLayers.find(d=>d.Name===n.title);if(!s)return!1;const c=this.#e.Fields.find(d=>d.FeatureLayerId===s.Id&&d.Name===o);return c?!!this.#e.CustomRenderers_Fields.find(d=>d.FieldId===c.Id):!1}getAllFieldsWithCustomRenderers(n){this.#u();const o=this.#e.FeatureLayers.find(h=>h.Name===n.title);if(!o)return[];const s=this.#e.Fields.filter(h=>h.FeatureLayerId===o.Id),c=[];for(const h of s)this.#e.CustomRenderers_Fields.some(m=>m.FieldId===h.Id)&&c.push(h.Name);return c}async applyCustomRenderer(n,o){this.#u();const s=this.#e.FeatureLayers.find(A=>A.Name===n.title);if(!s)return;const c=this.#e.Fields.find(A=>A.FeatureLayerId===s.Id&&A.Name===o);if(!c){console.warn(`[custom-renderer-service] could not find the field ${o} for feature layer id ${s.Id}`);return}const h=this.#e.CustomRenderers_Fields.find(A=>A.FieldId===c.Id);if(!h){console.warn(`[custom-renderer-service] could not find a custom renderer field for field ${o} in feature layer id ${s.Id}`);return}const d=this.#e.CustomRenderers.find(A=>A.Id===h.CustomRendererId);if(!d)throw new Error(`Could not find a custom renderer with the id ${h.CustomRendererId}`);const m=await this.getRendererClassBreaks(d.ClassBreaksGroupId.toString()),T=await this.getRendererSymbols(d.SymbolsId.toString()),k=this.#n(d.CustomRendererType,T,m,[],o);n.renderer=k,this.setCustomOutlines(n,d.LodsGroupId)}async setCustomOutlines(n,o){const s=this.#e.CustomRenderers_Lods.filter(d=>d.GroupId===o).sort((d,m)=>d.Lod-m.Lod);if(s.length===0){console.warn(`No LODs found for LODs group id ${o}`);return}const c=[],h=Object.values(Hu);s.forEach(d=>{const m=d.OutlineWidth,T=d.Lod,k=this.#i(h,T)-1;c.push({size:m,value:h[k].scale})}),(n.renderer instanceof ra||n.renderer instanceof ia)&&this.#s(n.renderer,c)}async getRendererClassBreaks(n){const o=parseInt(n,10),s=this.#e.CustomRenderers_ClassBreaks.filter(c=>c.GroupId===o).sort((c,h)=>c.Order-h.Order);if(s.length===0)throw new Error(`Could not find a group with the id ${n}`);return s}async getRendererSymbols(n){const o=parseInt(n,10),s=this.#e.CustomRenderers_Symbols.find(d=>d.Id===o);if(!s)throw new Error(`Could not find a symbol with the id ${n}`);const c=this.#e.CustomRenderers_Symbols_Appearances.filter(d=>d.SymbolsId===o).sort((d,m)=>d.Order-m.Order);return{...s,Appearances:c}}#i(n,o){const s=n.findIndex(c=>c.lod===o);return s===-1?0:s<23?s+1:s}#n(n,o,s,c,h){switch(n){case 1:return this.#l(o,c);case 2:return this.#a(h,o,s,c);default:throw new Error(`Unknown renderer type: ${n}`)}}#a(n,o,s,c){const h="ClassMinValue",d="ClassMaxValue",m="SymbolColor",T="OutlineColor",k="OutlineWidth",A=o.Appearances.length,D=new ra({field:n});for(let E=0;E<A;E++){const G=s[E][h],N=s[E][d],M=o.Appearances[E][m],H=o.Appearances[E][T],j=o.Appearances[E][k];D.addClassBreakInfo({minValue:G,maxValue:N,symbol:new aa({color:br.fromHex(M),outline:new oa({color:br.fromHex(H),width:j})})})}return this.#s(D,c),D}#l(n,o){const s="SymbolColor",c="OutlineColor",h="OutlineWidth",d=n.Appearances[0][s],m=n.Appearances[0][c],T=n.Appearances[0][h],k=new ia({symbol:new aa({color:br.fromHex(d),outline:new oa({color:br.fromHex(m),width:T})})});return this.#s(k,o),k}#s(n,o){n.visualVariables=[{type:"size",target:"outline",valueExpression:"$view.scale",stops:o}]}#u(){if(!this.#t)throw new Error("CustomRendererService is not initialized");if(!this.#e)throw new Error("Data is not loaded")}}var zu=se('<div class="flex w-full items-center justify-between"><div class="font-medium">Chat</div> <div class="flex gap-1"><!> <!></div></div>'),Ku=se("<!> <!>",1),Vu=se("<div><!></div>");function Bu(x,n){Re(n,!0);const o=Ee(n,"isOpenedOnInit",3,!1);let s=ie(!1),c=ie(Je(o())),h=ie(!1),d=ie(void 0),m="300px",T="45px";ot(()=>{u(s)||!u(d)||(u(c)&&(u(d).style.height=m),z(s,!0))});function k(){u(d)&&(z(c,!u(c)),z(h,!1),u(c)?(T=u(d).style.height,u(d).style.height=m):u(d).style.height=T)}function A(){u(d)&&(z(h,!u(h)),u(h)?(m=u(d).style.height,u(d).style.height="100%"):u(d).style.height=m)}var D=Vu(),E=Q(D);De(E,()=>Pr,(G,N)=>{N(G,{class:"h-full w-full gap-0 rounded-none py-0 pt-0 pb-0",children:(M,H)=>{var j=Ku(),B=$(j);De(B,()=>as,(ve,te)=>{te(ve,{class:"pt-2",children:(ce,_e)=>{var Ae=zu(),de=fe(Q(Ae),2),Se=Q(de);{var X=xe=>{At(xe,{class:"size-7",onclick:A,children:(Le,ae)=>{var we=le(),ke=$(we);{var pe=Xe=>{Ts(Xe,{})},Fe=Xe=>{Ps(Xe,{})};me(ke,Xe=>{u(h)?Xe(pe):Xe(Fe,!1)})}F(Le,we)},$$slots:{default:!0}})};me(Se,xe=>{u(c)&&xe(X)})}var ue=fe(Se,2);At(ue,{class:"size-7",onclick:k,children:(xe,Le)=>{var ae=le(),we=$(ae);{var ke=Fe=>{Os(Fe,{})},pe=Fe=>{ds(Fe,{})};me(we,Fe=>{u(c)?Fe(pe,!1):Fe(ke)})}F(xe,ae)},$$slots:{default:!0}}),U(de),U(Ae),F(ce,Ae)},$$slots:{default:!0}})});var V=fe(B,2);{var Y=ve=>{var te=le(),ce=$(te);De(ce,()=>Or,(_e,Ae)=>{Ae(_e,{class:"h-full min-h-[10px] w-full p-0",children:(de,Se)=>{var X=le(),ue=$(X);$e(ue,()=>n.children??Qe),F(de,X)},$$slots:{default:!0}})}),F(ve,te)};me(V,ve=>{u(c)&&ve(Y)})}F(M,j)},$$slots:{default:!0}})}),U(D),Mt(D,G=>z(d,G),()=>u(d)),F(x,D),He()}function qu(x,n){Re(n,!0),At(x,{onclick:()=>n.clear(),variant:"destructive",class:"size-7",title:"Clear all selections",children:(o,s)=>{ks(o,{})},$$slots:{default:!0}}),He()}var $u=se('<p class="p-4 text-center text-sm text-gray-500">Download service is not available.</p>'),Uu=se("<div><!></div> <div><!></div> <div><!></div> <div><!></div>",1),Gu=se("<div><!></div>"),Wu=se('<p class="p-4 text-center text-sm text-gray-500">AI UPRN Chatbot service is not available.</p>'),Yu=se('<div class="relative flex h-full w-full min-w-0 flex-col overflow-visible"><!> <!> <div class="fixed pt-1 pl-1"><!></div> <!> <!></div>'),Ju=se("<!> <!> <!> <!> <!>",1);function jc(x,n){Re(n,!0);let o;const s=Je(new Sl),c=Je(new _l),h=Je(new Ia);let d=ie("define-areas"),m=ie(void 0),T=ie(void 0),k=ie(void 0),A=ie(void 0),D=ie(void 0),E=ie(!1),G=ie(!1),N=ie(Je(new Set)),M=ie(!0),H=Je(Be.LEFT);Je(Be.BOTTOM);let j=ie(Je([])),B=ie(Je(typeof window<"u"?window.innerWidth:1280)),V=ge(()=>ve(u(j),ae=>ae.originalSize)),Y=ge(()=>ve(u(j),ae=>ae.minSize));function ve(ae,we){if(!ae||ae.length===0)return;const pe=[...ae].sort((Fe,Xe)=>Xe.breakpoint-Fe.breakpoint).find(Fe=>u(B)>=Fe.breakpoint);return pe?we(pe):"0"}function te(){z(M,!u(M))}function ce(ae){z(d,ae,!0)}function _e(){z(d,"downloads")}function Ae(){Ne.clearSelections(),kt.clearSelections(),h.clearSelections(),o?.clearSelections(),ol()}kn(async()=>{z(k,new ju,!0),await u(k).init(`${os}/custom-renderers.json`),console.log("[uprn-2/page] CustomRendererService initialized");const ae=await Ao();Ne.setFieldInfo(ae.serviceUprn2Config.selectionLayersNameFields||[]),z(j,ae.serviceUprn2Config.mainSidebarSizes||[],!0),z(m,new pa(ae.serviceUprn2Config.dataSelectionTreeviewConfig),!0),z(T,new pa(ae.serviceUprn2Config.areaSelectionTreeviewConfig),!0),(async()=>{const ke=ae.serviceUprn2Config.uprnDownloadServiceEndpoints,pe=ae.serviceUprn2Config.aiUprnChatbotServiceEndpoints;z(A,new Nu(ke),!0),z(D,new Ru(pe),!0),z(E,await u(A).getHealth(),!0),u(E)?console.log("[uprn-2/page] UPRN Download Service is available"):console.warn("[uprn-2/page] UPRN Download Service is NOT available"),z(G,await u(D).getHealth(),!0),u(G)?console.log("[uprn-2/page] AI UPRN Chatbot Service is available"):console.warn("[uprn-2/page] AI UPRN Chatbot Service is NOT available")})(),z(N,new Set(ae.serviceUprn2Config.dataSelectionTreeviewConfig?.fieldsToHide||[]),!0),await s.initializeAsync({portalUrl:ae.serviceUprn2Config.portalUrl,itemId:ae.serviceUprn2Config.portalItemId||"",proxy:ae.serviceUprn2Config.proxy})}),kn(()=>{const ae=()=>{z(B,window.innerWidth,!0)};return window.addEventListener("resize",ae),()=>{window.removeEventListener("resize",ae)}}),ya(()=>{Ne.cleanup(),h.cleanup(),kt.cleanup(),Cr.cleanup()});var de=Ju(),Se=$(de);ns(Se,{});var X=fe(Se,2);Ms(X,{});var ue=fe(X,2);Bl(ue,{get fieldFilterMenuStore(){return c},get fieldsToHide(){return u(N)}});var xe=fe(ue,2);Ns(xe,{});var Le=fe(xe,2);{const ae=ke=>{var pe=Yu(),Fe=Q(pe);De(Fe,()=>Fu,(Ce,je)=>{je(Ce,{children:(tt,ne)=>{xu(tt,{get value(){return u(d)},get triggers(){return Mu},onValueChange:ce})},$$slots:{default:!0}})});var Xe=fe(Fe,2);De(Xe,()=>Tu,(Ce,je)=>{je(Ce,{children:(tt,ne)=>{var Ge=Uu(),qe=$(Ge),be=Q(qe);Sr(be,{children:(Ve,at)=>{var Ke=le(),pt=$(Ke);{var St=gt=>{nu(gt,{get webMap(){return s.data},get treeviewStore(){return h},get treeviewConfigStore(){return u(T)}})};me(pt,gt=>{s.isLoaded&&gt(St)})}F(Ve,Ke)}}),U(qe);var Ue=fe(qe,2),wt=Q(Ue);Sr(wt,{children:(Ve,at)=>{var Ke=le(),pt=$(Ke);{var St=gt=>{Mt(hu(gt,{get webMap(){return s.data},get treeviewConfigStore(){return u(m)},get customRendererService(){return u(k)},get fieldFilterMenuStore(){return c}}),xt=>o=xt,()=>o)};me(pt,gt=>{s.isLoaded&&gt(St)})}F(Ve,Ke)}}),U(Ue);var We=fe(Ue,2),_t=Q(We);Sr(_t,{children:(Ve,at)=>{Fl(Ve,{get webMapStore(){return s},get areaSelectionTreeviewStore(){return h},get dataSelectionTreeviewConfig(){return u(m)},get fieldFilterMenuStore(){return c}})}}),U(We);var ht=fe(We,2),vt=Q(ht);Sr(vt,{children:(Ve,at)=>{var Ke=le(),pt=$(Ke);{var St=xt=>{var Pt=$u();F(xt,Pt)},gt=xt=>{ml(xt,{get webMapStore(){return s},get uprnDownloadService(){return u(A)},get fieldsToHide(){return u(N)}})};me(pt,xt=>{!u(A)||!u(E)?xt(St):xt(gt,!1)})}F(Ve,Ke)}}),U(ht),ut(()=>{qe.hidden=u(d)!=="define-areas",Ue.hidden=u(d)!=="select-data",We.hidden=u(d)!=="export",ht.hidden=u(d)!=="downloads"}),F(tt,Ge)},$$slots:{default:!0}})});var et=fe(Xe,2),Ze=Q(et);qu(Ze,{clear:Ae}),U(et);var it=fe(et,2);De(it,()=>Lu,(Ce,je)=>{je(Ce,{children:(tt,ne)=>{var Ge=Gu(),qe=Q(Ge);wl(qe,{onExportSuccess:_e}),U(Ge),ut(()=>Ge.hidden=u(d)!=="export"),F(tt,Ge)},$$slots:{default:!0}})});var ye=fe(it,2);Bu(ye,{isOpenedOnInit:!0,children:(Ce,je)=>{var tt=le(),ne=$(tt);{var Ge=be=>{var Ue=Wu();F(be,Ue)},qe=be=>{el(be,{get aiUprnChatbotService(){return u(D)}})};me(ne,be=>{!u(D)||!u(G)?be(Ge):be(qe,!1)})}F(Ce,tt)},$$slots:{default:!0}}),U(pe),F(ke,pe)},we=ke=>{yu(ke,{get webMap(){return s.data},get areaSelectionTreeviewStore(){return h},panelPosition:"top-left",menuPosition:"top-right"})};De(Le,()=>Au,(ke,pe)=>{pe(ke,{get isOpen(){return u(M)},onToggle:te,get position(){return H},get originalSize(){return u(V)},get minSize(){return u(Y)},sidebarContent:ae,mainContent:we,$$slots:{sidebarContent:!0,mainContent:!0}})})}F(x,de),He()}export{jc as component};
