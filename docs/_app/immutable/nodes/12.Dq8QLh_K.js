const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/COf4WTrX.js","../chunks/DwWpeHsS.js","../chunks/PPVm8Dsz.js","../chunks/BfMV86KQ.js","../chunks/h5rW6lAS.js","../chunks/BiKLiV0b.js","../chunks/BUpj17sD.js","../chunks/mvO4rAvm.js","../chunks/BFkxbxSE.js","../chunks/Db91rTNV.js","../chunks/CNI1bPWi.js","../chunks/Cp_8tW2x.js","../chunks/BW9c9SrU.js","../chunks/Y_0EfhRu.js","../chunks/bnayRBMH.js","../chunks/JSgpbLKx.js","../chunks/v5xyD8FI.js","../chunks/BT4JRnHr.js","../chunks/D2feDspf.js","../chunks/CPLN7muT.js","../chunks/C0wm8_Yw.js","../chunks/C0Q15jgo.js","../chunks/idjzkL-p.js","../chunks/D7TN9t_q.js","../chunks/Dm66KbFf.js","../chunks/CH2_fMSn.js","../chunks/8JOOWlUE.js","../chunks/DmtPipHG.js","../chunks/B87vTgcy.js","../chunks/CbKIfN8e.js","../chunks/DdbdneQ1.js","../chunks/BV8-ngCo.js","../chunks/O7sg2ysZ.js","../chunks/rIJyvhvt.js","../chunks/Dc261vxq.js","../chunks/CC5XFA8H.js","../chunks/D-fXJnCB.js","../chunks/B4oxan5h.js","../chunks/CEhj4l8G.js","../chunks/D_bKRBrk.js","../chunks/BvwLokzg.js","../chunks/6vsZKnZ9.js","../chunks/7VNfS1TG.js","../chunks/DP5d1tPL.js","../chunks/D-LmNXBe.js","../chunks/B0qK9XMn.js","../chunks/Dci9kdnZ.js","../chunks/CF39WpqH.js","../chunks/BAzr6Eo0.js","../chunks/FTzM2Tyd.js","../chunks/C61-NiK_.js","../chunks/BWeyrF54.js","../chunks/Cx8JFOfk.js","../chunks/BmgeYasw.js","../chunks/DLOQEY_Z.js","../chunks/91llm6te.js","../chunks/D31seSHD.js","../chunks/DH0im0Cr.js","../chunks/NIvIaQ85.js","../chunks/qyF9FwQ9.js","../chunks/XI-Li77m.js","../chunks/Bdg0_NLM.js","../chunks/ShBCB_ow.js","../chunks/Df_x8s9w.js","../chunks/O7OdySC2.js","../chunks/8hNj00IL.js","../chunks/BauKPgXA.js","../chunks/UusjRatb.js","../chunks/BTOnRfOV.js","../chunks/CaYZrGFV.js","../chunks/Epqbrrx8.js","../chunks/DkJ9ydHD.js","../chunks/DOBtub6T.js","../assets/index.CQED0rIl.css","../chunks/CdDXOJ3Y.js","../assets/component-utils.R4SXog4D.css","../chunks/B5GhfNyB.js","../chunks/BVzLLi1N.js","../chunks/BawRJkAp.js","../chunks/OuOF1Ws1.js","../chunks/CHtALhqk.js","../chunks/BQBvadb7.js","../chunks/D-YQ4CHs.js","../chunks/Blp-4Wmz.js","../chunks/BqgbqPku.js","../chunks/Bc_TmxSc.js","../chunks/4u0wcz6f.js","../chunks/C6pzAkdR.js","../chunks/Bkm1woOz.js","../chunks/DkWWe1YB.js","../chunks/DXGw_0Ww.js","../chunks/DlHjpvET.js","../chunks/DHAweUE4.js","../chunks/DtjklSP3.js","../chunks/CEIZYuf2.js","../chunks/CYB2EK_d.js","../chunks/SyT8jeOM.js","../chunks/CUNSjG0I.js","../chunks/DfNXrkzI.js","../chunks/D6J3MaDQ.js","../chunks/fAYE5hKe.js","../chunks/D30EvcMW.js","../chunks/DbKbkLbd.js","../chunks/Dex61Jy7.js","../chunks/C1ZOqSSJ.js","../chunks/Caulfaw_.js","../chunks/hXVyCst1.js","../chunks/CsU-E5rt.js","../chunks/DKzVzLpH.js","../chunks/BEQnBRaB.js","../chunks/BvOub3JO.js","../chunks/BnQ6HM0P.js","../chunks/Bsuu90_S.js","../chunks/CAq7DlNS.js","../chunks/CnvtJwPf.js","../chunks/BqS24NHV.js","../chunks/H-XdHQIn.js","../chunks/8WtPGj6h.js","../chunks/CG7ZQ6BV.js","../chunks/C0vf8uoL.js","../chunks/B1fWfl4G.js","../chunks/BvER9tXK.js","../chunks/BkgrN5CW.js","../chunks/BBr4RcYl.js","../chunks/BiRr0v4Y.js","../chunks/UWqqdvX0.js","../chunks/P29LO4Qt.js","../chunks/CBdls4Sa.js","../chunks/Bxxl7NsE.js","../chunks/CaVKkSa6.js","../chunks/CUzevAry.js","../chunks/C8zGwbjb.js","../chunks/D8-AuTXI.js","../chunks/ULv2OBn1.js","../chunks/j00zX3Hz.js","../chunks/DOfiCZuP.js","../chunks/CcNQ31gQ.js","../chunks/C-pcCkpH.js","../chunks/C7e3Z5XT.js","../chunks/QoFPZSeS.js","../chunks/CHwVPrQX.js","../chunks/HTOW8iPe.js","../chunks/DYslx7It.js","../chunks/DuIgqnlY.js","../chunks/D-Nm-cDg.js","../chunks/DaQyK3nQ.js","../chunks/DP-0fjQN.js","../chunks/BxzdRo61.js","../chunks/BdDvN8O6.js","../chunks/DYAvFwNf.js","../chunks/in6aGWsR.js","../chunks/CgRsZskV.js","../chunks/Cgb6qxNH.js","../chunks/E6bx-lsJ.js","../chunks/jrtQMiTD.js","../chunks/CT-uuzXp.js","../chunks/fFYBqOqn.js","../chunks/B1N-tmtC.js","../chunks/DEfNR1C0.js","../chunks/CtljFrUl.js","../chunks/D-qJO60r.js","../chunks/QQC62dOK.js","../chunks/DNogqiqR.js","../chunks/DQOO6RKE.js","../chunks/Bi6C4OG6.js"])))=>i.map(i=>d[i]);
import{_ as Oe}from"../chunks/PPVm8Dsz.js";import"../chunks/DsnmJJEf.js";import{o as it,a as Pt}from"../chunks/dDAaEPZG.js";import{a5 as C,p as Ne,n as Et,a as ze,c as g,r as p,a6 as Y,R as J,t as e,aa as K,V as Ke,a8 as $,a9 as Fe,u as Ze,a7 as s,b3 as ar,b4 as nr,aP as or}from"../chunks/BDDTUZ88.js";import{f as sr,e as yt}from"../chunks/DNyUMNTX.js";import{d as D,a as o,f as h,t as qe}from"../chunks/Cwt5lIb3.js";import{l as ir,s as tt,r as It,p as _e,i as M}from"../chunks/C31JG7LH.js";import{c as Q}from"../chunks/D1jCOcTt.js";import{a as lr,f as Vt,b as ct,s as Ge,d as wt}from"../chunks/BElPz1eq.js";import{b as nt}from"../chunks/BSKGGa8Q.js";import{s as ae}from"../chunks/XAXmKrrN.js";import{s as Mt,e as et,i as cr}from"../chunks/DPcECag8.js";import{C as dr,a as ur,b as dt,c as ut,d as ft}from"../chunks/DzbG3iOB.js";import{c as vt}from"../chunks/PDByQl4c.js";import{X as fr,A as vr,a as mr,b as pr,C as gr}from"../chunks/DVXdH0Hj.js";import"../chunks/69_IOA4Y.js";import{I as hr,s as _r,S as xt}from"../chunks/Dmx1ecyr.js";import{C as wr}from"../chunks/COC1fdeC.js";import{S as ot,a as Rt,c as Lt,C as kt}from"../chunks/B5_puA7x.js";import{B as yr}from"../chunks/B2ZqdCVZ.js";import{I as xr}from"../chunks/BEmBV25U.js";import{S as Cr}from"../chunks/6eoOfjnb.js";import{H as br}from"../chunks/BfMV86KQ.js";import{S as Ct}from"../chunks/BgQyHJ5O.js";import"../chunks/B17Q6ahh.js";import"../chunks/O7sg2ysZ.js";function Sr(f,t){const v=ir(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const y=[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3"}]];hr(f,tt({name:"command"},()=>v,{get iconNode(){return y},children:(i,x)=>{var n=D(),A=C(n);_r(A,t,"default",{}),o(i,n)},$$slots:{default:!0}}))}function Pr(f,t){Ne(t,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let v=It(t,["$$slots","$$events","$$legacy"]);const y=[["path",{d:"m12 19-7-7 7-7"}],["path",{d:"M19 12H5"}]];xr(f,tt({name:"arrow-left"},()=>v,{get iconNode(){return y},children:(i,x)=>{var n=D(),A=C(n);Mt(A,()=>t.children??Et),o(i,n)},$$slots:{default:!0}})),ze()}var Ir=h("<span><!></span>");function Rr(f,t){Ne(t,!0);let v=_e(t,"ref",15,null),y=It(t,["$$slots","$$events","$$legacy","ref","class","children"]);var i=Ir();lr(i,n=>({"data-slot":"command-shortcut",class:n,...y}),[()=>vt("text-muted-foreground ml-auto text-xs tracking-widest",t.class)]);var x=g(i);Mt(x,()=>t.children??Et),p(i),nt(i,n=>v(n),()=>v()),o(f,i),ze()}function $r(f,t){f.stopPropagation(),t()?.()}var Or=h('<button type="button" class="pointer-events-none flex h-4 w-0 items-center justify-center rounded text-muted-foreground opacity-0 transition-[width,margin-left,opacity] group-hover:pointer-events-auto group-hover:ml-1 group-hover:w-4 group-hover:opacity-100"><!></button>'),Ar=h('<div><span class="truncate"> </span> <!></div>');function Dt(f,t){Ne(t,!0);let v=_e(t,"onClose",3,null);const y=t.title??t.value;var i=Ar(),x=g(i),n=g(x,!0);p(x);var A=Y(x,2);{var S=L=>{var k=Or();k.__click=[$r,v];var I=g(k);fr(I,{class:"size-3"}),p(k),J(()=>Ge(k,"aria-label",`Clear ${t.value}`)),o(L,k)};M(A,L=>{v()&&L(S)})}p(i),J(L=>{ct(i,1,L),Ge(i,"title",y),ae(n,t.value)},[()=>Vt(vt("group inline-flex max-w-[10rem] items-center overflow-hidden rounded border border-border px-1 py-0.5 text-xs font-medium text-muted-foreground transition-all",t.class))]),o(f,i),ze()}sr(["click"]);var Er=h('<!> <span aria-hidden="true" class="h-5 w-px bg-border"></span>',1),Vr=h('<div class="flex h-9 items-center gap-2 border-b pl-2" data-slot="command-input-wrapper"><span class="flex h-full min-w-[1.25rem] shrink-0 items-center justify-center text-muted-foreground"><!></span> <!> <!></div>');function Mr(f,t){Ne(t,!0);let v=_e(t,"ref",15,null),y=_e(t,"value",15,""),i=_e(t,"iconProps",19,()=>({})),x=_e(t,"onCommandClose",3,null),n=It(t,["$$slots","$$events","$$legacy","ref","class","value","icon","iconProps","commandId","onCommandClose"]);var A=Vr(),S=g(A),L=g(S);{var k=_=>{const N=K(()=>t.icon);var R=D(),m=C(R);Q(m,()=>e(N),(d,w)=>{w(d,tt(i))}),o(_,R)},I=_=>{Sr(_,{class:"size-4 opacity-50"})};M(L,_=>{t.icon?_(k):_(I,!1)})}p(S);var T=Y(S,2);{var W=_=>{var N=Er(),R=C(N);Dt(R,{get value(){return t.commandId},get title(){return t.commandId},get onClose(){return x()}}),Ke(2),o(_,N)};M(T,_=>{t.commandId&&_(W)})}var b=Y(T,2);{let _=K(()=>vt("flex h-10 flex-1 rounded-md bg-transparent py-3 text-sm outline-hidden placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t.class));Q(b,()=>dr,(N,R)=>{R(N,tt({"data-slot":"command-input",get class(){return e(_)}},()=>n,{get ref(){return v()},set ref(m){v(m)},get value(){return y()},set value(m){y(m)}}))})}p(A),o(f,A),ze()}function Lr(f,t){Ne(t,!0);const v=_e(t,"disabled",3,!1);yr(f,{class:"m-0 flex size-7 shrink-0 items-center justify-center rounded-md border-none bg-transparent p-0 text-muted-foreground opacity-50 shadow-none transition hover:bg-transparent hover:text-accent-foreground focus:outline-none focus-visible:border-transparent focus-visible:ring-0 focus-visible:ring-offset-0 focus-visible:outline-none active:ring-0 active:outline-none disabled:pointer-events-none disabled:opacity-50 has-[>svg]:px-0",onclick:()=>{v()||t.onPress?.()},"aria-label":"Return to command search",get disabled(){return v()},children:(y,i)=>{{let x=K(()=>`size-4 ${t.class}`.trim());Pr(y,{get class(){return e(x)}})}},$$slots:{default:!0}}),ze()}var kr=h('<div class="flex flex-wrap gap-2 px-2 py-0.5"></div>'),Dr=h('<span class="text-xs text-muted-foreground"> </span>'),Tr=h('<div class="flex flex-col gap-0.5"><span class="text-sm leading-tight font-medium"> </span> <!></div> <!>',1),Nr=h("<!> <!>",1),zr=h('<div class="px-4 pb-3"><!></div>'),Br=h("<!> <!>",1),Fr=h('<div class="px-4 pb-3"><!></div>'),Wr=h('<p class="text-sm text-muted-foreground">No panel registered for this command.</p>'),jr=h('<div class="pr-2 pb-2 pl-2"><!></div>'),Ur=h("<!> <!> <!>",1),Kr=h("<!> <!>",1),qr=h("<!> <!>",1),Gr=h("<div><!></div>");function Hr(f,t){Ne(t,!0);let v=_e(t,"ref",15,null),y=_e(t,"commands",19,()=>[]),i=_e(t,"placeholder",3,"Commands..."),x=_e(t,"emptyMessage",3,"No commands found."),n=$(null),A=$(null),S=$(null),L=$(null),k=$(null),I=$(null),T=$(Fe([])),W=$(""),b=$(!1),_=$(Fe(i())),N=$(null),R=!1,m=$(null),d=!1,w=null,F=null,j=0,E=null;const ne=K(()=>{const a=new Map;for(const l of y())a.set(l.id,l);return Array.from(a.values())}),we=K(()=>{const a=new Map;for(const l of e(ne)){const r=l.group??null,q=a.get(r);q?q.push(l):a.set(r,[l])}return a});it(()=>{je()});function oe(a,l=!1){l&&(R=!0),s(W,a,!0)}function Ce(a=null,l){if(!E||a&&E!==a)return;s(N,null),E.placeholderOverridden&&s(_,i()),(l?.forceReset??(l?.skipReset?!1:E.resetValueOnDetach))&&(oe("",!0),E.onInput("")),E.onDetach?.(),E=null}function c(){Ce(null,{forceReset:!0}),s(N,null),s(_,i()),R=!1}Ze(()=>{const a=e(N);if(a){if(R){R=!1;return}a(e(W))}}),Ze(()=>{e(n)||s(_,i())});function u(){if(F)try{F()}catch(a){console.error("Failed to dispose command session",a)}F=null,s(S,null),s(L,null),c(),s(A,null)}function P(){e(n)&&(u(),s(n,null),s(I,null),s(k,null),oe("",!0),s(b,!0))}function z(a){try{t.commandSearchContext.get(a.classType).clear()}catch(l){console.error("Failed to clear global variable",l)}finally{je()}}function X(){e(m)?.blur()}function B(a,l){if(!a.component)return null;const r=a.props;return r?{component:a.component,props:()=>r(l)}:{component:a.component}}function Z(a,l){const r=a.createSession?.(l);if(r){F=r.dispose??null,Object.prototype.hasOwnProperty.call(r,"input")?s(S,r.input??null,!0):s(S,null),Object.prototype.hasOwnProperty.call(r,"content")?s(L,r.content??null,!0):s(L,B(a,l),!0);return}F=null,s(S,null),s(L,B(a,l),!0)}function U(a){const l=a.id;return{getContext:()=>t.commandSearchContext,deactivate:()=>{!e(n)||e(n).id!==l||(P(),je())},isActive:r=>!e(n)||e(n).id!==l?!1:r?e(n).id===r:!0,setIsOpen:(r,q)=>{if(!e(n)||e(n).id!==l)return;if(r){d=!1,s(b,!0);return}const ee=q?.preserveActive??!0;We(ee)},setInputSurface:r=>{!e(n)||e(n).id!==l||s(S,r,!0)},setContentSurface:r=>{!e(n)||e(n).id!==l||s(L,r,!0)},getInputValue:()=>e(W),setInputValue:r=>{!e(n)||e(n).id!==l||oe(r,!0)},setInputHandler:r=>{if(!(!e(n)||e(n).id!==l)){if(Ce(null,{skipReset:!0}),s(N,r,!0),!r){R=!1;return}r(e(W))}},setPlaceholder:r=>{!e(n)||e(n).id!==l||s(_,r,!0)},resetPlaceholder:()=>{!e(n)||e(n).id!==l||s(_,i())},attachInputBinding:r=>{if(!e(n)||e(n).id!==l)return()=>{};Ce(null,{skipReset:!0});const q=r.placeholder??e(n).inputPlaceholder??i(),ee={id:++j,commandId:l,onInput:r.onInput,onDetach:r.onDetach,placeholderOverridden:!!q,resetValueOnDetach:r.resetValueOnDetach??!0};E=ee,ee.placeholderOverridden&&q&&s(_,q,!0),s(N,Ae=>{!E||E.id!==ee.id||r.onInput(Ae)});const G=r.resetValueOnAttach??!0,ge=r.replayInitialValue??!G;return G?(oe("",!0),r.onInput("")):ge&&r.onInput(e(W)),()=>{Ce(ee)}}}}function be(a){const l=e(A);if(!a)return l?{runtime:l}:{};if(!l)return{};const{props:r}=a;return r?{...typeof r=="function"?r(l):r,runtime:l}:{runtime:l}}function ce(a){return`${a.name} ${a.description??""}`.trim()}async function ie(a){if(e(n)?.id===a.id){P();return}u(),s(I,null),s(k,a.id,!0),s(b,!0),e(m)&&e(m).focus();const l=U(a);s(A,l,!0),s(n,a,!0),Z(a,l);try{await a.execute(l)}catch(r){s(I,r instanceof Error?r:new Error("Failed to execute the command."),!0)}finally{s(k,null),oe("",!0),je()}}function He(a){const l=a.key.toLowerCase();if((a.metaKey||a.ctrlKey)&&l==="p"){if(a.preventDefault(),e(n)){P();return}e(m)&&e(m).focus();return}if(l==="escape"){if(e(n)){a.preventDefault(),P(),X();return}e(b)&&(a.preventDefault(),s(b,!1),X());return}if(!e(n))for(const q of e(ne)){if(!q.shortcut)continue;const ee=q.shortcut.join(" ").toLowerCase(),G=[];if(a.metaKey&&G.push("âŒ˜"),a.ctrlKey&&G.push("Ctrl"),a.altKey&&G.push("Alt"),a.shiftKey&&G.push("Shift"),G.push(a.key.length===1?a.key.toUpperCase():a.key),G.join(" ").toLowerCase()===ee.toLowerCase()){a.preventDefault(),ie(q);break}}}function Qe(){s(b,!0)}function We(a=!1){d=a,s(b,!1),X()}function rt(a){const l=w;if(!l)return;const r=a.target;r&&l.contains(r)||e(b)&&We(!!e(n))}Ze(()=>{if(!e(b)){if(oe("",!0),!e(n)){d=!1;return}if(d){d=!1;return}u(),s(n,null),s(I,null)}});function je(){if(!t.commandSearchContext){s(T,[],!0);return}const a=t.commandSearchContext.getGlobalVariables(),l=[];for(const r of a){const q=r.getId();q&&l.push({displayName:r.displayName,id:q,classType:r.constructor})}s(T,l,!0)}var pe=Gr();yt("keydown",ar,He),yt("pointerdown",nr,rt);var Ie=g(pe);Q(Ie,()=>ur,(a,l)=>{l(a,{children:(r,q)=>{var ee=qr(),G=C(ee);{let Se=K(()=>e(n)?e(n).inputPlaceholder??e(_):e(_)),Ye=K(()=>e(n)?Lr:void 0),Ee=K(()=>e(n)?{onPress:P,disabled:e(k)===e(n).id}:void 0),Ue=K(()=>e(n)?.id),ye=K(()=>e(n)?P:null);Mr(G,{get placeholder(){return e(Se)},onfocus:()=>Qe(),get icon(){return e(Ye)},get iconProps(){return e(Ee)},get commandId(){return e(Ue)},get onCommandClose(){return e(ye)},get value(){return e(W)},set value(de){s(W,de,!0)},get ref(){return e(m)},set ref(de){s(m,de,!0)}})}var ge=Y(G,2);{var Ae=Se=>{var Ye=Kr(),Ee=C(Ye);{var Ue=te=>{var se=kr();et(se,21,()=>e(T),ue=>ue.id,(ue,fe)=>{{let Re=K(()=>`${e(fe).displayName}: ${e(fe).id}`),Me=K(()=>`${e(fe).displayName}: ${e(fe).id}`);Dt(ue,{get value(){return e(Re)},get title(){return e(Me)},onClose:()=>z(e(fe))})}}),p(se),o(te,se)};M(Ee,te=>{e(T).length&&te(Ue)})}var ye=Y(Ee,2);{var de=te=>{xt(te,{children:(se,ue)=>{var fe=D(),Re=C(fe);Q(Re,()=>dt,(Me,at)=>{at(Me,{children:(he,Be)=>{var ve=Nr(),Le=C(ve);Q(Le,()=>ut,($e,me)=>{me($e,{children:(xe,V)=>{Ke();var O=qe();J(()=>ae(O,x())),o(xe,O)},$$slots:{default:!0}})});var ke=Y(Le,2);et(ke,17,()=>Array.from(e(we).entries()),cr,($e,me)=>{var xe=K(()=>or(e(me),2));let V=()=>e(xe)[1];var O=D(),H=C(O);et(H,17,V,le=>le.id,(le,re)=>{var Pe=D(),De=C(Pe);{let Ft=K(()=>ce(e(re)));Q(De,()=>ft,(Wt,jt)=>{jt(Wt,{get value(){return e(Ft)},onclick:()=>ie(e(re)),children:(Ut,Sa)=>{var $t=Tr(),pt=C($t),gt=g(pt),Kt=g(gt,!0);p(gt);var qt=Y(gt,2);{var Gt=Te=>{var Je=Dr(),ht=g(Je,!0);p(Je),J(()=>ae(ht,e(re).description)),o(Te,Je)};M(qt,Te=>{e(re).description&&Te(Gt)})}p(pt);var Ht=Y(pt,2);{var Qt=Te=>{ot(Te,{class:"ml-auto size-4 text-muted-foreground"})},Yt=Te=>{var Je=D(),ht=C(Je);{var Xt=_t=>{var Ot=D(),Jt=C(Ot);Q(Jt,()=>Rr,(Zt,er)=>{er(Zt,{children:(tr,Pa)=>{Ke();var At=qe();J(rr=>ae(At,rr),[()=>e(re).shortcut?.join(" + ")]),o(tr,At)},$$slots:{default:!0}})}),o(_t,Ot)};M(ht,_t=>{e(re).shortcut?.length&&_t(Xt)},!0)}o(Te,Je)};M(Ht,Te=>{e(k)===e(re).id?Te(Qt):Te(Yt,!1)})}J(()=>ae(Kt,e(re).name)),o(Ut,$t)},$$slots:{default:!0}})})}o(le,Pe)}),o($e,O)}),o(he,ve)},$$slots:{default:!0}})}),o(se,fe)},$$slots:{default:!0}})},Ve=te=>{var se=Ur(),ue=C(se);{var fe=he=>{const Be=K(()=>e(S).component);var ve=zr(),Le=g(ve);{let ke=K(()=>be(e(S)));Q(Le,()=>e(Be),($e,me)=>{me($e,tt(()=>e(ke)))})}p(ve),o(he,ve)};M(ue,he=>{e(S)&&he(fe)})}var Re=Y(ue,2);{var Me=he=>{var Be=Fr(),ve=g(Be);Q(ve,()=>vr,(Le,ke)=>{ke(Le,{variant:"destructive",children:($e,me)=>{var xe=Br(),V=C(xe);Q(V,()=>mr,(H,le)=>{le(H,{children:(re,Pe)=>{Ke();var De=qe();J(()=>ae(De,`${e(n).name??""} failed`)),o(re,De)},$$slots:{default:!0}})});var O=Y(V,2);Q(O,()=>pr,(H,le)=>{le(H,{children:(re,Pe)=>{Ke();var De=qe();J(()=>ae(De,e(I).message)),o(re,De)},$$slots:{default:!0}})}),o($e,xe)},$$slots:{default:!0}})}),p(Be),o(he,Be)};M(Re,he=>{e(I)&&he(Me)})}var at=Y(Re,2);xt(at,{children:(he,Be)=>{var ve=jr(),Le=g(ve);{var ke=me=>{const xe=K(()=>e(L).component);var V=D(),O=C(V);{let H=K(()=>be(e(L)));Q(O,()=>e(xe),(le,re)=>{re(le,tt(()=>e(H)))})}o(me,V)},$e=me=>{var xe=D(),V=C(xe);Q(V,()=>wr,(O,H)=>{H(O,{class:"px-0",children:(le,re)=>{var Pe=Wr();o(le,Pe)},$$slots:{default:!0}})}),o(me,xe)};M(Le,me=>{e(L)?me(ke):me($e,!1)})}p(ve),o(he,ve)},$$slots:{default:!0}}),o(te,se)};M(ye,te=>{e(n)?te(Ve,!1):te(de)})}o(Se,Ye)};M(ge,Se=>{e(b)&&Se(Ae)})}o(r,ee)},$$slots:{default:!0}})}),p(pe),nt(pe,a=>w=a,()=>w),nt(pe,a=>v(a),()=>v()),J(a=>ct(pe,1,a),[()=>Vt(vt("space-y-4",t.class))]),o(f,pe),ze()}class Tt{colour=null;id=null;getId(){return this.id}setId(t){this.id=t}clear(){this.setId(null)}}class Qr{services=new Map;globalVariables=new Map;add(t,v){this.services.set(t,v),v instanceof Tt&&this.globalVariables.set(t,v)}get(t){const v=this.services.get(t);if(!v)throw new Error(`Service not found for token: ${t.name}`);return v}has(t){return this.services.has(t)}getGlobalVariables(){return Array.from(this.globalVariables.values())}}class bt{#e=[];constructor(t){this.#e=t}get organisations(){return this.#e}}class Xe extends Tt{displayName="org";organisations;constructor(t){super(),this.organisations=new Map(t.map(v=>[v.id,v])),t.length>0&&this.setId(t[0].id)}setActiveOrganisation(t){this.setId(t)}getActiveOrganisationId(){return this.id}getActiveOrganisationPortalUrl(){const t=this.organisations.get(this.getActiveOrganisationIdInternal());if(!t)throw new Error("No organisation is currently selected.");return t.portalUrl}getActiveOrganisationEndpoint(){const t=this.organisations.get(this.getActiveOrganisationIdInternal());if(!t)throw new Error("No organisation is currently selected.");return t.endpoint}getActiveOrganisationQueryParams(){const t=this.organisations.get(this.getActiveOrganisationIdInternal());if(!t)throw new Error("No organisation is currently selected.");return t.queryParams||{}}getActiveOrganisationIdInternal(){if(!this.id)throw new Error("No organisation is currently selected.");return this.id}}class st{_mapView;constructor(t){this._mapView=t}get mapView(){return this._mapView}}const St=new Map;function Yr(f,t){St.has(f)&&console.warn(`[registerCommand] Command "${f}" already registered, overriding.`),St.set(f,t)}function lt(f){return St.get(f)}function mt(f,t){return Yr(f,t),t}class Nt{#e=$(null);#t=$(!1);#r=$(null);load=async(t,v)=>{s(this.#t,!0),s(this.#r,null);try{console.log("Esri Request URL:",t,v);const y=await br(t,{...v,responseType:"json"});console.log("Esri Request Response:",y,y.data.url),s(this.#e,y.data,!0)}catch(y){s(this.#r,y,!0)}finally{s(this.#t,!1)}};get data(){return e(this.#e)}get isLoading(){return e(this.#t)}get error(){return e(this.#r)}}var Xr=h('<div class="error-message svelte-11six79"><p class="text-sm text-red-600 svelte-11six79"> </p></div>'),Jr=h('<div class="flex items-center justify-center p-4"><!></div>'),Zr=h('<div class="flex items-center gap-2"><!> <span class="title-text w-full font-medium text-foreground svelte-11six79"> </span></div>'),ea=h('<span class="description-text text-xs text-gray-500 svelte-11six79"> </span>'),ta=h('<div class="error-message svelte-11six79"><!> <p class="text-sm text-red-600 svelte-11six79"> </p></div>'),ra=h('<div class="flex w-full min-w-0 flex-col gap-0.5"><span class="title-text font-medium text-foreground svelte-11six79"> </span> <!> <!></div>'),aa=h('<div class="item-container svelte-11six79"><!></div>');function na(f,t){Ne(t,!0);const v=_e(t,"runtime",3,null),y=new Nt;let i=$(null),x=$(null),n=Fe(new Ct),A=$(""),S=$(Fe([]));const L=K(()=>{const m=e(S);console.log("Filtering web maps with data:",m);const d=e(A).trim().toLowerCase();return d?m.filter(w=>{const F=w?.title?.toLowerCase()??"",j=w?.description?.toLowerCase()??"";return F.includes(d)||j.includes(d)}):m});it(async()=>{s(i,t.commandSearchContext.get(st).mapView,!0);const d=t.commandSearchContext.get(Xe).getActiveOrganisationId();if(!d){console.warn("No active organisation selected in OrganisationCommandService");return}try{const w=await fetch(Rt(`/api/maps/${d}.json`));if(!w.ok)throw new Error(`Failed to fetch maps: ${w.status} ${w.statusText}`);const F=await w.json();s(S,(F.results??[]).filter(j=>j.type.toLowerCase()==="web map").map(j=>({id:j.id,title:j.title,description:Lt(j.description),owner:j.owner,tags:j.tags})),!0)}catch(w){console.error("Error fetching web maps:",w)}});let k=null,I=null,T=t.inputPlaceholder??"Search...";Ze(()=>{const m=v(),d=t.inputPlaceholder??"Search...";if(!m){k?.(),k=null,I=null,T=d,s(A,"");return}if(m===I){d!==T&&(m.setPlaceholder(d),T=d);return}k?.(),k=null,T=d,k=m.attachInputBinding({placeholder:d,onInput:w=>{s(A,w,!0)}}),I=m}),Pt(()=>{k?.(),k=null,I=null});async function W(m){if(!e(i)){console.error("MapView is not initialized"),n.set(m,new Error("MapView is not ready. Please wait and try again."));return}s(x,m,!0),n.delete(m);try{console.log(`Loading web map with ID: ${m}`);const d=t.commandSearchContext.get(Xe);if(!d.getActiveOrganisationId()){console.warn("No active organisation selected in OrganisationCommandService");return}const F=d.getActiveOrganisationPortalUrl(),{default:j}=await Oe(async()=>{const{default:oe}=await import("../chunks/COf4WTrX.js").then(Ce=>Ce.W);return{default:oe}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69]),import.meta.url),E=new j({portalItem:{id:m,portal:{url:F}}});await E.load(),console.log("Web map loaded successfully"),console.log("Applying web map to MapView",e(i).ui),e(i).map=E,console.log("Web map applied to MapView"),await(await Oe(()=>import("../chunks/BUpj17sD.js").then(oe=>oe.y),__vite__mapDeps([6,1,3,2,7]),import.meta.url)).whenOnce(()=>e(i)?.ready),console.log("MapView updated with new web map");const we=E.initialViewProperties?.viewpoint?.targetGeometry;we&&(console.log("Navigating to web map initial viewpoint"),await e(i).goTo(we),console.log("MapView navigated to web map initial viewpoint")),v()?.setIsOpen(!1)}catch(d){console.error("Error loading web map:",d),n.set(m,d),s(x,null)}finally{s(x,null)}}var b=aa(),_=g(b);{var N=m=>{var d=Xr(),w=g(d),F=g(w);p(w),p(d),J(()=>ae(F,`${y.error.message??""}. ${y.error?.details?.httpStatus===0?"Reason: CORS Error. See console for more information.":""}`)),o(m,d)},R=m=>{var d=D(),w=C(d);{var F=E=>{var ne=Jr(),we=g(ne);ot(we,{class:"size-5"}),p(ne),o(E,ne)},j=E=>{var ne=D(),we=C(ne);Q(we,()=>dt,(oe,Ce)=>{Ce(oe,{children:(c,u)=>{var P=D(),z=C(P);{var X=Z=>{var U=D(),be=C(U);Q(be,()=>ut,(ce,ie)=>{ie(ce,{children:(He,Qe)=>{Ke();var We=qe("No web maps match your search.");o(He,We)},$$slots:{default:!0}})}),o(Z,U)},B=Z=>{var U=D(),be=C(U);et(be,17,()=>e(L),ce=>ce.id,(ce,ie)=>{var He=D(),Qe=C(He);Q(Qe,()=>ft,(We,rt)=>{rt(We,{onclick:()=>W(e(ie).id),children:(je,pe)=>{const Ie=K(()=>n.get(e(ie).id));var a=D(),l=C(a);{var r=ee=>{var G=Zr(),ge=g(G);ot(ge,{class:"size-4"});var Ae=Y(ge,2),Se=g(Ae);p(Ae),p(G),J(()=>ae(Se,`Loading ${e(ie).title??"Untitled web map"??""}...`)),o(ee,G)},q=ee=>{var G=ra(),ge=g(G),Ae=g(ge,!0);p(ge);var Se=Y(ge,2);{var Ye=ye=>{var de=ea(),Ve=g(de,!0);p(de),J(()=>{Ge(de,"title",e(ie).description),ae(Ve,e(ie).description)}),o(ye,de)};M(Se,ye=>{e(ie).description&&ye(Ye)})}var Ee=Y(Se,2);{var Ue=ye=>{const de=K(()=>`${e(Ie).message}. ${e(Ie).details?.error?.details?.httpStatus===0?"Reason: CORS Error. See console for more information.":""}`);var Ve=ta(),te=g(Ve);kt(te,{class:"error-icon",size:16});var se=Y(te,2),ue=g(se,!0);p(se),p(Ve),J(()=>{Ge(Ve,"title",e(de)),ae(ue,e(de))}),o(ye,Ve)};M(Ee,ye=>{e(Ie)&&ye(Ue)})}p(G),J(()=>{Ge(ge,"title",e(ie).title),ae(Ae,e(ie).title??"Untitled web map")}),o(ee,G)};M(l,ee=>{e(x)===e(ie).id?ee(r):ee(q,!1)})}o(je,a)},$$slots:{default:!0}})}),o(ce,He)}),o(Z,U)};M(z,Z=>{e(L).length===0?Z(X):Z(B,!1)})}o(c,P)},$$slots:{default:!0}})}),o(E,ne)};M(w,E=>{y.isLoading?E(F):E(j,!1)},!0)}o(m,d)};M(_,m=>{y.error?m(N):m(R,!1)})}p(b),o(f,b),ze()}const zt={id:"add-web-map",name:"Add web map",description:"Fetch and display web maps.",group:"Maps",shortcut:["Ctrl","M"],inputPlaceholder:"Search web maps...",execute:async()=>{},component:na,props:f=>({commandSearchContext:f.getContext(),inputPlaceholder:zt.inputPlaceholder})};mt("add-web-map",zt);globalThis.process?.versions?.webcontainer;Oe(()=>import("../chunks/BIHI7g3E.js"),[],import.meta.url).then(f=>new f.AsyncLocalStorage).catch(()=>{});var oa=h('<div class="error-message svelte-1lap2l5"><p class="text-sm text-red-600 svelte-1lap2l5"> </p></div>'),sa=h('<div class="flex items-center justify-center p-4"><!></div>'),ia=h('<div class="flex items-center gap-2"><!> <span class="title-text w-full font-medium text-foreground svelte-1lap2l5"> </span></div>'),la=h('<div class="flex items-center gap-2"><!></div>'),ca=h('<span class="description-text text-xs text-gray-500 svelte-1lap2l5"> </span>'),da=h('<span class="text-[11px] text-muted-foreground"> </span>'),ua=h('<span class="text-[11px] text-muted-foreground"> <!></span>'),fa=h('<div class="error-message svelte-1lap2l5"><!> <p class="text-sm text-red-600 svelte-1lap2l5"> </p></div>'),va=h('<!> <div class="flex w-full min-w-0 flex-col gap-0.5"><span class="title-text font-medium text-foreground svelte-1lap2l5"> </span> <!> <!> <!> <!></div>',1),ma=h('<div class="item-container svelte-1lap2l5"><!></div>');function pa(f,t){Ne(t,!0);const v=_e(t,"runtime",3,null),y=new Nt;let i=$(null),x=$(null),n=Fe(new Ct),A=$(""),S=$(Fe(new Ct)),L=$(Fe([]));const k=new Map,I={27700:"OS_Open_Background"},T=K(()=>{const c=e(L),u=e(A).trim().toLowerCase();return u?c.filter(P=>{const z=P?.title?.toLowerCase()??"",X=P?.description?.toLowerCase()??"";return z.includes(u)||X.includes(u)}):c});it(async()=>{s(i,t.commandSearchContext.get(st).mapView,!0);const c=t.commandSearchContext.get(Xe),u=c.getActiveOrganisationId();if(!u){console.warn("No active organisation selected in OrganisationCommandService");return}c.getActiveOrganisationPortalUrl(),c.getActiveOrganisationEndpoint();const P=["Feature Layer","Feature Service","Map Service","Image Service"],z=await fetch(Rt(`/api/maps/${u}.json`));if(!z.ok)throw new Error(`Failed to fetch maps: ${z.status} ${z.statusText}`);const X=await z.json();s(L,(X.results??[]).filter(B=>P.includes(B.type)).map(B=>({id:B.id,title:B.title,description:Lt(B.description),owner:B.owner,tags:B.tags})),!0),k.clear();for(const B of e(L))k.set(B.id,B)});let W=null,b=null,_=t.inputPlaceholder??"Search...";Ze(()=>{const c=v(),u=t.inputPlaceholder??"Search...";if(!c){W?.(),W=null,b=null,_=u,s(A,"");return}if(c===b){u!==_&&(c.setPlaceholder(u),_=u);return}W?.(),W=null,_=u,W=c.attachInputBinding({placeholder:u,onInput:P=>{s(A,P,!0)}}),b=c}),Pt(()=>{W?.(),W=null,b=null});async function N(c){e(S).has(c)?R(c):await m(c)}function R(c){const u=e(S).get(c);!u||!e(i)||!e(i).map||(e(i).map.remove(u),e(S).delete(c),s(S,e(S),!0),console.log(`Layer removed from the map: ${c}`))}async function m(c){if(!e(i)||!e(i).map){console.error("Map or MapView is not initialized"),n.set(c,new Error("Map is not ready. Please wait and try again."));return}s(x,c,!0),n.delete(c);try{console.log(`Loading layer with portal item ID: ${c}`);const u=t.commandSearchContext.get(Xe);if(!u.getActiveOrganisationId()){console.warn("No active organisation selected in OrganisationCommandService");return}const z=u.getActiveOrganisationPortalUrl(),[{default:X},{default:B}]=await Promise.all([Oe(()=>import("../chunks/Db91rTNV.js").then(ce=>ce.P),__vite__mapDeps([9,6,1,3,2,7]),import.meta.url),Oe(()=>import("../chunks/mvO4rAvm.js").then(ce=>ce.P),__vite__mapDeps([7,2,1,3]),import.meta.url)]),Z=new B({url:z}),U=await X.fromPortalItem({portalItem:{id:c,portal:Z}});await U.load();const be=await d(U,c);await E(be),e(i).map.add(U),e(S).set(c,U),s(S,e(S),!0),console.log("Layer added to the map");try{await e(i).whenLayerView(U),U.fullExtent&&await e(i).goTo(U.fullExtent)}catch(ce){console.warn("Layer view not ready for navigation",ce)}}catch(u){console.error("Error loading layer:",u),n.set(c,u),s(x,null)}finally{s(x,null)}}async function d(c,u){const P=w(c);if(P)return P;const z=k.get(u);if(z?.spatialReferenceWkid){const{default:B}=await Oe(async()=>{const{default:Z}=await import("../chunks/BfMV86KQ.js").then(U=>U.bV);return{default:Z}},__vite__mapDeps([3,1,2]),import.meta.url);return new B({wkid:z.spatialReferenceWkid})}const X=c.portalItem?.spatialReference;return X||null}function w(c){return c?.spatialReference??null}function F(c){if(!c)return;const u=c;return c.wkid??u?.latestWkid??void 0}async function j(c){if(!e(i)||!e(i).map)return console.warn("MapView or Map is not available for basemap loading"),null;if(!c)return e(i).map.basemap;const u=I[c];if(!u)return e(i).map.basemap;const{default:P}=await Oe(async()=>{const{default:z}=await import("../chunks/BiKLiV0b.js").then(X=>X.B);return{default:z}},__vite__mapDeps([5,2,1,3,6,7,8,9,10,11,12]),import.meta.url);try{return await P.fromId(u)}catch(z){return console.warn(`Failed to load basemap ${u}`,z),e(i).map.basemap}}async function E(c){if(!e(i)||!e(i).map||!c){console.log("MapView or target spatial reference is not available","mapView:",e(i),"target:",c);return}const u=F(c),P=F(e(i).spatialReference??void 0);if(console.log(`Ensuring map view spatial reference compatibility: target WKID=${u}, current WKID=${P}`),!u||u===P)return;const[{default:z}]=await Promise.all([Oe(()=>import("../chunks/h5rW6lAS.js").then(be=>be.M),__vite__mapDeps([4,1,5,2,3,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]),import.meta.url)]),X=await j(u),B=e(i).map.layers.toArray(),Z=e(i).map.ground;e(i).map.removeAll();const U=new z({basemap:X??void 0,ground:Z});U.spatialReference=c,U.layers.addMany(B),e(i).map=U,await e(i).when()}var ne=ma(),we=g(ne);{var oe=c=>{var u=oa(),P=g(u),z=g(P);p(P),p(u),J(()=>ae(z,`${y.error.message??""}. ${y.error?.details?.httpStatus===0?"Reason: CORS Error. See console for more information.":""}`)),o(c,u)},Ce=c=>{var u=D(),P=C(u);{var z=B=>{var Z=sa(),U=g(Z);ot(U,{class:"size-5"}),p(Z),o(B,Z)},X=B=>{var Z=D(),U=C(Z);Q(U,()=>dt,(be,ce)=>{ce(be,{children:(ie,He)=>{var Qe=D(),We=C(Qe);{var rt=pe=>{var Ie=D(),a=C(Ie);Q(a,()=>ut,(l,r)=>{r(l,{children:(q,ee)=>{Ke();var G=qe("No layers match your search.");o(q,G)},$$slots:{default:!0}})}),o(pe,Ie)},je=pe=>{var Ie=D(),a=C(Ie);et(a,17,()=>e(T),l=>l.id,(l,r)=>{var q=D(),ee=C(q);{let G=K(()=>e(S).has(e(r).id)?"layer-selected":"");Q(ee,()=>ft,(ge,Ae)=>{Ae(ge,{onclick:()=>N(e(r).id),get class(){return e(G)},children:(Se,Ye)=>{const Ee=K(()=>n.get(e(r).id));var Ue=D(),ye=C(Ue);{var de=te=>{var se=ia(),ue=g(se);ot(ue,{class:"size-4"});var fe=Y(ue,2),Re=g(fe);p(fe),p(se),J(()=>ae(Re,`Loading ${e(r).title??"Untitled layer"??""}...`)),o(te,se)},Ve=te=>{var se=va(),ue=C(se);{var fe=V=>{var O=la(),H=g(O);gr(H,{}),p(O),o(V,O)};M(ue,V=>{e(S).has(e(r).id)&&V(fe)})}var Re=Y(ue,2),Me=g(Re),at=g(Me,!0);p(Me);var he=Y(Me,2);{var Be=V=>{var O=ca(),H=g(O,!0);p(O),J(()=>{Ge(O,"title",e(r).description),ae(H,e(r).description)}),o(V,O)};M(he,V=>{e(r).description&&V(Be)})}var ve=Y(he,2);{var Le=V=>{var O=da(),H=g(O,!0);p(O),J(()=>ae(H,e(r).type??"")),o(V,O)};M(ve,V=>{e(r).type&&V(Le)})}var ke=Y(ve,2);{var $e=V=>{var O=ua(),H=g(O),le=Y(H);{var re=Pe=>{var De=qe();De.nodeValue=" (auto aligns view)",o(Pe,De)};M(le,Pe=>{I[e(r).spatialReferenceWkid]&&Pe(re)})}p(O),J(()=>ae(H,`WKID ${e(r).spatialReferenceWkid??""} `)),o(V,O)};M(ke,V=>{e(r).spatialReferenceWkid&&V($e)})}var me=Y(ke,2);{var xe=V=>{const O=K(()=>`${e(Ee).message}. ${e(Ee).details?.error?.details?.httpStatus===0?"Reason: CORS Error. See console for more information.":""}`);var H=fa(),le=g(H);kt(le,{size:16});var re=Y(le,2),Pe=g(re,!0);p(re),p(H),J(()=>{Ge(H,"title",e(O)),ae(Pe,e(O))}),o(V,H)};M(me,V=>{e(Ee)&&V(xe)})}p(Re),J(()=>{Ge(Me,"title",e(r).title),ae(at,e(r).title??"Untitled layer")}),o(te,se)};M(ye,te=>{e(x)===e(r).id?te(de):te(Ve,!1)})}o(Se,Ue)},$$slots:{default:!0}})})}o(l,q)}),o(pe,Ie)};M(We,pe=>{e(T).length===0?pe(rt):pe(je,!1)})}o(ie,Qe)},$$slots:{default:!0}})}),o(B,Z)};M(P,B=>{y.isLoading?B(z):B(X,!1)},!0)}o(c,u)};M(we,c=>{y.error?c(oe):c(Ce,!1)})}p(ne),o(f,ne),ze()}const Bt={id:"add-layer",name:"Add layers",description:"Fetch and display layers.",group:"Maps",shortcut:["Ctrl","L"],execute:async()=>{},component:pa,props:f=>({commandSearchContext:f.getContext(),inputPlaceholder:Bt.inputPlaceholder})};mt("add-layer",Bt);var ga=h('<div class="flex w-full min-w-0 flex-col gap-0.5"><span class="title-text font-medium text-foreground svelte-1w2u78y"> </span></div>'),ha=h('<div class="item-container svelte-1w2u78y"><!></div>');function _a(f,t){Ne(t,!0);const v=_e(t,"runtime",3,null);let y=$(Fe([])),i=$("");it(async()=>{const I=t.commandSearchContext.get(bt)?.organisations;if(!I){console.warn("No organisation configuration found in MapsConfig");return}s(y,I,!0)});let x=null,n=null,A=t.inputPlaceholder??"Search...";Ze(()=>{const I=v(),T=t.inputPlaceholder??"Search...";if(!I){x?.(),x=null,n=null,A=T,s(i,"");return}if(I===n){T!==A&&(I.setPlaceholder(T),A=T);return}x?.(),x=null,A=T,x=I.attachInputBinding({placeholder:T,onInput:W=>{s(i,W,!0)}}),n=I}),Pt(()=>{x?.(),x=null,n=null});function S(I){t.commandSearchContext.get(Xe).setActiveOrganisation(I),v()&&v().deactivate()}var L=ha(),k=g(L);Q(k,()=>dt,(I,T)=>{T(I,{children:(W,b)=>{var _=D(),N=C(_);{var R=d=>{var w=D(),F=C(w);Q(F,()=>ut,(j,E)=>{E(j,{children:(ne,we)=>{Ke();var oe=qe("No organisations match your search.");o(ne,oe)},$$slots:{default:!0}})}),o(d,w)},m=d=>{var w=D(),F=C(w);et(F,17,()=>e(y),j=>j.name,(j,E)=>{var ne=D(),we=C(ne);Q(we,()=>ft,(oe,Ce)=>{Ce(oe,{onclick:()=>S(e(E).id),children:(c,u)=>{var P=ga(),z=g(P),X=g(z,!0);p(z),p(P),J(()=>ae(X,e(E).name??"Untitled organisation")),o(c,P)},$$slots:{default:!0}})}),o(j,ne)}),o(d,w)};M(N,d=>{e(y).length===0?d(R):d(m,!1)})}o(W,_)},$$slots:{default:!0}})}),p(L),o(f,L),ze()}const wa={id:"add-organisation",name:"Add organisation",description:"Find and add an organisation to filter items by.",group:"Maps",shortcut:["Ctrl","O"],inputPlaceholder:"Search organisations...",component:_a,execute:async()=>{},props:f=>({commandSearchContext:f.getContext(),inputPlaceholder:"Search organisations..."})};mt("add-organisation",wa);const ya={id:"clear-map",name:"Clear map",description:"Clear all layers and reset the map view.",shortcut:["Ctrl","C"],execute:async f=>{const t=f.getContext().get(st).mapView;t&&t.map&&(t.map.layers.removeAll(),t.map.basemap="gray",await t.map.basemap?.loadAll()),f.deactivate()}};mt("clear-map",ya);var xa=h("<arcgis-layer-list></arcgis-layer-list>",2),Ca=h('<div id="search-slot" class="absolute top-3 left-1/2 z-10 -translate-x-1/2"><!></div>'),ba=h("<arcgis-map><!></arcgis-map>",2);function Ja(f,t){Ne(t,!0);const v=new Qr;let y=$(null),i=$(null),x=$(null),n=$(null),A=$(!0),S=$(Fe([]));it(async()=>{const b=await L(),_=new Xe(b.organisations);v.add(bt,b),v.add(Xe,_),await I(),s(S,[lt("add-web-map"),lt("add-layer"),lt("add-organisation"),lt("clear-map")],!0)});async function L(){const b=await fetch(Rt("/config/maps/config.json"));if(!b.ok)throw new Error(`Failed to load maps config: ${b.status} ${b.statusText}`);const _=await b.json();return new bt(_.organisations)}async function k(){if(!e(x))return;s(y,e(x).view,!0),v.add(st,new st(e(y)));const b="#cfd3d4";e(x).background={color:b},e(n)&&(e(n).view=e(y),e(n).listItemCreatedFunction=_=>{const{item:N}=_;N.layer.type!="group"&&(N.panel={content:"legend",open:!0})})}async function I(){await Oe(()=>import("../chunks/Epqbrrx8.js").then(b=>b.a),__vite__mapDeps([70,71,72,73,6,1,3,2,7,74,75,76,77,9,17,18,14,78,31,13,29,16,30,79,80,81,82,83]),import.meta.url),await Oe(()=>import("../chunks/BqgbqPku.js"),__vite__mapDeps([84,85,72,73,86,87,88,89,90,91,92,93,94,74,95,96,71,6,1,3,2,7,75,9,80,97,30,13,14,29,16,18,98,34,35,17,99,59,60,53,54,100,62,78,31,101,43,44,102,83,103,104,105,106,38,23,39,40,41,42,36,45,46,47,48,107,50,108,109,110,52,55,56,57,58,61,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138]),import.meta.url),await Oe(()=>import("../chunks/QoFPZSeS.js"),__vite__mapDeps([139,85,72,73,86,87,140,90,92,141,95,74,94,142,143,144,145,103,71,6,1,3,2,7,75,146,26,27,16,28,14,29,13,18,30,31,9,15,147,23,148,149,77,17,78,150,151,4,5,8,10,11,12,19,20,21,22,24,25,76,152,101,153,154,65,66,129,155,156,157,158,159,160,161,128,162,163,134,164,138,82,0,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,67,68,69]),import.meta.url)}var T=D(),W=C(T);{const b=N=>{xt(N,{class:"h-full",children:(R,m)=>{var d=xa();ct(d,1,"mx-2 min-h-20"),nt(d,w=>s(n,w),()=>e(n)),o(R,d)},$$slots:{default:!0}})},_=N=>{var R=ba();ct(R,1,"relative h-full w-full"),wt(R,"basemap","gray"),wt(R,"center","-2.231774828836059,53.46531847221502"),wt(R,"zoom","15");var m=g(R);{var d=w=>{var F=Ca(),j=g(F);Hr(j,{class:"w-full max-w-md",get commandSearchContext(){return v},get commands(){return e(S)},get ref(){return e(i)},set ref(E){s(i,E,!0)}}),p(F),o(w,F)};M(m,w=>{e(S).length>0&&w(d)})}p(R),nt(R,w=>s(x,w),()=>e(x)),yt("arcgisViewReadyChange",R,k),o(N,R)};Q(W,()=>Cr,(N,R)=>{R(N,{get isOpen(){return e(A)},onToggle:()=>s(A,!e(A)),sidebarContent:b,mainContent:_,$$slots:{sidebarContent:!0,mainContent:!0}})})}o(f,T),ze()}export{Ja as component};
