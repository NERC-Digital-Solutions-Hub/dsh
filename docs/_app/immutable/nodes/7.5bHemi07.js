const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/tWIlYmLc.js","../chunks/DEfw6_ef.js","../chunks/BsH20_Vs.js","../chunks/Cg-g7sfq.js","../chunks/CxlgmuS0.js","../chunks/PPVm8Dsz.js","../chunks/CbSHxjnO.js","../chunks/CuDkSQ9K.js","../chunks/H0QphIdm.js","../chunks/CYlsogSb.js","../chunks/DiDKkOPS.js","../chunks/CupCqN7H.js","../chunks/XDfhPTz9.js","../chunks/i1FBtECX.js","../chunks/DEofI9xF.js","../chunks/CXxgNwmb.js","../chunks/BvZUr92_.js","../chunks/ClNG7cqw.js","../chunks/CpmMRAq-.js","../chunks/Cp_8tW2x.js","../chunks/BsdKzw5M.js","../chunks/C_0-aHjr.js","../chunks/Ci6C1k20.js","../chunks/bnayRBMH.js","../chunks/62qj6Kpw.js","../chunks/CErz6YiP.js","../chunks/GBH_ff3h.js","../chunks/Oe6SV2kF.js","../chunks/CTb2irFk.js","../chunks/MtSiOt06.js","../chunks/C0wm8_Yw.js","../chunks/3slrYEkV.js","../chunks/D0AGBp4m.js","../chunks/BXgHj_R5.js","../chunks/v-Ii51UH.js","../chunks/FGXSRGVg.js","../chunks/C0i3V7C8.js","../chunks/Djp3mnm5.js","../chunks/DKyYFRGo.js","../chunks/DYawoE1a.js","../chunks/DBuKqDYo.js","../chunks/B48eeFnl.js","../chunks/BYatnZGe.js","../chunks/B87vTgcy.js","../chunks/6L2SN8qu.js","../chunks/CVfonb79.js","../chunks/wCjEFJCX.js","../chunks/D3qbIiMo.js","../chunks/Bc4mpJhY.js","../chunks/DQaHheF0.js","../chunks/DV4r8n6I.js","../chunks/B2U_oPpb.js","../chunks/CNDan-Rx.js","../chunks/DGDScQxG.js","../chunks/CVwTD0fV.js","../chunks/D2jIvlkk.js","../chunks/Bwyp3dnI.js","../chunks/DPJXGPFY.js","../chunks/ExwrXyXn.js","../chunks/BGpT5vjv.js","../chunks/q_b6UJoq.js","../chunks/ktuqrY34.js","../chunks/Ctgqef5D.js","../chunks/CMiA3YQc.js","../chunks/DS9C8gJc.js","../chunks/fHzmurrr.js","../chunks/WNRSLWWh.js","../chunks/D7sjVwUC.js","../chunks/DvKU1K2H.js","../chunks/BlOilgcx.js","../assets/index.CQED0rIl.css","../chunks/DqbAVxMv.js","../chunks/B_nYcLPE.js","../chunks/Dsdk2tBG.js","../chunks/Cs8pR8So.js","../chunks/BgGtT-vP.js","../chunks/Bdxq8yCu.js","../chunks/DrKQjMrE.js","../chunks/DzMNFj8U.js","../chunks/Cgb6qxNH.js","../chunks/Bz66wGT9.js","../chunks/Bc6r6iEs.js","../chunks/F0BUsLjt.js","../chunks/CnMVBO6H.js","../chunks/D_njKkhs.js","../chunks/CaVKkSa6.js","../chunks/lHHrw-Fy.js","../chunks/B8u0uflR.js","../chunks/B1N-tmtC.js","../chunks/DfmE7muS.js","../chunks/CawG38_V.js","../chunks/D-qJO60r.js","../chunks/QQC62dOK.js","../chunks/Bxxl7NsE.js","../chunks/B2f5VqqG.js","../chunks/DQOO6RKE.js","../chunks/B-bZALxR.js","../chunks/Bi6C4OG6.js","../chunks/CJXkYEXo.js","../chunks/D-YQ4CHs.js","../chunks/CVaFVXl_.js","../chunks/DmBOxXOl.js","../chunks/DRBpbFTt.js","../chunks/CIVnWVW-.js","../chunks/l8ODxJLy.js","../chunks/BXmoyKZo.js","../chunks/kwrskX6P.js","../chunks/CSXZNpHb.js","../chunks/B5sfERVE.js","../chunks/DYatL6-0.js","../chunks/SKHDfhet.js","../chunks/x-rwtYAj.js","../chunks/CnMl1gv8.js","../chunks/S1-2yIgm.js","../chunks/_Pe164bs.js","../chunks/CuL02vTr.js","../chunks/DgVWghap.js","../chunks/-RG-nG9T.js","../chunks/fsKfK0sy.js","../chunks/DQbAsBwU.js","../chunks/spAbxKnx.js","../chunks/CX3ZFNfL.js","../chunks/BmF0IJ7E.js","../chunks/36uNJNa5.js","../chunks/CEKE62pQ.js","../chunks/B5qWImIY.js","../chunks/CiTlTuUs.js","../chunks/CNS1QZY8.js","../chunks/CbFgluc7.js","../chunks/B5Hsb4hi.js","../chunks/C0kKYzrM.js","../chunks/kRFlM29_.js","../chunks/CzKZmtx0.js","../chunks/DLaSncW_.js","../chunks/ByqZcsO_.js","../chunks/4JtatMd6.js","../chunks/rk55UWB4.js","../chunks/queAb42C.js","../chunks/B6ZUGniA.js","../chunks/Dlz37zDM.js","../chunks/GKolV7NZ.js","../chunks/BBdCmBkR.js","../chunks/vZpAfLDx.js","../chunks/x3RVuiyh.js","../chunks/88DWifGA.js","../chunks/Bmgo1H0I.js","../chunks/8AGV1qtY.js","../chunks/92klRbLe.js","../chunks/DJbTxK2-.js","../chunks/ggylUvPH.js","../chunks/Cto6YqlL.js","../chunks/DhzudQro.js","../chunks/BNpAlv8J.js","../chunks/BeANzU7s.js","../chunks/B_Z9OVhx.js","../chunks/DJ9aDd4R.js","../chunks/DKwqxe3-.js","../chunks/D8ujzhvG.js","../chunks/BZQvkt3k.js","../chunks/DLLlF3RK.js","../chunks/Dt79-m9U.js","../chunks/CcIpjlrY.js","../chunks/m4Bs3uz7.js","../chunks/B5rM3F5M.js","../chunks/JCteah4Q.js","../chunks/qyF9FwQ9.js","../chunks/XI-Li77m.js","../chunks/BmnLPdqE.js","../chunks/BTIdS9sW.js","../chunks/DPb6J-GU.js","../chunks/CEe-6-vO.js","../chunks/wviEkgi6.js","../chunks/LY0Drczk.js","../chunks/CKHFt-LJ.js","../chunks/CHyjlL6-.js","../chunks/BfrB-kUx.js","../chunks/DzoO0ETS.js","../chunks/noHA0x_k.js","../chunks/CxJOUKnC.js","../chunks/BJ6k9N22.js","../chunks/DOTCkzsN.js","../chunks/HwIixIZ0.js","../chunks/DVPBzQS7.js","../chunks/0vDwWQHq.js","../chunks/WnwY1cq9.js","../chunks/BZA5O26k.js","../chunks/CaYZrGFV.js"])))=>i.map(i=>d[i]);
import"../chunks/DsnmJJEf.js";import{a as Ft,o as Pt}from"../chunks/CsvHgo6E.js";import{p as Y,f as I,a as J,F as r,X as $,c as b,n as se,r as w,aG as N,ax as K,ar as _,y as ee,a8 as A,t as Q,l as ce}from"../chunks/C2G-U2Rp.js";import{p as zt,c as E,a as l,f as V,t as me}from"../chunks/Bw9dopYk.js";import{p as Z,i as z,r as ut,s as Et,a as Ot,b as Gt}from"../chunks/BwRR2sz5.js";import{_ as ge}from"../chunks/PPVm8Dsz.js";import{s as ae,e as ue,i as He}from"../chunks/DDY_L61N.js";import{b as Be}from"../chunks/Ck-qfSU1.js";import{S as de}from"../chunks/BbM6OCzS.js";import{c as q}from"../chunks/YPopVK-T.js";import{T as Ut,O as ht,a as Rt,G as at,F as nt,b as jt,c as Ce,d as ft,t as le,e as Bt,f as Wt,g as qt,h as Xt,i as Zt,S as Ie,C as ot,j as Qt,I as Yt,k as Jt,l as Kt,L as $t,m as ei,V as st,n as ti,o as ii}from"../chunks/DnwXDgRb.js";import{a as ri,e as De,b as ke,s as ye,f as ai}from"../chunks/P7z0ujPM.js";import{s as re}from"../chunks/VHBl3xBG.js";import{h as be}from"../chunks/Dn9W2mAS.js";import{f as Ae}from"../chunks/B7MCGzuW.js";import{C as ni,X as oi,a as si,b as li,g as di}from"../chunks/2odzE28I.js";import{c as ci}from"../chunks/DjSD7d6X.js";import{a as We,g as ui,m as hi}from"../chunks/Dywrsv9N.js";import{C as Ke}from"../chunks/RFbR4QUt.js";import{C as $e}from"../chunks/DHKFkDmX.js";import{C as fi}from"../chunks/CUHrt0sg.js";import{S as vi}from"../chunks/ByBLjScv.js";import{s as gi,f as yi,g as mi,h as wi,i as pi}from"../chunks/BODOddys.js";import{B as ve}from"../chunks/B-p-siuQ.js";import{s as bi}from"../chunks/Ce7XlCe7.js";import{S as _i,C as Si}from"../chunks/BH_a3QLS.js";var Ci=V("<div><!></div>");function Ii(d,e){const t=zt();Y(e,!0);let i=Z(e,"id",19,()=>ui(t)),a=Z(e,"ref",15,null),n=ut(e,["$$slots","$$events","$$legacy","children","child","id","ref","value"]);const s=Ut.create({value:We(()=>e.value),id:We(()=>i()),ref:We(()=>a(),o=>a(o))}),m=$(()=>hi(n,s.props));var c=E(),h=I(c);{var g=o=>{var y=E(),u=I(y);ae(u,()=>e.child,()=>({props:r(m)})),l(o,y)},p=o=>{var y=Ci();ri(y,()=>({...r(m)}));var u=b(y);ae(u,()=>e.children??se),w(y),l(o,y)};z(h,o=>{e.child?o(g):o(p,!1)})}l(d,c),J()}const Hi=()=>{const d=bi;return{page:{subscribe:d.page.subscribe},navigating:{subscribe:d.navigating.subscribe},updated:d.updated}},ki={subscribe(d){return Hi().page.subscribe(d)}};function Ai(d,e){Y(e,!0);let t=Z(e,"ref",15,null),i=ut(e,["$$slots","$$events","$$legacy","ref","class"]);var a=E(),n=I(a);{let s=$(()=>ci("flex-1 outline-none",e.class));q(n,()=>Ii,(m,c)=>{c(m,Et({"data-slot":"tabs-content",get class(){return r(s)}},()=>i,{get ref(){return t()},set ref(h){t(h)}}))})}l(d,a),J()}class Li{#e=N(K({featureLayerView:null,areaInfos:[]}));get layerHighlightState(){return r(this.#e)}set layerHighlightState(e){_(this.#e,e,!0)}#t=N(null);get lastAddedArea(){return r(this.#t)}set lastAddedArea(e){_(this.#t,e,!0)}#a=N(null);get lastRemovedArea(){return r(this.#a)}set lastRemovedArea(e){_(this.#a,e,!0)}#i=N(null);get currentHoveredArea(){return r(this.#i)}set currentHoveredArea(e){_(this.#i,e,!0)}#r=[];#o=new de;setNameFields(e){console.log("Setting name fields:",e),this.#r=e}setSelectedLayerView(e){this.layerHighlightState?.featureLayerView!==e&&(this.layerHighlightState&&this.layerHighlightState.areaInfos.forEach(t=>{t.handle.remove()}),this.layerHighlightState={featureLayerView:e,areaInfos:[]})}clearSelectedLayerView(){this.layerHighlightState.featureLayerView!==null&&(this.resetSelectedAreas(),this.layerHighlightState.featureLayerView=null)}resetSelectedAreas(){!this.layerHighlightState.featureLayerView&&this.layerHighlightState.areaInfos.length===0||(this.layerHighlightState&&this.layerHighlightState.areaInfos.forEach(e=>{e.handle.remove()}),this.layerHighlightState={featureLayerView:null,areaInfos:[]})}addSelectedArea(e,t){if(console.log("Adding selected area with ID:",e),!this.layerHighlightState){console.warn("SelectedAreasStore: No feature layer view is set.");return}const i={id:e,handle:t};this.layerHighlightState.areaInfos.push(i),this.lastAddedArea=i}removeSelectedArea(e){if(console.log("Removing selected area with ID:",e),!this.layerHighlightState){console.warn("SelectedAreasStore: No feature layer view is set.");return}const t=this.layerHighlightState.areaInfos.findIndex(i=>i.id===e);t!==-1&&(this.lastRemovedArea={id:e,handle:this.layerHighlightState.areaInfos[t].handle},this.layerHighlightState.areaInfos[t].handle.remove(),this.layerHighlightState.areaInfos.splice(t,1))}async getAreaNamesById(e){if(!this.layerHighlightState?.featureLayerView)return[];const t=this.getNameFieldForCurrentLayer();if(!t)return[];const i=this.layerHighlightState.featureLayerView.layer;let a=this.#o.get(i.uid);a||(a=new de,this.#o.set(i.uid,a));const n=new Array(e.length),s=new de,m=[];if(e.forEach((g,p)=>{s.set(g,p);const o=a.get(g);o!==void 0?n[p]=o:m.push(g)}),m.length===0)return n.map(g=>g??"");const c=i.objectIdField,h=await i.queryFeatures({objectIds:m,outFields:[t,c],returnGeometry:!1});for(const g of h.features){const p=g.attributes[c],o=g.attributes[t],y=s.get(p);y!==void 0&&(n[y]=o??"",a.set(p,o??""))}return n.map(g=>g??"")}setHoveredArea(e,t){this.currentHoveredArea&&this.clearHoveredArea(),this.currentHoveredArea={id:e,handle:t}}clearHoveredArea(){this.currentHoveredArea&&(this.currentHoveredArea?.handle.remove(),this.currentHoveredArea=null)}getNameFieldForCurrentLayer(){if(!this.layerHighlightState||!this.layerHighlightState.featureLayerView)return null;const e=this.#r.find(t=>t.layerName===this.layerHighlightState?.featureLayerView?.layer?.title)?.field;return e||(console.warn(`SelectedAreasStore: No name field configured for layer ${this.layerHighlightState.featureLayerView.layer.title}`,this.#r),null)}}const G=new Li;class xi{#e=N(null);get mapView(){return r(this.#e)}set mapView(e){_(this.#e,e,!0)}#t=N(K(new Set));get interactableLayers(){return r(this.#t)}set interactableLayers(e){_(this.#t,e,!0)}pointerMoveHandle=null;clickHandle=null;leaveHandle=null;enterHandle=null;#a=N(!1);get isInitialized(){return r(this.#a)}set isInitialized(e){_(this.#a,e,!0)}#i=N(!0);get pointerInsideMap(){return r(this.#i)}set pointerInsideMap(e){_(this.#i,e,!0)}initializationInProgress=!1;async initializeAsync(e,t){if(console.log("[map-interaction-store] Initializing with MapView"),this.mapView===e&&this.isInitialized){console.log("[map-interaction-store] MapView is already initialized"),this.interactableLayers=t;return}if(this.initializationInProgress){console.log("[map-interaction-store] Initialization already in progress");return}this.initializationInProgress=!0,console.log("[map-interaction-store] Cleaning up previous MapView if any"),this.cleanup(),this.mapView=e,this.interactableLayers=t,await e.when(),this.setupHighlights(e),this.setupPointerMoveHandler(e),this.setupClickHandler(e),this.setupLeaveHandler(e),this.setupEnterHandler(e),this.isInitialized=!0,this.initializationInProgress=!1,console.log("[map-interaction-store] Initialized with MapView")}updateInteractableLayers(e){this.interactableLayers=e}setupHighlights(e){const t={name:"hover",color:"lightgreen",haloOpacity:1,fillOpacity:.2},i={name:"selected",color:"green",haloOpacity:1,fillOpacity:.3};e.highlights.push(t),e.highlights.push(i)}setupPointerMoveHandler(e){this.pointerMoveHandle=e.on("pointer-move",async t=>{if(!this.pointerInsideMap)return;const{results:i}=await e.hitTest(t),a=i[0];if(!a){this.clearHoverHighlight();return}const n=a.graphic,s=n.layer;if(!n||!s||!this.isLayerInteractable(s.id)||n.attributes?.[s.objectIdField]===void 0){this.clearHoverHighlight();return}const m=n.attributes?.[s.objectIdField];if(!(G.currentHoveredArea&&G.currentHoveredArea.id===m))try{const c=await e.whenLayerView(s);G.layerHighlightState.featureLayerView!==c&&G.setSelectedLayerView(c),this.clearHoverHighlight();const h=c;if(!h){console.warn("LayerView is not a FeatureLayerView");return}if(!this.pointerInsideMap)return;const g=h.highlight(n,{name:"hover"});G.setHoveredArea(m,g)}catch(c){console.error("Error in pointer-move handler:",c),this.clearHoverHighlight()}})}setupClickHandler(e){this.clickHandle=e.on("click",async t=>{const{results:i}=await e.hitTest(t),a=i[0];if(!a)return;const n=a.graphic,s=n.layer;if(console.log("Clicked graphic:",n),!n||!s||!this.isLayerInteractable(s.id)||n.attributes?.[s.objectIdField]===void 0)return;const m=n.attributes?.[s.objectIdField];try{const c=await e.whenLayerView(s),h=c;if(!h){console.warn("Layer is not a FeatureLayerView");return}G.layerHighlightState.featureLayerView!==c&&G.setSelectedLayerView(c);const p=(G.layerHighlightState.areaInfos||[]).find(o=>o.id===m);if(p)G.removeSelectedArea(p.id);else{const o=h.highlight(n,{name:"selected"});G.addSelectedArea(m,o)}}catch(c){console.error("Error in click handler:",c)}})}setupLeaveHandler(e){this.leaveHandle=e.on("pointer-leave",()=>{this.pointerInsideMap=!1,this.clearHoverHighlight()})}setupEnterHandler(e){this.enterHandle=e.on("pointer-enter",()=>{this.pointerInsideMap=!0})}isLayerInteractable(e){return this.interactableLayers.has(e)}clearHoverHighlight(){G.currentHoveredArea&&G.clearHoveredArea()}cleanup(){this.pointerMoveHandle&&(this.pointerMoveHandle.remove(),this.pointerMoveHandle=null),this.clickHandle&&(this.clickHandle.remove(),this.clickHandle=null),this.leaveHandle&&(this.leaveHandle.remove(),this.leaveHandle=null),this.enterHandle&&(this.enterHandle.remove(),this.enterHandle=null),this.clearHoverHighlight(),this.isInitialized=!1,this.mapView=null,this.pointerInsideMap=!0,this.interactableLayers=new Set,console.log("[map-interaction-store] Cleaned up")}get currentMapView(){return this.mapView}get initialized(){return this.isInitialized}}const Te=new xi;var Vi=V('<div class="esri-ui-element svelte-xggl6e"><!></div>'),Ni=V('<div class="esri-ui-element svelte-xggl6e"><!></div>'),Ti=V('<div class="map-view svelte-xggl6e"></div> <!> <!>',1);function Mi(d,e){Y(e,!0);const t=Z(e,"webMap",3,null),i=Z(e,"panelPosition",3,"top-left"),a=Z(e,"menuPosition",3,"top-right");let n=null,s=N(null),m=N(null),c=N(null),h=N(!1);const g="streets-vector";let p,o;async function y(){if(!o){const[{default:C},{default:x},{default:D}]=await Promise.all([ge(()=>import("../chunks/tWIlYmLc.js").then(O=>O.M),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39]),import.meta.url),ge(()=>import("../chunks/DBuKqDYo.js").then(O=>O.a2),__vite__mapDeps([40,1,2,3,5,41,42,26,43,23,6,7,44,33,34,45,21,22,46,8,9,10,11,24,47,48,18,49,50,51,52,25,53,54,55,56,57,12,16,58,59,60,61,62,63,35,64,65,66,27,67,68,69,70,71,14,15,72,0,4,13,17,19,20,28,29,30,31,32,36,37,38,39,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99]),import.meta.url),ge(()=>import("../chunks/CVaFVXl_.js").then(O=>O.W),__vite__mapDeps([100,1,2,3,5,6,7,0,4,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,46,101,102,103,74,104,105,83,84,78,50,51,52,53,54,55,56,57,58,59,60,61,62,63,106,107,108,77,109,47,48,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,76,127,73,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,68,181,182,183,184,185,186]),import.meta.url)]);p=C,o=x}}async function u(C,x){const D=new o({container:x,popupEnabled:!1,map:C});return await D.when(),D}function v(C){C.ui.move("zoom","top-right"),r(m)&&i()&&C.ui.add(r(m),i()),r(c)&&a()&&C.ui.add(r(c),a()),_(h,!0)}async function M(){return new p({basemap:g})}async function L(){if(t())try{if(await y(),await H(),!r(s)){console.error("MapView is not initialized");return}r(s).map=t(),console.log("[uprn-map-view] MapView updated with new webMap")}catch(C){console.error("Error updating MapView with new webMap:",C)}}ee(()=>{t()&&L()});async function H(){if(!n){console.error("Map container element was not found");return}try{_(s,await u(t()??void 0,n),!0),v(r(s)),console.log("[uprn-map-view] Map loaded successfully")}catch(C){console.error("Error loading map:",C),await f()}}async function f(){try{const C=await M();_(s,await u(C,n),!0),v(r(s)),console.log("[uprn-map-view] Fallback map loaded")}catch(C){console.error("Error loading fallback map:",C)}}ee(()=>{if(!r(s)||!e.areaSelectionTreeviewStore.initialized)return;const C=e.areaSelectionTreeviewStore.getNonHiddenNodes().map(x=>x.id);Te.initialized?Te.updateInteractableLayers(new Set(C)):Te.initializeAsync(r(s),new Set(C))});async function S(C){if(!r(s))return;const x=await r(s).whenLayerView(C);if(!x){console.warn("Could not get LayerView for the visible node layer");return}G.setSelectedLayerView(x)}ee(()=>{if(!e.areaSelectionTreeviewStore.initialized)return;if(!e.areaSelectionTreeviewStore.getVisibleNodes().length){G.resetSelectedAreas();return}const C=e.areaSelectionTreeviewStore.getVisibleNodes()[0].layer;if(!C){console.warn("Visible node layer is not a FeatureLayer");return}S(C)});function T(){Te.cleanup(),r(s)&&r(s).destroy()}Ft(()=>{T()});var k=Ti(),j=I(k);Be(j,C=>n=C,()=>n);var F=A(j,2);{var U=C=>{var x=Vi(),D=b(x);{var O=P=>{var W=E(),B=I(W);ae(B,()=>e.panel),l(P,W)};z(D,P=>{r(h)&&P(O)})}w(x),Be(x,P=>_(m,P),()=>r(m)),l(C,x)};z(F,C=>{e.panel&&C(U)})}var R=A(F,2);{var X=C=>{var x=Ni(),D=b(x);{var O=P=>{var W=E(),B=I(W);ae(B,()=>e.menu),l(P,W)};z(D,P=>{r(h)&&P(O)})}w(x),Be(x,P=>_(c,P),()=>r(c)),l(C,x)};z(R,C=>{e.menu&&C(X)})}l(d,k),J()}var Di=V('<div class="tree-node-item svelte-1ehc80l"><!></div>'),Fi=V('<div class="tree-children relative ml-4 w-full svelte-1ehc80l"><div class="tree-guide-line tree-guide-line-animate svelte-1ehc80l"></div> <!></div>'),Pi=V('<div class="w-full"><!>  <!></div>');function vt(d,e){const t=Z(e,"isOpen",3,!1),i=Z(e,"childNodes",3,null);var a=Pi(),n=b(a);ae(n,()=>e.content??se);var s=A(n,2);{var m=c=>{var h=Fi(),g=A(b(h),2);ue(g,19,()=>i()??[],p=>p.id,(p,o,y)=>{var u=Di(),v=b(u);ae(v,()=>e.childNode??se,()=>r(o)),w(u),Q(()=>De(u,`animation-delay: ${100+r(y)*50}ms;`)),l(p,u)}),w(h),l(c,h)};z(s,c=>{t()&&i()&&c(m)})}w(a),l(d,a)}const gt="mb-1 cursor-pointer rounded-md border border-border/30 p-2 text-left",yt="transform-gpu transition-all duration-150 ease-out hover:border-border/50 hover:bg-card/70 hover:shadow-sm",zi="transition-colors hover:bg-card/70",Ye="text-sm font-normal",Je="bg-card/50",mt="bg-accent text-accent-foreground";function Ei(d){const{enhancedHover:e=!1,includeFont:t=!1,pressed:i=!1}=d;let a=gt;return e?a+=" "+yt:a+=" "+zi,t&&(a+=" "+Ye),i?a+=" "+mt:a+=" "+Je,a}const Oi="!h-auto !min-h-9 !whitespace-normal data-[state=on]:!bg-accent data-[state=on]:!text-accent-foreground data-[state=on]:hover:!bg-accent data-[state=on]:hover:!text-accent-foreground";var Gi=V('<div class="flex w-full !items-center !justify-between gap-2"><div class="pointer-events-none !flex min-w-0 flex-1 !items-center gap-1"><span class="inline-block size-4" aria-hidden="true"><!></span> <span class="block w-full text-left break-words"> </span></div> <!></div>'),Ui=V('<button><div class="flex w-full items-center justify-between gap-2"><div class="pointer-events-none flex min-w-0 flex-1 items-center gap-1"><!> <span class="inline-block size-4" aria-hidden="true"><!></span> <span class="block w-full text-left break-words"> </span></div> <!></div></button>');function lt(d,e){const t=`calc(100% - ${e.depth*1}rem)`,i=`${gt} ${yt}`,a=`${i} ${Oi} ${Je} ${Ye}`,n=`${i} ${Ye}`;var s=E(),m=I(s);{var c=g=>{Rt(g,{get pressed(){return e.pressed},get class(){return a},variant:"outline",get style(){return`width: ${t};`},get onPressedChange(){return e.onclick},children:(p,o)=>{var y=Gi(),u=b(y),v=b(u),M=b(v);be(M,()=>e.icon),w(v);var L=A(v,2),H=b(L,!0);w(L),w(u);var f=A(u,2);ae(f,()=>e.children??se),w(y),Q(()=>re(H,e.name)),l(p,y)},$$slots:{default:!0}})},h=g=>{var p=Ui();p.__click=function(...S){e.onclick?.apply(this,S)};var o=b(p),y=b(o),u=b(y);ht(u,{get isOpen(){return e.isOpen}});var v=A(u,2),M=b(v);be(M,()=>e.icon),w(v);var L=A(v,2),H=b(L,!0);w(L),w(y);var f=A(y,2);ae(f,()=>e.children??se),w(o),w(p),Q(()=>{ke(p,1,`${n} ${e.pressed?mt:Je}`),De(p,`width: ${t};`),re(H,e.name)}),l(g,p)};z(m,g=>{e.isTogglable?g(c):g(h,!1)})}l(d,s)}Ae(["click"]);const wt=(d,e,t,i)=>e?Ri(d,t):t?i?'<path d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/>':'<path d="M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/>':'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14,2 14,8 20,8"/>',Ri=(d,e)=>{switch(d.type){case"group":return at;case"feature":return nt;case"tile":return jt;default:return e?at:nt}};function pt(d,e){Y(e,!0);const t=v=>{var M=E(),L=I(M);{var H=f=>{var S=E(),T=I(S);{var k=F=>{lt(F,{isTogglable:!1,get pressed(){return r(h)},get icon(){return r(g)},get name(){return e.node.name},get depth(){return a()},onclick:u,get isOpen(){return r(c)}})},j=F=>{lt(F,{isTogglable:!0,get pressed(){return r(h)},get icon(){return r(g)},get name(){return e.node.name},get depth(){return a()},onclick:y,get isOpen(){return r(c)}})};z(T,F=>{m?F(k):F(j,!1)})}l(f,S)};z(L,f=>{e.treeviewConfigStore.getItemConfig(e.node.id)?.isHidden||f(H)})}l(v,M)},i=(v,M=se)=>{var L=E(),H=I(L);{var f=S=>{{let T=$(()=>a()+1);pt(S,{get treeviewConfigStore(){return e.treeviewConfigStore},get node(){return M()},get onNodeClick(){return e.onNodeClick},get onNodeVisibilityChange(){return e.onNodeVisibilityChange},get getNodeVisibility(){return e.getNodeVisibility},get depth(){return r(T)},get useLayerTypeIcon(){return n()}})}};z(H,S=>{m&&r(c)&&!e.treeviewConfigStore.getItemConfig(M().id)?.isHidden&&S(f)})}l(v,L)},a=Z(e,"depth",3,0),n=Z(e,"useLayerTypeIcon",3,!1),s=!!e.node.layer&&"visible"in e.node.layer,m=!!(e.node.children&&e.node.children.length);let c=N(!1),h=N(!1),g=N("");function p(){return!e.node.children||!e.getNodeVisibility?!1:e.node.children.some(v=>{const M=e.getNodeVisibility(v.id);return M!==void 0?M:v.layer.visible})}ee(()=>{if(e.node){if(m)_(h,p(),!0);else{const v=e.getNodeVisibility?e.getNodeVisibility(e.node.id):void 0;_(h,v!==void 0?v:e.node.layer.visible,!0)}_(g,wt(e.node.layer,n(),m,r(c)),!0)}});function o(){!s||!e.onNodeVisibilityChange||m||(_(h,!r(h)),e.onNodeVisibilityChange(e.node,r(h)))}function y(){m||o(),e.onNodeClick?.(e.node)}function u(){_(c,!r(c)),e.onNodeClick?.(e.node)}{let v=$(()=>m?e.node.children:null);vt(d,{get isOpen(){return r(c)},get content(){return t},get childNodes(){return r(v)},get childNode(){return i}})}J()}class bt{#e=N(!1);get initialized(){return r(this.#e)}set initialized(e){_(this.#e,e,!0)}#t=null;#a=N(K([]));#i=$(()=>{const e=new de;return this.#w(r(this.#a),e),e});#r=N(K(new de));#o=N(K(new de));initialize(e,t){if(this.initialized)throw new Error("TreeviewStore is already initialized.");if(this.initialized=!0,!t)throw new Error("TreeviewStore requires a valid TreeviewConfigStore to initialize.");if(this.#t=t,!e)throw new Error("TreeviewStore requires a valid array of layers to initialize.");_(this.#a,this.#u(e),!0)}getNodeById(e){return this.#l(),r(this.#i).get(e)}getNodes(){return this.#l(),r(this.#a)}getVisibleNodes(){this.#l();const e=[];for(const[t,i]of r(this.#r)){if(!i)continue;const a=r(this.#i).get(t);a&&e.push(a)}return e}getNonHiddenNodes(){return this.#l(),this.#d(r(this.#a))}#d(e){this.#l();const t=[];for(const i of e){const a=this.#n(i.id);if(!(a&&a.isHidden)&&(t.push(i),i.children?.length)){const n=this.#d(i.children);t.push(...n)}}return t}getVisibilityState(e){return this.#l(),r(this.#r).get(e)??!1}setVisibilityState(e,t){this.#l();const i=r(this.#i).get(e);if(!i)throw new Error(`Tree node not found for ID: ${e}`);if(r(this.#r).set(e,t),i.layer.visible=t,this.#s(i,t),i.visibilityDependencyIds?.length&&this.#c(i,t),!i.visibilityGroupId)return;const a=i.visibilityGroupId;console.log(`Node ${e} is part of visibility group ${a}`);let n=r(this.#o).get(a);n||(n=[],r(this.#o).set(a,n));const s=this.#v(a);if(!s)throw new Error(`Visibility group config not found for group ID: ${a}`);if(!t){const c=n.indexOf(e);n.splice(c,1);return}const m=c=>{r(this.#r).set(c,!1);const h=r(this.#i).get(c);h&&(h.layer.visible=!1,this.#s(h,!1),h.visibilityDependencyIds?.length&&this.#c(h,!1));const g=n.indexOf(c);g>=0&&n.splice(g,1)};for(;n.length>=s.maxVisibleLayers;){const c=n[0];m(c)}n.push(e),this.#s(i,t),i.visibilityDependencyIds?.length&&this.#c(i,t)}#s(e,t){e.parent&&(r(this.#r).set(e.parent.id,t),e.parent.layer.visible=t,this.#s(e.parent,t))}#c(e,t){if(e.visibilityDependencyIds?.length)for(const i of e.visibilityDependencyIds){const a=r(this.#i).get(i);a&&(r(this.#r).set(i,t),a.layer.visible=t,this.#s(a,t))}}#v(e){if(e&&this.#t)return this.#t.getVisibilityGroupConfig(e)}#u(e){const t=e.map(i=>{const a=this.#n(i.id);return this.#f(i,void 0,a)});return this.#h([...t])}#n(e){if(e&&this.#t)return this.#t.getItemConfig(e)}#h(e){e.reverse();for(const t of e)t.children?.length&&this.#h(t.children);return e}#f(e,t,i){const a={id:e.id,name:e.title,layer:e,visibilityDependencyIds:i?.visibilityDependencyIds,visibilityGroupId:i?.visibilityGroupId,children:[],parent:t};if(e.visible=i?.isVisibleOnInit??!1,r(this.#r).set(e.id,e.visible),this.#p(e)){const n=e;return a.children=n.layers.toArray().map(s=>{const m=this.#g(s,i);return this.#f(s,a,m)}),a}if(this.#y(e)){const n=e;if(n.sublayers&&n.sublayers.length>0){const s=n.sublayers;a.children=s.toArray().map(this.#m)}}return a}#g(e,t){if(!this.#t||!t)return;const i=this.#t.getItemConfig(e.id);return{id:e.id,type:Ce.None,isDownloadable:i?.isDownloadable,isVisibleOnInit:i?.isVisibleOnInit,isHidden:i?.isHidden,visibilityDependencyIds:i?.visibilityDependencyIds??t.visibilityDependencyIds,visibilityGroupId:i?.visibilityGroupId??t.visibilityGroupId}}#y(e){return e.type==="map-image"||e.type==="wms"}#m(e){const t={id:e.uid,name:e.title,layer:e,children:[]};return e.sublayers?.length&&(t.children=e.sublayers.toArray().map(this.#m)),t}#w(e,t){for(const i of e)t.set(i.id,i),i.children?.length&&this.#w(i.children,t)}#p(e){return e.type==="group"}#l(){if(!this.initialized)throw new Error("TreeviewStore is not initialized. Call initialize() first.")}}function ji(d,e){Y(e,!0);const t=Z(e,"webMap",3,null);ee(()=>{!t()||e.treeviewStore.initialized||e.treeviewStore.initialize(t().layers.toArray(),e.treeviewConfigStore)});var i=E(),a=I(i);{var n=s=>{var m=E(),c=I(m);q(c,()=>ft,(h,g)=>{g(h,{children:(p,o)=>{var y=E(),u=I(y);ue(u,17,()=>e.treeviewStore.getNodes(),v=>v.id,(v,M)=>{pt(v,{get treeviewConfigStore(){return e.treeviewConfigStore},get node(){return r(M)},onNodeClick:()=>{},onNodeVisibilityChange:(L,H)=>e.treeviewStore.setVisibilityState(L.id,H),getNodeVisibility:L=>e.treeviewStore.getVisibilityState(L),depth:0,useLayerTypeIcon:!0})}),l(p,y)},$$slots:{default:!0}})}),l(s,m)};z(a,s=>{e.treeviewStore.initialized&&s(n)})}l(d,i),J()}function Bi(d,e){Y(e,!0),ee(()=>{if(!G.lastAddedArea)return;(async()=>{if(G.lastAddedArea===null)return;const i=await G.getAreaNamesById([G.lastAddedArea.id]);!i||i.length===0||!i[0]||le.success(`Area added: ${i?.[0]}`)})()}),ee(()=>{if(!G.lastRemovedArea)return;(async()=>{if(G.lastRemovedArea===null)return;const i=await G.getAreaNamesById([G.lastRemovedArea.id]);!i||i.length===0||!i[0]||le.success(`Area removed: ${i?.[0]}`)})()}),J()}var Wi=V("<!> <!>",1),qi=V("<!> <!>",1);function Xi(d,e){Y(e,!0);const t=Z(e,"triggers",19,()=>[]);var i=E(),a=I(i);q(a,()=>Bt,(n,s)=>{s(n,{get value(){return e.value},get onValueChange(){return e.onValueChange},class:"w-full",children:(m,c)=>{var h=qi(),g=I(h);q(g,()=>Wt,(o,y)=>{y(o,{class:"tab-list",children:(u,v)=>{var M=E(),L=I(M);ue(L,17,t,He,(H,f,S,T)=>{let k=()=>r(f).value,j=()=>r(f).label;var F=Wi(),U=I(F);q(U,()=>qt,(C,x)=>{x(C,{get value(){return k()},class:"tab-trigger",children:(D,O)=>{ce();var P=me();Q(()=>re(P,j())),l(D,P)},$$slots:{default:!0}})});var R=A(U,2);{var X=C=>{ni(C,{class:"separator"})};z(R,C=>{k()!==t()[t().length-1]?.value&&C(X)})}l(H,F)}),l(u,M)},$$slots:{default:!0}})});var p=A(g,2);ae(p,()=>e.children??se),l(m,h)},$$slots:{default:!0}})}),l(d,i),J()}var Zi=V('<div class="min-w-0 space-y-2 overflow-hidden p-4"><!></div>'),Qi=V("<!> <!>",1);function Me(d,e){var t=E(),i=I(t);q(i,()=>Ai,(a,n)=>{n(a,{get value(){return e.value},class:"w-full",children:(s,m)=>{var c=E(),h=I(c);q(h,()=>Ke,(g,p)=>{p(g,{class:"w-full overflow-hidden",children:(o,y)=>{var u=Qi(),v=I(u);q(v,()=>$e,(H,f)=>{f(H,{class:"card-content overflow-hidden p-0",children:(S,T)=>{vi(S,{class:"h-[400px] w-full",children:(k,j)=>{var F=Zi(),U=b(F);ae(U,()=>e.children??se),w(F),l(k,F)},$$slots:{default:!0}})},$$slots:{default:!0}})});var M=A(v,2);{var L=H=>{var f=E(),S=I(f);q(S,()=>fi,(T,k)=>{k(T,{class:"flex items-center justify-between",children:(j,F)=>{var U=E(),R=I(U);ae(R,()=>e.footer),l(j,U)},$$slots:{default:!0}})}),l(H,f)};z(M,H=>{e.footer&&H(L)})}l(o,u)},$$slots:{default:!0}})}),l(s,c)},$$slots:{default:!0}})}),l(d,t)}class Yi{#e=N(!1);get isLoaded(){return r(this.#e)}set isLoaded(e){_(this.#e,e,!0)}#t=N(null);get data(){return r(this.#t)}set data(e){_(this.#t,e,!0)}#a=$(()=>{const e=new de;function t(i){e.set(i.id,i),i.type==="group"&&i.layers.forEach(n=>{t(n)})}return this.data&&this.data.layers.forEach(i=>{t(i)}),e});get dataLookup(){return r(this.#a)}set dataLookup(e){_(this.#a,e)}#i=N(!1);get loading(){return r(this.#i)}set loading(e){_(this.#i,e,!0)}#r=N(null);get error(){return r(this.#r)}set error(e){_(this.#r,e,!0)}async initializeAsync(e){if(!this.data){this.loading=!0,this.error=null;try{const{portalUrl:t,itemId:i,proxy:a}=e;await this.configurePortalAsync(t,a),await this.loadwebmapAsync(i)}catch(t){console.error("Error initializing webmap:",t),this.error=t.message}finally{this.loading=!1}}}async configurePortalAsync(e,t){if(!e)return;const i=await $i();if(i.portalUrl=e,console.log(i),!t)return;const{addProxyRule:a}=await er();console.log("Adding proxy rule for portal traffic"),a({urlPrefix:t?.urlPrefix,proxyUrl:t?.proxyUrl})}async loadwebmapAsync(e){if(this.data)return;const[t,i]=await Promise.all([Ji(),Ki()]),a=new i({id:e}),n=new t({portalItem:a});this.data=n,await this.data.when(),this.data.loaded&&(this.isLoaded=!0)}clear(){this.data=null,this.loading=!1,this.error=null}clearError(){this.error=null}getWebmap(){return this.data}}let qe=null,Xe=null,Ze=null,Qe=null;async function Ji(){return qe||(qe=ge(()=>import("../chunks/CVaFVXl_.js").then(d=>d.W),__vite__mapDeps([100,1,2,3,5,6,7,0,4,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,46,101,102,103,74,104,105,83,84,78,50,51,52,53,54,55,56,57,58,59,60,61,62,63,106,107,108,77,109,47,48,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,76,127,73,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,68,181,182,183,184,185,186]),import.meta.url).then(d=>d.default)),qe}async function Ki(){return Xe||(Xe=ge(()=>import("../chunks/ClNG7cqw.js"),__vite__mapDeps([17,5,1,2,3,6,7,10,16]),import.meta.url).then(d=>d.default)),Xe}async function $i(){return Ze||(Ze=ge(()=>import("../chunks/BsH20_Vs.js").then(d=>d.a4),[],import.meta.url).then(d=>d.default)),Ze}async function er(){return Qe||(Qe=ge(()=>import("../chunks/CuDkSQ9K.js").then(d=>d.O),__vite__mapDeps([7,2,3]),import.meta.url)),Qe}class tr{#e=N(K(new de));get DataSelections(){return r(this.#e)}set DataSelections(e){_(this.#e,e,!0)}addSelection(e){this.DataSelections.set(e.layerId,e),le.success(`'${e.name}' Added`)}removeSelection(e){const t=this.DataSelections.get(e);this.DataSelections.delete(e),le.success(`'${t?.name}' Removed`)}}const ie=new tr;function ir(d,e){d.stopPropagation(),e.onFilterClicked?.(e.layerId)}var rr=V("<button><!></button>");function _t(d,e){Y(e,!0);let t=N(K(e.hasFiltersApplied?.(e.layerId)??!1));ee(()=>{_(t,e.hasFiltersApplied?.(e.layerId)??!1,!0)});const i=$(()=>r(t)?Xt:Zt);var a=rr();let n;a.__click=[ir,e];var s=b(a);be(s,()=>r(i)),w(a),Q(m=>{n=ke(a,1,"filter-btn svelte-effqed",null,n,m),ye(a,"aria-pressed",r(t))},[()=>({active:r(t)})]),l(d,a),J()}Ae(["click"]);class ar{#e=N(null);get ActiveLayer(){return r(this.#e)}set ActiveLayer(e){_(this.#e,e,!0)}}var nr=V('<li class="area-item svelte-1eawb4y"><span class="area-name svelte-1eawb4y"> </span> <!></li>'),or=V('<ul class="selected-list svelte-1eawb4y"></ul> <p class="count svelte-1eawb4y"> </p>',1),sr=V('<p class="no-selection svelte-1eawb4y">No areas selected</p>'),lr=V('<li class="data-item svelte-1eawb4y"><span class="data-name svelte-1eawb4y"> </span> <div class="data-actions svelte-1eawb4y"><!> <!></div></li>'),dr=V('<ul class="selected-list svelte-1eawb4y"></ul> <p class="count svelte-1eawb4y"> </p>',1),cr=V('<p class="no-selection svelte-1eawb4y">No data selected</p>'),ur=V('<h2 class="svelte-1eawb4y">Export Options</h2> <div class="section svelte-1eawb4y"><h3 class="svelte-1eawb4y"> </h3> <h4 class="svelte-1eawb4y">Selected Areas</h4> <!></div> <div class="section svelte-1eawb4y"><h4 class="svelte-1eawb4y">Selected Data</h4> <!></div>',1);function hr(d,e){Y(e,!0);const t=Z(e,"fieldFilterMenuStore",7);let i=N(K([]));ee(()=>{if(!G.layerHighlightState.areaInfos.length){_(i,[],!0);return}(async()=>{const S=await G.getAreaNamesById(G.layerHighlightState.areaInfos.map(k=>k.id)),T=[];for(let k=0;k<S.length;k++)T.push({name:S[k]||"Unknown Area",HighlightAreaInfo:G.layerHighlightState.areaInfos[k]});_(i,T,!0)})()});function a(f){const S=r(i).findIndex(T=>T.name===f);S!==-1&&G.removeSelectedArea(r(i)[S]?.HighlightAreaInfo.id)}function n(f){console.log("[export-menu] Removing data selection for layerId:",f),ie.DataSelections.delete(f),console.log("[export-menu] Current SelectedData:",gi(ie.DataSelections))}function s(f){t().ActiveLayer?.id===f?t().ActiveLayer=null:t().ActiveLayer=e.webMapStore.dataLookup.get(f)}function m(f){const S=ie.DataSelections.get(f);return!(!S||!S.fields||S.fields.size===0||S.fields.size===e.webMapStore.dataLookup.get(f).fields?.length)}var c=ur(),h=A(I(c),2),g=b(h),p=b(g,!0);w(g);var o=A(g,4);{var y=f=>{var S=or(),T=I(S);ue(T,21,()=>r(i),He,(F,U)=>{var R=nr(),X=b(R),C=b(X,!0);w(X);var x=A(X,2);ve(x,{variant:"ghost",size:"sm",class:"area-remove-btn",onclick:()=>a(r(U).name),children:(D,O)=>{ce();var P=me("Ã—");l(D,P)},$$slots:{default:!0}}),w(R),Q(()=>re(C,r(U).name)),l(F,R)}),w(T);var k=A(T,2),j=b(k);w(k),Q(()=>re(j,`${r(i).length??""} area(s) selected`)),l(f,S)},u=f=>{var S=sr();l(f,S)};z(o,f=>{r(i).length>0?f(y):f(u,!1)})}w(h);var v=A(h,2),M=A(b(v),2);{var L=f=>{var S=dr(),T=I(S);ue(T,21,()=>[...ie.DataSelections.values()],He,(F,U)=>{var R=lr(),X=b(R),C=b(X,!0);w(X);var x=A(X,2),D=b(x);{var O=W=>{_t(W,{get layerId(){return r(U).layerId},onFilterClicked:s,hasFiltersApplied:m})};z(D,W=>{r(U).fields&&W(O)})}var P=A(D,2);ve(P,{variant:"ghost",size:"sm",class:"data-remove-btn",onclick:()=>n(r(U).layerId),children:(W,B)=>{ce();var ne=me("Ã—");l(W,ne)},$$slots:{default:!0}}),w(x),w(R),Q(()=>re(C,r(U).name)),l(F,R)}),w(T);var k=A(T,2),j=b(k);w(k),Q(()=>re(j,`${ie.DataSelections.size??""} data layer(s) selected`)),l(f,S)},H=f=>{var S=cr();l(f,S)};z(M,f=>{ie.DataSelections.size>0?f(L):f(H,!1)})}w(v),Q(f=>re(p,f),[()=>e.areaSelectionTreeviewStore.initialized?e.areaSelectionTreeviewStore.getVisibleNodes()[0]?.name:"Loading..."]),l(d,c),J()}class fr{#e=N(K([]));get downloads(){return r(this.#e)}set downloads(e){_(this.#e,e,!0)}}const pe=new fr;var vr=V('<p class="text-sm text-muted-foreground">Click "Export" to begin the download.</p> <!>',1);function gr(d,e){Y(e,!0);const t=()=>Gt(ki,"$page",i),[i,a]=Ot();function n(){if(G.layerHighlightState.areaInfos.length<=0){le.error("Please select at least one area to export.");return}if(ie.DataSelections.size<=0){le.error("Please select at least one data layer to export.");return}console.log("Starting export..."),le.info("Export started successfully.",{duration:4e3});const c=crypto.randomUUID();pe.downloads.push({id:c,url:`${t().url}/${c}`,status:"pending"}),e.onExportSuccess?.()}var s=vr(),m=A(I(s),2);ve(m,{onclick:n,children:(c,h)=>{ce();var g=me("Export");l(c,g)},$$slots:{default:!0}}),l(d,s),J(),a()}var yr=V('<p class="text-sm font-medium"> </p>'),mr=V('<div class="pointer-events-none fixed z-50 transition-opacity duration-200"><!></div>');function wr(d,e){Y(e,!0);let t=N(null),i=N(K({x:0,y:0})),a=0;const n=h=>{_(i,{x:h.clientX,y:h.clientY},!0)};ee(()=>(document.addEventListener("mousemove",n),()=>{document.removeEventListener("mousemove",n)})),ee(()=>{const h=G.currentHoveredArea?.id,g=++a;if(!h){_(t,null);return}(async()=>{const p=await G.getAreaNamesById([h]);g===a&&G.currentHoveredArea?.id===h&&_(t,p[0]??null,!0)})()});var s=E(),m=I(s);{var c=h=>{var g=mr(),p=b(g);q(p,()=>Ke,(o,y)=>{y(o,{class:"max-w-xs border !py-2 shadow-lg",children:(u,v)=>{var M=E(),L=I(M);q(L,()=>$e,(H,f)=>{f(H,{class:"!px-3 !py-0",children:(S,T)=>{var k=yr(),j=b(k,!0);w(k),Q(()=>re(j,r(t))),l(S,k)},$$slots:{default:!0}})}),l(u,M)},$$slots:{default:!0}})}),w(g),Q(()=>De(g,`left: ${r(i).x+10}px; top: ${r(i).y-10}px;`)),l(h,g)};z(m,h=>{r(t)&&h(c)})}l(d,s),J()}function pr(d,e){d.target===d.currentTarget&&e()}var br=(d,e)=>d.key==="Escape"&&e(),_r=(d,e,t)=>e(r(t).name),Sr=V('<div class="info-icon-container svelte-18b92yu"><!></div>'),Cr=V('<div class="field-content-wrapper svelte-18b92yu"><!> <button class="field-content svelte-18b92yu" tabindex="0"><div class="field-name-container svelte-18b92yu"><span class="field-name svelte-18b92yu"> </span> <!></div></button></div>'),Ir=V('<div class="master-checkbox-container svelte-18b92yu"><!> <span class="master-checkbox-label svelte-18b92yu">Select All Fields</span></div> <!> <!>',1),Hr=V("<!> <!>",1),kr=V("<!> <!>",1),Ar=V('<button class="close-button svelte-18b92yu" aria-label="Close"><!></button> <!>',1),Lr=V('<div class="card-container svelte-18b92yu" role="dialog" aria-modal="true" tabindex="-1"><!></div>');function xr(d,e){Y(e,!0);const t=Z(e,"fieldFilterMenuStore",7);let i=N(null),a=N(K(new Ie)),n=$(()=>{if(!r(i)||!r(i).fields)return{checked:!1,indeterminate:!1};const u=r(i).fields.length,v=r(a)?.size||0;return v===0?{checked:!1,indeterminate:!1}:v===u?{checked:!0,indeterminate:!1}:{checked:!1,indeterminate:!0}});ee(()=>{console.log("Active Layer to Filter:",t().ActiveLayer);const u=t().ActiveLayer;if(_(i,u,!0),u){const v=ie.DataSelections.get(u.id);v?.fields?_(a,new Ie([...v.fields]),!0):_(a,new Ie,!0)}});function s(){m(),t().ActiveLayer=null}function m(){if(!r(i))return;let u=ie.DataSelections.get(r(i).id);if(u){if((u.fields===void 0||u.fields===null)&&(u.fields=new Ie),r(a).size===0){ie.removeSelection(r(i).id);return}u.fields.clear(),r(a).forEach(v=>{u.fields?.add(v)})}}function c(u){r(i)&&(r(a).has(u)?r(a).delete(u):r(a).add(u))}function h(){if(!r(i)?.fields)return;(r(a)?.size||0)===0?r(i).fields.forEach(v=>{r(a).add(v.name)}):r(a).clear()}function g(){return r(i)?.fields?r(i).fields.filter(u=>!e.fieldsToHide?.has(u.alias?.toLowerCase()??"")):[]}var p=E(),o=I(p);{var y=u=>{var v=Lr();v.__click=[pr,s],v.__keydown=[br,s];var M=b(v);q(M,()=>Ke,(L,H)=>{H(L,{class:"command-card",children:(f,S)=>{var T=Ar(),k=I(T);k.__click=s;var j=b(k);oi(j,{size:20}),w(k);var F=A(k,2);q(F,()=>$e,(U,R)=>{R(U,{class:"card-content",children:(X,C)=>{var x=E(),D=I(x);q(D,()=>yi,(O,P)=>{P(O,{children:(W,B)=>{var ne=kr(),te=I(ne);q(te,()=>si,(he,fe)=>{fe(he,{placeholder:"Search for fields..."})});var _e=A(te,2);q(_e,()=>mi,(he,fe)=>{fe(he,{children:(we,Fe)=>{var Le=Hr(),xe=I(Le);q(xe,()=>wi,(Pe,ze)=>{ze(Pe,{children:(Ee,It)=>{ce();var Ve=me("No results found.");l(Ee,Ve)},$$slots:{default:!0}})});var Ct=A(xe,2);q(Ct,()=>li,(Pe,ze)=>{ze(Pe,{heading:"Fields",children:(Ee,It)=>{var Ve=Ir(),Oe=I(Ve),Ht=b(Oe);ot(Ht,{get checked(){return r(n).checked},get indeterminate(){return r(n).indeterminate},onCheckedChange:h}),ce(2),w(Oe);var et=A(Oe,2);q(et,()=>Qt,(Ge,oe)=>{oe(Ge,{})});var kt=A(et,2);ue(kt,17,g,He,(Ge,oe)=>{var tt=E(),At=I(tt);q(At,()=>pi,(Lt,xt)=>{xt(Lt,{class:"field-item",onselect:()=>c(r(oe).name),children:(Vt,Qr)=>{var Ue=Cr(),it=b(Ue);{let Se=$(()=>r(a)?.has(r(oe).name)??!1);ot(it,{class:"field-checkbox",get checked(){return r(Se)},onCheckedChange:()=>c(r(oe).name)})}var Re=A(it,2);Re.__click=[_r,c,oe];var rt=b(Re),je=b(rt),Nt=b(je,!0);w(je);var Tt=A(je,2);{var Mt=Se=>{var Ne=Sr(),Dt=b(Ne);be(Dt,()=>Yt),w(Ne),Q(()=>ye(Ne,"title",r(oe).description)),l(Se,Ne)};z(Tt,Se=>{r(oe).description&&Se(Mt)})}w(rt),w(Re),w(Ue),Q(()=>re(Nt,r(oe).alias||r(oe).name)),l(Vt,Ue)},$$slots:{default:!0}})}),l(Ge,tt)}),l(Ee,Ve)},$$slots:{default:!0}})}),l(we,Le)},$$slots:{default:!0}})}),l(W,ne)},$$slots:{default:!0}})}),l(X,x)},$$slots:{default:!0}})}),l(f,T)},$$slots:{default:!0}})}),w(v),l(u,v)};z(o,u=>{r(i)&&u(y)})}l(d,p),J()}Ae(["click","keydown"]);var Vr=V('<li class="download-item svelte-ynwhdm"><div class="download-info svelte-ynwhdm"><span class="download-url svelte-ynwhdm"> </span></div> <div class="download-actions svelte-ynwhdm"><div><!></div> <!> <!> <!></div></li>'),Nr=V('<ul class="selected-list svelte-ynwhdm"></ul> <p class="count svelte-ynwhdm"> </p>',1),Tr=V('<p class="no-selection svelte-ynwhdm">No downloads in queue</p>'),Mr=V('<div class="section svelte-ynwhdm"><h4 class="svelte-ynwhdm">Download Queue</h4> <!></div>');function Dr(d,e){Y(e,!0);let t=N(K(new Set));function i(o){const y=pe.downloads.findIndex(u=>u.url===o);y!==-1&&pe.downloads.splice(y,1)}async function a(o){try{await navigator.clipboard.writeText(o),_(t,new Set(r(t)).add(o),!0),le.success("URL copied to clipboard"),setTimeout(()=>{const y=new Set(r(t));y.delete(o),_(t,y,!0)},2e3)}catch(y){console.error("Failed to copy URL:",y),le.error("Failed to copy URL to clipboard")}}function n(o){switch(o){case"completed":return"#059669";case"in-progress":return"#2563eb";case"failed":return"#dc2626";case"pending":default:return"#6b7280"}}function s(o){switch(o){case"completed":return"Completed";case"in-progress":return"In Progress";case"failed":return"Failed";case"pending":default:return"Pending"}}function m(o){switch(o){case"completed":return ei;case"in-progress":return $t;case"failed":return Si;case"pending":default:return _i}}var c=Mr(),h=A(b(c),2);{var g=o=>{var y=Nr(),u=I(y);ue(u,21,()=>pe.downloads,He,(L,H)=>{var f=Vr(),S=b(f),T=b(S),k=b(T,!0);w(T),w(S);var j=A(S,2),F=b(j),U=b(F);{let D=$(()=>n(r(H).status));ve(U,{variant:"ghost",size:"sm",class:"download-status-btn",get style(){return`color: ${r(D)??""}`},disabled:!0,children:(O,P)=>{const W=$(()=>m(r(H).status));var B=E(),ne=I(B);{let te=$(()=>r(H).status==="in-progress"?"spinning":"");q(ne,()=>r(W),(_e,he)=>{he(_e,{size:14,get class(){return r(te)}})})}l(O,B)},$$slots:{default:!0}})}w(F);var R=A(F,2);ve(R,{variant:"ghost",size:"sm",class:"download-clipboard-btn",onclick:()=>a(r(H).url),title:"Copy URL to clipboard",children:(D,O)=>{var P=E(),W=I(P);{var B=te=>{Jt(te,{size:14})},ne=te=>{Kt(te,{size:14})};z(W,te=>{r(t).has(r(H).url)?te(B):te(ne,!1)})}l(D,P)},$$slots:{default:!0}});var X=A(R,2);{var C=D=>{ve(D,{variant:"ghost",size:"sm",class:"download-action-btn",onclick:()=>window.open(r(H).url,"_blank"),title:"Open download",children:(O,P)=>{ce();var W=me("ðŸ“¥");l(O,W)},$$slots:{default:!0}})};z(X,D=>{r(H).status==="completed"&&D(C)})}var x=A(X,2);ve(x,{variant:"ghost",size:"sm",class:"download-remove-btn",onclick:()=>i(r(H).url),title:"Remove from queue",children:(D,O)=>{ce();var P=me("Ã—");l(D,P)},$$slots:{default:!0}}),w(j),w(f),Q(D=>{ye(T,"title",r(H).url),re(k,r(H).id),ye(F,"title",D)},[()=>s(r(H).status)]),l(L,f)}),w(u);var v=A(u,2),M=b(v);w(v),Q(()=>re(M,`${pe.downloads.length??""} download(s) in queue`)),l(o,y)},p=o=>{var y=Tr();l(o,y)};z(h,o=>{pe.downloads.length>0?o(g):o(p,!1)})}w(c),l(d,c),J()}var Fr=V('<button><div class="flex w-full items-center justify-between gap-2"><div class="pointer-events-none flex min-w-0 flex-1 items-center gap-1"><!> <span class="inline-block size-4" aria-hidden="true"><!></span> <span class="block w-full text-left break-words"> </span></div> <!></div></button>');function dt(d,e){Y(e,!0);const t=Z(e,"isGroup",3,!1),i=Z(e,"isOpen",3,!1),a=`calc(100% - ${e.depth*1}rem)`;var n=Fr();n.__click=function(...v){e.onclick?.apply(this,v)};var s=b(n),m=b(s),c=b(m);{var h=v=>{ht(v,{get isOpen(){return i()}})};z(c,v=>{t()&&v(h)})}var g=A(c,2),p=b(g);be(p,()=>e.icon),w(g);var o=A(g,2),y=b(o,!0);w(o),w(m);var u=A(m,2);ae(u,()=>e.children??se),w(s),w(n),Q(v=>{ke(n,1,v),De(n,`width: ${a};`),re(y,e.name)},[()=>ai(Ei({enhancedHover:!0,includeFont:!0}))]),l(d,n),J()}Ae(["click"]);const Pr='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-down-to-line-icon lucide-arrow-down-to-line"><path d="M12 17V3"/><path d="m6 11 6 6 6-6"/><path d="M19 21H5"/></svg>';function zr(d,e,t){d.stopPropagation(),_(e,!r(e)),t.onDownloadStateChanged?.(t.node,r(e))}var Er=V("<button><!></button>");function Or(d,e){Y(e,!0);let t=N(K(e.getDownloadState?.(e.node)??!1));ee(()=>{if(e.getDownloadState){const s=e.getDownloadState(e.node);_(t,s??!1,!0)}});var i=Er();let a;i.__click=[zr,t,e];var n=b(i);be(n,()=>Pr),w(i),Q(s=>{a=ke(i,1,"download-btn svelte-1gynj9v",null,a,s),ye(i,"title",`Download ${e.node.name??""}`),ye(i,"aria-label",`Download ${e.node.name??""}`),ye(i,"aria-pressed",r(t))},[()=>({active:r(t)})]),l(d,i),J()}Ae(["click"]);var Gr=V('<div class="flex items-center gap-2"><!></div>'),Ur=V("<div><!></div>"),Rr=V("<!> <!>",1),jr=V('<div class="flex items-center gap-2"><!> <!></div>');function St(d,e){Y(e,!0);const t=L=>{var H=E(),f=I(H);{var S=T=>{var k=E(),j=I(k);{var F=R=>{dt(R,{get icon(){return r(p)},get name(){return e.node.name},get depth(){return n()},onclick:M,isGroup:!0,get isOpen(){return r(h)},children:C=>{var x=Gr(),D=b(x);{var O=P=>{st(P,{get checked(){return r(g)},onCheckedChange:u})};z(D,P=>{c&&P(O)})}w(x),l(C,x)},$$slots:{default:!0}})},U=R=>{dt(R,{get icon(){return r(p)},get name(){return e.node.name},get depth(){return n()},onclick:v,isGroup:!1,children:C=>{var x=jr(),D=b(x);{var O=B=>{var ne=Rr(),te=I(ne);{var _e=fe=>{var we=Ur();let Fe;var Le=b(we);_t(Le,{get layerId(){return e.node.id},get onFilterClicked(){return e.onFilterClicked},get hasFiltersApplied(){return e.hasFiltersApplied}}),w(we),Q(xe=>Fe=ke(we,1,"filter-transition-wrapper svelte-42m3ms",null,Fe,xe),[()=>({"fade-in":!r(y),"fade-out":r(y)})]),l(fe,we)};z(te,fe=>{r(o)&&fe(_e)})}var he=A(te,2);Or(he,{get node(){return e.node},get onDownloadStateChanged(){return e.onDownloadStateChanged},get getDownloadState(){return e.getDownloadState}}),l(B,ne)};z(D,B=>{e.isDownloadable&&B(O)})}var P=A(D,2);{var W=B=>{st(B,{get checked(){return r(g)},onCheckedChange:u})};z(P,B=>{c&&B(W)})}w(x),l(C,x)},$$slots:{default:!0}})};z(j,R=>{m?R(F):R(U,!1)})}l(T,k)};z(f,T=>{a()?.getItemConfig(e.node.id)?.isHidden||T(S)})}l(L,H)},i=(L,H=se)=>{var f=E(),S=I(f);{var T=k=>{{let j=$(()=>a()?.getItemConfig(H().id)?.isDownloadable??!0),F=$(()=>n()+1);St(k,{get node(){return H()},get isDownloadable(){return r(j)},get onNodeClick(){return e.onNodeClick},get onNodeVisibilityChange(){return e.onNodeVisibilityChange},get onDownloadStateChanged(){return e.onDownloadStateChanged},get getDownloadState(){return e.getDownloadState},get onFilterClicked(){return e.onFilterClicked},get hasFiltersApplied(){return e.hasFiltersApplied},get getNodeVisibility(){return e.getNodeVisibility},get depth(){return r(F)},get useLayerTypeIcon(){return s()}})}};z(S,k=>{m&&r(h)&&!a()?.getItemConfig(H().id)?.isHidden&&k(T)})}l(L,f)},a=Z(e,"treeviewConfigStore",3,null),n=Z(e,"depth",3,0),s=Z(e,"useLayerTypeIcon",3,!1),m=!!(e.node.children&&e.node.children.length),c=!!e.node.layer&&"visible"in e.node.layer&&!m;let h=N(!1),g=N(!1),p=N(""),o=N(!1),y=N(!1);ee(()=>{if(!e.node)return;const L=e.getNodeVisibility?e.getNodeVisibility(e.node.id):void 0;_(g,L!==void 0?L:e.node.layer.visible,!0),_(p,wt(e.node.layer,s(),m,r(h)),!0)}),ee(()=>{const L=(e.getDownloadState?.(e.node)&&e.node.layer.type==="feature")??!1;L&&!r(o)?(_(o,!0),_(y,!1)):!L&&r(o)&&(_(y,!0),setTimeout(()=>{_(o,!1),_(y,!1)},180))});function u(){!c||!e.onNodeVisibilityChange||(_(g,!r(g)),e.onNodeVisibilityChange(e.node,r(g)))}function v(){e.onNodeClick?.(e.node)}function M(){_(h,!r(h)),e.onNodeClick?.(e.node)}{let L=$(()=>m?e.node.children:null);vt(d,{get isOpen(){return r(h)},get content(){return t},get childNodes(){return r(L)},get childNode(){return i}})}J()}function Br(d,e){Y(e,!0);const t=Z(e,"webMap",3,null),i=Z(e,"fieldFilterMenuStore",7),a=new bt;ee(()=>{if(!t()||a.initialized)return;(async()=>{a.initialize(t().layers.toArray(),e.treeviewConfigStore),console.log("TreeView initialized with layers:",a.getNodes())})()});function n(o,y){if(y){const u={layerId:o.id,name:o.layer.title||"",fields:new Ie(o.layer.fields?.map(v=>v.name)||[])};ie.addSelection(u)}else ie.removeSelection(o.id)}function s(o){return ie.DataSelections.has(o.id)}function m(o){if(i().ActiveLayer?.uid===o)i().ActiveLayer=null;else{const u=a.getNodeById(o)?.layer;i().ActiveLayer=u}}function c(o){const y=ie.DataSelections.get(o);if(!y?.fields)return!1;const u=a.getNodeById(o);if(!u)return!1;const v=u.layer.fields?.length||0,M=y.fields.size;return M>0&&M!==v}var h=E(),g=I(h);{var p=o=>{var y=E(),u=I(y);q(u,()=>ft,(v,M)=>{M(v,{children:(L,H)=>{var f=E(),S=I(f);ue(S,17,()=>a.getNodes(),T=>T.id,(T,k)=>{{let j=$(()=>e.treeviewConfigStore.getItemConfig(r(k).id)?.isDownloadable??!1);St(T,{get treeviewConfigStore(){return e.treeviewConfigStore},get node(){return r(k)},get isDownloadable(){return r(j)},onNodeClick:()=>{},onNodeVisibilityChange:(F,U)=>a.setVisibilityState(F.id,U),getNodeVisibility:F=>a.getVisibilityState(F),onDownloadStateChanged:n,getDownloadState:s,onFilterClicked:m,hasFiltersApplied:c,depth:0,useLayerTypeIcon:!0})}}),l(L,f)},$$slots:{default:!0}})}),l(o,y)};z(g,o=>{a.initialized&&o(p)})}l(d,h),J()}class ct{#e=[];#t=new Map;#a=[];#i=new Map;#r=[];#o=new Map;#d=new Set;constructor(e){if(!e)throw new Error("TreeviewConfigStore requires a valid configuration object.");this.#e=e.items??[],this.#t=new Map(this.#e.map(t=>[t.id,t])),this.#a=e.visibilityGroups??[],this.#i=new Map(this.#a.map(t=>[t.id,t])),this.#r=e.inheritanceGroups??[],this.#o=new Map(this.#r.map(t=>[t.id,t])),e.fieldsToHide&&(this.#d=new Set(e.fieldsToHide.map(t=>t.trim().toLowerCase())))}getItemConfig(e){return this.#t.get(e)}getVisibilityGroupConfig(e){return this.#i.get(e)}getInheritanceGroupConfig(e){return this.#o.get(e)}resolveInheritance(e){if(!(e.length===0||!this.#e||this.#e.length===0))for(const t of e)this.#s(t)}#s(e,t){const i=this.#c(e,t);if(this.#y(e)&&i.showFields){const a=e;a.loaded||console.warn(`Layer not loaded: ${e.id}`);for(const n of a.fields??[])this.#v(this.#f(e.id,n.name),n.alias||n.name,i)}if(this.#g(e)){const a=e;for(const n of a.layers.toArray())this.#s(n,i)}}#c(e,t){const i=this.#u(e.id,t);return i.type===Ce.None&&(i.type=ti(e)),i}#v(e,t,i){const a=this.#u(e,i);return a.type===Ce.None&&(a.type=Ce.Field),this.#d.has(t.trim().toLowerCase())&&(a.isHidden=!0),a}#u(e,t){let i=this.getItemConfig(e);const a=i!==void 0,n=i?.inheritanceGroupId?this.getInheritanceGroupConfig(i.inheritanceGroupId):this.getInheritanceGroupConfig(t?.inheritanceGroupId??"");return i={id:e,type:Ce.None,isDownloadable:this.#n(n,"isDownloadable",i,t,!0),isVisibleOnInit:this.#n(n,"isVisibleOnInit",i,t,!1),isHidden:this.#n(n,"isHidden",i,t,!1),showFields:this.#n(n,"showFields",i,t,!1),visibilityDependencyIds:this.#n(n,"visibilityDependencyIds",i,t,[]),visibilityGroupId:this.#n(n,"visibilityGroupId",i,t,void 0),inheritanceGroupId:this.#n(n,"inheritanceGroupId",i,t,void 0)},a===!1&&this.#h(i),i}#n(e,t,i,a,n){const s=i?.[t];return s!==void 0?s:e?.inheritedProperties.includes(t)&&a?a[t]??n:n}#h(e){if(this.#t.has(e.id))throw new Error(`Item with id ${e.id} already exists.`);this.#e.push(e),this.#t.set(e.id,e)}#f(e,t){return`${e}-${t}`}#g(e){return e.type==="group"}#y(e){return e.type==="feature"}}const Wr=[{value:"define-areas",label:"Define Areas"},{value:"select-data",label:"Select Data"},{value:"export",label:"Export"},{value:"downloads",label:"Download"}];var qr=V("<!> <!> <!> <!>",1),Xr=V('<div class="flex w-120 min-w-0 flex-col gap-6"><!></div>'),Zr=V('<!> <!> <!> <!> <div class="map-section svelte-zapjb6"><!></div>',1);function Sa(d,e){Y(e,!0);const t=f=>{var S=Xr(),T=b(S);Xi(T,{get value(){return r(s)},get triggers(){return Wr},onValueChange:g,children:(k,j)=>{var F=qr(),U=I(F);Me(U,{value:"define-areas",children:(x,D)=>{var O=E(),P=I(O);{var W=B=>{ji(B,{get webMap(){return i.data},get treeviewStore(){return n},get treeviewConfigStore(){return r(h)}})};z(P,B=>{i.isLoaded&&B(W)})}l(x,O)}});var R=A(U,2);Me(R,{value:"select-data",children:(x,D)=>{var O=E(),P=I(O);{var W=B=>{Br(B,{get webMap(){return i.data},get treeviewConfigStore(){return r(c)},get fieldFilterMenuStore(){return a}})};z(P,B=>{i.isLoaded&&B(W)})}l(x,O)}});var X=A(R,2);Me(X,{value:"export",footer:D=>{gr(D,{onExportSuccess:p})},children:(D,O)=>{hr(D,{get webMapStore(){return i},get areaSelectionTreeviewStore(){return n},get fieldFilterMenuStore(){return a}})}});var C=A(X,2);Me(C,{value:"downloads",children:(x,D)=>{Dr(x,{})}}),l(k,F)},$$slots:{default:!0}}),w(S),l(f,S)},i=K(new Yi),a=K(new ar),n=K(new bt);let s=N("define-areas"),m=N(K(new Set)),c=N(void 0),h=N(void 0);Pt(async()=>{const f=await di();_(m,new Set(f.serviceUprnConfig.fieldsToHide||[]),!0),G.setNameFields(f.serviceUprnConfig.selectionLayersNameFields||[]),_(c,new ct(f.serviceUprnConfig.dataSelectionTreeviewConfig),!0),_(h,new ct(f.serviceUprnConfig.areaSelectionTreeviewConfig),!0),await i.initializeAsync({portalUrl:f.serviceUprnConfig.portalUrl,itemId:f.serviceUprnConfig.portalItemId||"",proxy:f.serviceUprnConfig.proxy}),console.log("[page] WebMap loaded")});function g(f){_(s,f,!0)}function p(){_(s,"downloads")}var o=Zr(),y=I(o);ii(y,{});var u=A(y,2);wr(u,{});var v=A(u,2);xr(v,{get fieldFilterMenuStore(){return a},get fieldsToHide(){return r(m)}});var M=A(v,2);Bi(M,{});var L=A(M,2),H=b(L);Mi(H,{get webMap(){return i.data},get areaSelectionTreeviewStore(){return n},panelPosition:"top-left",menuPosition:"top-right",get panel(){return t}}),w(L),l(d,o),J()}export{Sa as component};
