const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/gV446Zal.js","../chunks/CKPuaBYR.js","../chunks/w-2V2ENZ.js","../chunks/DGjcIG0n.js","../chunks/B-Uk06ux.js","../chunks/PPVm8Dsz.js","../chunks/Dc40Hn7j.js","../chunks/BBGELVfD.js","../chunks/C6_pfFWS.js","../chunks/DE3--tLW.js","../chunks/Dm941dBC.js","../chunks/D8t6YHTB.js","../chunks/BWPniy7t.js","../chunks/CBeJHy14.js","../chunks/tWP1hlXH.js","../chunks/DckaW9b_.js","../chunks/NLpBZxRj.js","../chunks/Owin8cjQ.js","../chunks/D0RvfEuG.js","../chunks/CVJoTV8m.js","../chunks/DnQgC4Ha.js","../chunks/D6wORzA5.js","../chunks/D6KPPgz5.js","../chunks/BNZPdy3K.js","../chunks/D_y-sfSV.js","../chunks/IxEuKwon.js","../chunks/Cl5lrJ4c.js","../chunks/DA7SASLe.js","../chunks/MtSiOt06.js","../chunks/C0wm8_Yw.js","../chunks/cmtqNiVW.js","../chunks/CKmAvxJl.js","../chunks/BT7E4tWz.js","../chunks/C6ccPtdP.js","../chunks/Djp3mnm5.js","../chunks/B1bBpLS1.js","../chunks/DQOJ18NT.js","../chunks/Cb3Aswsi.js","../chunks/Cg6qoSAP.js","../chunks/Cu_5K5Zz.js","../chunks/DWJ_RHQc.js","../chunks/0eYbUadG.js","../chunks/EzLf78vY.js","../chunks/DXOBWh9J.js","../chunks/DQ_YjUJb.js","../chunks/mri5zWU4.js","../chunks/CtKa3THk.js","../chunks/DDtlEfCS.js","../chunks/DvC2ngdU.js","../chunks/DZd6gJy7.js","../chunks/DDYyo22O.js","../chunks/C8BmVxiO.js","../chunks/BP0-ZyuP.js","../chunks/CMBSuDh0.js","../chunks/BBU8X8Ah.js","../chunks/BnFCzMm9.js","../chunks/C-XOaeAn.js","../chunks/BF70gY8q.js","../chunks/9YvG7tFv.js","../chunks/DE49FngL.js","../chunks/DZzaLosK.js","../chunks/aQeO9QTD.js","../chunks/DAFEYYNK.js","../chunks/D-JjE83C.js","../chunks/BXte5Lg3.js","../chunks/CuBDo_-F.js","../chunks/B8s7ldIr.js","../chunks/BDvScnYe.js","../chunks/DdIyMqx_.js","../chunks/Bo7PZbSN.js","../chunks/B5hrGkZw.js","../chunks/BGsbaJnX.js","../chunks/Chk7YAAL.js","../chunks/C4eyRFHZ.js","../chunks/Cgb6qxNH.js","../chunks/B4fr8LAe.js","../chunks/CHt7Mn0H.js","../chunks/QQC62dOK.js","../chunks/U5XdjVHm.js","../chunks/DjD5Mp7q.js","../chunks/DSQdj5sy.js","../chunks/DbXUmHv4.js","../chunks/DKpmsPfl.js","../chunks/CaVKkSa6.js","../chunks/C1d91D9B.js","../chunks/DysKX3BL.js","../chunks/B1N-tmtC.js","../chunks/CASyCajO.js","../chunks/BiphejqT.js","../chunks/BeeG8NQi.js","../chunks/pDuGEAnG.js","../chunks/DmenWAEG.js","../chunks/BrScpkSj.js","../chunks/rxpTDz6e.js","../chunks/CcA5n_nD.js","../chunks/DcTGm81B.js","../chunks/CECaDSnI.js","../chunks/CL2NbQte.js","../chunks/Co8ML-Xw.js","../chunks/BaGr8PU4.js","../chunks/BBJKedcW.js","../chunks/CoQoT6iH.js","../chunks/C5CzMsLd.js","../chunks/DGvp5qLz.js","../chunks/ByirBkQo.js","../chunks/CGtfJUQA.js","../chunks/BYPeQQUq.js","../chunks/CqaGcLtW.js","../chunks/BXe4iLRC.js","../chunks/D5LfT7W_.js","../chunks/B2C-dbaZ.js","../chunks/ClnEmzgi.js","../chunks/CJG_RRAU.js","../chunks/nSKUNa7p.js","../chunks/BS_oygkd.js","../chunks/B241IRyR.js","../chunks/GKolV7NZ.js","../chunks/VuFqJijV.js","../chunks/BEnS4Tus.js","../chunks/L5VTCVZK.js","../chunks/CSoP8JbI.js","../chunks/D9B-nNzP.js","../chunks/bak0aO70.js","../chunks/m_57cSl2.js","../chunks/BiKjlG2z.js","../chunks/CTXkrprB.js","../chunks/VMSlSy0z.js","../chunks/cUDmHyc2.js","../chunks/Gnu6FYLL.js","../chunks/BljbOEVe.js","../chunks/C2SSoHeS.js","../chunks/C8Hr9Tbr.js","../chunks/kpqSibOI.js","../chunks/DQabrfMa.js","../chunks/BWCLhfKQ.js","../chunks/CXlOSIUB.js","../chunks/-EtKvpTw.js","../chunks/C0T08xGg.js","../chunks/DoUDv7wn.js","../chunks/BC2JYgbL.js","../chunks/BCeIRRRi.js","../chunks/Dpvne76_.js","../chunks/DNH91us3.js","../chunks/ClTGcEgI.js","../chunks/DypQGKEF.js","../chunks/Xqjo61yv.js","../chunks/Dl0rLF8m.js","../chunks/keDlZJLG.js","../chunks/KcazVFlU.js","../chunks/CYsUaMUi.js","../chunks/Cc2mYLc9.js","../chunks/Chix3Wl1.js","../chunks/D35hgLZq.js","../chunks/BDQ7lyec.js","../chunks/C99ggfNu.js","../chunks/D55AmI9p.js","../chunks/BgtvC5K-.js","../chunks/BqMYqny5.js","../chunks/DCdj6Lab.js","../chunks/BXfupK_G.js","../chunks/BkQcsSCB.js","../chunks/DPb6J-GU.js","../chunks/-ytxYhhT.js","../chunks/24-izIl7.js","../chunks/DD-IjuHV.js","../chunks/D9-fAzDj.js","../chunks/B_ZG5ntY.js","../chunks/Caie0p3g.js","../chunks/DtPXKitF.js","../chunks/cHvQTL2Z.js","../chunks/ovw6hubi.js","../chunks/CxOUhYPm.js","../chunks/Bq0sqGmk.js","../chunks/DzZ7E5_o.js","../chunks/CZIedxnU.js","../chunks/DwgYsua4.js","../chunks/BXt_i_Zn.js","../chunks/NRTVJfGF.js","../chunks/DsHDw-MJ.js"])))=>i.map(i=>d[i]);
import{p as no,c as Ce,a as R,f as ye,t as $n}from"../chunks/Cp6gagLc.js";import{o as Wn,a as qa}from"../chunks/BEugbry3.js";import{C as io,E as ao,b8 as oo,b9 as so,L as lo,t as uo,ba as co,bb as fo,bc as ho,Z as Fa,am as vo,N as po,a as Et,ay as Le,x as f,ab as te,p as dt,f as le,b as ft,c as re,r as J,aw as we,ag as Ct,u as Dt,B as Tt,a4 as Ee,n as kn}from"../chunks/CGuDK3cH.js";import{p as nt,i as qe,r as vr,l as wi,s as ur}from"../chunks/CYzw9kj_.js";import{c as at}from"../chunks/BQask9zx.js";import{b as mo,s as Qt}from"../chunks/CGgxIKi_.js";import{a as Wi,e as Gn,s as Vi,d as nn,b as go}from"../chunks/C52hcmTJ.js";import{I as _i,n as Si,d as Gi,c as va,S as Ra,s as yo,X as bo,e as wo,f as _o,g as So,h as xo,i as ko,j as Co,C as Io,k as Eo}from"../chunks/DU_kuKi7.js";import{C as Ao,D as Oo,l as Po,o as To,z as Mo,b as Fi,B as No,p as jr,$ as Lo,a0 as ja,c as Do,a1 as qo}from"../chunks/BrP-zdqQ.js";import{t as Cn,k as Fo,l as Ro,m as jo,n as Ho,L as zo,o as Bo,h as Ko,i as Vo,S as Vn,C as ya,j as Uo,I as $o,G as ba,F as wa,b as Wo,O as Ha,a as Go,d as za,c as Ri,p as Qo,r as Yo,M as Xo,V as _a,f as Jo,e as Zo,g as es,s as ts,q as rs}from"../chunks/TfsO81hG.js";import{s as xt,I as Xn,a as Hr,i as Qn}from"../chunks/Cl7Mgxd0.js";import{g as ns,d as Qi}from"../chunks/CU0SCnmu.js";import{b as Pr}from"../chunks/CGMUYGDS.js";import{c as Yi,B as hr}from"../chunks/CGsbJcZG.js";import{I as is,C as as}from"../chunks/gKNna5fd.js";import"../chunks/BxA9u5OI.js";import"../chunks/Gdu1143p.js";import"../chunks/fuL_5N5w.js";import Ba from"../chunks/CoQoT6iH.js";import{j as os}from"../chunks/CcA5n_nD.js";import ss from"../chunks/NLpBZxRj.js";import{s as Sa}from"../chunks/w-2V2ENZ.js";import{O as ls}from"../chunks/BBGELVfD.js";import{h as bi}from"../chunks/yDTRCkMh.js";import{_ as Un}from"../chunks/PPVm8Dsz.js";import{C as us}from"../chunks/C7OPQEgL.js";function cs(A,n){for(var u=0;u<n.length;u++){const c=n[u];if(typeof c!="string"&&!Array.isArray(c)){for(const p in c)if(p!=="default"&&!(p in A)){const g=Object.getOwnPropertyDescriptor(c,p);g&&Object.defineProperty(A,p,g.get?g:{enumerable:!0,get:()=>c[p]})}}}return Object.freeze(Object.defineProperty(A,Symbol.toStringTag,{value:"Module"}))}const ds=()=>performance.now(),$r={tick:A=>requestAnimationFrame(A),now:()=>ds(),tasks:new Set};function Ka(){const A=$r.now();$r.tasks.forEach(n=>{n.c(A)||($r.tasks.delete(n),n.f())}),$r.tasks.size!==0&&$r.tick(Ka)}function fs(A){let n;return $r.tasks.size===0&&$r.tick(Ka),{promise:new Promise(u=>{$r.tasks.add(n={c:A,f:u})}),abort(){$r.tasks.delete(n)}}}function ji(A,n){Fa(()=>{A.dispatchEvent(new CustomEvent(n))})}function hs(A){if(A==="float")return"cssFloat";if(A==="offset")return"cssOffset";if(A.startsWith("--"))return A;const n=A.split("-");return n.length===1?n[0]:n[0]+n.slice(1).map(u=>u[0].toUpperCase()+u.slice(1)).join("")}function xa(A){const n={},u=A.split(";");for(const c of u){const[p,g]=c.split(":");if(!p||g===void 0)break;const b=hs(p.trim());n[b]=g.trim()}return n}const vs=A=>A;function Ui(A,n,u,c){var p=(A&fo)!==0,g=(A&ho)!==0,b=p&&g,C=(A&co)!==0,F=b?"both":p?"in":"out",v,N=n.inert,H=n.style.overflow,V,Q;function z(){return Fa(()=>v??=u()(n,c?.()??{},{direction:F}))}var j={is_global:C,in(){if(n.inert=N,!p){Q?.abort(),Q?.reset?.();return}g||V?.abort(),ji(n,"introstart"),V=la(n,z(),Q,1,()=>{ji(n,"introend"),V?.abort(),V=v=void 0,n.style.overflow=H})},out(X){if(!g){X?.(),v=void 0;return}n.inert=!0,ji(n,"outrostart"),Q=la(n,z(),V,0,()=>{ji(n,"outroend"),X?.()})},stop:()=>{V?.abort(),Q?.abort()}},U=io;if((U.transitions??=[]).push(j),p&&mo){var Z=C;if(!Z){for(var ie=U.parent;ie&&(ie.f&ao)!==0;)for(;(ie=ie.parent)&&(ie.f&oo)===0;);Z=!ie||(ie.f&so)!==0}Z&&lo(()=>{uo(()=>j.in())})}}function la(A,n,u,c,p){var g=c===1;if(vo(n)){var b,C=!1;return po(()=>{if(!C){var U=n({direction:g?"in":"out"});b=la(A,U,u,c,p)}}),{abort:()=>{C=!0,b?.abort()},deactivate:()=>b.deactivate(),reset:()=>b.reset(),t:()=>b.t()}}if(u?.deactivate(),!n?.duration)return p(),{abort:Et,deactivate:Et,reset:Et,t:()=>c};const{delay:F=0,css:v,tick:N,easing:H=vs}=n;var V=[];if(g&&u===void 0&&(N&&N(0,1),v)){var Q=xa(v(0,1));V.push(Q,Q)}var z=()=>1-c,j=A.animate(V,{duration:F,fill:"forwards"});return j.onfinish=()=>{j.cancel();var U=u?.t()??1-c;u?.abort();var Z=c-U,ie=n.duration*Math.abs(Z),X=[];if(ie>0){var ae=!1;if(v)for(var Ae=Math.ceil(ie/16.666666666666668),de=0;de<=Ae;de+=1){var be=U+Z*H(de/Ae),Pe=xa(v(be,1-be));X.push(Pe),ae||=Pe.overflow==="hidden"}ae&&(A.style.overflow="hidden"),z=()=>{var Ke=j.currentTime;return U+Z*H(Ke/ie)},N&&fs(()=>{if(j.playState!=="running")return!1;var Ke=z();return N(Ke,1-Ke),!0})}j=A.animate(X,{duration:ie,fill:"forwards"}),j.onfinish=()=>{z=()=>c,N?.(c,1-c),p()}},{abort:()=>{j&&(j.cancel(),j.effect=null,j.onfinish=Et)},deactivate:()=>{p=Et},reset:()=>{c===0&&N?.(1,0)},t:()=>z()}}const ps=To({component:"avatar",parts:["root","image","fallback"]}),ms=new Ao("Avatar.Root");class pa{static create(n){return ms.set(new pa(n))}opts;domContext;attachment;constructor(n){this.opts=n,this.domContext=new Oo(this.opts.ref),this.loadImage=this.loadImage.bind(this),this.attachment=Po(this.opts.ref)}loadImage(n,u,c){if(this.opts.loadingStatus.current==="loaded")return;let p;const g=new Image;return g.src=n,u!==void 0&&(g.crossOrigin=u),c&&(g.referrerPolicy=c),this.opts.loadingStatus.current="loading",g.onload=()=>{p=this.domContext.setTimeout(()=>{this.opts.loadingStatus.current="loaded"},this.opts.delayMs.current)},g.onerror=()=>{this.opts.loadingStatus.current="error"},()=>{p&&this.domContext.clearTimeout(p)}}#e=Le(()=>({id:this.opts.id.current,[ps.root]:"","data-status":this.opts.loadingStatus.current,...this.attachment}));get props(){return f(this.#e)}set props(n){te(this.#e,n)}}var gs=ye("<div><!></div>");function ys(A,n){const u=no();dt(n,!0);let c=nt(n,"delayMs",3,0),p=nt(n,"loadingStatus",15,"loading"),g=nt(n,"id",19,()=>Mo(u)),b=nt(n,"ref",15,null),C=vr(n,["$$slots","$$events","$$legacy","delayMs","loadingStatus","onLoadingStatusChange","child","children","id","ref"]);const F=pa.create({delayMs:Fi(()=>c()),loadingStatus:Fi(()=>p(),z=>{p()!==z&&(p(z),n.onLoadingStatusChange?.(z))}),id:Fi(()=>g()),ref:Fi(()=>b(),z=>b(z))}),v=Le(()=>No(C,F.props));var N=Ce(),H=le(N);{var V=z=>{var j=Ce(),U=le(j);xt(U,()=>n.child,()=>({props:f(v)})),R(z,j)},Q=z=>{var j=gs();Wi(j,()=>({...f(v)}));var U=re(j);xt(U,()=>n.children??Et),J(j),R(z,j)};qe(H,z=>{n.child?z(V):z(Q,!1)})}R(A,N),ft()}function bs(A,n){const u=wi(n,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const c=[["path",{d:"m6 9 6 6 6-6"}]];_i(A,ur({name:"chevron-down"},()=>u,{get iconNode(){return c},children:(p,g)=>{var b=Ce(),C=le(b);Si(C,n,"default",{}),R(p,b)},$$slots:{default:!0}}))}function ws(A,n){const u=wi(n,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const c=[["path",{d:"m15 18-6-6 6-6"}]];_i(A,ur({name:"chevron-left"},()=>u,{get iconNode(){return c},children:(p,g)=>{var b=Ce(),C=le(b);Si(C,n,"default",{}),R(p,b)},$$slots:{default:!0}}))}function _s(A,n){const u=wi(n,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const c=[["path",{d:"m18 15-6-6-6 6"}]];_i(A,ur({name:"chevron-up"},()=>u,{get iconNode(){return c},children:(p,g)=>{var b=Ce(),C=le(b);Si(C,n,"default",{}),R(p,b)},$$slots:{default:!0}}))}function Ss(A,n){const u=wi(n,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const c=[["path",{d:"M12 15V3"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}],["path",{d:"m7 10 5 5 5-5"}]];_i(A,ur({name:"download"},()=>u,{get iconNode(){return c},children:(p,g)=>{var b=Ce(),C=le(b);Si(C,n,"default",{}),R(p,b)},$$slots:{default:!0}}))}function xs(A,n){const u=wi(n,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const c=[["path",{d:"M4 5h16"}],["path",{d:"M4 12h16"}],["path",{d:"M4 19h16"}]];_i(A,ur({name:"menu"},()=>u,{get iconNode(){return c},children:(p,g)=>{var b=Ce(),C=le(b);Si(C,n,"default",{}),R(p,b)},$$slots:{default:!0}}))}function ks(A,n){dt(n,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let u=vr(n,["$$slots","$$events","$$legacy"]);const c=[["path",{d:"M12 17V3"}],["path",{d:"m6 11 6 6 6-6"}],["path",{d:"M19 21H5"}]];Xn(A,ur({name:"arrow-down-to-line"},()=>u,{get iconNode(){return c},children:(p,g)=>{var b=Ce(),C=le(b);xt(C,()=>n.children??Et),R(p,b)},$$slots:{default:!0}})),ft()}function Cs(A,n){dt(n,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let u=vr(n,["$$slots","$$events","$$legacy"]);const c=[["path",{d:"M12 5v14"}],["path",{d:"m19 12-7 7-7-7"}]];Xn(A,ur({name:"arrow-down"},()=>u,{get iconNode(){return c},children:(p,g)=>{var b=Ce(),C=le(b);xt(C,()=>n.children??Et),R(p,b)},$$slots:{default:!0}})),ft()}function Is(A,n){dt(n,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let u=vr(n,["$$slots","$$events","$$legacy"]);const c=[["path",{d:"m18 15-6-6-6 6"}]];Xn(A,ur({name:"chevron-up"},()=>u,{get iconNode(){return c},children:(p,g)=>{var b=Ce(),C=le(b);xt(C,()=>n.children??Et),R(p,b)},$$slots:{default:!0}})),ft()}function Es(A,n){dt(n,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let u=vr(n,["$$slots","$$events","$$legacy"]);const c=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3"}]];Xn(A,ur({name:"maximize"},()=>u,{get iconNode(){return c},children:(p,g)=>{var b=Ce(),C=le(b);xt(C,()=>n.children??Et),R(p,b)},$$slots:{default:!0}})),ft()}function As(A,n){dt(n,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let u=vr(n,["$$slots","$$events","$$legacy"]);const c=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3"}]];Xn(A,ur({name:"minimize"},()=>u,{get iconNode(){return c},children:(p,g)=>{var b=Ce(),C=le(b);xt(C,()=>n.children??Et),R(p,b)},$$slots:{default:!0}})),ft()}function Os(A,n){dt(n,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let u=vr(n,["$$slots","$$events","$$legacy"]);const c=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"}],["path",{d:"m21.854 2.147-10.94 10.939"}]];Xn(A,ur({name:"send"},()=>u,{get iconNode(){return c},children:(p,g)=>{var b=Ce(),C=le(b);xt(C,()=>n.children??Et),R(p,b)},$$slots:{default:!0}})),ft()}class Ps{#e=we(Ct({featureLayerView:null,areaInfos:[]}));get layerHighlightState(){return f(this.#e)}set layerHighlightState(n){te(this.#e,n,!0)}#t=we(null);get lastAddedArea(){return f(this.#t)}set lastAddedArea(n){te(this.#t,n,!0)}#r=we(null);get lastRemovedArea(){return f(this.#r)}set lastRemovedArea(n){te(this.#r,n,!0)}#i=we(null);get currentHoveredArea(){return f(this.#i)}set currentHoveredArea(n){te(this.#i,n,!0)}#n=[];#o=new jr;setFieldInfo(n){console.log("Setting field info:",n),this.#n=n}setSelectedLayerView(n){this.layerHighlightState?.featureLayerView!==n&&(this.layerHighlightState&&this.layerHighlightState.areaInfos.forEach(u=>{u.handle.remove()}),this.layerHighlightState={featureLayerView:n,areaInfos:[]})}clearSelectedLayerView(){this.layerHighlightState.featureLayerView!==null&&(this.resetSelectedAreas(),this.layerHighlightState.featureLayerView=null)}resetSelectedAreas(){!this.layerHighlightState.featureLayerView&&this.layerHighlightState.areaInfos.length===0||(this.layerHighlightState&&this.layerHighlightState.areaInfos.forEach(n=>{n.handle.remove()}),this.layerHighlightState={featureLayerView:null,areaInfos:[]})}addSelectedArea(n,u){if(!this.layerHighlightState){console.warn("SelectedAreasStore: No feature layer view is set.");return}const c={id:n,handle:u};this.layerHighlightState.areaInfos.push(c),this.lastAddedArea=c}removeSelectedArea(n){if(!this.layerHighlightState){console.warn("SelectedAreasStore: No feature layer view is set.");return}const u=this.layerHighlightState.areaInfos.findIndex(c=>c.id===n);u!==-1&&(this.lastRemovedArea={id:n,handle:this.layerHighlightState.areaInfos[u].handle},this.layerHighlightState.areaInfos[u].handle.remove(),this.layerHighlightState.areaInfos.splice(u,1))}async getAreaNamesById(n){if(!this.layerHighlightState?.featureLayerView)return[];const u=this.getNameFieldForCurrentLayer();if(!u)return[];const c=this.layerHighlightState.featureLayerView.layer;let p=this.#o.get(c.uid);p||(p=new jr,this.#o.set(c.uid,p));const g=new Array(n.length),b=new jr,C=[];if(n.forEach((N,H)=>{b.set(N,H);const V=p.get(N);V!==void 0?g[H]=V:C.push(N)}),C.length===0)return g.map(N=>N??"");const F=c.objectIdField,v=await c.queryFeatures({objectIds:C,outFields:[u,F],returnGeometry:!1});for(const N of v.features){const H=N.attributes[F],V=N.attributes[u],Q=b.get(H);Q!==void 0&&(g[Q]=V??"",p.set(H,V??""))}return g.map(N=>N??"")}async getAreaCodesById(n){if(!this.layerHighlightState?.featureLayerView)return[];const u=this.getCodeFieldForCurrentLayer();if(!u)return[];const c=this.layerHighlightState.featureLayerView.layer,p=c.objectIdField,g=await c.queryFeatures({objectIds:n,outFields:[u,p],returnGeometry:!1}),b=new Array(n.length);for(const C of g.features){const F=C.attributes[p],v=C.attributes[u],N=n.indexOf(F);N!==-1&&(b[N]=v??"")}return b.map(C=>C??"")}setHoveredArea(n,u){this.currentHoveredArea&&this.clearHoveredArea(),this.currentHoveredArea={id:n,handle:u}}clearHoveredArea(){this.currentHoveredArea&&(this.currentHoveredArea?.handle.remove(),this.currentHoveredArea=null)}getNameFieldForCurrentLayer(){if(!this.layerHighlightState||!this.layerHighlightState.featureLayerView||!this.layerHighlightState.featureLayerView.layer)return null;const n=this.#n.find(u=>u.layerName===this.layerHighlightState?.featureLayerView?.layer?.title)?.nameField;return n||(console.warn(`SelectedAreasStore: No name field configured for layer ${this.layerHighlightState.featureLayerView.layer.title}`,this.#n),null)}getCodeFieldForCurrentLayer(){if(!this.layerHighlightState||!this.layerHighlightState.featureLayerView||!this.layerHighlightState.featureLayerView.layer)return null;const n=this.#n.find(u=>u.layerName===this.layerHighlightState?.featureLayerView?.layer?.title)?.codeField;return n||(console.warn(`SelectedAreasStore: No code field configured for layer ${this.layerHighlightState.featureLayerView.layer.title}`,this.#n),null)}cleanup(){this.resetSelectedAreas(),this.clearHoveredArea(),this.lastAddedArea=null,this.lastRemovedArea=null,this.currentHoveredArea=null,this.#o.clear(),this.#n=[],console.log("[area-selection-store] cleaned up.")}}const ut=new Ps;var Ts=ye('<p class="text-sm font-medium"> </p>'),Ms=ye('<div class="pointer-events-none fixed z-50 transition-opacity duration-200"><!></div>');function Ns(A,n){dt(n,!0);let u=we(null),c=we(Ct({x:0,y:0})),p=0;const g=v=>{te(c,{x:v.clientX,y:v.clientY},!0)};Dt(()=>(document.addEventListener("mousemove",g),()=>{document.removeEventListener("mousemove",g)})),Dt(()=>{const v=ut.currentHoveredArea?.id,N=++p;if(!v){te(u,null);return}(async()=>{const H=await ut.getAreaNamesById([v]);N===p&&ut.currentHoveredArea?.id===v&&te(u,H[0]??null,!0)})()});var b=Ce(),C=le(b);{var F=v=>{var N=Ms(),H=re(N);at(H,()=>va,(V,Q)=>{Q(V,{class:"max-w-xs border !py-2 shadow-lg",children:(z,j)=>{var U=Ce(),Z=le(U);at(Z,()=>Gi,(ie,X)=>{X(ie,{class:"!px-3 !py-0",children:(ae,Ae)=>{var de=Ts(),be=re(de,!0);J(de),Tt(()=>Qt(be,f(u))),R(ae,de)},$$slots:{default:!0}})}),R(z,U)},$$slots:{default:!0}})}),J(N),Tt(()=>Gn(N,`left: ${f(c).x+10}px; top: ${f(c).y-10}px;`)),R(v,N)};qe(C,v=>{f(u)&&v(F)})}R(A,b),ft()}function Ls(A,n){dt(n,!0);async function u(c,p){const g=await ut.getAreaNamesById([c]);if(!g||g.length===0||!g[0])return;const b=`Area ${p}: ${g[0]}`;Cn.success(b)}Dt(()=>{ut.lastAddedArea&&u(ut.lastAddedArea.id,"added")}),Dt(()=>{ut.lastRemovedArea&&u(ut.lastRemovedArea.id,"removed")}),ft()}var Ds=ye("<div><!></div>");function ka(A,n){dt(n,!0);let u=nt(n,"ref",15,null),c=vr(n,["$$slots","$$events","$$legacy","ref","variant","children"]);var p=Ds();Wi(p,()=>({...c,class:"group/chat-bubble flex max-w-[80%] flex-row place-items-end gap-2 data-[variant='sent']:place-self-end","data-variant":n.variant}));var g=re(p);xt(g,()=>n.children??Et),J(p),Pr(p,b=>u(b),()=>u()),R(A,p),ft()}var qs=ye('<span class="inline-block size-(--loading-dots-size) rounded-full bg-primary svelte-k2x6sv"></span>'),Fs=ye('<div class="inline-flex items-center gap-1 svelte-k2x6sv"></div>');function Rs(A,n){let u=nt(n,"size",3,4);var c=Fs();let p;Hr(c,20,()=>({length:3}),Qn,(g,b)=>{var C=qs();R(g,C)}),J(c),Tt(g=>p=Gn(c,"",p,g),[()=>({"--loading-dots-size":`${u()??""}px`})]),R(A,c)}var js=ye('<div class="flex size-full place-items-center justify-center"><!></div>'),Hs=ye("<div><!></div>");function oa(A,n){dt(n,!0);let u=nt(n,"ref",15,null),c=nt(n,"typing",3,!1),p=vr(n,["$$slots","$$events","$$legacy","ref","typing","class","children"]);var g=Hs();Wi(g,v=>({...p,class:v}),[()=>Yi("order-2 rounded-lg bg-secondary p-4 text-sm group-data-[variant='received']/chat-bubble:rounded-bl-none group-data-[variant='sent']/chat-bubble:order-1 group-data-[variant='sent']/chat-bubble:rounded-br-none group-data-[variant='sent']/chat-bubble:bg-primary group-data-[variant='sent']/chat-bubble:text-primary-foreground",n.class)]);var b=re(g);{var C=v=>{var N=js(),H=re(N);Rs(H,{}),J(N),R(v,N)},F=v=>{var N=Ce(),H=le(N);xt(H,()=>n.children??Et),R(v,N)};qe(b,v=>{c()?v(C):v(F,!1)})}J(g),Pr(g,v=>u(v),()=>u()),R(A,g),ft()}function zs(A,n){dt(n,!0);let u=nt(n,"ref",15,null),c=vr(n,["$$slots","$$events","$$legacy","ref","class"]);var p=Ce(),g=le(p);{let b=Le(()=>Yi("relative flex size-8 shrink-0 overflow-hidden rounded-full",n.class));at(g,()=>ys,(C,F)=>{F(C,ur({"data-slot":"avatar",get class(){return f(b)}},()=>c,{get ref(){return u()},set ref(v){u(v)}}))})}R(A,p),ft()}function Ca(A,n){dt(n,!0);let u=nt(n,"ref",15,null),c=vr(n,["$$slots","$$events","$$legacy","ref","class"]);{let p=Le(()=>Yi("order-1 group-data-[variant='sent']/chat-bubble:order-2",n.class));zs(A,ur({get class(){return f(p)}},()=>c,{get ref(){return u()},set ref(g){u(g)}}))}ft()}function Va(A){const n=A-1;return n*n*n+1}function Ia(A,{delay:n=0,duration:u=400,easing:c=Va,axis:p="y"}={}){const g=getComputedStyle(A),b=+g.opacity,C=p==="y"?"height":"width",F=parseFloat(g[C]),v=p==="y"?["top","bottom"]:["left","right"],N=v.map(Z=>`${Z[0].toUpperCase()}${Z.slice(1)}`),H=parseFloat(g[`padding${N[0]}`]),V=parseFloat(g[`padding${N[1]}`]),Q=parseFloat(g[`margin${N[0]}`]),z=parseFloat(g[`margin${N[1]}`]),j=parseFloat(g[`border${N[0]}Width`]),U=parseFloat(g[`border${N[1]}Width`]);return{delay:n,duration:u,easing:c,css:Z=>`overflow: hidden;opacity: ${Math.min(Z*20,1)*b};${C}: ${Z*F}px;padding-${v[0]}: ${Z*H}px;padding-${v[1]}: ${Z*V}px;margin-${v[0]}: ${Z*Q}px;margin-${v[1]}: ${Z*z}px;border-${v[0]}-width: ${Z*j}px;border-${v[1]}-width: ${Z*U}px;min-${C}: 0`}}function Ea(A,{delay:n=0,duration:u=400,easing:c=Va,start:p=0,opacity:g=0}={}){const b=getComputedStyle(A),C=+b.opacity,F=b.transform==="none"?"":b.transform,v=1-p,N=C*(1-g);return{delay:n,duration:u,easing:c,css:(H,V)=>`
			transform: ${F} scale(${1-v*V});
			opacity: ${C-N*V}
		`}}class Bs{#e=we();#t=we(0);#r=we(!1);lastScrollHeight=0;set ref(n){if(te(this.#e,n,!0),!f(this.#e))return;this.lastScrollHeight=f(this.#e).scrollHeight,f(this.#e).scrollTo(0,f(this.#t)?f(this.#t):f(this.#e).scrollHeight),f(this.#e).addEventListener("scroll",()=>{f(this.#e)&&(te(this.#t,f(this.#e).scrollTop,!0),this.disableAutoScroll())}),window.addEventListener("resize",()=>{this.scrollToBottom(!0)}),new MutationObserver(()=>{f(this.#e)&&(f(this.#e).scrollHeight!==this.lastScrollHeight&&this.scrollToBottom(!0),this.lastScrollHeight=f(this.#e).scrollHeight)}).observe(f(this.#e),{childList:!0,subtree:!0})}get ref(){return f(this.#e)}get scrollY(){return f(this.#t)}get isAtBottom(){return f(this.#e)?f(this.#t)+f(this.#e).offsetHeight>=f(this.#e).scrollHeight:!0}disableAutoScroll(){this.isAtBottom?te(this.#r,!1):te(this.#r,!0)}scrollToBottom(n=!1){f(this.#e)&&(n&&f(this.#r)||f(this.#e).scrollTo(0,f(this.#e).scrollHeight))}}var Ks=ye("<div><!></div>"),Vs=ye('<div class="relative"><div><!></div> <!></div>');function Us(A,n){dt(n,!0);let u=nt(n,"ref",15,null),c=vr(n,["$$slots","$$events","$$legacy","ref","children","class"]),p=we(!1);const g=new Bs;Wn(()=>{te(p,!0)});var b=Vs(),C=re(b);Wi(C,H=>({...c,class:H}),[()=>Yi("no-scrollbar flex h-full w-full flex-col gap-4 overflow-y-auto p-4",n.class,{"scroll-smooth":f(p)})]);var F=re(C);xt(F,()=>n.children??Et),J(C),Pr(C,H=>u(H),()=>u()),Pr(C,H=>g.ref=H,()=>g?.ref);var v=Ee(C,2);{var N=H=>{var V=Ks(),Q=re(V);hr(Q,{onclick:()=>g.scrollToBottom(),variant:"outline",size:"icon",class:"absolute bottom-2 left-1/2 inline-flex -translate-x-1/2 transform rounded-full shadow-md",children:(z,j)=>{Cs(z,{})},$$slots:{default:!0}}),J(V),Ui(1,V,()=>Ea,()=>({start:.85,duration:100,delay:250})),Ui(2,V,()=>Ea,()=>({start:.85,duration:100})),R(H,V)};qe(v,H=>{g.isAtBottom||H(N)})}J(b),R(A,b),ft()}var $s=ye(`<p class="break-words whitespace-pre-wrap"> </p> <div class="w-full text-xs group-data-[variant='sent']/chat-bubble:text-end"> </div>`,1),Ws=ye("<!> <!>",1),Gs=ye('<p class="break-words whitespace-pre-wrap"> </p>'),Qs=ye("<!> <!>",1),Ys=ye("<!> <!>",1),Xs=ye('<div class="chat-container h-full w-full border border-border svelte-1osgd7m"><div class="message-wrapper svelte-1osgd7m"><!></div> <div class="input-wrapper svelte-1osgd7m"><form class="flex shrink-0 items-center gap-2 border-t border-border bg-background p-2"><!> <!></form></div></div>');function Js(A,n){dt(n,!0);const u=1,c=2,p="Sorry, I encountered an error processing your request.",g="How can I help?";let b=we(""),C=we(!1),F=we(""),v=we(null),N=we(null),H=we(null);const V=Ct([{senderId:u,message:g,sentAt:Q(new Date)}]);Dt(()=>{if(f(N)&&f(H)){const oe=f(N),ue=f(H),ve=()=>{const xe=oe.offsetHeight;ue.style.paddingBottom=`${xe}px`};ve();const G=new ResizeObserver(ve);return G.observe(oe),()=>{G.disconnect()}}}),Dt(()=>{V.length,f(F),f(v)&&setTimeout(()=>{const oe=f(v)?.querySelector('[data-slot="scroll-area-viewport"]');oe&&(oe.scrollTop=oe.scrollHeight)},0)});function Q(oe){const ue=oe.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),ve=oe.getHours()>=12?"PM":"AM";return`${ue} ${ve}`}function z(oe,ue){return{message:oe,senderId:ue,sentAt:Q(new Date)}}function j(oe,ue){V.push(z(oe,ue))}function U(){te(C,!1),te(F,"")}function Z(oe){te(F,f(F)+oe)}async function ie(oe){if(oe.preventDefault(),!f(b).trim()||f(C))return;const ue=f(b).trim();te(b,""),j(ue,c),te(C,!0),te(F,"");try{await n.aiUprnChatbotService.chatStream(ue,Z)&&f(F)?j(f(F),u):j(p,u)}catch(ve){console.error("Chat error:",ve),j(p,u)}finally{U()}}var X=Xs(),ae=re(X),Ae=re(ae);Ra(Ae,{class:"h-full w-full",get ref(){return f(v)},set ref(oe){te(v,oe,!0)},children:(oe,ue)=>{var ve=Ce(),G=le(ve);at(G,()=>Us,(xe,De)=>{De(xe,{children:(ge,ze)=>{var We=Ys(),je=le(We);Hr(je,16,()=>V,Ze=>Ze,(Ze,Ye)=>{var Mt=Ce(),bt=le(Mt);{let vt=Le(()=>Ye.senderId===c?"sent":"received");at(bt,()=>ka,(st,_e)=>{_e(st,{get variant(){return f(vt)},children:(Y,et)=>{var wt=Ws(),Oe=le(wt);at(Oe,()=>Ca,(pt,It)=>{It(pt,{})});var yt=Ee(Oe,2);at(yt,()=>oa,(pt,It)=>{It(pt,{class:"flex flex-col gap-1",children:(Ve,Ht)=>{var qt=$s(),lt=le(qt),_t=re(lt,!0);J(lt);var ot=Ee(lt,2),Ut=re(ot,!0);J(ot),Tt(()=>{Qt(_t,Ye.message),Qt(Ut,Ye.sentAt)}),R(Ve,qt)},$$slots:{default:!0}})}),R(Y,wt)},$$slots:{default:!0}})})}R(Ze,Mt)});var Me=Ee(je,2);{var Je=Ze=>{var Ye=Ce(),Mt=le(Ye);at(Mt,()=>ka,(bt,vt)=>{vt(bt,{variant:"received",children:(st,_e)=>{var Y=Qs(),et=le(Y);at(et,()=>Ca,(Oe,yt)=>{yt(Oe,{})});var wt=Ee(et,2);at(wt,()=>oa,(Oe,yt)=>{yt(Oe,{class:"flex flex-col gap-1",children:(pt,It)=>{var Ve=Ce(),Ht=le(Ve);{var qt=_t=>{var ot=Gs(),Ut=re(ot,!0);J(ot),Tt(()=>Qt(Ut,f(F))),R(_t,ot)},lt=_t=>{var ot=Ce(),Ut=le(ot);at(Ut,()=>oa,(Kt,pr)=>{pr(Kt,{typing:!0})}),R(_t,ot)};qe(Ht,_t=>{f(F)?_t(qt):_t(lt,!1)})}R(pt,Ve)},$$slots:{default:!0}})}),R(st,Y)},$$slots:{default:!0}})}),R(Ze,Ye)};qe(Me,Ze=>{f(C)&&Ze(Je)})}R(ge,We)},$$slots:{default:!0}})}),R(oe,ve)},$$slots:{default:!0}}),J(ae),Pr(ae,oe=>te(H,oe),()=>f(H));var de=Ee(ae,2),be=re(de),Pe=re(be);is(Pe,{class:"rounded-full",placeholder:"Type a message...",get disabled(){return f(C)},get value(){return f(b)},set value(oe){te(b,oe,!0)}});var Ke=Ee(Pe,2);{let oe=Le(()=>f(b).trim()===""||f(C));hr(Ke,{type:"submit",variant:"default",size:"icon",class:"shrink-0 rounded-full",get disabled(){return f(oe)},children:(ue,ve)=>{Os(ue,{})},$$slots:{default:!0}})}J(be),Pr(be,oe=>te(N,oe),()=>f(N)),J(de),J(X),ns("submit",be,ie),R(A,X),ft()}const rn=Object.freeze({Pending:"pending",InProgress:"in-progress",Completed:"completed",Failed:"failed"}),Hi=Object.freeze({Submitted:"SUBMITTED",Queued:"QUEUED",Processing:"IN_PROGRESS",Completed:"COMPLETED",Error:"ERROR"}),Zs=Object.freeze({Success:"success",Error:"error"});var Bi={exports:{}},el=Bi.exports,Aa;function tl(){return Aa||(Aa=1,(function(A,n){(function(u,c){A.exports=c()})(el,function(){var u=function(e,r){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(i[s]=o[s])})(e,r)},c=function(){return(c=Object.assign||function(e){for(var r,i=1,o=arguments.length;i<o;i++)for(var s in r=arguments[i])Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s]);return e}).apply(this,arguments)};function p(e,r,i){for(var o,s=0,d=r.length;s<d;s++)!o&&s in r||((o=o||Array.prototype.slice.call(r,0,s))[s]=r[s]);return e.concat(o||Array.prototype.slice.call(r))}var g=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Lo,b=Object.keys,C=Array.isArray;function F(e,r){return typeof r!="object"||b(r).forEach(function(i){e[i]=r[i]}),e}typeof Promise>"u"||g.Promise||(g.Promise=Promise);var v=Object.getPrototypeOf,N={}.hasOwnProperty;function H(e,r){return N.call(e,r)}function V(e,r){typeof r=="function"&&(r=r(v(e))),(typeof Reflect>"u"?b:Reflect.ownKeys)(r).forEach(function(i){z(e,i,r[i])})}var Q=Object.defineProperty;function z(e,r,i,o){Q(e,r,F(i&&H(i,"get")&&typeof i.get=="function"?{get:i.get,set:i.set,configurable:!0}:{value:i,configurable:!0,writable:!0},o))}function j(e){return{from:function(r){return e.prototype=Object.create(r.prototype),z(e.prototype,"constructor",e),{extend:V.bind(null,e.prototype)}}}}var U=Object.getOwnPropertyDescriptor,Z=[].slice;function ie(e,r,i){return Z.call(e,r,i)}function X(e,r){return r(e)}function ae(e){if(!e)throw new Error("Assertion Failed")}function Ae(e){g.setImmediate?setImmediate(e):setTimeout(e,0)}function de(e,r){if(typeof r=="string"&&H(e,r))return e[r];if(!r)return e;if(typeof r!="string"){for(var i=[],o=0,s=r.length;o<s;++o){var d=de(e,r[o]);i.push(d)}return i}var m=r.indexOf(".");if(m!==-1){var y=e[r.substr(0,m)];return y==null?void 0:de(y,r.substr(m+1))}}function be(e,r,i){if(e&&r!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof r!="string"&&"length"in r){ae(typeof i!="string"&&"length"in i);for(var o=0,s=r.length;o<s;++o)be(e,r[o],i[o])}else{var d,m,y=r.indexOf(".");y!==-1?(d=r.substr(0,y),(m=r.substr(y+1))===""?i===void 0?C(e)&&!isNaN(parseInt(d))?e.splice(d,1):delete e[d]:e[d]=i:be(y=!(y=e[d])||!H(e,d)?e[d]={}:y,m,i)):i===void 0?C(e)&&!isNaN(parseInt(r))?e.splice(r,1):delete e[r]:e[r]=i}}function Pe(e){var r,i={};for(r in e)H(e,r)&&(i[r]=e[r]);return i}var Ke=[].concat;function oe(e){return Ke.apply([],e)}var Ft="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(oe([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(r){return r+e+"Array"})}))).filter(function(e){return g[e]}),ue=new Set(Ft.map(function(e){return g[e]})),ve=null;function G(e){return ve=new WeakMap,e=(function r(i){if(!i||typeof i!="object")return i;var o=ve.get(i);if(o)return o;if(C(i)){o=[],ve.set(i,o);for(var s=0,d=i.length;s<d;++s)o.push(r(i[s]))}else if(ue.has(i.constructor))o=i;else{var m,y=v(i);for(m in o=y===Object.prototype?{}:Object.create(y),ve.set(i,o),i)H(i,m)&&(o[m]=r(i[m]))}return o})(e),ve=null,e}var xe={}.toString;function De(e){return xe.call(e).slice(8,-1)}var ge=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ze=typeof ge=="symbol"?function(e){var r;return e!=null&&(r=e[ge])&&r.apply(e)}:function(){return null};function We(e,r){return r=e.indexOf(r),0<=r&&e.splice(r,1),0<=r}var je={};function Me(e){var r,i,o,s;if(arguments.length===1){if(C(e))return e.slice();if(this===je&&typeof e=="string")return[e];if(s=ze(e)){for(i=[];!(o=s.next()).done;)i.push(o.value);return i}if(e==null)return[e];if(typeof(r=e.length)!="number")return[e];for(i=new Array(r);r--;)i[r]=e[r];return i}for(r=arguments.length,i=new Array(r);r--;)i[r]=arguments[r];return i}var Je=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},er=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],xr=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(er),Ze={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ye(e,r){this.name=e,this.message=r}function Mt(e,r){return e+". Errors: "+Object.keys(r).map(function(i){return r[i].toString()}).filter(function(i,o,s){return s.indexOf(i)===o}).join(`
`)}function bt(e,r,i,o){this.failures=r,this.failedKeys=o,this.successCount=i,this.message=Mt(e,r)}function vt(e,r){this.name="BulkError",this.failures=Object.keys(r).map(function(i){return r[i]}),this.failuresByPos=r,this.message=Mt(e,this.failures)}j(Ye).from(Error).extend({toString:function(){return this.name+": "+this.message}}),j(bt).from(Ye),j(vt).from(Ye);var st=xr.reduce(function(e,r){return e[r]=r+"Error",e},{}),_e=Ye,Y=xr.reduce(function(e,r){var i=r+"Error";function o(s,d){this.name=i,s?typeof s=="string"?(this.message="".concat(s).concat(d?`
 `+d:""),this.inner=d||null):typeof s=="object"&&(this.message="".concat(s.name," ").concat(s.message),this.inner=s):(this.message=Ze[r]||i,this.inner=null)}return j(o).from(_e),e[r]=o,e},{});Y.Syntax=SyntaxError,Y.Type=TypeError,Y.Range=RangeError;var et=er.reduce(function(e,r){return e[r+"Error"]=Y[r],e},{}),wt=xr.reduce(function(e,r){return["Syntax","Type","Range"].indexOf(r)===-1&&(e[r+"Error"]=Y[r]),e},{});function Oe(){}function yt(e){return e}function pt(e,r){return e==null||e===yt?r:function(i){return r(e(i))}}function It(e,r){return function(){e.apply(this,arguments),r.apply(this,arguments)}}function Ve(e,r){return e===Oe?r:function(){var i=e.apply(this,arguments);i!==void 0&&(arguments[0]=i);var o=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var d=r.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?It(o,this.onsuccess):o),s&&(this.onerror=this.onerror?It(s,this.onerror):s),d!==void 0?d:i}}function Ht(e,r){return e===Oe?r:function(){e.apply(this,arguments);var i=this.onsuccess,o=this.onerror;this.onsuccess=this.onerror=null,r.apply(this,arguments),i&&(this.onsuccess=this.onsuccess?It(i,this.onsuccess):i),o&&(this.onerror=this.onerror?It(o,this.onerror):o)}}function qt(e,r){return e===Oe?r:function(i){var o=e.apply(this,arguments);F(i,o);var s=this.onsuccess,d=this.onerror;return this.onsuccess=null,this.onerror=null,i=r.apply(this,arguments),s&&(this.onsuccess=this.onsuccess?It(s,this.onsuccess):s),d&&(this.onerror=this.onerror?It(d,this.onerror):d),o===void 0?i===void 0?void 0:i:F(o,i)}}function lt(e,r){return e===Oe?r:function(){return r.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function _t(e,r){return e===Oe?r:function(){var i=e.apply(this,arguments);if(i&&typeof i.then=="function"){for(var o=this,s=arguments.length,d=new Array(s);s--;)d[s]=arguments[s];return i.then(function(){return r.apply(o,d)})}return r.apply(this,arguments)}}wt.ModifyError=bt,wt.DexieError=Ye,wt.BulkError=vt;var ot=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Ut(e){ot=e}var Kt={},pr=100,Ft=typeof Promise>"u"?[]:(function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,v(e),e];var r=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[r,v(r),e]})(),er=Ft[0],xr=Ft[1],Ft=Ft[2],xr=xr&&xr.then,jt=er&&er.constructor,Tr=!!Ft,kr=function(e,r){Qr.push([e,r]),Wr&&(queueMicrotask(rr),Wr=!1)},Mr=!0,Wr=!0,Cr=[],Gr=[],Re=yt,$t={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Oe,pgp:!1,env:{},finalize:Oe},Ie=$t,Qr=[],tr=0,In=[];function ce(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var r=this._PSD=Ie;if(typeof e!="function"){if(e!==Kt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&An(this,this._value))}this._state=null,this._value=null,++r.ref,(function i(o,s){try{s(function(d){if(o._state===null){if(d===o)throw new TypeError("A promise cannot be resolved with itself.");var m=o._lib&&Nr();d&&typeof d.then=="function"?i(o,function(y,S){d instanceof ce?d._then(y,S):d.then(y,S)}):(o._state=!0,o._value=d,he(o)),m&&Lr()}},An.bind(null,o))}catch(d){An(o,d)}})(this,e)}var En={get:function(){var e=Ie,r=sn;function i(o,s){var d=this,m=!e.global&&(e!==Ie||r!==sn),y=m&&!Dr(),S=new ce(function(x,O){Zn(d,new Jn(ki(o,e,m,y),ki(s,e,m,y),x,O,e))});return this._consoleTask&&(S._consoleTask=this._consoleTask),S}return i.prototype=Kt,i},set:function(e){z(this,"then",e&&e.prototype===Kt?En:{get:function(){return e},set:En.set})}};function Jn(e,r,i,o,s){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof r=="function"?r:null,this.resolve=i,this.reject=o,this.psd=s}function An(e,r){var i,o;Gr.push(r),e._state===null&&(i=e._lib&&Nr(),r=Re(r),e._state=!1,e._value=r,o=e,Cr.some(function(s){return s._value===o._value})||Cr.push(o),he(e),i&&Lr())}function he(e){var r=e._listeners;e._listeners=[];for(var i=0,o=r.length;i<o;++i)Zn(e,r[i]);var s=e._PSD;--s.ref||s.finalize(),tr===0&&(++tr,kr(function(){--tr==0&&an()},[]))}function Zn(e,r){if(e._state!==null){var i=e._state?r.onFulfilled:r.onRejected;if(i===null)return(e._state?r.resolve:r.reject)(e._value);++r.psd.ref,++tr,kr(Ji,[i,e,r])}else e._listeners.push(r)}function Ji(e,r,i){try{var o,s=r._value;!r._state&&Gr.length&&(Gr=[]),o=ot&&r._consoleTask?r._consoleTask.run(function(){return e(s)}):e(s),r._state||Gr.indexOf(s)!==-1||(function(d){for(var m=Cr.length;m;)if(Cr[--m]._value===d._value)return Cr.splice(m,1)})(r),i.resolve(o)}catch(d){i.reject(d)}finally{--tr==0&&an(),--i.psd.ref||i.psd.finalize()}}function rr(){yr($t,function(){Nr()&&Lr()})}function Nr(){var e=Mr;return Wr=Mr=!1,e}function Lr(){var e,r,i;do for(;0<Qr.length;)for(e=Qr,Qr=[],i=e.length,r=0;r<i;++r){var o=e[r];o[0].apply(null,o[1])}while(0<Qr.length);Wr=Mr=!0}function an(){var e=Cr;Cr=[],e.forEach(function(o){o._PSD.onunhandled.call(null,o._value,o)});for(var r=In.slice(0),i=r.length;i;)r[--i]()}function mr(e){return new ce(Kt,!1,e)}function St(e,r){var i=Ie;return function(){var o=Nr(),s=Ie;try{return gr(i,!0),e.apply(this,arguments)}catch(d){r&&r(d)}finally{gr(s,!1),o&&Lr()}}}V(ce.prototype,{then:En,_then:function(e,r){Zn(this,new Jn(null,null,e,r,Ie))},catch:function(e){if(arguments.length===1)return this.then(null,e);var r=e,i=arguments[1];return typeof r=="function"?this.then(null,function(o){return(o instanceof r?i:mr)(o)}):this.then(null,function(o){return(o&&o.name===r?i:mr)(o)})},finally:function(e){return this.then(function(r){return ce.resolve(e()).then(function(){return r})},function(r){return ce.resolve(e()).then(function(){return mr(r)})})},timeout:function(e,r){var i=this;return e<1/0?new ce(function(o,s){var d=setTimeout(function(){return s(new Y.Timeout(r))},e);i.then(o,s).finally(clearTimeout.bind(null,d))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&z(ce.prototype,Symbol.toStringTag,"Dexie.Promise"),$t.env=ei(),V(ce,{all:function(){var e=Me.apply(null,arguments).map(Yr);return new ce(function(r,i){e.length===0&&r([]);var o=e.length;e.forEach(function(s,d){return ce.resolve(s).then(function(m){e[d]=m,--o||r(e)},i)})})},resolve:function(e){return e instanceof ce?e:e&&typeof e.then=="function"?new ce(function(r,i){e.then(r,i)}):new ce(Kt,!0,e)},reject:mr,race:function(){var e=Me.apply(null,arguments).map(Yr);return new ce(function(r,i){e.map(function(o){return ce.resolve(o).then(r,i)})})},PSD:{get:function(){return Ie},set:function(e){return Ie=e}},totalEchoes:{get:function(){return sn}},newPSD:At,usePSD:yr,scheduler:{get:function(){return kr},set:function(e){kr=e}},rejectionMapper:{get:function(){return Re},set:function(e){Re=e}},follow:function(e,r){return new ce(function(i,o){return At(function(s,d){var m=Ie;m.unhandleds=[],m.onunhandled=d,m.finalize=It(function(){var y,S=this;y=function(){S.unhandleds.length===0?s():d(S.unhandleds[0])},In.push(function x(){y(),In.splice(In.indexOf(x),1)}),++tr,kr(function(){--tr==0&&an()},[])},m.finalize),e()},r,i,o)})}}),jt&&(jt.allSettled&&z(ce,"allSettled",function(){var e=Me.apply(null,arguments).map(Yr);return new ce(function(r){e.length===0&&r([]);var i=e.length,o=new Array(i);e.forEach(function(s,d){return ce.resolve(s).then(function(m){return o[d]={status:"fulfilled",value:m}},function(m){return o[d]={status:"rejected",reason:m}}).then(function(){return--i||r(o)})})})}),jt.any&&typeof AggregateError<"u"&&z(ce,"any",function(){var e=Me.apply(null,arguments).map(Yr);return new ce(function(r,i){e.length===0&&i(new AggregateError([]));var o=e.length,s=new Array(o);e.forEach(function(d,m){return ce.resolve(d).then(function(y){return r(y)},function(y){s[m]=y,--o||i(new AggregateError(s))})})})}),jt.withResolvers&&(ce.withResolvers=jt.withResolvers));var ct={awaits:0,echoes:0,id:0},xi=0,Ir=[],on=0,sn=0,On=0;function At(e,r,i,o){var s=Ie,d=Object.create(s);return d.parent=s,d.ref=0,d.global=!1,d.id=++On,$t.env,d.env=Tr?{Promise:ce,PromiseProp:{value:ce,configurable:!0,writable:!0},all:ce.all,race:ce.race,allSettled:ce.allSettled,any:ce.any,resolve:ce.resolve,reject:ce.reject}:{},r&&F(d,r),++s.ref,d.finalize=function(){--this.parent.ref||this.parent.finalize()},o=yr(d,e,i,o),d.ref===0&&d.finalize(),o}function zr(){return ct.id||(ct.id=++xi),++ct.awaits,ct.echoes+=pr,ct.id}function Dr(){return!!ct.awaits&&(--ct.awaits==0&&(ct.id=0),ct.echoes=ct.awaits*pr,!0)}function Yr(e){return ct.echoes&&e&&e.constructor===jt?(zr(),e.then(function(r){return Dr(),r},function(r){return Dr(),kt(r)})):e}function Zi(){var e=Ir[Ir.length-1];Ir.pop(),gr(e,!1)}function gr(e,r){var i,o=Ie;(r?!ct.echoes||on++&&e===Ie:!on||--on&&e===Ie)||queueMicrotask(r?(function(s){++sn,ct.echoes&&--ct.echoes!=0||(ct.echoes=ct.awaits=ct.id=0),Ir.push(Ie),gr(s,!0)}).bind(null,e):Zi),e!==Ie&&(Ie=e,o===$t&&($t.env=ei()),Tr&&(i=$t.env.Promise,r=e.env,(o.global||e.global)&&(Object.defineProperty(g,"Promise",r.PromiseProp),i.all=r.all,i.race=r.race,i.resolve=r.resolve,i.reject=r.reject,r.allSettled&&(i.allSettled=r.allSettled),r.any&&(i.any=r.any))))}function ei(){var e=g.Promise;return Tr?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(g,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function yr(e,r,i,o,s){var d=Ie;try{return gr(e,!0),r(i,o,s)}finally{gr(d,!1)}}function ki(e,r,i,o){return typeof e!="function"?e:function(){var s=Ie;i&&zr(),gr(r,!0);try{return e.apply(this,arguments)}finally{gr(s,!1),o&&queueMicrotask(Dr)}}}function nr(e){Promise===jt&&ct.echoes===0?on===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+xr).indexOf("[native code]")===-1&&(zr=Dr=Oe);var kt=ce.reject,Er="￿",br="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ti="String expected.",wr=[],ln="__dbnames",Xr="readonly",Pn="readwrite";function ir(e,r){return e?r?function(){return e.apply(this,arguments)&&r.apply(this,arguments)}:e:r}var Tn={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function un(e){return typeof e!="string"||/\./.test(e)?function(r){return r}:function(r){return r[e]===void 0&&e in r&&delete(r=G(r))[e],r}}function ri(){throw Y.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function tt(e,r){try{var i=Ci(e),o=Ci(r);if(i!==o)return i==="Array"?1:o==="Array"?-1:i==="binary"?1:o==="binary"?-1:i==="string"?1:o==="string"?-1:i==="Date"?1:o!=="Date"?NaN:-1;switch(i){case"number":case"Date":case"string":return r<e?1:e<r?-1:0;case"binary":return(function(s,d){for(var m=s.length,y=d.length,S=m<y?m:y,x=0;x<S;++x)if(s[x]!==d[x])return s[x]<d[x]?-1:1;return m===y?0:m<y?-1:1})(Ar(e),Ar(r));case"Array":return(function(s,d){for(var m=s.length,y=d.length,S=m<y?m:y,x=0;x<S;++x){var O=tt(s[x],d[x]);if(O!==0)return O}return m===y?0:m<y?-1:1})(e,r)}}catch{}return NaN}function Ci(e){var r=typeof e;return r!="object"?r:ArrayBuffer.isView(e)?"binary":(e=De(e),e==="ArrayBuffer"?"binary":e)}function Ar(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function mt(e,r,i){var o=e.schema.yProps;return o?(r&&0<i.numFailures&&(r=r.filter(function(s,d){return!i.failures[d]})),Promise.all(o.map(function(s){return s=s.updatesTable,r?e.db.table(s).where("k").anyOf(r).delete():e.db.table(s).clear()})).then(function(){return i})):i}var cr=(cn.prototype.execute=function(e){var r=this["@@propmod"];if(r.add!==void 0){var i=r.add;if(C(i))return p(p([],C(e)?e:[],!0),i).sort();if(typeof i=="number")return(Number(e)||0)+i;if(typeof i=="bigint")try{return BigInt(e)+i}catch{return BigInt(0)+i}throw new TypeError("Invalid term ".concat(i))}if(r.remove!==void 0){var o=r.remove;if(C(o))return C(e)?e.filter(function(s){return!o.includes(s)}).sort():[];if(typeof o=="number")return Number(e)-o;if(typeof o=="bigint")try{return BigInt(e)-o}catch{return BigInt(0)-o}throw new TypeError("Invalid subtrahend ".concat(o))}return i=(i=r.replacePrefix)===null||i===void 0?void 0:i[0],i&&typeof e=="string"&&e.startsWith(i)?r.replacePrefix[1]+e.substring(i.length):e},cn);function cn(e){this["@@propmod"]=e}function dn(e,r){for(var i=b(r),o=i.length,s=!1,d=0;d<o;++d){var m=i[d],y=r[m],S=de(e,m);y instanceof cr?(be(e,m,y.execute(S)),s=!0):S!==y&&(be(e,m,y),s=!0)}return s}var fn=(gt.prototype._trans=function(e,r,i){var o=this._tx||Ie.trans,s=this.name,d=ot&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function m(x,O,_){if(!_.schema[s])throw new Y.NotFound("Table "+s+" not part of transaction");return r(_.idbtrans,_)}var y=Nr();try{var S=o&&o.db._novip===this.db._novip?o===Ie.trans?o._promise(e,m,i):At(function(){return o._promise(e,m,i)},{trans:o,transless:Ie.transless||Ie}):(function x(O,_,T,k){if(O.idbdb&&(O._state.openComplete||Ie.letThrough||O._vip)){var I=O._createTransaction(_,T,O._dbSchema);try{I.create(),O._state.PR1398_maxLoop=3}catch(E){return E.name===st.InvalidState&&O.isOpen()&&0<--O._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),O.close({disableAutoOpen:!1}),O.open().then(function(){return x(O,_,T,k)})):kt(E)}return I._promise(_,function(E,P){return At(function(){return Ie.trans=I,k(E,P,I)})}).then(function(E){if(_==="readwrite")try{I.idbtrans.commit()}catch{}return _==="readonly"?E:I._completion.then(function(){return E})})}if(O._state.openComplete)return kt(new Y.DatabaseClosed(O._state.dbOpenError));if(!O._state.isBeingOpened){if(!O._state.autoOpen)return kt(new Y.DatabaseClosed);O.open().catch(Oe)}return O._state.dbReadyPromise.then(function(){return x(O,_,T,k)})})(this.db,e,[this.name],m);return d&&(S._consoleTask=d,S=S.catch(function(x){return console.trace(x),kt(x)})),S}finally{y&&Lr()}},gt.prototype.get=function(e,r){var i=this;return e&&e.constructor===Object?this.where(e).first(r):e==null?kt(new Y.Type("Invalid argument to Table.get()")):this._trans("readonly",function(o){return i.core.get({trans:o,key:e}).then(function(s){return i.hook.reading.fire(s)})}).then(r)},gt.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(C(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var r=b(e);if(r.length===1)return this.where(r[0]).equals(e[r[0]]);var i=this.schema.indexes.concat(this.schema.primKey).filter(function(y){if(y.compound&&r.every(function(x){return 0<=y.keyPath.indexOf(x)})){for(var S=0;S<r.length;++S)if(r.indexOf(y.keyPath[S])===-1)return!1;return!0}return!1}).sort(function(y,S){return y.keyPath.length-S.keyPath.length})[0];if(i&&this.db._maxKey!==Er){var d=i.keyPath.slice(0,r.length);return this.where(d).equals(d.map(function(S){return e[S]}))}!i&&ot&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(r.join("+"),"]"));var o=this.schema.idxByName;function s(y,S){return tt(y,S)===0}var m=r.reduce(function(_,S){var x=_[0],O=_[1],_=o[S],T=e[S];return[x||_,x||!_?ir(O,_&&_.multi?function(k){return k=de(k,S),C(k)&&k.some(function(I){return s(T,I)})}:function(k){return s(T,de(k,S))}):O]},[null,null]),d=m[0],m=m[1];return d?this.where(d.name).equals(e[d.keyPath]).filter(m):i?this.filter(m):this.where(r).equals("")},gt.prototype.filter=function(e){return this.toCollection().and(e)},gt.prototype.count=function(e){return this.toCollection().count(e)},gt.prototype.offset=function(e){return this.toCollection().offset(e)},gt.prototype.limit=function(e){return this.toCollection().limit(e)},gt.prototype.each=function(e){return this.toCollection().each(e)},gt.prototype.toArray=function(e){return this.toCollection().toArray(e)},gt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},gt.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,C(e)?"[".concat(e.join("+"),"]"):e))},gt.prototype.reverse=function(){return this.toCollection().reverse()},gt.prototype.mapToClass=function(e){var r,i=this.db,o=this.name;function s(){return r!==null&&r.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof ri&&((function(S,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");function O(){this.constructor=S}u(S,x),S.prototype=x===null?Object.create(x):(O.prototype=x.prototype,new O)})(s,r=e),Object.defineProperty(s.prototype,"db",{get:function(){return i},enumerable:!1,configurable:!0}),s.prototype.table=function(){return o},e=s);for(var d=new Set,m=e.prototype;m;m=v(m))Object.getOwnPropertyNames(m).forEach(function(S){return d.add(S)});function y(S){if(!S)return S;var x,O=Object.create(e.prototype);for(x in S)if(!d.has(x))try{O[x]=S[x]}catch{}return O}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=y,this.hook("reading",y),e},gt.prototype.defineClass=function(){return this.mapToClass(function(e){F(this,e)})},gt.prototype.add=function(e,r){var i=this,o=this.schema.primKey,s=o.auto,d=o.keyPath,m=e;return d&&s&&(m=un(d)(e)),this._trans("readwrite",function(y){return i.core.mutate({trans:y,type:"add",keys:r!=null?[r]:null,values:[m]})}).then(function(y){return y.numFailures?ce.reject(y.failures[0]):y.lastResult}).then(function(y){if(d)try{be(e,d,y)}catch{}return y})},gt.prototype.upsert=function(e,r){var i=this,o=this.schema.primKey.keyPath;return this._trans("readwrite",function(s){return i.core.get({trans:s,key:e}).then(function(d){var m=d??{};return dn(m,r),o&&be(m,o,e),i.core.mutate({trans:s,type:"put",values:[m],keys:[e],upsert:!0,updates:{keys:[e],changeSpecs:[r]}}).then(function(y){return y.numFailures?ce.reject(y.failures[0]):!!d})})})},gt.prototype.update=function(e,r){return typeof e!="object"||C(e)?this.where(":id").equals(e).modify(r):(e=de(e,this.schema.primKey.keyPath),e===void 0?kt(new Y.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(r))},gt.prototype.put=function(e,r){var i=this,o=this.schema.primKey,s=o.auto,d=o.keyPath,m=e;return d&&s&&(m=un(d)(e)),this._trans("readwrite",function(y){return i.core.mutate({trans:y,type:"put",values:[m],keys:r!=null?[r]:null})}).then(function(y){return y.numFailures?ce.reject(y.failures[0]):y.lastResult}).then(function(y){if(d)try{be(e,d,y)}catch{}return y})},gt.prototype.delete=function(e){var r=this;return this._trans("readwrite",function(i){return r.core.mutate({trans:i,type:"delete",keys:[e]}).then(function(o){return mt(r,[e],o)}).then(function(o){return o.numFailures?ce.reject(o.failures[0]):void 0})})},gt.prototype.clear=function(){var e=this;return this._trans("readwrite",function(r){return e.core.mutate({trans:r,type:"deleteRange",range:Tn}).then(function(i){return mt(e,null,i)})}).then(function(r){return r.numFailures?ce.reject(r.failures[0]):void 0})},gt.prototype.bulkGet=function(e){var r=this;return this._trans("readonly",function(i){return r.core.getMany({keys:e,trans:i}).then(function(o){return o.map(function(s){return r.hook.reading.fire(s)})})})},gt.prototype.bulkAdd=function(e,r,i){var o=this,s=Array.isArray(r)?r:void 0,d=(i=i||(s?void 0:r))?i.allKeys:void 0;return this._trans("readwrite",function(m){var x=o.schema.primKey,y=x.auto,x=x.keyPath;if(x&&s)throw new Y.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new Y.InvalidArgument("Arguments objects and keys must have the same length");var S=e.length,x=x&&y?e.map(un(x)):e;return o.core.mutate({trans:m,type:"add",keys:s,values:x,wantResults:d}).then(function(I){var _=I.numFailures,T=I.results,k=I.lastResult,I=I.failures;if(_===0)return d?T:k;throw new vt("".concat(o.name,".bulkAdd(): ").concat(_," of ").concat(S," operations failed"),I)})})},gt.prototype.bulkPut=function(e,r,i){var o=this,s=Array.isArray(r)?r:void 0,d=(i=i||(s?void 0:r))?i.allKeys:void 0;return this._trans("readwrite",function(m){var x=o.schema.primKey,y=x.auto,x=x.keyPath;if(x&&s)throw new Y.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new Y.InvalidArgument("Arguments objects and keys must have the same length");var S=e.length,x=x&&y?e.map(un(x)):e;return o.core.mutate({trans:m,type:"put",keys:s,values:x,wantResults:d}).then(function(I){var _=I.numFailures,T=I.results,k=I.lastResult,I=I.failures;if(_===0)return d?T:k;throw new vt("".concat(o.name,".bulkPut(): ").concat(_," of ").concat(S," operations failed"),I)})})},gt.prototype.bulkUpdate=function(e){var r=this,i=this.core,o=e.map(function(m){return m.key}),s=e.map(function(m){return m.changes}),d=[];return this._trans("readwrite",function(m){return i.getMany({trans:m,keys:o,cache:"clone"}).then(function(y){var S=[],x=[];e.forEach(function(_,T){var k=_.key,I=_.changes,E=y[T];if(E){for(var P=0,L=Object.keys(I);P<L.length;P++){var q=L[P],K=I[q];if(q===r.schema.primKey.keyPath){if(tt(K,k)!==0)throw new Y.Constraint("Cannot update primary key in bulkUpdate()")}else be(E,q,K)}d.push(T),S.push(k),x.push(E)}});var O=S.length;return i.mutate({trans:m,type:"put",keys:S,values:x,updates:{keys:o,changeSpecs:s}}).then(function(_){var T=_.numFailures,k=_.failures;if(T===0)return O;for(var I=0,E=Object.keys(k);I<E.length;I++){var P,L=E[I],q=d[Number(L)];q!=null&&(P=k[L],delete k[L],k[q]=P)}throw new vt("".concat(r.name,".bulkUpdate(): ").concat(T," of ").concat(O," operations failed"),k)})})})},gt.prototype.bulkDelete=function(e){var r=this,i=e.length;return this._trans("readwrite",function(o){return r.core.mutate({trans:o,type:"delete",keys:e}).then(function(s){return mt(r,e,s)})}).then(function(m){var s=m.numFailures,d=m.lastResult,m=m.failures;if(s===0)return d;throw new vt("".concat(r.name,".bulkDelete(): ").concat(s," of ").concat(i," operations failed"),m)})},gt);function gt(){}function hn(e){function r(m,y){if(y){for(var S=arguments.length,x=new Array(S-1);--S;)x[S-1]=arguments[S];return i[m].subscribe.apply(null,x),e}if(typeof m=="string")return i[m]}var i={};r.addEventType=d;for(var o=1,s=arguments.length;o<s;++o)d(arguments[o]);return r;function d(m,y,S){if(typeof m!="object"){var x;y=y||lt;var O={subscribers:[],fire:S=S||Oe,subscribe:function(_){O.subscribers.indexOf(_)===-1&&(O.subscribers.push(_),O.fire=y(O.fire,_))},unsubscribe:function(_){O.subscribers=O.subscribers.filter(function(T){return T!==_}),O.fire=O.subscribers.reduce(y,S)}};return i[m]=r[m]=O}b(x=m).forEach(function(_){var T=x[_];if(C(T))d(_,x[_][0],x[_][1]);else{if(T!=="asap")throw new Y.InvalidArgument("Invalid event config");var k=d(_,yt,function(){for(var I=arguments.length,E=new Array(I);I--;)E[I]=arguments[I];k.subscribers.forEach(function(P){Ae(function(){P.apply(null,E)})})})}})}}function vn(e,r){return j(r).from({prototype:e}),r}function _r(e,r){return!(e.filter||e.algorithm||e.or)&&(r?e.justLimit:!e.replayFilter)}function Mn(e,r){e.filter=ir(e.filter,r)}function ni(e,r,i){var o=e.replayFilter;e.replayFilter=o?function(){return ir(o(),r())}:r,e.justLimit=i&&!o}function Jr(e,r){if(e.isPrimKey)return r.primaryKey;var i=r.getIndexByKeyPath(e.index);if(!i)throw new Y.Schema("KeyPath "+e.index+" on object store "+r.name+" is not indexed");return i}function ii(e,r,i){var o=Jr(e,r.schema);return r.openCursor({trans:i,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:o,range:e.range}})}function Zr(e,r,i,o){var s=e.replayFilter?ir(e.filter,e.replayFilter()):e.filter;if(e.or){var d={},m=function(y,S,x){var O,_;s&&!s(S,x,function(T){return S.stop(T)},function(T){return S.fail(T)})||((_=""+(O=S.primaryKey))=="[object ArrayBuffer]"&&(_=""+new Uint8Array(O)),H(d,_)||(d[_]=!0,r(y,S,x)))};return Promise.all([e.or._iterate(m,i),Nn(ii(e,o,i),e.algorithm,m,!e.keysOnly&&e.valueMapper)])}return Nn(ii(e,o,i),ir(e.algorithm,s),r,!e.keysOnly&&e.valueMapper)}function Nn(e,r,i,o){var s=St(o?function(d,m,y){return i(o(d),m,y)}:i);return e.then(function(d){if(d)return d.start(function(){var m=function(){return d.continue()};r&&!r(d,function(y){return m=y},function(y){d.stop(y),m=Oe},function(y){d.fail(y),m=Oe})||s(d.value,d,function(y){return m=y}),m()})})}var ea=(it.prototype._read=function(e,r){var i=this._ctx;return i.error?i.table._trans(null,kt.bind(null,i.error)):i.table._trans("readonly",e).then(r)},it.prototype._write=function(e){var r=this._ctx;return r.error?r.table._trans(null,kt.bind(null,r.error)):r.table._trans("readwrite",e,"locked")},it.prototype._addAlgorithm=function(e){var r=this._ctx;r.algorithm=ir(r.algorithm,e)},it.prototype._iterate=function(e,r){return Zr(this._ctx,e,r,this._ctx.table.core)},it.prototype.clone=function(e){var r=Object.create(this.constructor.prototype),i=Object.create(this._ctx);return e&&F(i,e),r._ctx=i,r},it.prototype.raw=function(){return this._ctx.valueMapper=null,this},it.prototype.each=function(e){var r=this._ctx;return this._read(function(i){return Zr(r,e,i,r.table.core)})},it.prototype.count=function(e){var r=this;return this._read(function(i){var o=r._ctx,s=o.table.core;if(_r(o,!0))return s.count({trans:i,query:{index:Jr(o,s.schema),range:o.range}}).then(function(m){return Math.min(m,o.limit)});var d=0;return Zr(o,function(){return++d,!1},i,s).then(function(){return d})}).then(e)},it.prototype.sortBy=function(e,r){var i=e.split(".").reverse(),o=i[0],s=i.length-1;function d(S,x){return x?d(S[i[x]],x-1):S[o]}var m=this._ctx.dir==="next"?1:-1;function y(S,x){return tt(d(S,s),d(x,s))*m}return this.toArray(function(S){return S.sort(y)}).then(r)},it.prototype.toArray=function(e){var r=this;return this._read(function(i){var o=r._ctx;if(o.dir==="next"&&_r(o,!0)&&0<o.limit){var s=o.valueMapper,d=Jr(o,o.table.core.schema);return o.table.core.query({trans:i,limit:o.limit,values:!0,query:{index:d,range:o.range}}).then(function(y){return y=y.result,s?y.map(s):y})}var m=[];return Zr(o,function(y){return m.push(y)},i,o.table.core).then(function(){return m})},e)},it.prototype.offset=function(e){var r=this._ctx;return e<=0||(r.offset+=e,_r(r)?ni(r,function(){var i=e;return function(o,s){return i===0||(i===1?--i:s(function(){o.advance(i),i=0}),!1)}}):ni(r,function(){var i=e;return function(){return--i<0}})),this},it.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),ni(this._ctx,function(){var r=e;return function(i,o,s){return--r<=0&&o(s),0<=r}},!0),this},it.prototype.until=function(e,r){return Mn(this._ctx,function(i,o,s){return!e(i.value)||(o(s),r)}),this},it.prototype.first=function(e){return this.limit(1).toArray(function(r){return r[0]}).then(e)},it.prototype.last=function(e){return this.reverse().first(e)},it.prototype.filter=function(e){var r;return Mn(this._ctx,function(i){return e(i.value)}),(r=this._ctx).isMatch=ir(r.isMatch,e),this},it.prototype.and=function(e){return this.filter(e)},it.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},it.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},it.prototype.desc=function(){return this.reverse()},it.prototype.eachKey=function(e){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(i,o){e(o.key,o)})},it.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},it.prototype.eachPrimaryKey=function(e){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(i,o){e(o.primaryKey,o)})},it.prototype.keys=function(e){var r=this._ctx;r.keysOnly=!r.isMatch;var i=[];return this.each(function(o,s){i.push(s.key)}).then(function(){return i}).then(e)},it.prototype.primaryKeys=function(e){var r=this._ctx;if(r.dir==="next"&&_r(r,!0)&&0<r.limit)return this._read(function(o){var s=Jr(r,r.table.core.schema);return r.table.core.query({trans:o,values:!1,limit:r.limit,query:{index:s,range:r.range}})}).then(function(o){return o.result}).then(e);r.keysOnly=!r.isMatch;var i=[];return this.each(function(o,s){i.push(s.primaryKey)}).then(function(){return i}).then(e)},it.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},it.prototype.firstKey=function(e){return this.limit(1).keys(function(r){return r[0]}).then(e)},it.prototype.lastKey=function(e){return this.reverse().firstKey(e)},it.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var r={};return Mn(this._ctx,function(s){var o=s.primaryKey.toString(),s=H(r,o);return r[o]=!0,!s}),this},it.prototype.modify=function(e){var r=this,i=this._ctx;return this._write(function(o){var s=typeof e=="function"?e:function(E){return dn(E,e)},d=i.table.core,x=d.schema.primaryKey,m=x.outbound,y=x.extractKey,S=200,x=r.db._options.modifyChunkSize;x&&(S=typeof x=="object"?x[d.name]||x["*"]||200:x);function O(E,q){var L=q.failures,q=q.numFailures;T+=E-q;for(var K=0,$=b(L);K<$.length;K++){var ne=$[K];_.push(L[ne])}}var _=[],T=0,k=[],I=e===pn;return r.clone().primaryKeys().then(function(E){function P(q){var K=Math.min(S,E.length-q),$=E.slice(q,q+K);return(I?Promise.resolve([]):d.getMany({trans:o,keys:$,cache:"immutable"})).then(function(ne){var pe=[],ee=[],se=m?[]:null,me=I?$:[];if(!I)for(var fe=0;fe<K;++fe){var Se=ne[fe],Qe={value:G(Se),primKey:E[q+fe]};s.call(Qe,Qe.value,Qe)!==!1&&(Qe.value==null?me.push(E[q+fe]):m||tt(y(Se),y(Qe.value))===0?(ee.push(Qe.value),m&&se.push(E[q+fe])):(me.push(E[q+fe]),pe.push(Qe.value)))}return Promise.resolve(0<pe.length&&d.mutate({trans:o,type:"add",values:pe}).then(function(Xe){for(var rt in Xe.failures)me.splice(parseInt(rt),1);O(pe.length,Xe)})).then(function(){return(0<ee.length||L&&typeof e=="object")&&d.mutate({trans:o,type:"put",keys:se,values:ee,criteria:L,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<q}).then(function(Xe){return O(ee.length,Xe)})}).then(function(){return(0<me.length||L&&I)&&d.mutate({trans:o,type:"delete",keys:me,criteria:L,isAdditionalChunk:0<q}).then(function(Xe){return mt(i.table,me,Xe)}).then(function(Xe){return O(me.length,Xe)})}).then(function(){return E.length>q+K&&P(q+S)})})}var L=_r(i)&&i.limit===1/0&&(typeof e!="function"||I)&&{index:i.index,range:i.range};return P(0).then(function(){if(0<_.length)throw new bt("Error modifying one or more objects",_,T,k);return E.length})})})},it.prototype.delete=function(){var e=this._ctx,r=e.range;return!_r(e)||e.table.schema.yProps||!e.isPrimKey&&r.type!==3?this.modify(pn):this._write(function(i){var o=e.table.core.schema.primaryKey,s=r;return e.table.core.count({trans:i,query:{index:o,range:s}}).then(function(d){return e.table.core.mutate({trans:i,type:"deleteRange",range:s}).then(function(S){var y=S.failures,S=S.numFailures;if(S)throw new bt("Could not delete some values",Object.keys(y).map(function(x){return y[x]}),d-S);return d-S})})})},it);function it(){}var pn=function(e,r){return r.value=null};function Br(e,r){return e<r?-1:e===r?0:1}function ai(e,r){return r<e?-1:e===r?0:1}function Nt(e,r,i){return e=e instanceof Ln?new e.Collection(e):e,e._ctx.error=new(i||TypeError)(r),e}function Yt(e){return new e.Collection(e,function(){return Te("")}).limit(0)}function qr(e,r,i,o){var s,d,m,y,S,x,O,_=i.length;if(!i.every(function(I){return typeof I=="string"}))return Nt(e,ti);function T(I){s=I==="next"?function(P){return P.toUpperCase()}:function(P){return P.toLowerCase()},d=I==="next"?function(P){return P.toLowerCase()}:function(P){return P.toUpperCase()},m=I==="next"?Br:ai;var E=i.map(function(P){return{lower:d(P),upper:s(P)}}).sort(function(P,L){return m(P.lower,L.lower)});y=E.map(function(P){return P.upper}),S=E.map(function(P){return P.lower}),O=(x=I)==="next"?"":o}T("next"),e=new e.Collection(e,function(){return Fr(y[0],S[_-1]+o)}),e._ondirectionchange=function(I){T(I)};var k=0;return e._addAlgorithm(function(I,E,P){var L=I.key;if(typeof L!="string")return!1;var q=d(L);if(r(q,S,k))return!0;for(var K=null,$=k;$<_;++$){var ne=(function(pe,ee,se,me,fe,Se){for(var Qe=Math.min(pe.length,me.length),Xe=-1,rt=0;rt<Qe;++rt){var fr=ee[rt];if(fr!==me[rt])return fe(pe[rt],se[rt])<0?pe.substr(0,rt)+se[rt]+se.substr(rt+1):fe(pe[rt],me[rt])<0?pe.substr(0,rt)+me[rt]+se.substr(rt+1):0<=Xe?pe.substr(0,Xe)+ee[Xe]+se.substr(Xe+1):null;fe(pe[rt],fr)<0&&(Xe=rt)}return Qe<me.length&&Se==="next"?pe+se.substr(pe.length):Qe<pe.length&&Se==="prev"?pe.substr(0,se.length):Xe<0?null:pe.substr(0,Xe)+me[Xe]+se.substr(Xe+1)})(L,q,y[$],S[$],m,x);ne===null&&K===null?k=$+1:(K===null||0<m(K,ne))&&(K=ne)}return E(K!==null?function(){I.continue(K+O)}:P),!1}),e}function Fr(e,r,i,o){return{type:2,lower:e,upper:r,lowerOpen:i,upperOpen:o}}function Te(e){return{type:1,lower:e,upper:e}}var Ln=(Object.defineProperty(Lt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Lt.prototype.between=function(e,r,i,o){i=i!==!1,o=o===!0;try{return 0<this._cmp(e,r)||this._cmp(e,r)===0&&(i||o)&&(!i||!o)?Yt(this):new this.Collection(this,function(){return Fr(e,r,!i,!o)})}catch{return Nt(this,br)}},Lt.prototype.equals=function(e){return e==null?Nt(this,br):new this.Collection(this,function(){return Te(e)})},Lt.prototype.above=function(e){return e==null?Nt(this,br):new this.Collection(this,function(){return Fr(e,void 0,!0)})},Lt.prototype.aboveOrEqual=function(e){return e==null?Nt(this,br):new this.Collection(this,function(){return Fr(e,void 0,!1)})},Lt.prototype.below=function(e){return e==null?Nt(this,br):new this.Collection(this,function(){return Fr(void 0,e,!1,!0)})},Lt.prototype.belowOrEqual=function(e){return e==null?Nt(this,br):new this.Collection(this,function(){return Fr(void 0,e)})},Lt.prototype.startsWith=function(e){return typeof e!="string"?Nt(this,ti):this.between(e,e+Er,!0,!0)},Lt.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):qr(this,function(r,i){return r.indexOf(i[0])===0},[e],Er)},Lt.prototype.equalsIgnoreCase=function(e){return qr(this,function(r,i){return r===i[0]},[e],"")},Lt.prototype.anyOfIgnoreCase=function(){var e=Me.apply(je,arguments);return e.length===0?Yt(this):qr(this,function(r,i){return i.indexOf(r)!==-1},e,"")},Lt.prototype.startsWithAnyOfIgnoreCase=function(){var e=Me.apply(je,arguments);return e.length===0?Yt(this):qr(this,function(r,i){return i.some(function(o){return r.indexOf(o)===0})},e,Er)},Lt.prototype.anyOf=function(){var e=this,r=Me.apply(je,arguments),i=this._cmp;try{r.sort(i)}catch{return Nt(this,br)}if(r.length===0)return Yt(this);var o=new this.Collection(this,function(){return Fr(r[0],r[r.length-1])});o._ondirectionchange=function(d){i=d==="next"?e._ascending:e._descending,r.sort(i)};var s=0;return o._addAlgorithm(function(d,m,y){for(var S=d.key;0<i(S,r[s]);)if(++s===r.length)return m(y),!1;return i(S,r[s])===0||(m(function(){d.continue(r[s])}),!1)}),o},Lt.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Lt.prototype.noneOf=function(){var e=Me.apply(je,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Nt(this,br)}var r=e.reduce(function(i,o){return i?i.concat([[i[i.length-1][1],o]]):[[-1/0,o]]},null);return r.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})},Lt.prototype.inAnyRange=function(L,r){var i=this,o=this._cmp,s=this._ascending,d=this._descending,m=this._min,y=this._max;if(L.length===0)return Yt(this);if(!L.every(function(q){return q[0]!==void 0&&q[1]!==void 0&&s(q[0],q[1])<=0}))return Nt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Y.InvalidArgument);var S=!r||r.includeLowers!==!1,x=r&&r.includeUppers===!0,O,_=s;function T(q,K){return _(q[0],K[0])}try{(O=L.reduce(function(q,K){for(var $=0,ne=q.length;$<ne;++$){var pe=q[$];if(o(K[0],pe[1])<0&&0<o(K[1],pe[0])){pe[0]=m(pe[0],K[0]),pe[1]=y(pe[1],K[1]);break}}return $===ne&&q.push(K),q},[])).sort(T)}catch{return Nt(this,br)}var k=0,I=x?function(q){return 0<s(q,O[k][1])}:function(q){return 0<=s(q,O[k][1])},E=S?function(q){return 0<d(q,O[k][0])}:function(q){return 0<=d(q,O[k][0])},P=I,L=new this.Collection(this,function(){return Fr(O[0][0],O[O.length-1][1],!S,!x)});return L._ondirectionchange=function(q){_=q==="next"?(P=I,s):(P=E,d),O.sort(T)},L._addAlgorithm(function(q,K,$){for(var ne,pe=q.key;P(pe);)if(++k===O.length)return K($),!1;return!I(ne=pe)&&!E(ne)||(i._cmp(pe,O[k][1])===0||i._cmp(pe,O[k][0])===0||K(function(){_===s?q.continue(O[k][0]):q.continue(O[k][1])}),!1)}),L},Lt.prototype.startsWithAnyOf=function(){var e=Me.apply(je,arguments);return e.every(function(r){return typeof r=="string"})?e.length===0?Yt(this):this.inAnyRange(e.map(function(r){return[r,r+Er]})):Nt(this,"startsWithAnyOf() only works with strings")},Lt);function Lt(){}function dr(e){return St(function(r){return en(r),e(r.target.error),!1})}function en(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Or="storagemutated",Sr="x-storagemutated-1",ar=hn(null,Or),oi=(t.prototype._lock=function(){return ae(!Ie.global),++this._reculock,this._reculock!==1||Ie.global||(Ie.lockOwnerFor=this),this},t.prototype._unlock=function(){if(ae(!Ie.global),--this._reculock==0)for(Ie.global||(Ie.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{yr(e[1],e[0])}catch{}}return this},t.prototype._locked=function(){return this._reculock&&Ie.lockOwnerFor!==this},t.prototype.create=function(e){var r=this;if(!this.mode)return this;var i=this.db.idbdb,o=this.db._state.dbOpenError;if(ae(!this.idbtrans),!e&&!i)switch(o&&o.name){case"DatabaseClosedError":throw new Y.DatabaseClosed(o);case"MissingAPIError":throw new Y.MissingAPI(o.message,o);default:throw new Y.OpenFailed(o)}if(!this.active)throw new Y.TransactionInactive;return ae(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||i).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=St(function(s){en(s),r._reject(e.error)}),e.onabort=St(function(s){en(s),r.active&&r._reject(new Y.Abort(e.error)),r.active=!1,r.on("abort").fire(s)}),e.oncomplete=St(function(){r.active=!1,r._resolve(),"mutatedParts"in e&&ar.storagemutated.fire(e.mutatedParts)}),this},t.prototype._promise=function(e,r,i){var o=this;if(e==="readwrite"&&this.mode!=="readwrite")return kt(new Y.ReadOnly("Transaction is readonly"));if(!this.active)return kt(new Y.TransactionInactive);if(this._locked())return new ce(function(d,m){o._blockedFuncs.push([function(){o._promise(e,r,i).then(d,m)},Ie])});if(i)return At(function(){var d=new ce(function(m,y){o._lock();var S=r(m,y,o);S&&S.then&&S.then(m,y)});return d.finally(function(){return o._unlock()}),d._lib=!0,d});var s=new ce(function(d,m){var y=r(d,m,o);y&&y.then&&y.then(d,m)});return s._lib=!0,s},t.prototype._root=function(){return this.parent?this.parent._root():this},t.prototype.waitFor=function(e){var r,i=this._root(),o=ce.resolve(e);i._waitingFor?i._waitingFor=i._waitingFor.then(function(){return o}):(i._waitingFor=o,i._waitingQueue=[],r=i.idbtrans.objectStore(i.storeNames[0]),(function d(){for(++i._spinCount;i._waitingQueue.length;)i._waitingQueue.shift()();i._waitingFor&&(r.get(-1/0).onsuccess=d)})());var s=i._waitingFor;return new ce(function(d,m){o.then(function(y){return i._waitingQueue.push(St(d.bind(null,y)))},function(y){return i._waitingQueue.push(St(m.bind(null,y)))}).finally(function(){i._waitingFor===s&&(i._waitingFor=null)})})},t.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Y.Abort))},t.prototype.table=function(e){var r=this._memoizedTables||(this._memoizedTables={});if(H(r,e))return r[e];var i=this.schema[e];if(!i)throw new Y.NotFound("Table "+e+" not part of transaction");return i=new this.db.Table(e,i,this),i.core=this.db.core.table(e),r[e]=i},t);function t(){}function a(e,r,i,o,s,d,m,y){return{name:e,keyPath:r,unique:i,multi:o,auto:s,compound:d,src:(i&&!m?"&":"")+(o?"*":"")+(s?"++":"")+l(r),type:y}}function l(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function h(e,r,i){return{name:e,primKey:r,indexes:i,mappedClass:null,idxByName:(o=function(s){return[s.name,s]},i.reduce(function(s,d,m){return m=o(d,m),m&&(s[m[0]]=m[1]),s},{}))};var o}var w=function(e){try{return e.only([[]]),w=function(){return[[]]},[[]]}catch{return w=function(){return Er},Er}};function D(e){return e==null?function(){}:typeof e=="string"?(r=e).split(".").length===1?function(i){return i[r]}:function(i){return de(i,r)}:function(i){return de(i,e)};var r}function B(e){return[].slice.call(e)}var Ne=0;function Ue(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Ge(e,r,S){function o(P){if(P.type===3)return null;if(P.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var k=P.lower,I=P.upper,E=P.lowerOpen,P=P.upperOpen;return k===void 0?I===void 0?null:r.upperBound(I,!!P):I===void 0?r.lowerBound(k,!!E):r.bound(k,I,!!E,!!P)}function s(T){var k,I=T.name;return{name:I,schema:T,mutate:function(E){var P=E.trans,L=E.type,q=E.keys,K=E.values,$=E.range;return new Promise(function(ne,pe){ne=St(ne);var ee=P.objectStore(I),se=ee.keyPath==null,me=L==="put"||L==="add";if(!me&&L!=="delete"&&L!=="deleteRange")throw new Error("Invalid operation type: "+L);var fe,Se=(q||K||{length:1}).length;if(q&&K&&q.length!==K.length)throw new Error("Given keys array must have same length as given values array.");if(Se===0)return ne({numFailures:0,failures:{},results:[],lastResult:void 0});function Qe(Zt){++fr,en(Zt)}var Xe=[],rt=[],fr=0;if(L==="deleteRange"){if($.type===4)return ne({numFailures:fr,failures:rt,results:[],lastResult:void 0});$.type===3?Xe.push(fe=ee.clear()):Xe.push(fe=ee.delete(o($)))}else{var se=me?se?[K,q]:[K,null]:[q,null],$e=se[0],Wt=se[1];if(me)for(var Gt=0;Gt<Se;++Gt)Xe.push(fe=Wt&&Wt[Gt]!==void 0?ee[L]($e[Gt],Wt[Gt]):ee[L]($e[Gt])),fe.onerror=Qe;else for(Gt=0;Gt<Se;++Gt)Xe.push(fe=ee[L]($e[Gt])),fe.onerror=Qe}function qi(Zt){Zt=Zt.target.result,Xe.forEach(function(xn,aa){return xn.error!=null&&(rt[aa]=xn.error)}),ne({numFailures:fr,failures:rt,results:L==="delete"?q:Xe.map(function(xn){return xn.result}),lastResult:Zt})}fe.onerror=function(Zt){Qe(Zt),qi(Zt)},fe.onsuccess=qi})},getMany:function(E){var P=E.trans,L=E.keys;return new Promise(function(q,K){q=St(q);for(var $,ne=P.objectStore(I),pe=L.length,ee=new Array(pe),se=0,me=0,fe=function(Xe){Xe=Xe.target,ee[Xe._pos]=Xe.result,++me===se&&q(ee)},Se=dr(K),Qe=0;Qe<pe;++Qe)L[Qe]!=null&&(($=ne.get(L[Qe]))._pos=Qe,$.onsuccess=fe,$.onerror=Se,++se);se===0&&q(ee)})},get:function(E){var P=E.trans,L=E.key;return new Promise(function(q,K){q=St(q);var $=P.objectStore(I).get(L);$.onsuccess=function(ne){return q(ne.target.result)},$.onerror=dr(K)})},query:(k=x,function(E){return new Promise(function(P,L){P=St(P);var q,K,$,se=E.trans,ne=E.values,pe=E.limit,fe=E.query,ee=pe===1/0?void 0:pe,me=fe.index,fe=fe.range,se=se.objectStore(I),me=me.isPrimaryKey?se:se.index(me.name),fe=o(fe);if(pe===0)return P({result:[]});k?((ee=ne?me.getAll(fe,ee):me.getAllKeys(fe,ee)).onsuccess=function(Se){return P({result:Se.target.result})},ee.onerror=dr(L)):(q=0,K=!ne&&"openKeyCursor"in me?me.openKeyCursor(fe):me.openCursor(fe),$=[],K.onsuccess=function(Se){var Qe=K.result;return Qe?($.push(ne?Qe.value:Qe.primaryKey),++q===pe?P({result:$}):void Qe.continue()):P({result:$})},K.onerror=dr(L))})}),openCursor:function(E){var P=E.trans,L=E.values,q=E.query,K=E.reverse,$=E.unique;return new Promise(function(ne,pe){ne=St(ne);var me=q.index,ee=q.range,se=P.objectStore(I),se=me.isPrimaryKey?se:se.index(me.name),me=K?$?"prevunique":"prev":$?"nextunique":"next",fe=!L&&"openKeyCursor"in se?se.openKeyCursor(o(ee),me):se.openCursor(o(ee),me);fe.onerror=dr(pe),fe.onsuccess=St(function(Se){var Qe,Xe,rt,fr,$e=fe.result;$e?($e.___id=++Ne,$e.done=!1,Qe=$e.continue.bind($e),Xe=(Xe=$e.continuePrimaryKey)&&Xe.bind($e),rt=$e.advance.bind($e),fr=function(){throw new Error("Cursor not stopped")},$e.trans=P,$e.stop=$e.continue=$e.continuePrimaryKey=$e.advance=function(){throw new Error("Cursor not started")},$e.fail=St(pe),$e.next=function(){var Wt=this,Gt=1;return this.start(function(){return Gt--?Wt.continue():Wt.stop()}).then(function(){return Wt})},$e.start=function(Wt){function Gt(){if(fe.result)try{Wt()}catch(Zt){$e.fail(Zt)}else $e.done=!0,$e.start=function(){throw new Error("Cursor behind last entry")},$e.stop()}var qi=new Promise(function(Zt,xn){Zt=St(Zt),fe.onerror=dr(xn),$e.fail=xn,$e.stop=function(aa){$e.stop=$e.continue=$e.continuePrimaryKey=$e.advance=fr,Zt(aa)}});return fe.onsuccess=St(function(Zt){fe.onsuccess=Gt,Gt()}),$e.continue=Qe,$e.continuePrimaryKey=Xe,$e.advance=rt,Gt(),qi},ne($e)):ne(null)},pe)})},count:function(E){var P=E.query,L=E.trans,q=P.index,K=P.range;return new Promise(function($,ne){var pe=L.objectStore(I),ee=q.isPrimaryKey?pe:pe.index(q.name),pe=o(K),ee=pe?ee.count(pe):ee.count();ee.onsuccess=St(function(se){return $(se.target.result)}),ee.onerror=dr(ne)})}}}var d,m,y,O=(m=S,y=B((d=e).objectStoreNames),{schema:{name:d.name,tables:y.map(function(T){return m.objectStore(T)}).map(function(T){var k=T.keyPath,P=T.autoIncrement,I=C(k),E={},P={name:T.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:k==null,compound:I,keyPath:k,autoIncrement:P,unique:!0,extractKey:D(k)},indexes:B(T.indexNames).map(function(L){return T.index(L)}).map(function($){var q=$.name,K=$.unique,ne=$.multiEntry,$=$.keyPath,ne={name:q,compound:C($),keyPath:$,unique:K,multiEntry:ne,extractKey:D($)};return E[Ue($)]=ne}),getIndexByKeyPath:function(L){return E[Ue(L)]}};return E[":id"]=P.primaryKey,k!=null&&(E[Ue(k)]=P.primaryKey),P})},hasGetAll:0<y.length&&"getAll"in m.objectStore(y[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),S=O.schema,x=O.hasGetAll,O=S.tables.map(s),_={};return O.forEach(function(T){return _[T.name]=T}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(T){if(!_[T])throw new Error("Table '".concat(T,"' not found"));return _[T]},MIN_KEY:-1/0,MAX_KEY:w(r),schema:S}}function Ot(e,r,i,o){var s=i.IDBKeyRange;return i.indexedDB,{dbcore:(o=Ge(r,s,o),e.dbcore.reduce(function(d,m){return m=m.create,c(c({},d),m(d))},o))}}function zt(e,o){var i=o.db,o=Ot(e._middlewares,i,e._deps,o);e.core=o.dbcore,e.tables.forEach(function(s){var d=s.name;e.core.schema.tables.some(function(m){return m.name===d})&&(s.core=e.core.table(d),e[d]instanceof e.Table&&(e[d].core=s.core))})}function mn(e,r,i,o){i.forEach(function(s){var d=o[s];r.forEach(function(m){var y=(function S(x,O){return U(x,O)||(x=v(x))&&S(x,O)})(m,s);(!y||"value"in y&&y.value===void 0)&&(m===e.Transaction.prototype||m instanceof e.Transaction?z(m,s,{get:function(){return this.table(s)},set:function(S){Q(this,s,{value:S,writable:!0,configurable:!0,enumerable:!0})}}):m[s]=new e.Table(s,d))})})}function si(e,r){r.forEach(function(i){for(var o in i)i[o]instanceof e.Table&&delete i[o]})}function Ii(e,r){return e._cfg.version-r._cfg.version}function ta(e,r,i,o){var s=e._dbSchema;i.objectStoreNames.contains("$meta")&&!s.$meta&&(s.$meta=h("$meta",Oi("")[0],[]),e._storeNames.push("$meta"));var d=e._createTransaction("readwrite",e._storeNames,s);d.create(i),d._completion.catch(o);var m=d._reject.bind(d),y=Ie.transless||Ie;At(function(){return Ie.trans=d,Ie.transless=y,r!==0?(zt(e,i),x=r,((S=d).storeNames.includes("$meta")?S.table("$meta").get("version").then(function(O){return O??x}):ce.resolve(x)).then(function(O){return T=O,k=d,I=i,E=[],O=(_=e)._versions,P=_._dbSchema=qn(0,_.idbdb,I),(O=O.filter(function(L){return L._cfg.version>=T})).length!==0?(O.forEach(function(L){E.push(function(){var q=P,K=L._cfg.dbschema;Fn(_,q,I),Fn(_,K,I),P=_._dbSchema=K;var $=li(q,K);$.add.forEach(function(me){ui(I,me[0],me[1].primKey,me[1].indexes)}),$.change.forEach(function(me){if(me.recreate)throw new Y.Upgrade("Not yet support for changing primary key");var fe=I.objectStore(me.name);me.add.forEach(function(Se){return Dn(fe,Se)}),me.change.forEach(function(Se){fe.deleteIndex(Se.name),Dn(fe,Se)}),me.del.forEach(function(Se){return fe.deleteIndex(Se)})});var ne=L._cfg.contentUpgrade;if(ne&&L._cfg.version>T){zt(_,I),k._memoizedTables={};var pe=Pe(K);$.del.forEach(function(me){pe[me]=q[me]}),si(_,[_.Transaction.prototype]),mn(_,[_.Transaction.prototype],b(pe),pe),k.schema=pe;var ee,se=Je(ne);return se&&zr(),$=ce.follow(function(){var me;(ee=ne(k))&&se&&(me=Dr.bind(null,null),ee.then(me,me))}),ee&&typeof ee.then=="function"?ce.resolve(ee):$.then(function(){return ee})}}),E.push(function(q){var K,$,ne=L._cfg.dbschema;K=ne,$=q,[].slice.call($.db.objectStoreNames).forEach(function(pe){return K[pe]==null&&$.db.deleteObjectStore(pe)}),si(_,[_.Transaction.prototype]),mn(_,[_.Transaction.prototype],_._storeNames,_._dbSchema),k.schema=_._dbSchema}),E.push(function(q){_.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(_.idbdb.version/10)===L._cfg.version?(_.idbdb.deleteObjectStore("$meta"),delete _._dbSchema.$meta,_._storeNames=_._storeNames.filter(function(K){return K!=="$meta"})):q.objectStore("$meta").put(L._cfg.version,"version"))})}),(function L(){return E.length?ce.resolve(E.shift()(k.idbtrans)).then(L):ce.resolve()})().then(function(){Ai(P,I)})):ce.resolve();var _,T,k,I,E,P}).catch(m)):(b(s).forEach(function(O){ui(i,O,s[O].primKey,s[O].indexes)}),zt(e,i),void ce.follow(function(){return e.on.populate.fire(d)}).catch(m));var S,x})}function Ei(e,r){Ai(e._dbSchema,r),r.db.version%10!=0||r.objectStoreNames.contains("$meta")||r.db.createObjectStore("$meta").add(Math.ceil(r.db.version/10-1),"version");var i=qn(0,e.idbdb,r);Fn(e,e._dbSchema,r);for(var o=0,s=li(i,e._dbSchema).change;o<s.length;o++){var d=(function(m){if(m.change.length||m.recreate)return console.warn("Unable to patch indexes of table ".concat(m.name," because it has changes on the type of index or primary key.")),{value:void 0};var y=r.objectStore(m.name);m.add.forEach(function(S){ot&&console.debug("Dexie upgrade patch: Creating missing index ".concat(m.name,".").concat(S.src)),Dn(y,S)})})(s[o]);if(typeof d=="object")return d.value}}function li(e,r){var i,o={del:[],add:[],change:[]};for(i in e)r[i]||o.del.push(i);for(i in r){var s=e[i],d=r[i];if(s){var m={name:i,def:d,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(d.primKey.keyPath||"")||s.primKey.auto!==d.primKey.auto)m.recreate=!0,o.change.push(m);else{var y=s.idxByName,S=d.idxByName,x=void 0;for(x in y)S[x]||m.del.push(x);for(x in S){var O=y[x],_=S[x];O?O.src!==_.src&&m.change.push(_):m.add.push(_)}(0<m.del.length||0<m.add.length||0<m.change.length)&&o.change.push(m)}}else o.add.push([i,d])}return o}function ui(e,r,i,o){var s=e.db.createObjectStore(r,i.keyPath?{keyPath:i.keyPath,autoIncrement:i.auto}:{autoIncrement:i.auto});return o.forEach(function(d){return Dn(s,d)}),s}function Ai(e,r){b(e).forEach(function(i){r.db.objectStoreNames.contains(i)||(ot&&console.debug("Dexie: Creating missing table",i),ui(r,i,e[i].primKey,e[i].indexes))})}function Dn(e,r){e.createIndex(r.name,r.keyPath,{unique:r.unique,multiEntry:r.multi})}function qn(e,r,i){var o={};return ie(r.objectStoreNames,0).forEach(function(s){for(var d=i.objectStore(s),m=a(l(x=d.keyPath),x||"",!0,!1,!!d.autoIncrement,x&&typeof x!="string",!0),y=[],S=0;S<d.indexNames.length;++S){var O=d.index(d.indexNames[S]),x=O.keyPath,O=a(O.name,x,!!O.unique,!!O.multiEntry,!1,x&&typeof x!="string",!1);y.push(O)}o[s]=h(s,m,y)}),o}function Fn(e,r,i){for(var o=i.db.objectStoreNames,s=0;s<o.length;++s){var d=o[s],m=i.objectStore(d);e._hasGetAll="getAll"in m;for(var y=0;y<m.indexNames.length;++y){var S=m.indexNames[y],x=m.index(S).keyPath,O=typeof x=="string"?x:"["+ie(x).join("+")+"]";!r[d]||(x=r[d].idxByName[O])&&(x.name=S,delete r[d].idxByName[O],r[d].idxByName[S]=x)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&g.WorkerGlobalScope&&g instanceof g.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function Oi(e){return e.split(",").map(function(r,i){var d=r.split(":"),o=(s=d[1])===null||s===void 0?void 0:s.trim(),s=(r=d[0].trim()).replace(/([&*]|\+\+)/g,""),d=/^\[/.test(s)?s.match(/^\[(.*)\]$/)[1].split("+"):s;return a(s,d||null,/\&/.test(r),/\*/.test(r),/\+\+/.test(r),C(d),i===0,o)})}var ra=(Kr.prototype._createTableSchema=h,Kr.prototype._parseIndexSyntax=Oi,Kr.prototype._parseStoresSpec=function(e,r){var i=this;b(e).forEach(function(o){if(e[o]!==null){var s=i._parseIndexSyntax(e[o]),d=s.shift();if(!d)throw new Y.Schema("Invalid schema for table "+o+": "+e[o]);if(d.unique=!0,d.multi)throw new Y.Schema("Primary key cannot be multiEntry*");s.forEach(function(m){if(m.auto)throw new Y.Schema("Only primary key can be marked as autoIncrement (++)");if(!m.keyPath)throw new Y.Schema("Index must have a name and cannot be an empty string")}),s=i._createTableSchema(o,d,s),r[o]=s}})},Kr.prototype.stores=function(i){var r=this.db;this._cfg.storesSource=this._cfg.storesSource?F(this._cfg.storesSource,i):i;var i=r._versions,o={},s={};return i.forEach(function(d){F(o,d._cfg.storesSource),s=d._cfg.dbschema={},d._parseStoresSpec(o,s)}),r._dbSchema=s,si(r,[r._allTables,r,r.Transaction.prototype]),mn(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],b(s),s),r._storeNames=b(s),this},Kr.prototype.upgrade=function(e){return this._cfg.contentUpgrade=_t(this._cfg.contentUpgrade||Oe,e),this},Kr);function Kr(){}function ci(e,r){var i=e._dbNamesDB;return i||(i=e._dbNamesDB=new Ur(ln,{addons:[],indexedDB:e,IDBKeyRange:r})).version(1).stores({dbnames:"name"}),i.table("dbnames")}function di(e){return e&&typeof e.databases=="function"}function fi(e){return At(function(){return Ie.letThrough=!0,e()})}function hi(e){return!("from"in e)}var Vt=function(e,r){if(!this){var i=new Vt;return e&&"d"in e&&F(i,e),i}F(this,arguments.length?{d:1,from:e,to:1<arguments.length?r:e}:{d:0})};function gn(e,r,i){var o=tt(r,i);if(!isNaN(o)){if(0<o)throw RangeError();if(hi(e))return F(e,{from:r,to:i,d:1});var s=e.l,o=e.r;if(tt(i,e.from)<0)return s?gn(s,r,i):e.l={from:r,to:i,d:1,l:null,r:null},Pi(e);if(0<tt(r,e.to))return o?gn(o,r,i):e.r={from:r,to:i,d:1,l:null,r:null},Pi(e);tt(r,e.from)<0&&(e.from=r,e.l=null,e.d=o?o.d+1:1),0<tt(i,e.to)&&(e.to=i,e.r=null,e.d=e.l?e.l.d+1:1),i=!e.r,s&&!e.l&&yn(e,s),o&&i&&yn(e,o)}}function yn(e,r){hi(r)||(function i(o,S){var d=S.from,m=S.to,y=S.l,S=S.r;gn(o,d,m),y&&i(o,y),S&&i(o,S)})(e,r)}function vi(e,r){var i=Rn(r),o=i.next();if(o.done)return!1;for(var s=o.value,d=Rn(e),m=d.next(s.from),y=m.value;!o.done&&!m.done;){if(tt(y.from,s.to)<=0&&0<=tt(y.to,s.from))return!0;tt(s.from,y.from)<0?s=(o=i.next(y.from)).value:y=(m=d.next(s.from)).value}return!1}function Rn(e){var r=hi(e)?null:{s:0,n:e};return{next:function(i){for(var o=0<arguments.length;r;)switch(r.s){case 0:if(r.s=1,o)for(;r.n.l&&tt(i,r.n.from)<0;)r={up:r,n:r.n.l,s:1};else for(;r.n.l;)r={up:r,n:r.n.l,s:1};case 1:if(r.s=2,!o||tt(i,r.n.to)<=0)return{value:r.n,done:!1};case 2:if(r.n.r){r.s=3,r={up:r,n:r.n.r,s:0};continue}case 3:r=r.up}return{done:!0}}}}function Pi(e){var r,i,o=(((r=e.r)===null||r===void 0?void 0:r.d)||0)-(((i=e.l)===null||i===void 0?void 0:i.d)||0),s=1<o?"r":o<-1?"l":"";s&&(r=s=="r"?"l":"r",i=c({},e),o=e[s],e.from=o.from,e.to=o.to,e[s]=o[s],i[s]=o[r],(e[r]=i).d=Ti(i)),e.d=Ti(e)}function Ti(i){var r=i.r,i=i.l;return(r?i?Math.max(r.d,i.d):r.d:i?i.d:0)+1}function jn(e,r){return b(r).forEach(function(i){e[i]?yn(e[i],r[i]):e[i]=(function o(s){var d,m,y={};for(d in s)H(s,d)&&(m=s[d],y[d]=!m||typeof m!="object"||ue.has(m.constructor)?m:o(m));return y})(r[i])}),e}function pi(e,r){return e.all||r.all||Object.keys(e).some(function(i){return r[i]&&vi(r[i],e[i])})}V(Vt.prototype,((xr={add:function(e){return yn(this,e),this},addKey:function(e){return gn(this,e,e),this},addKeys:function(e){var r=this;return e.forEach(function(i){return gn(r,i,i)}),this},hasKey:function(e){var r=Rn(this).next(e).value;return r&&tt(r.from,e)<=0&&0<=tt(r.to,e)}})[ge]=function(){return Rn(this)},xr));var Vr={},Hn={},mi=!1;function zn(e){jn(Hn,e),mi||(mi=!0,setTimeout(function(){mi=!1,gi(Hn,!(Hn={}))},0))}function gi(e,r){r===void 0&&(r=!1);var i=new Set;if(e.all)for(var o=0,s=Object.values(Vr);o<s.length;o++)bn(m=s[o],e,i,r);else for(var d in e){var m,y=/^idb\:\/\/(.*)\/(.*)\//.exec(d);y&&(d=y[1],y=y[2],(m=Vr["idb://".concat(d,"/").concat(y)])&&bn(m,e,i,r))}i.forEach(function(S){return S()})}function bn(e,r,i,o){for(var s=[],d=0,m=Object.entries(e.queries.query);d<m.length;d++){for(var y=m[d],S=y[0],x=[],O=0,_=y[1];O<_.length;O++){var T=_[O];pi(r,T.obsSet)?T.subscribers.forEach(function(P){return i.add(P)}):o&&x.push(T)}o&&s.push([S,x])}if(o)for(var k=0,I=s;k<I.length;k++){var E=I[k],S=E[0],x=E[1];e.queries.query[S]=x}}function Mi(e){var r=e._state,i=e._deps.indexedDB;if(r.isBeingOpened||e.idbdb)return r.dbReadyPromise.then(function(){return r.dbOpenError?kt(r.dbOpenError):e});r.isBeingOpened=!0,r.dbOpenError=null,r.openComplete=!1;var o=r.openCanceller,s=Math.round(10*e.verno),d=!1;function m(){if(r.openCanceller!==o)throw new Y.DatabaseClosed("db.open() was cancelled")}function y(){return new ce(function(T,k){if(m(),!i)throw new Y.MissingAPI;var I=e.name,E=r.autoSchema||!s?i.open(I):i.open(I,s);if(!E)throw new Y.MissingAPI;E.onerror=dr(k),E.onblocked=St(e._fireOnBlocked),E.onupgradeneeded=St(function(P){var L;O=E.transaction,r.autoSchema&&!e._options.allowEmptyDB?(E.onerror=en,O.abort(),E.result.close(),(L=i.deleteDatabase(I)).onsuccess=L.onerror=St(function(){k(new Y.NoSuchDatabase("Database ".concat(I," doesnt exist")))})):(O.onerror=dr(k),P=P.oldVersion>Math.pow(2,62)?0:P.oldVersion,_=P<1,e.idbdb=E.result,d&&Ei(e,O),ta(e,P/10,O,k))},k),E.onsuccess=St(function(){O=null;var P,L,q,K,$,ne=e.idbdb=E.result,pe=ie(ne.objectStoreNames);if(0<pe.length)try{var ee=ne.transaction((K=pe).length===1?K[0]:K,"readonly");if(r.autoSchema)L=ne,q=ee,(P=e).verno=L.version/10,q=P._dbSchema=qn(0,L,q),P._storeNames=ie(L.objectStoreNames,0),mn(P,[P._allTables],b(q),q);else if(Fn(e,e._dbSchema,ee),(($=li(qn(0,($=e).idbdb,ee),$._dbSchema)).add.length||$.change.some(function(se){return se.add.length||se.change.length}))&&!d)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),ne.close(),s=ne.version+1,d=!0,T(y());zt(e,ee)}catch{}wr.push(e),ne.onversionchange=St(function(se){r.vcFired=!0,e.on("versionchange").fire(se)}),ne.onclose=St(function(){e.close({disableAutoOpen:!1})}),_&&($=e._deps,ee=I,ne=$.indexedDB,$=$.IDBKeyRange,di(ne)||ee===ln||ci(ne,$).put({name:ee}).catch(Oe)),T()},k)}).catch(function(T){switch(T?.name){case"UnknownError":if(0<r.PR1398_maxLoop)return r.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),y();break;case"VersionError":if(0<s)return s=0,y()}return ce.reject(T)})}var S,x=r.dbReadyResolve,O=null,_=!1;return ce.race([o,(typeof navigator>"u"?ce.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(T){function k(){return indexedDB.databases().finally(T)}S=setInterval(k,100),k()}).finally(function(){return clearInterval(S)}):Promise.resolve()).then(y)]).then(function(){return m(),r.onReadyBeingFired=[],ce.resolve(fi(function(){return e.on.ready.fire(e.vip)})).then(function T(){if(0<r.onReadyBeingFired.length){var k=r.onReadyBeingFired.reduce(_t,Oe);return r.onReadyBeingFired=[],ce.resolve(fi(function(){return k(e.vip)})).then(T)}})}).finally(function(){r.openCanceller===o&&(r.onReadyBeingFired=null,r.isBeingOpened=!1)}).catch(function(T){r.dbOpenError=T;try{O&&O.abort()}catch{}return o===r.openCanceller&&e._close(),kt(T)}).finally(function(){r.openComplete=!0,x()}).then(function(){var T;return _&&(T={},e.tables.forEach(function(k){k.schema.indexes.forEach(function(I){I.name&&(T["idb://".concat(e.name,"/").concat(k.name,"/").concat(I.name)]=new Vt(-1/0,[[[]]]))}),T["idb://".concat(e.name,"/").concat(k.name,"/")]=T["idb://".concat(e.name,"/").concat(k.name,"/:dels")]=new Vt(-1/0,[[[]]])}),ar(Or).fire(T),gi(T,!0)),e})}function Bn(e){function r(d){return e.next(d)}var i=s(r),o=s(function(d){return e.throw(d)});function s(d){return function(S){var y=d(S),S=y.value;return y.done?S:S&&typeof S.then=="function"?S.then(i,o):C(S)?Promise.all(S).then(i,o):i(S)}}return s(r)()}function wn(e,r,i){for(var o=C(e)?e.slice():[e],s=0;s<i;++s)o.push(r);return o}var M={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return c(c({},e),{table:function(r){var i=e.table(r),o=i.schema,s={},d=[];function m(_,T,k){var I=Ue(_),E=s[I]=s[I]||[],P=_==null?0:typeof _=="string"?1:_.length,L=0<T,L=c(c({},k),{name:L?"".concat(I,"(virtual-from:").concat(k.name,")"):k.name,lowLevelIndex:k,isVirtual:L,keyTail:T,keyLength:P,extractKey:D(_),unique:!L&&k.unique});return E.push(L),L.isPrimaryKey||d.push(L),1<P&&m(P===2?_[0]:_.slice(0,P-1),T+1,k),E.sort(function(q,K){return q.keyTail-K.keyTail}),L}r=m(o.primaryKey.keyPath,0,o.primaryKey),s[":id"]=[r];for(var y=0,S=o.indexes;y<S.length;y++){var x=S[y];m(x.keyPath,0,x)}function O(_){var T,k=_.query.index;return k.isVirtual?c(c({},_),{query:{index:k.lowLevelIndex,range:(T=_.query.range,k=k.keyTail,{type:T.type===1?2:T.type,lower:wn(T.lower,T.lowerOpen?e.MAX_KEY:e.MIN_KEY,k),lowerOpen:!0,upper:wn(T.upper,T.upperOpen?e.MIN_KEY:e.MAX_KEY,k),upperOpen:!0})}}):_}return c(c({},i),{schema:c(c({},o),{primaryKey:r,indexes:d,getIndexByKeyPath:function(_){return(_=s[Ue(_)])&&_[0]}}),count:function(_){return i.count(O(_))},query:function(_){return i.query(O(_))},openCursor:function(_){var T=_.query.index,k=T.keyTail,I=T.isVirtual,E=T.keyLength;return I?i.openCursor(O(_)).then(function(L){return L&&P(L)}):i.openCursor(_);function P(L){return Object.create(L,{continue:{value:function(q){q!=null?L.continue(wn(q,_.reverse?e.MAX_KEY:e.MIN_KEY,k)):_.unique?L.continue(L.key.slice(0,E).concat(_.reverse?e.MIN_KEY:e.MAX_KEY,k)):L.continue()}},continuePrimaryKey:{value:function(q,K){L.continuePrimaryKey(wn(q,e.MAX_KEY,k),K)}},primaryKey:{get:function(){return L.primaryKey}},key:{get:function(){var q=L.key;return E===1?q[0]:q.slice(0,E)}},value:{get:function(){return L.value}}})}}})}})}};function W(e,r,i,o){return i=i||{},o=o||"",b(e).forEach(function(s){var d,m,y;H(r,s)?(d=e[s],m=r[s],typeof d=="object"&&typeof m=="object"&&d&&m?(y=De(d))!==De(m)?i[o+s]=r[s]:y==="Object"?W(d,m,i,o+s+"."):d!==m&&(i[o+s]=r[s]):d!==m&&(i[o+s]=r[s])):i[o+s]=void 0}),b(r).forEach(function(s){H(e,s)||(i[o+s]=r[s])}),i}function ke(e,r){return r.type==="delete"?r.keys:r.keys||r.values.map(e.extractKey)}var Fe={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return c(c({},e),{table:function(r){var i=e.table(r),o=i.schema.primaryKey;return c(c({},i),{mutate:function(s){var d=Ie.trans,m=d.table(r).hook,y=m.deleting,S=m.creating,x=m.updating;switch(s.type){case"add":if(S.fire===Oe)break;return d._promise("readwrite",function(){return O(s)},!0);case"put":if(S.fire===Oe&&x.fire===Oe)break;return d._promise("readwrite",function(){return O(s)},!0);case"delete":if(y.fire===Oe)break;return d._promise("readwrite",function(){return O(s)},!0);case"deleteRange":if(y.fire===Oe)break;return d._promise("readwrite",function(){return(function _(T,k,I){return i.query({trans:T,values:!1,query:{index:o,range:k},limit:I}).then(function(E){var P=E.result;return O({type:"delete",keys:P,trans:T}).then(function(L){return 0<L.numFailures?Promise.reject(L.failures[0]):P.length<I?{failures:[],numFailures:0,lastResult:void 0}:_(T,c(c({},k),{lower:P[P.length-1],lowerOpen:!0}),I)})})})(s.trans,s.range,1e4)},!0)}return i.mutate(s);function O(_){var T,k,I,E=Ie.trans,P=_.keys||ke(o,_);if(!P)throw new Error("Keys missing");return(_=_.type==="add"||_.type==="put"?c(c({},_),{keys:P}):c({},_)).type!=="delete"&&(_.values=p([],_.values)),_.keys&&(_.keys=p([],_.keys)),T=i,I=P,((k=_).type==="add"?Promise.resolve([]):T.getMany({trans:k.trans,keys:I,cache:"immutable"})).then(function(L){var q=P.map(function(K,$){var ne,pe,ee,se=L[$],me={onerror:null,onsuccess:null};return _.type==="delete"?y.fire.call(me,K,se,E):_.type==="add"||se===void 0?(ne=S.fire.call(me,K,_.values[$],E),K==null&&ne!=null&&(_.keys[$]=K=ne,o.outbound||be(_.values[$],o.keyPath,K))):(ne=W(se,_.values[$]),(pe=x.fire.call(me,ne,K,se,E))&&(ee=_.values[$],Object.keys(pe).forEach(function(fe){H(ee,fe)?ee[fe]=pe[fe]:be(ee,fe,pe[fe])}))),me});return i.mutate(_).then(function(K){for(var $=K.failures,ne=K.results,pe=K.numFailures,K=K.lastResult,ee=0;ee<P.length;++ee){var se=(ne||P)[ee],me=q[ee];se==null?me.onerror&&me.onerror($[ee]):me.onsuccess&&me.onsuccess(_.type==="put"&&L[ee]?_.values[ee]:se)}return{failures:$,results:ne,numFailures:pe,lastResult:K}}).catch(function(K){return q.forEach(function($){return $.onerror&&$.onerror(K)}),Promise.reject(K)})})}}})}})}};function Be(e,r,i){try{if(!r||r.keys.length<e.length)return null;for(var o=[],s=0,d=0;s<r.keys.length&&d<e.length;++s)tt(r.keys[s],e[d])===0&&(o.push(i?G(r.values[s]):r.values[s]),++d);return o.length===e.length?o:null}catch{return null}}var ht={stack:"dbcore",level:-1,create:function(e){return{table:function(r){var i=e.table(r);return c(c({},i),{getMany:function(o){if(!o.cache)return i.getMany(o);var s=Be(o.keys,o.trans._cache,o.cache==="clone");return s?ce.resolve(s):i.getMany(o).then(function(d){return o.trans._cache={keys:o.keys,values:o.cache==="clone"?G(d):d},d})},mutate:function(o){return o.type!=="add"&&(o.trans._cache=null),i.mutate(o)}})}}}};function or(e,r){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!r.schema.primaryKey.outbound}function Xt(e,r){switch(e){case"query":return r.values&&!r.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Jt={stack:"dbcore",level:0,name:"Observability",create:function(e){var r=e.schema.name,i=new Vt(e.MIN_KEY,e.MAX_KEY);return c(c({},e),{transaction:function(o,s,d){if(Ie.subscr&&s!=="readonly")throw new Y.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ie.querier));return e.transaction(o,s,d)},table:function(o){var s=e.table(o),d=s.schema,m=d.primaryKey,_=d.indexes,y=m.extractKey,S=m.outbound,x=m.autoIncrement&&_.filter(function(k){return k.compound&&k.keyPath.includes(m.keyPath)}),O=c(c({},s),{mutate:function(k){function I(fe){return fe="idb://".concat(r,"/").concat(o,"/").concat(fe),K[fe]||(K[fe]=new Vt)}var E,P,L,q=k.trans,K=k.mutatedParts||(k.mutatedParts={}),$=I(""),ne=I(":dels"),pe=k.type,me=k.type==="deleteRange"?[k.range]:k.type==="delete"?[k.keys]:k.values.length<50?[ke(m,k).filter(function(fe){return fe}),k.values]:[],ee=me[0],se=me[1],me=k.trans._cache;return C(ee)?($.addKeys(ee),(me=pe==="delete"||ee.length===se.length?Be(ee,me):null)||ne.addKeys(ee),(me||se)&&(E=I,P=me,L=se,d.indexes.forEach(function(fe){var Se=E(fe.name||"");function Qe(rt){return rt!=null?fe.extractKey(rt):null}function Xe(rt){return fe.multiEntry&&C(rt)?rt.forEach(function(fr){return Se.addKey(fr)}):Se.addKey(rt)}(P||L).forEach(function(rt,Wt){var $e=P&&Qe(P[Wt]),Wt=L&&Qe(L[Wt]);tt($e,Wt)!==0&&($e!=null&&Xe($e),Wt!=null&&Xe(Wt))})}))):ee?(se={from:(se=ee.lower)!==null&&se!==void 0?se:e.MIN_KEY,to:(se=ee.upper)!==null&&se!==void 0?se:e.MAX_KEY},ne.add(se),$.add(se)):($.add(i),ne.add(i),d.indexes.forEach(function(fe){return I(fe.name).add(i)})),s.mutate(k).then(function(fe){return!ee||k.type!=="add"&&k.type!=="put"||($.addKeys(fe.results),x&&x.forEach(function(Se){for(var Qe=k.values.map(function($e){return Se.extractKey($e)}),Xe=Se.keyPath.findIndex(function($e){return $e===m.keyPath}),rt=0,fr=fe.results.length;rt<fr;++rt)Qe[rt][Xe]=fe.results[rt];I(Se.name).addKeys(Qe)})),q.mutatedParts=jn(q.mutatedParts||{},K),fe})}}),_=function(I){var E=I.query,I=E.index,E=E.range;return[I,new Vt((I=E.lower)!==null&&I!==void 0?I:e.MIN_KEY,(E=E.upper)!==null&&E!==void 0?E:e.MAX_KEY)]},T={get:function(k){return[m,new Vt(k.key)]},getMany:function(k){return[m,new Vt().addKeys(k.keys)]},count:_,query:_,openCursor:_};return b(T).forEach(function(k){O[k]=function(I){var E=Ie.subscr,P=!!E,L=or(Ie,s)&&Xt(k,I)?I.obsSet={}:E;if(P){var q=function(se){return se="idb://".concat(r,"/").concat(o,"/").concat(se),L[se]||(L[se]=new Vt)},K=q(""),$=q(":dels"),E=T[k](I),P=E[0],E=E[1];if((k==="query"&&P.isPrimaryKey&&!I.values?$:q(P.name||"")).add(E),!P.isPrimaryKey){if(k!=="count"){var ne=k==="query"&&S&&I.values&&s.query(c(c({},I),{values:!1}));return s[k].apply(this,arguments).then(function(se){if(k==="query"){if(S&&I.values)return ne.then(function(Qe){return Qe=Qe.result,K.addKeys(Qe),se});var me=I.values?se.result.map(y):se.result;(I.values?K:$).addKeys(me)}else if(k==="openCursor"){var fe=se,Se=I.values;return fe&&Object.create(fe,{key:{get:function(){return $.addKey(fe.primaryKey),fe.key}},primaryKey:{get:function(){var Qe=fe.primaryKey;return $.addKey(Qe),Qe}},value:{get:function(){return Se&&K.addKey(fe.primaryKey),fe.value}}})}return se})}$.add(i)}}return s[k].apply(this,arguments)}}),O}})}};function sr(e,r,i){if(i.numFailures===0)return r;if(r.type==="deleteRange")return null;var o=r.keys?r.keys.length:"values"in r&&r.values?r.values.length:1;return i.numFailures===o?null:(r=c({},r),C(r.keys)&&(r.keys=r.keys.filter(function(s,d){return!(d in i.failures)})),"values"in r&&C(r.values)&&(r.values=r.values.filter(function(s,d){return!(d in i.failures)})),r)}function _n(e,r){return i=e,((o=r).lower===void 0||(o.lowerOpen?0<tt(i,o.lower):0<=tt(i,o.lower)))&&(e=e,(r=r).upper===void 0||(r.upperOpen?tt(e,r.upper)<0:tt(e,r.upper)<=0));var i,o}function Rr(e,r,T,o,s,d){if(!T||T.length===0)return e;var m=r.query.index,y=m.multiEntry,S=r.query.range,x=o.schema.primaryKey.extractKey,O=m.extractKey,_=(m.lowLevelIndex||m).extractKey,T=T.reduce(function(k,I){var E=k,P=[];if(I.type==="add"||I.type==="put")for(var L=new Vt,q=I.values.length-1;0<=q;--q){var K,$=I.values[q],ne=x($);L.hasKey(ne)||(K=O($),(y&&C(K)?K.some(function(fe){return _n(fe,S)}):_n(K,S))&&(L.addKey(ne),P.push($)))}switch(I.type){case"add":var pe=new Vt().addKeys(r.values?k.map(function(Se){return x(Se)}):k),E=k.concat(r.values?P.filter(function(Se){return Se=x(Se),!pe.hasKey(Se)&&(pe.addKey(Se),!0)}):P.map(function(Se){return x(Se)}).filter(function(Se){return!pe.hasKey(Se)&&(pe.addKey(Se),!0)}));break;case"put":var ee=new Vt().addKeys(I.values.map(function(Se){return x(Se)}));E=k.filter(function(Se){return!ee.hasKey(r.values?x(Se):Se)}).concat(r.values?P:P.map(function(Se){return x(Se)}));break;case"delete":var se=new Vt().addKeys(I.keys);E=k.filter(function(Se){return!se.hasKey(r.values?x(Se):Se)});break;case"deleteRange":var me=I.range;E=k.filter(function(Se){return!_n(x(Se),me)})}return E},e);return T===e?e:(T.sort(function(k,I){return tt(_(k),_(I))||tt(x(k),x(I))}),r.limit&&r.limit<1/0&&(T.length>r.limit?T.length=r.limit:e.length===r.limit&&T.length<r.limit&&(s.dirty=!0)),d?Object.freeze(T):T)}function Ni(e,r){return tt(e.lower,r.lower)===0&&tt(e.upper,r.upper)===0&&!!e.lowerOpen==!!r.lowerOpen&&!!e.upperOpen==!!r.upperOpen}function Za(e,r){return(function(i,o,s,d){if(i===void 0)return o!==void 0?-1:0;if(o===void 0)return 1;if((o=tt(i,o))===0){if(s&&d)return 0;if(s)return 1;if(d)return-1}return o})(e.lower,r.lower,e.lowerOpen,r.lowerOpen)<=0&&0<=(function(i,o,s,d){if(i===void 0)return o!==void 0?1:0;if(o===void 0)return-1;if((o=tt(i,o))===0){if(s&&d)return 0;if(s)return-1;if(d)return 1}return o})(e.upper,r.upper,e.upperOpen,r.upperOpen)}function eo(e,r,i,o){e.subscribers.add(i),o.addEventListener("abort",function(){var s,d;e.subscribers.delete(i),e.subscribers.size===0&&(s=e,d=r,setTimeout(function(){s.subscribers.size===0&&We(d,s)},3e3))})}var to={stack:"dbcore",level:0,name:"Cache",create:function(e){var r=e.schema.name;return c(c({},e),{transaction:function(i,o,s){var d,m,y=e.transaction(i,o,s);return o==="readwrite"&&(m=(d=new AbortController).signal,s=function(S){return function(){if(d.abort(),o==="readwrite"){for(var x=new Set,O=0,_=i;O<_.length;O++){var T=_[O],k=Vr["idb://".concat(r,"/").concat(T)];if(k){var I=e.table(T),E=k.optimisticOps.filter(function(Se){return Se.trans===y});if(y._explicit&&S&&y.mutatedParts)for(var P=0,L=Object.values(k.queries.query);P<L.length;P++)for(var q=0,K=(pe=L[P]).slice();q<K.length;q++)pi((ee=K[q]).obsSet,y.mutatedParts)&&(We(pe,ee),ee.subscribers.forEach(function(Se){return x.add(Se)}));else if(0<E.length){k.optimisticOps=k.optimisticOps.filter(function(Se){return Se.trans!==y});for(var $=0,ne=Object.values(k.queries.query);$<ne.length;$++)for(var pe,ee,se,me=0,fe=(pe=ne[$]).slice();me<fe.length;me++)(ee=fe[me]).res!=null&&y.mutatedParts&&(S&&!ee.dirty?(se=Object.isFrozen(ee.res),se=Rr(ee.res,ee.req,E,I,ee,se),ee.dirty?(We(pe,ee),ee.subscribers.forEach(function(Se){return x.add(Se)})):se!==ee.res&&(ee.res=se,ee.promise=ce.resolve({result:se}))):(ee.dirty&&We(pe,ee),ee.subscribers.forEach(function(Se){return x.add(Se)})))}}}x.forEach(function(Se){return Se()})}}},y.addEventListener("abort",s(!1),{signal:m}),y.addEventListener("error",s(!1),{signal:m}),y.addEventListener("complete",s(!0),{signal:m})),y},table:function(i){var o=e.table(i),s=o.schema.primaryKey;return c(c({},o),{mutate:function(d){var m=Ie.trans;if(s.outbound||m.db._options.cache==="disabled"||m.explicit||m.idbtrans.mode!=="readwrite")return o.mutate(d);var y=Vr["idb://".concat(r,"/").concat(i)];return y?(m=o.mutate(d),d.type!=="add"&&d.type!=="put"||!(50<=d.values.length||ke(s,d).some(function(S){return S==null}))?(y.optimisticOps.push(d),d.mutatedParts&&zn(d.mutatedParts),m.then(function(S){0<S.numFailures&&(We(y.optimisticOps,d),(S=sr(0,d,S))&&y.optimisticOps.push(S),d.mutatedParts&&zn(d.mutatedParts))}),m.catch(function(){We(y.optimisticOps,d),d.mutatedParts&&zn(d.mutatedParts)})):m.then(function(S){var x=sr(0,c(c({},d),{values:d.values.map(function(O,_){var T;return S.failures[_]?O:(O=(T=s.keyPath)!==null&&T!==void 0&&T.includes(".")?G(O):c({},O),be(O,s.keyPath,S.results[_]),O)})}),S);y.optimisticOps.push(x),queueMicrotask(function(){return d.mutatedParts&&zn(d.mutatedParts)})}),m):o.mutate(d)},query:function(d){if(!or(Ie,o)||!Xt("query",d))return o.query(d);var m=((x=Ie.trans)===null||x===void 0?void 0:x.db._options.cache)==="immutable",_=Ie,y=_.requery,S=_.signal,x=(function(I,E,P,L){var q=Vr["idb://".concat(I,"/").concat(E)];if(!q)return[];if(!(E=q.queries[P]))return[null,!1,q,null];var K=E[(L.query?L.query.index.name:null)||""];if(!K)return[null,!1,q,null];switch(P){case"query":var $=K.find(function(ne){return ne.req.limit===L.limit&&ne.req.values===L.values&&Ni(ne.req.query.range,L.query.range)});return $?[$,!0,q,K]:[K.find(function(ne){return("limit"in ne.req?ne.req.limit:1/0)>=L.limit&&(!L.values||ne.req.values)&&Za(ne.req.query.range,L.query.range)}),!1,q,K];case"count":return $=K.find(function(ne){return Ni(ne.req.query.range,L.query.range)}),[$,!!$,q,K]}})(r,i,"query",d),O=x[0],_=x[1],T=x[2],k=x[3];return O&&_?O.obsSet=d.obsSet:(_=o.query(d).then(function(I){var E=I.result;if(O&&(O.res=E),m){for(var P=0,L=E.length;P<L;++P)Object.freeze(E[P]);Object.freeze(E)}else I.result=G(E);return I}).catch(function(I){return k&&O&&We(k,O),Promise.reject(I)}),O={obsSet:d.obsSet,promise:_,subscribers:new Set,type:"query",req:d,dirty:!1},k?k.push(O):(k=[O],(T=T||(Vr["idb://".concat(r,"/").concat(i)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[d.query.index.name||""]=k)),eo(O,k,y,S),O.promise.then(function(I){return{result:Rr(I.result,d,T?.optimisticOps,o,O,m)}})}})}})}};function Li(e,r){return new Proxy(e,{get:function(i,o,s){return o==="db"?r:Reflect.get(i,o,s)}})}var Ur=(Rt.prototype.version=function(e){if(isNaN(e)||e<.1)throw new Y.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new Y.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var r=this._versions,i=r.filter(function(o){return o._cfg.version===e})[0];return i||(i=new this.Version(e),r.push(i),r.sort(Ii),i.stores({}),this._state.autoSchema=!1,i)},Rt.prototype._whenReady=function(e){var r=this;return this.idbdb&&(this._state.openComplete||Ie.letThrough||this._vip)?e():new ce(function(i,o){if(r._state.openComplete)return o(new Y.DatabaseClosed(r._state.dbOpenError));if(!r._state.isBeingOpened){if(!r._state.autoOpen)return void o(new Y.DatabaseClosed);r.open().catch(Oe)}r._state.dbReadyPromise.then(i,o)}).then(e)},Rt.prototype.use=function(e){var r=e.stack,i=e.create,o=e.level,s=e.name;return s&&this.unuse({stack:r,name:s}),e=this._middlewares[r]||(this._middlewares[r]=[]),e.push({stack:r,create:i,level:o??10,name:s}),e.sort(function(d,m){return d.level-m.level}),this},Rt.prototype.unuse=function(e){var r=e.stack,i=e.name,o=e.create;return r&&this._middlewares[r]&&(this._middlewares[r]=this._middlewares[r].filter(function(s){return o?s.create!==o:!!i&&s.name!==i})),this},Rt.prototype.open=function(){var e=this;return yr($t,function(){return Mi(e)})},Rt.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var e=this._state,r=wr.indexOf(this);if(0<=r&&wr.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new ce(function(i){e.dbReadyResolve=i}),e.openCanceller=new ce(function(i,o){e.cancelOpen=o}))},Rt.prototype.close=function(i){var r=(i===void 0?{disableAutoOpen:!0}:i).disableAutoOpen,i=this._state;r?(i.isBeingOpened&&i.cancelOpen(new Y.DatabaseClosed),this._close(),i.autoOpen=!1,i.dbOpenError=new Y.DatabaseClosed):(this._close(),i.autoOpen=this._options.autoOpen||i.isBeingOpened,i.openComplete=!1,i.dbOpenError=null)},Rt.prototype.delete=function(e){var r=this;e===void 0&&(e={disableAutoOpen:!0});var i=0<arguments.length&&typeof arguments[0]!="object",o=this._state;return new ce(function(s,d){function m(){r.close(e);var y=r._deps.indexedDB.deleteDatabase(r.name);y.onsuccess=St(function(){var S,x,O;S=r._deps,x=r.name,O=S.indexedDB,S=S.IDBKeyRange,di(O)||x===ln||ci(O,S).delete(x).catch(Oe),s()}),y.onerror=dr(d),y.onblocked=r._fireOnBlocked}if(i)throw new Y.InvalidArgument("Invalid closeOptions argument to db.delete()");o.isBeingOpened?o.dbReadyPromise.then(m):m()})},Rt.prototype.backendDB=function(){return this.idbdb},Rt.prototype.isOpen=function(){return this.idbdb!==null},Rt.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},Rt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Rt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Rt.prototype,"tables",{get:function(){var e=this;return b(this._allTables).map(function(r){return e._allTables[r]})},enumerable:!1,configurable:!0}),Rt.prototype.transaction=function(){var e=(function(r,i,o){var s=arguments.length;if(s<2)throw new Y.InvalidArgument("Too few arguments");for(var d=new Array(s-1);--s;)d[s-1]=arguments[s];return o=d.pop(),[r,oe(d),o]}).apply(this,arguments);return this._transaction.apply(this,e)},Rt.prototype._transaction=function(e,r,i){var o=this,s=Ie.trans;s&&s.db===this&&e.indexOf("!")===-1||(s=null);var d,m,y=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(m=r.map(function(x){if(x=x instanceof o.Table?x.name:x,typeof x!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return x}),e=="r"||e===Xr)d=Xr;else{if(e!="rw"&&e!=Pn)throw new Y.InvalidArgument("Invalid transaction mode: "+e);d=Pn}if(s){if(s.mode===Xr&&d===Pn){if(!y)throw new Y.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&m.forEach(function(x){if(s&&s.storeNames.indexOf(x)===-1){if(!y)throw new Y.SubTransaction("Table "+x+" not included in parent transaction.");s=null}}),y&&s&&!s.active&&(s=null)}}catch(x){return s?s._promise(null,function(O,_){_(x)}):kt(x)}var S=(function x(O,_,T,k,I){return ce.resolve().then(function(){var E=Ie.transless||Ie,P=O._createTransaction(_,T,O._dbSchema,k);if(P.explicit=!0,E={trans:P,transless:E},k)P.idbtrans=k.idbtrans;else try{P.create(),P.idbtrans._explicit=!0,O._state.PR1398_maxLoop=3}catch(K){return K.name===st.InvalidState&&O.isOpen()&&0<--O._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),O.close({disableAutoOpen:!1}),O.open().then(function(){return x(O,_,T,null,I)})):kt(K)}var L,q=Je(I);return q&&zr(),E=ce.follow(function(){var K;(L=I.call(P,P))&&(q?(K=Dr.bind(null,null),L.then(K,K)):typeof L.next=="function"&&typeof L.throw=="function"&&(L=Bn(L)))},E),(L&&typeof L.then=="function"?ce.resolve(L).then(function(K){return P.active?K:kt(new Y.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):E.then(function(){return L})).then(function(K){return k&&P._resolve(),P._completion.then(function(){return K})}).catch(function(K){return P._reject(K),kt(K)})})}).bind(null,this,d,m,s,i);return s?s._promise(d,S,"lock"):Ie.trans?yr(Ie.transless,function(){return o._whenReady(S)}):this._whenReady(S)},Rt.prototype.table=function(e){if(!H(this._allTables,e))throw new Y.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},Rt);function Rt(e,r){var i=this;this._middlewares={},this.verno=0;var o=Rt.dependencies;this._options=r=c({addons:Rt.addons,autoOpen:!0,indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange,cache:"cloned"},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange},o=r.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var s,d,m,y,S,x={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Oe,dbReadyPromise:null,cancelOpen:Oe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:r.autoOpen};x.dbReadyPromise=new ce(function(_){x.dbReadyResolve=_}),x.openCanceller=new ce(function(_,T){x.cancelOpen=T}),this._state=x,this.name=e,this.on=hn(this,"populate","blocked","versionchange","close",{ready:[_t,Oe]}),this.once=function(_,T){var k=function(){for(var I=[],E=0;E<arguments.length;E++)I[E]=arguments[E];i.on(_).unsubscribe(k),T.apply(i,I)};return i.on(_,k)},this.on.ready.subscribe=X(this.on.ready.subscribe,function(_){return function(T,k){Rt.vip(function(){var I,E=i._state;E.openComplete?(E.dbOpenError||ce.resolve().then(T),k&&_(T)):E.onReadyBeingFired?(E.onReadyBeingFired.push(T),k&&_(T)):(_(T),I=i,k||_(function P(){I.on.ready.unsubscribe(T),I.on.ready.unsubscribe(P)}))})}}),this.Collection=(s=this,vn(ea.prototype,function(L,P){this.db=s;var k=Tn,I=null;if(P)try{k=P()}catch(q){I=q}var E=L._ctx,P=E.table,L=P.hook.reading.fire;this._ctx={table:P,index:E.index,isPrimKey:!E.index||P.schema.primKey.keyPath&&E.index===P.schema.primKey.name,range:k,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:I,or:E.or,valueMapper:L!==yt?L:null}})),this.Table=(d=this,vn(fn.prototype,function(_,T,k){this.db=d,this._tx=k,this.name=_,this.schema=T,this.hook=d._allTables[_]?d._allTables[_].hook:hn(null,{creating:[Ve,Oe],reading:[pt,yt],updating:[qt,Oe],deleting:[Ht,Oe]})})),this.Transaction=(m=this,vn(oi.prototype,function(_,T,k,I,E){var P=this;_!=="readonly"&&T.forEach(function(L){L=(L=k[L])===null||L===void 0?void 0:L.yProps,L&&(T=T.concat(L.map(function(q){return q.updatesTable})))}),this.db=m,this.mode=_,this.storeNames=T,this.schema=k,this.chromeTransactionDurability=I,this.idbtrans=null,this.on=hn(this,"complete","error","abort"),this.parent=E||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new ce(function(L,q){P._resolve=L,P._reject=q}),this._completion.then(function(){P.active=!1,P.on.complete.fire()},function(L){var q=P.active;return P.active=!1,P.on.error.fire(L),P.parent?P.parent._reject(L):q&&P.idbtrans&&P.idbtrans.abort(),kt(L)})})),this.Version=(y=this,vn(ra.prototype,function(_){this.db=y,this._cfg={version:_,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(S=this,vn(Ln.prototype,function(_,T,k){if(this.db=S,this._ctx={table:_,index:T===":id"?null:T,or:k},this._cmp=this._ascending=tt,this._descending=function(I,E){return tt(E,I)},this._max=function(I,E){return 0<tt(I,E)?I:E},this._min=function(I,E){return tt(I,E)<0?I:E},this._IDBKeyRange=S._deps.IDBKeyRange,!this._IDBKeyRange)throw new Y.MissingAPI})),this.on("versionchange",function(_){0<_.newVersion?console.warn("Another connection wants to upgrade database '".concat(i.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(i.name,"'. Closing db now to resume the delete request.")),i.close({disableAutoOpen:!1})}),this.on("blocked",function(_){!_.newVersion||_.newVersion<_.oldVersion?console.warn("Dexie.delete('".concat(i.name,"') was blocked")):console.warn("Upgrade '".concat(i.name,"' blocked by other connection holding version ").concat(_.oldVersion/10))}),this._maxKey=w(r.IDBKeyRange),this._createTransaction=function(_,T,k,I){return new i.Transaction(_,T,k,i._options.chromeTransactionDurability,I)},this._fireOnBlocked=function(_){i.on("blocked").fire(_),wr.filter(function(T){return T.name===i.name&&T!==i&&!T._state.vcFired}).map(function(T){return T.on("versionchange").fire(_)})},this.use(ht),this.use(to),this.use(Jt),this.use(M),this.use(Fe);var O=new Proxy(this,{get:function(_,T,k){if(T==="_vip")return!0;if(T==="table")return function(E){return Li(i.table(E),O)};var I=Reflect.get(_,T,k);return I instanceof fn?Li(I,O):T==="tables"?I.map(function(E){return Li(E,O)}):T==="_createTransaction"?function(){return Li(I.apply(this,arguments),O)}:I}});this.vip=O,o.forEach(function(_){return _(i)})}var Di,xr=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",ro=(na.prototype.subscribe=function(e,r,i){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:r,complete:i})},na.prototype[xr]=function(){return this},na);function na(e){this._subscribe=e}try{Di={indexedDB:g.indexedDB||g.mozIndexedDB||g.webkitIndexedDB||g.msIndexedDB,IDBKeyRange:g.IDBKeyRange||g.webkitIDBKeyRange}}catch{Di={indexedDB:null,IDBKeyRange:null}}function ma(e){var r,i=!1,o=new ro(function(s){var d=Je(e),m,y=!1,S={},x={},O={get closed(){return y},unsubscribe:function(){y||(y=!0,m&&m.abort(),_&&ar.storagemutated.unsubscribe(k))}};s.start&&s.start(O);var _=!1,T=function(){return nr(I)},k=function(E){jn(S,E),pi(x,S)&&T()},I=function(){var E,P,L;!y&&Di.indexedDB&&(S={},E={},m&&m.abort(),m=new AbortController,L=(function(q){var K=Nr();try{d&&zr();var $=At(e,q);return $=d?$.finally(Dr):$}finally{K&&Lr()}})(P={subscr:E,signal:m.signal,requery:T,querier:e,trans:null}),Promise.resolve(L).then(function(q){i=!0,r=q,y||P.signal.aborted||(S={},(function(K){for(var $ in K)if(H(K,$))return;return 1})(x=E)||_||(ar(Or,k),_=!0),nr(function(){return!y&&s.next&&s.next(q)}))},function(q){i=!1,["DatabaseClosedError","AbortError"].includes(q?.name)||y||nr(function(){y||s.error&&s.error(q)})}))};return setTimeout(T,0),O});return o.hasValue=function(){return i},o.getValue=function(){return r},o}var Sn=Ur;function ia(e){var r=tn;try{tn=!0,ar.storagemutated.fire(e),gi(e,!0)}finally{tn=r}}V(Sn,c(c({},wt),{delete:function(e){return new Sn(e,{addons:[]}).delete()},exists:function(e){return new Sn(e,{addons:[]}).open().then(function(r){return r.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return r=Sn.dependencies,i=r.indexedDB,r=r.IDBKeyRange,(di(i)?Promise.resolve(i.databases()).then(function(o){return o.map(function(s){return s.name}).filter(function(s){return s!==ln})}):ci(i,r).toCollection().primaryKeys()).then(e)}catch{return kt(new Y.MissingAPI)}var r,i},defineClass:function(){return function(e){F(this,e)}},ignoreTransaction:function(e){return Ie.trans?yr(Ie.transless,e):e()},vip:fi,async:function(e){return function(){try{var r=Bn(e.apply(this,arguments));return r&&typeof r.then=="function"?r:ce.resolve(r)}catch(i){return kt(i)}}},spawn:function(e,r,i){try{var o=Bn(e.apply(i,r||[]));return o&&typeof o.then=="function"?o:ce.resolve(o)}catch(s){return kt(s)}},currentTransaction:{get:function(){return Ie.trans||null}},waitFor:function(e,r){return r=ce.resolve(typeof e=="function"?Sn.ignoreTransaction(e):e).timeout(r||6e4),Ie.trans?Ie.trans.waitFor(r):r},Promise:ce,debug:{get:function(){return ot},set:function(e){Ut(e)}},derive:j,extend:F,props:V,override:X,Events:hn,on:ar,liveQuery:ma,extendObservabilitySet:jn,getByKeyPath:de,setByKeyPath:be,delByKeyPath:function(e,r){typeof r=="string"?be(e,r,void 0):"length"in r&&[].map.call(r,function(i){be(e,i,void 0)})},shallowClone:Pe,deepClone:G,getObjectDiff:W,cmp:tt,asap:Ae,minKey:-1/0,addons:[],connections:wr,errnames:st,dependencies:Di,cache:Vr,semVer:"4.2.1",version:"4.2.1".split(".").map(function(e){return parseInt(e)}).reduce(function(e,r,i){return e+r/Math.pow(10,2*i)})})),Sn.maxKey=w(Sn.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(ar(Or,function(e){tn||(e=new CustomEvent(Sr,{detail:e}),tn=!0,dispatchEvent(e),tn=!1)}),addEventListener(Sr,function(e){e=e.detail,tn||ia(e)}));var Kn,tn=!1,ga=function(){};return typeof BroadcastChannel<"u"&&((ga=function(){(Kn=new BroadcastChannel(Sr)).onmessage=function(e){return e.data&&ia(e.data)}})(),typeof Kn.unref=="function"&&Kn.unref(),ar(Or,function(e){tn||Kn.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!Ur.disableBfCache&&e.persisted){ot&&console.debug("Dexie: handling persisted pagehide"),Kn?.close();for(var r=0,i=wr;r<i.length;r++)i[r].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!Ur.disableBfCache&&e.persisted&&(ot&&console.debug("Dexie: handling persisted pageshow"),ga(),ia({all:new Vt(-1/0,[[]])}))})),ce.rejectionMapper=function(e,r){return!e||e instanceof Ye||e instanceof TypeError||e instanceof SyntaxError||!e.name||!et[e.name]?e:(r=new et[e.name](r||e.message,e),"stack"in e&&z(r,"stack",{get:function(){return this.inner.stack}}),r)},Ut(ot),c(Ur,Object.freeze({__proto__:null,Dexie:Ur,liveQuery:ma,Entity:ri,cmp:tt,PropModification:cr,replacePrefix:function(e,r){return new cr({replacePrefix:[e,r]})},add:function(e){return new cr({add:e})},remove:function(e){return new cr({remove:e})},default:Ur,RangeSet:Vt,mergeRanges:yn,rangesOverlap:vi}),{default:Ur}),Ur})})(Bi)),Bi.exports}var rl=tl();const ua=ja(rl),Oa=Symbol.for("Dexie"),$i=globalThis[Oa]||(globalThis[Oa]=ua);if(ua.semVer!==$i.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${ua.semVer} and ${$i.semVer}`);const{liveQuery:Cc,mergeRanges:Ic,rangesOverlap:Ec,RangeSet:Ac,cmp:Oc,Entity:Pc,PropModification:Tc,replacePrefix:Mc,add:Nc,remove:Lc,DexieYProvider:Dc}=$i;class nl extends $i{uprnSelections;areaSelections;dataSelections;userDownloads;constructor(){super("app-db"),this.version(1).stores({uprnSelections:"++id, createdAt",areaSelections:"++id, layerId, *areaIds",dataSelections:"++id, layerId, *fields",userDownloads:"++id, &localId, createdAt"})}}const Xi=new nl,il=async(A,n,u)=>await Xi.userDownloads.add({localId:A,areaSelection:n,dataSelections:u,status:rn.Pending,createdAt:Date.now()}),al=async(A,n,u,c)=>{const p={};n!==void 0&&(p.externalId=n),u!==void 0&&(p.areaSelection=u),c!==void 0&&(p.dataSelections=c),Object.keys(p).length!==0&&await Xi.userDownloads.where("localId").equals(A).modify(p)},ol=async()=>await Xi.userDownloads.orderBy("createdAt").reverse().toArray(),sl=async A=>await Xi.userDownloads.where("localId").equals(A).delete();class ll{#e=we(Ct(new jr));constructor(){this.#t()}addDownload(n){console.log("[downloads-store] Adding download:",n),f(this.#e).set(n.localId,n),il(n.localId,n.areaSelection,n.dataSelections)}updateDownloadStatus(n){console.log("[downloads-store] Updating download status:",n),f(this.#e).set(n.localId,{...n}),al(n.localId,n.externalId,n.areaSelection,n.dataSelections)}removeDownload(n){f(this.#e).delete(n),sl(n)}getDownloads(){return Array.from(f(this.#e).values())}async#t(){const n=await ol();!n||n.length===0||(console.log("Loaded downloads from DB:",n),n.forEach(u=>{f(this.#e).set(u.localId,{localId:u.localId,status:rn.Pending,areaSelection:u.areaSelection,dataSelections:u.dataSelections})}))}}const yi=new ll;var ul=ye('<span class="download-url svelte-vgw5fc" title="Pending...">Pending...</span>'),cl=ye('<span class="download-url svelte-vgw5fc"> </span>'),dl=ye('<li class="download-item svelte-vgw5fc"><div class="download-info svelte-vgw5fc"><!></div> <div class="download-actions svelte-vgw5fc"><div><!></div> <!> <!> <!></div></li>'),fl=ye('<ul class="selected-list svelte-vgw5fc"></ul> <p class="count svelte-vgw5fc"> </p>',1),hl=ye('<p class="no-selection svelte-vgw5fc">No downloads in queue</p>'),vl=ye('<div class="section svelte-vgw5fc"><h4 class="svelte-vgw5fc">Download Queue</h4> <!></div>');function pl(A,n){dt(n,!0);let u=we(Ct(new Set));const c=Le(()=>yi.getDownloads()),p={completed:{color:"#059669",text:"Completed",icon:Bo},"in-progress":{color:"#2563eb",text:"In Progress",icon:zo},failed:{color:"#dc2626",text:"Failed",icon:Ho},pending:{color:"#6b7280",text:"Pending",icon:jo}};Wn(()=>{const U=setInterval(()=>{g()},5e3);return()=>{clearInterval(U)}}),Dt(()=>{if(!f(c)||f(c).length<=0||!n.uprnDownloadService)return;(async()=>{for(const Z of f(c)){if(Z.externalId||Z.status!==rn.Pending)continue;const ie={exports:{areaSelectionLayer:{remoteId:Z.areaSelection.layerId,areas:Z.areaSelection.areas},dataSelectionLayers:Z.dataSelections.map(ae=>({remoteId:ae.layerId,fields:ae.fields.filter(Ae=>!n.fieldsToHide||!n.fieldsToHide.has(Ae))}))}};console.log("[downloads-menu] Submitting download request:",ie);const X=await n.uprnDownloadService.requestJob(ie);if(!X||X.type===Zs.Error){console.error("[downloads-menu] Failed to submit download request.",X);continue}Z.externalId=X.guid,Z.status=rn.InProgress,yi.updateDownloadStatus(Z)}})()});async function g(){if(f(c).length<=0||!n.uprnDownloadService)return;const U={jobs:f(c).filter(ie=>ie.externalId).map(ie=>ie.externalId)},Z=await n.uprnDownloadService.requestJobStatuses(U);if(!Z){console.error("[downloads-menu] Failed to get job statuses.",Z);return}for(const ie of Z.jobs){const X=f(c).find(ae=>ae.externalId===ie.guid);if(!X){console.warn("[downloads-menu] Received job status for unknown download:",ie.guid);continue}switch(ie.status.type){case Hi.Submitted:case Hi.Processing:X.status=rn.InProgress;break;case Hi.Completed:X.status=rn.Completed;break;case Hi.Error:X.status=rn.Failed;break;default:console.warn("[downloads-menu] Unknown job status type:",ie.status.type);break}yi.updateDownloadStatus(X)}}function b(U){yi.removeDownload(U)}async function C(U){try{await navigator.clipboard.writeText(U),te(u,new Set(f(u)).add(U),!0),Cn.success("URL copied to clipboard"),setTimeout(()=>{const Z=new Set(f(u));Z.delete(U),te(u,Z,!0)},2e3)}catch(Z){console.error("Failed to copy URL:",Z),Cn.error("Failed to copy URL to clipboard")}}function F(U){return p[U]?.color??p.pending.color}function v(U){return p[U]?.text??p.pending.text}function N(U){return p[U]?.icon??p.pending.icon}function H(U){return n.uprnDownloadService.getDownloadUrl(U)}var V=vl(),Q=Ee(re(V),2);{var z=U=>{var Z=fl(),ie=le(Z);Hr(ie,21,()=>f(c),Qn,(Ae,de)=>{var be=dl(),Pe=re(be),Ke=re(Pe);{var oe=Me=>{var Je=ul();R(Me,Je)},ue=Me=>{var Je=cl(),Ze=re(Je,!0);J(Je),Tt(Ye=>{Vi(Je,"title",Ye),Qt(Ze,f(de).externalId)},[()=>H(f(de).externalId)]),R(Me,Je)};qe(Ke,Me=>{f(de).externalId?Me(ue,!1):Me(oe)})}J(Pe);var ve=Ee(Pe,2),G=re(ve),xe=re(G);{let Me=Le(()=>F(f(de).status));hr(xe,{variant:"ghost",size:"sm",class:"download-status-btn",get style(){return`color: ${f(Me)??""}`},disabled:!0,children:(Je,Ze)=>{const Ye=Le(()=>N(f(de).status));var Mt=Ce(),bt=le(Mt);{let vt=Le(()=>f(de).status==="in-progress"?"spinning":"");at(bt,()=>f(Ye),(st,_e)=>{_e(st,{size:14,get class(){return f(vt)}})})}R(Je,Mt)},$$slots:{default:!0}})}J(G);var De=Ee(G,2);{var ge=Me=>{hr(Me,{variant:"ghost",size:"sm",class:"download-clipboard-btn",onclick:()=>C(H(f(de).externalId)),title:"Copy URL to clipboard",children:(Je,Ze)=>{var Ye=Ce(),Mt=le(Ye);{var bt=st=>{Fo(st,{size:14})},vt=st=>{Ro(st,{size:14})};qe(Mt,st=>{f(u).has(H(f(de).externalId))?st(bt):st(vt,!1)})}R(Je,Ye)},$$slots:{default:!0}})};qe(De,Me=>{f(de).externalId&&Me(ge)})}var ze=Ee(De,2);{var We=Me=>{hr(Me,{variant:"ghost",size:"sm",class:"download-action-btn",onclick:()=>window.open(H(f(de).externalId),"_blank"),title:"Open download",children:(Je,Ze)=>{Ss(Je,{})},$$slots:{default:!0}})};qe(ze,Me=>{f(de).externalId&&f(de).status==="completed"&&Me(We)})}var je=Ee(ze,2);hr(je,{variant:"ghost",size:"sm",class:"download-remove-btn",onclick:()=>b(f(de).localId),title:"Remove from queue",children:(Me,Je)=>{kn();var Ze=$n("×");R(Me,Ze)},$$slots:{default:!0}}),J(ve),J(be),Tt(Me=>Vi(G,"title",Me),[()=>v(f(de).status)]),R(Ae,be)}),J(ie);var X=Ee(ie,2),ae=re(X);J(X),Tt(()=>Qt(ae,`${f(c).length??""} download(s) in queue`)),R(U,Z)},j=U=>{var Z=hl();R(U,Z)};qe(Q,U=>{f(c).length>0?U(z):U(j,!1)})}J(V),R(A,V),ft()}class ml{#e=we(Ct(new jr));addSelection(n){f(this.#e).set(n.layerId,n),Cn.success(`'${n.layer.title}' Added`)}removeSelection(n){const u=f(this.#e).get(n);f(this.#e).delete(n),Cn.success(`'${u?.layer.title}' Removed`)}getSelection(n){return f(this.#e).get(n)}getAllSelections(){return Array.from(f(this.#e).values())}cleanup(){f(this.#e).clear()}}const lr=new ml;var gl=ye('<div class="export-footer svelte-10dgoyk"><div class="export-footer__left svelte-10dgoyk"><p class="text-sm text-muted-foreground svelte-10dgoyk">Click "Export" to begin the download.</p></div> <div class="export-footer__right svelte-10dgoyk"><!></div></div>');function yl(A,n){dt(n,!0);function u(){if(ut.layerHighlightState.areaInfos.length<=0){Cn.error("Please select at least one area to export.");return}if(lr.getAllSelections().length<=0){Cn.error("Please select at least one data layer to export.");return}console.log("Starting export..."),(async()=>{const C={layerId:ut.layerHighlightState.featureLayerView?.layer.id||"",layerIndex:ut.layerHighlightState.featureLayerView?.layer.layerId||0,areas:await ut.getAreaCodesById(ut.layerHighlightState.areaInfos.map(N=>N.id))},F=lr.getAllSelections().map(N=>({layerId:N.layerId,layerIndex:N.layer instanceof Ba?N.layer.layerId:-1,fields:Array.from(N.fields)})),v=crypto.randomUUID();yi.addDownload({localId:v,status:rn.Pending,areaSelection:C,dataSelections:F}),n.onExportSuccess?.()})()}var c=gl(),p=Ee(re(c),2),g=re(p);hr(g,{onclick:u,children:(b,C)=>{kn();var F=$n("Export");R(b,F)},$$slots:{default:!0}}),J(p),J(c),R(A,c),ft()}class bl{#e=we(null);get ActiveLayer(){return f(this.#e)}set ActiveLayer(n){te(this.#e,n,!0)}}class wl{#e=we(!1);get isLoaded(){return f(this.#e)}set isLoaded(n){te(this.#e,n,!0)}#t=we(null);get data(){return f(this.#t)}set data(n){te(this.#t,n,!0)}#r=Le(()=>{const n=new jr;function u(c){n.set(c.id,c),c.type==="group"&&c.layers.forEach(g=>{u(g)})}return this.data&&this.data.layers.forEach(c=>{u(c)}),n});get dataLookup(){return f(this.#r)}set dataLookup(n){te(this.#r,n)}#i=we(!1);get loading(){return f(this.#i)}set loading(n){te(this.#i,n,!0)}#n=we(null);get error(){return f(this.#n)}set error(n){te(this.#n,n,!0)}async initializeAsync(n){if(!this.data){this.loading=!0,this.error=null;try{const{portalUrl:u,itemId:c,proxy:p}=n;await this.configurePortalAsync(u,p),await this.loadwebmapAsync(c)}catch(u){console.error("Error initializing webmap:",u),this.error=u.message}finally{this.loading=!1}}}async configurePortalAsync(n,u){if(!n||(Sa.portalUrl=n,console.log(Sa),!u))return;const{addProxyRule:c}=ls;console.log("Adding proxy rule for portal traffic"),c({urlPrefix:u?.urlPrefix,proxyUrl:u?.proxyUrl})}async loadwebmapAsync(n){if(this.data)return;const u=new ss({id:n}),c=new os({portalItem:u});this.data=c,await this.data.when(),this.data.loaded&&(this.isLoaded=!0)}clear(){this.data=null,this.loading=!1,this.error=null}clearError(){this.error=null}getWebmap(){return this.data}}function _l(A,n){A.stopPropagation(),n.onFilterClicked?.(n.layerId)}var Sl=ye("<button><!></button>");function xl(A,n){dt(n,!0);let u=we(Ct(n.hasFiltersApplied?.(n.layerId)??!1));Dt(()=>{te(u,n.hasFiltersApplied?.(n.layerId)??!1,!0)});const c=Le(()=>f(u)?Ko:Vo);var p=Sl();let g;p.__click=[_l,n];var b=re(p);bi(b,()=>f(c)),J(p),Tt(C=>{g=nn(p,1,"filter-btn svelte-k95pvd",null,g,C),Vi(p,"aria-pressed",f(u))},[()=>({active:f(u)})]),R(A,p),ft()}Qi(["click"]);var kl=ye('<li class="area-item svelte-81yb5c"><span class="area-name svelte-81yb5c"> </span> <!></li>'),Cl=ye('<ul class="selected-list svelte-81yb5c"></ul> <p class="count svelte-81yb5c"> </p>',1),Il=ye('<p class="no-selection svelte-81yb5c">No areas selected</p>'),El=ye('<li class="data-item svelte-81yb5c"><span class="data-name svelte-81yb5c"> </span> <div class="data-actions svelte-81yb5c"><!> <!></div></li>'),Al=ye('<ul class="selected-list svelte-81yb5c"></ul> <p class="count svelte-81yb5c"> </p>',1),Ol=ye('<p class="no-selection svelte-81yb5c">No data selected</p>'),Pl=ye('<h2 class="svelte-81yb5c">Export Options</h2> <div class="section svelte-81yb5c"><h3 class="svelte-81yb5c"> </h3> <h4 class="svelte-81yb5c">Selected Areas</h4> <!></div> <div class="section svelte-81yb5c"><h4 class="svelte-81yb5c">Selected Data</h4> <!></div>',1);function Tl(A,n){dt(n,!0);const u=nt(n,"fieldFilterMenuStore",7);let c=we(Ct([]));Dt(()=>{if(!ut.layerHighlightState.areaInfos.length){te(c,[],!0);return}(async()=>{const ae=await ut.getAreaNamesById(ut.layerHighlightState.areaInfos.map(de=>de.id)),Ae=[];for(let de=0;de<ae.length;de++)Ae.push({name:ae[de]||"Unknown Area",HighlightAreaInfo:ut.layerHighlightState.areaInfos[de]});te(c,Ae,!0)})()});function p(X){const ae=f(c).findIndex(Ae=>Ae.name===X);ae!==-1&&ut.removeSelectedArea(f(c)[ae]?.HighlightAreaInfo.id)}function g(X){console.log("[export-menu] Removing data selection for layerId:",X),lr.removeSelection(X),console.log("[export-menu] Current SelectedData:",yo(lr.getAllSelections()))}function b(X){if(u().ActiveLayer?.id===X){u().ActiveLayer=null;return}const ae=n.webMapStore.dataLookup.get(X);if(!ae){console.warn(`[export-menu] Layer with ID ${X} not found in web map store.`);return}u().ActiveLayer=ae}function C(X){const ae=lr.getSelection(X);return!(!ae||!ae.fields||ae.fields.size===0||ae.fields.size===n.webMapStore.dataLookup.get(X)?.fields?.length)}var F=Pl(),v=Ee(le(F),2),N=re(v),H=re(N,!0);J(N);var V=Ee(N,4);{var Q=X=>{var ae=Cl(),Ae=le(ae);Hr(Ae,21,()=>f(c),Qn,(Pe,Ke)=>{var oe=kl(),ue=re(oe),ve=re(ue,!0);J(ue);var G=Ee(ue,2);hr(G,{variant:"ghost",size:"sm",class:"area-remove-btn",onclick:()=>p(f(Ke).name),children:(xe,De)=>{kn();var ge=$n("×");R(xe,ge)},$$slots:{default:!0}}),J(oe),Tt(()=>Qt(ve,f(Ke).name)),R(Pe,oe)}),J(Ae);var de=Ee(Ae,2),be=re(de);J(de),Tt(()=>Qt(be,`${f(c).length??""} area(s) selected`)),R(X,ae)},z=X=>{var ae=Il();R(X,ae)};qe(V,X=>{f(c).length>0?X(Q):X(z,!1)})}J(v);var j=Ee(v,2),U=Ee(re(j),2);{var Z=X=>{var ae=Al(),Ae=le(ae);Hr(Ae,21,()=>lr.getAllSelections(),Qn,(Pe,Ke)=>{var oe=El(),ue=re(oe),ve=re(ue,!0);J(ue);var G=Ee(ue,2),xe=re(G);{var De=ze=>{xl(ze,{get layerId(){return f(Ke).layerId},onFilterClicked:b,hasFiltersApplied:C})};qe(xe,ze=>{f(Ke).layer instanceof Ba&&ze(De)})}var ge=Ee(xe,2);hr(ge,{variant:"ghost",size:"sm",class:"data-remove-btn",onclick:()=>g(f(Ke).layerId),children:(ze,We)=>{kn();var je=$n("×");R(ze,je)},$$slots:{default:!0}}),J(G),J(oe),Tt(()=>Qt(ve,f(Ke).layer.title)),R(Pe,oe)}),J(Ae);var de=Ee(Ae,2),be=re(de);J(de),Tt(Pe=>Qt(be,`${Pe??""} data layer(s) selected`),[()=>lr.getAllSelections().length]),R(X,ae)},ie=X=>{var ae=Ol();R(X,ae)};qe(U,X=>{lr.getAllSelections().length>0?X(Z):X(ie,!1)})}J(j),Tt(X=>Qt(H,X),[()=>n.areaSelectionTreeviewStore.initialized?n.areaSelectionTreeviewStore.getVisibleNodes()[0]?.name:"Loading..."]),R(A,F),ft()}function Ml(A,n){A.target===A.currentTarget&&n()}var Nl=(A,n)=>A.key==="Escape"&&n(),Ll=(A,n,u)=>n(f(u).name),Dl=ye('<div class="info-icon-container svelte-fp5rsc"><!></div>'),ql=ye('<div class="field-content-wrapper svelte-fp5rsc"><!> <button class="field-content svelte-fp5rsc" tabindex="0"><div class="field-name-container svelte-fp5rsc"><span class="field-name svelte-fp5rsc"> </span> <!></div></button></div>'),Fl=ye('<div class="master-checkbox-container svelte-fp5rsc"><!> <span class="master-checkbox-label svelte-fp5rsc">Select All Fields</span></div> <!> <!>',1),Rl=ye("<!> <!>",1),jl=ye("<!> <!>",1),Hl=ye('<button class="close-button svelte-fp5rsc" aria-label="Close"><!></button> <!>',1),zl=ye('<div class="card-container svelte-fp5rsc" role="dialog" aria-modal="true" tabindex="-1"><!></div>');function Bl(A,n){dt(n,!0);const u=nt(n,"fieldFilterMenuStore",7);let c=we(null),p=we(Ct(new Vn)),g=Le(()=>{if(!f(c)||!f(c).fields)return{checked:!1,indeterminate:!1};const z=f(c).fields.length,j=f(p)?.size||0;return j===0?{checked:!1,indeterminate:!1}:j===z?{checked:!0,indeterminate:!1}:{checked:!1,indeterminate:!0}});Dt(()=>{const z=u().ActiveLayer;if(!z){te(c,null),te(p,new Vn,!0);return}te(c,z,!0);const j=lr.getSelection(z.id);j?.fields?te(p,new Vn([...j.fields]),!0):te(p,new Vn,!0)});function b(){C(),u().ActiveLayer=null}function C(){if(!f(c))return;let z=lr.getSelection(f(c).id);if(z){if((z.fields===void 0||z.fields===null)&&(z.fields=new Vn),f(p).size===0){lr.removeSelection(f(c).id);return}z.fields.clear(),f(p).forEach(j=>{z.fields?.add(j)})}}function F(z){f(c)&&(f(p).has(z)?f(p).delete(z):f(p).add(z))}function v(){if(!f(c)?.fields)return;(f(p)?.size||0)===0?f(c).fields.forEach(j=>{f(p).add(j.name)}):f(p).clear()}function N(){if(!f(c)?.fields)return[];const z=f(c).fields.filter(j=>!n.fieldsToHide.has(j.name.toLowerCase()));return console.log("Filtered fields to show:",z,n.fieldsToHide,f(c).fields),z}var H=Ce(),V=le(H);{var Q=z=>{var j=zl();j.__click=[Ml,b],j.__keydown=[Nl,b];var U=re(j);at(U,()=>va,(Z,ie)=>{ie(Z,{class:"command-card",children:(X,ae)=>{var Ae=Hl(),de=le(Ae);de.__click=b;var be=re(de);bo(be,{size:20}),J(de);var Pe=Ee(de,2);at(Pe,()=>Gi,(Ke,oe)=>{oe(Ke,{class:"card-content",children:(ue,ve)=>{var G=Ce(),xe=le(G);at(xe,()=>wo,(De,ge)=>{ge(De,{children:(ze,We)=>{var je=jl(),Me=le(je);at(Me,()=>_o,(Ze,Ye)=>{Ye(Ze,{placeholder:"Search for fields..."})});var Je=Ee(Me,2);at(Je,()=>So,(Ze,Ye)=>{Ye(Ze,{children:(Mt,bt)=>{var vt=Rl(),st=le(vt);at(st,()=>xo,(Y,et)=>{et(Y,{children:(wt,Oe)=>{kn();var yt=$n("No results found.");R(wt,yt)},$$slots:{default:!0}})});var _e=Ee(st,2);at(_e,()=>ko,(Y,et)=>{et(Y,{heading:"Fields",children:(wt,Oe)=>{var yt=Fl(),pt=le(yt),It=re(pt);ya(It,{get checked(){return f(g).checked},get indeterminate(){return f(g).indeterminate},onCheckedChange:v}),kn(2),J(pt);var Ve=Ee(pt,2);at(Ve,()=>Uo,(qt,lt)=>{lt(qt,{})});var Ht=Ee(Ve,2);Hr(Ht,17,N,Qn,(qt,lt)=>{var _t=Ce(),ot=le(_t);at(ot,()=>Co,(Ut,Kt)=>{Kt(Ut,{class:"field-item",onselect:()=>F(f(lt).name),children:(pr,er)=>{var Ft=ql(),jt=re(Ft);{let Re=Le(()=>f(p)?.has(f(lt).name)??!1);ya(jt,{class:"field-checkbox",get checked(){return f(Re)},onCheckedChange:()=>F(f(lt).name)})}var Tr=Ee(jt,2);Tr.__click=[Ll,F,lt];var kr=re(Tr),Mr=re(kr),Wr=re(Mr,!0);J(Mr);var Cr=Ee(Mr,2);{var Gr=Re=>{var $t=Dl(),Ie=re($t);bi(Ie,()=>$o),J($t),Tt(()=>Vi($t,"title",f(lt).description)),R(Re,$t)};qe(Cr,Re=>{f(lt).description&&Re(Gr)})}J(kr),J(Tr),J(Ft),Tt(()=>Qt(Wr,f(lt).alias||f(lt).name)),R(pr,Ft)},$$slots:{default:!0}})}),R(qt,_t)}),R(wt,yt)},$$slots:{default:!0}})}),R(Mt,vt)},$$slots:{default:!0}})}),R(ze,je)},$$slots:{default:!0}})}),R(ue,G)},$$slots:{default:!0}})}),R(X,Ae)},$$slots:{default:!0}})}),J(j),R(z,j)};qe(V,z=>{f(c)&&z(Q)})}R(A,H),ft()}Qi(["click","keydown"]);class Ua{id;name;children;parent;constructor(n,u,c=[],p=null){this.id=n,this.name=u,this.children=c,this.parent=p}}class Bt extends Ua{layer;constructor(n,u,c,p=[],g=null){super(n,u,p,g),this.layer=c}}class Yn extends Bt{featureLayer;field;constructor(n,u,c,p,g=[],b=null){super(n,u,c,g,b),this.field=p,this.featureLayer=c}}var Pt=(A=>(A.Inactive="inactive",A.Indeterminate="indeterminate",A.Active="active",A))(Pt||{});class $a{#e=we(!1);get initialized(){return f(this.#e)}set initialized(n){te(this.#e,n,!0)}#t=null;#r=we(Ct([]));#i=Le(()=>{const n=new jr;return this.#b(f(this.#r),n),n});#n=we(Ct(new jr));#o=we(Ct(new jr));#u=we(Ct(new jr));initialize(n,u,c){if(this.initialized)throw new Error("TreeviewStore is already initialized.");if(this.initialized=!0,!u)throw new Error("TreeviewStore requires a valid TreeviewConfigStore to initialize.");if(this.#t=u,c)for(const p of c)f(this.#u).set(p.id,p);if(!n)throw new Error("TreeviewStore requires a valid array of layers to initialize.");this.#a(n),te(this.#r,this.#m(n),!0)}getNodeById(n){return this.#c(),f(this.#i).get(n)}getNodes(){return this.#c(),f(this.#r)}getVisibleNodes(){this.#c();const n=[];for(const[u,c]of f(this.#n)){if(!c)continue;const p=f(this.#i).get(u);p&&n.push(p)}return n}getNonHiddenNodes(){return this.#c(),this.#d(f(this.#r))}#d(n){this.#c();const u=[];for(const c of n){const p=this.#l(c.id);if(!(p&&p.isHidden)&&(u.push(c),c.children?.length)){const g=this.#d(c.children);u.push(...g)}}return u}getVisibilityState(n){return this.#c(),f(this.#n).get(n)??!1}setVisibilityState(n,u){this.#c();const c=f(this.#i).get(n);if(!c)throw new Error(`Tree node not found for ID: ${n}`);if(!(c instanceof Bt))throw new Error(`Tree node is not a layer node: ${n}`);const p=this.#l(n);if(p?.disableVisibilityToggle||(f(this.#n).set(n,u),c.layer.visible=u,c instanceof Yn&&(c.featureLayer.displayField=u?c.field.name:""),this.#s(c,u),!p||p.isHidden)||(p.visibilityDependencyIds?.length&&this.#f(c,u),!p.visibilityGroupId))return;const g=p.visibilityGroupId;let b=f(this.#o).get(g);b||(b=[],f(this.#o).set(g,b));const C=this.#h(g);if(!C)throw new Error(`Visibility group config not found for group ID: ${g}`);if(!u){const v=b.indexOf(n);b.splice(v,1);return}const F=v=>{f(this.#n).set(v,!1);const N=f(this.#i).get(v);if(N&&N instanceof Bt){N.layer.visible=!1,this.#s(N,!1);const V=this.#l(v);V&&V.visibilityDependencyIds?.length&&this.#f(N,!1)}const H=b.indexOf(v);H>=0&&b.splice(H,1)};for(;b.length>=C.maxVisibleLayers;){const v=b[0];F(v)}b.push(n),this.#s(c,u),p.visibilityDependencyIds?.length&&this.#f(c,u)}cleanup(){this.initialized=!1,f(this.#n).clear(),f(this.#o).clear(),f(this.#u).clear(),te(this.#r,[],!0),f(this.#i).clear()}#s(n,u){const c=n.parent;if(c){if(!(c instanceof Bt)){this.#s(c,u);return}f(this.#n).set(c.id,u),c.layer.visible=u,this.#s(c,u)}}#f(n,u){const c=this.#l(n.id);if(c&&c.visibilityDependencyIds?.length)for(const p of c.visibilityDependencyIds){const g=f(this.#i).get(p);g&&g instanceof Bt&&(f(this.#n).set(p,u),g.layer.visible=u,this.#s(g,u))}}#h(n){if(n&&this.#t)return this.#t.getVisibilityGroupConfig(n)}#a(n){this.#t&&this.#t.resolveInheritance(n)}#m(n){const u=n.map(c=>this.#p(c,void 0));return this.#v([...u])}#l(n){if(n&&this.#t)return this.#t.getItemConfig(n)}#v(n){n.reverse();for(const u of n)u.children?.length&&this.#v(u.children);return n}#p(n,u){const c=this.#l(n.id);if(c&&c.customConverterId){if(!f(this.#u).has(c.customConverterId))throw new Error(`Custom converter not found: ${c.customConverterId}`);const g=f(this.#u).get(c.customConverterId);if(!g)throw new Error(`Custom converter not found: ${c.customConverterId}`);return g.layerToNode(n,u??null)}const p=new Bt(n.id,n.title,n,[],u);if(n.visible=c?.disableVisibilityToggle?n.visible:c?.isHidden?!1:c?.isVisibleOnInit??!1,f(this.#n).set(n.id,n.visible),this.#x(n)&&c?.showFields){const g=n;g.loaded||console.warn(`Layer not loaded: ${n.id}`);for(const b of g.fields??[]){const C=this.#g(b,p);p.children.push(C)}}if(this.#S(n)){const g=n;return p.children=g.layers.toArray().map(b=>this.#p(b,p)),p}if(this.#w(n)){const g=n;if(g.sublayers&&g.sublayers.length>0){const b=g.sublayers;p.children=b.toArray().map(this.#y)}}return p}#g(n,u){const c=this.#_(u.id,n.name),p=new Yn(c,n.alias||n.name,u.layer,n,[],u),g=this.#l(c);return f(this.#n).set(c,g?.isVisibleOnInit??!1),p}#w(n){return n.type==="map-image"||n.type==="wms"}#y(n){const u=new Bt(n.uid,n.title,n);return n.sublayers?.length&&(u.children=n.sublayers.toArray().map(this.#y)),u}#b(n,u){for(const c of n)u.set(c.id,c),c.children?.length&&this.#b(c.children,u)}#_(n,u){return`${n}-${u}`}#S(n){return n.type==="group"}#x(n){return n.type==="feature"}#c(){if(!this.initialized)throw new Error("TreeviewStore is not initialized. Call initialize() first.")}}const Kl='<path d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/>',Vl='<path d="M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/>',Ul='<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14,2 14,8 20,8"/>',Wa=(A,n,u,c)=>n?$l(A,u):u?c?Kl:Vl:Ul,$l=(A,n)=>{switch(A.type){case"group":return ba;case"feature":return wa;case"tile":return Wo;default:return n?ba:wa}};function Wl(A){const n=A-1;return n*n*n+1}var Gl=ye('<div class="relative ml-4 w-full"><div class="tree-guide-line svelte-1y72o5r"></div> <div class="tree-children svelte-1y72o5r"></div></div>'),Ql=ye('<div class="w-full"><!> <!></div>');function Ga(A,n){const u=nt(n,"isOpen",3,!1),c=nt(n,"childNodes",3,null),p=nt(n,"duration",3,300);var g=Ql(),b=re(g);xt(b,()=>n.content??Et);var C=Ee(b,2);{var F=v=>{var N=Gl(),H=Ee(re(N),2);Hr(H,21,()=>c()??[],V=>V.id,(V,Q)=>{var z=Ce(),j=le(z);xt(j,()=>n.childNode??Et,()=>f(Q)),R(V,z)}),J(H),J(N),Ui(1,H,()=>Ia,()=>({duration:p(),easing:Wl})),Ui(2,H,()=>Ia,()=>({duration:p()})),R(v,N)};qe(C,v=>{u()&&c()&&v(F)})}J(g),R(A,g)}const ca="mb-1 cursor-pointer rounded-md border border-border p-2 text-left",da="transform-gpu transition-all duration-150 ease-out hover:border-border/50 hover:bg-gray-100 hover:shadow-sm",Yl="transition-colors hover:bg-blue-500",fa="text-sm font-normal",ha="bg-card",Qa="bg-accent text-accent-foreground",Xl="!h-auto !min-h-9 !whitespace-normal data-[state=on]:!bg-accent data-[state=on]:!text-accent-foreground data-[state=on]:hover:!bg-accent data-[state=on]:hover:!text-accent-foreground";function Jl(A={}){const{enhancedHover:n=!1,includeFont:u=!1,pressed:c=!1}=A;let p=ca;return n?p+=" "+da:p+=" "+Yl,u&&(p+=" "+fa),c?p+=" "+Qa:p+=" "+ha,p}var Zl=ye('<div class="flex w-full !items-center !justify-between gap-2"><div class="pointer-events-none !flex min-w-0 flex-1 !items-center gap-1"><span class="inline-block size-4" aria-hidden="true"><!></span> <span class="block w-full text-left break-words"> </span></div> <!></div>'),eu=ye('<button><div class="flex w-full items-center justify-between gap-2"><div class="pointer-events-none flex min-w-0 flex-1 items-center gap-1"><!> <span class="inline-block size-4" aria-hidden="true"><!></span> <span class="block w-full text-left break-words"> </span></div> <!></div></button>');function Pa(A,n){const u=`calc(100% - ${n.depth*1}rem)`,c=`${ca} ${da} ${Xl} ${ha} ${fa}`,p=`${ca} ${da} ${fa}`;var g=Ce(),b=le(g);{var C=v=>{Go(v,{get pressed(){return n.pressed},get class(){return c},variant:"outline",get style(){return`width: ${u};`},get onPressedChange(){return n.onclick},children:(N,H)=>{var V=Zl(),Q=re(V),z=re(Q),j=re(z);bi(j,()=>n.icon),J(z);var U=Ee(z,2),Z=re(U,!0);J(U),J(Q);var ie=Ee(Q,2);xt(ie,()=>n.children??Et),J(V),Tt(()=>Qt(Z,n.name)),R(N,V)},$$slots:{default:!0}})},F=v=>{var N=eu();N.__click=function(...X){n.onclick?.apply(this,X)};var H=re(N),V=re(H),Q=re(V);Ha(Q,{get isOpen(){return n.isOpen}});var z=Ee(Q,2),j=re(z);bi(j,()=>n.icon),J(z);var U=Ee(z,2),Z=re(U,!0);J(U),J(V);var ie=Ee(V,2);xt(ie,()=>n.children??Et),J(H),J(N),Tt(()=>{nn(N,1,`${p} ${n.pressed?Qa:ha}`),Gn(N,`width: ${u};`),Qt(Z,n.name)}),R(v,N)};qe(b,v=>{n.isTogglable?v(C):v(F,!1)})}R(A,g)}Qi(["click"]);function Ya(A,n){dt(n,!0);const u=j=>{var U=Ce(),Z=le(U);{var ie=X=>{var ae=Ce(),Ae=le(ae);{var de=Pe=>{Pa(Pe,{isTogglable:!1,get pressed(){return f(v)},get icon(){return f(N)},get name(){return n.node.name},get depth(){return p()},onclick:z,get isOpen(){return f(F)}})},be=Pe=>{Pa(Pe,{isTogglable:!0,get pressed(){return f(v)},get icon(){return f(N)},get name(){return n.node.name},get depth(){return p()},onclick:Q,get isOpen(){return f(F)}})};qe(Ae,Pe=>{b?Pe(de):Pe(be,!1)})}R(X,ae)};qe(Z,X=>{n.treeviewConfigStore.getItemConfig(n.node.id)?.isHidden||X(ie)})}R(j,U)},c=(j,U=Et)=>{var Z=Ce(),ie=le(Z);{var X=ae=>{{let Ae=Le(()=>p()+1);Ya(ae,{get treeviewConfigStore(){return n.treeviewConfigStore},get node(){return U()},get onNodeClick(){return n.onNodeClick},get onNodeVisibilityChange(){return n.onNodeVisibilityChange},get getNodeVisibility(){return n.getNodeVisibility},get depth(){return f(Ae)},get useLayerTypeIcon(){return g()}})}};qe(ie,ae=>{b&&f(F)&&!n.treeviewConfigStore.getItemConfig(U().id)?.isHidden&&ae(X)})}R(j,Z)},p=nt(n,"depth",3,0),g=nt(n,"useLayerTypeIcon",3,!1),b=!!(n.node.children&&n.node.children.length),C=!b;let F=we(!1),v=we(!1),N=we("");function H(){return!n.node.children||!n.getNodeVisibility?!1:n.node.children.some(j=>{const U=n.getNodeVisibility(j.id);return U!==void 0?U:j instanceof Bt?j.layer.visible:!1})}Dt(()=>{if(!(!n.node||!(n.node instanceof Bt))){if(b)te(v,H(),!0);else{const j=n.getNodeVisibility?n.getNodeVisibility(n.node.id):void 0;te(v,j!==void 0?j:n.node.layer.visible,!0)}te(N,Wa(n.node.layer,g(),b,f(F)),!0)}});function V(){!C||!n.onNodeVisibilityChange||b||(te(v,!f(v)),n.onNodeVisibilityChange(n.node,f(v)))}function Q(){b||V(),n.onNodeClick?.(n.node)}function z(){te(F,!f(F)),n.onNodeClick?.(n.node)}{let j=Le(()=>b?n.node.children:null);Ga(A,{get isOpen(){return f(F)},get content(){return u},get childNodes(){return f(j)},get childNode(){return c}})}ft()}function tu(A,n){dt(n,!0);const u=nt(n,"webMap",3,null);Dt(()=>{!u()||n.treeviewStore.initialized||n.treeviewStore.initialize(u().layers.toArray(),n.treeviewConfigStore)});var c=Ce(),p=le(c);{var g=b=>{var C=Ce(),F=le(C);at(F,()=>za,(v,N)=>{N(v,{children:(H,V)=>{var Q=Ce(),z=le(Q);Hr(z,17,()=>n.treeviewStore.getNodes(),j=>j.id,(j,U)=>{Ya(j,{get treeviewConfigStore(){return n.treeviewConfigStore},get node(){return f(U)},onNodeClick:()=>{},onNodeVisibilityChange:(Z,ie)=>n.treeviewStore.setVisibilityState(Z.id,ie),getNodeVisibility:Z=>n.treeviewStore.getVisibilityState(Z),depth:0,useLayerTypeIcon:!0})}),R(H,Q)},$$slots:{default:!0}})}),R(b,C)};qe(p,b=>{n.treeviewStore.initialized&&b(g)})}R(A,c),ft()}class ru{configStore;constructor(n){this.configStore=n}}function nu(A){return A.replace(/&deg;/gi,"°").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&lt;/gi,"<").replace(/&gt;/gi,">")}class iu extends ru{id="aliasPath";layerToNode(n,u){const c=new Bt(n.id,n.title,n,[],u),p=this.configStore.getItemConfig(n.id);if(this.#r(n)&&p?.showFields){const g=n;g.loaded||console.warn(`Layer not loaded: ${n.id}`);const b=new Map;for(const C of g.fields??[]){const F=this.configStore.getItemConfig(this.#t(n.id,C.name));!F||F.isHidden||this.#e(C,c,b)}c.children.sort((C,F)=>C.children.length>0&&F.children.length===0?1:C.children.length===0&&F.children.length>0?-1:0)}return c}#e(n,u,c=new Map){const p=this.#t(u.id,n.name),b=nu(n.alias||"")?.split("|").map(V=>V.trim()).filter(Boolean)??[];if(b.length===0){const V=new Yn(p,n.alias||n.name,u.layer,n,[],u);return u.children.push(V),V}const C=b.slice(0,-1),F=b[b.length-1];let v=u;const N=(V,Q)=>{V.children??=[],V.children.includes(Q)||V.children.push(Q)};for(let V=0;V<C.length;V++){const Q=C[V],z=b.slice(0,V+1).join("::"),j=`${u.id}::${z}`;let U=c.get(j);U||(U=new Ua(j,Q,[],v),c.set(j,U),N(v,U)),v=U}const H=new Yn(p,F||n.name,u.layer,n,[],v);return N(v,H),H}#t(n,u){return`${n}-${u}`}#r(n){return n.type==="feature"}}class Ta{#e=[];#t=new Map;#r=[];#i=new Map;#n=[];#o=new Map;#u=new Set;constructor(n){if(!n)throw new Error("TreeviewConfigStore requires a valid configuration object.");this.#e=n.items??[],this.#t=new Map(this.#e.map(u=>[u.id,u])),this.#r=n.visibilityGroups??[],this.#i=new Map(this.#r.map(u=>[u.id,u])),this.#n=n.inheritanceGroups??[],this.#o=new Map(this.#n.map(u=>[u.id,u])),n.fieldsToHide&&(this.#u=new Set(n.fieldsToHide.map(u=>u.trim().toLowerCase())))}getItemConfig(n){return this.#t.get(n)}getVisibilityGroupConfig(n){return this.#i.get(n)}getInheritanceGroupConfig(n){return this.#o.get(n)}resolveInheritance(n){if(!(n.length===0||!this.#e||this.#e.length===0))for(const u of n){const c=this.getItemConfig(u.id);this.#d(u,c)}}#d(n,u){const c=this.#s(n,u);if(this.#g(n)&&c.showFields){const p=n;p.loaded||console.warn(`Layer not loaded: ${n.id}`);for(const g of p.fields??[])this.#f(this.#v(n.id,g.name),g.alias||g.name,c)}if(this.#p(n)){const p=n;for(const g of p.layers.toArray())this.#d(g,c)}}#s(n,u){const c=this.#h(n.id,u);return c.type===Ri.None&&(c.type=Qo(n)),c}#f(n,u,c){const p=this.#h(n,c);return p.type===Ri.None&&(p.type=Ri.Field),this.#u.has(u.trim().toLowerCase())&&(p.isHidden=!0),p}#h(n,u){let c=this.getItemConfig(n);const p=c?.inheritanceGroupId?this.getInheritanceGroupConfig(c.inheritanceGroupId):this.getInheritanceGroupConfig(u?.inheritanceGroupId??"");return c={id:n,type:Ri.None,isDownloadable:this.#a(p,"isDownloadable",c,u,!0),isVisibleOnInit:this.#a(p,"isVisibleOnInit",c,u,!1),isHidden:this.#a(p,"isHidden",c,u,!1),disableVisibilityToggle:this.#a(p,"disableVisibilityToggle",c,u,!1),isOpenOnInit:this.#a(p,"isOpenOnInit",c,u,!1),showFields:this.#a(p,"showFields",c,u,!1),visibilityDependencyIds:this.#a(p,"visibilityDependencyIds",c,u,[]),visibilityGroupId:this.#a(p,"visibilityGroupId",c,u,void 0),customConverterId:this.#a(p,"customConverterId",c,u,void 0),inheritanceGroupId:this.#a(p,"inheritanceGroupId",c,u,void 0)},this.#l(c),this.#m(c),c}#a(n,u,c,p,g){const b=c?.[u];return b!==void 0?b:n?.inheritedProperties.includes(u)&&p?p[u]??g:g}#m(n){if(this.#t.has(n.id))throw new Error(`Item with id ${n.id} already exists.`);this.#e.push(n),this.#t.set(n.id,n)}#l(n){this.#t.has(n.id)&&(this.#e=this.#e.filter(u=>u.id!==n.id),this.#t.delete(n.id))}#v(n,u){return`${n}-${u}`}#p(n){return n.type==="group"}#g(n){return n.type==="feature"}}var au=ye('<div data-slot="checkbox-indicator" class="text-current transition-none"><!></div>');function ou(A,n){dt(n,!0);let u=nt(n,"ref",15,null),c=nt(n,"checked",11,!1),p=nt(n,"indeterminate",11,!1),g=vr(n,["$$slots","$$events","$$legacy","ref","checked","indeterminate","class"]),b=we(Ct(c())),C=we(Ct(p()));Dt(()=>{te(b,c())}),Dt(()=>{te(C,p())});var F=Ce(),v=le(F);{const N=(V,Q)=>{let z=()=>Q?.().checked,j=()=>Q?.().indeterminate;var U=au(),Z=re(U);{var ie=ae=>{ks(ae,{class:"size-3.5"})},X=ae=>{var Ae=Ce(),de=le(Ae);{var be=Pe=>{Xo(Pe,{class:"size-3.5"})};qe(de,Pe=>{j()&&Pe(be)},!0)}R(ae,Ae)};qe(Z,ae=>{z()?ae(ie):ae(X,!1)})}J(U),R(V,U)};let H=Le(()=>Do("peer flex size-4 shrink-0 items-center justify-center rounded-[4px] border border-input shadow-xs transition-shadow outline-none focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50 disabled:cursor-not-allowed disabled:opacity-50 aria-invalid:border-destructive aria-invalid:ring-destructive/20 data-[state=checked]:border-primary data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:bg-input/30 dark:aria-invalid:ring-destructive/40 dark:data-[state=checked]:bg-primary",n.class));at(v,()=>Yo,(V,Q)=>{Q(V,ur({"data-slot":"checkbox",get class(){return f(H)}},()=>g,{get ref(){return u()},set ref(z){u(z)},get checked(){return f(b)},set checked(z){te(b,z,!0)},get indeterminate(){return f(C)},set indeterminate(z){te(C,z,!0)},children:N,$$slots:{default:!0}}))})}R(A,F),ft()}var su=ye("<div><!></div>");function Ma(A,n){dt(n,!0);let u=Le(()=>n.getDownloadState?.(n.node)??Pt.Inactive),c=Le(()=>f(u)===Pt.Active),p=Le(()=>f(u)===Pt.Indeterminate);function g(F){F.stopPropagation();const v=f(u)===Pt.Active?Pt.Inactive:Pt.Active;n.onDownloadStateChanged?.(n.node,v)}var b=su(),C=re(b);ou(C,{get checked(){return f(c)},get indeterminate(){return f(p)},onclick:g}),J(b),R(A,b),ft()}var lu=ye('<button><div class="flex w-full items-center justify-between gap-2"><div class="pointer-events-none flex min-w-0 flex-1 items-center gap-1"><!> <span class="inline-block size-4" aria-hidden="true"><!></span> <span class="block w-full text-left break-words"> </span></div> <!></div></button>');function Na(A,n){dt(n,!0);const u=nt(n,"isFolder",3,!1),c=nt(n,"isOpen",3,!1),p=`calc(100% - ${n.depth*1}rem)`;var g=lu();g.__click=function(...j){n.onclick?.apply(this,j)};var b=re(g),C=re(b),F=re(C);{var v=j=>{Ha(j,{get isOpen(){return c()}})};qe(F,j=>{u()&&j(v)})}var N=Ee(F,2),H=re(N);bi(H,()=>n.icon),J(N);var V=Ee(N,2),Q=re(V,!0);J(V),J(C);var z=Ee(C,2);xt(z,()=>n.children??Et),J(b),J(g),Tt(j=>{nn(g,1,j),Gn(g,`width: ${p};`),Qt(Q,n.name)},[()=>go(Jl({enhancedHover:!0,includeFont:!0}))]),R(A,g),ft()}Qi(["click"]);var uu=ye('<div class="flex items-center gap-2"><!> <!></div>'),cu=ye('<div class="flex items-center gap-2"><!> <!></div>');function Xa(A,n){dt(n,!0);const u=ie=>{var X=Ce(),ae=le(X);{var Ae=de=>{var be=Ce(),Pe=le(be);{var Ke=ue=>{Na(ue,{get icon(){return f(V)},get name(){return n.node.name},get depth(){return g()},onclick:Z,get isFolder(){return C},get isOpen(){return f(N)},children:G=>{var xe=uu(),De=re(xe);{var ge=je=>{Ma(je,{get node(){return n.node},get onDownloadStateChanged(){return n.onDownloadStateChanged},get getDownloadState(){return n.getDownloadState}})};qe(De,je=>{n.isDownloadable&&je(ge)})}var ze=Ee(De,2);{var We=je=>{_a(je,{get checked(){return f(H)},onCheckedChange:j})};qe(ze,je=>{F&&je(We)})}J(xe),R(G,xe)},$$slots:{default:!0}})},oe=ue=>{Na(ue,{get icon(){return f(V)},get name(){return n.node.name},get depth(){return g()},onclick:U,get isFolder(){return C},children:G=>{var xe=cu(),De=re(xe);{var ge=je=>{Ma(je,{get node(){return n.node},get onDownloadStateChanged(){return n.onDownloadStateChanged},get getDownloadState(){return n.getDownloadState}})};qe(De,je=>{n.isDownloadable&&je(ge)})}var ze=Ee(De,2);{var We=je=>{_a(je,{get checked(){return f(H)},onCheckedChange:j})};qe(ze,je=>{F&&je(We)})}J(xe),R(G,xe)},$$slots:{default:!0}})};qe(Pe,ue=>{C?ue(Ke):ue(oe,!1)})}R(de,be)};qe(ae,de=>{p()?.getItemConfig(n.node.id)?.isHidden||de(Ae)})}R(ie,X)},c=(ie,X=Et)=>{var ae=Ce(),Ae=le(ae);{var de=be=>{{let Pe=Le(()=>p()?.getItemConfig(X().id)?.isDownloadable??!0),Ke=Le(()=>g()+1);Xa(be,{get treeviewConfigStore(){return p()},get node(){return X()},get isDownloadable(){return f(Pe)},get onNodeClick(){return n.onNodeClick},get onNodeVisibilityChange(){return n.onNodeVisibilityChange},get onDownloadStateChanged(){return n.onDownloadStateChanged},get getDownloadState(){return n.getDownloadState},get onFilterClicked(){return n.onFilterClicked},get hasFiltersApplied(){return n.hasFiltersApplied},get getNodeVisibility(){return n.getNodeVisibility},get depth(){return f(Ke)},get useLayerTypeIcon(){return b()}})}};qe(Ae,be=>{C&&f(N)&&!p()?.getItemConfig(X().id)?.isHidden&&be(de)})}R(ie,ae)},p=nt(n,"treeviewConfigStore",3,null),g=nt(n,"depth",3,0),b=nt(n,"useLayerTypeIcon",3,!1),C=!!(n.node.children&&n.node.children.length),F=!C;let v=!1,N=we(!1),H=we(!1),V=we(""),Q=we(!1),z=we(!1);Dt(()=>{v||(te(N,p()?.getItemConfig(n.node.id)?.isOpenOnInit??!1,!0),v=!0)}),Dt(()=>{if(!n.node)return;const ie=n.getNodeVisibility?n.getNodeVisibility(n.node.id):!1;te(H,ie??!1,!0),n.node instanceof Bt&&te(V,Wa(n.node.layer,b(),C,f(N)),!0)}),Dt(()=>{if(!(n.node instanceof Bt))return;const ie=(n.getDownloadState?.(n.node)===Pt.Active&&n.node.layer.type==="feature")??!1;ie&&!f(Q)?(te(Q,!0),te(z,!1)):!ie&&f(Q)&&(te(z,!0),setTimeout(()=>{te(Q,!1),te(z,!1)},180))});function j(){!F||!n.onNodeVisibilityChange||(te(H,!f(H)),n.onNodeVisibilityChange(n.node,f(H)))}function U(){n.onNodeClick?.(n.node)}function Z(){te(N,!f(N)),n.onNodeClick?.(n.node)}{let ie=Le(()=>C?n.node.children:null);Ga(A,{get isOpen(){return f(N)},get content(){return u},get childNodes(){return f(ie)},get childNode(){return c}})}ft()}class du{#e;#t;constructor(n,u){this.#e=n,this.#t=u}updateSelection(n,u){if(!this.#t.getItemConfig(n.id)?.isHidden){if(!(n instanceof Bt)){this.updateChildrenSelection(n,u);return}if(n instanceof Yn){this.updateFieldSelection(n,u);return}this.updateLayerSelection(n,u)}}getSelectionState(n){if(!(n instanceof Bt))return this.determineSelectionStateFromChildren(n);if(this.isGroupLayer(n))return this.determineSelectionStateFromChildren(n);let u;return n instanceof Yn?(u=this.#e.getSelection(n.featureLayer.id),u&&u.fields.has(n.field.name)?Pt.Active:Pt.Inactive):(u=this.#e.getSelection(n.id),u?this.isFeatureLayer(n)&&n.children&&n.children.length>0?this.determineSelectionStateFromChildren(n):Pt.Active:Pt.Inactive)}updateLayerSelection(n,u){let c=this.#e.getSelection(n.id);switch(u){case Pt.Active:!c&&!this.isGroupLayer(n)&&(c=this.createAndAddDataSelection(n.id,n.layer));for(const p of n.children||[])this.updateSelection(p,u);break;case Pt.Inactive:c&&!this.isGroupLayer(n)&&this.#e.removeSelection(n.id),this.updateChildrenSelection(n,u);break}}updateFieldSelection(n,u){let c=this.#e.getSelection(n.featureLayer.id);switch(u){case Pt.Active:c||(c=this.createAndAddDataSelection(n.featureLayer.id,n.featureLayer)),c.fields.add(n.field.name);break;case Pt.Inactive:if(!c)break;c.fields.delete(n.field.name),c.fields.size===0&&this.#e.removeSelection(c.layerId);break}}updateChildrenSelection(n,u){for(const c of n.children||[])this.updateSelection(c,u)}determineSelectionStateFromChildren(n){let u=0,c=0;for(const p of n.children||[]){if(this.#t.getItemConfig(p.id)?.isHidden)continue;c++;const b=this.getSelectionState(p);if(b===Pt.Active||this.isFeatureLayer(p)&&b!==Pt.Inactive)u++;else if(b===Pt.Indeterminate)return Pt.Indeterminate}return u===0?Pt.Inactive:u===c?Pt.Active:Pt.Indeterminate}createAndAddDataSelection(n,u){const c={layerId:n,layer:u,fields:new Vn};return this.#e.addSelection(c),c}isGroupLayer(n){return n instanceof Bt&&n.layer.type==="group"}isFeatureLayer(n){return n instanceof Bt&&n.layer.type==="feature"}}function fu(A,n){dt(n,!0);const u=nt(n,"webMap",3,null),c=nt(n,"fieldFilterMenuStore",7),p=new $a,g=new du(lr,n.treeviewConfigStore);Dt(()=>{if(!u()||p.initialized)return;(async()=>{await u().when(),await b(u().layers.toArray());const j=new iu(n.treeviewConfigStore);p.initialize(u().layers.toArray(),n.treeviewConfigStore,[j])})()});async function b(z){for(const j of z)j.type==="feature"&&!j.loaded&&(await j.load(),console.log("Loaded feature layer:",j.title)),j.type==="group"&&await b(j.layers.toArray())}function C(z,j){g.updateSelection(z,j)}function F(z){return g.getSelectionState(z)}function v(z){if(c().ActiveLayer?.uid===z){c().ActiveLayer=null;return}const U=p.getNodeById(z);!U||!(U instanceof Bt)||(c().ActiveLayer=U.layer)}function N(z){const j=lr.getSelection(z);if(!j?.fields)return!1;const U=p.getNodeById(z);if(!U||!(U instanceof Bt))return!1;const Z=U.layer.fields?.length||0,ie=j.fields.size;return ie>0&&ie!==Z}var H=Ce(),V=le(H);{var Q=z=>{var j=Ce(),U=le(j);at(U,()=>za,(Z,ie)=>{ie(Z,{children:(X,ae)=>{var Ae=Ce(),de=le(Ae);Hr(de,17,()=>p.getNodes(),be=>be.id,(be,Pe)=>{{let Ke=Le(()=>n.treeviewConfigStore.getItemConfig(f(Pe).id)?.isDownloadable??!0);Xa(be,{get treeviewConfigStore(){return n.treeviewConfigStore},get node(){return f(Pe)},get isDownloadable(){return f(Ke)},onNodeClick:()=>{},onNodeVisibilityChange:(oe,ue)=>p.setVisibilityState(oe.id,ue),getNodeVisibility:oe=>p.getVisibilityState(oe),onDownloadStateChanged:C,getDownloadState:F,onFilterClicked:v,hasFiltersApplied:N,depth:0,useLayerTypeIcon:!0})}}),R(X,Ae)},$$slots:{default:!0}})}),R(z,j)};qe(V,z=>{p.initialized&&z(Q)})}R(A,H),ft()}class hu{#e=we(null);get mapView(){return f(this.#e)}set mapView(n){te(this.#e,n,!0)}#t=we(Ct(new Set));get interactableLayers(){return f(this.#t)}set interactableLayers(n){te(this.#t,n,!0)}pointerMoveHandle=null;clickHandle=null;leaveHandle=null;enterHandle=null;#r=we(!1);get isInitialized(){return f(this.#r)}set isInitialized(n){te(this.#r,n,!0)}#i=we(!0);get pointerInsideMap(){return f(this.#i)}set pointerInsideMap(n){te(this.#i,n,!0)}initializationInProgress=!1;async initializeAsync(n,u){if(console.log("[map-interaction-store] Initializing with MapView"),this.mapView===n&&this.isInitialized){console.log("[map-interaction-store] MapView is already initialized"),this.interactableLayers=u;return}if(this.initializationInProgress){console.log("[map-interaction-store] Initialization already in progress");return}this.initializationInProgress=!0,console.log("[map-interaction-store] Cleaning up previous MapView if any"),this.cleanup(),this.mapView=n,this.interactableLayers=u,await n.when(),this.setupHighlights(n),this.setupPointerMoveHandler(n),this.setupClickHandler(n),this.setupLeaveHandler(n),this.setupEnterHandler(n),this.isInitialized=!0,console.log("[map-interaction-store] Initialized with MapView"),this.initializationInProgress=!1}updateInteractableLayers(n){this.interactableLayers=n}setupHighlights(n){const u={name:"hover",color:"lightgreen",haloOpacity:1,fillOpacity:.2},c={name:"selected",color:"green",haloOpacity:1,fillOpacity:.3};n.highlights.push(u),n.highlights.push(c)}setupPointerMoveHandler(n){this.pointerMoveHandle=n.on("pointer-move",async u=>{if(!this.pointerInsideMap)return;const{results:c}=await n.hitTest(u),p=c[0];if(!p){this.clearHoverHighlight();return}const g=p.graphic,b=g.layer;if(!g||!b||!this.isLayerInteractable(b.id)||g.attributes?.[b.objectIdField]===void 0){this.clearHoverHighlight();return}const C=g.attributes?.[b.objectIdField];if(!(ut.currentHoveredArea&&ut.currentHoveredArea.id===C))try{const F=await n.whenLayerView(b);ut.layerHighlightState.featureLayerView!==F&&ut.setSelectedLayerView(F),this.clearHoverHighlight();const v=F;if(!v){console.warn("LayerView is not a FeatureLayerView");return}if(!this.pointerInsideMap)return;const N=v.highlight(g,{name:"hover"});ut.setHoveredArea(C,N)}catch(F){console.error("Error in pointer-move handler:",F),this.clearHoverHighlight()}})}setupClickHandler(n){this.clickHandle=n.on("click",async u=>{const{results:c}=await n.hitTest(u),p=c[0];if(!p)return;const g=p.graphic,b=g.layer;if(!g||!b||!this.isLayerInteractable(b.id)||g.attributes?.[b.objectIdField]===void 0)return;const C=g.attributes?.[b.objectIdField];try{const F=await n.whenLayerView(b),v=F;if(!v){console.warn("Layer is not a FeatureLayerView");return}ut.layerHighlightState.featureLayerView!==F&&ut.setSelectedLayerView(F);const H=(ut.layerHighlightState.areaInfos||[]).find(V=>V.id===C);if(H)ut.removeSelectedArea(H.id);else{const V=v.highlight(g,{name:"selected"});ut.addSelectedArea(C,V)}}catch(F){console.error("Error in click handler:",F)}})}setupLeaveHandler(n){this.leaveHandle=n.on("pointer-leave",()=>{this.pointerInsideMap=!1,this.clearHoverHighlight()})}setupEnterHandler(n){this.enterHandle=n.on("pointer-enter",()=>{this.pointerInsideMap=!0})}isLayerInteractable(n){return this.interactableLayers.has(n)}clearHoverHighlight(){ut.currentHoveredArea&&ut.clearHoveredArea()}cleanup(){this.pointerMoveHandle&&(this.pointerMoveHandle.remove(),this.pointerMoveHandle=null),this.clickHandle&&(this.clickHandle.remove(),this.clickHandle=null),this.leaveHandle&&(this.leaveHandle.remove(),this.leaveHandle=null),this.enterHandle&&(this.enterHandle.remove(),this.enterHandle=null),this.clearHoverHighlight(),this.isInitialized=!1,this.mapView=null,this.pointerInsideMap=!0,this.interactableLayers=new Set,console.log("[map-interaction-store] cleaned up")}get currentMapView(){return this.mapView}get initialized(){return this.isInitialized}}const Ki=new hu;var vu=ye('<div class="esri-ui-element svelte-i0p9uk"><!></div>'),pu=ye('<div class="esri-ui-element svelte-i0p9uk"><!></div>'),mu=ye('<div class="map-view svelte-i0p9uk"></div> <!> <!>',1);function gu(A,n){dt(n,!0);const u=nt(n,"webMap",3,null),c=nt(n,"panelPosition",3,"top-left"),p=nt(n,"menuPosition",3,"top-right");let g=null,b=we(null),C=we(null),F=we(null),v=we(!1);const N="streets-vector";let H,V;Wn(async()=>{await Q(),await ie()});async function Q(){if(!V){const[{default:ve},{default:G},{default:xe},{default:De}]=await Promise.all([Un(()=>import("../chunks/gV446Zal.js").then(ge=>ge.M),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39]),import.meta.url),Un(()=>import("../chunks/DWJ_RHQc.js").then(ge=>ge.a3),__vite__mapDeps([40,1,2,3,5,41,24,42,22,6,7,43,32,44,20,21,45,8,9,10,11,25,46,47,17,33,48,49,50,26,51,52,15,53,0,4,12,13,14,16,18,19,23,27,28,29,30,31,34,35,36,37,38,39,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93]),import.meta.url),Un(()=>import("../chunks/CcA5n_nD.js").then(ge=>ge.W),__vite__mapDeps([94,1,2,3,5,6,7,0,4,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,95,96,97,98,67,99,100,80,81,71,55,56,57,58,59,60,61,62,63,64,65,101,102,103,70,66,104,105,106,107,69,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,46,47,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178]),import.meta.url),Un(()=>import("../chunks/CoQoT6iH.js"),__vite__mapDeps([101,5,1,2,3,56,24,8,9,10,11,7,6,57,23,20,21,22,39,95,102,103,70,71,66,104,105,106,38,13,67,107,15,26,69,43,32,44,19,108,109,110,111,61,112,55,58,59,60,12,62,63,64,65,113,114,115,116,117,118,119,120,121,122,123,124,125,126,96,33,46,47,17,127,128,129,130,131,132,133,134,34,35,36,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,45,151,152,153,154,155,156,157,158,159,160,161,28,162,163,164,16,165,166,167,98,168,169,170,171,172,173,174,175,97]),import.meta.url)]);H=ve,V=G}}async function z(ve,G){const xe=new V({container:G,popupEnabled:!1,map:ve});return await xe.when(),xe}function j(ve){ve.ui.move("zoom","top-right"),f(C)&&c()&&ve.ui.add(f(C),c()),f(F)&&p()&&ve.ui.add(f(F),p()),te(v,!0)}async function U(){return new H({basemap:N})}async function Z(){if(u())try{if(await Q(),await ie(),!f(b)){console.error("MapView is not initialized");return}f(b).map=u(),console.log("[uprn-map-view] MapView updated with new webMap")}catch(ve){console.error("Error updating MapView with new webMap:",ve)}}async function ie(){if(!g){console.error("Map container element was not found");return}try{te(b,await z(u()??void 0,g),!0),j(f(b)),console.log("[uprn-map-view] Map loaded successfully")}catch(ve){console.error("Error loading map:",ve),await X()}}async function X(){try{const ve=await U();te(b,await z(ve,g),!0),j(f(b)),console.log("[uprn-map-view] Fallback map loaded")}catch(ve){console.error("Error loading fallback map:",ve)}}Dt(()=>{u()&&Z()}),Dt(()=>{if(!f(b)||!n.areaSelectionTreeviewStore.initialized)return;const ve=n.areaSelectionTreeviewStore.getNonHiddenNodes().map(G=>G.id);Ki.initialized?Ki.updateInteractableLayers(new Set(ve)):Ki.initializeAsync(f(b),new Set(ve))}),Dt(()=>{if(!n.areaSelectionTreeviewStore.initialized)return;if(!n.areaSelectionTreeviewStore.getVisibleNodes().length){ut.resetSelectedAreas();return}const ve=n.areaSelectionTreeviewStore.getVisibleNodes()[0];if(!ve||!(ve instanceof Bt)){console.warn("Visible node is not a FeatureLayer");return}if(!ve.layer){console.warn("Visible node layer is not a FeatureLayer");return}ae(ve.layer)});async function ae(ve){if(!f(b))return;const G=await f(b).whenLayerView(ve);if(!G){console.warn("Could not get LayerView for the visible node layer");return}ut.setSelectedLayerView(G)}function Ae(){f(b)&&f(b).destroy()}qa(()=>{Ae()});var de=mu(),be=le(de);Pr(be,ve=>g=ve,()=>g);var Pe=Ee(be,2);{var Ke=ve=>{var G=vu(),xe=re(G);{var De=ge=>{var ze=Ce(),We=le(ze);xt(We,()=>n.panel),R(ge,ze)};qe(xe,ge=>{f(v)&&ge(De)})}J(G),Pr(G,ge=>te(C,ge),()=>f(C)),R(ve,G)};qe(Pe,ve=>{n.panel&&ve(Ke)})}var oe=Ee(Pe,2);{var ue=ve=>{var G=pu(),xe=re(G);{var De=ge=>{var ze=Ce(),We=le(ze);xt(We,()=>n.menu),R(ge,ze)};qe(xe,ge=>{f(v)&&ge(De)})}J(G),Pr(G,ge=>te(F,ge),()=>f(F)),R(ve,G)};qe(oe,ve=>{n.menu&&ve(ue)})}R(A,de),ft()}var yu=ye('<div class="min-w-0 space-y-2 overflow-hidden p-4"><!></div>'),bu=ye('<div class="flex min-h-0 flex-1 flex-col"><!></div>');function zi(A,n){var u=bu(),c=re(u);at(c,()=>Gi,(p,g)=>{g(p,{class:"card-content flex min-h-0 flex-1 flex-col overflow-hidden p-0",children:(b,C)=>{var F=yu(),v=re(F);xt(v,()=>n.children??Et),J(F),R(b,F)},$$slots:{default:!0}})}),J(u),R(A,u)}var wu=ye("<!> <!>",1),_u=ye('<div class="tab-list-wrapper flex-shrink-0 svelte-rohqkk"><!></div> <!>',1);function Su(A,n){dt(n,!0);const u=nt(n,"triggers",19,()=>[]);var c=Ce(),p=le(c);at(p,()=>Jo,(g,b)=>{b(g,{get value(){return n.value},get onValueChange(){return n.onValueChange},class:"flex h-full w-full flex-col",children:(C,F)=>{var v=_u(),N=le(v),H=re(N);at(H,()=>Zo,(Q,z)=>{z(Q,{class:"tab-list",children:(j,U)=>{var Z=Ce(),ie=le(Z);Hr(ie,17,u,Qn,(X,ae,Ae,de)=>{let be=()=>f(ae).value,Pe=()=>f(ae).label;var Ke=wu(),oe=le(Ke);at(oe,()=>es,(G,xe)=>{xe(G,{get value(){return be()},class:"tab-trigger",children:(De,ge)=>{kn();var ze=$n();Tt(()=>Qt(ze,Pe())),R(De,ze)},$$slots:{default:!0}})});var ue=Ee(oe,2);{var ve=G=>{Io(G,{class:"separator"})};qe(ue,G=>{be()!==u()[u().length-1]?.value&&G(ve)})}R(X,Ke)}),R(j,Z)},$$slots:{default:!0}})}),J(N);var V=Ee(N,2);xt(V,()=>n.children??Et),R(C,v)},$$slots:{default:!0}})}),R(A,c),ft()}const He=Object.freeze({LEFT:"left",RIGHT:"right",TOP:"top",BOTTOM:"bottom"});var xu=ye("<!> <div><aside><div><div><!></div></div></aside></div> <!>",1);function ku(A,n){dt(n,!0);const u=nt(n,"position",19,()=>He.LEFT),c=nt(n,"openIcon",3,xs),p=nt(n,"overlay",3,!1),g=8,b="500px",C="calc(var(--header-height, 64px) + 1rem)";let F,v=we(0),N=we(Ct(n.originalSize??b)),H=we(!1),V=we(!1);const Q=Le(()=>u()===He.LEFT||u()===He.RIGHT),z=Le(()=>u()===He.LEFT||u()===He.TOP),j=Le(()=>f(Q)?"500px":"100px"),U=Le(()=>n.minSize??f(j)),Z=Le(()=>parseFloat(f(U))),ie=Le(()=>f(Q)?"width":"height"),X=Le(()=>f(Q)?"ew-resize":"ns-resize");Dt(()=>{f(V)||(te(N,n.originalSize??f(U),!0),console.log("Sidebar size updated due to minSize/originalSize change:",f(N),n.originalSize))}),Wn(()=>{if(!F)return;const _e=new ResizeObserver(Y=>{for(const et of Y)te(v,f(Q)?et.contentRect.width:et.contentRect.height,!0)});return _e.observe(F),()=>_e.disconnect()});function ae(_e){if(!n.isOpen)return;te(H,!0),_e.preventDefault();const Y=f(Q)?_e.clientX:_e.clientY,et=parseFloat(f(N));function wt(yt){const pt=f(Q)?yt.clientX:yt.clientY,It=f(z)?pt-Y:Y-pt,Ve=Math.max(f(Z),et+It);te(N,`${Ve}px`),te(V,!0)}function Oe(){te(H,!1),document.removeEventListener("mousemove",wt),document.removeEventListener("mouseup",Oe),document.body.style.cursor="",document.body.style.userSelect=""}document.addEventListener("mousemove",wt),document.addEventListener("mouseup",Oe),document.body.style.cursor=f(X),document.body.style.userSelect="none"}const Ae=Le(()=>()=>{const _e=n.isOpen?f(N):"0px";return p()?{[He.LEFT]:{top:"1rem",left:_e},[He.RIGHT]:{top:"1rem",right:_e},[He.TOP]:{top:_e,left:"1rem"},[He.BOTTOM]:{bottom:_e,left:"1rem"}}[u()]:{[He.LEFT]:{top:C,left:_e},[He.RIGHT]:{top:C,right:_e},[He.TOP]:{top:_e,left:"1rem"},[He.BOTTOM]:{bottom:_e,left:"1rem"}}[u()]}),de=Le(()=>()=>({[He.LEFT]:"rounded-l-none rounded-r-md",[He.RIGHT]:"rounded-r-none rounded-l-md",[He.TOP]:"rounded-t-none rounded-b-md",[He.BOTTOM]:"rounded-b-none rounded-t-md"})[u()]),be=Le(()=>()=>!p()&&n.isOpen?"":{[He.LEFT]:"box-shadow: 4px 0 8px -2px rgb(0 0 0 / 0.1), 2px 0 4px -2px rgb(0 0 0 / 0.1);",[He.RIGHT]:"box-shadow: -4px 0 8px -2px rgb(0 0 0 / 0.1), -2px 0 4px -2px rgb(0 0 0 / 0.1);",[He.TOP]:"box-shadow: 0 4px 8px -2px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);",[He.BOTTOM]:"box-shadow: 0 -4px 8px -2px rgb(0 0 0 / 0.1), 0 -2px 4px -2px rgb(0 0 0 / 0.1);"}[u()]),Pe=Le(()=>()=>({[He.LEFT]:ws,[He.RIGHT]:ts,[He.TOP]:_s,[He.BOTTOM]:bs})[u()]),Ke=Le(()=>()=>{if(!n.isOpen)return{};const _e=`${g}px`,Y=n.isOpen?`calc(${f(N)} + ${-g/2}px)`:"0px";return p()?{[He.LEFT]:{left:Y,top:"0",width:_e,height:"100%"},[He.RIGHT]:{right:Y,top:"0",width:_e,height:"100%"},[He.TOP]:{top:Y,left:"0",height:_e,width:"100%"},[He.BOTTOM]:{bottom:Y,left:"0",height:_e,width:"100%"}}[u()]:{[He.LEFT]:{left:Y,top:"0",width:_e,height:"100%"},[He.RIGHT]:{right:Y,top:"0",width:_e,height:"100%"},[He.TOP]:{top:Y,left:"0",height:_e,width:"100%"},[He.BOTTOM]:{bottom:Y,left:"0",height:_e,width:"100%"}}[u()]});function oe(_e){return Object.entries(_e).map(([Y,et])=>`${Y}: ${et}`).join("; ")}const ue=Le(()=>f(z)?0:1),ve=Le(()=>()=>n.isOpen?"translate(0, 0)":{[He.LEFT]:`translate(-${f(N)}, 0)`,[He.RIGHT]:`translate(${f(N)}, 0)`,[He.TOP]:`translate(0, -${f(N)})`,[He.BOTTOM]:`translate(0, ${f(N)})`}[u()]),G=Le(()=>()=>{const _e=n.isOpen?f(N):"0px";if(p()){if(f(Q)){const et={position:"absolute",top:"0",bottom:"0",width:_e,height:"100%","z-index":"30"};return et[u()===He.LEFT?"left":"right"]="0",et}const Y={position:"absolute",left:"0",right:"0",height:_e,width:"100%","z-index":"30"};return Y[u()===He.TOP?"top":"bottom"]="0",Y}return{[f(ie)]:_e,order:`${f(ue)}`}});var xe=xu(),De=le(xe);{let _e=Le(()=>p()?"absolute":"fixed"),Y=Le(()=>f(de)()),et=Le(()=>f(H)?"":"transition-all duration-300"),wt=Le(()=>oe(f(Ae)())),Oe=Le(()=>f(be)()),yt=Le(()=>f(H)?"transition: none !important;":""),pt=Le(()=>n.isOpen?"Close sidebar":"Open sidebar");hr(De,{get onclick(){return n.onToggle},variant:"default",size:"icon",get class(){return`size-7 ${f(_e)??""} z-[10] !bg-background hover:scale-105 hover:!bg-background/90 ${f(Y)??""} ${f(et)??""}`},get style(){return`${f(wt)??""}; pointer-events: auto; ${f(Oe)??""} ${f(yt)??""}`},get"aria-label"(){return f(pt)},get"aria-expanded"(){return n.isOpen},children:(It,Ve)=>{var Ht=Ce(),qt=le(Ht);{var lt=ot=>{const Ut=Le(()=>f(Pe)());var Kt=Ce(),pr=le(Kt);at(pr,()=>f(Ut),(er,Ft)=>{Ft(er,{class:"h-6 w-6 text-primary"})}),R(ot,Kt)},_t=ot=>{const Ut=Le(c);var Kt=Ce(),pr=le(Kt);at(pr,()=>f(Ut),(er,Ft)=>{Ft(er,{class:"h-6 w-6 text-primary"})}),R(ot,Kt)};qe(qt,ot=>{n.isOpen?ot(lt):ot(_t,!1)})}R(It,Ht)},$$slots:{default:!0}})}var ge=Ee(De,2);let ze;var We=re(ge);let je;var Me=re(We);let Je;var Ze=re(Me);let Ye;var Mt=re(Ze);{var bt=_e=>{var Y=Ce(),et=le(Y);xt(et,()=>n.children),R(_e,Y)};qe(Mt,_e=>{n.children&&_e(bt)})}J(Ze),J(Me),J(We),Pr(We,_e=>F=_e,()=>F),J(ge);var vt=Ee(ge,2);{var st=_e=>{{let Y=Le(()=>p()?"absolute":"fixed"),et=Le(()=>f(Q)?"cursor-ew-resize":"cursor-ns-resize"),wt=Le(()=>f(H)?"":"transition-all duration-300"),Oe=Le(()=>oe(f(Ke)()));hr(_e,{get class(){return`${f(Y)??""} z-40 border-0 bg-transparent p-0 ring-0 transition-colors outline-none hover:!bg-primary/50 focus-visible:ring-0 ${f(et)??""} ${f(wt)??""}`},onmousedown:ae,"aria-label":"Resize sidebar by dragging",get style(){return`${f(Oe)??""}; outline: none !important; box-shadow: none !important; border: none !important;`}})}};qe(vt,_e=>{n.isOpen&&_e(st)})}Tt((_e,Y,et,wt,Oe,yt)=>{ze=nn(ge,1,"relative",null,ze,_e),Gn(ge,Y),je=nn(We,1,`border-r-bg-sidebar-border relative flex border-r-1 bg-sidebar text-sidebar-foreground
    ${p()?"shadow-2xl":"shadow-lg"}`,null,je,et),Gn(We,`${f(ie)??""}: ${f(N)??""}; transform: ${wt??""};`),Je=nn(Me,1,"flex overflow-hidden",null,Je,Oe),Ye=nn(Ze,1,"flex overflow-hidden",null,Ye,yt)},[()=>({"overflow-hidden":!p(),"overflow-visible":p(),"h-full":f(Q),"w-full":!f(Q),"transition-all":!f(H),"duration-300":!f(H),"z-30":p()}),()=>oe(f(G)()),()=>({"flex-col":f(Q),"flex-row":!f(Q),"h-full":f(Q),"w-full":!f(Q),"border-r":u()===He.LEFT,"border-l":u()===He.RIGHT,"border-b":u()===He.TOP,"border-t":u()===He.BOTTOM,"border-sidebar-border":!0,"transition-transform":!f(H),"duration-300":!f(H),"pointer-events-auto":p(),"z-30":p()}),()=>f(ve)(),()=>({"flex-col":f(Q),"flex-row":!f(Q),"h-full":f(Q),"w-full":!f(Q)}),()=>({"flex-col":f(Q),"flex-row":!f(Q),"h-full":f(Q),"w-full":!f(Q)})]),R(A,xe),ft()}var Cu=ye('<div><!> <div class="main-content svelte-f4u9lw"><!></div></div>');function Iu(A,n){dt(n,!0);const u=nt(n,"position",19,()=>He.LEFT),c=Le(()=>u()===He.TOP||u()===He.BOTTOM);var p=Cu();let g;var b=re(p);ku(b,{get isOpen(){return n.isOpen},get onToggle(){return n.onToggle},get position(){return u()},get originalSize(){return n.originalSize},get minSize(){return n.minSize},get openIcon(){return n.openIcon},children:(N,H)=>{var V=Ce(),Q=le(V);{var z=j=>{var U=Ce(),Z=le(U);xt(Z,()=>n.sidebarContent),R(j,U)};qe(Q,j=>{n.sidebarContent&&j(z)})}R(N,V)},$$slots:{default:!0}});var C=Ee(b,2),F=re(C);{var v=N=>{var H=Ce(),V=le(H);xt(V,()=>n.mainContent),R(N,H)};qe(F,N=>{n.mainContent&&N(v)})}J(C),J(p),Tt(N=>g=nn(p,1,"sidebar-layout svelte-f4u9lw",null,g,N),[()=>({vertical:f(c)})]),R(A,p),ft()}var Eu=ye('<div class="min-w-0 space-y-2 overflow-hidden"><!></div>'),Au=ye('<div class="w-full flex-1 overflow-hidden p-1.5"><!></div>');function Ou(A,n){var u=Au(),c=re(u);Ra(c,{class:"h-full w-full",children:(p,g)=>{var b=Eu(),C=re(b);{var F=v=>{var N=Ce(),H=le(N);xt(H,()=>n.children),R(v,N)};qe(C,v=>{n.children&&v(F)})}J(b),R(p,b)},$$slots:{default:!0}}),J(u),R(A,u)}var Pu=ye('<div class="w-full flex-shrink-0"><!></div>');function Tu(A,n){var u=Pu(),c=re(u);{var p=g=>{var b=Ce(),C=le(b);xt(C,()=>n.children),R(g,b)};qe(c,g=>{n.children&&g(p)})}J(u),R(A,u)}var Mu=ye('<div class="w-full flex-shrink-0"><!></div>');function Nu(A,n){var u=Mu(),c=re(u);{var p=g=>{var b=Ce(),C=le(b);xt(C,()=>n.children),R(g,b)};qe(c,g=>{n.children&&g(p)})}J(u),R(A,u)}const Lu=[{value:"define-areas",label:"Define Areas"},{value:"select-data",label:"Select Data"},{value:"export",label:"Export"},{value:"downloads",label:"Download"}];class Du{#e;constructor(n){if(!n)throw new Error("UprnDownloadService endpoints configuration is required");if(!n.baseUrl||!n.healthRoute||!n.requestJobRoute||!n.requestJobStatusesRoute||!n.getAreaSelectionLimitsRoute||!n.fetchDownloadRoute)throw new Error("UprnDownloadService endpoints configuration is incomplete");this.#e=n}async getHealth(){try{const n=`${this.#e.baseUrl}${this.#e.healthRoute}`,u=await fetch(n);return u.ok?(await u.json()).status==="ok":!1}catch(n){return console.error("Health check failed:",n),!1}}async requestJob(n){try{console.log("[uprn-download-service] requesting job with request:",n);const u=`${this.#e.baseUrl}${this.#e.requestJobRoute}`,c=await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!c.ok){console.error("Failed to request job:",c.statusText,"request:",JSON.stringify(n));return}return await c.json()}catch(u){console.error("Error requesting job:",u);return}}async requestJobStatuses(n){try{const u=`${this.#e.baseUrl}${this.#e.requestJobStatusesRoute}`,c=await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!c.ok){console.error("Failed to get job statuses:",c.statusText);return}return await c.json()}catch(u){console.error("Error getting job statuses:",u);return}}async getSelectionAreaLimits(){try{const n=`${this.#e.baseUrl}${this.#e.getAreaSelectionLimitsRoute}`,u=await fetch(n);if(!u.ok){console.error("Failed to get area selection limits:",u.statusText);return}return await u.json()}catch(n){console.error("Error getting selection area limits:",n);return}}getDownloadUrl(n){const u=this.#e.baseUrl.replace(/\/+$/,""),c=this.#e.fetchDownloadRoute.replace(/\/+$/,"");return`${u}${c}/${encodeURIComponent(n)}`}}class qu{#e;constructor(n){this.#e=n}async getHealth(){try{const n=`${this.#e.baseUrl}${this.#e.healthRoute}`,u=await fetch(n);return u.ok?(await u.json()).status==="ok":!1}catch(n){return console.error("Health check failed:",n),!1}}async chat(n){try{const u=`${this.#e.baseUrl}${this.#e.chatRoute}`,p=await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:n})});if(!p.ok){console.error("Failed to send chat query:",p.statusText);return}return await p.json()}catch(u){console.error("Error sending chat query:",u);return}}async chatStream(n,u){try{const c=`${this.#e.baseUrl}${this.#e.chatStreamRoute}`,g=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:n})});if(!g.ok)return console.error("Failed to start chat stream:",g.statusText),!1;const b=g.body?.getReader();if(!b)return console.error("No response body reader available"),!1;const C=new TextDecoder;let F=!1;for(;!F;){const{value:v,done:N}=await b.read();if(F=N,v){const H=C.decode(v,{stream:!F});u(H)}}return!0}catch(c){return console.error("Error during chat stream:",c),!1}}}var sa={exports:{}};const Fu={},Ru=Object.freeze(Object.defineProperty({__proto__:null,default:Fu},Symbol.toStringTag,{value:"Module"})),La=qo(Ru);var Da;function ju(){return Da||(Da=1,(function(A,n){var u=void 0,c=function(p){return u||(u=new Promise(function(g,b){var C=typeof p<"u"?p:{},F=C.onAbort;C.onAbort=function(t){b(new Error(t)),F&&F(t)},C.postRun=C.postRun||[],C.postRun.push(function(){g(C)}),A=void 0;var v;v||=typeof C<"u"?C:{};var N=typeof window=="object",H=typeof WorkerGlobalScope<"u",V=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&process.type!="renderer";v.onRuntimeInitialized=function(){function t(M,W){switch(typeof W){case"boolean":gi(M,W?1:0);break;case"number":Vr(M,W);break;case"string":mi(M,W,-1,-1);break;case"object":if(W===null)Hn(M);else if(W.length!=null){var ke=pn(W,it);zn(M,ke,W.length,-1),Lt(ke)}else bn(M,"Wrong API use : tried to return a value of an unknown type ("+W+").",-1);break;default:Hn(M)}}function a(M,W){for(var ke=[],Fe=0;Fe<M;Fe+=1){var Be=Oe(W+4*Fe,"i32"),ht=Rn(Be);if(ht===1||ht===2)Be=pi(Be);else if(ht===3)Be=Ti(Be);else if(ht===4){ht=Be,Be=Pi(ht),ht=jn(ht);for(var or=new Uint8Array(Be),Xt=0;Xt<Be;Xt+=1)or[Xt]=oe[ht+Xt];Be=or}else Be=null;ke.push(Be)}return ke}function l(M,W){this.Qa=M,this.db=W,this.Oa=1,this.lb=[]}function h(M,W){if(this.db=W,W=Ft(M)+1,this.eb=Ln(W),this.eb===null)throw Error("Unable to allocate memory for the SQL string");jt(M,ue,this.eb,W),this.kb=this.eb,this.Za=this.pb=null}function w(M){if(this.filename="dbfile_"+(4294967295*Math.random()>>>0),M!=null){var W=this.filename,ke="/",Fe=W;if(ke&&(ke=typeof ke=="string"?ke:Nr(ke),Fe=W?lt(ke+"/"+W):ke),W=$t(!0,!0),Fe=ki(Fe,W),M){if(typeof M=="string"){ke=Array(M.length);for(var Be=0,ht=M.length;Be<ht;++Be)ke[Be]=M.charCodeAt(Be);M=ke}Xr(Fe,W|146),ke=ir(Fe,577),tt(ke,M,0,M.length,0),Tn(ke),Xr(Fe,W)}}this.handleError(Ne(this.filename,D)),this.db=Oe(D,"i32"),Bn(this.db),this.fb={},this.Sa={}}var D=Sr(4),B=v.cwrap,Ne=B("sqlite3_open","number",["string","number"]),Ue=B("sqlite3_close_v2","number",["number"]),Ge=B("sqlite3_exec","number",["number","string","number","number","number"]),Ot=B("sqlite3_changes","number",["number"]),zt=B("sqlite3_prepare_v2","number",["number","string","number","number","number"]),mn=B("sqlite3_sql","string",["number"]),si=B("sqlite3_normalized_sql","string",["number"]),Ii=B("sqlite3_prepare_v2","number",["number","number","number","number","number"]),ta=B("sqlite3_bind_text","number",["number","number","number","number","number"]),Ei=B("sqlite3_bind_blob","number",["number","number","number","number","number"]),li=B("sqlite3_bind_double","number",["number","number","number"]),ui=B("sqlite3_bind_int","number",["number","number","number"]),Ai=B("sqlite3_bind_parameter_index","number",["number","string"]),Dn=B("sqlite3_step","number",["number"]),qn=B("sqlite3_errmsg","string",["number"]),Fn=B("sqlite3_column_count","number",["number"]),Oi=B("sqlite3_data_count","number",["number"]),ra=B("sqlite3_column_double","number",["number","number"]),Kr=B("sqlite3_column_text","string",["number","number"]),ci=B("sqlite3_column_blob","number",["number","number"]),di=B("sqlite3_column_bytes","number",["number","number"]),fi=B("sqlite3_column_type","number",["number","number"]),hi=B("sqlite3_column_name","string",["number","number"]),Vt=B("sqlite3_reset","number",["number"]),gn=B("sqlite3_clear_bindings","number",["number"]),yn=B("sqlite3_finalize","number",["number"]),vi=B("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),Rn=B("sqlite3_value_type","number",["number"]),Pi=B("sqlite3_value_bytes","number",["number"]),Ti=B("sqlite3_value_text","string",["number"]),jn=B("sqlite3_value_blob","number",["number"]),pi=B("sqlite3_value_double","number",["number"]),Vr=B("sqlite3_result_double","",["number","number"]),Hn=B("sqlite3_result_null","",["number"]),mi=B("sqlite3_result_text","",["number","string","number","number"]),zn=B("sqlite3_result_blob","",["number","number","number","number"]),gi=B("sqlite3_result_int","",["number","number"]),bn=B("sqlite3_result_error","",["number","string","number"]),Mi=B("sqlite3_aggregate_context","number",["number","number"]),Bn=B("RegisterExtensionFunctions","number",["number"]),wn=B("sqlite3_update_hook","number",["number","number","number"]);l.prototype.bind=function(M){if(!this.Qa)throw"Statement closed";return this.reset(),Array.isArray(M)?this.Cb(M):M!=null&&typeof M=="object"?this.Db(M):!0},l.prototype.step=function(){if(!this.Qa)throw"Statement closed";this.Oa=1;var M=Dn(this.Qa);switch(M){case 100:return!0;case 101:return!1;default:throw this.db.handleError(M)}},l.prototype.wb=function(M){return M==null&&(M=this.Oa,this.Oa+=1),ra(this.Qa,M)},l.prototype.Gb=function(M){if(M==null&&(M=this.Oa,this.Oa+=1),M=Kr(this.Qa,M),typeof BigInt!="function")throw Error("BigInt is not supported");return BigInt(M)},l.prototype.Hb=function(M){return M==null&&(M=this.Oa,this.Oa+=1),Kr(this.Qa,M)},l.prototype.getBlob=function(M){M==null&&(M=this.Oa,this.Oa+=1);var W=di(this.Qa,M);M=ci(this.Qa,M);for(var ke=new Uint8Array(W),Fe=0;Fe<W;Fe+=1)ke[Fe]=oe[M+Fe];return ke},l.prototype.get=function(M,W){W=W||{},M!=null&&this.bind(M)&&this.step(),M=[];for(var ke=Oi(this.Qa),Fe=0;Fe<ke;Fe+=1)switch(fi(this.Qa,Fe)){case 1:var Be=W.useBigInt?this.Gb(Fe):this.wb(Fe);M.push(Be);break;case 2:M.push(this.wb(Fe));break;case 3:M.push(this.Hb(Fe));break;case 4:M.push(this.getBlob(Fe));break;default:M.push(null)}return M},l.prototype.getColumnNames=function(){for(var M=[],W=Fn(this.Qa),ke=0;ke<W;ke+=1)M.push(hi(this.Qa,ke));return M},l.prototype.getAsObject=function(M,W){M=this.get(M,W),W=this.getColumnNames();for(var ke={},Fe=0;Fe<W.length;Fe+=1)ke[W[Fe]]=M[Fe];return ke},l.prototype.getSQL=function(){return mn(this.Qa)},l.prototype.getNormalizedSQL=function(){return si(this.Qa)},l.prototype.run=function(M){return M!=null&&this.bind(M),this.step(),this.reset()},l.prototype.sb=function(M,W){W==null&&(W=this.Oa,this.Oa+=1),M=Tr(M);var ke=pn(M,it);this.lb.push(ke),this.db.handleError(ta(this.Qa,W,ke,M.length-1,0))},l.prototype.Bb=function(M,W){W==null&&(W=this.Oa,this.Oa+=1);var ke=pn(M,it);this.lb.push(ke),this.db.handleError(Ei(this.Qa,W,ke,M.length,0))},l.prototype.rb=function(M,W){W==null&&(W=this.Oa,this.Oa+=1),this.db.handleError((M===(M|0)?ui:li)(this.Qa,W,M))},l.prototype.Eb=function(M){M==null&&(M=this.Oa,this.Oa+=1),Ei(this.Qa,M,0,0,0)},l.prototype.tb=function(M,W){switch(W==null&&(W=this.Oa,this.Oa+=1),typeof M){case"string":this.sb(M,W);return;case"number":this.rb(M,W);return;case"bigint":this.sb(M.toString(),W);return;case"boolean":this.rb(M+0,W);return;case"object":if(M===null){this.Eb(W);return}if(M.length!=null){this.Bb(M,W);return}}throw"Wrong API use : tried to bind a value of an unknown type ("+M+")."},l.prototype.Db=function(M){var W=this;return Object.keys(M).forEach(function(ke){var Fe=Ai(W.Qa,ke);Fe!==0&&W.tb(M[ke],Fe)}),!0},l.prototype.Cb=function(M){for(var W=0;W<M.length;W+=1)this.tb(M[W],W+1);return!0},l.prototype.reset=function(){return this.freemem(),gn(this.Qa)===0&&Vt(this.Qa)===0},l.prototype.freemem=function(){for(var M;(M=this.lb.pop())!==void 0;)Lt(M)},l.prototype.free=function(){this.freemem();var M=yn(this.Qa)===0;return delete this.db.fb[this.Qa],this.Qa=0,M},h.prototype.next=function(){if(this.eb===null)return{done:!0};if(this.Za!==null&&(this.Za.free(),this.Za=null),!this.db.db)throw this.mb(),Error("Database closed");var M=ar(),W=Sr(4);pt(D),pt(W);try{this.db.handleError(Ii(this.db.db,this.kb,-1,D,W)),this.kb=Oe(W,"i32");var ke=Oe(D,"i32");return ke===0?(this.mb(),{done:!0}):(this.Za=new l(ke,this.db),this.db.fb[ke]=this.Za,{value:this.Za,done:!1})}catch(Fe){throw this.pb=Ht(this.kb),this.mb(),Fe}finally{Or(M)}},h.prototype.mb=function(){Lt(this.eb),this.eb=null},h.prototype.getRemainingSQL=function(){return this.pb!==null?this.pb:Ht(this.kb)},typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(h.prototype[Symbol.iterator]=function(){return this}),w.prototype.run=function(M,W){if(!this.db)throw"Database closed";if(W){M=this.prepare(M,W);try{M.step()}finally{M.free()}}else this.handleError(Ge(this.db,M,0,0,D));return this},w.prototype.exec=function(M,W,ke){if(!this.db)throw"Database closed";var Fe=ar(),Be=null;try{var ht=Nn(M),or=Sr(4);for(M=[];Oe(ht,"i8")!==0;){pt(D),pt(or),this.handleError(Ii(this.db,ht,-1,D,or));var Xt=Oe(D,"i32");if(ht=Oe(or,"i32"),Xt!==0){var Jt=null;for(Be=new l(Xt,this),W!=null&&Be.bind(W);Be.step();)Jt===null&&(Jt={columns:Be.getColumnNames(),values:[]},M.push(Jt)),Jt.values.push(Be.get(null,ke));Be.free()}}return M}catch(sr){throw Be&&Be.free(),sr}finally{Or(Fe)}},w.prototype.each=function(M,W,ke,Fe,Be){typeof W=="function"&&(Fe=ke,ke=W,W=void 0),M=this.prepare(M,W);try{for(;M.step();)ke(M.getAsObject(null,Be))}finally{M.free()}if(typeof Fe=="function")return Fe()},w.prototype.prepare=function(M,W){if(pt(D),this.handleError(zt(this.db,M,-1,D,0)),M=Oe(D,"i32"),M===0)throw"Nothing to prepare";var ke=new l(M,this);return W!=null&&ke.bind(W),this.fb[M]=ke},w.prototype.iterateStatements=function(M){return new h(M,this)},w.prototype.export=function(){Object.values(this.fb).forEach(function(W){W.free()}),Object.values(this.Sa).forEach(Yt),this.Sa={},this.handleError(Ue(this.db));var M=Ci(this.filename);return this.handleError(Ne(this.filename,D)),this.db=Oe(D,"i32"),Bn(this.db),M},w.prototype.close=function(){this.db!==null&&(Object.values(this.fb).forEach(function(M){M.free()}),Object.values(this.Sa).forEach(Yt),this.Sa={},this.Ya&&(Yt(this.Ya),this.Ya=void 0),this.handleError(Ue(this.db)),ti("/"+this.filename),this.db=null)},w.prototype.handleError=function(M){if(M===0)return null;throw M=qn(this.db),Error(M)},w.prototype.getRowsModified=function(){return Ot(this.db)},w.prototype.create_function=function(M,W){Object.prototype.hasOwnProperty.call(this.Sa,M)&&(Yt(this.Sa[M]),delete this.Sa[M]);var ke=qr(function(Fe,Be,ht){Be=a(Be,ht);try{var or=W.apply(null,Be)}catch(Xt){bn(Fe,Xt,-1);return}t(Fe,or)},"viii");return this.Sa[M]=ke,this.handleError(vi(this.db,M,W.length,1,0,ke,0,0,0)),this},w.prototype.create_aggregate=function(M,W){var ke=W.init||function(){return null},Fe=W.finalize||function(Jt){return Jt},Be=W.step;if(!Be)throw"An aggregate function must have a step function in "+M;var ht={};Object.hasOwnProperty.call(this.Sa,M)&&(Yt(this.Sa[M]),delete this.Sa[M]),W=M+"__finalize",Object.hasOwnProperty.call(this.Sa,W)&&(Yt(this.Sa[W]),delete this.Sa[W]);var or=qr(function(Jt,sr,_n){var Rr=Mi(Jt,1);Object.hasOwnProperty.call(ht,Rr)||(ht[Rr]=ke()),sr=a(sr,_n),sr=[ht[Rr]].concat(sr);try{ht[Rr]=Be.apply(null,sr)}catch(Ni){delete ht[Rr],bn(Jt,Ni,-1)}},"viii"),Xt=qr(function(Jt){var sr=Mi(Jt,1);try{var _n=Fe(ht[sr])}catch(Rr){delete ht[sr],bn(Jt,Rr,-1);return}t(Jt,_n),delete ht[sr]},"vi");return this.Sa[M]=or,this.Sa[W]=Xt,this.handleError(vi(this.db,M,Be.length-1,1,0,0,or,Xt,0)),this},w.prototype.updateHook=function(M){this.Ya&&(wn(this.db,0,0),Yt(this.Ya),this.Ya=void 0),M&&(this.Ya=qr(function(W,ke,Fe,Be,ht){switch(ke){case 18:W="insert";break;case 23:W="update";break;case 9:W="delete";break;default:throw"unknown operationCode in updateHook callback: "+ke}if(Fe=Fe?Ve(ue,Fe):"",Be=Be?Ve(ue,Be):"",ht>Number.MAX_SAFE_INTEGER)throw"rowId too big to fit inside a Number";M(W,Fe,Be,Number(ht))},"viiiij"),wn(this.db,this.Ya,0))},v.Database=w};var Q={...v},z="./this.program",j=(t,a)=>{throw a},U="",Z,ie;if(V){var X=La;U=__dirname+"/",ie=t=>(t=We(t)?new URL(t):t,X.readFileSync(t)),Z=async t=>(t=We(t)?new URL(t):t,X.readFileSync(t,void 0)),!v.thisProgram&&1<process.argv.length&&(z=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),A.exports=v,j=(t,a)=>{throw process.exitCode=t,a}}else(N||H)&&(H?U=self.location.href:typeof document<"u"&&document.currentScript&&(U=document.currentScript.src),U=U.startsWith("blob:")?"":U.slice(0,U.replace(/[?#].*/,"").lastIndexOf("/")+1),H&&(ie=t=>{var a=new XMLHttpRequest;return a.open("GET",t,!1),a.responseType="arraybuffer",a.send(null),new Uint8Array(a.response)}),Z=async t=>{if(We(t))return new Promise((l,h)=>{var w=new XMLHttpRequest;w.open("GET",t,!0),w.responseType="arraybuffer",w.onload=()=>{w.status==200||w.status==0&&w.response?l(w.response):h(w.status)},w.onerror=h,w.send(null)});var a=await fetch(t,{credentials:"same-origin"});if(a.ok)return a.arrayBuffer();throw Error(a.status+" : "+a.url)});var ae=v.print||console.log.bind(console),Ae=v.printErr||console.error.bind(console);Object.assign(v,Q),Q=null,v.thisProgram&&(z=v.thisProgram);var de=v.wasmBinary,be,Pe=!1,Ke,oe,ue,ve,G,xe,De,ge,ze,We=t=>t.startsWith("file://");function je(){var t=be.buffer;v.HEAP8=oe=new Int8Array(t),v.HEAP16=ve=new Int16Array(t),v.HEAPU8=ue=new Uint8Array(t),v.HEAPU16=new Uint16Array(t),v.HEAP32=G=new Int32Array(t),v.HEAPU32=xe=new Uint32Array(t),v.HEAPF32=De=new Float32Array(t),v.HEAPF64=ze=new Float64Array(t),v.HEAP64=ge=new BigInt64Array(t),v.HEAPU64=new BigUint64Array(t)}var Me=0,Je=null;function Ze(t){throw v.onAbort?.(t),t="Aborted("+t+")",Ae(t),Pe=!0,new WebAssembly.RuntimeError(t+". Build with -sASSERTIONS for more info.")}var Ye;async function Mt(t){if(!de)try{var a=await Z(t);return new Uint8Array(a)}catch{}if(t==Ye&&de)t=new Uint8Array(de);else if(ie)t=ie(t);else throw"both async and sync fetching of the wasm failed";return t}async function bt(t,a){try{var l=await Mt(t);return await WebAssembly.instantiate(l,a)}catch(h){Ae(`failed to asynchronously prepare wasm: ${h}`),Ze(h)}}async function vt(t){var a=Ye;if(!de&&typeof WebAssembly.instantiateStreaming=="function"&&!We(a)&&!V)try{var l=fetch(a,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(l,t)}catch(h){Ae(`wasm streaming compile failed: ${h}`),Ae("falling back to ArrayBuffer instantiation")}return bt(a,t)}class st{name="ExitStatus";constructor(a){this.message=`Program terminated with exit(${a})`,this.status=a}}var _e=t=>{for(;0<t.length;)t.shift()(v)},Y=[],et=[],wt=()=>{var t=v.preRun.shift();et.unshift(t)};function Oe(t,a="i8"){switch(a.endsWith("*")&&(a="*"),a){case"i1":return oe[t];case"i8":return oe[t];case"i16":return ve[t>>1];case"i32":return G[t>>2];case"i64":return ge[t>>3];case"float":return De[t>>2];case"double":return ze[t>>3];case"*":return xe[t>>2];default:Ze(`invalid type for getValue: ${a}`)}}var yt=v.noExitRuntime||!0;function pt(t){var a="i32";switch(a.endsWith("*")&&(a="*"),a){case"i1":oe[t]=0;break;case"i8":oe[t]=0;break;case"i16":ve[t>>1]=0;break;case"i32":G[t>>2]=0;break;case"i64":ge[t>>3]=BigInt(0);break;case"float":De[t>>2]=0;break;case"double":ze[t>>3]=0;break;case"*":xe[t>>2]=0;break;default:Ze(`invalid type for setValue: ${a}`)}}var It=typeof TextDecoder<"u"?new TextDecoder:void 0,Ve=(t,a=0,l=NaN)=>{var h=a+l;for(l=a;t[l]&&!(l>=h);)++l;if(16<l-a&&t.buffer&&It)return It.decode(t.subarray(a,l));for(h="";a<l;){var w=t[a++];if(w&128){var D=t[a++]&63;if((w&224)==192)h+=String.fromCharCode((w&31)<<6|D);else{var B=t[a++]&63;w=(w&240)==224?(w&15)<<12|D<<6|B:(w&7)<<18|D<<12|B<<6|t[a++]&63,65536>w?h+=String.fromCharCode(w):(w-=65536,h+=String.fromCharCode(55296|w>>10,56320|w&1023))}}else h+=String.fromCharCode(w)}return h},Ht=(t,a)=>t?Ve(ue,t,a):"",qt=(t,a)=>{for(var l=0,h=t.length-1;0<=h;h--){var w=t[h];w==="."?t.splice(h,1):w===".."?(t.splice(h,1),l++):l&&(t.splice(h,1),l--)}if(a)for(;l;l--)t.unshift("..");return t},lt=t=>{var a=t.charAt(0)==="/",l=t.slice(-1)==="/";return(t=qt(t.split("/").filter(h=>!!h),!a).join("/"))||a||(t="."),t&&l&&(t+="/"),(a?"/":"")+t},_t=t=>{var a=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(t).slice(1);return t=a[0],a=a[1],!t&&!a?".":(a&&=a.slice(0,-1),t+a)},ot=t=>t&&t.match(/([^\/]+|\/)\/*$/)[1],Ut=()=>{if(V){var t=La;return a=>t.randomFillSync(a)}return a=>crypto.getRandomValues(a)},Kt=t=>{(Kt=Ut())(t)},pr=(...t)=>{for(var a="",l=!1,h=t.length-1;-1<=h&&!l;h--){if(l=0<=h?t[h]:"/",typeof l!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!l)return"";a=l+"/"+a,l=l.charAt(0)==="/"}return a=qt(a.split("/").filter(w=>!!w),!l).join("/"),(l?"/":"")+a||"."},er=[],Ft=t=>{for(var a=0,l=0;l<t.length;++l){var h=t.charCodeAt(l);127>=h?a++:2047>=h?a+=2:55296<=h&&57343>=h?(a+=4,++l):a+=3}return a},jt=(t,a,l,h)=>{if(!(0<h))return 0;var w=l;h=l+h-1;for(var D=0;D<t.length;++D){var B=t.charCodeAt(D);if(55296<=B&&57343>=B){var Ne=t.charCodeAt(++D);B=65536+((B&1023)<<10)|Ne&1023}if(127>=B){if(l>=h)break;a[l++]=B}else{if(2047>=B){if(l+1>=h)break;a[l++]=192|B>>6}else{if(65535>=B){if(l+2>=h)break;a[l++]=224|B>>12}else{if(l+3>=h)break;a[l++]=240|B>>18,a[l++]=128|B>>12&63}a[l++]=128|B>>6&63}a[l++]=128|B&63}}return a[l]=0,l-w},Tr=(t,a)=>{var l=Array(Ft(t)+1);return t=jt(t,l,0,l.length),a&&(l.length=t),l},kr=[];function Mr(t,a){kr[t]={input:[],output:[],cb:a},gr(t,Wr)}var Wr={open(t){var a=kr[t.node.rdev];if(!a)throw new he(43);t.tty=a,t.seekable=!1},close(t){t.tty.cb.fsync(t.tty)},fsync(t){t.tty.cb.fsync(t.tty)},read(t,a,l,h){if(!t.tty||!t.tty.cb.xb)throw new he(60);for(var w=0,D=0;D<h;D++){try{var B=t.tty.cb.xb(t.tty)}catch{throw new he(29)}if(B===void 0&&w===0)throw new he(6);if(B==null)break;w++,a[l+D]=B}return w&&(t.node.atime=Date.now()),w},write(t,a,l,h){if(!t.tty||!t.tty.cb.qb)throw new he(60);try{for(var w=0;w<h;w++)t.tty.cb.qb(t.tty,a[l+w])}catch{throw new he(29)}return h&&(t.node.mtime=t.node.ctime=Date.now()),w}},Cr={xb(){e:{if(!er.length){var t=null;if(V){var a=Buffer.alloc(256),l=0,h=process.stdin.fd;try{l=X.readSync(h,a,0,256)}catch(w){if(w.toString().includes("EOF"))l=0;else throw w}0<l&&(t=a.slice(0,l).toString("utf-8"))}else typeof window<"u"&&typeof window.prompt=="function"&&(t=window.prompt("Input: "),t!==null&&(t+=`
`));if(!t){t=null;break e}er=Tr(t,!0)}t=er.shift()}return t},qb(t,a){a===null||a===10?(ae(Ve(t.output)),t.output=[]):a!=0&&t.output.push(a)},fsync(t){0<t.output?.length&&(ae(Ve(t.output)),t.output=[])},Tb(){return{Ob:25856,Qb:5,Nb:191,Pb:35387,Mb:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},Ub(){return 0},Vb(){return[24,80]}},Gr={qb(t,a){a===null||a===10?(Ae(Ve(t.output)),t.output=[]):a!=0&&t.output.push(a)},fsync(t){0<t.output?.length&&(Ae(Ve(t.output)),t.output=[])}},Re={Wa:null,Xa(){return Re.createNode(null,"/",16895,0)},createNode(t,a,l,h){if((l&61440)===24576||(l&61440)===4096)throw new he(63);return Re.Wa||(Re.Wa={dir:{node:{Ta:Re.La.Ta,Ua:Re.La.Ua,lookup:Re.La.lookup,hb:Re.La.hb,rename:Re.La.rename,unlink:Re.La.unlink,rmdir:Re.La.rmdir,readdir:Re.La.readdir,symlink:Re.La.symlink},stream:{Va:Re.Ma.Va}},file:{node:{Ta:Re.La.Ta,Ua:Re.La.Ua},stream:{Va:Re.Ma.Va,read:Re.Ma.read,write:Re.Ma.write,ib:Re.Ma.ib,jb:Re.Ma.jb}},link:{node:{Ta:Re.La.Ta,Ua:Re.La.Ua,readlink:Re.La.readlink},stream:{}},ub:{node:{Ta:Re.La.Ta,Ua:Re.La.Ua},stream:Zi}}),l=St(t,a,l,h),ct(l.mode)?(l.La=Re.Wa.dir.node,l.Ma=Re.Wa.dir.stream,l.Na={}):(l.mode&61440)===32768?(l.La=Re.Wa.file.node,l.Ma=Re.Wa.file.stream,l.Ra=0,l.Na=null):(l.mode&61440)===40960?(l.La=Re.Wa.link.node,l.Ma=Re.Wa.link.stream):(l.mode&61440)===8192&&(l.La=Re.Wa.ub.node,l.Ma=Re.Wa.ub.stream),l.atime=l.mtime=l.ctime=Date.now(),t&&(t.Na[a]=l,t.atime=t.mtime=t.ctime=l.atime),l},Sb(t){return t.Na?t.Na.subarray?t.Na.subarray(0,t.Ra):new Uint8Array(t.Na):new Uint8Array(0)},La:{Ta(t){var a={};return a.dev=(t.mode&61440)===8192?t.id:1,a.ino=t.id,a.mode=t.mode,a.nlink=1,a.uid=0,a.gid=0,a.rdev=t.rdev,ct(t.mode)?a.size=4096:(t.mode&61440)===32768?a.size=t.Ra:(t.mode&61440)===40960?a.size=t.link.length:a.size=0,a.atime=new Date(t.atime),a.mtime=new Date(t.mtime),a.ctime=new Date(t.ctime),a.blksize=4096,a.blocks=Math.ceil(a.size/a.blksize),a},Ua(t,a){for(var l of["mode","atime","mtime","ctime"])a[l]!=null&&(t[l]=a[l]);a.size!==void 0&&(a=a.size,t.Ra!=a&&(a==0?(t.Na=null,t.Ra=0):(l=t.Na,t.Na=new Uint8Array(a),l&&t.Na.set(l.subarray(0,Math.min(a,t.Ra))),t.Ra=a)))},lookup(){throw Re.vb},hb(t,a,l,h){return Re.createNode(t,a,l,h)},rename(t,a,l){try{var h=mr(a,l)}catch{}if(h){if(ct(t.mode))for(var w in h.Na)throw new he(55);an(h)}delete t.parent.Na[t.name],a.Na[l]=t,t.name=l,a.ctime=a.mtime=t.parent.ctime=t.parent.mtime=Date.now()},unlink(t,a){delete t.Na[a],t.ctime=t.mtime=Date.now()},rmdir(t,a){var l=mr(t,a),h;for(h in l.Na)throw new he(55);delete t.Na[a],t.ctime=t.mtime=Date.now()},readdir(t){return[".","..",...Object.keys(t.Na)]},symlink(t,a,l){return t=Re.createNode(t,a,41471,0),t.link=l,t},readlink(t){if((t.mode&61440)!==40960)throw new he(28);return t.link}},Ma:{read(t,a,l,h,w){var D=t.node.Na;if(w>=t.node.Ra)return 0;if(t=Math.min(t.node.Ra-w,h),8<t&&D.subarray)a.set(D.subarray(w,w+t),l);else for(h=0;h<t;h++)a[l+h]=D[w+h];return t},write(t,a,l,h,w,D){if(a.buffer===oe.buffer&&(D=!1),!h)return 0;if(t=t.node,t.mtime=t.ctime=Date.now(),a.subarray&&(!t.Na||t.Na.subarray)){if(D)return t.Na=a.subarray(l,l+h),t.Ra=h;if(t.Ra===0&&w===0)return t.Na=a.slice(l,l+h),t.Ra=h;if(w+h<=t.Ra)return t.Na.set(a.subarray(l,l+h),w),h}D=w+h;var B=t.Na?t.Na.length:0;if(B>=D||(D=Math.max(D,B*(1048576>B?2:1.125)>>>0),B!=0&&(D=Math.max(D,256)),B=t.Na,t.Na=new Uint8Array(D),0<t.Ra&&t.Na.set(B.subarray(0,t.Ra),0)),t.Na.subarray&&a.subarray)t.Na.set(a.subarray(l,l+h),w);else for(D=0;D<h;D++)t.Na[w+D]=a[l+D];return t.Ra=Math.max(t.Ra,w+h),h},Va(t,a,l){if(l===1?a+=t.position:l===2&&(t.node.mode&61440)===32768&&(a+=t.node.Ra),0>a)throw new he(28);return a},ib(t,a,l,h,w){if((t.node.mode&61440)!==32768)throw new he(43);if(t=t.node.Na,w&2||!t||t.buffer!==oe.buffer){w=!0,h=65536*Math.ceil(a/65536);var D=dr(65536,h);if(D&&ue.fill(0,D,D+h),h=D,!h)throw new he(48);t&&((0<l||l+a<t.length)&&(t.subarray?t=t.subarray(l,l+a):t=Array.prototype.slice.call(t,l,l+a)),oe.set(t,h))}else w=!1,h=t.byteOffset;return{Kb:h,Ab:w}},jb(t,a,l,h){return Re.Ma.write(t,a,0,h,l,!1),0}}},$t=(t,a)=>{var l=0;return t&&(l|=365),a&&(l|=146),l},Ie=null,Qr={},tr=[],In=1,ce=null,En=!1,Jn=!0,An={},he=class{name="ErrnoError";constructor(t){this.Pa=t}},Zn=class{gb={};node=null;get flags(){return this.gb.flags}set flags(t){this.gb.flags=t}get position(){return this.gb.position}set position(t){this.gb.position=t}},Ji=class{La={};Ma={};ab=null;constructor(t,a,l,h){t||=this,this.parent=t,this.Xa=t.Xa,this.id=In++,this.name=a,this.mode=l,this.rdev=h,this.atime=this.mtime=this.ctime=Date.now()}get read(){return(this.mode&365)===365}set read(t){t?this.mode|=365:this.mode&=-366}get write(){return(this.mode&146)===146}set write(t){t?this.mode|=146:this.mode&=-147}};function rr(t,a={}){if(!t)throw new he(44);a.nb??(a.nb=!0),t.charAt(0)==="/"||(t="//"+t);var l=0;e:for(;40>l;l++){t=t.split("/").filter(Ne=>!!Ne);for(var h=Ie,w="/",D=0;D<t.length;D++){var B=D===t.length-1;if(B&&a.parent)break;if(t[D]!==".")if(t[D]==="..")w=_t(w),h=h.parent;else{w=lt(w+"/"+t[D]);try{h=mr(h,t[D])}catch(Ne){if(Ne?.Pa===44&&B&&a.Jb)return{path:w};throw Ne}if(!h.ab||B&&!a.nb||(h=h.ab.root),(h.mode&61440)===40960&&(!B||a.$a)){if(!h.La.readlink)throw new he(52);h=h.La.readlink(h),h.charAt(0)==="/"||(h=_t(w)+"/"+h),t=h+"/"+t.slice(D+1).join("/");continue e}}}return{path:w,node:h}}throw new he(32)}function Nr(t){for(var a;;){if(t===t.parent)return t=t.Xa.zb,a?t[t.length-1]!=="/"?`${t}/${a}`:t+a:t;a=a?`${t.name}/${a}`:t.name,t=t.parent}}function Lr(t,a){for(var l=0,h=0;h<a.length;h++)l=(l<<5)-l+a.charCodeAt(h)|0;return(t+l>>>0)%ce.length}function an(t){var a=Lr(t.parent.id,t.name);if(ce[a]===t)ce[a]=t.bb;else for(a=ce[a];a;){if(a.bb===t){a.bb=t.bb;break}a=a.bb}}function mr(t,a){var l=ct(t.mode)?(l=Ir(t,"x"))?l:t.La.lookup?0:2:54;if(l)throw new he(l);for(l=ce[Lr(t.id,a)];l;l=l.bb){var h=l.name;if(l.parent.id===t.id&&h===a)return l}return t.La.lookup(t,a)}function St(t,a,l,h){return t=new Ji(t,a,l,h),a=Lr(t.parent.id,t.name),t.bb=ce[a],ce[a]=t}function ct(t){return(t&61440)===16384}function xi(t){var a=["r","w","rw"][t&3];return t&512&&(a+="w"),a}function Ir(t,a){if(Jn)return 0;if(!a.includes("r")||t.mode&292){if(a.includes("w")&&!(t.mode&146)||a.includes("x")&&!(t.mode&73))return 2}else return 2;return 0}function on(t,a){if(!ct(t.mode))return 54;try{return mr(t,a),20}catch{}return Ir(t,"wx")}function sn(t,a,l){try{var h=mr(t,a)}catch(w){return w.Pa}if(t=Ir(t,"wx"))return t;if(l){if(!ct(h.mode))return 54;if(h===h.parent||Nr(h)==="/")return 10}else if(ct(h.mode))return 31;return 0}function On(t){if(!t)throw new he(63);return t}function At(t){if(t=tr[t],!t)throw new he(8);return t}function zr(t,a=-1){if(t=Object.assign(new Zn,t),a==-1)e:{for(a=0;4096>=a;a++)if(!tr[a])break e;throw new he(33)}return t.fd=a,tr[a]=t}function Dr(t,a=-1){return t=zr(t,a),t.Ma?.Rb?.(t),t}function Yr(t,a,l){var h=t?.Ma.Ua;t=h?t:a,h??=a.La.Ua,On(h),h(t,l)}var Zi={open(t){t.Ma=Qr[t.node.rdev].Ma,t.Ma.open?.(t)},Va(){throw new he(70)}};function gr(t,a){Qr[t]={Ma:a}}function ei(t,a){var l=a==="/";if(l&&Ie)throw new he(10);if(!l&&a){var h=rr(a,{nb:!1});if(a=h.path,h=h.node,h.ab)throw new he(10);if(!ct(h.mode))throw new he(54)}a={type:t,Wb:{},zb:a,Ib:[]},t=t.Xa(a),t.Xa=a,a.root=t,l?Ie=t:h&&(h.ab=a,h.Xa&&h.Xa.Ib.push(a))}function yr(t,a,l){var h=rr(t,{parent:!0}).node;if(t=ot(t),!t)throw new he(28);if(t==="."||t==="..")throw new he(20);var w=on(h,t);if(w)throw new he(w);if(!h.La.hb)throw new he(63);return h.La.hb(h,t,a,l)}function ki(t,a=438){return yr(t,a&4095|32768,0)}function nr(t,a=511){return yr(t,a&1023|16384,0)}function kt(t,a,l){typeof l>"u"&&(l=a,a=438),yr(t,a|8192,l)}function Er(t,a){if(!pr(t))throw new he(44);var l=rr(a,{parent:!0}).node;if(!l)throw new he(44);a=ot(a);var h=on(l,a);if(h)throw new he(h);if(!l.La.symlink)throw new he(63);l.La.symlink(l,a,t)}function br(t){var a=rr(t,{parent:!0}).node;t=ot(t);var l=mr(a,t),h=sn(a,t,!0);if(h)throw new he(h);if(!a.La.rmdir)throw new he(63);if(l.ab)throw new he(10);a.La.rmdir(a,t),an(l)}function ti(t){var a=rr(t,{parent:!0}).node;if(!a)throw new he(44);t=ot(t);var l=mr(a,t),h=sn(a,t,!1);if(h)throw new he(h);if(!a.La.unlink)throw new he(63);if(l.ab)throw new he(10);a.La.unlink(a,t),an(l)}function wr(t,a){return t=rr(t,{$a:!a}).node,On(t.La.Ta)(t)}function ln(t,a,l,h){Yr(t,a,{mode:l&4095|a.mode&-4096,ctime:Date.now(),Fb:h})}function Xr(t,a){t=typeof t=="string"?rr(t,{$a:!0}).node:t,ln(null,t,a)}function Pn(t,a,l){if(ct(a.mode))throw new he(31);if((a.mode&61440)!==32768)throw new he(28);var h=Ir(a,"w");if(h)throw new he(h);Yr(t,a,{size:l,timestamp:Date.now()})}function ir(t,a,l=438){if(t==="")throw new he(44);if(typeof a=="string"){var h={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[a];if(typeof h>"u")throw Error(`Unknown file open mode: ${a}`);a=h}if(l=a&64?l&4095|32768:0,typeof t=="object")h=t;else{var w=t.endsWith("/");t=rr(t,{$a:!(a&131072),Jb:!0}),h=t.node,t=t.path}var D=!1;if(a&64)if(h){if(a&128)throw new he(20)}else{if(w)throw new he(31);h=yr(t,l|511,0),D=!0}if(!h)throw new he(44);if((h.mode&61440)===8192&&(a&=-513),a&65536&&!ct(h.mode))throw new he(54);if(!D&&(w=h?(h.mode&61440)===40960?32:ct(h.mode)&&(xi(a)!=="r"||a&576)?31:Ir(h,xi(a)):44))throw new he(w);return a&512&&!D&&(w=h,w=typeof w=="string"?rr(w,{$a:!0}).node:w,Pn(null,w,0)),a&=-131713,w=zr({node:h,path:Nr(h),flags:a,seekable:!0,position:0,Ma:h.Ma,Lb:[],error:!1}),w.Ma.open&&w.Ma.open(w),D&&Xr(h,l&511),!v.logReadFiles||a&1||t in An||(An[t]=1),w}function Tn(t){if(t.fd===null)throw new he(8);t.ob&&(t.ob=null);try{t.Ma.close&&t.Ma.close(t)}catch(a){throw a}finally{tr[t.fd]=null}t.fd=null}function un(t,a,l){if(t.fd===null)throw new he(8);if(!t.seekable||!t.Ma.Va)throw new he(70);if(l!=0&&l!=1&&l!=2)throw new he(28);t.position=t.Ma.Va(t,a,l),t.Lb=[]}function ri(t,a,l,h,w){if(0>h||0>w)throw new he(28);if(t.fd===null)throw new he(8);if((t.flags&2097155)===1)throw new he(8);if(ct(t.node.mode))throw new he(31);if(!t.Ma.read)throw new he(28);var D=typeof w<"u";if(!D)w=t.position;else if(!t.seekable)throw new he(70);return a=t.Ma.read(t,a,l,h,w),D||(t.position+=a),a}function tt(t,a,l,h,w){if(0>h||0>w)throw new he(28);if(t.fd===null)throw new he(8);if((t.flags&2097155)===0)throw new he(8);if(ct(t.node.mode))throw new he(31);if(!t.Ma.write)throw new he(28);t.seekable&&t.flags&1024&&un(t,0,2);var D=typeof w<"u";if(!D)w=t.position;else if(!t.seekable)throw new he(70);return a=t.Ma.write(t,a,l,h,w,void 0),D||(t.position+=a),a}function Ci(t){var a,l=ir(t,l||0);t=wr(t).size;var h=new Uint8Array(t);return ri(l,h,0,t,0),a=h,Tn(l),a}function Ar(t,a,l){t=lt("/dev/"+t);var h=$t(!!a,!!l);Ar.yb??(Ar.yb=64);var w=Ar.yb++<<8|0;gr(w,{open(D){D.seekable=!1},close(){l?.buffer?.length&&l(10)},read(D,B,Ne,Ue){for(var Ge=0,Ot=0;Ot<Ue;Ot++){try{var zt=a()}catch{throw new he(29)}if(zt===void 0&&Ge===0)throw new he(6);if(zt==null)break;Ge++,B[Ne+Ot]=zt}return Ge&&(D.node.atime=Date.now()),Ge},write(D,B,Ne,Ue){for(var Ge=0;Ge<Ue;Ge++)try{l(B[Ne+Ge])}catch{throw new he(29)}return Ue&&(D.node.mtime=D.node.ctime=Date.now()),Ge}}),kt(t,h,w)}var mt={};function cr(t,a,l){if(a.charAt(0)==="/")return a;if(t=t===-100?"/":At(t).path,a.length==0){if(!l)throw new he(44);return t}return t+"/"+a}function cn(t,a){G[t>>2]=a.dev,G[t+4>>2]=a.mode,xe[t+8>>2]=a.nlink,G[t+12>>2]=a.uid,G[t+16>>2]=a.gid,G[t+20>>2]=a.rdev,ge[t+24>>3]=BigInt(a.size),G[t+32>>2]=4096,G[t+36>>2]=a.blocks;var l=a.atime.getTime(),h=a.mtime.getTime(),w=a.ctime.getTime();return ge[t+40>>3]=BigInt(Math.floor(l/1e3)),xe[t+48>>2]=l%1e3*1e6,ge[t+56>>3]=BigInt(Math.floor(h/1e3)),xe[t+64>>2]=h%1e3*1e6,ge[t+72>>3]=BigInt(Math.floor(w/1e3)),xe[t+80>>2]=w%1e3*1e6,ge[t+88>>3]=BigInt(a.ino),0}var dn=void 0,fn=()=>{var t=G[+dn>>2];return dn+=4,t},gt=0,hn=[0,31,60,91,121,152,182,213,244,274,305,335],vn=[0,31,59,90,120,151,181,212,243,273,304,334],_r={},Mn=t=>{Ke=t,yt||0<gt||(v.onExit?.(t),Pe=!0),j(t,new st(t))},ni=t=>{if(!Pe)try{if(t(),!(yt||0<gt))try{Ke=t=Ke,Mn(t)}catch(a){a instanceof st||a=="unwind"||j(1,a)}}catch(a){a instanceof st||a=="unwind"||j(1,a)}},Jr={},ii=()=>{if(!Zr){var t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:z||"./this.program"},a;for(a in Jr)Jr[a]===void 0?delete t[a]:t[a]=Jr[a];var l=[];for(a in t)l.push(`${a}=${t[a]}`);Zr=l}return Zr},Zr,Nn=t=>{var a=Ft(t)+1,l=Sr(a);return jt(t,ue,l,a),l},ea=(t,a,l,h)=>{var w={string:Ge=>{var Ot=0;return Ge!=null&&Ge!==0&&(Ot=Nn(Ge)),Ot},array:Ge=>{var Ot=Sr(Ge.length);return oe.set(Ge,Ot),Ot}};t=v["_"+t];var D=[],B=0;if(h)for(var Ne=0;Ne<h.length;Ne++){var Ue=w[l[Ne]];Ue?(B===0&&(B=ar()),D[Ne]=Ue(h[Ne])):D[Ne]=h[Ne]}return l=t(...D),l=(function(Ge){return B!==0&&Or(B),a==="string"?Ge?Ve(ue,Ge):"":a==="boolean"?!!Ge:Ge})(l)},it=0,pn=(t,a)=>(a=a==1?Sr(t.length):Ln(t.length),t.subarray||t.slice||(t=new Uint8Array(t)),ue.set(t,a),a),Br,ai=[],Nt,Yt=t=>{Br.delete(Nt.get(t)),Nt.set(t,null),ai.push(t)},qr=(t,a)=>{if(!Br){Br=new WeakMap;var l=Nt.length;if(Br)for(var h=0;h<0+l;h++){var w=Nt.get(h);w&&Br.set(w,h)}}if(l=Br.get(t)||0)return l;if(ai.length)l=ai.pop();else{try{Nt.grow(1)}catch(Ue){throw Ue instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":Ue}l=Nt.length-1}try{Nt.set(l,t)}catch(Ue){if(!(Ue instanceof TypeError))throw Ue;if(typeof WebAssembly.Function=="function"){var D=WebAssembly.Function;h={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},w={parameters:[],results:a[0]=="v"?[]:[h[a[0]]]};for(var B=1;B<a.length;++B)w.parameters.push(h[a[B]]);a=new D(w,t)}else{h=[1],w=a.slice(0,1),a=a.slice(1),B={i:127,p:127,j:126,f:125,d:124,e:111},h.push(96);var Ne=a.length;128>Ne?h.push(Ne):h.push(Ne%128|128,Ne>>7);for(D of a)h.push(B[D]);w=="v"?h.push(0):h.push(1,B[w]),a=[0,97,115,109,1,0,0,0,1],D=h.length,128>D?a.push(D):a.push(D%128|128,D>>7),a.push(...h),a.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),a=new WebAssembly.Module(new Uint8Array(a)),a=new WebAssembly.Instance(a,{e:{f:t}}).exports.f}Nt.set(l,a)}return Br.set(t,l),l};ce=Array(4096),ei(Re,"/"),nr("/tmp"),nr("/home"),nr("/home/web_user"),(function(){nr("/dev"),gr(259,{read:()=>0,write:(h,w,D,B)=>B,Va:()=>0}),kt("/dev/null",259),Mr(1280,Cr),Mr(1536,Gr),kt("/dev/tty",1280),kt("/dev/tty1",1536);var t=new Uint8Array(1024),a=0,l=()=>(a===0&&(Kt(t),a=t.byteLength),t[--a]);Ar("random",l),Ar("urandom",l),nr("/dev/shm"),nr("/dev/shm/tmp")})(),(function(){nr("/proc");var t=nr("/proc/self");nr("/proc/self/fd"),ei({Xa(){var a=St(t,"fd",16895,73);return a.Ma={Va:Re.Ma.Va},a.La={lookup(l,h){l=+h;var w=At(l);return l={parent:null,Xa:{zb:"fake"},La:{readlink:()=>w.path},id:l+1},l.parent=l},readdir(){return Array.from(tr.entries()).filter(([,l])=>l).map(([l])=>l.toString())}},a}},"/proc/self/fd")})(),Re.vb=new he(44),Re.vb.stack="<generic error, no stack>";var Fr={a:(t,a,l,h)=>Ze(`Assertion failed: ${t?Ve(ue,t):""}, at: `+[a?a?Ve(ue,a):"":"unknown filename",l,h?h?Ve(ue,h):"":"unknown function"]),i:function(t,a){try{return t=t?Ve(ue,t):"",Xr(t,a),0}catch(l){if(typeof mt>"u"||l.name!=="ErrnoError")throw l;return-l.Pa}},L:function(t,a,l){try{if(a=a?Ve(ue,a):"",a=cr(t,a),l&-8)return-28;var h=rr(a,{$a:!0}).node;return h?(t="",l&4&&(t+="r"),l&2&&(t+="w"),l&1&&(t+="x"),t&&Ir(h,t)?-2:0):-44}catch(w){if(typeof mt>"u"||w.name!=="ErrnoError")throw w;return-w.Pa}},j:function(t,a){try{var l=At(t);return ln(l,l.node,a,!1),0}catch(h){if(typeof mt>"u"||h.name!=="ErrnoError")throw h;return-h.Pa}},h:function(t){try{var a=At(t);return Yr(a,a.node,{timestamp:Date.now(),Fb:!1}),0}catch(l){if(typeof mt>"u"||l.name!=="ErrnoError")throw l;return-l.Pa}},b:function(t,a,l){dn=l;try{var h=At(t);switch(a){case 0:var w=fn();if(0>w)break;for(;tr[w];)w++;return Dr(h,w).fd;case 1:case 2:return 0;case 3:return h.flags;case 4:return w=fn(),h.flags|=w,0;case 12:return w=fn(),ve[w+0>>1]=2,0;case 13:case 14:return 0}return-28}catch(D){if(typeof mt>"u"||D.name!=="ErrnoError")throw D;return-D.Pa}},g:function(t,a){try{var l=At(t),h=l.node,w=l.Ma.Ta;t=w?l:h,w??=h.La.Ta,On(w);var D=w(t);return cn(a,D)}catch(B){if(typeof mt>"u"||B.name!=="ErrnoError")throw B;return-B.Pa}},H:function(t,a){a=-9007199254740992>a||9007199254740992<a?NaN:Number(a);try{if(isNaN(a))return 61;var l=At(t);if(0>a||(l.flags&2097155)===0)throw new he(28);return Pn(l,l.node,a),0}catch(h){if(typeof mt>"u"||h.name!=="ErrnoError")throw h;return-h.Pa}},G:function(t,a){try{if(a===0)return-28;var l=Ft("/")+1;return a<l?-68:(jt("/",ue,t,a),l)}catch(h){if(typeof mt>"u"||h.name!=="ErrnoError")throw h;return-h.Pa}},K:function(t,a){try{return t=t?Ve(ue,t):"",cn(a,wr(t,!0))}catch(l){if(typeof mt>"u"||l.name!=="ErrnoError")throw l;return-l.Pa}},C:function(t,a,l){try{return a=a?Ve(ue,a):"",a=cr(t,a),nr(a,l),0}catch(h){if(typeof mt>"u"||h.name!=="ErrnoError")throw h;return-h.Pa}},J:function(t,a,l,h){try{a=a?Ve(ue,a):"";var w=h&256;return a=cr(t,a,h&4096),cn(l,w?wr(a,!0):wr(a))}catch(D){if(typeof mt>"u"||D.name!=="ErrnoError")throw D;return-D.Pa}},x:function(t,a,l,h){dn=h;try{a=a?Ve(ue,a):"",a=cr(t,a);var w=h?fn():0;return ir(a,l,w).fd}catch(D){if(typeof mt>"u"||D.name!=="ErrnoError")throw D;return-D.Pa}},v:function(t,a,l,h){try{if(a=a?Ve(ue,a):"",a=cr(t,a),0>=h)return-28;var w=rr(a).node;if(!w)throw new he(44);if(!w.La.readlink)throw new he(28);var D=w.La.readlink(w),B=Math.min(h,Ft(D)),Ne=oe[l+B];return jt(D,ue,l,h+1),oe[l+B]=Ne,B}catch(Ue){if(typeof mt>"u"||Ue.name!=="ErrnoError")throw Ue;return-Ue.Pa}},u:function(t){try{return t=t?Ve(ue,t):"",br(t),0}catch(a){if(typeof mt>"u"||a.name!=="ErrnoError")throw a;return-a.Pa}},f:function(t,a){try{return t=t?Ve(ue,t):"",cn(a,wr(t))}catch(l){if(typeof mt>"u"||l.name!=="ErrnoError")throw l;return-l.Pa}},r:function(t,a,l){try{return a=a?Ve(ue,a):"",a=cr(t,a),l===0?ti(a):l===512?br(a):Ze("Invalid flags passed to unlinkat"),0}catch(h){if(typeof mt>"u"||h.name!=="ErrnoError")throw h;return-h.Pa}},q:function(t,a,l){try{a=a?Ve(ue,a):"",a=cr(t,a,!0);var h=Date.now(),w,D;if(l){var B=xe[l>>2]+4294967296*G[l+4>>2],Ne=G[l+8>>2];Ne==1073741823?w=h:Ne==1073741822?w=null:w=1e3*B+Ne/1e6,l+=16,B=xe[l>>2]+4294967296*G[l+4>>2],Ne=G[l+8>>2],Ne==1073741823?D=h:Ne==1073741822?D=null:D=1e3*B+Ne/1e6}else D=w=h;if((D??w)!==null){t=w;var Ue=rr(a,{$a:!0}).node;On(Ue.La.Ua)(Ue,{atime:t,mtime:D})}return 0}catch(Ge){if(typeof mt>"u"||Ge.name!=="ErrnoError")throw Ge;return-Ge.Pa}},m:()=>Ze(""),l:()=>{yt=!1,gt=0},A:function(t,a){t=-9007199254740992>t||9007199254740992<t?NaN:Number(t),t=new Date(1e3*t),G[a>>2]=t.getSeconds(),G[a+4>>2]=t.getMinutes(),G[a+8>>2]=t.getHours(),G[a+12>>2]=t.getDate(),G[a+16>>2]=t.getMonth(),G[a+20>>2]=t.getFullYear()-1900,G[a+24>>2]=t.getDay();var l=t.getFullYear();G[a+28>>2]=(l%4!==0||l%100===0&&l%400!==0?vn:hn)[t.getMonth()]+t.getDate()-1|0,G[a+36>>2]=-(60*t.getTimezoneOffset()),l=new Date(t.getFullYear(),6,1).getTimezoneOffset();var h=new Date(t.getFullYear(),0,1).getTimezoneOffset();G[a+32>>2]=(l!=h&&t.getTimezoneOffset()==Math.min(h,l))|0},y:function(t,a,l,h,w,D,B){w=-9007199254740992>w||9007199254740992<w?NaN:Number(w);try{if(isNaN(w))return 61;var Ne=At(h);if((a&2)!==0&&(l&2)===0&&(Ne.flags&2097155)!==2)throw new he(2);if((Ne.flags&2097155)===1)throw new he(2);if(!Ne.Ma.ib)throw new he(43);if(!t)throw new he(28);var Ue=Ne.Ma.ib(Ne,t,w,a,l),Ge=Ue.Kb;return G[D>>2]=Ue.Ab,xe[B>>2]=Ge,0}catch(Ot){if(typeof mt>"u"||Ot.name!=="ErrnoError")throw Ot;return-Ot.Pa}},z:function(t,a,l,h,w,D){D=-9007199254740992>D||9007199254740992<D?NaN:Number(D);try{var B=At(w);if(l&2){if(l=D,(B.node.mode&61440)!==32768)throw new he(43);if(!(h&2)){var Ne=ue.slice(t,t+a);B.Ma.jb&&B.Ma.jb(B,Ne,l,a,h)}}}catch(Ue){if(typeof mt>"u"||Ue.name!=="ErrnoError")throw Ue;return-Ue.Pa}},n:(t,a)=>{if(_r[t]&&(clearTimeout(_r[t].id),delete _r[t]),!a)return 0;var l=setTimeout(()=>{delete _r[t],ni(()=>en(t,performance.now()))},a);return _r[t]={id:l,Xb:a},0},B:(t,a,l,h)=>{var w=new Date().getFullYear(),D=new Date(w,0,1).getTimezoneOffset();w=new Date(w,6,1).getTimezoneOffset(),xe[t>>2]=60*Math.max(D,w),G[a>>2]=+(D!=w),a=B=>{var Ne=Math.abs(B);return`UTC${0<=B?"-":"+"}${String(Math.floor(Ne/60)).padStart(2,"0")}${String(Ne%60).padStart(2,"0")}`},t=a(D),a=a(w),w<D?(jt(t,ue,l,17),jt(a,ue,h,17)):(jt(t,ue,h,17),jt(a,ue,l,17))},d:()=>Date.now(),s:()=>2147483648,c:()=>performance.now(),o:t=>{var a=ue.length;if(t>>>=0,2147483648<t)return!1;for(var l=1;4>=l;l*=2){var h=a*(1+.2/l);h=Math.min(h,t+100663296);e:{h=(Math.min(2147483648,65536*Math.ceil(Math.max(t,h)/65536))-be.buffer.byteLength+65535)/65536|0;try{be.grow(h),je();var w=1;break e}catch{}w=void 0}if(w)return!0}return!1},E:(t,a)=>{var l=0;return ii().forEach((h,w)=>{var D=a+l;for(w=xe[t+4*w>>2]=D,D=0;D<h.length;++D)oe[w++]=h.charCodeAt(D);oe[w]=0,l+=h.length+1}),0},F:(t,a)=>{var l=ii();xe[t>>2]=l.length;var h=0;return l.forEach(w=>h+=w.length+1),xe[a>>2]=h,0},e:function(t){try{var a=At(t);return Tn(a),0}catch(l){if(typeof mt>"u"||l.name!=="ErrnoError")throw l;return l.Pa}},p:function(t,a){try{var l=At(t);return oe[a]=l.tty?2:ct(l.mode)?3:(l.mode&61440)===40960?7:4,ve[a+2>>1]=0,ge[a+8>>3]=BigInt(0),ge[a+16>>3]=BigInt(0),0}catch(h){if(typeof mt>"u"||h.name!=="ErrnoError")throw h;return h.Pa}},w:function(t,a,l,h){try{e:{var w=At(t);t=a;for(var D,B=a=0;B<l;B++){var Ne=xe[t>>2],Ue=xe[t+4>>2];t+=8;var Ge=ri(w,oe,Ne,Ue,D);if(0>Ge){var Ot=-1;break e}if(a+=Ge,Ge<Ue)break;typeof D<"u"&&(D+=Ge)}Ot=a}return xe[h>>2]=Ot,0}catch(zt){if(typeof mt>"u"||zt.name!=="ErrnoError")throw zt;return zt.Pa}},D:function(t,a,l,h){a=-9007199254740992>a||9007199254740992<a?NaN:Number(a);try{if(isNaN(a))return 61;var w=At(t);return un(w,a,l),ge[h>>3]=BigInt(w.position),w.ob&&a===0&&l===0&&(w.ob=null),0}catch(D){if(typeof mt>"u"||D.name!=="ErrnoError")throw D;return D.Pa}},I:function(t){try{var a=At(t);return a.Ma?.fsync?a.Ma.fsync(a):0}catch(l){if(typeof mt>"u"||l.name!=="ErrnoError")throw l;return l.Pa}},t:function(t,a,l,h){try{e:{var w=At(t);t=a;for(var D,B=a=0;B<l;B++){var Ne=xe[t>>2],Ue=xe[t+4>>2];t+=8;var Ge=tt(w,oe,Ne,Ue,D);if(0>Ge){var Ot=-1;break e}if(a+=Ge,Ge<Ue)break;typeof D<"u"&&(D+=Ge)}Ot=a}return xe[h>>2]=Ot,0}catch(zt){if(typeof mt>"u"||zt.name!=="ErrnoError")throw zt;return zt.Pa}},k:Mn},Te;(async function(){function t(l){return Te=l.exports,be=Te.M,je(),Nt=Te.O,Me--,v.monitorRunDependencies?.(Me),Me==0&&Je&&(l=Je,Je=null,l()),Te}Me++,v.monitorRunDependencies?.(Me);var a={a:Fr};return v.instantiateWasm?new Promise(l=>{v.instantiateWasm(a,(h,w)=>{t(h),l(h.exports)})}):(Ye??=v.locateFile?v.locateFile("sql-wasm.wasm",U):U+"sql-wasm.wasm",t((await vt(a)).instance))})(),v._sqlite3_free=t=>(v._sqlite3_free=Te.P)(t),v._sqlite3_value_text=t=>(v._sqlite3_value_text=Te.Q)(t),v._sqlite3_prepare_v2=(t,a,l,h,w)=>(v._sqlite3_prepare_v2=Te.R)(t,a,l,h,w),v._sqlite3_step=t=>(v._sqlite3_step=Te.S)(t),v._sqlite3_reset=t=>(v._sqlite3_reset=Te.T)(t),v._sqlite3_exec=(t,a,l,h,w)=>(v._sqlite3_exec=Te.U)(t,a,l,h,w),v._sqlite3_finalize=t=>(v._sqlite3_finalize=Te.V)(t),v._sqlite3_column_name=(t,a)=>(v._sqlite3_column_name=Te.W)(t,a),v._sqlite3_column_text=(t,a)=>(v._sqlite3_column_text=Te.X)(t,a),v._sqlite3_column_type=(t,a)=>(v._sqlite3_column_type=Te.Y)(t,a),v._sqlite3_errmsg=t=>(v._sqlite3_errmsg=Te.Z)(t),v._sqlite3_clear_bindings=t=>(v._sqlite3_clear_bindings=Te._)(t),v._sqlite3_value_blob=t=>(v._sqlite3_value_blob=Te.$)(t),v._sqlite3_value_bytes=t=>(v._sqlite3_value_bytes=Te.aa)(t),v._sqlite3_value_double=t=>(v._sqlite3_value_double=Te.ba)(t),v._sqlite3_value_int=t=>(v._sqlite3_value_int=Te.ca)(t),v._sqlite3_value_type=t=>(v._sqlite3_value_type=Te.da)(t),v._sqlite3_result_blob=(t,a,l,h)=>(v._sqlite3_result_blob=Te.ea)(t,a,l,h),v._sqlite3_result_double=(t,a)=>(v._sqlite3_result_double=Te.fa)(t,a),v._sqlite3_result_error=(t,a,l)=>(v._sqlite3_result_error=Te.ga)(t,a,l),v._sqlite3_result_int=(t,a)=>(v._sqlite3_result_int=Te.ha)(t,a),v._sqlite3_result_int64=(t,a)=>(v._sqlite3_result_int64=Te.ia)(t,a),v._sqlite3_result_null=t=>(v._sqlite3_result_null=Te.ja)(t),v._sqlite3_result_text=(t,a,l,h)=>(v._sqlite3_result_text=Te.ka)(t,a,l,h),v._sqlite3_aggregate_context=(t,a)=>(v._sqlite3_aggregate_context=Te.la)(t,a),v._sqlite3_column_count=t=>(v._sqlite3_column_count=Te.ma)(t),v._sqlite3_data_count=t=>(v._sqlite3_data_count=Te.na)(t),v._sqlite3_column_blob=(t,a)=>(v._sqlite3_column_blob=Te.oa)(t,a),v._sqlite3_column_bytes=(t,a)=>(v._sqlite3_column_bytes=Te.pa)(t,a),v._sqlite3_column_double=(t,a)=>(v._sqlite3_column_double=Te.qa)(t,a),v._sqlite3_bind_blob=(t,a,l,h,w)=>(v._sqlite3_bind_blob=Te.ra)(t,a,l,h,w),v._sqlite3_bind_double=(t,a,l)=>(v._sqlite3_bind_double=Te.sa)(t,a,l),v._sqlite3_bind_int=(t,a,l)=>(v._sqlite3_bind_int=Te.ta)(t,a,l),v._sqlite3_bind_text=(t,a,l,h,w)=>(v._sqlite3_bind_text=Te.ua)(t,a,l,h,w),v._sqlite3_bind_parameter_index=(t,a)=>(v._sqlite3_bind_parameter_index=Te.va)(t,a),v._sqlite3_sql=t=>(v._sqlite3_sql=Te.wa)(t),v._sqlite3_normalized_sql=t=>(v._sqlite3_normalized_sql=Te.xa)(t),v._sqlite3_changes=t=>(v._sqlite3_changes=Te.ya)(t),v._sqlite3_close_v2=t=>(v._sqlite3_close_v2=Te.za)(t),v._sqlite3_create_function_v2=(t,a,l,h,w,D,B,Ne,Ue)=>(v._sqlite3_create_function_v2=Te.Aa)(t,a,l,h,w,D,B,Ne,Ue),v._sqlite3_update_hook=(t,a,l)=>(v._sqlite3_update_hook=Te.Ba)(t,a,l),v._sqlite3_open=(t,a)=>(v._sqlite3_open=Te.Ca)(t,a);var Ln=v._malloc=t=>(Ln=v._malloc=Te.Da)(t),Lt=v._free=t=>(Lt=v._free=Te.Ea)(t);v._RegisterExtensionFunctions=t=>(v._RegisterExtensionFunctions=Te.Fa)(t);var dr=(t,a)=>(dr=Te.Ga)(t,a),en=(t,a)=>(en=Te.Ha)(t,a),Or=t=>(Or=Te.Ia)(t),Sr=t=>(Sr=Te.Ja)(t),ar=()=>(ar=Te.Ka)();v.stackSave=()=>ar(),v.stackRestore=t=>Or(t),v.stackAlloc=t=>Sr(t),v.cwrap=(t,a,l,h)=>{var w=!l||l.every(D=>D==="number"||D==="boolean");return a!=="string"&&w&&!h?v["_"+t]:(...D)=>ea(t,a,l,D)},v.addFunction=qr,v.removeFunction=Yt,v.UTF8ToString=Ht,v.ALLOC_NORMAL=it,v.allocate=pn,v.allocateUTF8OnStack=Nn;function oi(){function t(){if(v.calledRun=!0,!Pe){if(!v.noFSInit&&!En){var a,l;En=!0,h??=v.stdin,a??=v.stdout,l??=v.stderr,h?Ar("stdin",h):Er("/dev/tty","/dev/stdin"),a?Ar("stdout",null,a):Er("/dev/tty","/dev/stdout"),l?Ar("stderr",null,l):Er("/dev/tty1","/dev/stderr"),ir("/dev/stdin",0),ir("/dev/stdout",1),ir("/dev/stderr",1)}if(Te.N(),Jn=!1,v.onRuntimeInitialized?.(),v.postRun)for(typeof v.postRun=="function"&&(v.postRun=[v.postRun]);v.postRun.length;){var h=v.postRun.shift();Y.unshift(h)}_e(Y)}}if(0<Me)Je=oi;else{if(v.preRun)for(typeof v.preRun=="function"&&(v.preRun=[v.preRun]);v.preRun.length;)wt();_e(et),0<Me?Je=oi:v.setStatus?(v.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>v.setStatus(""),1),t()},1)):t()}}if(v.preInit)for(typeof v.preInit=="function"&&(v.preInit=[v.preInit]);0<v.preInit.length;)v.preInit.pop()();return oi(),C}),u)};A.exports=c,A.exports.default=c})(sa)),sa.exports}var Ja=ju();const Hu=ja(Ja),zu=cs({__proto__:null,default:Hu},[Ja]);class Bu{#e=null;#t=!1;async init(n){if(this.#t)return;const u=await fetch(n),[{default:c},{default:p}]=await Promise.all([Un(()=>Promise.resolve().then(()=>zu),void 0,import.meta.url),Un(()=>import("../chunks/eO9STgq2.js"),[],import.meta.url)]),g=await c({locateFile:C=>C==="sql-wasm.wasm"?p:C}),b=await u.arrayBuffer();this.#e=new g.Database(new Uint8Array(b)),this.#t=!0}async applyCustomRenderer(n,u){this.#r()}async getCustomRenderer(){this.#r();const n=this.#e.prepare("SELECT * FROM CustomRenderers"),u=[];for(;n.step();)u.push(n.getAsObject());return n.free(),console.table(u),u}#r(){if(!this.#t)throw new Error("CustomRendererService is not initialized");if(!this.#e)throw new Error("Database instance is not available")}}var Ku=ye('<div class="flex w-full items-center justify-between"><div class="font-medium">Chat</div> <div class="flex gap-1"><!> <!></div></div>'),Vu=ye("<!> <!>",1),Uu=ye("<div><!></div>");function $u(A,n){const u=nt(n,"isCollapsedOnInit",3,!0);let c=we(Ct(u())),p=we(!1),g,b="300px",C="100px";function F(){te(c,!f(c)),te(p,!1),f(c)?g.style.height=C:(C=g.style.height,g.style.height=b)}function v(){te(p,!f(p)),f(p)?(b=g.style.height,g.style.height="100%"):g.style.height=b}var N=Uu(),H=re(N);at(H,()=>va,(V,Q)=>{Q(V,{class:"h-full w-full gap-0 rounded-br-none rounded-bl-none py-0 pt-0 pb-0",children:(z,j)=>{var U=Vu(),Z=le(U);at(Z,()=>as,(ae,Ae)=>{Ae(ae,{class:"pt-2",children:(de,be)=>{var Pe=Ku(),Ke=Ee(re(Pe),2),oe=re(Ke);{var ue=G=>{hr(G,{size:"sm",onclick:v,children:(xe,De)=>{var ge=Ce(),ze=le(ge);{var We=Me=>{As(Me,{})},je=Me=>{Es(Me,{})};qe(ze,Me=>{f(p)?Me(We):Me(je,!1)})}R(xe,ge)},$$slots:{default:!0}})};qe(oe,G=>{f(c)||G(ue)})}var ve=Ee(oe,2);hr(ve,{size:"sm",onclick:F,children:(G,xe)=>{var De=Ce(),ge=le(De);{var ze=je=>{Is(je,{})},We=je=>{us(je,{})};qe(ge,je=>{f(c)?je(ze):je(We,!1)})}R(G,De)},$$slots:{default:!0}}),J(Ke),J(Pe),R(de,Pe)},$$slots:{default:!0}})});var ie=Ee(Z,2);{var X=ae=>{var Ae=Ce(),de=le(Ae);at(de,()=>Gi,(be,Pe)=>{Pe(be,{class:"h-full min-h-[10px] w-full p-0",children:(Ke,oe)=>{var ue=Ce(),ve=le(ue);xt(ve,()=>n.children??Et),R(Ke,ue)},$$slots:{default:!0}})}),R(ae,Ae)};qe(ie,ae=>{f(c)||ae(X)})}R(z,U)},$$slots:{default:!0}})}),J(N),Pr(N,V=>g=V,()=>g),R(A,N)}var Wu=ye('<p class="p-4 text-center text-sm text-gray-500">Download service is not available.</p>'),Gu=ye("<div><!></div> <div><!></div> <div><!></div> <div><!></div>",1),Qu=ye("<div><!></div>"),Yu=ye('<p class="p-4 text-center text-sm text-gray-500">AI UPRN Chatbot service is not available.</p>'),Xu=ye('<div class="relative flex h-full w-full min-w-0 flex-col overflow-visible"><!> <!> <!> <!></div>'),Ju=ye("<!> <!> <!> <!> <!>",1);function qc(A,n){dt(n,!0);const u=Ct(new wl),c=Ct(new bl),p=Ct(new $a);let g=we("define-areas"),b=we(void 0),C=we(void 0),F=we(void 0),v=we(void 0),N=we(!1),H=we(!1),V=we(Ct(new Set)),Q=we(!0),z=Ct(He.LEFT);Ct(He.BOTTOM);let j=we(Ct([])),U=we(Ct(typeof window<"u"?window.innerWidth:1280)),Z=Le(()=>X(f(j),G=>G.originalSize)),ie=Le(()=>X(f(j),G=>G.minSize));function X(G,xe){if(!G||G.length===0)return;const ge=[...G].sort((ze,We)=>We.breakpoint-ze.breakpoint).find(ze=>f(U)>=ze.breakpoint);return ge?xe(ge):"0"}function ae(){te(Q,!f(Q))}function Ae(G){te(g,G,!0)}function de(){te(g,"downloads")}Wn(async()=>{const G=new Bu;await G.init("/custom-renderers.sqlite"),console.log("[uprn-2/page] CustomRendererService initialized");const xe=await G.getCustomRenderer();console.log("[uprn-2/page] Retrieved custom renderer:",xe);const De=await Eo();ut.setFieldInfo(De.serviceUprn2Config.selectionLayersNameFields||[]),te(j,De.serviceUprn2Config.mainSidebarSizes||[],!0),te(b,new Ta(De.serviceUprn2Config.dataSelectionTreeviewConfig),!0),te(C,new Ta(De.serviceUprn2Config.areaSelectionTreeviewConfig),!0);const ge=De.serviceUprn2Config.uprnDownloadServiceEndpoints,ze=De.serviceUprn2Config.aiUprnChatbotServiceEndpoints;te(F,new Du(ge),!0),te(v,new qu(ze),!0),te(N,await f(F).getHealth(),!0),f(N)?console.log("[uprn-2/page] UPRN Download Service is available"):console.warn("[uprn-2/page] UPRN Download Service is NOT available"),te(H,await f(v).getHealth(),!0),f(H)?console.log("[uprn-2/page] AI UPRN Chatbot Service is available"):console.warn("[uprn-2/page] AI UPRN Chatbot Service is NOT available"),te(V,new Set(De.serviceUprn2Config.dataSelectionTreeviewConfig?.fieldsToHide||[]),!0),await u.initializeAsync({portalUrl:De.serviceUprn2Config.portalUrl,itemId:De.serviceUprn2Config.portalItemId||"",proxy:De.serviceUprn2Config.proxy}),console.log("[page] WebMap loaded")}),Wn(()=>{const G=()=>{te(U,window.innerWidth,!0)};return window.addEventListener("resize",G),()=>{window.removeEventListener("resize",G)}}),qa(()=>{ut.cleanup(),p.cleanup(),lr.cleanup(),Ki.cleanup()});var be=Ju(),Pe=le(be);rs(Pe,{});var Ke=Ee(Pe,2);Ns(Ke,{});var oe=Ee(Ke,2);Bl(oe,{get fieldFilterMenuStore(){return c},get fieldsToHide(){return f(V)}});var ue=Ee(oe,2);Ls(ue,{});var ve=Ee(ue,2);{const G=De=>{var ge=Xu(),ze=re(ge);at(ze,()=>Tu,(Je,Ze)=>{Ze(Je,{children:(Ye,Mt)=>{Su(Ye,{get value(){return f(g)},get triggers(){return Lu},onValueChange:Ae})},$$slots:{default:!0}})});var We=Ee(ze,2);at(We,()=>Ou,(Je,Ze)=>{Ze(Je,{children:(Ye,Mt)=>{var bt=Gu(),vt=le(bt),st=re(vt);zi(st,{children:(pt,It)=>{var Ve=Ce(),Ht=le(Ve);{var qt=lt=>{tu(lt,{get webMap(){return u.data},get treeviewStore(){return p},get treeviewConfigStore(){return f(C)}})};qe(Ht,lt=>{u.isLoaded&&lt(qt)})}R(pt,Ve)}}),J(vt);var _e=Ee(vt,2),Y=re(_e);zi(Y,{children:(pt,It)=>{var Ve=Ce(),Ht=le(Ve);{var qt=lt=>{fu(lt,{get webMap(){return u.data},get treeviewConfigStore(){return f(b)},get fieldFilterMenuStore(){return c}})};qe(Ht,lt=>{u.isLoaded&&lt(qt)})}R(pt,Ve)}}),J(_e);var et=Ee(_e,2),wt=re(et);zi(wt,{children:(pt,It)=>{Tl(pt,{get webMapStore(){return u},get areaSelectionTreeviewStore(){return p},get fieldFilterMenuStore(){return c}})}}),J(et);var Oe=Ee(et,2),yt=re(Oe);zi(yt,{children:(pt,It)=>{var Ve=Ce(),Ht=le(Ve);{var qt=_t=>{var ot=Wu();R(_t,ot)},lt=_t=>{pl(_t,{get webMapStore(){return u},get uprnDownloadService(){return f(F)},get fieldsToHide(){return f(V)}})};qe(Ht,_t=>{!f(F)||!f(N)?_t(qt):_t(lt,!1)})}R(pt,Ve)}}),J(Oe),Tt(()=>{vt.hidden=f(g)!=="define-areas",_e.hidden=f(g)!=="select-data",et.hidden=f(g)!=="export",Oe.hidden=f(g)!=="downloads"}),R(Ye,bt)},$$slots:{default:!0}})});var je=Ee(We,2);at(je,()=>Nu,(Je,Ze)=>{Ze(Je,{children:(Ye,Mt)=>{var bt=Qu(),vt=re(bt);yl(vt,{onExportSuccess:de}),J(bt),Tt(()=>bt.hidden=f(g)!=="export"),R(Ye,bt)},$$slots:{default:!0}})});var Me=Ee(je,2);$u(Me,{children:(Je,Ze)=>{var Ye=Ce(),Mt=le(Ye);{var bt=st=>{var _e=Yu();R(st,_e)},vt=st=>{Js(st,{get aiUprnChatbotService(){return f(v)}})};qe(Mt,st=>{!f(v)||!f(H)?st(bt):st(vt,!1)})}R(Je,Ye)},$$slots:{default:!0}}),J(ge),R(De,ge)},xe=De=>{gu(De,{get webMap(){return u.data},get areaSelectionTreeviewStore(){return p},panelPosition:"top-left",menuPosition:"top-right"})};at(ve,()=>Iu,(De,ge)=>{ge(De,{get isOpen(){return f(Q)},onToggle:ae,get position(){return z},get originalSize(){return f(Z)},get minSize(){return f(ie)},sidebarContent:G,mainContent:xe,$$slots:{sidebarContent:!0,mainContent:!0}})})}R(A,be),ft()}export{qc as component};
