const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/C8QWR4pF.js","../chunks/DpeSjMG2.js","../chunks/BIZQK9ru.js","../chunks/Dixwmyno.js","../chunks/w35C-uaM.js","../chunks/PPVm8Dsz.js","../chunks/DL5YDhuI.js","../chunks/Djw9Gov4.js","../chunks/Mt5KK1Z_.js","../chunks/BfGNFCWE.js","../chunks/CLkopWLj.js","../chunks/NIUDGxM9.js","../chunks/DnfFIx56.js","../chunks/DwtTzuix.js","../chunks/B1KdG5Vm.js","../chunks/BZZGCZ0G.js","../chunks/BRzTHeuj.js","../chunks/CyGEjURR.js","../chunks/BOlUPpxD.js","../chunks/D6wORzA5.js","../chunks/D6KPPgz5.js","../chunks/CNCZeU-H.js","../chunks/DGA79LlX.js","../chunks/BwEqPHUQ.js","../chunks/Cl5lrJ4c.js","../chunks/C8JgNZ3x.js","../chunks/MtSiOt06.js","../chunks/C0wm8_Yw.js","../chunks/B-LKPD9B.js","../chunks/Chjpi3L4.js","../chunks/BxxF2K5K.js","../chunks/BrnhpxSe.js","../chunks/Djp3mnm5.js","../chunks/D7c21UBh.js","../chunks/DQOJ18NT.js","../chunks/D5VzVYh5.js","../chunks/SyXYkzcA.js","../chunks/BZSUfw5O.js","../chunks/DxxzICxw.js","../chunks/D1-Bbnis.js","../chunks/EzLf78vY.js","../chunks/BAOqyVDi.js","../chunks/DwXMslh1.js","../chunks/B_Y5zHpf.js","../chunks/DmVQwInr.js","../chunks/DEVuWo1T.js","../chunks/_fi8_dML.js","../chunks/DZd6gJy7.js","../chunks/Bogns-FN.js","../chunks/C8BmVxiO.js","../chunks/CZtpjpnM.js","../chunks/1j1pYN02.js","../chunks/C6wNwRUZ.js","../chunks/CpnbkAIm.js","../chunks/CrpvBj4t.js","../chunks/_uMSq0WP.js","../chunks/9YvG7tFv.js","../chunks/osG3oR1O.js","../chunks/8qchxLA7.js","../chunks/aQeO9QTD.js","../chunks/b67rbN0x.js","../chunks/EdnA6WMy.js","../chunks/CYbKlZVl.js","../chunks/CESBSi8r.js","../chunks/C3ss5c5T.js","../chunks/ChGm0na_.js","../chunks/Con-s-kM.js","../chunks/B9eFHZ-c.js","../chunks/Cv_LxOZA.js","../chunks/BUr4OYAU.js","../chunks/Chk7YAAL.js","../chunks/C4eyRFHZ.js","../chunks/Cgb6qxNH.js","../chunks/BIMf17KL.js","../chunks/BXzkygno.js","../chunks/QQC62dOK.js","../chunks/s6g8Mh6H.js","../chunks/BKzqicii.js","../chunks/Bpd0WbG4.js","../chunks/0XsMeaMz.js","../chunks/DKpmsPfl.js","../chunks/CaVKkSa6.js","../chunks/Do1PcgeY.js","../chunks/BpkG5jEF.js","../chunks/B1N-tmtC.js","../chunks/CASyCajO.js","../chunks/BiphejqT.js","../chunks/ChUxsD4f.js","../chunks/pDuGEAnG.js","../chunks/Bf43_Pan.js","../chunks/BrScpkSj.js","../chunks/rxpTDz6e.js","../chunks/CJ_yvpu1.js","../chunks/Di-oXZFE.js","../chunks/LQx871qB.js","../chunks/CL2NbQte.js","../chunks/DDyKYEg4.js","../chunks/DEORHd4D.js","../chunks/PsIk0YoZ.js","../chunks/Cep3ALYs.js","../chunks/C5CzMsLd.js","../chunks/DfJBcdop.js","../chunks/CYvifV_i.js","../chunks/D5Jbof_K.js","../chunks/CekRXSkd.js","../chunks/qN0_A0b1.js","../chunks/C_qGS9qP.js","../chunks/BV4aMNI2.js","../chunks/ChNf4GDb.js","../chunks/DCdKoteN.js","../chunks/Dzk7VnHJ.js","../chunks/CJNKiax9.js","../chunks/CV5u8O9_.js","../chunks/CvW9ZVsc.js","../chunks/GKolV7NZ.js","../chunks/Ch1yCNz5.js","../chunks/5TZaMWHN.js","../chunks/8knNLaKO.js","../chunks/BHqBUnL2.js","../chunks/rTIYwDOP.js","../chunks/2h2Az7BE.js","../chunks/cEM2YKPq.js","../chunks/B8xzAwSv.js","../chunks/Nxjp7eG7.js","../chunks/VMSlSy0z.js","../chunks/DMf2c78C.js","../chunks/BJTYVH5y.js","../chunks/CbZXq9yy.js","../chunks/DnfyH8r_.js","../chunks/Djbyjfeq.js","../chunks/wDkmYXJM.js","../chunks/DPZxJmJ7.js","../chunks/CMWjJx_t.js","../chunks/ZjqPXI7J.js","../chunks/BpZAkzQs.js","../chunks/WpWZe4en.js","../chunks/BFV0Ojiv.js","../chunks/DQj8aexp.js","../chunks/cpvnOiAG.js","../chunks/DK1FsxTs.js","../chunks/3v4oKDp_.js","../chunks/DIHu76RQ.js","../chunks/0-ZHklBV.js","../chunks/U56EMsPZ.js","../chunks/8P_H7snD.js","../chunks/DkB1Tb7X.js","../chunks/KcazVFlU.js","../chunks/CYsUaMUi.js","../chunks/ieihnHfJ.js","../chunks/DjgkFiVe.js","../chunks/Bdi-4qo-.js","../chunks/Q6IL8MGR.js","../chunks/CmUORUsg.js","../chunks/zbAZN0f9.js","../chunks/BgtvC5K-.js","../chunks/BqMYqny5.js","../chunks/DCdj6Lab.js","../chunks/BXfupK_G.js","../chunks/BkQcsSCB.js","../chunks/DPb6J-GU.js","../chunks/BibdetiK.js","../chunks/B8RMBbaJ.js","../chunks/Cc40Xvju.js","../chunks/DwjSd-ry.js","../chunks/DLEWNlhh.js","../chunks/D7MIEWzD.js","../chunks/CzWmY7dq.js","../chunks/D4iPbchN.js","../chunks/DoiCzofL.js","../chunks/DjgObdp-.js","../chunks/tQ1PnY8g.js","../chunks/CqJ2jxT2.js","../chunks/CocNPb3x.js","../chunks/CQCqRlUn.js","../chunks/DjJ-Vq3m.js","../chunks/DNhkfSxa.js","../chunks/DsHDw-MJ.js"])))=>i.map(i=>d[i]);
import{p as oo,c as se,a as D,f as oe,t as Cr}from"../chunks/Cp6gagLc.js";import{o as kr,a as _a}from"../chunks/BEugbry3.js";import{C as so,E as lo,b8 as uo,b9 as co,L as fo,t as ho,ba as vo,bb as po,bc as go,Z as Sa,am as yo,N as mo,a as Qe,ay as pe,x as l,ab as K,p as Re,f as $,b as He,c as Q,r as U,aw as re,ag as qe,u as Ze,B as dt,a4 as de,n as fr}from"../chunks/CGuDK3cH.js";import{p as Fe,i as ye,r as Lt,l as Pr,s as kt}from"../chunks/CYzw9kj_.js";import{c as Le}from"../chunks/BQask9zx.js";import{b as Pt}from"../chunks/CGMUYGDS.js";import{b as bo,s as Tt}from"../chunks/CGgxIKi_.js";import{a as On,e as Ir,s as bi,d as tr,b as wo}from"../chunks/C52hcmTJ.js";import{I as Tr,n as Er,d as Pn,c as Tn,S as xa,s as _o,X as So,e as xo,f as Co,g as ko,h as Io,i as Ao,j as Oo,C as Po,k as To}from"../chunks/Ez3IfIhj.js";import di from"../chunks/Cep3ALYs.js";import{S as dr,t as hr,k as Eo,l as Do,m as Fo,n as Lo,L as No,o as Mo,h as Ro,i as Ho,C as ea,j as jo,I as zo,G as ta,F as ra,b as Vo,O as Ca,a as Ko,d as ka,c as yn,p as Bo,r as qo,M as $o,V as na,f as Uo,e as Go,g as Wo,s as Yo,q as Jo}from"../chunks/C-DBgWsx.js";import{C as Qo,D as Xo,l as Zo,o as es,z as ts,b as mn,B as rs,p as Rt,$ as ns,a0 as is,c as as}from"../chunks/VT3kn57n.js";import{s as $e,I as Dr,a as zt,i as Ar}from"../chunks/Cl7Mgxd0.js";import{g as os,d as En}from"../chunks/CU0SCnmu.js";import{c as Dn,B as Ot}from"../chunks/CGsbJcZG.js";import{I as ss,C as ls}from"../chunks/CmL7bQEc.js";import"../chunks/Ce60uIQL.js";import{b as us}from"../chunks/Dzq2RSpJ.js";import"../chunks/fuL_5N5w.js";import{j as cs}from"../chunks/CJ_yvpu1.js";import ds from"../chunks/BZZGCZ0G.js";import{s as ia}from"../chunks/BIZQK9ru.js";import{O as fs}from"../chunks/Djw9Gov4.js";import{h as qr}from"../chunks/yDTRCkMh.js";import{h as aa}from"../chunks/SyXYkzcA.js";import"../chunks/CMIdJdQ8.js";import{l as hs}from"../chunks/BfGNFCWE.js";import"../chunks/Dixwmyno.js";import"../chunks/DpeSjMG2.js";import{_ as bn}from"../chunks/PPVm8Dsz.js";import"../chunks/BV4aMNI2.js";import{j as oa}from"../chunks/DkB1Tb7X.js";import{m as sa}from"../chunks/C_qGS9qP.js";import{a as la,m as ua}from"../chunks/8qchxLA7.js";import{l as wn}from"../chunks/BOlUPpxD.js";import{C as vs}from"../chunks/C7OPQEgL.js";const ps=()=>performance.now(),$t={tick:S=>requestAnimationFrame(S),now:()=>ps(),tasks:new Set};function Ia(){const S=$t.now();$t.tasks.forEach(r=>{r.c(S)||($t.tasks.delete(r),r.f())}),$t.tasks.size!==0&&$t.tick(Ia)}function gs(S){let r;return $t.tasks.size===0&&$t.tick(Ia),{promise:new Promise(o=>{$t.tasks.add(r={c:S,f:o})}),abort(){$t.tasks.delete(r)}}}function _n(S,r){Sa(()=>{S.dispatchEvent(new CustomEvent(r))})}function ys(S){if(S==="float")return"cssFloat";if(S==="offset")return"cssOffset";if(S.startsWith("--"))return S;const r=S.split("-");return r.length===1?r[0]:r[0]+r.slice(1).map(o=>o[0].toUpperCase()+o.slice(1)).join("")}function ca(S){const r={},o=S.split(";");for(const s of o){const[c,h]=s.split(":");if(!c||h===void 0)break;const d=ys(c.trim());r[d]=h.trim()}return r}const ms=S=>S;function In(S,r,o,s){var c=(S&po)!==0,h=(S&go)!==0,d=c&&h,g=(S&vo)!==0,T=d?"both":c?"in":"out",I,C=r.inert,F=r.style.overflow,E,Y;function M(){return Sa(()=>I??=o()(r,s?.()??{},{direction:T}))}var N={is_global:g,in(){if(r.inert=C,!c){Y?.abort(),Y?.reset?.();return}h||E?.abort(),_n(r,"introstart"),E=fi(r,M(),Y,1,()=>{_n(r,"introend"),E?.abort(),E=I=void 0,r.style.overflow=F})},out(j){if(!h){j?.(),I=void 0;return}r.inert=!0,_n(r,"outrostart"),Y=fi(r,M(),E,0,()=>{_n(r,"outroend"),j?.()})},stop:()=>{E?.abort(),Y?.abort()}},z=so;if((z.transitions??=[]).push(N),c&&bo){var H=g;if(!H){for(var V=z.parent;V&&(V.f&lo)!==0;)for(;(V=V.parent)&&(V.f&uo)===0;);H=!V||(V.f&co)!==0}H&&fo(()=>{ho(()=>N.in())})}}function fi(S,r,o,s,c){var h=s===1;if(yo(r)){var d,g=!1;return mo(()=>{if(!g){var z=r({direction:h?"in":"out"});d=fi(S,z,o,s,c)}}),{abort:()=>{g=!0,d?.abort()},deactivate:()=>d.deactivate(),reset:()=>d.reset(),t:()=>d.t()}}if(o?.deactivate(),!r?.duration)return c(),{abort:Qe,deactivate:Qe,reset:Qe,t:()=>s};const{delay:T=0,css:I,tick:C,easing:F=ms}=r;var E=[];if(h&&o===void 0&&(C&&C(0,1),I)){var Y=ca(I(0,1));E.push(Y,Y)}var M=()=>1-s,N=S.animate(E,{duration:T,fill:"forwards"});return N.onfinish=()=>{N.cancel();var z=o?.t()??1-s;o?.abort();var H=s-z,V=r.duration*Math.abs(H),j=[];if(V>0){var W=!1;if(I)for(var ce=Math.ceil(V/16.666666666666668),X=0;X<=ce;X+=1){var he=z+H*F(X/ce),_e=ca(I(he,1-he));j.push(_e),W||=_e.overflow==="hidden"}W&&(S.style.overflow="hidden"),M=()=>{var Oe=N.currentTime;return z+H*F(Oe/V)},C&&gs(()=>{if(N.playState!=="running")return!1;var Oe=M();return C(Oe,1-Oe),!0})}N=S.animate(j,{duration:V,fill:"forwards"}),N.onfinish=()=>{M=()=>s,C?.(s,1-s),c()}},{abort:()=>{N&&(N.cancel(),N.effect=null,N.onfinish=Qe)},deactivate:()=>{c=Qe},reset:()=>{s===0&&C?.(1,0)},t:()=>M()}}const bs=es({component:"avatar",parts:["root","image","fallback"]}),ws=new Qo("Avatar.Root");class wi{static create(r){return ws.set(new wi(r))}opts;domContext;attachment;constructor(r){this.opts=r,this.domContext=new Xo(this.opts.ref),this.loadImage=this.loadImage.bind(this),this.attachment=Zo(this.opts.ref)}loadImage(r,o,s){if(this.opts.loadingStatus.current==="loaded")return;let c;const h=new Image;return h.src=r,o!==void 0&&(h.crossOrigin=o),s&&(h.referrerPolicy=s),this.opts.loadingStatus.current="loading",h.onload=()=>{c=this.domContext.setTimeout(()=>{this.opts.loadingStatus.current="loaded"},this.opts.delayMs.current)},h.onerror=()=>{this.opts.loadingStatus.current="error"},()=>{c&&this.domContext.clearTimeout(c)}}#e=pe(()=>({id:this.opts.id.current,[bs.root]:"","data-status":this.opts.loadingStatus.current,...this.attachment}));get props(){return l(this.#e)}set props(r){K(this.#e,r)}}var _s=oe("<div><!></div>");function Ss(S,r){const o=oo();Re(r,!0);let s=Fe(r,"delayMs",3,0),c=Fe(r,"loadingStatus",15,"loading"),h=Fe(r,"id",19,()=>ts(o)),d=Fe(r,"ref",15,null),g=Lt(r,["$$slots","$$events","$$legacy","delayMs","loadingStatus","onLoadingStatusChange","child","children","id","ref"]);const T=wi.create({delayMs:mn(()=>s()),loadingStatus:mn(()=>c(),M=>{c()!==M&&(c(M),r.onLoadingStatusChange?.(M))}),id:mn(()=>h()),ref:mn(()=>d(),M=>d(M))}),I=pe(()=>rs(g,T.props));var C=se(),F=$(C);{var E=M=>{var N=se(),z=$(N);$e(z,()=>r.child,()=>({props:l(I)})),D(M,N)},Y=M=>{var N=_s();On(N,()=>({...l(I)}));var z=Q(N);$e(z,()=>r.children??Qe),U(N),D(M,N)};ye(F,M=>{r.child?M(E):M(Y,!1)})}D(S,C),He()}function xs(S,r){const o=Pr(r,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"m6 9 6 6 6-6"}]];Tr(S,kt({name:"chevron-down"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=se(),g=$(d);Er(g,r,"default",{}),D(c,d)},$$slots:{default:!0}}))}function Cs(S,r){const o=Pr(r,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"m15 18-6-6 6-6"}]];Tr(S,kt({name:"chevron-left"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=se(),g=$(d);Er(g,r,"default",{}),D(c,d)},$$slots:{default:!0}}))}function ks(S,r){const o=Pr(r,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"m18 15-6-6-6 6"}]];Tr(S,kt({name:"chevron-up"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=se(),g=$(d);Er(g,r,"default",{}),D(c,d)},$$slots:{default:!0}}))}function Is(S,r){const o=Pr(r,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"M12 15V3"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}],["path",{d:"m7 10 5 5 5-5"}]];Tr(S,kt({name:"download"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=se(),g=$(d);Er(g,r,"default",{}),D(c,d)},$$slots:{default:!0}}))}function As(S,r){const o=Pr(r,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"M4 5h16"}],["path",{d:"M4 12h16"}],["path",{d:"M4 19h16"}]];Tr(S,kt({name:"menu"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=se(),g=$(d);Er(g,r,"default",{}),D(c,d)},$$slots:{default:!0}}))}function Os(S,r){const o=Pr(r,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const s=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}],["path",{d:"M3 6h18"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}]];Tr(S,kt({name:"trash"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=se(),g=$(d);Er(g,r,"default",{}),D(c,d)},$$slots:{default:!0}}))}function Ps(S,r){Re(r,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let o=Lt(r,["$$slots","$$events","$$legacy"]);const s=[["path",{d:"M12 17V3"}],["path",{d:"m6 11 6 6 6-6"}],["path",{d:"M19 21H5"}]];Dr(S,kt({name:"arrow-down-to-line"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=se(),g=$(d);$e(g,()=>r.children??Qe),D(c,d)},$$slots:{default:!0}})),He()}function Ts(S,r){Re(r,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let o=Lt(r,["$$slots","$$events","$$legacy"]);const s=[["path",{d:"M12 5v14"}],["path",{d:"m19 12-7 7-7-7"}]];Dr(S,kt({name:"arrow-down"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=se(),g=$(d);$e(g,()=>r.children??Qe),D(c,d)},$$slots:{default:!0}})),He()}function Es(S,r){Re(r,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let o=Lt(r,["$$slots","$$events","$$legacy"]);const s=[["path",{d:"m18 15-6-6-6 6"}]];Dr(S,kt({name:"chevron-up"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=se(),g=$(d);$e(g,()=>r.children??Qe),D(c,d)},$$slots:{default:!0}})),He()}function Ds(S,r){Re(r,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let o=Lt(r,["$$slots","$$events","$$legacy"]);const s=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3"}]];Dr(S,kt({name:"maximize"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=se(),g=$(d);$e(g,()=>r.children??Qe),D(c,d)},$$slots:{default:!0}})),He()}function Fs(S,r){Re(r,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let o=Lt(r,["$$slots","$$events","$$legacy"]);const s=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3"}]];Dr(S,kt({name:"minimize"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=se(),g=$(d);$e(g,()=>r.children??Qe),D(c,d)},$$slots:{default:!0}})),He()}function Ls(S,r){Re(r,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let o=Lt(r,["$$slots","$$events","$$legacy"]);const s=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"}],["path",{d:"m21.854 2.147-10.94 10.939"}]];Dr(S,kt({name:"send"},()=>o,{get iconNode(){return s},children:(c,h)=>{var d=se(),g=$(d);$e(g,()=>r.children??Qe),D(c,d)},$$slots:{default:!0}})),He()}class Ns{#e=re(null);get visibleLayer(){return l(this.#e)}set visibleLayer(r){K(this.#e,r,!0)}#t=re(qe({featureLayerView:null,areaInfos:[]}));get layerHighlightState(){return l(this.#t)}set layerHighlightState(r){K(this.#t,r,!0)}#r=re(null);get lastAddedArea(){return l(this.#r)}set lastAddedArea(r){K(this.#r,r,!0)}#n=re(null);get lastRemovedArea(){return l(this.#n)}set lastRemovedArea(r){K(this.#n,r,!0)}#o=re(null);get currentHoveredArea(){return l(this.#o)}set currentHoveredArea(r){K(this.#o,r,!0)}#i=re(qe(new dr));get areaSelectionLayerIds(){return l(this.#i)}set areaSelectionLayerIds(r){K(this.#i,r,!0)}#a=[];#s=new Rt;setFieldInfo(r){console.log("Setting field info:",r),this.#a=r}setSelectedLayerView(r){this.layerHighlightState?.featureLayerView!==r&&(this.layerHighlightState&&this.layerHighlightState.areaInfos.forEach(o=>{o.handle.remove()}),this.layerHighlightState={featureLayerView:r,areaInfos:[]})}clearSelectedLayerView(){this.layerHighlightState.featureLayerView!==null&&(this.resetSelectedAreas(),this.layerHighlightState.featureLayerView=null)}resetSelectedAreas(){!this.layerHighlightState.featureLayerView&&this.layerHighlightState.areaInfos.length===0||(this.layerHighlightState&&this.layerHighlightState.areaInfos.forEach(r=>{r.handle.remove()}),this.visibleLayer=null,this.layerHighlightState={featureLayerView:null,areaInfos:[]})}addSelectedArea(r,o){if(!this.layerHighlightState){console.warn("SelectedAreasStore: No feature layer view is set.");return}const s={id:r,handle:o};this.layerHighlightState.areaInfos.push(s),this.lastAddedArea=s}removeSelectedArea(r){if(!this.layerHighlightState){console.warn("SelectedAreasStore: No feature layer view is set.");return}const o=this.layerHighlightState.areaInfos.findIndex(s=>s.id===r);o!==-1&&(this.lastRemovedArea={id:r,handle:this.layerHighlightState.areaInfos[o].handle},this.layerHighlightState.areaInfos[o].handle.remove(),this.layerHighlightState.areaInfos.splice(o,1))}async getAreaNamesById(r){if(!this.layerHighlightState?.featureLayerView)return[];const o=this.getNameFieldForCurrentLayer();if(!o)return[];const s=this.layerHighlightState.featureLayerView.layer;let c=this.#s.get(s.uid);c||(c=new Rt,this.#s.set(s.uid,c));const h=new Array(r.length),d=new Rt,g=[];if(r.forEach((C,F)=>{d.set(C,F);const E=c.get(C);E!==void 0?h[F]=E:g.push(C)}),g.length===0)return h.map(C=>C??"");const T=s.objectIdField,I=await s.queryFeatures({objectIds:g,outFields:[o,T],returnGeometry:!1});for(const C of I.features){const F=C.attributes[T],E=C.attributes[o],Y=d.get(F);Y!==void 0&&(h[Y]=E??"",c.set(F,E??""))}return h.map(C=>C??"")}async getAreaCodesById(r){if(!this.layerHighlightState?.featureLayerView)return[];const o=this.getCodeFieldForCurrentLayer();if(!o)return[];const s=this.layerHighlightState.featureLayerView.layer,c=s.objectIdField,h=await s.queryFeatures({objectIds:r,outFields:[o,c],returnGeometry:!1}),d=new Array(r.length);for(const g of h.features){const T=g.attributes[c],I=g.attributes[o],C=r.indexOf(T);C!==-1&&(d[C]=I??"")}return d.map(g=>g??"")}setHoveredArea(r,o){this.currentHoveredArea&&this.clearHoveredArea(),this.currentHoveredArea={id:r,handle:o}}clearHoveredArea(){this.currentHoveredArea&&(this.currentHoveredArea?.handle.remove(),this.currentHoveredArea=null)}getNameFieldForCurrentLayer(){if(!this.layerHighlightState||!this.layerHighlightState.featureLayerView||!this.layerHighlightState.featureLayerView.layer)return null;const r=this.#a.find(o=>o.layerName===this.layerHighlightState?.featureLayerView?.layer?.title)?.nameField;return r||(console.warn(`SelectedAreasStore: No name field configured for layer ${this.layerHighlightState.featureLayerView.layer.title}`,this.#a),null)}getCodeFieldForCurrentLayer(){if(!this.layerHighlightState||!this.layerHighlightState.featureLayerView||!this.layerHighlightState.featureLayerView.layer)return null;const r=this.#a.find(o=>o.layerName===this.layerHighlightState?.featureLayerView?.layer?.title)?.codeField;return r||(console.warn(`SelectedAreasStore: No code field configured for layer ${this.layerHighlightState.featureLayerView.layer.title}`,this.#a),null)}clearSelections(){this.resetSelectedAreas(),this.clearHoveredArea(),this.lastAddedArea=null,this.lastRemovedArea=null,this.currentHoveredArea=null,console.log("[area-selection-store] selections cleared.")}cleanup(){this.resetSelectedAreas(),this.clearHoveredArea(),this.lastAddedArea=null,this.lastRemovedArea=null,this.currentHoveredArea=null,this.#s.clear(),this.#a=[],console.log("[area-selection-store] cleaned up.")}}const Pe=new Ns;var Ms=oe('<p class="text-sm font-medium"> </p>'),Rs=oe('<div class="pointer-events-none fixed z-50 transition-opacity duration-200"><!></div>');function Hs(S,r){Re(r,!0);let o=re(null),s=re(qe({x:0,y:0})),c=0;const h=I=>{K(s,{x:I.clientX,y:I.clientY},!0)};Ze(()=>(document.addEventListener("mousemove",h),()=>{document.removeEventListener("mousemove",h)})),Ze(()=>{const I=Pe.currentHoveredArea?.id,C=++c;if(!I){K(o,null);return}(async()=>{const F=await Pe.getAreaNamesById([I]);C===c&&Pe.currentHoveredArea?.id===I&&K(o,F[0]??null,!0)})()});var d=se(),g=$(d);{var T=I=>{var C=Rs(),F=Q(C);Le(F,()=>Tn,(E,Y)=>{Y(E,{class:"max-w-xs border !py-2 shadow-lg",children:(M,N)=>{var z=se(),H=$(z);Le(H,()=>Pn,(V,j)=>{j(V,{class:"!px-3 !py-0",children:(W,ce)=>{var X=Ms(),he=Q(X,!0);U(X),dt(()=>Tt(he,l(o))),D(W,X)},$$slots:{default:!0}})}),D(M,z)},$$slots:{default:!0}})}),U(C),dt(()=>Ir(C,`left: ${l(s).x+10}px; top: ${l(s).y-10}px;`)),D(I,C)};ye(g,I=>{l(o)&&I(T)})}D(S,d),He()}function js(S,r){Re(r,!0);async function o(s,c){const h=await Pe.getAreaNamesById([s]);if(!h||h.length===0||!h[0])return;const d=`Area ${c}: ${h[0]}`;hr.success(d)}Ze(()=>{Pe.lastAddedArea&&o(Pe.lastAddedArea.id,"added")}),Ze(()=>{Pe.lastRemovedArea&&o(Pe.lastRemovedArea.id,"removed")}),He()}var zs=oe("<div><!></div>");function da(S,r){Re(r,!0);let o=Fe(r,"ref",15,null),s=Lt(r,["$$slots","$$events","$$legacy","ref","variant","children"]);var c=zs();On(c,()=>({...s,class:"group/chat-bubble flex max-w-[80%] flex-row place-items-end gap-2 data-[variant='sent']:place-self-end","data-variant":r.variant}));var h=Q(c);$e(h,()=>r.children??Qe),U(c),Pt(c,d=>o(d),()=>o()),D(S,c),He()}var Vs=oe('<span class="inline-block size-(--loading-dots-size) rounded-full bg-primary svelte-k2x6sv"></span>'),Ks=oe('<div class="inline-flex items-center gap-1 svelte-k2x6sv"></div>');function Bs(S,r){let o=Fe(r,"size",3,4);var s=Ks();let c;zt(s,20,()=>({length:3}),Ar,(h,d)=>{var g=Vs();D(h,g)}),U(s),dt(h=>c=Ir(s,"",c,h),[()=>({"--loading-dots-size":`${o()??""}px`})]),D(S,s)}var qs=oe('<div class="flex size-full place-items-center justify-center"><!></div>'),$s=oe("<div><!></div>");function ci(S,r){Re(r,!0);let o=Fe(r,"ref",15,null),s=Fe(r,"typing",3,!1),c=Lt(r,["$$slots","$$events","$$legacy","ref","typing","class","children"]);var h=$s();On(h,I=>({...c,class:I}),[()=>Dn("order-2 rounded-lg bg-secondary p-4 text-sm group-data-[variant='received']/chat-bubble:rounded-bl-none group-data-[variant='sent']/chat-bubble:order-1 group-data-[variant='sent']/chat-bubble:rounded-br-none group-data-[variant='sent']/chat-bubble:bg-primary group-data-[variant='sent']/chat-bubble:text-primary-foreground",r.class)]);var d=Q(h);{var g=I=>{var C=qs(),F=Q(C);Bs(F,{}),U(C),D(I,C)},T=I=>{var C=se(),F=$(C);$e(F,()=>r.children??Qe),D(I,C)};ye(d,I=>{s()?I(g):I(T,!1)})}U(h),Pt(h,I=>o(I),()=>o()),D(S,h),He()}function Us(S,r){Re(r,!0);let o=Fe(r,"ref",15,null),s=Lt(r,["$$slots","$$events","$$legacy","ref","class"]);var c=se(),h=$(c);{let d=pe(()=>Dn("relative flex size-8 shrink-0 overflow-hidden rounded-full",r.class));Le(h,()=>Ss,(g,T)=>{T(g,kt({"data-slot":"avatar",get class(){return l(d)}},()=>s,{get ref(){return o()},set ref(I){o(I)}}))})}D(S,c),He()}function fa(S,r){Re(r,!0);let o=Fe(r,"ref",15,null),s=Lt(r,["$$slots","$$events","$$legacy","ref","class"]);{let c=pe(()=>Dn("order-1 group-data-[variant='sent']/chat-bubble:order-2",r.class));Us(S,kt({get class(){return l(c)}},()=>s,{get ref(){return o()},set ref(h){o(h)}}))}He()}function Aa(S){const r=S-1;return r*r*r+1}function ha(S,{delay:r=0,duration:o=400,easing:s=Aa,axis:c="y"}={}){const h=getComputedStyle(S),d=+h.opacity,g=c==="y"?"height":"width",T=parseFloat(h[g]),I=c==="y"?["top","bottom"]:["left","right"],C=I.map(H=>`${H[0].toUpperCase()}${H.slice(1)}`),F=parseFloat(h[`padding${C[0]}`]),E=parseFloat(h[`padding${C[1]}`]),Y=parseFloat(h[`margin${C[0]}`]),M=parseFloat(h[`margin${C[1]}`]),N=parseFloat(h[`border${C[0]}Width`]),z=parseFloat(h[`border${C[1]}Width`]);return{delay:r,duration:o,easing:s,css:H=>`overflow: hidden;opacity: ${Math.min(H*20,1)*d};${g}: ${H*T}px;padding-${I[0]}: ${H*F}px;padding-${I[1]}: ${H*E}px;margin-${I[0]}: ${H*Y}px;margin-${I[1]}: ${H*M}px;border-${I[0]}-width: ${H*N}px;border-${I[1]}-width: ${H*z}px;min-${g}: 0`}}function va(S,{delay:r=0,duration:o=400,easing:s=Aa,start:c=0,opacity:h=0}={}){const d=getComputedStyle(S),g=+d.opacity,T=d.transform==="none"?"":d.transform,I=1-c,C=g*(1-h);return{delay:r,duration:o,easing:s,css:(F,E)=>`
			transform: ${T} scale(${1-I*E});
			opacity: ${g-C*E}
		`}}class Gs{#e=re();#t=re(0);#r=re(!1);lastScrollHeight=0;set ref(r){if(K(this.#e,r,!0),!l(this.#e))return;this.lastScrollHeight=l(this.#e).scrollHeight,l(this.#e).scrollTo(0,l(this.#t)?l(this.#t):l(this.#e).scrollHeight),l(this.#e).addEventListener("scroll",()=>{l(this.#e)&&(K(this.#t,l(this.#e).scrollTop,!0),this.disableAutoScroll())}),window.addEventListener("resize",()=>{this.scrollToBottom(!0)}),new MutationObserver(()=>{l(this.#e)&&(l(this.#e).scrollHeight!==this.lastScrollHeight&&this.scrollToBottom(!0),this.lastScrollHeight=l(this.#e).scrollHeight)}).observe(l(this.#e),{childList:!0,subtree:!0})}get ref(){return l(this.#e)}get scrollY(){return l(this.#t)}get isAtBottom(){return l(this.#e)?l(this.#t)+l(this.#e).offsetHeight>=l(this.#e).scrollHeight:!0}disableAutoScroll(){this.isAtBottom?K(this.#r,!1):K(this.#r,!0)}scrollToBottom(r=!1){l(this.#e)&&(r&&l(this.#r)||l(this.#e).scrollTo(0,l(this.#e).scrollHeight))}}var Ws=oe("<div><!></div>"),Ys=oe('<div class="relative"><div><!></div> <!></div>');function Js(S,r){Re(r,!0);let o=Fe(r,"ref",15,null),s=Lt(r,["$$slots","$$events","$$legacy","ref","children","class"]),c=re(!1);const h=new Gs;kr(()=>{K(c,!0)});var d=Ys(),g=Q(d);On(g,F=>({...s,class:F}),[()=>Dn("no-scrollbar flex h-full w-full flex-col gap-4 overflow-y-auto p-4",r.class,{"scroll-smooth":l(c)})]);var T=Q(g);$e(T,()=>r.children??Qe),U(g),Pt(g,F=>o(F),()=>o()),Pt(g,F=>h.ref=F,()=>h?.ref);var I=de(g,2);{var C=F=>{var E=Ws(),Y=Q(E);Ot(Y,{onclick:()=>h.scrollToBottom(),variant:"outline",size:"icon",class:"absolute bottom-2 left-1/2 inline-flex -translate-x-1/2 transform rounded-full shadow-md",children:(M,N)=>{Ts(M,{})},$$slots:{default:!0}}),U(E),In(1,E,()=>va,()=>({start:.85,duration:100,delay:250})),In(2,E,()=>va,()=>({start:.85,duration:100})),D(F,E)};ye(I,F=>{h.isAtBottom||F(C)})}U(d),D(S,d),He()}var Qs=oe(`<p class="break-words whitespace-pre-wrap"> </p> <div class="w-full text-xs group-data-[variant='sent']/chat-bubble:text-end"> </div>`,1),Xs=oe("<!> <!>",1),Zs=oe('<p class="break-words whitespace-pre-wrap"> </p>'),el=oe("<!> <!>",1),tl=oe("<!> <!>",1),rl=oe('<div class="chat-container h-full w-full border border-border svelte-1osgd7m"><div class="message-wrapper svelte-1osgd7m"><!></div> <div class="input-wrapper svelte-1osgd7m"><form class="flex shrink-0 items-center gap-2 border-t border-border bg-background p-2"><!> <!></form></div></div>');function nl(S,r){Re(r,!0);const o=1,s=2,c="Sorry, I encountered an error processing your request.",h="How can I help?";let d=re(""),g=re(!1),T=re(""),I=re(null),C=re(null),F=re(null);const E=qe([{senderId:o,message:h,sentAt:Y(new Date)}]);Ze(()=>{if(l(C)&&l(F)){const ue=l(C),Se=l(F),ke=()=>{const le=ue.offsetHeight;Se.style.paddingBottom=`${le}px`};ke();const xe=new ResizeObserver(ke);return xe.observe(ue),()=>{xe.disconnect()}}}),Ze(()=>{E.length,l(T),l(I)&&setTimeout(()=>{const ue=l(I)?.querySelector('[data-slot="scroll-area-viewport"]');ue&&(ue.scrollTop=ue.scrollHeight)},0)});function Y(ue){const Se=ue.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),ke=ue.getHours()>=12?"PM":"AM";return`${Se} ${ke}`}function M(ue,Se){return{message:ue,senderId:Se,sentAt:Y(new Date)}}function N(ue,Se){E.push(M(ue,Se))}function z(){K(g,!1),K(T,"")}function H(ue){K(T,l(T)+ue)}async function V(ue){if(ue.preventDefault(),!l(d).trim()||l(g))return;const Se=l(d).trim();K(d,""),N(Se,s),K(g,!0),K(T,"");try{await r.aiUprnChatbotService.chatStream(Se,H)&&l(T)?N(l(T),o):N(c,o)}catch(ke){console.error("Chat error:",ke),N(c,o)}finally{z()}}var j=rl(),W=Q(j),ce=Q(W);xa(ce,{class:"h-full w-full",get ref(){return l(I)},set ref(ue){K(I,ue,!0)},children:(ue,Se)=>{var ke=se(),xe=$(ke);Le(xe,()=>Js,(le,Ce)=>{Ce(le,{children:(je,ie)=>{var ge=tl(),ve=$(ge);zt(ve,16,()=>E,Xe=>Xe,(Xe,Ge)=>{var at=se(),be=$(at);{let Ee=pe(()=>Ge.senderId===s?"sent":"received");Le(be,()=>da,(Me,ot)=>{ot(Me,{get variant(){return l(Ee)},children:(Z,lt)=>{var Ke=Xs(),we=$(Ke);Le(we,()=>fa,(ft,nt)=>{nt(ft,{})});var Be=de(we,2);Le(Be,()=>ci,(ft,nt)=>{nt(ft,{class:"flex flex-col gap-1",children:(vt,It)=>{var pt=Qs(),et=$(pt),We=Q(et,!0);U(et);var Ye=de(et,2),ht=Q(Ye,!0);U(Ye),dt(()=>{Tt(We,Ge.message),Tt(ht,Ge.sentAt)}),D(vt,pt)},$$slots:{default:!0}})}),D(Z,Ke)},$$slots:{default:!0}})})}D(Xe,at)});var me=de(ve,2);{var Ue=Xe=>{var Ge=se(),at=$(Ge);Le(at,()=>da,(be,Ee)=>{Ee(be,{variant:"received",children:(Me,ot)=>{var Z=el(),lt=$(Z);Le(lt,()=>fa,(we,Be)=>{Be(we,{})});var Ke=de(lt,2);Le(Ke,()=>ci,(we,Be)=>{Be(we,{class:"flex flex-col gap-1",children:(ft,nt)=>{var vt=se(),It=$(vt);{var pt=We=>{var Ye=Zs(),ht=Q(Ye,!0);U(Ye),dt(()=>Tt(ht,l(T))),D(We,Ye)},et=We=>{var Ye=se(),ht=$(Ye);Le(ht,()=>ci,(St,Nt)=>{Nt(St,{typing:!0})}),D(We,Ye)};ye(It,We=>{l(T)?We(pt):We(et,!1)})}D(ft,vt)},$$slots:{default:!0}})}),D(Me,Z)},$$slots:{default:!0}})}),D(Xe,Ge)};ye(me,Xe=>{l(g)&&Xe(Ue)})}D(je,ge)},$$slots:{default:!0}})}),D(ue,ke)},$$slots:{default:!0}}),U(W),Pt(W,ue=>K(F,ue),()=>l(F));var X=de(W,2),he=Q(X),_e=Q(he);ss(_e,{class:"rounded-full",placeholder:"Type a message...",get disabled(){return l(g)},get value(){return l(d)},set value(ue){K(d,ue,!0)}});var Oe=de(_e,2);{let ue=pe(()=>l(d).trim()===""||l(g));Ot(Oe,{type:"submit",variant:"default",size:"icon",class:"shrink-0 rounded-full",get disabled(){return l(ue)},children:(Se,ke)=>{Ls(Se,{})},$$slots:{default:!0}})}U(he),Pt(he,ue=>K(C,ue),()=>l(C)),U(X),U(j),os("submit",he,V),D(S,j),He()}const Zt=Object.freeze({Pending:"pending",InProgress:"in-progress",Completed:"completed",Failed:"failed"}),Sn=Object.freeze({Submitted:"SUBMITTED",Queued:"QUEUED",Processing:"IN_PROGRESS",Completed:"COMPLETED",Error:"ERROR"}),il=Object.freeze({Success:"success",Error:"error"});var Cn={exports:{}},al=Cn.exports,pa;function ol(){return pa||(pa=1,(function(S,r){(function(o,s){S.exports=s()})(al,function(){var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])})(e,t)},s=function(){return(s=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function c(e,t,n){for(var i,a=0,u=t.length;a<u;a++)!i&&a in t||((i=i||Array.prototype.slice.call(t,0,a))[a]=t[a]);return e.concat(i||Array.prototype.slice.call(t))}var h=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:ns,d=Object.keys,g=Array.isArray;function T(e,t){return typeof t!="object"||d(t).forEach(function(n){e[n]=t[n]}),e}typeof Promise>"u"||h.Promise||(h.Promise=Promise);var I=Object.getPrototypeOf,C={}.hasOwnProperty;function F(e,t){return C.call(e,t)}function E(e,t){typeof t=="function"&&(t=t(I(e))),(typeof Reflect>"u"?d:Reflect.ownKeys)(t).forEach(function(n){M(e,n,t[n])})}var Y=Object.defineProperty;function M(e,t,n,i){Y(e,t,T(n&&F(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},i))}function N(e){return{from:function(t){return e.prototype=Object.create(t.prototype),M(e.prototype,"constructor",e),{extend:E.bind(null,e.prototype)}}}}var z=Object.getOwnPropertyDescriptor,H=[].slice;function V(e,t,n){return H.call(e,t,n)}function j(e,t){return t(e)}function W(e){if(!e)throw new Error("Assertion Failed")}function ce(e){h.setImmediate?setImmediate(e):setTimeout(e,0)}function X(e,t){if(typeof t=="string"&&F(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],i=0,a=t.length;i<a;++i){var u=X(e,t[i]);n.push(u)}return n}var f=t.indexOf(".");if(f!==-1){var v=e[t.substr(0,f)];return v==null?void 0:X(v,t.substr(f+1))}}function he(e,t,n){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){W(typeof n!="string"&&"length"in n);for(var i=0,a=t.length;i<a;++i)he(e,t[i],n[i])}else{var u,f,v=t.indexOf(".");v!==-1?(u=t.substr(0,v),(f=t.substr(v+1))===""?n===void 0?g(e)&&!isNaN(parseInt(u))?e.splice(u,1):delete e[u]:e[u]=n:he(v=!(v=e[u])||!F(e,u)?e[u]={}:v,f,n)):n===void 0?g(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function _e(e){var t,n={};for(t in e)F(e,t)&&(n[t]=e[t]);return n}var Oe=[].concat;function ue(e){return Oe.apply([],e)}var st="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ue([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return h[e]}),Se=new Set(st.map(function(e){return h[e]})),ke=null;function xe(e){return ke=new WeakMap,e=(function t(n){if(!n||typeof n!="object")return n;var i=ke.get(n);if(i)return i;if(g(n)){i=[],ke.set(n,i);for(var a=0,u=n.length;a<u;++a)i.push(t(n[a]))}else if(Se.has(n.constructor))i=n;else{var f,v=I(n);for(f in i=v===Object.prototype?{}:Object.create(v),ke.set(n,i),n)F(n,f)&&(i[f]=t(n[f]))}return i})(e),ke=null,e}var le={}.toString;function Ce(e){return le.call(e).slice(8,-1)}var je=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ie=typeof je=="symbol"?function(e){var t;return e!=null&&(t=e[je])&&t.apply(e)}:function(){return null};function ge(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var ve={};function me(e){var t,n,i,a;if(arguments.length===1){if(g(e))return e.slice();if(this===ve&&typeof e=="string")return[e];if(a=ie(e)){for(n=[];!(i=a.next()).done;)n.push(i.value);return n}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(n=new Array(t);t--;)n[t]=e[t];return n}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var Ue=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},mt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Mt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(mt),Xe={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ge(e,t){this.name=e,this.message=t}function at(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,i,a){return a.indexOf(n)===i}).join(`
`)}function be(e,t,n,i){this.failures=t,this.failedKeys=i,this.successCount=n,this.message=at(e,t)}function Ee(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=at(e,this.failures)}N(Ge).from(Error).extend({toString:function(){return this.name+": "+this.message}}),N(be).from(Ge),N(Ee).from(Ge);var Me=Mt.reduce(function(e,t){return e[t]=t+"Error",e},{}),ot=Ge,Z=Mt.reduce(function(e,t){var n=t+"Error";function i(a,u){this.name=n,a?typeof a=="string"?(this.message="".concat(a).concat(u?`
 `+u:""),this.inner=u||null):typeof a=="object"&&(this.message="".concat(a.name," ").concat(a.message),this.inner=a):(this.message=Xe[t]||n,this.inner=null)}return N(i).from(ot),e[t]=i,e},{});Z.Syntax=SyntaxError,Z.Type=TypeError,Z.Range=RangeError;var lt=mt.reduce(function(e,t){return e[t+"Error"]=Z[t],e},{}),Ke=Mt.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=Z[t]),e},{});function we(){}function Be(e){return e}function ft(e,t){return e==null||e===Be?t:function(n){return t(e(n))}}function nt(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function vt(e,t){return e===we?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var u=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?nt(i,this.onsuccess):i),a&&(this.onerror=this.onerror?nt(a,this.onerror):a),u!==void 0?u:n}}function It(e,t){return e===we?t:function(){e.apply(this,arguments);var n=this.onsuccess,i=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?nt(n,this.onsuccess):n),i&&(this.onerror=this.onerror?nt(i,this.onerror):i)}}function pt(e,t){return e===we?t:function(n){var i=e.apply(this,arguments);T(n,i);var a=this.onsuccess,u=this.onerror;return this.onsuccess=null,this.onerror=null,n=t.apply(this,arguments),a&&(this.onsuccess=this.onsuccess?nt(a,this.onsuccess):a),u&&(this.onerror=this.onerror?nt(u,this.onerror):u),i===void 0?n===void 0?void 0:n:T(i,n)}}function et(e,t){return e===we?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function We(e,t){return e===we?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var i=this,a=arguments.length,u=new Array(a);a--;)u[a]=arguments[a];return n.then(function(){return t.apply(i,u)})}return t.apply(this,arguments)}}Ke.ModifyError=be,Ke.DexieError=Ge,Ke.BulkError=Ee;var Ye=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ht(e){Ye=e}var St={},Nt=100,st=typeof Promise>"u"?[]:(function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,I(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,I(t),e]})(),mt=st[0],Mt=st[1],st=st[2],Mt=Mt&&Mt.then,At=mt&&mt.constructor,rr=!!st,Ut=function(e,t){Fr.push([e,t]),vr&&(queueMicrotask(Ma),vr=!1)},nr=!0,vr=!0,Vt=[],pr=[],Kt=Be,Et={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:we,pgp:!1,env:{},finalize:we},fe=Et,Fr=[],ir=0,Ur=[];function ne(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=fe;if(typeof e!="function"){if(e!==St)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Ln(this,this._value))}this._state=null,this._value=null,++t.ref,(function n(i,a){try{a(function(u){if(i._state===null){if(u===i)throw new TypeError("A promise cannot be resolved with itself.");var f=i._lib&&gr();u&&typeof u.then=="function"?n(i,function(v,y){u instanceof ne?u._then(v,y):u.then(v,y)}):(i._state=!0,i._value=u,Si(i)),f&&yr()}},Ln.bind(null,i))}catch(u){Ln(i,u)}})(this,e)}var Fn={get:function(){var e=fe,t=Jr;function n(i,a){var u=this,f=!e.global&&(e!==fe||t!==Jr),v=f&&!Wt(),y=new ne(function(m,x){Nn(u,new _i(Ci(i,e,f,v),Ci(a,e,f,v),m,x,e))});return this._consoleTask&&(y._consoleTask=this._consoleTask),y}return n.prototype=St,n},set:function(e){M(this,"then",e&&e.prototype===St?Fn:{get:function(){return e},set:Fn.set})}};function _i(e,t,n,i,a){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=i,this.psd=a}function Ln(e,t){var n,i;pr.push(t),e._state===null&&(n=e._lib&&gr(),t=Kt(t),e._state=!1,e._value=t,i=e,Vt.some(function(a){return a._value===i._value})||Vt.push(i),Si(e),n&&yr())}function Si(e){var t=e._listeners;e._listeners=[];for(var n=0,i=t.length;n<i;++n)Nn(e,t[n]);var a=e._PSD;--a.ref||a.finalize(),ir===0&&(++ir,Ut(function(){--ir==0&&Mn()},[]))}function Nn(e,t){if(e._state!==null){var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++ir,Ut(Na,[n,e,t])}else e._listeners.push(t)}function Na(e,t,n){try{var i,a=t._value;!t._state&&pr.length&&(pr=[]),i=Ye&&t._consoleTask?t._consoleTask.run(function(){return e(a)}):e(a),t._state||pr.indexOf(a)!==-1||(function(u){for(var f=Vt.length;f;)if(Vt[--f]._value===u._value)return Vt.splice(f,1)})(t),n.resolve(i)}catch(u){n.reject(u)}finally{--ir==0&&Mn(),--n.psd.ref||n.psd.finalize()}}function Ma(){ar(Et,function(){gr()&&yr()})}function gr(){var e=nr;return vr=nr=!1,e}function yr(){var e,t,n;do for(;0<Fr.length;)for(e=Fr,Fr=[],n=e.length,t=0;t<n;++t){var i=e[t];i[0].apply(null,i[1])}while(0<Fr.length);vr=nr=!0}function Mn(){var e=Vt;Vt=[],e.forEach(function(i){i._PSD.onunhandled.call(null,i._value,i)});for(var t=Ur.slice(0),n=t.length;n;)t[--n]()}function Gr(e){return new ne(St,!1,e)}function tt(e,t){var n=fe;return function(){var i=gr(),a=fe;try{return Yt(n,!0),e.apply(this,arguments)}catch(u){t&&t(u)}finally{Yt(a,!1),i&&yr()}}}E(ne.prototype,{then:Fn,_then:function(e,t){Nn(this,new _i(null,null,e,t,fe))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,n=arguments[1];return typeof t=="function"?this.then(null,function(i){return(i instanceof t?n:Gr)(i)}):this.then(null,function(i){return(i&&i.name===t?n:Gr)(i)})},finally:function(e){return this.then(function(t){return ne.resolve(e()).then(function(){return t})},function(t){return ne.resolve(e()).then(function(){return Gr(t)})})},timeout:function(e,t){var n=this;return e<1/0?new ne(function(i,a){var u=setTimeout(function(){return a(new Z.Timeout(t))},e);n.then(i,a).finally(clearTimeout.bind(null,u))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&M(ne.prototype,Symbol.toStringTag,"Dexie.Promise"),Et.env=xi(),E(ne,{all:function(){var e=me.apply(null,arguments).map(Qr);return new ne(function(t,n){e.length===0&&t([]);var i=e.length;e.forEach(function(a,u){return ne.resolve(a).then(function(f){e[u]=f,--i||t(e)},n)})})},resolve:function(e){return e instanceof ne?e:e&&typeof e.then=="function"?new ne(function(t,n){e.then(t,n)}):new ne(St,!0,e)},reject:Gr,race:function(){var e=me.apply(null,arguments).map(Qr);return new ne(function(t,n){e.map(function(i){return ne.resolve(i).then(t,n)})})},PSD:{get:function(){return fe},set:function(e){return fe=e}},totalEchoes:{get:function(){return Jr}},newPSD:Gt,usePSD:ar,scheduler:{get:function(){return Ut},set:function(e){Ut=e}},rejectionMapper:{get:function(){return Kt},set:function(e){Kt=e}},follow:function(e,t){return new ne(function(n,i){return Gt(function(a,u){var f=fe;f.unhandleds=[],f.onunhandled=u,f.finalize=nt(function(){var v,y=this;v=function(){y.unhandleds.length===0?a():u(y.unhandleds[0])},Ur.push(function m(){v(),Ur.splice(Ur.indexOf(m),1)}),++ir,Ut(function(){--ir==0&&Mn()},[])},f.finalize),e()},t,n,i)})}}),At&&(At.allSettled&&M(ne,"allSettled",function(){var e=me.apply(null,arguments).map(Qr);return new ne(function(t){e.length===0&&t([]);var n=e.length,i=new Array(n);e.forEach(function(a,u){return ne.resolve(a).then(function(f){return i[u]={status:"fulfilled",value:f}},function(f){return i[u]={status:"rejected",reason:f}}).then(function(){return--n||t(i)})})})}),At.any&&typeof AggregateError<"u"&&M(ne,"any",function(){var e=me.apply(null,arguments).map(Qr);return new ne(function(t,n){e.length===0&&n(new AggregateError([]));var i=e.length,a=new Array(i);e.forEach(function(u,f){return ne.resolve(u).then(function(v){return t(v)},function(v){a[f]=v,--i||n(new AggregateError(a))})})})}),At.withResolvers&&(ne.withResolvers=At.withResolvers));var gt={awaits:0,echoes:0,id:0},Ra=0,Wr=[],Yr=0,Jr=0,Ha=0;function Gt(e,t,n,i){var a=fe,u=Object.create(a);return u.parent=a,u.ref=0,u.global=!1,u.id=++Ha,Et.env,u.env=rr?{Promise:ne,PromiseProp:{value:ne,configurable:!0,writable:!0},all:ne.all,race:ne.race,allSettled:ne.allSettled,any:ne.any,resolve:ne.resolve,reject:ne.reject}:{},t&&T(u,t),++a.ref,u.finalize=function(){--this.parent.ref||this.parent.finalize()},i=ar(u,e,n,i),u.ref===0&&u.finalize(),i}function mr(){return gt.id||(gt.id=++Ra),++gt.awaits,gt.echoes+=Nt,gt.id}function Wt(){return!!gt.awaits&&(--gt.awaits==0&&(gt.id=0),gt.echoes=gt.awaits*Nt,!0)}function Qr(e){return gt.echoes&&e&&e.constructor===At?(mr(),e.then(function(t){return Wt(),t},function(t){return Wt(),ut(t)})):e}function ja(){var e=Wr[Wr.length-1];Wr.pop(),Yt(e,!1)}function Yt(e,t){var n,i=fe;(t?!gt.echoes||Yr++&&e===fe:!Yr||--Yr&&e===fe)||queueMicrotask(t?(function(a){++Jr,gt.echoes&&--gt.echoes!=0||(gt.echoes=gt.awaits=gt.id=0),Wr.push(fe),Yt(a,!0)}).bind(null,e):ja),e!==fe&&(fe=e,i===Et&&(Et.env=xi()),rr&&(n=Et.env.Promise,t=e.env,(i.global||e.global)&&(Object.defineProperty(h,"Promise",t.PromiseProp),n.all=t.all,n.race=t.race,n.resolve=t.resolve,n.reject=t.reject,t.allSettled&&(n.allSettled=t.allSettled),t.any&&(n.any=t.any))))}function xi(){var e=h.Promise;return rr?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(h,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function ar(e,t,n,i,a){var u=fe;try{return Yt(e,!0),t(n,i,a)}finally{Yt(u,!1)}}function Ci(e,t,n,i){return typeof e!="function"?e:function(){var a=fe;n&&mr(),Yt(t,!0);try{return e.apply(this,arguments)}finally{Yt(a,!1),i&&queueMicrotask(Wt)}}}function Rn(e){Promise===At&&gt.echoes===0?Yr===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+Mt).indexOf("[native code]")===-1&&(mr=Wt=we);var ut=ne.reject,or="",Bt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ki="String expected.",br=[],Xr="__dbnames",Hn="readonly",jn="readwrite";function sr(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Ii={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Zr(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=xe(t))[e],t}}function Ai(){throw Z.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Ne(e,t){try{var n=Oi(e),i=Oi(t);if(n!==i)return n==="Array"?1:i==="Array"?-1:n==="binary"?1:i==="binary"?-1:n==="string"?1:i==="string"?-1:n==="Date"?1:i!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return(function(a,u){for(var f=a.length,v=u.length,y=f<v?f:v,m=0;m<y;++m)if(a[m]!==u[m])return a[m]<u[m]?-1:1;return f===v?0:f<v?-1:1})(Pi(e),Pi(t));case"Array":return(function(a,u){for(var f=a.length,v=u.length,y=f<v?f:v,m=0;m<y;++m){var x=Ne(a[m],u[m]);if(x!==0)return x}return f===v?0:f<v?-1:1})(e,t)}}catch{}return NaN}function Oi(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=Ce(e),e==="ArrayBuffer"?"binary":e)}function Pi(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function en(e,t,n){var i=e.schema.yProps;return i?(t&&0<n.numFailures&&(t=t.filter(function(a,u){return!n.failures[u]})),Promise.all(i.map(function(a){return a=a.updatesTable,t?e.db.table(a).where("k").anyOf(t).delete():e.db.table(a).clear()})).then(function(){return n})):n}var Lr=(Ti.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var n=t.add;if(g(n))return c(c([],g(e)?e:[],!0),n).sort();if(typeof n=="number")return(Number(e)||0)+n;if(typeof n=="bigint")try{return BigInt(e)+n}catch{return BigInt(0)+n}throw new TypeError("Invalid term ".concat(n))}if(t.remove!==void 0){var i=t.remove;if(g(i))return g(e)?e.filter(function(a){return!i.includes(a)}).sort():[];if(typeof i=="number")return Number(e)-i;if(typeof i=="bigint")try{return BigInt(e)-i}catch{return BigInt(0)-i}throw new TypeError("Invalid subtrahend ".concat(i))}return n=(n=t.replacePrefix)===null||n===void 0?void 0:n[0],n&&typeof e=="string"&&e.startsWith(n)?t.replacePrefix[1]+e.substring(n.length):e},Ti);function Ti(e){this["@@propmod"]=e}function Ei(e,t){for(var n=d(t),i=n.length,a=!1,u=0;u<i;++u){var f=n[u],v=t[f],y=X(e,f);v instanceof Lr?(he(e,f,v.execute(y)),a=!0):y!==v&&(he(e,f,v),a=!0)}return a}var Di=(Je.prototype._trans=function(e,t,n){var i=this._tx||fe.trans,a=this.name,u=Ye&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function f(m,x,p){if(!p.schema[a])throw new Z.NotFound("Table "+a+" not part of transaction");return t(p.idbtrans,p)}var v=gr();try{var y=i&&i.db._novip===this.db._novip?i===fe.trans?i._promise(e,f,n):Gt(function(){return i._promise(e,f,n)},{trans:i,transless:fe.transless||fe}):(function m(x,p,A,b){if(x.idbdb&&(x._state.openComplete||fe.letThrough||x._vip)){var w=x._createTransaction(p,A,x._dbSchema);try{w.create(),x._state.PR1398_maxLoop=3}catch(_){return _.name===Me.InvalidState&&x.isOpen()&&0<--x._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),x.close({disableAutoOpen:!1}),x.open().then(function(){return m(x,p,A,b)})):ut(_)}return w._promise(p,function(_,k){return Gt(function(){return fe.trans=w,b(_,k,w)})}).then(function(_){if(p==="readwrite")try{w.idbtrans.commit()}catch{}return p==="readonly"?_:w._completion.then(function(){return _})})}if(x._state.openComplete)return ut(new Z.DatabaseClosed(x._state.dbOpenError));if(!x._state.isBeingOpened){if(!x._state.autoOpen)return ut(new Z.DatabaseClosed);x.open().catch(we)}return x._state.dbReadyPromise.then(function(){return m(x,p,A,b)})})(this.db,e,[this.name],f);return u&&(y._consoleTask=u,y=y.catch(function(m){return console.trace(m),ut(m)})),y}finally{v&&yr()}},Je.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?ut(new Z.Type("Invalid argument to Table.get()")):this._trans("readonly",function(i){return n.core.get({trans:i,key:e}).then(function(a){return n.hook.reading.fire(a)})}).then(t)},Je.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(g(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=d(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(v){if(v.compound&&t.every(function(m){return 0<=v.keyPath.indexOf(m)})){for(var y=0;y<t.length;++y)if(t.indexOf(v.keyPath[y])===-1)return!1;return!0}return!1}).sort(function(v,y){return v.keyPath.length-y.keyPath.length})[0];if(n&&this.db._maxKey!==or){var u=n.keyPath.slice(0,t.length);return this.where(u).equals(u.map(function(y){return e[y]}))}!n&&Ye&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var i=this.schema.idxByName;function a(v,y){return Ne(v,y)===0}var f=t.reduce(function(p,y){var m=p[0],x=p[1],p=i[y],A=e[y];return[m||p,m||!p?sr(x,p&&p.multi?function(b){return b=X(b,y),g(b)&&b.some(function(w){return a(A,w)})}:function(b){return a(A,X(b,y))}):x]},[null,null]),u=f[0],f=f[1];return u?this.where(u.name).equals(e[u.keyPath]).filter(f):n?this.filter(f):this.where(t).equals("")},Je.prototype.filter=function(e){return this.toCollection().and(e)},Je.prototype.count=function(e){return this.toCollection().count(e)},Je.prototype.offset=function(e){return this.toCollection().offset(e)},Je.prototype.limit=function(e){return this.toCollection().limit(e)},Je.prototype.each=function(e){return this.toCollection().each(e)},Je.prototype.toArray=function(e){return this.toCollection().toArray(e)},Je.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Je.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,g(e)?"[".concat(e.join("+"),"]"):e))},Je.prototype.reverse=function(){return this.toCollection().reverse()},Je.prototype.mapToClass=function(e){var t,n=this.db,i=this.name;function a(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof Ai&&((function(y,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");function x(){this.constructor=y}o(y,m),y.prototype=m===null?Object.create(m):(x.prototype=m.prototype,new x)})(a,t=e),Object.defineProperty(a.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),a.prototype.table=function(){return i},e=a);for(var u=new Set,f=e.prototype;f;f=I(f))Object.getOwnPropertyNames(f).forEach(function(y){return u.add(y)});function v(y){if(!y)return y;var m,x=Object.create(e.prototype);for(m in y)if(!u.has(m))try{x[m]=y[m]}catch{}return x}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=v,this.hook("reading",v),e},Je.prototype.defineClass=function(){return this.mapToClass(function(e){T(this,e)})},Je.prototype.add=function(e,t){var n=this,i=this.schema.primKey,a=i.auto,u=i.keyPath,f=e;return u&&a&&(f=Zr(u)(e)),this._trans("readwrite",function(v){return n.core.mutate({trans:v,type:"add",keys:t!=null?[t]:null,values:[f]})}).then(function(v){return v.numFailures?ne.reject(v.failures[0]):v.lastResult}).then(function(v){if(u)try{he(e,u,v)}catch{}return v})},Je.prototype.upsert=function(e,t){var n=this,i=this.schema.primKey.keyPath;return this._trans("readwrite",function(a){return n.core.get({trans:a,key:e}).then(function(u){var f=u??{};return Ei(f,t),i&&he(f,i,e),n.core.mutate({trans:a,type:"put",values:[f],keys:[e],upsert:!0,updates:{keys:[e],changeSpecs:[t]}}).then(function(v){return v.numFailures?ne.reject(v.failures[0]):!!u})})})},Je.prototype.update=function(e,t){return typeof e!="object"||g(e)?this.where(":id").equals(e).modify(t):(e=X(e,this.schema.primKey.keyPath),e===void 0?ut(new Z.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},Je.prototype.put=function(e,t){var n=this,i=this.schema.primKey,a=i.auto,u=i.keyPath,f=e;return u&&a&&(f=Zr(u)(e)),this._trans("readwrite",function(v){return n.core.mutate({trans:v,type:"put",values:[f],keys:t!=null?[t]:null})}).then(function(v){return v.numFailures?ne.reject(v.failures[0]):v.lastResult}).then(function(v){if(u)try{he(e,u,v)}catch{}return v})},Je.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]}).then(function(i){return en(t,[e],i)}).then(function(i){return i.numFailures?ne.reject(i.failures[0]):void 0})})},Je.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Ii}).then(function(n){return en(e,null,n)})}).then(function(t){return t.numFailures?ne.reject(t.failures[0]):void 0})},Je.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(n){return t.core.getMany({keys:e,trans:n}).then(function(i){return i.map(function(a){return t.hook.reading.fire(a)})})})},Je.prototype.bulkAdd=function(e,t,n){var i=this,a=Array.isArray(t)?t:void 0,u=(n=n||(a?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(f){var m=i.schema.primKey,v=m.auto,m=m.keyPath;if(m&&a)throw new Z.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new Z.InvalidArgument("Arguments objects and keys must have the same length");var y=e.length,m=m&&v?e.map(Zr(m)):e;return i.core.mutate({trans:f,type:"add",keys:a,values:m,wantResults:u}).then(function(w){var p=w.numFailures,A=w.results,b=w.lastResult,w=w.failures;if(p===0)return u?A:b;throw new Ee("".concat(i.name,".bulkAdd(): ").concat(p," of ").concat(y," operations failed"),w)})})},Je.prototype.bulkPut=function(e,t,n){var i=this,a=Array.isArray(t)?t:void 0,u=(n=n||(a?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(f){var m=i.schema.primKey,v=m.auto,m=m.keyPath;if(m&&a)throw new Z.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new Z.InvalidArgument("Arguments objects and keys must have the same length");var y=e.length,m=m&&v?e.map(Zr(m)):e;return i.core.mutate({trans:f,type:"put",keys:a,values:m,wantResults:u}).then(function(w){var p=w.numFailures,A=w.results,b=w.lastResult,w=w.failures;if(p===0)return u?A:b;throw new Ee("".concat(i.name,".bulkPut(): ").concat(p," of ").concat(y," operations failed"),w)})})},Je.prototype.bulkUpdate=function(e){var t=this,n=this.core,i=e.map(function(f){return f.key}),a=e.map(function(f){return f.changes}),u=[];return this._trans("readwrite",function(f){return n.getMany({trans:f,keys:i,cache:"clone"}).then(function(v){var y=[],m=[];e.forEach(function(p,A){var b=p.key,w=p.changes,_=v[A];if(_){for(var k=0,O=Object.keys(w);k<O.length;k++){var P=O[k],L=w[P];if(P===t.schema.primKey.keyPath){if(Ne(L,b)!==0)throw new Z.Constraint("Cannot update primary key in bulkUpdate()")}else he(_,P,L)}u.push(A),y.push(b),m.push(_)}});var x=y.length;return n.mutate({trans:f,type:"put",keys:y,values:m,updates:{keys:i,changeSpecs:a}}).then(function(p){var A=p.numFailures,b=p.failures;if(A===0)return x;for(var w=0,_=Object.keys(b);w<_.length;w++){var k,O=_[w],P=u[Number(O)];P!=null&&(k=b[O],delete b[O],b[P]=k)}throw new Ee("".concat(t.name,".bulkUpdate(): ").concat(A," of ").concat(x," operations failed"),b)})})})},Je.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",function(i){return t.core.mutate({trans:i,type:"delete",keys:e}).then(function(a){return en(t,e,a)})}).then(function(f){var a=f.numFailures,u=f.lastResult,f=f.failures;if(a===0)return u;throw new Ee("".concat(t.name,".bulkDelete(): ").concat(a," of ").concat(n," operations failed"),f)})},Je);function Je(){}function Nr(e){function t(f,v){if(v){for(var y=arguments.length,m=new Array(y-1);--y;)m[y-1]=arguments[y];return n[f].subscribe.apply(null,m),e}if(typeof f=="string")return n[f]}var n={};t.addEventType=u;for(var i=1,a=arguments.length;i<a;++i)u(arguments[i]);return t;function u(f,v,y){if(typeof f!="object"){var m;v=v||et;var x={subscribers:[],fire:y=y||we,subscribe:function(p){x.subscribers.indexOf(p)===-1&&(x.subscribers.push(p),x.fire=v(x.fire,p))},unsubscribe:function(p){x.subscribers=x.subscribers.filter(function(A){return A!==p}),x.fire=x.subscribers.reduce(v,y)}};return n[f]=t[f]=x}d(m=f).forEach(function(p){var A=m[p];if(g(A))u(p,m[p][0],m[p][1]);else{if(A!=="asap")throw new Z.InvalidArgument("Invalid event config");var b=u(p,Be,function(){for(var w=arguments.length,_=new Array(w);w--;)_[w]=arguments[w];b.subscribers.forEach(function(k){ce(function(){k.apply(null,_)})})})}})}}function Mr(e,t){return N(t).from({prototype:e}),t}function wr(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function zn(e,t){e.filter=sr(e.filter,t)}function Vn(e,t,n){var i=e.replayFilter;e.replayFilter=i?function(){return sr(i(),t())}:t,e.justLimit=n&&!i}function tn(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new Z.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Fi(e,t,n){var i=tn(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:i,range:e.range}})}function rn(e,t,n,i){var a=e.replayFilter?sr(e.filter,e.replayFilter()):e.filter;if(e.or){var u={},f=function(v,y,m){var x,p;a&&!a(y,m,function(A){return y.stop(A)},function(A){return y.fail(A)})||((p=""+(x=y.primaryKey))=="[object ArrayBuffer]"&&(p=""+new Uint8Array(x)),F(u,p)||(u[p]=!0,t(v,y,m)))};return Promise.all([e.or._iterate(f,n),Li(Fi(e,i,n),e.algorithm,f,!e.keysOnly&&e.valueMapper)])}return Li(Fi(e,i,n),sr(e.algorithm,a),t,!e.keysOnly&&e.valueMapper)}function Li(e,t,n,i){var a=tt(i?function(u,f,v){return n(i(u),f,v)}:n);return e.then(function(u){if(u)return u.start(function(){var f=function(){return u.continue()};t&&!t(u,function(v){return f=v},function(v){u.stop(v),f=we},function(v){u.fail(v),f=we})||a(u.value,u,function(v){return f=v}),f()})})}var za=(ze.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,ut.bind(null,n.error)):n.table._trans("readonly",e).then(t)},ze.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,ut.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},ze.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=sr(t.algorithm,e)},ze.prototype._iterate=function(e,t){return rn(this._ctx,e,t,this._ctx.table.core)},ze.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&T(n,e),t._ctx=n,t},ze.prototype.raw=function(){return this._ctx.valueMapper=null,this},ze.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return rn(t,e,n,t.table.core)})},ze.prototype.count=function(e){var t=this;return this._read(function(n){var i=t._ctx,a=i.table.core;if(wr(i,!0))return a.count({trans:n,query:{index:tn(i,a.schema),range:i.range}}).then(function(f){return Math.min(f,i.limit)});var u=0;return rn(i,function(){return++u,!1},n,a).then(function(){return u})}).then(e)},ze.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),i=n[0],a=n.length-1;function u(y,m){return m?u(y[n[m]],m-1):y[i]}var f=this._ctx.dir==="next"?1:-1;function v(y,m){return Ne(u(y,a),u(m,a))*f}return this.toArray(function(y){return y.sort(v)}).then(t)},ze.prototype.toArray=function(e){var t=this;return this._read(function(n){var i=t._ctx;if(i.dir==="next"&&wr(i,!0)&&0<i.limit){var a=i.valueMapper,u=tn(i,i.table.core.schema);return i.table.core.query({trans:n,limit:i.limit,values:!0,query:{index:u,range:i.range}}).then(function(v){return v=v.result,a?v.map(a):v})}var f=[];return rn(i,function(v){return f.push(v)},n,i.table.core).then(function(){return f})},e)},ze.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,wr(t)?Vn(t,function(){var n=e;return function(i,a){return n===0||(n===1?--n:a(function(){i.advance(n),n=0}),!1)}}):Vn(t,function(){var n=e;return function(){return--n<0}})),this},ze.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Vn(this._ctx,function(){var t=e;return function(n,i,a){return--t<=0&&i(a),0<=t}},!0),this},ze.prototype.until=function(e,t){return zn(this._ctx,function(n,i,a){return!e(n.value)||(i(a),t)}),this},ze.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},ze.prototype.last=function(e){return this.reverse().first(e)},ze.prototype.filter=function(e){var t;return zn(this._ctx,function(n){return e(n.value)}),(t=this._ctx).isMatch=sr(t.isMatch,e),this},ze.prototype.and=function(e){return this.filter(e)},ze.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},ze.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ze.prototype.desc=function(){return this.reverse()},ze.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,i){e(i.key,i)})},ze.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},ze.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,i){e(i.primaryKey,i)})},ze.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(i,a){n.push(a.key)}).then(function(){return n}).then(e)},ze.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&wr(t,!0)&&0<t.limit)return this._read(function(i){var a=tn(t,t.table.core.schema);return t.table.core.query({trans:i,values:!1,limit:t.limit,query:{index:a,range:t.range}})}).then(function(i){return i.result}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(i,a){n.push(a.primaryKey)}).then(function(){return n}).then(e)},ze.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},ze.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},ze.prototype.lastKey=function(e){return this.reverse().firstKey(e)},ze.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return zn(this._ctx,function(a){var i=a.primaryKey.toString(),a=F(t,i);return t[i]=!0,!a}),this},ze.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(i){var a=typeof e=="function"?e:function(_){return Ei(_,e)},u=n.table.core,m=u.schema.primaryKey,f=m.outbound,v=m.extractKey,y=200,m=t.db._options.modifyChunkSize;m&&(y=typeof m=="object"?m[u.name]||m["*"]||200:m);function x(_,P){var O=P.failures,P=P.numFailures;A+=_-P;for(var L=0,R=d(O);L<R.length;L++){var q=R[L];p.push(O[q])}}var p=[],A=0,b=[],w=e===Ni;return t.clone().primaryKeys().then(function(_){function k(P){var L=Math.min(y,_.length-P),R=_.slice(P,P+L);return(w?Promise.resolve([]):u.getMany({trans:i,keys:R,cache:"immutable"})).then(function(q){var ee=[],B=[],G=f?[]:null,te=w?R:[];if(!w)for(var J=0;J<L;++J){var ae=q[J],Ae={value:xe(ae),primKey:_[P+J]};a.call(Ae,Ae.value,Ae)!==!1&&(Ae.value==null?te.push(_[P+J]):f||Ne(v(ae),v(Ae.value))===0?(B.push(Ae.value),f&&G.push(_[P+J])):(te.push(_[P+J]),ee.push(Ae.value)))}return Promise.resolve(0<ee.length&&u.mutate({trans:i,type:"add",values:ee}).then(function(Te){for(var De in Te.failures)te.splice(parseInt(De),1);x(ee.length,Te)})).then(function(){return(0<B.length||O&&typeof e=="object")&&u.mutate({trans:i,type:"put",keys:G,values:B,criteria:O,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<P}).then(function(Te){return x(B.length,Te)})}).then(function(){return(0<te.length||O&&w)&&u.mutate({trans:i,type:"delete",keys:te,criteria:O,isAdditionalChunk:0<P}).then(function(Te){return en(n.table,te,Te)}).then(function(Te){return x(te.length,Te)})}).then(function(){return _.length>P+L&&k(P+y)})})}var O=wr(n)&&n.limit===1/0&&(typeof e!="function"||w)&&{index:n.index,range:n.range};return k(0).then(function(){if(0<p.length)throw new be("Error modifying one or more objects",p,A,b);return _.length})})})},ze.prototype.delete=function(){var e=this._ctx,t=e.range;return!wr(e)||e.table.schema.yProps||!e.isPrimKey&&t.type!==3?this.modify(Ni):this._write(function(n){var i=e.table.core.schema.primaryKey,a=t;return e.table.core.count({trans:n,query:{index:i,range:a}}).then(function(u){return e.table.core.mutate({trans:n,type:"deleteRange",range:a}).then(function(y){var v=y.failures,y=y.numFailures;if(y)throw new be("Could not delete some values",Object.keys(v).map(function(m){return v[m]}),u-y);return u-y})})})},ze);function ze(){}var Ni=function(e,t){return t.value=null};function Va(e,t){return e<t?-1:e===t?0:1}function Ka(e,t){return t<e?-1:e===t?0:1}function Dt(e,t,n){return e=e instanceof Ri?new e.Collection(e):e,e._ctx.error=new(n||TypeError)(t),e}function _r(e){return new e.Collection(e,function(){return Mi("")}).limit(0)}function nn(e,t,n,i){var a,u,f,v,y,m,x,p=n.length;if(!n.every(function(w){return typeof w=="string"}))return Dt(e,ki);function A(w){a=w==="next"?function(k){return k.toUpperCase()}:function(k){return k.toLowerCase()},u=w==="next"?function(k){return k.toLowerCase()}:function(k){return k.toUpperCase()},f=w==="next"?Va:Ka;var _=n.map(function(k){return{lower:u(k),upper:a(k)}}).sort(function(k,O){return f(k.lower,O.lower)});v=_.map(function(k){return k.upper}),y=_.map(function(k){return k.lower}),x=(m=w)==="next"?"":i}A("next"),e=new e.Collection(e,function(){return Jt(v[0],y[p-1]+i)}),e._ondirectionchange=function(w){A(w)};var b=0;return e._addAlgorithm(function(w,_,k){var O=w.key;if(typeof O!="string")return!1;var P=u(O);if(t(P,y,b))return!0;for(var L=null,R=b;R<p;++R){var q=(function(ee,B,G,te,J,ae){for(var Ae=Math.min(ee.length,te.length),Te=-1,De=0;De<Ae;++De){var Ft=B[De];if(Ft!==te[De])return J(ee[De],G[De])<0?ee.substr(0,De)+G[De]+G.substr(De+1):J(ee[De],te[De])<0?ee.substr(0,De)+te[De]+G.substr(De+1):0<=Te?ee.substr(0,Te)+B[Te]+G.substr(Te+1):null;J(ee[De],Ft)<0&&(Te=De)}return Ae<te.length&&ae==="next"?ee+G.substr(ee.length):Ae<ee.length&&ae==="prev"?ee.substr(0,G.length):Te<0?null:ee.substr(0,Te)+te[Te]+G.substr(Te+1)})(O,P,v[R],y[R],f,m);q===null&&L===null?b=R+1:(L===null||0<f(L,q))&&(L=q)}return _(L!==null?function(){w.continue(L+x)}:k),!1}),e}function Jt(e,t,n,i){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:i}}function Mi(e){return{type:1,lower:e,upper:e}}var Ri=(Object.defineProperty(yt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),yt.prototype.between=function(e,t,n,i){n=n!==!1,i=i===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(n||i)&&(!n||!i)?_r(this):new this.Collection(this,function(){return Jt(e,t,!n,!i)})}catch{return Dt(this,Bt)}},yt.prototype.equals=function(e){return e==null?Dt(this,Bt):new this.Collection(this,function(){return Mi(e)})},yt.prototype.above=function(e){return e==null?Dt(this,Bt):new this.Collection(this,function(){return Jt(e,void 0,!0)})},yt.prototype.aboveOrEqual=function(e){return e==null?Dt(this,Bt):new this.Collection(this,function(){return Jt(e,void 0,!1)})},yt.prototype.below=function(e){return e==null?Dt(this,Bt):new this.Collection(this,function(){return Jt(void 0,e,!1,!0)})},yt.prototype.belowOrEqual=function(e){return e==null?Dt(this,Bt):new this.Collection(this,function(){return Jt(void 0,e)})},yt.prototype.startsWith=function(e){return typeof e!="string"?Dt(this,ki):this.between(e,e+or,!0,!0)},yt.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):nn(this,function(t,n){return t.indexOf(n[0])===0},[e],or)},yt.prototype.equalsIgnoreCase=function(e){return nn(this,function(t,n){return t===n[0]},[e],"")},yt.prototype.anyOfIgnoreCase=function(){var e=me.apply(ve,arguments);return e.length===0?_r(this):nn(this,function(t,n){return n.indexOf(t)!==-1},e,"")},yt.prototype.startsWithAnyOfIgnoreCase=function(){var e=me.apply(ve,arguments);return e.length===0?_r(this):nn(this,function(t,n){return n.some(function(i){return t.indexOf(i)===0})},e,or)},yt.prototype.anyOf=function(){var e=this,t=me.apply(ve,arguments),n=this._cmp;try{t.sort(n)}catch{return Dt(this,Bt)}if(t.length===0)return _r(this);var i=new this.Collection(this,function(){return Jt(t[0],t[t.length-1])});i._ondirectionchange=function(u){n=u==="next"?e._ascending:e._descending,t.sort(n)};var a=0;return i._addAlgorithm(function(u,f,v){for(var y=u.key;0<n(y,t[a]);)if(++a===t.length)return f(v),!1;return n(y,t[a])===0||(f(function(){u.continue(t[a])}),!1)}),i},yt.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},yt.prototype.noneOf=function(){var e=me.apply(ve,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Dt(this,Bt)}var t=e.reduce(function(n,i){return n?n.concat([[n[n.length-1][1],i]]):[[-1/0,i]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},yt.prototype.inAnyRange=function(O,t){var n=this,i=this._cmp,a=this._ascending,u=this._descending,f=this._min,v=this._max;if(O.length===0)return _r(this);if(!O.every(function(P){return P[0]!==void 0&&P[1]!==void 0&&a(P[0],P[1])<=0}))return Dt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Z.InvalidArgument);var y=!t||t.includeLowers!==!1,m=t&&t.includeUppers===!0,x,p=a;function A(P,L){return p(P[0],L[0])}try{(x=O.reduce(function(P,L){for(var R=0,q=P.length;R<q;++R){var ee=P[R];if(i(L[0],ee[1])<0&&0<i(L[1],ee[0])){ee[0]=f(ee[0],L[0]),ee[1]=v(ee[1],L[1]);break}}return R===q&&P.push(L),P},[])).sort(A)}catch{return Dt(this,Bt)}var b=0,w=m?function(P){return 0<a(P,x[b][1])}:function(P){return 0<=a(P,x[b][1])},_=y?function(P){return 0<u(P,x[b][0])}:function(P){return 0<=u(P,x[b][0])},k=w,O=new this.Collection(this,function(){return Jt(x[0][0],x[x.length-1][1],!y,!m)});return O._ondirectionchange=function(P){p=P==="next"?(k=w,a):(k=_,u),x.sort(A)},O._addAlgorithm(function(P,L,R){for(var q,ee=P.key;k(ee);)if(++b===x.length)return L(R),!1;return!w(q=ee)&&!_(q)||(n._cmp(ee,x[b][1])===0||n._cmp(ee,x[b][0])===0||L(function(){p===a?P.continue(x[b][0]):P.continue(x[b][1])}),!1)}),O},yt.prototype.startsWithAnyOf=function(){var e=me.apply(ve,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?_r(this):this.inAnyRange(e.map(function(t){return[t,t+or]})):Dt(this,"startsWithAnyOf() only works with strings")},yt);function yt(){}function Ht(e){return tt(function(t){return Rr(t),e(t.target.error),!1})}function Rr(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Hr="storagemutated",Kn="x-storagemutated-1",Qt=Nr(null,Hr),Ba=(jt.prototype._lock=function(){return W(!fe.global),++this._reculock,this._reculock!==1||fe.global||(fe.lockOwnerFor=this),this},jt.prototype._unlock=function(){if(W(!fe.global),--this._reculock==0)for(fe.global||(fe.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{ar(e[1],e[0])}catch{}}return this},jt.prototype._locked=function(){return this._reculock&&fe.lockOwnerFor!==this},jt.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,i=this.db._state.dbOpenError;if(W(!this.idbtrans),!e&&!n)switch(i&&i.name){case"DatabaseClosedError":throw new Z.DatabaseClosed(i);case"MissingAPIError":throw new Z.MissingAPI(i.message,i);default:throw new Z.OpenFailed(i)}if(!this.active)throw new Z.TransactionInactive;return W(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||n).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=tt(function(a){Rr(a),t._reject(e.error)}),e.onabort=tt(function(a){Rr(a),t.active&&t._reject(new Z.Abort(e.error)),t.active=!1,t.on("abort").fire(a)}),e.oncomplete=tt(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&Qt.storagemutated.fire(e.mutatedParts)}),this},jt.prototype._promise=function(e,t,n){var i=this;if(e==="readwrite"&&this.mode!=="readwrite")return ut(new Z.ReadOnly("Transaction is readonly"));if(!this.active)return ut(new Z.TransactionInactive);if(this._locked())return new ne(function(u,f){i._blockedFuncs.push([function(){i._promise(e,t,n).then(u,f)},fe])});if(n)return Gt(function(){var u=new ne(function(f,v){i._lock();var y=t(f,v,i);y&&y.then&&y.then(f,v)});return u.finally(function(){return i._unlock()}),u._lib=!0,u});var a=new ne(function(u,f){var v=t(u,f,i);v&&v.then&&v.then(u,f)});return a._lib=!0,a},jt.prototype._root=function(){return this.parent?this.parent._root():this},jt.prototype.waitFor=function(e){var t,n=this._root(),i=ne.resolve(e);n._waitingFor?n._waitingFor=n._waitingFor.then(function(){return i}):(n._waitingFor=i,n._waitingQueue=[],t=n.idbtrans.objectStore(n.storeNames[0]),(function u(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(t.get(-1/0).onsuccess=u)})());var a=n._waitingFor;return new ne(function(u,f){i.then(function(v){return n._waitingQueue.push(tt(u.bind(null,v)))},function(v){return n._waitingQueue.push(tt(f.bind(null,v)))}).finally(function(){n._waitingFor===a&&(n._waitingFor=null)})})},jt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Z.Abort))},jt.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(F(t,e))return t[e];var n=this.schema[e];if(!n)throw new Z.NotFound("Table "+e+" not part of transaction");return n=new this.db.Table(e,n,this),n.core=this.db.core.table(e),t[e]=n},jt);function jt(){}function Bn(e,t,n,i,a,u,f,v){return{name:e,keyPath:t,unique:n,multi:i,auto:a,compound:u,src:(n&&!f?"&":"")+(i?"*":"")+(a?"++":"")+Hi(t),type:v}}function Hi(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function qn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(i=function(a){return[a.name,a]},n.reduce(function(a,u,f){return f=i(u,f),f&&(a[f[0]]=f[1]),a},{}))};var i}var jr=function(e){try{return e.only([[]]),jr=function(){return[[]]},[[]]}catch{return jr=function(){return or},or}};function $n(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(n){return n[t]}:function(n){return X(n,t)}:function(n){return X(n,e)};var t}function ji(e){return[].slice.call(e)}var qa=0;function zr(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function $a(e,t,y){function i(k){if(k.type===3)return null;if(k.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var b=k.lower,w=k.upper,_=k.lowerOpen,k=k.upperOpen;return b===void 0?w===void 0?null:t.upperBound(w,!!k):w===void 0?t.lowerBound(b,!!_):t.bound(b,w,!!_,!!k)}function a(A){var b,w=A.name;return{name:w,schema:A,mutate:function(_){var k=_.trans,O=_.type,P=_.keys,L=_.values,R=_.range;return new Promise(function(q,ee){q=tt(q);var B=k.objectStore(w),G=B.keyPath==null,te=O==="put"||O==="add";if(!te&&O!=="delete"&&O!=="deleteRange")throw new Error("Invalid operation type: "+O);var J,ae=(P||L||{length:1}).length;if(P&&L&&P.length!==L.length)throw new Error("Given keys array must have same length as given values array.");if(ae===0)return q({numFailures:0,failures:{},results:[],lastResult:void 0});function Ae(xt){++Ft,Rr(xt)}var Te=[],De=[],Ft=0;if(O==="deleteRange"){if(R.type===4)return q({numFailures:Ft,failures:De,results:[],lastResult:void 0});R.type===3?Te.push(J=B.clear()):Te.push(J=B.delete(i(R)))}else{var G=te?G?[L,P]:[L,null]:[P,null],Ie=G[0],wt=G[1];if(te)for(var _t=0;_t<ae;++_t)Te.push(J=wt&&wt[_t]!==void 0?B[O](Ie[_t],wt[_t]):B[O](Ie[_t])),J.onerror=Ae;else for(_t=0;_t<ae;++_t)Te.push(J=B[O](Ie[_t])),J.onerror=Ae}function gn(xt){xt=xt.target.result,Te.forEach(function(cr,ui){return cr.error!=null&&(De[ui]=cr.error)}),q({numFailures:Ft,failures:De,results:O==="delete"?P:Te.map(function(cr){return cr.result}),lastResult:xt})}J.onerror=function(xt){Ae(xt),gn(xt)},J.onsuccess=gn})},getMany:function(_){var k=_.trans,O=_.keys;return new Promise(function(P,L){P=tt(P);for(var R,q=k.objectStore(w),ee=O.length,B=new Array(ee),G=0,te=0,J=function(Te){Te=Te.target,B[Te._pos]=Te.result,++te===G&&P(B)},ae=Ht(L),Ae=0;Ae<ee;++Ae)O[Ae]!=null&&((R=q.get(O[Ae]))._pos=Ae,R.onsuccess=J,R.onerror=ae,++G);G===0&&P(B)})},get:function(_){var k=_.trans,O=_.key;return new Promise(function(P,L){P=tt(P);var R=k.objectStore(w).get(O);R.onsuccess=function(q){return P(q.target.result)},R.onerror=Ht(L)})},query:(b=m,function(_){return new Promise(function(k,O){k=tt(k);var P,L,R,G=_.trans,q=_.values,ee=_.limit,J=_.query,B=ee===1/0?void 0:ee,te=J.index,J=J.range,G=G.objectStore(w),te=te.isPrimaryKey?G:G.index(te.name),J=i(J);if(ee===0)return k({result:[]});b?((B=q?te.getAll(J,B):te.getAllKeys(J,B)).onsuccess=function(ae){return k({result:ae.target.result})},B.onerror=Ht(O)):(P=0,L=!q&&"openKeyCursor"in te?te.openKeyCursor(J):te.openCursor(J),R=[],L.onsuccess=function(ae){var Ae=L.result;return Ae?(R.push(q?Ae.value:Ae.primaryKey),++P===ee?k({result:R}):void Ae.continue()):k({result:R})},L.onerror=Ht(O))})}),openCursor:function(_){var k=_.trans,O=_.values,P=_.query,L=_.reverse,R=_.unique;return new Promise(function(q,ee){q=tt(q);var te=P.index,B=P.range,G=k.objectStore(w),G=te.isPrimaryKey?G:G.index(te.name),te=L?R?"prevunique":"prev":R?"nextunique":"next",J=!O&&"openKeyCursor"in G?G.openKeyCursor(i(B),te):G.openCursor(i(B),te);J.onerror=Ht(ee),J.onsuccess=tt(function(ae){var Ae,Te,De,Ft,Ie=J.result;Ie?(Ie.___id=++qa,Ie.done=!1,Ae=Ie.continue.bind(Ie),Te=(Te=Ie.continuePrimaryKey)&&Te.bind(Ie),De=Ie.advance.bind(Ie),Ft=function(){throw new Error("Cursor not stopped")},Ie.trans=k,Ie.stop=Ie.continue=Ie.continuePrimaryKey=Ie.advance=function(){throw new Error("Cursor not started")},Ie.fail=tt(ee),Ie.next=function(){var wt=this,_t=1;return this.start(function(){return _t--?wt.continue():wt.stop()}).then(function(){return wt})},Ie.start=function(wt){function _t(){if(J.result)try{wt()}catch(xt){Ie.fail(xt)}else Ie.done=!0,Ie.start=function(){throw new Error("Cursor behind last entry")},Ie.stop()}var gn=new Promise(function(xt,cr){xt=tt(xt),J.onerror=Ht(cr),Ie.fail=cr,Ie.stop=function(ui){Ie.stop=Ie.continue=Ie.continuePrimaryKey=Ie.advance=Ft,xt(ui)}});return J.onsuccess=tt(function(xt){J.onsuccess=_t,_t()}),Ie.continue=Ae,Ie.continuePrimaryKey=Te,Ie.advance=De,_t(),gn},q(Ie)):q(null)},ee)})},count:function(_){var k=_.query,O=_.trans,P=k.index,L=k.range;return new Promise(function(R,q){var ee=O.objectStore(w),B=P.isPrimaryKey?ee:ee.index(P.name),ee=i(L),B=ee?B.count(ee):B.count();B.onsuccess=tt(function(G){return R(G.target.result)}),B.onerror=Ht(q)})}}}var u,f,v,x=(f=y,v=ji((u=e).objectStoreNames),{schema:{name:u.name,tables:v.map(function(A){return f.objectStore(A)}).map(function(A){var b=A.keyPath,k=A.autoIncrement,w=g(b),_={},k={name:A.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:b==null,compound:w,keyPath:b,autoIncrement:k,unique:!0,extractKey:$n(b)},indexes:ji(A.indexNames).map(function(O){return A.index(O)}).map(function(R){var P=R.name,L=R.unique,q=R.multiEntry,R=R.keyPath,q={name:P,compound:g(R),keyPath:R,unique:L,multiEntry:q,extractKey:$n(R)};return _[zr(R)]=q}),getIndexByKeyPath:function(O){return _[zr(O)]}};return _[":id"]=k.primaryKey,b!=null&&(_[zr(b)]=k.primaryKey),k})},hasGetAll:0<v.length&&"getAll"in f.objectStore(v[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),y=x.schema,m=x.hasGetAll,x=y.tables.map(a),p={};return x.forEach(function(A){return p[A.name]=A}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(A){if(!p[A])throw new Error("Table '".concat(A,"' not found"));return p[A]},MIN_KEY:-1/0,MAX_KEY:jr(t),schema:y}}function Ua(e,t,n,i){var a=n.IDBKeyRange;return n.indexedDB,{dbcore:(i=$a(t,a,i),e.dbcore.reduce(function(u,f){return f=f.create,s(s({},u),f(u))},i))}}function an(e,i){var n=i.db,i=Ua(e._middlewares,n,e._deps,i);e.core=i.dbcore,e.tables.forEach(function(a){var u=a.name;e.core.schema.tables.some(function(f){return f.name===u})&&(a.core=e.core.table(u),e[u]instanceof e.Table&&(e[u].core=a.core))})}function on(e,t,n,i){n.forEach(function(a){var u=i[a];t.forEach(function(f){var v=(function y(m,x){return z(m,x)||(m=I(m))&&y(m,x)})(f,a);(!v||"value"in v&&v.value===void 0)&&(f===e.Transaction.prototype||f instanceof e.Transaction?M(f,a,{get:function(){return this.table(a)},set:function(y){Y(this,a,{value:y,writable:!0,configurable:!0,enumerable:!0})}}):f[a]=new e.Table(a,u))})})}function Un(e,t){t.forEach(function(n){for(var i in n)n[i]instanceof e.Table&&delete n[i]})}function Ga(e,t){return e._cfg.version-t._cfg.version}function Wa(e,t,n,i){var a=e._dbSchema;n.objectStoreNames.contains("$meta")&&!a.$meta&&(a.$meta=qn("$meta",Vi("")[0],[]),e._storeNames.push("$meta"));var u=e._createTransaction("readwrite",e._storeNames,a);u.create(n),u._completion.catch(i);var f=u._reject.bind(u),v=fe.transless||fe;Gt(function(){return fe.trans=u,fe.transless=v,t!==0?(an(e,n),m=t,((y=u).storeNames.includes("$meta")?y.table("$meta").get("version").then(function(x){return x??m}):ne.resolve(m)).then(function(x){return A=x,b=u,w=n,_=[],x=(p=e)._versions,k=p._dbSchema=ln(0,p.idbdb,w),(x=x.filter(function(O){return O._cfg.version>=A})).length!==0?(x.forEach(function(O){_.push(function(){var P=k,L=O._cfg.dbschema;un(p,P,w),un(p,L,w),k=p._dbSchema=L;var R=Gn(P,L);R.add.forEach(function(te){Wn(w,te[0],te[1].primKey,te[1].indexes)}),R.change.forEach(function(te){if(te.recreate)throw new Z.Upgrade("Not yet support for changing primary key");var J=w.objectStore(te.name);te.add.forEach(function(ae){return sn(J,ae)}),te.change.forEach(function(ae){J.deleteIndex(ae.name),sn(J,ae)}),te.del.forEach(function(ae){return J.deleteIndex(ae)})});var q=O._cfg.contentUpgrade;if(q&&O._cfg.version>A){an(p,w),b._memoizedTables={};var ee=_e(L);R.del.forEach(function(te){ee[te]=P[te]}),Un(p,[p.Transaction.prototype]),on(p,[p.Transaction.prototype],d(ee),ee),b.schema=ee;var B,G=Ue(q);return G&&mr(),R=ne.follow(function(){var te;(B=q(b))&&G&&(te=Wt.bind(null,null),B.then(te,te))}),B&&typeof B.then=="function"?ne.resolve(B):R.then(function(){return B})}}),_.push(function(P){var L,R,q=O._cfg.dbschema;L=q,R=P,[].slice.call(R.db.objectStoreNames).forEach(function(ee){return L[ee]==null&&R.db.deleteObjectStore(ee)}),Un(p,[p.Transaction.prototype]),on(p,[p.Transaction.prototype],p._storeNames,p._dbSchema),b.schema=p._dbSchema}),_.push(function(P){p.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(p.idbdb.version/10)===O._cfg.version?(p.idbdb.deleteObjectStore("$meta"),delete p._dbSchema.$meta,p._storeNames=p._storeNames.filter(function(L){return L!=="$meta"})):P.objectStore("$meta").put(O._cfg.version,"version"))})}),(function O(){return _.length?ne.resolve(_.shift()(b.idbtrans)).then(O):ne.resolve()})().then(function(){zi(k,w)})):ne.resolve();var p,A,b,w,_,k}).catch(f)):(d(a).forEach(function(x){Wn(n,x,a[x].primKey,a[x].indexes)}),an(e,n),void ne.follow(function(){return e.on.populate.fire(u)}).catch(f));var y,m})}function Ya(e,t){zi(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=ln(0,e.idbdb,t);un(e,e._dbSchema,t);for(var i=0,a=Gn(n,e._dbSchema).change;i<a.length;i++){var u=(function(f){if(f.change.length||f.recreate)return console.warn("Unable to patch indexes of table ".concat(f.name," because it has changes on the type of index or primary key.")),{value:void 0};var v=t.objectStore(f.name);f.add.forEach(function(y){Ye&&console.debug("Dexie upgrade patch: Creating missing index ".concat(f.name,".").concat(y.src)),sn(v,y)})})(a[i]);if(typeof u=="object")return u.value}}function Gn(e,t){var n,i={del:[],add:[],change:[]};for(n in e)t[n]||i.del.push(n);for(n in t){var a=e[n],u=t[n];if(a){var f={name:n,def:u,recreate:!1,del:[],add:[],change:[]};if(""+(a.primKey.keyPath||"")!=""+(u.primKey.keyPath||"")||a.primKey.auto!==u.primKey.auto)f.recreate=!0,i.change.push(f);else{var v=a.idxByName,y=u.idxByName,m=void 0;for(m in v)y[m]||f.del.push(m);for(m in y){var x=v[m],p=y[m];x?x.src!==p.src&&f.change.push(p):f.add.push(p)}(0<f.del.length||0<f.add.length||0<f.change.length)&&i.change.push(f)}}else i.add.push([n,u])}return i}function Wn(e,t,n,i){var a=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return i.forEach(function(u){return sn(a,u)}),a}function zi(e,t){d(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(Ye&&console.debug("Dexie: Creating missing table",n),Wn(t,n,e[n].primKey,e[n].indexes))})}function sn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function ln(e,t,n){var i={};return V(t.objectStoreNames,0).forEach(function(a){for(var u=n.objectStore(a),f=Bn(Hi(m=u.keyPath),m||"",!0,!1,!!u.autoIncrement,m&&typeof m!="string",!0),v=[],y=0;y<u.indexNames.length;++y){var x=u.index(u.indexNames[y]),m=x.keyPath,x=Bn(x.name,m,!!x.unique,!!x.multiEntry,!1,m&&typeof m!="string",!1);v.push(x)}i[a]=qn(a,f,v)}),i}function un(e,t,n){for(var i=n.db.objectStoreNames,a=0;a<i.length;++a){var u=i[a],f=n.objectStore(u);e._hasGetAll="getAll"in f;for(var v=0;v<f.indexNames.length;++v){var y=f.indexNames[v],m=f.index(y).keyPath,x=typeof m=="string"?m:"["+V(m).join("+")+"]";!t[u]||(m=t[u].idxByName[x])&&(m.name=y,delete t[u].idxByName[x],t[u].idxByName[y]=m)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&h.WorkerGlobalScope&&h instanceof h.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function Vi(e){return e.split(",").map(function(t,n){var u=t.split(":"),i=(a=u[1])===null||a===void 0?void 0:a.trim(),a=(t=u[0].trim()).replace(/([&*]|\+\+)/g,""),u=/^\[/.test(a)?a.match(/^\[(.*)\]$/)[1].split("+"):a;return Bn(a,u||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),g(u),n===0,i)})}var Ja=(Sr.prototype._createTableSchema=qn,Sr.prototype._parseIndexSyntax=Vi,Sr.prototype._parseStoresSpec=function(e,t){var n=this;d(e).forEach(function(i){if(e[i]!==null){var a=n._parseIndexSyntax(e[i]),u=a.shift();if(!u)throw new Z.Schema("Invalid schema for table "+i+": "+e[i]);if(u.unique=!0,u.multi)throw new Z.Schema("Primary key cannot be multiEntry*");a.forEach(function(f){if(f.auto)throw new Z.Schema("Only primary key can be marked as autoIncrement (++)");if(!f.keyPath)throw new Z.Schema("Index must have a name and cannot be an empty string")}),a=n._createTableSchema(i,u,a),t[i]=a}})},Sr.prototype.stores=function(n){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?T(this._cfg.storesSource,n):n;var n=t._versions,i={},a={};return n.forEach(function(u){T(i,u._cfg.storesSource),a=u._cfg.dbschema={},u._parseStoresSpec(i,a)}),t._dbSchema=a,Un(t,[t._allTables,t,t.Transaction.prototype]),on(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],d(a),a),t._storeNames=d(a),this},Sr.prototype.upgrade=function(e){return this._cfg.contentUpgrade=We(this._cfg.contentUpgrade||we,e),this},Sr);function Sr(){}function Yn(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new qt(Xr,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function Jn(e){return e&&typeof e.databases=="function"}function Qn(e){return Gt(function(){return fe.letThrough=!0,e()})}function Xn(e){return!("from"in e)}var bt=function(e,t){if(!this){var n=new bt;return e&&"d"in e&&T(n,e),n}T(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function Vr(e,t,n){var i=Ne(t,n);if(!isNaN(i)){if(0<i)throw RangeError();if(Xn(e))return T(e,{from:t,to:n,d:1});var a=e.l,i=e.r;if(Ne(n,e.from)<0)return a?Vr(a,t,n):e.l={from:t,to:n,d:1,l:null,r:null},Bi(e);if(0<Ne(t,e.to))return i?Vr(i,t,n):e.r={from:t,to:n,d:1,l:null,r:null},Bi(e);Ne(t,e.from)<0&&(e.from=t,e.l=null,e.d=i?i.d+1:1),0<Ne(n,e.to)&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1),n=!e.r,a&&!e.l&&Kr(e,a),i&&n&&Kr(e,i)}}function Kr(e,t){Xn(t)||(function n(i,y){var u=y.from,f=y.to,v=y.l,y=y.r;Vr(i,u,f),v&&n(i,v),y&&n(i,y)})(e,t)}function Ki(e,t){var n=cn(t),i=n.next();if(i.done)return!1;for(var a=i.value,u=cn(e),f=u.next(a.from),v=f.value;!i.done&&!f.done;){if(Ne(v.from,a.to)<=0&&0<=Ne(v.to,a.from))return!0;Ne(a.from,v.from)<0?a=(i=n.next(v.from)).value:v=(f=u.next(a.from)).value}return!1}function cn(e){var t=Xn(e)?null:{s:0,n:e};return{next:function(n){for(var i=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,i)for(;t.n.l&&Ne(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!i||Ne(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Bi(e){var t,n,i=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),a=1<i?"r":i<-1?"l":"";a&&(t=a=="r"?"l":"r",n=s({},e),i=e[a],e.from=i.from,e.to=i.to,e[a]=i[a],n[a]=i[t],(e[t]=n).d=qi(n)),e.d=qi(e)}function qi(n){var t=n.r,n=n.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function dn(e,t){return d(t).forEach(function(n){e[n]?Kr(e[n],t[n]):e[n]=(function i(a){var u,f,v={};for(u in a)F(a,u)&&(f=a[u],v[u]=!f||typeof f!="object"||Se.has(f.constructor)?f:i(f));return v})(t[n])}),e}function Zn(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&Ki(t[n],e[n])})}E(bt.prototype,((Mt={add:function(e){return Kr(this,e),this},addKey:function(e){return Vr(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return Vr(t,n,n)}),this},hasKey:function(e){var t=cn(this).next(e).value;return t&&Ne(t.from,e)<=0&&0<=Ne(t.to,e)}})[je]=function(){return cn(this)},Mt));var lr={},ei={},ti=!1;function fn(e){dn(ei,e),ti||(ti=!0,setTimeout(function(){ti=!1,ri(ei,!(ei={}))},0))}function ri(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var i=0,a=Object.values(lr);i<a.length;i++)$i(f=a[i],e,n,t);else for(var u in e){var f,v=/^idb\:\/\/(.*)\/(.*)\//.exec(u);v&&(u=v[1],v=v[2],(f=lr["idb://".concat(u,"/").concat(v)])&&$i(f,e,n,t))}n.forEach(function(y){return y()})}function $i(e,t,n,i){for(var a=[],u=0,f=Object.entries(e.queries.query);u<f.length;u++){for(var v=f[u],y=v[0],m=[],x=0,p=v[1];x<p.length;x++){var A=p[x];Zn(t,A.obsSet)?A.subscribers.forEach(function(k){return n.add(k)}):i&&m.push(A)}i&&a.push([y,m])}if(i)for(var b=0,w=a;b<w.length;b++){var _=w[b],y=_[0],m=_[1];e.queries.query[y]=m}}function Qa(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?ut(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var i=t.openCanceller,a=Math.round(10*e.verno),u=!1;function f(){if(t.openCanceller!==i)throw new Z.DatabaseClosed("db.open() was cancelled")}function v(){return new ne(function(A,b){if(f(),!n)throw new Z.MissingAPI;var w=e.name,_=t.autoSchema||!a?n.open(w):n.open(w,a);if(!_)throw new Z.MissingAPI;_.onerror=Ht(b),_.onblocked=tt(e._fireOnBlocked),_.onupgradeneeded=tt(function(k){var O;x=_.transaction,t.autoSchema&&!e._options.allowEmptyDB?(_.onerror=Rr,x.abort(),_.result.close(),(O=n.deleteDatabase(w)).onsuccess=O.onerror=tt(function(){b(new Z.NoSuchDatabase("Database ".concat(w," doesnt exist")))})):(x.onerror=Ht(b),k=k.oldVersion>Math.pow(2,62)?0:k.oldVersion,p=k<1,e.idbdb=_.result,u&&Ya(e,x),Wa(e,k/10,x,b))},b),_.onsuccess=tt(function(){x=null;var k,O,P,L,R,q=e.idbdb=_.result,ee=V(q.objectStoreNames);if(0<ee.length)try{var B=q.transaction((L=ee).length===1?L[0]:L,"readonly");if(t.autoSchema)O=q,P=B,(k=e).verno=O.version/10,P=k._dbSchema=ln(0,O,P),k._storeNames=V(O.objectStoreNames,0),on(k,[k._allTables],d(P),P);else if(un(e,e._dbSchema,B),((R=Gn(ln(0,(R=e).idbdb,B),R._dbSchema)).add.length||R.change.some(function(G){return G.add.length||G.change.length}))&&!u)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),q.close(),a=q.version+1,u=!0,A(v());an(e,B)}catch{}br.push(e),q.onversionchange=tt(function(G){t.vcFired=!0,e.on("versionchange").fire(G)}),q.onclose=tt(function(){e.close({disableAutoOpen:!1})}),p&&(R=e._deps,B=w,q=R.indexedDB,R=R.IDBKeyRange,Jn(q)||B===Xr||Yn(q,R).put({name:B}).catch(we)),A()},b)}).catch(function(A){switch(A?.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),v();break;case"VersionError":if(0<a)return a=0,v()}return ne.reject(A)})}var y,m=t.dbReadyResolve,x=null,p=!1;return ne.race([i,(typeof navigator>"u"?ne.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(A){function b(){return indexedDB.databases().finally(A)}y=setInterval(b,100),b()}).finally(function(){return clearInterval(y)}):Promise.resolve()).then(v)]).then(function(){return f(),t.onReadyBeingFired=[],ne.resolve(Qn(function(){return e.on.ready.fire(e.vip)})).then(function A(){if(0<t.onReadyBeingFired.length){var b=t.onReadyBeingFired.reduce(We,we);return t.onReadyBeingFired=[],ne.resolve(Qn(function(){return b(e.vip)})).then(A)}})}).finally(function(){t.openCanceller===i&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(A){t.dbOpenError=A;try{x&&x.abort()}catch{}return i===t.openCanceller&&e._close(),ut(A)}).finally(function(){t.openComplete=!0,m()}).then(function(){var A;return p&&(A={},e.tables.forEach(function(b){b.schema.indexes.forEach(function(w){w.name&&(A["idb://".concat(e.name,"/").concat(b.name,"/").concat(w.name)]=new bt(-1/0,[[[]]]))}),A["idb://".concat(e.name,"/").concat(b.name,"/")]=A["idb://".concat(e.name,"/").concat(b.name,"/:dels")]=new bt(-1/0,[[[]]])}),Qt(Hr).fire(A),ri(A,!0)),e})}function ni(e){function t(u){return e.next(u)}var n=a(t),i=a(function(u){return e.throw(u)});function a(u){return function(y){var v=u(y),y=v.value;return v.done?y:y&&typeof y.then=="function"?y.then(n,i):g(y)?Promise.all(y).then(n,i):n(y)}}return a(t)()}function hn(e,t,n){for(var i=g(e)?e.slice():[e],a=0;a<n;++a)i.push(t);return i}var Xa={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return s(s({},e),{table:function(t){var n=e.table(t),i=n.schema,a={},u=[];function f(p,A,b){var w=zr(p),_=a[w]=a[w]||[],k=p==null?0:typeof p=="string"?1:p.length,O=0<A,O=s(s({},b),{name:O?"".concat(w,"(virtual-from:").concat(b.name,")"):b.name,lowLevelIndex:b,isVirtual:O,keyTail:A,keyLength:k,extractKey:$n(p),unique:!O&&b.unique});return _.push(O),O.isPrimaryKey||u.push(O),1<k&&f(k===2?p[0]:p.slice(0,k-1),A+1,b),_.sort(function(P,L){return P.keyTail-L.keyTail}),O}t=f(i.primaryKey.keyPath,0,i.primaryKey),a[":id"]=[t];for(var v=0,y=i.indexes;v<y.length;v++){var m=y[v];f(m.keyPath,0,m)}function x(p){var A,b=p.query.index;return b.isVirtual?s(s({},p),{query:{index:b.lowLevelIndex,range:(A=p.query.range,b=b.keyTail,{type:A.type===1?2:A.type,lower:hn(A.lower,A.lowerOpen?e.MAX_KEY:e.MIN_KEY,b),lowerOpen:!0,upper:hn(A.upper,A.upperOpen?e.MIN_KEY:e.MAX_KEY,b),upperOpen:!0})}}):p}return s(s({},n),{schema:s(s({},i),{primaryKey:t,indexes:u,getIndexByKeyPath:function(p){return(p=a[zr(p)])&&p[0]}}),count:function(p){return n.count(x(p))},query:function(p){return n.query(x(p))},openCursor:function(p){var A=p.query.index,b=A.keyTail,w=A.isVirtual,_=A.keyLength;return w?n.openCursor(x(p)).then(function(O){return O&&k(O)}):n.openCursor(p);function k(O){return Object.create(O,{continue:{value:function(P){P!=null?O.continue(hn(P,p.reverse?e.MAX_KEY:e.MIN_KEY,b)):p.unique?O.continue(O.key.slice(0,_).concat(p.reverse?e.MIN_KEY:e.MAX_KEY,b)):O.continue()}},continuePrimaryKey:{value:function(P,L){O.continuePrimaryKey(hn(P,e.MAX_KEY,b),L)}},primaryKey:{get:function(){return O.primaryKey}},key:{get:function(){var P=O.key;return _===1?P[0]:P.slice(0,_)}},value:{get:function(){return O.value}}})}}})}})}};function ii(e,t,n,i){return n=n||{},i=i||"",d(e).forEach(function(a){var u,f,v;F(t,a)?(u=e[a],f=t[a],typeof u=="object"&&typeof f=="object"&&u&&f?(v=Ce(u))!==Ce(f)?n[i+a]=t[a]:v==="Object"?ii(u,f,n,i+a+"."):u!==f&&(n[i+a]=t[a]):u!==f&&(n[i+a]=t[a])):n[i+a]=void 0}),d(t).forEach(function(a){F(e,a)||(n[i+a]=t[a])}),n}function ai(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Za={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return s(s({},e),{table:function(t){var n=e.table(t),i=n.schema.primaryKey;return s(s({},n),{mutate:function(a){var u=fe.trans,f=u.table(t).hook,v=f.deleting,y=f.creating,m=f.updating;switch(a.type){case"add":if(y.fire===we)break;return u._promise("readwrite",function(){return x(a)},!0);case"put":if(y.fire===we&&m.fire===we)break;return u._promise("readwrite",function(){return x(a)},!0);case"delete":if(v.fire===we)break;return u._promise("readwrite",function(){return x(a)},!0);case"deleteRange":if(v.fire===we)break;return u._promise("readwrite",function(){return(function p(A,b,w){return n.query({trans:A,values:!1,query:{index:i,range:b},limit:w}).then(function(_){var k=_.result;return x({type:"delete",keys:k,trans:A}).then(function(O){return 0<O.numFailures?Promise.reject(O.failures[0]):k.length<w?{failures:[],numFailures:0,lastResult:void 0}:p(A,s(s({},b),{lower:k[k.length-1],lowerOpen:!0}),w)})})})(a.trans,a.range,1e4)},!0)}return n.mutate(a);function x(p){var A,b,w,_=fe.trans,k=p.keys||ai(i,p);if(!k)throw new Error("Keys missing");return(p=p.type==="add"||p.type==="put"?s(s({},p),{keys:k}):s({},p)).type!=="delete"&&(p.values=c([],p.values)),p.keys&&(p.keys=c([],p.keys)),A=n,w=k,((b=p).type==="add"?Promise.resolve([]):A.getMany({trans:b.trans,keys:w,cache:"immutable"})).then(function(O){var P=k.map(function(L,R){var q,ee,B,G=O[R],te={onerror:null,onsuccess:null};return p.type==="delete"?v.fire.call(te,L,G,_):p.type==="add"||G===void 0?(q=y.fire.call(te,L,p.values[R],_),L==null&&q!=null&&(p.keys[R]=L=q,i.outbound||he(p.values[R],i.keyPath,L))):(q=ii(G,p.values[R]),(ee=m.fire.call(te,q,L,G,_))&&(B=p.values[R],Object.keys(ee).forEach(function(J){F(B,J)?B[J]=ee[J]:he(B,J,ee[J])}))),te});return n.mutate(p).then(function(L){for(var R=L.failures,q=L.results,ee=L.numFailures,L=L.lastResult,B=0;B<k.length;++B){var G=(q||k)[B],te=P[B];G==null?te.onerror&&te.onerror(R[B]):te.onsuccess&&te.onsuccess(p.type==="put"&&O[B]?p.values[B]:G)}return{failures:R,results:q,numFailures:ee,lastResult:L}}).catch(function(L){return P.forEach(function(R){return R.onerror&&R.onerror(L)}),Promise.reject(L)})})}}})}})}};function Ui(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var i=[],a=0,u=0;a<t.keys.length&&u<e.length;++a)Ne(t.keys[a],e[u])===0&&(i.push(n?xe(t.values[a]):t.values[a]),++u);return i.length===e.length?i:null}catch{return null}}var eo={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return s(s({},n),{getMany:function(i){if(!i.cache)return n.getMany(i);var a=Ui(i.keys,i.trans._cache,i.cache==="clone");return a?ne.resolve(a):n.getMany(i).then(function(u){return i.trans._cache={keys:i.keys,values:i.cache==="clone"?xe(u):u},u})},mutate:function(i){return i.type!=="add"&&(i.trans._cache=null),n.mutate(i)}})}}}};function Gi(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function Wi(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var to={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new bt(e.MIN_KEY,e.MAX_KEY);return s(s({},e),{transaction:function(i,a,u){if(fe.subscr&&a!=="readonly")throw new Z.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(fe.querier));return e.transaction(i,a,u)},table:function(i){var a=e.table(i),u=a.schema,f=u.primaryKey,p=u.indexes,v=f.extractKey,y=f.outbound,m=f.autoIncrement&&p.filter(function(b){return b.compound&&b.keyPath.includes(f.keyPath)}),x=s(s({},a),{mutate:function(b){function w(J){return J="idb://".concat(t,"/").concat(i,"/").concat(J),L[J]||(L[J]=new bt)}var _,k,O,P=b.trans,L=b.mutatedParts||(b.mutatedParts={}),R=w(""),q=w(":dels"),ee=b.type,te=b.type==="deleteRange"?[b.range]:b.type==="delete"?[b.keys]:b.values.length<50?[ai(f,b).filter(function(J){return J}),b.values]:[],B=te[0],G=te[1],te=b.trans._cache;return g(B)?(R.addKeys(B),(te=ee==="delete"||B.length===G.length?Ui(B,te):null)||q.addKeys(B),(te||G)&&(_=w,k=te,O=G,u.indexes.forEach(function(J){var ae=_(J.name||"");function Ae(De){return De!=null?J.extractKey(De):null}function Te(De){return J.multiEntry&&g(De)?De.forEach(function(Ft){return ae.addKey(Ft)}):ae.addKey(De)}(k||O).forEach(function(De,wt){var Ie=k&&Ae(k[wt]),wt=O&&Ae(O[wt]);Ne(Ie,wt)!==0&&(Ie!=null&&Te(Ie),wt!=null&&Te(wt))})}))):B?(G={from:(G=B.lower)!==null&&G!==void 0?G:e.MIN_KEY,to:(G=B.upper)!==null&&G!==void 0?G:e.MAX_KEY},q.add(G),R.add(G)):(R.add(n),q.add(n),u.indexes.forEach(function(J){return w(J.name).add(n)})),a.mutate(b).then(function(J){return!B||b.type!=="add"&&b.type!=="put"||(R.addKeys(J.results),m&&m.forEach(function(ae){for(var Ae=b.values.map(function(Ie){return ae.extractKey(Ie)}),Te=ae.keyPath.findIndex(function(Ie){return Ie===f.keyPath}),De=0,Ft=J.results.length;De<Ft;++De)Ae[De][Te]=J.results[De];w(ae.name).addKeys(Ae)})),P.mutatedParts=dn(P.mutatedParts||{},L),J})}}),p=function(w){var _=w.query,w=_.index,_=_.range;return[w,new bt((w=_.lower)!==null&&w!==void 0?w:e.MIN_KEY,(_=_.upper)!==null&&_!==void 0?_:e.MAX_KEY)]},A={get:function(b){return[f,new bt(b.key)]},getMany:function(b){return[f,new bt().addKeys(b.keys)]},count:p,query:p,openCursor:p};return d(A).forEach(function(b){x[b]=function(w){var _=fe.subscr,k=!!_,O=Gi(fe,a)&&Wi(b,w)?w.obsSet={}:_;if(k){var P=function(G){return G="idb://".concat(t,"/").concat(i,"/").concat(G),O[G]||(O[G]=new bt)},L=P(""),R=P(":dels"),_=A[b](w),k=_[0],_=_[1];if((b==="query"&&k.isPrimaryKey&&!w.values?R:P(k.name||"")).add(_),!k.isPrimaryKey){if(b!=="count"){var q=b==="query"&&y&&w.values&&a.query(s(s({},w),{values:!1}));return a[b].apply(this,arguments).then(function(G){if(b==="query"){if(y&&w.values)return q.then(function(Ae){return Ae=Ae.result,L.addKeys(Ae),G});var te=w.values?G.result.map(v):G.result;(w.values?L:R).addKeys(te)}else if(b==="openCursor"){var J=G,ae=w.values;return J&&Object.create(J,{key:{get:function(){return R.addKey(J.primaryKey),J.key}},primaryKey:{get:function(){var Ae=J.primaryKey;return R.addKey(Ae),Ae}},value:{get:function(){return ae&&L.addKey(J.primaryKey),J.value}}})}return G})}R.add(n)}}return a[b].apply(this,arguments)}}),x}})}};function Yi(e,t,n){if(n.numFailures===0)return t;if(t.type==="deleteRange")return null;var i=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return n.numFailures===i?null:(t=s({},t),g(t.keys)&&(t.keys=t.keys.filter(function(a,u){return!(u in n.failures)})),"values"in t&&g(t.values)&&(t.values=t.values.filter(function(a,u){return!(u in n.failures)})),t)}function oi(e,t){return n=e,((i=t).lower===void 0||(i.lowerOpen?0<Ne(n,i.lower):0<=Ne(n,i.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?Ne(e,t.upper)<0:Ne(e,t.upper)<=0));var n,i}function Ji(e,t,A,i,a,u){if(!A||A.length===0)return e;var f=t.query.index,v=f.multiEntry,y=t.query.range,m=i.schema.primaryKey.extractKey,x=f.extractKey,p=(f.lowLevelIndex||f).extractKey,A=A.reduce(function(b,w){var _=b,k=[];if(w.type==="add"||w.type==="put")for(var O=new bt,P=w.values.length-1;0<=P;--P){var L,R=w.values[P],q=m(R);O.hasKey(q)||(L=x(R),(v&&g(L)?L.some(function(J){return oi(J,y)}):oi(L,y))&&(O.addKey(q),k.push(R)))}switch(w.type){case"add":var ee=new bt().addKeys(t.values?b.map(function(ae){return m(ae)}):b),_=b.concat(t.values?k.filter(function(ae){return ae=m(ae),!ee.hasKey(ae)&&(ee.addKey(ae),!0)}):k.map(function(ae){return m(ae)}).filter(function(ae){return!ee.hasKey(ae)&&(ee.addKey(ae),!0)}));break;case"put":var B=new bt().addKeys(w.values.map(function(ae){return m(ae)}));_=b.filter(function(ae){return!B.hasKey(t.values?m(ae):ae)}).concat(t.values?k:k.map(function(ae){return m(ae)}));break;case"delete":var G=new bt().addKeys(w.keys);_=b.filter(function(ae){return!G.hasKey(t.values?m(ae):ae)});break;case"deleteRange":var te=w.range;_=b.filter(function(ae){return!oi(m(ae),te)})}return _},e);return A===e?e:(A.sort(function(b,w){return Ne(p(b),p(w))||Ne(m(b),m(w))}),t.limit&&t.limit<1/0&&(A.length>t.limit?A.length=t.limit:e.length===t.limit&&A.length<t.limit&&(a.dirty=!0)),u?Object.freeze(A):A)}function Qi(e,t){return Ne(e.lower,t.lower)===0&&Ne(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function ro(e,t){return(function(n,i,a,u){if(n===void 0)return i!==void 0?-1:0;if(i===void 0)return 1;if((i=Ne(n,i))===0){if(a&&u)return 0;if(a)return 1;if(u)return-1}return i})(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=(function(n,i,a,u){if(n===void 0)return i!==void 0?1:0;if(i===void 0)return-1;if((i=Ne(n,i))===0){if(a&&u)return 0;if(a)return-1;if(u)return 1}return i})(e.upper,t.upper,e.upperOpen,t.upperOpen)}function no(e,t,n,i){e.subscribers.add(n),i.addEventListener("abort",function(){var a,u;e.subscribers.delete(n),e.subscribers.size===0&&(a=e,u=t,setTimeout(function(){a.subscribers.size===0&&ge(u,a)},3e3))})}var io={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return s(s({},e),{transaction:function(n,i,a){var u,f,v=e.transaction(n,i,a);return i==="readwrite"&&(f=(u=new AbortController).signal,a=function(y){return function(){if(u.abort(),i==="readwrite"){for(var m=new Set,x=0,p=n;x<p.length;x++){var A=p[x],b=lr["idb://".concat(t,"/").concat(A)];if(b){var w=e.table(A),_=b.optimisticOps.filter(function(ae){return ae.trans===v});if(v._explicit&&y&&v.mutatedParts)for(var k=0,O=Object.values(b.queries.query);k<O.length;k++)for(var P=0,L=(ee=O[k]).slice();P<L.length;P++)Zn((B=L[P]).obsSet,v.mutatedParts)&&(ge(ee,B),B.subscribers.forEach(function(ae){return m.add(ae)}));else if(0<_.length){b.optimisticOps=b.optimisticOps.filter(function(ae){return ae.trans!==v});for(var R=0,q=Object.values(b.queries.query);R<q.length;R++)for(var ee,B,G,te=0,J=(ee=q[R]).slice();te<J.length;te++)(B=J[te]).res!=null&&v.mutatedParts&&(y&&!B.dirty?(G=Object.isFrozen(B.res),G=Ji(B.res,B.req,_,w,B,G),B.dirty?(ge(ee,B),B.subscribers.forEach(function(ae){return m.add(ae)})):G!==B.res&&(B.res=G,B.promise=ne.resolve({result:G}))):(B.dirty&&ge(ee,B),B.subscribers.forEach(function(ae){return m.add(ae)})))}}}m.forEach(function(ae){return ae()})}}},v.addEventListener("abort",a(!1),{signal:f}),v.addEventListener("error",a(!1),{signal:f}),v.addEventListener("complete",a(!0),{signal:f})),v},table:function(n){var i=e.table(n),a=i.schema.primaryKey;return s(s({},i),{mutate:function(u){var f=fe.trans;if(a.outbound||f.db._options.cache==="disabled"||f.explicit||f.idbtrans.mode!=="readwrite")return i.mutate(u);var v=lr["idb://".concat(t,"/").concat(n)];return v?(f=i.mutate(u),u.type!=="add"&&u.type!=="put"||!(50<=u.values.length||ai(a,u).some(function(y){return y==null}))?(v.optimisticOps.push(u),u.mutatedParts&&fn(u.mutatedParts),f.then(function(y){0<y.numFailures&&(ge(v.optimisticOps,u),(y=Yi(0,u,y))&&v.optimisticOps.push(y),u.mutatedParts&&fn(u.mutatedParts))}),f.catch(function(){ge(v.optimisticOps,u),u.mutatedParts&&fn(u.mutatedParts)})):f.then(function(y){var m=Yi(0,s(s({},u),{values:u.values.map(function(x,p){var A;return y.failures[p]?x:(x=(A=a.keyPath)!==null&&A!==void 0&&A.includes(".")?xe(x):s({},x),he(x,a.keyPath,y.results[p]),x)})}),y);v.optimisticOps.push(m),queueMicrotask(function(){return u.mutatedParts&&fn(u.mutatedParts)})}),f):i.mutate(u)},query:function(u){if(!Gi(fe,i)||!Wi("query",u))return i.query(u);var f=((m=fe.trans)===null||m===void 0?void 0:m.db._options.cache)==="immutable",p=fe,v=p.requery,y=p.signal,m=(function(w,_,k,O){var P=lr["idb://".concat(w,"/").concat(_)];if(!P)return[];if(!(_=P.queries[k]))return[null,!1,P,null];var L=_[(O.query?O.query.index.name:null)||""];if(!L)return[null,!1,P,null];switch(k){case"query":var R=L.find(function(q){return q.req.limit===O.limit&&q.req.values===O.values&&Qi(q.req.query.range,O.query.range)});return R?[R,!0,P,L]:[L.find(function(q){return("limit"in q.req?q.req.limit:1/0)>=O.limit&&(!O.values||q.req.values)&&ro(q.req.query.range,O.query.range)}),!1,P,L];case"count":return R=L.find(function(q){return Qi(q.req.query.range,O.query.range)}),[R,!!R,P,L]}})(t,n,"query",u),x=m[0],p=m[1],A=m[2],b=m[3];return x&&p?x.obsSet=u.obsSet:(p=i.query(u).then(function(w){var _=w.result;if(x&&(x.res=_),f){for(var k=0,O=_.length;k<O;++k)Object.freeze(_[k]);Object.freeze(_)}else w.result=xe(_);return w}).catch(function(w){return b&&x&&ge(b,x),Promise.reject(w)}),x={obsSet:u.obsSet,promise:p,subscribers:new Set,type:"query",req:u,dirty:!1},b?b.push(x):(b=[x],(A=A||(lr["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[u.query.index.name||""]=b)),no(x,b,v,y),x.promise.then(function(w){return{result:Ji(w.result,u,A?.optimisticOps,i,x,f)}})}})}})}};function vn(e,t){return new Proxy(e,{get:function(n,i,a){return i==="db"?t:Reflect.get(n,i,a)}})}var qt=(ct.prototype.version=function(e){if(isNaN(e)||e<.1)throw new Z.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new Z.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(i){return i._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort(Ga),n.stores({}),this._state.autoSchema=!1,n)},ct.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||fe.letThrough||this._vip)?e():new ne(function(n,i){if(t._state.openComplete)return i(new Z.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void i(new Z.DatabaseClosed);t.open().catch(we)}t._state.dbReadyPromise.then(n,i)}).then(e)},ct.prototype.use=function(e){var t=e.stack,n=e.create,i=e.level,a=e.name;return a&&this.unuse({stack:t,name:a}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:n,level:i??10,name:a}),e.sort(function(u,f){return u.level-f.level}),this},ct.prototype.unuse=function(e){var t=e.stack,n=e.name,i=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(a){return i?a.create!==i:!!n&&a.name!==n})),this},ct.prototype.open=function(){var e=this;return ar(Et,function(){return Qa(e)})},ct.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var e=this._state,t=br.indexOf(this);if(0<=t&&br.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new ne(function(n){e.dbReadyResolve=n}),e.openCanceller=new ne(function(n,i){e.cancelOpen=i}))},ct.prototype.close=function(n){var t=(n===void 0?{disableAutoOpen:!0}:n).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new Z.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new Z.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},ct.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var n=0<arguments.length&&typeof arguments[0]!="object",i=this._state;return new ne(function(a,u){function f(){t.close(e);var v=t._deps.indexedDB.deleteDatabase(t.name);v.onsuccess=tt(function(){var y,m,x;y=t._deps,m=t.name,x=y.indexedDB,y=y.IDBKeyRange,Jn(x)||m===Xr||Yn(x,y).delete(m).catch(we),a()}),v.onerror=Ht(u),v.onblocked=t._fireOnBlocked}if(n)throw new Z.InvalidArgument("Invalid closeOptions argument to db.delete()");i.isBeingOpened?i.dbReadyPromise.then(f):f()})},ct.prototype.backendDB=function(){return this.idbdb},ct.prototype.isOpen=function(){return this.idbdb!==null},ct.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},ct.prototype.hasFailed=function(){return this._state.dbOpenError!==null},ct.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ct.prototype,"tables",{get:function(){var e=this;return d(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),ct.prototype.transaction=function(){var e=(function(t,n,i){var a=arguments.length;if(a<2)throw new Z.InvalidArgument("Too few arguments");for(var u=new Array(a-1);--a;)u[a-1]=arguments[a];return i=u.pop(),[t,ue(u),i]}).apply(this,arguments);return this._transaction.apply(this,e)},ct.prototype._transaction=function(e,t,n){var i=this,a=fe.trans;a&&a.db===this&&e.indexOf("!")===-1||(a=null);var u,f,v=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(f=t.map(function(m){if(m=m instanceof i.Table?m.name:m,typeof m!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return m}),e=="r"||e===Hn)u=Hn;else{if(e!="rw"&&e!=jn)throw new Z.InvalidArgument("Invalid transaction mode: "+e);u=jn}if(a){if(a.mode===Hn&&u===jn){if(!v)throw new Z.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a=null}a&&f.forEach(function(m){if(a&&a.storeNames.indexOf(m)===-1){if(!v)throw new Z.SubTransaction("Table "+m+" not included in parent transaction.");a=null}}),v&&a&&!a.active&&(a=null)}}catch(m){return a?a._promise(null,function(x,p){p(m)}):ut(m)}var y=(function m(x,p,A,b,w){return ne.resolve().then(function(){var _=fe.transless||fe,k=x._createTransaction(p,A,x._dbSchema,b);if(k.explicit=!0,_={trans:k,transless:_},b)k.idbtrans=b.idbtrans;else try{k.create(),k.idbtrans._explicit=!0,x._state.PR1398_maxLoop=3}catch(L){return L.name===Me.InvalidState&&x.isOpen()&&0<--x._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),x.close({disableAutoOpen:!1}),x.open().then(function(){return m(x,p,A,null,w)})):ut(L)}var O,P=Ue(w);return P&&mr(),_=ne.follow(function(){var L;(O=w.call(k,k))&&(P?(L=Wt.bind(null,null),O.then(L,L)):typeof O.next=="function"&&typeof O.throw=="function"&&(O=ni(O)))},_),(O&&typeof O.then=="function"?ne.resolve(O).then(function(L){return k.active?L:ut(new Z.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):_.then(function(){return O})).then(function(L){return b&&k._resolve(),k._completion.then(function(){return L})}).catch(function(L){return k._reject(L),ut(L)})})}).bind(null,this,u,f,a,n);return a?a._promise(u,y,"lock"):fe.trans?ar(fe.transless,function(){return i._whenReady(y)}):this._whenReady(y)},ct.prototype.table=function(e){if(!F(this._allTables,e))throw new Z.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},ct);function ct(e,t){var n=this;this._middlewares={},this.verno=0;var i=ct.dependencies;this._options=t=s({addons:ct.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},i=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a,u,f,v,y,m={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:we,dbReadyPromise:null,cancelOpen:we,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};m.dbReadyPromise=new ne(function(p){m.dbReadyResolve=p}),m.openCanceller=new ne(function(p,A){m.cancelOpen=A}),this._state=m,this.name=e,this.on=Nr(this,"populate","blocked","versionchange","close",{ready:[We,we]}),this.once=function(p,A){var b=function(){for(var w=[],_=0;_<arguments.length;_++)w[_]=arguments[_];n.on(p).unsubscribe(b),A.apply(n,w)};return n.on(p,b)},this.on.ready.subscribe=j(this.on.ready.subscribe,function(p){return function(A,b){ct.vip(function(){var w,_=n._state;_.openComplete?(_.dbOpenError||ne.resolve().then(A),b&&p(A)):_.onReadyBeingFired?(_.onReadyBeingFired.push(A),b&&p(A)):(p(A),w=n,b||p(function k(){w.on.ready.unsubscribe(A),w.on.ready.unsubscribe(k)}))})}}),this.Collection=(a=this,Mr(za.prototype,function(O,k){this.db=a;var b=Ii,w=null;if(k)try{b=k()}catch(P){w=P}var _=O._ctx,k=_.table,O=k.hook.reading.fire;this._ctx={table:k,index:_.index,isPrimKey:!_.index||k.schema.primKey.keyPath&&_.index===k.schema.primKey.name,range:b,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:w,or:_.or,valueMapper:O!==Be?O:null}})),this.Table=(u=this,Mr(Di.prototype,function(p,A,b){this.db=u,this._tx=b,this.name=p,this.schema=A,this.hook=u._allTables[p]?u._allTables[p].hook:Nr(null,{creating:[vt,we],reading:[ft,Be],updating:[pt,we],deleting:[It,we]})})),this.Transaction=(f=this,Mr(Ba.prototype,function(p,A,b,w,_){var k=this;p!=="readonly"&&A.forEach(function(O){O=(O=b[O])===null||O===void 0?void 0:O.yProps,O&&(A=A.concat(O.map(function(P){return P.updatesTable})))}),this.db=f,this.mode=p,this.storeNames=A,this.schema=b,this.chromeTransactionDurability=w,this.idbtrans=null,this.on=Nr(this,"complete","error","abort"),this.parent=_||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new ne(function(O,P){k._resolve=O,k._reject=P}),this._completion.then(function(){k.active=!1,k.on.complete.fire()},function(O){var P=k.active;return k.active=!1,k.on.error.fire(O),k.parent?k.parent._reject(O):P&&k.idbtrans&&k.idbtrans.abort(),ut(O)})})),this.Version=(v=this,Mr(Ja.prototype,function(p){this.db=v,this._cfg={version:p,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(y=this,Mr(Ri.prototype,function(p,A,b){if(this.db=y,this._ctx={table:p,index:A===":id"?null:A,or:b},this._cmp=this._ascending=Ne,this._descending=function(w,_){return Ne(_,w)},this._max=function(w,_){return 0<Ne(w,_)?w:_},this._min=function(w,_){return Ne(w,_)<0?w:_},this._IDBKeyRange=y._deps.IDBKeyRange,!this._IDBKeyRange)throw new Z.MissingAPI})),this.on("versionchange",function(p){0<p.newVersion?console.warn("Another connection wants to upgrade database '".concat(n.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(n.name,"'. Closing db now to resume the delete request.")),n.close({disableAutoOpen:!1})}),this.on("blocked",function(p){!p.newVersion||p.newVersion<p.oldVersion?console.warn("Dexie.delete('".concat(n.name,"') was blocked")):console.warn("Upgrade '".concat(n.name,"' blocked by other connection holding version ").concat(p.oldVersion/10))}),this._maxKey=jr(t.IDBKeyRange),this._createTransaction=function(p,A,b,w){return new n.Transaction(p,A,b,n._options.chromeTransactionDurability,w)},this._fireOnBlocked=function(p){n.on("blocked").fire(p),br.filter(function(A){return A.name===n.name&&A!==n&&!A._state.vcFired}).map(function(A){return A.on("versionchange").fire(p)})},this.use(eo),this.use(io),this.use(to),this.use(Xa),this.use(Za);var x=new Proxy(this,{get:function(p,A,b){if(A==="_vip")return!0;if(A==="table")return function(_){return vn(n.table(_),x)};var w=Reflect.get(p,A,b);return w instanceof Di?vn(w,x):A==="tables"?w.map(function(_){return vn(_,x)}):A==="_createTransaction"?function(){return vn(w.apply(this,arguments),x)}:w}});this.vip=x,i.forEach(function(p){return p(n)})}var pn,Mt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",ao=(si.prototype.subscribe=function(e,t,n){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:n})},si.prototype[Mt]=function(){return this},si);function si(e){this._subscribe=e}try{pn={indexedDB:h.indexedDB||h.mozIndexedDB||h.webkitIndexedDB||h.msIndexedDB,IDBKeyRange:h.IDBKeyRange||h.webkitIDBKeyRange}}catch{pn={indexedDB:null,IDBKeyRange:null}}function Xi(e){var t,n=!1,i=new ao(function(a){var u=Ue(e),f,v=!1,y={},m={},x={get closed(){return v},unsubscribe:function(){v||(v=!0,f&&f.abort(),p&&Qt.storagemutated.unsubscribe(b))}};a.start&&a.start(x);var p=!1,A=function(){return Rn(w)},b=function(_){dn(y,_),Zn(m,y)&&A()},w=function(){var _,k,O;!v&&pn.indexedDB&&(y={},_={},f&&f.abort(),f=new AbortController,O=(function(P){var L=gr();try{u&&mr();var R=Gt(e,P);return R=u?R.finally(Wt):R}finally{L&&yr()}})(k={subscr:_,signal:f.signal,requery:A,querier:e,trans:null}),Promise.resolve(O).then(function(P){n=!0,t=P,v||k.signal.aborted||(y={},(function(L){for(var R in L)if(F(L,R))return;return 1})(m=_)||p||(Qt(Hr,b),p=!0),Rn(function(){return!v&&a.next&&a.next(P)}))},function(P){n=!1,["DatabaseClosedError","AbortError"].includes(P?.name)||v||Rn(function(){v||a.error&&a.error(P)})}))};return setTimeout(A,0),x});return i.hasValue=function(){return n},i.getValue=function(){return t},i}var ur=qt;function li(e){var t=Xt;try{Xt=!0,Qt.storagemutated.fire(e),ri(e,!0)}finally{Xt=t}}E(ur,s(s({},Ke),{delete:function(e){return new ur(e,{addons:[]}).delete()},exists:function(e){return new ur(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=ur.dependencies,n=t.indexedDB,t=t.IDBKeyRange,(Jn(n)?Promise.resolve(n.databases()).then(function(i){return i.map(function(a){return a.name}).filter(function(a){return a!==Xr})}):Yn(n,t).toCollection().primaryKeys()).then(e)}catch{return ut(new Z.MissingAPI)}var t,n},defineClass:function(){return function(e){T(this,e)}},ignoreTransaction:function(e){return fe.trans?ar(fe.transless,e):e()},vip:Qn,async:function(e){return function(){try{var t=ni(e.apply(this,arguments));return t&&typeof t.then=="function"?t:ne.resolve(t)}catch(n){return ut(n)}}},spawn:function(e,t,n){try{var i=ni(e.apply(n,t||[]));return i&&typeof i.then=="function"?i:ne.resolve(i)}catch(a){return ut(a)}},currentTransaction:{get:function(){return fe.trans||null}},waitFor:function(e,t){return t=ne.resolve(typeof e=="function"?ur.ignoreTransaction(e):e).timeout(t||6e4),fe.trans?fe.trans.waitFor(t):t},Promise:ne,debug:{get:function(){return Ye},set:function(e){ht(e)}},derive:N,extend:T,props:E,override:j,Events:Nr,on:Qt,liveQuery:Xi,extendObservabilitySet:dn,getByKeyPath:X,setByKeyPath:he,delByKeyPath:function(e,t){typeof t=="string"?he(e,t,void 0):"length"in t&&[].map.call(t,function(n){he(e,n,void 0)})},shallowClone:_e,deepClone:xe,getObjectDiff:ii,cmp:Ne,asap:ce,minKey:-1/0,addons:[],connections:br,errnames:Me,dependencies:pn,cache:lr,semVer:"4.2.1",version:"4.2.1".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)})})),ur.maxKey=jr(ur.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Qt(Hr,function(e){Xt||(e=new CustomEvent(Kn,{detail:e}),Xt=!0,dispatchEvent(e),Xt=!1)}),addEventListener(Kn,function(e){e=e.detail,Xt||li(e)}));var xr,Xt=!1,Zi=function(){};return typeof BroadcastChannel<"u"&&((Zi=function(){(xr=new BroadcastChannel(Kn)).onmessage=function(e){return e.data&&li(e.data)}})(),typeof xr.unref=="function"&&xr.unref(),Qt(Hr,function(e){Xt||xr.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!qt.disableBfCache&&e.persisted){Ye&&console.debug("Dexie: handling persisted pagehide"),xr?.close();for(var t=0,n=br;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!qt.disableBfCache&&e.persisted&&(Ye&&console.debug("Dexie: handling persisted pageshow"),Zi(),li({all:new bt(-1/0,[[]])}))})),ne.rejectionMapper=function(e,t){return!e||e instanceof Ge||e instanceof TypeError||e instanceof SyntaxError||!e.name||!lt[e.name]?e:(t=new lt[e.name](t||e.message,e),"stack"in e&&M(t,"stack",{get:function(){return this.inner.stack}}),t)},ht(Ye),s(qt,Object.freeze({__proto__:null,Dexie:qt,liveQuery:Xi,Entity:Ai,cmp:Ne,PropModification:Lr,replacePrefix:function(e,t){return new Lr({replacePrefix:[e,t]})},add:function(e){return new Lr({add:e})},remove:function(e){return new Lr({remove:e})},default:qt,RangeSet:bt,mergeRanges:Kr,rangesOverlap:Ki}),{default:qt}),qt})})(Cn)),Cn.exports}var sl=ol();const hi=is(sl),ga=Symbol.for("Dexie"),An=globalThis[ga]||(globalThis[ga]=hi);if(hi.semVer!==An.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${hi.semVer} and ${An.semVer}`);const{liveQuery:Rc,mergeRanges:Hc,rangesOverlap:jc,RangeSet:zc,cmp:Vc,Entity:Kc,PropModification:Bc,replacePrefix:qc,add:$c,remove:Uc,DexieYProvider:Gc}=An;class ll extends An{uprnSelections;areaSelections;dataSelections;userDownloads;constructor(){super("app-db"),this.version(1).stores({uprnSelections:"++id, createdAt",areaSelections:"++id, layerId, *areaIds",dataSelections:"++id, layerId, *fields",userDownloads:"++id, &localId, createdAt"})}}const $r=new ll,ul=async()=>await $r.uprnSelections.clear(),cl=async(S,r,o)=>await $r.userDownloads.add({localId:S,areaSelection:r,dataSelections:o,status:Zt.Pending,createdAt:Date.now()}),dl=async(S,r,o,s)=>{const c={};r!==void 0&&(c.externalId=r),o!==void 0&&(c.areaSelection=o),s!==void 0&&(c.dataSelections=s),Object.keys(c).length!==0&&await $r.userDownloads.where("localId").equals(S).modify(c)},fl=async()=>await $r.userDownloads.orderBy("createdAt").reverse().toArray(),hl=async S=>await $r.userDownloads.where("localId").equals(S).delete();class vl{#e=re(qe(new Rt));constructor(){this.#t()}addDownload(r){console.log("[downloads-store] Adding download:",r),l(this.#e).set(r.localId,r),cl(r.localId,r.areaSelection,r.dataSelections)}updateDownloadStatus(r){console.log("[downloads-store] Updating download status:",r),l(this.#e).set(r.localId,{...r}),dl(r.localId,r.externalId,r.areaSelection,r.dataSelections)}removeDownload(r){l(this.#e).delete(r),hl(r)}getDownloads(){return Array.from(l(this.#e).values())}async#t(){const r=await fl();!r||r.length===0||(console.log("Loaded downloads from DB:",r),r.forEach(o=>{l(this.#e).set(o.localId,{localId:o.localId,status:Zt.Pending,areaSelection:o.areaSelection,dataSelections:o.dataSelections})}))}}const Br=new vl;var pl=oe('<div class="data-item svelte-v4uih6"><span class="data-name svelte-v4uih6"> </span> <div class="data-actions svelte-v4uih6"><!></div></div>');function vi(S,r){const o=Fe(r,"title",3,"");Tn(S,{class:"data-item-card",children:(s,c)=>{var h=pl(),d=Q(h),g=Q(d,!0);U(d);var T=de(d,2),I=Q(T);$e(I,()=>r.children??Qe),U(T),U(h),dt(()=>{bi(d,"title",o()),Tt(g,o())}),D(s,h)},$$slots:{default:!0}})}var gl=oe("<!> <!> <!> <!>",1),yl=oe('<ul class="selected-list svelte-vgw5fc"></ul> <p class="count svelte-vgw5fc"> </p>',1),ml=oe('<p class="no-selection svelte-vgw5fc">No downloads in queue</p>'),bl=oe('<div class="section svelte-vgw5fc"><h4 class="svelte-vgw5fc">Download Queue</h4> <!></div>');function wl(S,r){Re(r,!0);let o=re(qe(new Set));const s=pe(()=>Br.getDownloads()),c={completed:{color:"#059669",text:"Completed",icon:Mo},"in-progress":{color:"#2563eb",text:"In Progress",icon:No},failed:{color:"#dc2626",text:"Failed",icon:Lo},pending:{color:"#6b7280",text:"Pending",icon:Fo}};kr(()=>{const z=setInterval(()=>{h()},5e3);return()=>{clearInterval(z)}}),Ze(()=>{if(!l(s)||l(s).length<=0||!r.uprnDownloadService)return;(async()=>{for(const H of l(s)){if(H.externalId||H.status!==Zt.Pending)continue;const V={exports:{areaSelectionLayer:{remoteId:H.areaSelection.layerId,areas:H.areaSelection.areas},dataSelectionLayers:H.dataSelections.map(W=>({remoteId:W.layerId,fields:W.fields.filter(ce=>!r.fieldsToHide||!r.fieldsToHide.has(ce))}))}};console.log("[downloads-menu] Submitting download request:",V);const j=await r.uprnDownloadService.requestJob(V);if(!j||j.type===il.Error){console.error("[downloads-menu] Failed to submit download request.",j);continue}H.externalId=j.guid,H.status=Zt.InProgress,Br.updateDownloadStatus(H)}})()});async function h(){if(l(s).length<=0||!r.uprnDownloadService)return;const z={jobs:l(s).filter(V=>V.externalId).map(V=>V.externalId)},H=await r.uprnDownloadService.requestJobStatuses(z);if(!H){console.error("[downloads-menu] Failed to get job statuses.",H);return}for(const V of H.jobs){const j=l(s).find(W=>W.externalId===V.guid);if(!j){console.warn("[downloads-menu] Received job status for unknown download:",V.guid);continue}switch(V.status.type){case Sn.Submitted:case Sn.Processing:j.status=Zt.InProgress;break;case Sn.Completed:j.status=Zt.Completed;break;case Sn.Error:j.status=Zt.Failed;break;default:console.warn("[downloads-menu] Unknown job status type:",V.status.type);break}Br.updateDownloadStatus(j)}}function d(z){Br.removeDownload(z)}async function g(z){try{await navigator.clipboard.writeText(z),K(o,new Set(l(o)).add(z),!0),hr.success("URL copied to clipboard"),setTimeout(()=>{const H=new Set(l(o));H.delete(z),K(o,H,!0)},2e3)}catch(H){console.error("Failed to copy URL:",H),hr.error("Failed to copy URL to clipboard")}}function T(z){return c[z]?.color??c.pending.color}function I(z){return c[z]?.text??c.pending.text}function C(z){return c[z]?.icon??c.pending.icon}function F(z){return r.uprnDownloadService.getDownloadUrl(z)}var E=bl(),Y=de(Q(E),2);{var M=z=>{var H=yl(),V=$(H);zt(V,21,()=>l(s),Ar,(ce,X)=>{{let he=pe(()=>l(X).externalId?l(X).externalId:"Pending...");vi(ce,{get title(){return l(he)},children:(_e,Oe)=>{var ue=gl(),Se=$(ue);{let ie=pe(()=>T(l(X).status)),ge=pe(()=>I(l(X).status));Ot(Se,{variant:"ghost",size:"sm",class:"download-status-btn",get style(){return`color: ${l(ie)??""}`},get title(){return l(ge)},disabled:!0,children:(ve,me)=>{const Ue=pe(()=>C(l(X).status));var Xe=se(),Ge=$(Xe);{let at=pe(()=>l(X).status==="in-progress"?"spinning":"");Le(Ge,()=>l(Ue),(be,Ee)=>{Ee(be,{size:14,get class(){return l(at)}})})}D(ve,Xe)},$$slots:{default:!0}})}var ke=de(Se,2);{var xe=ie=>{Ot(ie,{variant:"ghost",size:"sm",class:"download-clipboard-btn",onclick:()=>g(F(l(X).externalId)),title:"Copy URL to clipboard",children:(ge,ve)=>{var me=se(),Ue=$(me);{var Xe=at=>{Eo(at,{size:14})},Ge=at=>{Do(at,{size:14})};ye(Ue,at=>{l(o).has(F(l(X).externalId))?at(Xe):at(Ge,!1)})}D(ge,me)},$$slots:{default:!0}})};ye(ke,ie=>{l(X).externalId&&ie(xe)})}var le=de(ke,2);{var Ce=ie=>{Ot(ie,{variant:"ghost",size:"sm",class:"download-action-btn",onclick:()=>window.open(F(l(X).externalId),"_blank"),title:"Open download",children:(ge,ve)=>{Is(ge,{})},$$slots:{default:!0}})};ye(le,ie=>{l(X).externalId&&l(X).status==="completed"&&ie(Ce)})}var je=de(le,2);Ot(je,{variant:"ghost",size:"sm",class:"download-remove-btn",onclick:()=>d(l(X).localId),title:"Remove from queue",children:(ie,ge)=>{fr();var ve=Cr("");D(ie,ve)},$$slots:{default:!0}}),D(_e,ue)},$$slots:{default:!0}})}}),U(V);var j=de(V,2),W=Q(j);U(j),dt(()=>Tt(W,`${l(s).length??""} download(s) in queue`)),D(z,H)},N=z=>{var H=ml();D(z,H)};ye(Y,z=>{l(s).length>0?z(M):z(N,!1)})}U(E),D(S,E),He()}class _l{#e=re(qe(new Rt));addSelection(r){l(this.#e).set(r.layerId,r),hr.success(`'${r.layer.title}' Added`)}removeSelection(r){const o=l(this.#e).get(r);l(this.#e).delete(r),hr.success(`'${o?.layer.title}' Removed`)}getSelection(r){return l(this.#e).get(r)}getAllSelections(){return Array.from(l(this.#e).values())}clearSelections(){l(this.#e).clear(),console.log("[data-selection-store] selections cleared.")}cleanup(){l(this.#e).clear()}}const Ct=new _l;var Sl=oe('<div class="export-footer svelte-10dgoyk"><div class="export-footer__left svelte-10dgoyk"><p class="text-sm text-muted-foreground svelte-10dgoyk">Click "Export" to begin the download.</p></div> <div class="export-footer__right svelte-10dgoyk"><!></div></div>');function xl(S,r){Re(r,!0);function o(){if(Pe.layerHighlightState.areaInfos.length<=0){hr.error("Please select at least one area to export.");return}if(Ct.getAllSelections().length<=0){hr.error("Please select at least one data layer to export.");return}console.log("Starting export..."),(async()=>{const g={layerId:Pe.layerHighlightState.featureLayerView?.layer.id||"",layerIndex:Pe.layerHighlightState.featureLayerView?.layer.layerId||0,areas:await Pe.getAreaCodesById(Pe.layerHighlightState.areaInfos.map(C=>C.id))},T=Ct.getAllSelections().map(C=>({layerId:C.layerId,layerIndex:C.layer instanceof di?C.layer.layerId:-1,fields:Array.from(C.fields)})),I=crypto.randomUUID();Br.addDownload({localId:I,status:Zt.Pending,areaSelection:g,dataSelections:T}),r.onExportSuccess?.()})()}var s=Sl(),c=de(Q(s),2),h=Q(c);Ot(h,{onclick:o,children:(d,g)=>{fr();var T=Cr("Export");D(d,T)},$$slots:{default:!0}}),U(c),U(s),D(S,s),He()}class Cl{#e=re(null);get ActiveLayer(){return l(this.#e)}set ActiveLayer(r){K(this.#e,r,!0)}}class kl{#e=re(!1);get isLoaded(){return l(this.#e)}set isLoaded(r){K(this.#e,r,!0)}#t=re(null);get data(){return l(this.#t)}set data(r){K(this.#t,r,!0)}#r=pe(()=>{const r=new Rt;function o(s){r.set(s.id,s),s.type==="group"&&s.layers.forEach(h=>{o(h)})}return this.data&&this.data.layers.forEach(s=>{o(s)}),r});get dataLookup(){return l(this.#r)}set dataLookup(r){K(this.#r,r)}#n=re(!1);get loading(){return l(this.#n)}set loading(r){K(this.#n,r,!0)}#o=re(null);get error(){return l(this.#o)}set error(r){K(this.#o,r,!0)}async initializeAsync(r){if(!this.data){this.loading=!0,this.error=null;try{const{portalUrl:o,itemId:s,proxy:c}=r;await this.configurePortalAsync(o,c),await this.loadwebmapAsync(s)}catch(o){console.error("Error initializing webmap:",o),this.error=o.message}finally{this.loading=!1}}}async configurePortalAsync(r,o){if(!r||(ia.portalUrl=r,console.log(ia),!o))return;const{addProxyRule:s}=fs;console.log("Adding proxy rule for portal traffic"),s({urlPrefix:o?.urlPrefix,proxyUrl:o?.proxyUrl})}async loadwebmapAsync(r){if(this.data)return;const o=new ds({id:r}),s=new cs({portalItem:o});this.data=s,await this.data.when(),this.data.loaded&&(this.isLoaded=!0)}clear(){this.data=null,this.loading=!1,this.error=null}clearError(){this.error=null}getWebmap(){return this.data}}function Il(S,r){S.stopPropagation(),r.onFilterClicked?.(r.layerId)}var Al=oe('<button title="Filter"><!></button>');function Ol(S,r){Re(r,!0);let o=re(qe(r.hasFiltersApplied?.(r.layerId)??!1));Ze(()=>{K(o,r.hasFiltersApplied?.(r.layerId)??!1,!0)});const s=pe(()=>l(o)?Ro:Ho);var c=Al();let h;c.__click=[Il,r];var d=Q(c);qr(d,()=>l(s)),U(c),dt(g=>{h=tr(c,1,"filter-btn svelte-k95pvd",null,h,g),bi(c,"aria-pressed",l(o))},[()=>({active:l(o)})]),D(S,c),He()}En(["click"]);var Pl=oe('<ul class="selected-list"></ul> <p class="count svelte-81yb5c"> </p>',1),Tl=oe('<p class="no-selection svelte-81yb5c">No areas selected</p>'),El=oe("<!> <!>",1),Dl=oe('<ul></ul> <p class="count svelte-81yb5c"> </p>',1),Fl=oe('<p class="no-selection svelte-81yb5c">No data selected</p>'),Ll=oe('<h2 class="svelte-81yb5c">Export Options</h2> <div class="section svelte-81yb5c"><h3 class="svelte-81yb5c"> </h3> <h4 class="svelte-81yb5c">Selected Areas</h4> <!></div> <div class="section svelte-81yb5c"><h4 class="svelte-81yb5c">Selected Data</h4> <!></div>',1);function Nl(S,r){Re(r,!0);const o=Fe(r,"fieldFilterMenuStore",7);let s=re(qe([]));Ze(()=>{if(!Pe.layerHighlightState.areaInfos.length){K(s,[],!0);return}(async()=>{const W=await Pe.getAreaNamesById(Pe.layerHighlightState.areaInfos.map(X=>X.id)),ce=[];for(let X=0;X<W.length;X++)ce.push({name:W[X]||"Unknown Area",HighlightAreaInfo:Pe.layerHighlightState.areaInfos[X]});K(s,ce,!0)})()});function c(j){const W=l(s).findIndex(ce=>ce.name===j);W!==-1&&Pe.removeSelectedArea(l(s)[W]?.HighlightAreaInfo.id)}function h(j){console.log("[export-menu] Removing data selection for layerId:",j),Ct.removeSelection(j),console.log("[export-menu] Current SelectedData:",_o(Ct.getAllSelections()))}function d(j){if(o().ActiveLayer?.id===j){o().ActiveLayer=null;return}const W=r.webMapStore.dataLookup.get(j);if(!W){console.warn(`[export-menu] Layer with ID ${j} not found in web map store.`);return}o().ActiveLayer=W}function g(j){const W=Ct.getSelection(j);return!(!W||!W.fields||W.fields.size===0||W.fields.size===r.webMapStore.dataLookup.get(j)?.fields?.length)}var T=Ll(),I=de($(T),2),C=Q(I),F=Q(C,!0);U(C);var E=de(C,4);{var Y=j=>{var W=Pl(),ce=$(W);zt(ce,21,()=>l(s),Ar,(_e,Oe)=>{vi(_e,{get title(){return l(Oe).name},children:(ue,Se)=>{Ot(ue,{variant:"ghost",size:"sm",class:"area-remove-btn",title:"Remove area",onclick:()=>c(l(Oe).name),children:(ke,xe)=>{fr();var le=Cr("");D(ke,le)},$$slots:{default:!0}})},$$slots:{default:!0}})}),U(ce);var X=de(ce,2),he=Q(X);U(X),dt(()=>Tt(he,`${l(s).length??""} area(s) selected`)),D(j,W)},M=j=>{var W=Tl();D(j,W)};ye(E,j=>{l(s).length>0?j(Y):j(M,!1)})}U(I);var N=de(I,2),z=de(Q(N),2);{var H=j=>{var W=Dl(),ce=$(W);zt(ce,21,()=>Ct.getAllSelections(),Ar,(_e,Oe)=>{{let ue=pe(()=>l(Oe).layer.title??"");vi(_e,{get title(){return l(ue)},children:(Se,ke)=>{var xe=El(),le=$(xe);{var Ce=ie=>{Ol(ie,{get layerId(){return l(Oe).layerId},onFilterClicked:d,hasFiltersApplied:g})};ye(le,ie=>{r.dataSelectionTreeviewConfig?.getItemConfig(l(Oe).layerId)?.showFields&&ie(Ce)})}var je=de(le,2);Ot(je,{variant:"ghost",size:"sm",class:"data-remove-btn",title:"Remove data selection",onclick:()=>h(l(Oe).layerId),children:(ie,ge)=>{fr();var ve=Cr("");D(ie,ve)},$$slots:{default:!0}}),D(Se,xe)},$$slots:{default:!0}})}}),U(ce);var X=de(ce,2),he=Q(X);U(X),dt(_e=>Tt(he,`${_e??""} data layer(s) selected`),[()=>Ct.getAllSelections().length]),D(j,W)},V=j=>{var W=Fl();D(j,W)};ye(z,j=>{Ct.getAllSelections().length>0?j(H):j(V,!1)})}U(N),dt(()=>Tt(F,Pe.visibleLayer?Pe.visibleLayer.title:"Loading...")),D(S,T),He()}function Ml(S,r){S.target===S.currentTarget&&r()}var Rl=(S,r)=>S.key==="Escape"&&r(),Hl=(S,r,o)=>r(l(o).name),jl=oe('<div class="info-icon-container svelte-fp5rsc"><!></div>'),zl=oe('<div class="field-content-wrapper svelte-fp5rsc"><!> <button class="field-content svelte-fp5rsc" tabindex="0"><div class="field-name-container svelte-fp5rsc"><span class="field-name svelte-fp5rsc"> </span> <!></div></button></div>'),Vl=oe('<div class="master-checkbox-container svelte-fp5rsc"><!> <span class="master-checkbox-label svelte-fp5rsc">Select All Fields</span></div> <!> <!>',1),Kl=oe("<!> <!>",1),Bl=oe("<!> <!>",1),ql=oe('<button class="close-button svelte-fp5rsc" aria-label="Close"><!></button> <!>',1),$l=oe('<div class="card-container svelte-fp5rsc" role="dialog" aria-modal="true" tabindex="-1"><!></div>');function Ul(S,r){Re(r,!0);const o=Fe(r,"fieldFilterMenuStore",7);let s=re(null),c=re(qe(new dr)),h=pe(()=>{if(!l(s)||!l(s).fields)return{checked:!1,indeterminate:!1};const M=l(s).fields.length,N=l(c)?.size||0;return N===0?{checked:!1,indeterminate:!1}:N===M?{checked:!0,indeterminate:!1}:{checked:!1,indeterminate:!0}});Ze(()=>{const M=o().ActiveLayer;if(!M){K(s,null),K(c,new dr,!0);return}K(s,M,!0);const N=Ct.getSelection(M.id);N?.fields?K(c,new dr([...N.fields]),!0):K(c,new dr,!0)});function d(){g(),o().ActiveLayer=null}function g(){if(!l(s))return;let M=Ct.getSelection(l(s).id);if(M){if((M.fields===void 0||M.fields===null)&&(M.fields=new dr),l(c).size===0){Ct.removeSelection(l(s).id);return}M.fields.clear(),l(c).forEach(N=>{M.fields?.add(N)})}}function T(M){l(s)&&(l(c).has(M)?l(c).delete(M):l(c).add(M))}function I(){if(!l(s)?.fields)return;(l(c)?.size||0)===0?l(s).fields.forEach(N=>{l(c).add(N.name)}):l(c).clear()}function C(){if(!l(s)?.fields)return[];const M=l(s).fields.filter(N=>!r.fieldsToHide.has(N.name.toLowerCase()));return console.log("Filtered fields to show:",M,r.fieldsToHide,l(s).fields),M}var F=se(),E=$(F);{var Y=M=>{var N=$l();N.__click=[Ml,d],N.__keydown=[Rl,d];var z=Q(N);Le(z,()=>Tn,(H,V)=>{V(H,{class:"command-card",children:(j,W)=>{var ce=ql(),X=$(ce);X.__click=d;var he=Q(X);So(he,{size:20}),U(X);var _e=de(X,2);Le(_e,()=>Pn,(Oe,ue)=>{ue(Oe,{class:"card-content",children:(Se,ke)=>{var xe=se(),le=$(xe);Le(le,()=>xo,(Ce,je)=>{je(Ce,{children:(ie,ge)=>{var ve=Bl(),me=$(ve);Le(me,()=>Co,(Xe,Ge)=>{Ge(Xe,{placeholder:"Search for fields..."})});var Ue=de(me,2);Le(Ue,()=>ko,(Xe,Ge)=>{Ge(Xe,{children:(at,be)=>{var Ee=Kl(),Me=$(Ee);Le(Me,()=>Io,(Z,lt)=>{lt(Z,{children:(Ke,we)=>{fr();var Be=Cr("No results found.");D(Ke,Be)},$$slots:{default:!0}})});var ot=de(Me,2);Le(ot,()=>Ao,(Z,lt)=>{lt(Z,{heading:"Fields",children:(Ke,we)=>{var Be=Vl(),ft=$(Be),nt=Q(ft);ea(nt,{get checked(){return l(h).checked},get indeterminate(){return l(h).indeterminate},onCheckedChange:I}),fr(2),U(ft);var vt=de(ft,2);Le(vt,()=>jo,(pt,et)=>{et(pt,{})});var It=de(vt,2);zt(It,17,C,Ar,(pt,et)=>{var We=se(),Ye=$(We);Le(Ye,()=>Oo,(ht,St)=>{St(ht,{class:"field-item",onselect:()=>T(l(et).name),children:(Nt,mt)=>{var st=zl(),At=Q(st);{let Kt=pe(()=>l(c)?.has(l(et).name)??!1);ea(At,{class:"field-checkbox",get checked(){return l(Kt)},onCheckedChange:()=>T(l(et).name)})}var rr=de(At,2);rr.__click=[Hl,T,et];var Ut=Q(rr),nr=Q(Ut),vr=Q(nr,!0);U(nr);var Vt=de(nr,2);{var pr=Kt=>{var Et=jl(),fe=Q(Et);qr(fe,()=>zo),U(Et),dt(()=>bi(Et,"title",l(et).description)),D(Kt,Et)};ye(Vt,Kt=>{l(et).description&&Kt(pr)})}U(Ut),U(rr),U(st),dt(()=>Tt(vr,l(et).alias||l(et).name)),D(Nt,st)},$$slots:{default:!0}})}),D(pt,We)}),D(Ke,Be)},$$slots:{default:!0}})}),D(at,Ee)},$$slots:{default:!0}})}),D(ie,ve)},$$slots:{default:!0}})}),D(Se,xe)},$$slots:{default:!0}})}),D(j,ce)},$$slots:{default:!0}})}),U(N),D(M,N)};ye(E,M=>{l(s)&&M(Y)})}D(S,F),He()}En(["click","keydown"]);class Oa{id;name;children;parent;constructor(r,o,s=[],c=null){this.id=r,this.name=o,this.children=s,this.parent=c}}class it extends Oa{layer;constructor(r,o,s,c=[],h=null){super(r,o,c,h),this.layer=s}}class Or extends it{featureLayer;field;constructor(r,o,s,c,h=[],d=null){super(r,o,s,h,d),this.field=c,this.featureLayer=s}}var rt=(S=>(S.Inactive="inactive",S.Indeterminate="indeterminate",S.Active="active",S))(rt||{}),er=(S=>(S.Hidden="hidden",S.Suspended="suspended",S.Visible="visible",S))(er||{});class Pa{#e=re(!1);get initialized(){return l(this.#e)}set initialized(r){K(this.#e,r,!0)}#t=null;#r=null;#n=re(qe([]));#o=pe(()=>{const r=new Rt;return this.#S(l(this.#n),r),r});#i=re(qe(new Rt));#a=re(qe(new Rt));#s=re(qe(new Rt));#u=re(qe(new Rt));#f=re(qe(new Rt));#h=null;initialize(r,o,s,c,h){if(this.initialized)throw new Error("TreeviewStore is already initialized.");if(this.initialized=!0,!o)throw new Error("TreeviewStore requires a valid TreeviewConfigStore to initialize.");if(this.#t=o,c)for(const d of c)l(this.#f).set(d.id,d);if(h&&(this.#h=h),!r)throw new Error("TreeviewStore requires a valid array of layers to initialize.");this.#r=s,this.#y(r),K(this.#n,this.#m(r),!0)}getNodeById(r){return this.#c(),l(this.#o).get(r)}getNodes(){return this.#c(),l(this.#n)}getVisibleNodes(){this.#c();const r=[];for(const[o,s]of l(this.#i)){if(!s)continue;const c=l(this.#o).get(o);c&&r.push(c)}return r}getNonHiddenNodes(){return this.#c(),this.#l(l(this.#n))}clearSelections(){this.#c();for(const r of l(this.#i).keys()){l(this.#i).set(r,!1);const o=l(this.#o).get(r);o&&o instanceof it&&(o.layer.visible=!1)}l(this.#u).clear()}#l(r){this.#c();const o=[];for(const s of r){const c=this.#v(s.id);if(!(c&&c.isHidden)&&(o.push(s),s.children?.length)){const h=this.#l(s.children);o.push(...h)}}return o}getVisibilityState(r){return this.#c(),l(this.#i).get(r)??!1}setVisibilityState(r,o){this.#c();const s=l(this.#o).get(r);if(!s)throw new Error(`Tree node not found for ID: ${r}`);if(!(s instanceof it))throw new Error(`Tree node is not a layer node: ${r}`);const c=this.#v(r);if(c?.disableVisibilityToggle||(l(this.#i).set(r,o),s.layer.visible=o,this.updateDrawState(s,o),s instanceof Or&&(s.featureLayer.displayField=o?s.field.name:"",o&&this.#h&&(console.log("[TreeviewStore] Applying custom renderer for field:",s.field.name),this.#h.applyCustomRenderer(s.featureLayer,s.field.name))),this.#d(s,o),!c||c.isHidden)||(c.visibilityDependencyIds?.length&&this.#p(s,o),!c.visibilityGroupId))return;const h=c.visibilityGroupId;let d=l(this.#u).get(h);d||(d=[],l(this.#u).set(h,d));const g=this.#g(h);if(!g)throw new Error(`Visibility group config not found for group ID: ${h}`);if(!o){const I=d.indexOf(r);d.splice(I,1);return}const T=I=>{l(this.#i).set(I,!1);const C=l(this.#o).get(I);if(C&&C instanceof it){C.layer.visible=!1,this.updateDrawState(C,!1),this.#d(C,!1);const E=this.#v(I);E&&E.visibilityDependencyIds?.length&&this.#p(C,!1)}const F=d.indexOf(I);F>=0&&d.splice(F,1)};for(;d.length>=g.maxVisibleLayers;){const I=d[0];T(I)}d.push(r),this.#d(s,o),c.visibilityDependencyIds?.length&&this.#p(s,o)}async updateDrawState(r,o){if(!this.#r)return;if(!o){l(this.#a).delete(r.id),l(this.#s).get(r.id)?.remove(),l(this.#s).delete(r.id);return}if(!(r instanceof it)||!(r.layer instanceof aa))return;const s=await this.#r.getLayerView(r.layer);if(!s)return;this.setInitialDrawState(r,s);const c=hs(()=>s.suspended,(h,d)=>{d&&!h?l(this.#a).set(r.id,er.Visible):!d&&h&&l(this.#a).set(r.id,er.Suspended)});l(this.#s).set(r.id,c)}getNodeDrawState(r){return this.#c(),l(this.#a).get(r)??er.Hidden}setInitialDrawState(r,o){!(r instanceof it)||!(r.layer instanceof aa)||o&&(o.suspended?l(this.#a).set(r.id,er.Suspended):l(this.#a).set(r.id,er.Visible))}clearDrawStateHandles(){for(const r of l(this.#s).values())r.remove();l(this.#s).clear()}cleanup(){this.initialized=!1,l(this.#i).clear(),l(this.#u).clear(),l(this.#f).clear(),K(this.#n,[],!0),l(this.#o).clear(),l(this.#a).clear(),this.clearDrawStateHandles()}#d(r,o){const s=r.parent;if(s){if(!(s instanceof it)){this.#d(s,o);return}l(this.#i).set(s.id,o),s.layer.visible=o,this.#d(s,o)}}#p(r,o){const s=this.#v(r.id);if(s&&s.visibilityDependencyIds?.length)for(const c of s.visibilityDependencyIds){const h=l(this.#o).get(c);h&&h instanceof it&&(l(this.#i).set(c,o),h.layer.visible=o,this.#d(h,o))}}#g(r){if(r&&this.#t)return this.#t.getVisibilityGroupConfig(r)}#y(r){this.#t&&this.#t.resolveInheritance(r)}#m(r){const o=r.map(s=>this.#w(s,void 0));return this.#b([...o])}#v(r){if(r&&this.#t)return this.#t.getItemConfig(r)}#b(r){r.reverse();for(const o of r)o.children?.length&&this.#b(o.children);return r}#w(r,o){const s=this.#v(r.id);if(s&&s.customConverterId){if(!l(this.#f).has(s.customConverterId))throw new Error(`Custom converter not found: ${s.customConverterId}`);const h=l(this.#f).get(s.customConverterId);if(!h)throw new Error(`Custom converter not found: ${s.customConverterId}`);return h.layerToNode(r,o??null)}const c=new it(r.id,r.title,r,[],o);if(r.visible=s?.disableVisibilityToggle?r.visible:s?.isHidden?!1:s?.isVisibleOnInit??!1,l(this.#i).set(r.id,r.visible),this.updateDrawState(c,r.visible),this.#A(r)&&s?.showFields){const h=r;h.loaded||console.warn(`Layer not loaded: ${r.id}`);for(const d of h.fields??[]){const g=this.#x(d,c);c.children.push(g)}}if(this.#I(r)){const h=r;return c.children=h.layers.toArray().map(d=>this.#w(d,c)),c}if(this.#C(r)){const h=r;if(h.sublayers&&h.sublayers.length>0){const d=h.sublayers;c.children=d.toArray().map(this.#_)}}return c}#x(r,o){const s=this.#k(o.id,r.name),c=new Or(s,r.alias||r.name,o.layer,r,[],o),h=this.#v(s);return l(this.#i).set(s,h?.isVisibleOnInit??!1),c}#C(r){return r.type==="map-image"||r.type==="wms"}#_(r){const o=new it(r.uid,r.title,r);return r.sublayers?.length&&(o.children=r.sublayers.toArray().map(this.#_)),o}#S(r,o){for(const s of r)o.set(s.id,s),s.children?.length&&this.#S(s.children,o)}#k(r,o){return`${r}-${o}`}#I(r){return r.type==="group"}#A(r){return r.type==="feature"}#c(){if(!this.initialized)throw new Error("TreeviewStore is not initialized. Call initialize() first.")}}const Gl='<path d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/>',Wl='<path d="M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/>',Yl='<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14,2 14,8 20,8"/>',Ta=(S,r,o,s)=>r?Jl(S,o):o?s?Gl:Wl:Yl,Jl=(S,r)=>{switch(S.type){case"group":return ta;case"feature":return ra;case"tile":return Vo;default:return r?ta:ra}};function Ql(S){const r=S-1;return r*r*r+1}var Xl=oe('<div class="relative ml-4 w-full"><div class="tree-guide-line svelte-1y72o5r"></div> <div class="tree-children svelte-1y72o5r"></div></div>'),Zl=oe('<div class="w-full"><!> <!></div>');function Ea(S,r){const o=Fe(r,"isOpen",3,!1),s=Fe(r,"childNodes",3,null),c=Fe(r,"duration",3,300);var h=Zl(),d=Q(h);$e(d,()=>r.content??Qe);var g=de(d,2);{var T=I=>{var C=Xl(),F=de(Q(C),2);zt(F,21,()=>s()??[],E=>E.id,(E,Y)=>{var M=se(),N=$(M);$e(N,()=>r.childNode??Qe,()=>l(Y)),D(E,M)}),U(F),U(C),In(1,F,()=>ha,()=>({duration:c(),easing:Ql})),In(2,F,()=>ha,()=>({duration:c()})),D(I,C)};ye(g,I=>{o()&&s()&&I(T)})}U(h),D(S,h)}const pi="mb-1 cursor-pointer rounded-md border border-border p-2 text-left",gi="transform-gpu transition-all duration-150 ease-out hover:border-border/50 hover:bg-gray-100 hover:shadow-sm",eu="transition-colors hover:bg-blue-500",yi="text-sm font-normal",mi="bg-card",Da="bg-accent text-accent-foreground",tu="!h-auto !min-h-9 !whitespace-normal data-[state=on]:!bg-accent data-[state=on]:!text-accent-foreground data-[state=on]:hover:!bg-accent data-[state=on]:hover:!text-accent-foreground";function ru(S={}){const{enhancedHover:r=!1,includeFont:o=!1,pressed:s=!1}=S;let c=pi;return r?c+=" "+gi:c+=" "+eu,o&&(c+=" "+yi),s?c+=" "+Da:c+=" "+mi,c}var nu=oe('<div class="flex w-full !items-center !justify-between gap-2"><div class="pointer-events-none !flex min-w-0 flex-1 !items-center gap-1"><span class="inline-block size-4" aria-hidden="true"><!></span> <span class="block w-full text-left break-words"> </span></div> <!></div>'),iu=oe('<button><div class="flex w-full items-center justify-between gap-2"><div class="pointer-events-none flex min-w-0 flex-1 items-center gap-1"><!> <span class="inline-block size-4" aria-hidden="true"><!></span> <span class="block w-full text-left break-words"> </span></div> <!></div></button>');function ya(S,r){const o=`calc(100% - ${r.depth*1}rem)`,s=`${pi} ${gi} ${tu} ${mi} ${yi}`,c=`${pi} ${gi} ${yi}`;var h=se(),d=$(h);{var g=I=>{Ko(I,{get pressed(){return r.pressed},get class(){return s},variant:"outline",get style(){return`width: ${o};`},get onPressedChange(){return r.onclick},children:(C,F)=>{var E=nu(),Y=Q(E),M=Q(Y),N=Q(M);qr(N,()=>r.icon),U(M);var z=de(M,2),H=Q(z,!0);U(z),U(Y);var V=de(Y,2);$e(V,()=>r.children??Qe),U(E),dt(()=>Tt(H,r.name)),D(C,E)},$$slots:{default:!0}})},T=I=>{var C=iu();C.__click=function(...j){r.onclick?.apply(this,j)};var F=Q(C),E=Q(F),Y=Q(E);Ca(Y,{get isOpen(){return r.isOpen}});var M=de(Y,2),N=Q(M);qr(N,()=>r.icon),U(M);var z=de(M,2),H=Q(z,!0);U(z),U(E);var V=de(E,2);$e(V,()=>r.children??Qe),U(F),U(C),dt(()=>{tr(C,1,`${c} ${r.pressed?Da:mi}`),Ir(C,`width: ${o};`),Tt(H,r.name)}),D(I,C)};ye(d,I=>{r.isTogglable?I(g):I(T,!1)})}D(S,h)}En(["click"]);function Fa(S,r){Re(r,!0);const o=N=>{var z=se(),H=$(z);{var V=j=>{var W=se(),ce=$(W);{var X=_e=>{ya(_e,{isTogglable:!1,get pressed(){return l(I)},get icon(){return l(C)},get name(){return r.node.name},get depth(){return c()},onclick:M,get isOpen(){return l(T)}})},he=_e=>{ya(_e,{isTogglable:!0,get pressed(){return l(I)},get icon(){return l(C)},get name(){return r.node.name},get depth(){return c()},onclick:Y,get isOpen(){return l(T)}})};ye(ce,_e=>{d?_e(X):_e(he,!1)})}D(j,W)};ye(H,j=>{r.treeviewConfigStore.getItemConfig(r.node.id)?.isHidden||j(V)})}D(N,z)},s=(N,z=Qe)=>{var H=se(),V=$(H);{var j=W=>{{let ce=pe(()=>c()+1);Fa(W,{get treeviewConfigStore(){return r.treeviewConfigStore},get node(){return z()},get onNodeClick(){return r.onNodeClick},get onNodeVisibilityChange(){return r.onNodeVisibilityChange},get getNodeVisibility(){return r.getNodeVisibility},get depth(){return l(ce)},get useLayerTypeIcon(){return h()}})}};ye(V,W=>{d&&l(T)&&!r.treeviewConfigStore.getItemConfig(z().id)?.isHidden&&W(j)})}D(N,H)},c=Fe(r,"depth",3,0),h=Fe(r,"useLayerTypeIcon",3,!1),d=!!(r.node.children&&r.node.children.length),g=!d;let T=re(!1),I=re(!1),C=re("");function F(){return!r.node.children||!r.getNodeVisibility?!1:r.node.children.some(N=>{const z=r.getNodeVisibility(N.id);return z!==void 0?z:N instanceof it?N.layer.visible:!1})}Ze(()=>{if(!(!r.node||!(r.node instanceof it))){if(d)K(I,F(),!0);else{const N=r.getNodeVisibility?r.getNodeVisibility(r.node.id):void 0;K(I,N!==void 0?N:r.node.layer.visible,!0)}K(C,Ta(r.node.layer,h(),d,l(T)),!0)}});function E(){!g||!r.onNodeVisibilityChange||d||(K(I,!l(I)),r.onNodeVisibilityChange(r.node,l(I)))}function Y(){d||E(),r.onNodeClick?.(r.node)}function M(){K(T,!l(T)),r.onNodeClick?.(r.node)}{let N=pe(()=>d?r.node.children:null);Ea(S,{get isOpen(){return l(T)},get content(){return o},get childNodes(){return l(N)},get childNode(){return s}})}He()}function au(S,r){Re(r,!0);const o=Fe(r,"webMap",3,null),s=Fe(r,"areaSelectionStore",7),c=new Pa;function h(){c.clearSelections()}Ze(()=>{!o()||c.initialized||c.initialize(o().layers.toArray(),r.treeviewConfigStore,null)}),Ze(()=>{if(!c.initialized)return;const C=c.getNonHiddenNodes().map(F=>F.id);s().areaSelectionLayerIds=new Set(C)}),Ze(()=>{if(!c.initialized)return;if(!c.getVisibleNodes().length){s().visibleLayer=null,s().resetSelectedAreas();return}const C=c.getVisibleNodes().find(F=>F instanceof it&&F.layer instanceof di);if(!C||!(C instanceof it)){console.warn("Visible node is not a FeatureLayer");return}if(!C.layer||!(C.layer instanceof di)){console.warn("Visible node layer is not a FeatureLayer",C.layer.type);return}s().visibleLayer=C.layer});var d={clearSelections:h},g=se(),T=$(g);{var I=C=>{var F=se(),E=$(F);Le(E,()=>ka,(Y,M)=>{M(Y,{children:(N,z)=>{var H=se(),V=$(H);zt(V,17,()=>c.getNodes(),j=>j.id,(j,W)=>{Fa(j,{get treeviewConfigStore(){return r.treeviewConfigStore},get node(){return l(W)},onNodeClick:()=>{},onNodeVisibilityChange:(ce,X)=>c.setVisibilityState(ce.id,X),getNodeVisibility:ce=>c.getVisibilityState(ce),depth:0,useLayerTypeIcon:!0})}),D(N,H)},$$slots:{default:!0}})}),D(C,F)};ye(T,C=>{c.initialized&&C(I)})}return D(S,g),He(d)}class ou{configStore;constructor(r){this.configStore=r}}function su(S){return S.replace(/&deg;/gi,"").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&lt;/gi,"<").replace(/&gt;/gi,">")}class lu extends ou{id="aliasPath";layerToNode(r,o){const s=new it(r.id,r.title,r,[],o),c=this.configStore.getItemConfig(r.id);if(this.#r(r)&&c?.showFields){const h=r;h.loaded||console.warn(`Layer not loaded: ${r.id}`);const d=new Map;for(const g of h.fields??[]){const T=this.configStore.getItemConfig(this.#t(r.id,g.name));!T||T.isHidden||this.#e(g,s,d)}s.children.sort((g,T)=>g.children.length>0&&T.children.length===0?1:g.children.length===0&&T.children.length>0?-1:0)}return s}#e(r,o,s=new Map){const c=this.#t(o.id,r.name),d=su(r.alias||"")?.split("|").map(E=>E.trim()).filter(Boolean)??[];if(d.length===0){const E=new Or(c,r.alias||r.name,o.layer,r,[],o);return o.children.push(E),E}const g=d.slice(0,-1),T=d[d.length-1];let I=o;const C=(E,Y)=>{E.children??=[],E.children.includes(Y)||E.children.push(Y)};for(let E=0;E<g.length;E++){const Y=g[E],M=d.slice(0,E+1).join("::"),N=`${o.id}::${M}`;let z=s.get(N);z||(z=new Oa(N,Y,[],I),s.set(N,z),C(I,z)),I=z}const F=new Or(c,T||r.name,o.layer,r,[],I);return C(I,F),F}#t(r,o){return`${r}-${o}`}#r(r){return r.type==="feature"}}class ma{#e=[];#t=new Map;#r=[];#n=new Map;#o=[];#i=new Map;#a=new Set;constructor(r){if(!r)throw new Error("TreeviewConfigStore requires a valid configuration object.");this.#e=r.items??[],this.#t=new Map(this.#e.map(o=>[o.id,o])),this.#r=r.visibilityGroups??[],this.#n=new Map(this.#r.map(o=>[o.id,o])),this.#o=r.inheritanceGroups??[],this.#i=new Map(this.#o.map(o=>[o.id,o])),r.fieldsToHide&&(this.#a=new Set(r.fieldsToHide.map(o=>o.trim().toLowerCase())))}getItemConfig(r){return this.#t.get(r)}getVisibilityGroupConfig(r){return this.#n.get(r)}getInheritanceGroupConfig(r){return this.#i.get(r)}resolveInheritance(r){if(!(r.length===0||!this.#e||this.#e.length===0))for(const o of r){const s=this.getItemConfig(o.id);this.#s(o,s)}}#s(r,o){const s=this.#u(r,o);if(this.#m(r)&&s.showFields){const c=r;c.loaded||console.warn(`Layer not loaded: ${r.id}`);for(const h of c.fields??[])this.#f(this.#g(r.id,h.name),h.alias||h.name,s)}if(this.#y(r)){const c=r;for(const h of c.layers.toArray())this.#s(h,s)}}#u(r,o){const s=this.#h(r.id,o);return s.type===yn.None&&(s.type=Bo(r)),s}#f(r,o,s){const c=this.#h(r,s);return c.type===yn.None&&(c.type=yn.Field),this.#a.has(o.trim().toLowerCase())&&(c.isHidden=!0),c}#h(r,o){let s=this.getItemConfig(r);const c=s?.inheritanceGroupId?this.getInheritanceGroupConfig(s.inheritanceGroupId):this.getInheritanceGroupConfig(o?.inheritanceGroupId??"");return s={id:r,type:yn.None,isDownloadable:this.#l(c,"isDownloadable",s,o,!0),isVisibleOnInit:this.#l(c,"isVisibleOnInit",s,o,!1),isHidden:this.#l(c,"isHidden",s,o,!1),disableVisibilityToggle:this.#l(c,"disableVisibilityToggle",s,o,!1),isOpenOnInit:this.#l(c,"isOpenOnInit",s,o,!1),showFields:this.#l(c,"showFields",s,o,!1),visibilityDependencyIds:this.#l(c,"visibilityDependencyIds",s,o,[]),visibilityGroupId:this.#l(c,"visibilityGroupId",s,o,void 0),customConverterId:this.#l(c,"customConverterId",s,o,void 0),inheritanceGroupId:this.#l(c,"inheritanceGroupId",s,o,void 0)},this.#p(s),this.#d(s),s}#l(r,o,s,c,h){const d=s?.[o];return d!==void 0?d:r?.inheritedProperties.includes(o)&&c?c[o]??h:h}#d(r){if(this.#t.has(r.id))throw new Error(`Item with id ${r.id} already exists.`);this.#e.push(r),this.#t.set(r.id,r)}#p(r){this.#t.has(r.id)&&(this.#e=this.#e.filter(o=>o.id!==r.id),this.#t.delete(r.id))}#g(r,o){return`${r}-${o}`}#y(r){return r.type==="group"}#m(r){return r.type==="feature"}}var uu=oe('<div data-slot="checkbox-indicator" class="text-current transition-none"><!></div>');function cu(S,r){Re(r,!0);let o=Fe(r,"ref",15,null),s=Fe(r,"checked",11,!1),c=Fe(r,"indeterminate",11,!1),h=Lt(r,["$$slots","$$events","$$legacy","ref","checked","indeterminate","class"]),d=re(qe(s())),g=re(qe(c()));Ze(()=>{K(d,s())}),Ze(()=>{K(g,c())});var T=se(),I=$(T);{const C=(E,Y)=>{let M=()=>Y?.().checked,N=()=>Y?.().indeterminate;var z=uu(),H=Q(z);{var V=W=>{Ps(W,{class:"size-3.5"})},j=W=>{var ce=se(),X=$(ce);{var he=_e=>{$o(_e,{class:"size-3.5"})};ye(X,_e=>{N()&&_e(he)},!0)}D(W,ce)};ye(H,W=>{M()?W(V):W(j,!1)})}U(z),D(E,z)};let F=pe(()=>as("peer flex size-4 shrink-0 items-center justify-center rounded-[4px] border border-input shadow-xs transition-shadow outline-none focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50 disabled:cursor-not-allowed disabled:opacity-50 aria-invalid:border-destructive aria-invalid:ring-destructive/20 data-[state=checked]:border-primary data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:bg-input/30 dark:aria-invalid:ring-destructive/40 dark:data-[state=checked]:bg-primary",r.class));Le(I,()=>qo,(E,Y)=>{Y(E,kt({"data-slot":"checkbox",get class(){return l(F)}},()=>h,{get ref(){return o()},set ref(M){o(M)},get checked(){return l(d)},set checked(M){K(d,M,!0)},get indeterminate(){return l(g)},set indeterminate(M){K(g,M,!0)},children:C,$$slots:{default:!0}}))})}D(S,T),He()}var du=oe("<div><!></div>");function ba(S,r){Re(r,!0);let o=pe(()=>r.getDownloadState?.(r.node)??rt.Inactive),s=pe(()=>l(o)===rt.Active),c=pe(()=>l(o)===rt.Indeterminate);function h(T){T.stopPropagation();const I=l(o)===rt.Active?rt.Inactive:rt.Active;r.onDownloadStateChanged?.(r.node,I)}var d=du(),g=Q(d);cu(g,{get checked(){return l(s)},get indeterminate(){return l(c)},onclick:h,title:"Download"}),U(d),D(S,d),He()}var fu=oe('<button><div class="flex w-full items-center justify-between gap-2"><div class="pointer-events-none flex min-w-0 flex-1 items-center gap-1"><!> <span class="inline-block size-4" aria-hidden="true"><!></span> <span class="block w-full text-left break-words"> </span></div> <!></div></button>');function wa(S,r){Re(r,!0);const o=Fe(r,"isFolder",3,!1),s=Fe(r,"isOpen",3,!1),c=`calc(100% - ${r.depth*1}rem)`;var h=fu();h.__click=function(...N){r.onclick?.apply(this,N)};var d=Q(h),g=Q(d),T=Q(g);{var I=N=>{Ca(N,{get isOpen(){return s()}})};ye(T,N=>{o()&&N(I)})}var C=de(T,2),F=Q(C);qr(F,()=>r.icon),U(C);var E=de(C,2),Y=Q(E,!0);U(E),U(g);var M=de(g,2);$e(M,()=>r.children??Qe),U(d),U(h),dt(N=>{tr(h,1,N),Ir(h,`width: ${c};`),Tt(Y,r.name)},[()=>wo(ru({enhancedHover:!0,includeFont:!0}))]),D(S,h),He()}En(["click"]);var hu=oe('<div class="flex items-center gap-2"><!> <!></div>'),vu=oe('<div class="flex items-center gap-2"><!> <!></div>');function La(S,r){Re(r,!0);const o=V=>{var j=se(),W=$(j);{var ce=X=>{var he=se(),_e=$(he);{var Oe=Se=>{wa(Se,{get icon(){return l(E)},get name(){return r.node.name},get depth(){return h()},onclick:H,get isFolder(){return g},get isOpen(){return l(C)},children:xe=>{var le=hu(),Ce=Q(le);{var je=ve=>{ba(ve,{get node(){return r.node},get onDownloadStateChanged(){return r.onDownloadStateChanged},get getDownloadState(){return r.getDownloadState}})};ye(Ce,ve=>{r.isDownloadable&&ve(je)})}var ie=de(Ce,2);{var ge=ve=>{{let me=pe(()=>r.getNodeDrawState?.(r.node.id)===er.Suspended);na(ve,{get checked(){return l(F)},get indeterminate(){return l(me)},onCheckedChange:N})}};ye(ie,ve=>{T&&ve(ge)})}U(le),D(xe,le)},$$slots:{default:!0}})},ue=Se=>{wa(Se,{get icon(){return l(E)},get name(){return r.node.name},get depth(){return h()},onclick:z,get isFolder(){return g},children:xe=>{var le=vu(),Ce=Q(le);{var je=ve=>{ba(ve,{get node(){return r.node},get onDownloadStateChanged(){return r.onDownloadStateChanged},get getDownloadState(){return r.getDownloadState}})};ye(Ce,ve=>{r.isDownloadable&&ve(je)})}var ie=de(Ce,2);{var ge=ve=>{{let me=pe(()=>r.getNodeDrawState?.(r.node.id)===er.Suspended);na(ve,{get checked(){return l(F)},get indeterminate(){return l(me)},onCheckedChange:N})}};ye(ie,ve=>{T&&ve(ge)})}U(le),D(xe,le)},$$slots:{default:!0}})};ye(_e,Se=>{g?Se(Oe):Se(ue,!1)})}D(X,he)};ye(W,X=>{c()?.getItemConfig(r.node.id)?.isHidden||X(ce)})}D(V,j)},s=(V,j=Qe)=>{var W=se(),ce=$(W);{var X=he=>{{let _e=pe(()=>c()?.getItemConfig(j().id)?.isDownloadable??!0),Oe=pe(()=>h()+1);La(he,{get treeviewConfigStore(){return c()},get node(){return j()},get isDownloadable(){return l(_e)},get onNodeClick(){return r.onNodeClick},get onNodeVisibilityChange(){return r.onNodeVisibilityChange},get onDownloadStateChanged(){return r.onDownloadStateChanged},get getDownloadState(){return r.getDownloadState},get onFilterClicked(){return r.onFilterClicked},get hasFiltersApplied(){return r.hasFiltersApplied},get getNodeVisibility(){return r.getNodeVisibility},get getNodeDrawState(){return r.getNodeDrawState},get depth(){return l(Oe)},get useLayerTypeIcon(){return d()}})}};ye(ce,he=>{g&&l(C)&&!c()?.getItemConfig(j().id)?.isHidden&&he(X)})}D(V,W)},c=Fe(r,"treeviewConfigStore",3,null),h=Fe(r,"depth",3,0),d=Fe(r,"useLayerTypeIcon",3,!1),g=!!(r.node.children&&r.node.children.length),T=!g;let I=!1,C=re(!1),F=re(!1),E=re(""),Y=re(!1),M=re(!1);Ze(()=>{I||(K(C,c()?.getItemConfig(r.node.id)?.isOpenOnInit??!1,!0),I=!0)}),Ze(()=>{if(!r.node)return;const V=r.getNodeVisibility?r.getNodeVisibility(r.node.id):!1;K(F,V??!1,!0),r.node instanceof it&&K(E,Ta(r.node.layer,d(),g,l(C)),!0)}),Ze(()=>{if(!(r.node instanceof it))return;const V=(r.getDownloadState?.(r.node)===rt.Active&&r.node.layer.type==="feature")??!1;V&&!l(Y)?(K(Y,!0),K(M,!1)):!V&&l(Y)&&(K(M,!0),setTimeout(()=>{K(Y,!1),K(M,!1)},180))});function N(){!T||!r.onNodeVisibilityChange||(K(F,!l(F)),r.onNodeVisibilityChange(r.node,l(F)))}function z(){r.onNodeClick?.(r.node)}function H(){K(C,!l(C)),r.onNodeClick?.(r.node)}{let V=pe(()=>g?r.node.children:null);Ea(S,{get isOpen(){return l(C)},get content(){return o},get childNodes(){return l(V)},get childNode(){return s}})}He()}class pu{#e;#t;constructor(r,o){this.#e=r,this.#t=o}updateSelection(r,o){if(!this.#t.getItemConfig(r.id)?.isHidden){if(!(r instanceof it)){this.updateChildrenSelection(r,o);return}if(r instanceof Or){this.updateFieldSelection(r,o);return}this.updateLayerSelection(r,o)}}getSelectionState(r){if(!(r instanceof it))return this.determineSelectionStateFromChildren(r);if(this.isGroupLayer(r))return this.determineSelectionStateFromChildren(r);let o;return r instanceof Or?(o=this.#e.getSelection(r.featureLayer.id),o&&o.fields.has(r.field.name)?rt.Active:rt.Inactive):(o=this.#e.getSelection(r.id),o?this.isFeatureLayer(r)&&r.children&&r.children.length>0?this.determineSelectionStateFromChildren(r):rt.Active:rt.Inactive)}updateLayerSelection(r,o){let s=this.#e.getSelection(r.id);switch(o){case rt.Active:!s&&!this.isGroupLayer(r)&&(s=this.createAndAddDataSelection(r.id,r.layer));for(const c of r.children||[])this.updateSelection(c,o);break;case rt.Inactive:s&&!this.isGroupLayer(r)&&this.#e.removeSelection(r.id),this.updateChildrenSelection(r,o);break}}updateFieldSelection(r,o){let s=this.#e.getSelection(r.featureLayer.id);switch(o){case rt.Active:s||(s=this.createAndAddDataSelection(r.featureLayer.id,r.featureLayer)),s.fields.add(r.field.name);break;case rt.Inactive:if(!s)break;s.fields.delete(r.field.name),s.fields.size===0&&this.#e.removeSelection(s.layerId);break}}updateChildrenSelection(r,o){for(const s of r.children||[])this.updateSelection(s,o)}determineSelectionStateFromChildren(r){let o=0,s=0;for(const c of r.children||[]){if(this.#t.getItemConfig(c.id)?.isHidden)continue;s++;const d=this.getSelectionState(c);if(d===rt.Active||this.isFeatureLayer(c)&&d!==rt.Inactive)o++;else if(d===rt.Indeterminate)return rt.Indeterminate}return o===0?rt.Inactive:o===s?rt.Active:rt.Indeterminate}createAndAddDataSelection(r,o){const s={layerId:r,layer:o,fields:new dr};return this.#e.addSelection(s),s}isGroupLayer(r){return r instanceof it&&r.layer.type==="group"}isFeatureLayer(r){return r instanceof it&&r.layer.type==="feature"}}function gu(S,r){Re(r,!0);const o=Fe(r,"fieldFilterMenuStore",7);function s(){c.clearSelections()}const c=new Pa,h=new pu(Ct,r.treeviewConfigStore);Ze(()=>{if(!r.webMap||c.initialized)return;(async()=>{await r.webMap.when(),await d(r.webMap.layers.toArray());const V=new lu(r.treeviewConfigStore);c.initialize(r.webMap.layers.toArray(),r.treeviewConfigStore,r.layerViewProvider,[V],r.customRendererService)})()});async function d(H){for(const V of H)V.type==="feature"&&!V.loaded&&await V.load(),V.type==="group"&&await d(V.layers.toArray())}function g(H,V){console.log(`[tree-view] onNodeVisibilityChange: Setting visibility of node ${H.id} to ${V}`),c.setVisibilityState(H.id,V)}function T(H){return c.getNodeDrawState(H)}function I(H,V){h.updateSelection(H,V)}function C(H){return h.getSelectionState(H)}function F(H){if(o().ActiveLayer?.uid===H){o().ActiveLayer=null;return}const j=c.getNodeById(H);!j||!(j instanceof it)||(o().ActiveLayer=j.layer)}function E(H){const V=Ct.getSelection(H);if(!V?.fields)return!1;const j=c.getNodeById(H);if(!j||!(j instanceof it))return!1;const W=j.layer.fields?.length||0,ce=V.fields.size;return ce>0&&ce!==W}var Y={clearSelections:s},M=se(),N=$(M);{var z=H=>{var V=se(),j=$(V);Le(j,()=>ka,(W,ce)=>{ce(W,{children:(X,he)=>{var _e=se(),Oe=$(_e);zt(Oe,17,()=>c.getNodes(),ue=>ue.id,(ue,Se)=>{{let ke=pe(()=>r.treeviewConfigStore.getItemConfig(l(Se).id)?.isDownloadable??!0);La(ue,{get treeviewConfigStore(){return r.treeviewConfigStore},get node(){return l(Se)},get isDownloadable(){return l(ke)},onNodeClick:()=>{},onNodeVisibilityChange:g,getNodeVisibility:xe=>c.getVisibilityState(xe),onDownloadStateChanged:I,getDownloadState:C,onFilterClicked:F,hasFiltersApplied:E,getNodeDrawState:T,depth:0,useLayerTypeIcon:!0})}}),D(X,_e)},$$slots:{default:!0}})}),D(H,V)};ye(N,H=>{c.initialized&&H(z)})}return D(S,M),He(Y)}class yu{#e;constructor(r){this.#e=r}async getLayerView(r){return this.#e.whenLayerView(r)}}class mu{#e=re(null);get mapView(){return l(this.#e)}set mapView(r){K(this.#e,r,!0)}#t=re(qe(new Set));get interactableLayers(){return l(this.#t)}set interactableLayers(r){K(this.#t,r,!0)}pointerMoveHandle=null;clickHandle=null;leaveHandle=null;enterHandle=null;#r=re(!1);get isInitialized(){return l(this.#r)}set isInitialized(r){K(this.#r,r,!0)}#n=re(!0);get pointerInsideMap(){return l(this.#n)}set pointerInsideMap(r){K(this.#n,r,!0)}initializationInProgress=!1;async initializeAsync(r,o){if(console.log("[map-interaction-store] Initializing with MapView"),this.mapView===r&&this.isInitialized){console.log("[map-interaction-store] MapView is already initialized"),this.interactableLayers=o;return}if(this.initializationInProgress){console.log("[map-interaction-store] Initialization already in progress");return}this.initializationInProgress=!0,console.log("[map-interaction-store] Cleaning up previous MapView if any"),this.cleanup(),this.mapView=r,this.interactableLayers=o,await r.when(),this.setupHighlights(r),this.setupPointerMoveHandler(r),this.setupClickHandler(r),this.setupLeaveHandler(r),this.setupEnterHandler(r),this.isInitialized=!0,console.log("[map-interaction-store] Initialized with MapView"),this.initializationInProgress=!1}updateInteractableLayers(r){this.interactableLayers=r}setupHighlights(r){const o={name:"hover",color:"lightgreen",haloOpacity:1,fillOpacity:.2},s={name:"selected",color:"green",haloOpacity:1,fillOpacity:.3};r.highlights.push(o),r.highlights.push(s)}setupPointerMoveHandler(r){this.pointerMoveHandle=r.on("pointer-move",async o=>{if(!this.pointerInsideMap)return;const{results:s}=await r.hitTest(o),c=s[0];if(!c){this.clearHoverHighlight();return}const h=c.graphic,d=h.layer;if(!h||!d||!this.isLayerInteractable(d.id)||h.attributes?.[d.objectIdField]===void 0){this.clearHoverHighlight();return}const g=h.attributes?.[d.objectIdField];if(!(Pe.currentHoveredArea&&Pe.currentHoveredArea.id===g))try{const T=await r.whenLayerView(d);Pe.layerHighlightState.featureLayerView!==T&&Pe.setSelectedLayerView(T),this.clearHoverHighlight();const I=T;if(!I){console.warn("LayerView is not a FeatureLayerView");return}if(!this.pointerInsideMap)return;const C=I.highlight(h,{name:"hover"});Pe.setHoveredArea(g,C)}catch(T){console.error("Error in pointer-move handler:",T),this.clearHoverHighlight()}})}setupClickHandler(r){this.clickHandle=r.on("click",async o=>{const{results:s}=await r.hitTest(o),c=s[0];if(!c)return;const h=c.graphic,d=h.layer;if(!h||!d||!this.isLayerInteractable(d.id)||h.attributes?.[d.objectIdField]===void 0)return;const g=h.attributes?.[d.objectIdField];try{const T=await r.whenLayerView(d),I=T;if(!I){console.warn("Layer is not a FeatureLayerView");return}Pe.layerHighlightState.featureLayerView!==T&&Pe.setSelectedLayerView(T);const F=(Pe.layerHighlightState.areaInfos||[]).find(E=>E.id===g);if(F)Pe.removeSelectedArea(F.id);else{const E=I.highlight(h,{name:"selected"});Pe.addSelectedArea(g,E)}}catch(T){console.error("Error in click handler:",T)}})}setupLeaveHandler(r){this.leaveHandle=r.on("pointer-leave",()=>{this.pointerInsideMap=!1,this.clearHoverHighlight()})}setupEnterHandler(r){this.enterHandle=r.on("pointer-enter",()=>{this.pointerInsideMap=!0})}isLayerInteractable(r){return this.interactableLayers.has(r)}clearHoverHighlight(){Pe.currentHoveredArea&&Pe.clearHoveredArea()}cleanup(){this.pointerMoveHandle&&(this.pointerMoveHandle.remove(),this.pointerMoveHandle=null),this.clickHandle&&(this.clickHandle.remove(),this.clickHandle=null),this.leaveHandle&&(this.leaveHandle.remove(),this.leaveHandle=null),this.enterHandle&&(this.enterHandle.remove(),this.enterHandle=null),this.clearHoverHighlight(),this.isInitialized=!1,this.mapView=null,this.pointerInsideMap=!0,this.interactableLayers=new Set,console.log("[map-interaction-store] cleaned up")}get currentMapView(){return this.mapView}get initialized(){return this.isInitialized}}const kn=new mu;var bu=oe('<div class="esri-ui-element svelte-i0p9uk"><!></div>'),wu=oe('<div class="esri-ui-element svelte-i0p9uk"><!></div>'),_u=oe('<div class="map-view svelte-i0p9uk"></div> <!> <!>',1);function Su(S,r){Re(r,!0);const o=Fe(r,"webMap",3,null),s=Fe(r,"panelPosition",3,"top-left"),c=Fe(r,"menuPosition",3,"top-right");let h=null,d=re(null),g=re(null),T=re(null),I=re(!1);const C="streets-vector";let F,E;function Y(){if(!l(d))throw new Error("MapView is not initialized");return new yu(l(d))}kr(async()=>{await M(),await j()});async function M(){if(!E){const[{default:le},{default:Ce},{default:je},{default:ie}]=await Promise.all([bn(()=>import("../chunks/C8QWR4pF.js").then(ge=>ge.M),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37]),import.meta.url),bn(()=>import("../chunks/DxxzICxw.js").then(ge=>ge.a3),__vite__mapDeps([38,1,2,3,5,39,22,40,20,6,7,41,30,42,18,19,43,8,9,10,11,23,44,45,16,31,46,47,48,24,49,50,14,51,0,4,12,13,15,17,21,25,26,27,28,29,32,33,34,35,36,37,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91]),import.meta.url),bn(()=>import("../chunks/CJ_yvpu1.js").then(ge=>ge.W),__vite__mapDeps([92,1,2,3,5,6,7,0,4,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,39,40,41,42,43,93,94,95,96,65,97,98,78,79,69,53,54,55,56,57,58,59,60,61,62,63,99,100,101,68,64,102,103,104,105,67,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,44,45,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176]),import.meta.url),bn(()=>import("../chunks/Cep3ALYs.js"),__vite__mapDeps([99,5,1,2,3,54,22,8,9,10,11,7,6,55,21,18,19,20,37,93,100,101,68,69,64,102,103,104,36,13,65,105,14,24,67,41,30,42,17,106,107,108,109,59,110,53,56,57,58,12,60,61,62,63,111,112,113,114,115,116,117,118,119,120,121,122,123,124,94,31,44,45,16,125,126,127,128,129,130,131,132,32,33,34,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,43,149,150,151,152,153,154,155,156,157,158,159,26,160,161,162,15,163,164,165,96,166,167,168,169,170,171,172,173,95]),import.meta.url)]);F=le,E=Ce}}async function N(le,Ce){const je=new E({container:Ce,popupEnabled:!1,map:le});return await je.when(),je}function z(le){le.ui.move("zoom","top-right"),l(g)&&s()&&le.ui.add(l(g),s()),l(T)&&c()&&le.ui.add(l(T),c()),K(I,!0)}async function H(){return new F({basemap:C})}async function V(){if(o())try{if(await M(),await j(),!l(d)){console.error("MapView is not initialized");return}l(d).map=o(),console.log("[uprn-map-view] MapView updated with new webMap")}catch(le){console.error("Error updating MapView with new webMap:",le)}}async function j(){if(!h){console.error("Map container element was not found");return}try{K(d,await N(o()??void 0,h),!0),z(l(d)),console.log("[uprn-map-view] Map loaded successfully")}catch(le){console.error("Error loading map:",le),await W()}}async function W(){try{const le=await H();K(d,await N(le,h),!0),z(l(d)),console.log("[uprn-map-view] Fallback map loaded")}catch(le){console.error("Error loading fallback map:",le)}}Ze(()=>{o()&&V()}),Ze(()=>{l(d)&&(kn.initialized?kn.updateInteractableLayers(Pe.areaSelectionLayerIds):kn.initializeAsync(l(d),Pe.areaSelectionLayerIds))}),Ze(()=>{!l(d)||!Pe.visibleLayer||ce(Pe.visibleLayer)});async function ce(le){if(!l(d))return;const Ce=await l(d).whenLayerView(le);if(!Ce){console.warn("Could not get LayerView for the visible node layer");return}Pe.setSelectedLayerView(Ce)}function X(){l(d)&&l(d).destroy()}_a(()=>{X()});var he={getLayerViewProvider:Y},_e=_u(),Oe=$(_e);Pt(Oe,le=>h=le,()=>h);var ue=de(Oe,2);{var Se=le=>{var Ce=bu(),je=Q(Ce);{var ie=ge=>{var ve=se(),me=$(ve);$e(me,()=>r.panel),D(ge,ve)};ye(je,ge=>{l(I)&&ge(ie)})}U(Ce),Pt(Ce,ge=>K(g,ge),()=>l(g)),D(le,Ce)};ye(ue,le=>{r.panel&&le(Se)})}var ke=de(ue,2);{var xe=le=>{var Ce=wu(),je=Q(Ce);{var ie=ge=>{var ve=se(),me=$(ve);$e(me,()=>r.menu),D(ge,ve)};ye(je,ge=>{l(I)&&ge(ie)})}U(Ce),Pt(Ce,ge=>K(T,ge),()=>l(T)),D(le,Ce)};ye(ke,le=>{r.menu&&le(xe)})}return D(S,_e),He(he)}var xu=oe('<div class="min-w-0 space-y-2 overflow-hidden p-4"><!></div>'),Cu=oe('<div class="flex min-h-0 flex-1 flex-col"><!></div>');function xn(S,r){var o=Cu(),s=Q(o);Le(s,()=>Pn,(c,h)=>{h(c,{class:"card-content flex min-h-0 flex-1 flex-col overflow-hidden p-0",children:(d,g)=>{var T=xu(),I=Q(T);$e(I,()=>r.children??Qe),U(T),D(d,T)},$$slots:{default:!0}})}),U(o),D(S,o)}var ku=oe("<!> <!>",1),Iu=oe('<div class="tab-list-wrapper flex-shrink-0 svelte-rohqkk"><!></div> <!>',1);function Au(S,r){Re(r,!0);const o=Fe(r,"triggers",19,()=>[]);var s=se(),c=$(s);Le(c,()=>Uo,(h,d)=>{d(h,{get value(){return r.value},get onValueChange(){return r.onValueChange},class:"flex h-full w-full flex-col",children:(g,T)=>{var I=Iu(),C=$(I),F=Q(C);Le(F,()=>Go,(Y,M)=>{M(Y,{class:"tab-list",children:(N,z)=>{var H=se(),V=$(H);zt(V,17,o,Ar,(j,W,ce,X)=>{let he=()=>l(W).value,_e=()=>l(W).label;var Oe=ku(),ue=$(Oe);Le(ue,()=>Wo,(xe,le)=>{le(xe,{get value(){return he()},class:"tab-trigger",children:(Ce,je)=>{fr();var ie=Cr();dt(()=>Tt(ie,_e())),D(Ce,ie)},$$slots:{default:!0}})});var Se=de(ue,2);{var ke=xe=>{Po(xe,{class:"separator"})};ye(Se,xe=>{he()!==o()[o().length-1]?.value&&xe(ke)})}D(j,Oe)}),D(N,H)},$$slots:{default:!0}})}),U(C);var E=de(C,2);$e(E,()=>r.children??Qe),D(g,I)},$$slots:{default:!0}})}),D(S,s),He()}const Ve=Object.freeze({LEFT:"left",RIGHT:"right",TOP:"top",BOTTOM:"bottom"});var Ou=oe("<!> <div><aside><div><div><!></div></div></aside></div> <!>",1);function Pu(S,r){Re(r,!0);const o=Fe(r,"position",19,()=>Ve.LEFT),s=Fe(r,"openIcon",3,As),c=8,h="500px",d="var(--header-height, 64px)";let g,T=re(0),I=re(qe(r.originalSize??h)),C=re(!1),F=re(!1);const E=pe(()=>o()===Ve.LEFT||o()===Ve.RIGHT),Y=pe(()=>o()===Ve.LEFT||o()===Ve.TOP),M=pe(()=>l(E)?"500px":"100px"),N=pe(()=>r.minSize??l(M)),z=pe(()=>parseFloat(l(N))),H=pe(()=>l(E)?"width":"height"),V=pe(()=>l(E)?"ew-resize":"ns-resize");Ze(()=>{l(F)||(K(I,r.originalSize??l(N),!0),console.log("Sidebar size updated due to minSize/originalSize change:",l(I),r.originalSize))}),kr(()=>{if(!g)return;const be=new ResizeObserver(Ee=>{for(const Me of Ee)K(T,l(E)?Me.contentRect.width:Me.contentRect.height,!0)});return be.observe(g),()=>be.disconnect()});function j(be){if(!r.isOpen)return;K(C,!0),be.preventDefault();const Ee=l(E)?be.clientX:be.clientY,Me=parseFloat(l(I));function ot(lt){const Ke=l(E)?lt.clientX:lt.clientY,we=l(Y)?Ke-Ee:Ee-Ke,Be=Math.max(l(z),Me+we);K(I,`${Be}px`),K(F,!0)}function Z(){K(C,!1),document.removeEventListener("mousemove",ot),document.removeEventListener("mouseup",Z),document.body.style.cursor="",document.body.style.userSelect=""}document.addEventListener("mousemove",ot),document.addEventListener("mouseup",Z),document.body.style.cursor=l(V),document.body.style.userSelect="none"}const W=pe(()=>()=>{const be=r.isOpen?l(I):"0px";return{[Ve.LEFT]:{top:d,left:be},[Ve.RIGHT]:{top:d,right:be},[Ve.TOP]:{top:be},[Ve.BOTTOM]:{bottom:be}}[o()]}),ce=pe(()=>()=>({[Ve.LEFT]:Cs,[Ve.RIGHT]:Yo,[Ve.TOP]:ks,[Ve.BOTTOM]:xs})[o()]),X=pe(()=>()=>{if(!r.isOpen)return{};const be=`${c}px`,Ee=r.isOpen?`calc(${l(I)} + ${-c/2}px)`:"0px";return{[Ve.LEFT]:{left:Ee,top:"0",width:be,height:"100%"},[Ve.RIGHT]:{right:Ee,top:"0",width:be,height:"100%"},[Ve.TOP]:{top:Ee,left:"0",height:be,width:"100%"},[Ve.BOTTOM]:{bottom:Ee,left:"0",height:be,width:"100%"}}[o()]});function he(be){return Object.entries(be).map(([Ee,Me])=>`${Ee}: ${Me}`).join("; ")}const _e=pe(()=>l(Y)?0:1),Oe=pe(()=>()=>r.isOpen?"translate(0, 0)":{[Ve.LEFT]:`translate(-${l(I)}, 0)`,[Ve.RIGHT]:`translate(${l(I)}, 0)`,[Ve.TOP]:`translate(0, -${l(I)})`,[Ve.BOTTOM]:`translate(0, ${l(I)})`}[o()]),ue=pe(()=>()=>{const be=r.isOpen?l(I):"0px";return{[l(H)]:be,order:`${l(_e)}`}});var Se=Ou(),ke=$(Se);{let be=pe(()=>l(C)?"":"transition-all duration-300"),Ee=pe(()=>he(l(W)())),Me=pe(()=>l(C)?"transition: none !important;":""),ot=pe(()=>r.isOpen?"Close sidebar":"Open sidebar");Ot(ke,{get onclick(){return r.onToggle},variant:"default",size:"icon",get class(){return`fixed z-2 -ml-1 inline-flex size-7 
	shrink-0 items-center justify-center gap-2 overflow-hidden rounded-md bg-background text-sm
	font-medium whitespace-nowrap shadow-none outline-hidden transition-all select-none hover:bg-accent focus-visible:border-ring 
	focus-visible:ring-[3px] focus-visible:ring-ring/50 disabled:pointer-events-none disabled:opacity-50 aria-invalid:border-destructive aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 ${l(be)??""}`},get style(){return`${l(Ee)??""}; pointer-events: auto; ${l(Me)??""}`},get"aria-label"(){return l(ot)},get"aria-expanded"(){return r.isOpen},children:(Z,lt)=>{var Ke=se(),we=$(Ke);{var Be=nt=>{const vt=pe(()=>l(ce)());var It=se(),pt=$(It);Le(pt,()=>l(vt),(et,We)=>{We(et,{class:"h-6 w-6 text-primary"})}),D(nt,It)},ft=nt=>{const vt=pe(s);var It=se(),pt=$(It);Le(pt,()=>l(vt),(et,We)=>{We(et,{class:"h-6 w-6 text-primary"})}),D(nt,It)};ye(we,nt=>{r.isOpen?nt(Be):nt(ft,!1)})}D(Z,Ke)},$$slots:{default:!0}})}var xe=de(ke,2);let le;var Ce=Q(xe);let je;var ie=Q(Ce);let ge;var ve=Q(ie);let me;var Ue=Q(ve);{var Xe=be=>{var Ee=se(),Me=$(Ee);$e(Me,()=>r.children),D(be,Ee)};ye(Ue,be=>{r.children&&be(Xe)})}U(ve),U(ie),U(Ce),Pt(Ce,be=>g=be,()=>g),U(xe);var Ge=de(xe,2);{var at=be=>{{let Ee=pe(()=>l(E)?"cursor-ew-resize":"cursor-ns-resize"),Me=pe(()=>l(C)?"":"transition-all duration-300"),ot=pe(()=>he(l(X)()));Ot(be,{get class(){return`fixed z-40 border-0 bg-transparent p-0 ring-0 transition-colors outline-none hover:!bg-primary/50 focus-visible:ring-0 ${l(Ee)??""} ${l(Me)??""}`},onmousedown:j,"aria-label":"Resize sidebar by dragging",get style(){return`${l(ot)??""}; outline: none !important; box-shadow: none !important; border: none !important;`}})}};ye(Ge,be=>{r.isOpen&&be(at)})}dt((be,Ee,Me,ot,Z,lt)=>{le=tr(xe,1,"relative z-3 h-full w-full overflow-hidden transition-all duration-300",null,le,be),Ir(xe,Ee),je=tr(Ce,1,"border-r-bg-sidebar-border relative flex border-r-1 bg-sidebar text-sidebar-foreground shadow-lg",null,je,Me),Ir(Ce,`${l(H)??""}: ${l(I)??""}; transform: ${ot??""};`),ge=tr(ie,1,"flex overflow-hidden",null,ge,Z),me=tr(ve,1,"flex overflow-hidden",null,me,lt)},[()=>({"h-full":l(E),"w-full":!l(E),"transition-all":!l(C),"duration-300":!l(C)}),()=>he(l(ue)()),()=>({"flex-col":l(E),"flex-row":!l(E),"h-full":l(E),"w-full":!l(E),"border-r":o()===Ve.LEFT,"border-l":o()===Ve.RIGHT,"border-b":o()===Ve.TOP,"border-t":o()===Ve.BOTTOM,"border-sidebar-border":!0,"transition-transform":!l(C),"duration-300":!l(C)}),()=>l(Oe)(),()=>({"flex-col":l(E),"flex-row":!l(E),"h-full":l(E),"w-full":!l(E)}),()=>({"flex-col":l(E),"flex-row":!l(E),"h-full":l(E),"w-full":!l(E)})]),D(S,Se),He()}var Tu=oe('<div><!> <div class="main-content svelte-f4u9lw"><!></div></div>');function Eu(S,r){Re(r,!0);const o=Fe(r,"position",19,()=>Ve.LEFT),s=pe(()=>o()===Ve.TOP||o()===Ve.BOTTOM);var c=Tu();let h;var d=Q(c);Pu(d,{get isOpen(){return r.isOpen},get onToggle(){return r.onToggle},get position(){return o()},get originalSize(){return r.originalSize},get minSize(){return r.minSize},get openIcon(){return r.openIcon},children:(C,F)=>{var E=se(),Y=$(E);{var M=N=>{var z=se(),H=$(z);$e(H,()=>r.sidebarContent),D(N,z)};ye(Y,N=>{r.sidebarContent&&N(M)})}D(C,E)},$$slots:{default:!0}});var g=de(d,2),T=Q(g);{var I=C=>{var F=se(),E=$(F);$e(E,()=>r.mainContent),D(C,F)};ye(T,C=>{r.mainContent&&C(I)})}U(g),U(c),dt(C=>h=tr(c,1,"sidebar-layout svelte-f4u9lw",null,h,C),[()=>({vertical:l(s)})]),D(S,c),He()}var Du=oe('<div class="min-w-0 space-y-2 overflow-hidden"><!></div>'),Fu=oe('<div class="w-full flex-1 overflow-hidden pr-1.5 pl-1.5"><!></div>');function Lu(S,r){var o=Fu(),s=Q(o);xa(s,{class:"h-full w-full",children:(c,h)=>{var d=Du(),g=Q(d);{var T=I=>{var C=se(),F=$(C);$e(F,()=>r.children),D(I,C)};ye(g,I=>{r.children&&I(T)})}U(d),D(c,d)},$$slots:{default:!0}}),U(o),D(S,o)}var Nu=oe('<div class="w-full flex-shrink-0"><!></div>');function Mu(S,r){var o=Nu(),s=Q(o);{var c=h=>{var d=se(),g=$(d);$e(g,()=>r.children),D(h,d)};ye(s,h=>{r.children&&h(c)})}U(o),D(S,o)}var Ru=oe('<div class="w-full flex-shrink-0"><!></div>');function Hu(S,r){var o=Ru(),s=Q(o);{var c=h=>{var d=se(),g=$(d);$e(g,()=>r.children),D(h,d)};ye(s,h=>{r.children&&h(c)})}U(o),D(S,o)}const ju=[{value:"define-areas",label:"Define Areas"},{value:"select-data",label:"Select Data"},{value:"export",label:"Export"},{value:"downloads",label:"Download"}];class zu{#e;constructor(r){if(!r)throw new Error("UprnDownloadService endpoints configuration is required");if(!r.baseUrl||!r.healthRoute||!r.requestJobRoute||!r.requestJobStatusesRoute||!r.getAreaSelectionLimitsRoute||!r.fetchDownloadRoute)throw new Error("UprnDownloadService endpoints configuration is incomplete");this.#e=r}async getHealth(){try{const r=`${this.#e.baseUrl}${this.#e.healthRoute}`,o=await fetch(r);return o.ok?(await o.json()).status==="ok":!1}catch(r){return console.error("Health check failed:",r),!1}}async requestJob(r){try{console.log("[uprn-download-service] requesting job with request:",r);const o=`${this.#e.baseUrl}${this.#e.requestJobRoute}`,s=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!s.ok){console.error("Failed to request job:",s.statusText,"request:",JSON.stringify(r));return}return await s.json()}catch(o){console.error("Error requesting job:",o);return}}async requestJobStatuses(r){try{const o=`${this.#e.baseUrl}${this.#e.requestJobStatusesRoute}`,s=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!s.ok){console.error("Failed to get job statuses:",s.statusText);return}return await s.json()}catch(o){console.error("Error getting job statuses:",o);return}}async getSelectionAreaLimits(){try{const r=`${this.#e.baseUrl}${this.#e.getAreaSelectionLimitsRoute}`,o=await fetch(r);if(!o.ok){console.error("Failed to get area selection limits:",o.statusText);return}return await o.json()}catch(r){console.error("Error getting selection area limits:",r);return}}getDownloadUrl(r){const o=this.#e.baseUrl.replace(/\/+$/,""),s=this.#e.fetchDownloadRoute.replace(/\/+$/,"");return`${o}${s}/${encodeURIComponent(r)}`}}class Vu{#e;constructor(r){this.#e=r}async getHealth(){try{const r=`${this.#e.baseUrl}${this.#e.healthRoute}`,o=await fetch(r);return o.ok?(await o.json()).status==="ok":!1}catch(r){return console.error("Health check failed:",r),!1}}async chat(r){try{const o=`${this.#e.baseUrl}${this.#e.chatRoute}`,c=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:r})});if(!c.ok){console.error("Failed to send chat query:",c.statusText);return}return await c.json()}catch(o){console.error("Error sending chat query:",o);return}}async chatStream(r,o){try{const s=`${this.#e.baseUrl}${this.#e.chatStreamRoute}`,h=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:r})});if(!h.ok)return console.error("Failed to start chat stream:",h.statusText),!1;const d=h.body?.getReader();if(!d)return console.error("No response body reader available"),!1;const g=new TextDecoder;let T=!1;for(;!T;){const{value:I,done:C}=await d.read();if(T=C,I){const F=g.decode(I,{stream:!T});o(F)}}return!0}catch(s){return console.error("Error during chat stream:",s),!1}}}const Ku=Object.freeze({lod00World:{lod:0,scale:591657527591555e-6},lod01World:{lod:1,scale:295828763795777e-6},lod02World:{lod:2,scale:147914381897889e-6},lod03Continent:{lod:3,scale:73957190948944e-6},lod04Continent:{lod:4,scale:36978595474472e-6},lod05Countries:{lod:5,scale:18489297737236e-6},lod06Country:{lod:6,scale:9244648868618e-6},lod07StatesProvinces:{lod:7,scale:4622324434309e-6},lod08Counties:{lod:8,scale:2311162217155e-6},lod09Counties:{lod:9,scale:1155581108577e-6},lod10Country:{lod:10,scale:577790.554289},lod11MetropolitanArea:{lod:11,scale:288895.277144},lod12Cities:{lod:12,scale:144447.638572},lod13City:{lod:13,scale:72223.819286},lod14Town:{lod:14,scale:36111.909643},lod15Neighborhood:{lod:15,scale:18055.954822},lod16Streets:{lod:16,scale:9027.977411},lod17CityBlock:{lod:17,scale:4513.988705},lod18Buildings:{lod:18,scale:2256.994353},lod19Building:{lod:19,scale:1128.497176},lod20Houses:{lod:20,scale:564.248588},lod21Houses:{lod:21,scale:282.124294},lod22Houses:{lod:22,scale:141.062147},lod23HouseProperty:{lod:23,scale:70.5310735}});class Bu{#e=null;#t=!1;async init(r){this.#t||(await this.#r(r),this.#t=!0)}async#r(r){const s=await(await fetch(r)).json();this.#e=s}doesFieldHaveCustomRenderer(r,o){this.#u();const s=this.#e.FeatureLayers.find(d=>d.Name===r.title);if(!s)return!1;const c=this.#e.Fields.find(d=>d.FeatureLayerId===s.Id&&d.Name===o);return c?!!this.#e.CustomRenderers_Fields.find(d=>d.FieldId===c.Id):!1}getAllFieldsWithCustomRenderers(r){this.#u();const o=this.#e.FeatureLayers.find(h=>h.Name===r.title);if(!o)return[];const s=this.#e.Fields.filter(h=>h.FeatureLayerId===o.Id),c=[];for(const h of s)this.#e.CustomRenderers_Fields.some(g=>g.FieldId===h.Id)&&c.push(h.Name);return c}async applyCustomRenderer(r,o){this.#u();const s=this.#e.FeatureLayers.find(C=>C.Name===r.title);if(!s)return;const c=this.#e.Fields.find(C=>C.FeatureLayerId===s.Id&&C.Name===o);if(!c){console.warn(`[custom-renderer-service] could not find the field ${o} for feature layer id ${s.Id}`);return}const h=this.#e.CustomRenderers_Fields.find(C=>C.FieldId===c.Id);if(!h){console.warn(`[custom-renderer-service] could not find a custom renderer field for field ${o} in feature layer id ${s.Id}`);return}const d=this.#e.CustomRenderers.find(C=>C.Id===h.CustomRendererId);if(!d)throw new Error(`Could not find a custom renderer with the id ${h.CustomRendererId}`);const g=await this.getRendererClassBreaks(d.ClassBreaksGroupId.toString()),T=await this.getRendererSymbols(d.SymbolsId.toString()),I=this.#o(d.CustomRendererType,T,g,[],o);r.renderer=I,this.setCustomOutlines(r,d.LodsGroupId)}async setCustomOutlines(r,o){const s=this.#e.CustomRenderers_Lods.filter(d=>d.GroupId===o).sort((d,g)=>d.Lod-g.Lod);if(s.length===0){console.warn(`No LODs found for LODs group id ${o}`);return}const c=[],h=Object.values(Ku);s.forEach(d=>{const g=d.OutlineWidth,T=d.Lod,I=this.#n(h,T)-1;c.push({size:g,value:h[I].scale})}),(r.renderer instanceof oa||r.renderer instanceof sa)&&this.#s(r.renderer,c)}async getRendererClassBreaks(r){const o=parseInt(r,10),s=this.#e.CustomRenderers_ClassBreaks.filter(c=>c.GroupId===o).sort((c,h)=>c.Order-h.Order);if(s.length===0)throw new Error(`Could not find a group with the id ${r}`);return s}async getRendererSymbols(r){const o=parseInt(r,10),s=this.#e.CustomRenderers_Symbols.find(d=>d.Id===o);if(!s)throw new Error(`Could not find a symbol with the id ${r}`);const c=this.#e.CustomRenderers_Symbols_Appearances.filter(d=>d.SymbolsId===o).sort((d,g)=>d.Order-g.Order);return{...s,Appearances:c}}#n(r,o){const s=r.findIndex(c=>c.lod===o);return s===-1?0:s<23?s+1:s}#o(r,o,s,c,h){switch(r){case 1:return this.#a(o,c);case 2:return this.#i(h,o,s,c);default:throw new Error(`Unknown renderer type: ${r}`)}}#i(r,o,s,c){const h="ClassMinValue",d="ClassMaxValue",g="SymbolColor",T="OutlineColor",I="OutlineWidth",C=o.Appearances.length,F=new oa({field:r});for(let E=0;E<C;E++){const Y=s[E][h],M=s[E][d],N=o.Appearances[E][g],z=o.Appearances[E][T],H=o.Appearances[E][I];F.addClassBreakInfo({minValue:Y,maxValue:M,symbol:new la({color:wn.fromHex(N),outline:new ua({color:wn.fromHex(z),width:H})})})}return this.#s(F,c),F}#a(r,o){const s="SymbolColor",c="OutlineColor",h="OutlineWidth",d=r.Appearances[0][s],g=r.Appearances[0][c],T=r.Appearances[0][h],I=new sa({symbol:new la({color:wn.fromHex(d),outline:new ua({color:wn.fromHex(g),width:T})})});return this.#s(I,o),I}#s(r,o){r.visualVariables=[{type:"size",target:"outline",valueExpression:"$view.scale",stops:o}]}#u(){if(!this.#t)throw new Error("CustomRendererService is not initialized");if(!this.#e)throw new Error("Data is not loaded")}}var qu=oe('<div class="flex w-full items-center justify-between"><div class="font-medium">Chat</div> <div class="flex gap-1"><!> <!></div></div>'),$u=oe("<!> <!>",1),Uu=oe("<div><!></div>");function Gu(S,r){Re(r,!0);const o=Fe(r,"isOpenedOnInit",3,!1);let s=re(!1),c=re(qe(o())),h=re(!1),d=re(void 0),g="300px",T="45px";Ze(()=>{l(s)||!l(d)||(l(c)&&(l(d).style.height=g),K(s,!0))});function I(){l(d)&&(K(c,!l(c)),K(h,!1),l(c)?(T=l(d).style.height,l(d).style.height=g):l(d).style.height=T)}function C(){l(d)&&(K(h,!l(h)),l(h)?(g=l(d).style.height,l(d).style.height="100%"):l(d).style.height=g)}var F=Uu(),E=Q(F);Le(E,()=>Tn,(Y,M)=>{M(Y,{class:"h-full w-full gap-0 rounded-none py-0 pt-0 pb-0",children:(N,z)=>{var H=$u(),V=$(H);Le(V,()=>ls,(ce,X)=>{X(ce,{class:"pt-2",children:(he,_e)=>{var Oe=qu(),ue=de(Q(Oe),2),Se=Q(ue);{var ke=le=>{Ot(le,{class:"size-7",onclick:C,children:(Ce,je)=>{var ie=se(),ge=$(ie);{var ve=Ue=>{Fs(Ue,{})},me=Ue=>{Ds(Ue,{})};ye(ge,Ue=>{l(h)?Ue(ve):Ue(me,!1)})}D(Ce,ie)},$$slots:{default:!0}})};ye(Se,le=>{l(c)&&le(ke)})}var xe=de(Se,2);Ot(xe,{class:"size-7",onclick:I,children:(le,Ce)=>{var je=se(),ie=$(je);{var ge=me=>{Es(me,{})},ve=me=>{vs(me,{})};ye(ie,me=>{l(c)?me(ve,!1):me(ge)})}D(le,je)},$$slots:{default:!0}}),U(ue),U(Oe),D(he,Oe)},$$slots:{default:!0}})});var j=de(V,2);{var W=ce=>{var X=se(),he=$(X);Le(he,()=>Pn,(_e,Oe)=>{Oe(_e,{class:"h-full min-h-[10px] w-full p-0",children:(ue,Se)=>{var ke=se(),xe=$(ke);$e(xe,()=>r.children??Qe),D(ue,ke)},$$slots:{default:!0}})}),D(ce,X)};ye(j,ce=>{l(c)&&ce(W)})}D(N,H)},$$slots:{default:!0}})}),U(F),Pt(F,Y=>K(d,Y),()=>l(d)),D(S,F),He()}function Wu(S,r){Re(r,!0),Ot(S,{onclick:()=>r.clear(),variant:"destructive",class:"size-7",title:"Clear all selections",children:(o,s)=>{Os(o,{})},$$slots:{default:!0}}),He()}var Yu=oe('<p class="p-4 text-center text-sm text-gray-500">Download service is not available.</p>'),Ju=oe("<div><!></div> <div><!></div> <div><!></div> <div><!></div>",1),Qu=oe("<div><!></div>"),Xu=oe('<p class="p-4 text-center text-sm text-gray-500">AI UPRN Chatbot service is not available.</p>'),Zu=oe('<div class="relative flex h-full w-full min-w-0 flex-col overflow-visible"><!> <!> <div class="fixed pt-1 pl-1"><!></div> <!> <!></div>'),ec=oe("<!> <!> <!> <!> <!>",1);function Wc(S,r){Re(r,!0);let o,s,c;const h=qe(new kl),d=qe(new Cl);let g=re("define-areas"),T=re(void 0),I=re(void 0),C=re(void 0),F=re(void 0),E=re(void 0),Y=re(!1),M=re(!1),N=re(qe(new Set)),z=re(!0),H=qe(Ve.LEFT);qe(Ve.BOTTOM);let V=re(qe([])),j=re(qe(typeof window<"u"?window.innerWidth:1280)),W=pe(()=>X(l(V),ie=>ie.originalSize)),ce=pe(()=>X(l(V),ie=>ie.minSize));function X(ie,ge){if(!ie||ie.length===0)return;const me=[...ie].sort((Ue,Xe)=>Xe.breakpoint-Ue.breakpoint).find(Ue=>l(j)>=Ue.breakpoint);return me?ge(me):"0"}function he(){K(z,!l(z))}function _e(ie){K(g,ie,!0)}function Oe(){K(g,"downloads")}function ue(){Pe.clearSelections(),Ct.clearSelections(),o?.clearSelections(),s?.clearSelections(),ul()}kr(async()=>{K(C,new Bu,!0),await l(C).init(`${us}/custom-renderers.json`),console.log("[uprn-2/page] CustomRendererService initialized");const ie=await To();Pe.setFieldInfo(ie.serviceUprn2Config.selectionLayersNameFields||[]),K(V,ie.serviceUprn2Config.mainSidebarSizes||[],!0),K(T,new ma(ie.serviceUprn2Config.dataSelectionTreeviewConfig),!0),K(I,new ma(ie.serviceUprn2Config.areaSelectionTreeviewConfig),!0),(async()=>{const ve=ie.serviceUprn2Config.uprnDownloadServiceEndpoints,me=ie.serviceUprn2Config.aiUprnChatbotServiceEndpoints;K(F,new zu(ve),!0),K(E,new Vu(me),!0),K(Y,await l(F).getHealth(),!0),l(Y)?console.log("[uprn-2/page] UPRN Download Service is available"):console.warn("[uprn-2/page] UPRN Download Service is NOT available"),K(M,await l(E).getHealth(),!0),l(M)?console.log("[uprn-2/page] AI UPRN Chatbot Service is available"):console.warn("[uprn-2/page] AI UPRN Chatbot Service is NOT available")})(),K(N,new Set(ie.serviceUprn2Config.dataSelectionTreeviewConfig?.fieldsToHide||[]),!0),await h.initializeAsync({portalUrl:ie.serviceUprn2Config.portalUrl,itemId:ie.serviceUprn2Config.portalItemId||"",proxy:ie.serviceUprn2Config.proxy})}),kr(()=>{const ie=()=>{K(j,window.innerWidth,!0)};return window.addEventListener("resize",ie),()=>{window.removeEventListener("resize",ie)}}),_a(()=>{Pe.cleanup(),Ct.cleanup(),kn.cleanup()});var Se=ec(),ke=$(Se);Jo(ke,{});var xe=de(ke,2);Hs(xe,{});var le=de(xe,2);Ul(le,{get fieldFilterMenuStore(){return d},get fieldsToHide(){return l(N)}});var Ce=de(le,2);js(Ce,{});var je=de(Ce,2);{const ie=ve=>{var me=Zu(),Ue=Q(me);Le(Ue,()=>Mu,(Me,ot)=>{ot(Me,{children:(Z,lt)=>{Au(Z,{get value(){return l(g)},get triggers(){return ju},onValueChange:_e})},$$slots:{default:!0}})});var Xe=de(Ue,2);Le(Xe,()=>Lu,(Me,ot)=>{ot(Me,{children:(Z,lt)=>{var Ke=Ju(),we=$(Ke),Be=Q(we);xn(Be,{children:(We,Ye)=>{var ht=se(),St=$(ht);{var Nt=mt=>{Pt(au(mt,{get webMap(){return h.data},get treeviewConfigStore(){return l(I)},get areaSelectionStore(){return Pe}}),st=>o=st,()=>o)};ye(St,mt=>{h.isLoaded&&mt(Nt)})}D(We,ht)}}),U(we);var ft=de(we,2),nt=Q(ft);xn(nt,{children:(We,Ye)=>{var ht=se(),St=$(ht);{var Nt=mt=>{{let st=pe(()=>c?.getLayerViewProvider());Pt(gu(mt,{get webMap(){return h.data},get layerViewProvider(){return l(st)},get treeviewConfigStore(){return l(T)},get customRendererService(){return l(C)},get fieldFilterMenuStore(){return d}}),At=>s=At,()=>s)}};ye(St,mt=>{h.isLoaded&&mt(Nt)})}D(We,ht)}}),U(ft);var vt=de(ft,2),It=Q(vt);xn(It,{children:(We,Ye)=>{Nl(We,{get webMapStore(){return h},get dataSelectionTreeviewConfig(){return l(T)},get fieldFilterMenuStore(){return d}})}}),U(vt);var pt=de(vt,2),et=Q(pt);xn(et,{children:(We,Ye)=>{var ht=se(),St=$(ht);{var Nt=st=>{var At=Yu();D(st,At)},mt=st=>{wl(st,{get webMapStore(){return h},get uprnDownloadService(){return l(F)},get fieldsToHide(){return l(N)}})};ye(St,st=>{!l(F)||!l(Y)?st(Nt):st(mt,!1)})}D(We,ht)}}),U(pt),dt(()=>{we.hidden=l(g)!=="define-areas",ft.hidden=l(g)!=="select-data",vt.hidden=l(g)!=="export",pt.hidden=l(g)!=="downloads"}),D(Z,Ke)},$$slots:{default:!0}})});var Ge=de(Xe,2),at=Q(Ge);Wu(at,{clear:ue}),U(Ge);var be=de(Ge,2);Le(be,()=>Hu,(Me,ot)=>{ot(Me,{children:(Z,lt)=>{var Ke=Qu(),we=Q(Ke);xl(we,{onExportSuccess:Oe}),U(Ke),dt(()=>Ke.hidden=l(g)!=="export"),D(Z,Ke)},$$slots:{default:!0}})});var Ee=de(be,2);Gu(Ee,{isOpenedOnInit:!0,children:(Me,ot)=>{var Z=se(),lt=$(Z);{var Ke=Be=>{var ft=Xu();D(Be,ft)},we=Be=>{nl(Be,{get aiUprnChatbotService(){return l(E)}})};ye(lt,Be=>{!l(E)||!l(M)?Be(Ke):Be(we,!1)})}D(Me,Z)},$$slots:{default:!0}}),U(me),D(ve,me)},ge=ve=>{Pt(Su(ve,{get webMap(){return h.data},panelPosition:"top-left",menuPosition:"top-right"}),me=>c=me,()=>c)};Le(je,()=>Eu,(ve,me)=>{me(ve,{get isOpen(){return l(z)},onToggle:he,get position(){return H},get originalSize(){return l(W)},get minSize(){return l(ce)},sidebarContent:ie,mainContent:ge,$$slots:{sidebarContent:!0,mainContent:!0}})})}D(S,Se),He()}export{Wc as component};
