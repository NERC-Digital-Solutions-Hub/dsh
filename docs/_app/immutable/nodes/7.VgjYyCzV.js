const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/BEZFO2vt.js","../chunks/BW0zoJTm.js","../chunks/CEBETtrS.js","../chunks/CaNW5Bx0.js","../chunks/CjBjO1Km.js","../chunks/PPVm8Dsz.js","../chunks/BUsxo-Ec.js","../chunks/D0nkGZIM.js","../chunks/CVQPxYbx.js","../chunks/DwerzRSF.js","../chunks/y1GB1Svy.js","../chunks/AlyPEkJM.js","../chunks/DFYTeVXP.js","../chunks/Cn9cIaVC.js","../chunks/BTNr9f9k.js","../chunks/EmFT8XhJ.js","../chunks/jYVHtrPb.js","../chunks/Cp_8tW2x.js","../chunks/BAWfW4Tu.js","../chunks/CumW50Sh.js","../chunks/Ci6C1k20.js","../chunks/bnayRBMH.js","../chunks/TJ-VhDZ5.js","../chunks/B0gOzRRh.js","../chunks/TW8D_o5j.js","../chunks/Oe6SV2kF.js","../chunks/B_yBz6pZ.js","../chunks/MtSiOt06.js","../chunks/C0wm8_Yw.js","../chunks/CW6Redn4.js","../chunks/BnQsZfR4.js","../chunks/BYduSOTS.js","../chunks/PJHcqbvL.js","../chunks/DS2ZxNQA.js","../chunks/Djp3mnm5.js","../chunks/DjNaDsmS.js","../chunks/C-w03I0l.js","../chunks/CZyMpCUL.js","../chunks/D9kT-sgB.js","../chunks/Bu0s_rAF.js","../chunks/B87vTgcy.js","../chunks/C3_gy5al.js","../chunks/CfBiQUdY.js","../chunks/BABeDC_w.js","../chunks/Dj-cqQsY.js","../chunks/B128_oTY.js","../chunks/7808le4B.js","../chunks/BwN_j92a.js","../chunks/Bde99gqs.js","../chunks/C7fxqwFZ.js","../chunks/CVwTD0fV.js","../chunks/9eAP65Ji.js","../chunks/mOc398RU.js","../chunks/DPJXGPFY.js","../chunks/B8cN3yAo.js","../chunks/BIj_QgNJ.js","../chunks/q_b6UJoq.js","../chunks/CYI1luaL.js","../chunks/DTEZVyiP.js","../chunks/BCTmL8G8.js","../chunks/DqwAHjQA.js","../chunks/CFxQi9ff.js","../chunks/Ba6e521d.js","../chunks/B45SJMf_.js","../chunks/DvKU1K2H.js","../assets/jsxFactory.CQED0rIl.css","../chunks/CRNKQexD.js","../chunks/DfDynnwy.js","../chunks/Ch4klalT.js","../chunks/0N6-HNAU.js","../chunks/BqXNu7b5.js","../chunks/48RKFPo7.js","../chunks/CTnd5cvu.js","../chunks/PWd9QCpP.js","../chunks/Cgb6qxNH.js","../chunks/fxczVhmx.js","../chunks/_r5V6nso.js","../chunks/TQki0tx9.js","../chunks/B934cuUn.js","../chunks/C1gSvD9v.js","../chunks/CaVKkSa6.js","../chunks/Bb7XCc95.js","../chunks/BrT4CCe6.js","../chunks/B1N-tmtC.js","../chunks/CEtlHNOR.js","../chunks/BZKeGk9D.js","../chunks/D-qJO60r.js","../chunks/QQC62dOK.js","../chunks/Bxxl7NsE.js","../chunks/BpZHOvkG.js","../chunks/DQOO6RKE.js","../chunks/B21jgz5M.js","../chunks/Bi6C4OG6.js","../chunks/teoI27Zt.js","../chunks/D-YQ4CHs.js","../chunks/DpAKiq6K.js","../chunks/XEmGDYB_.js","../chunks/BVFIxAn9.js","../chunks/CAO_3SU9.js","../chunks/CglP3OMz.js","../chunks/DCBLidga.js","../chunks/DhMSIuCj.js","../chunks/CSXZNpHb.js","../chunks/xXH_AyYh.js","../chunks/CHAiFIco.js","../chunks/6Jo1niE7.js","../chunks/DjNuiUVf.js","../chunks/CpqG7TFG.js","../chunks/D_dxbuU-.js","../chunks/jQbrml54.js","../chunks/uHWM1awI.js","../chunks/CYEJx0Wq.js","../chunks/BteoTDFn.js","../chunks/B7Ex7sMf.js","../chunks/DocBEfKB.js","../chunks/B2jVc7id.js","../chunks/Da4sQo3R.js","../chunks/CAGdFHZB.js","../chunks/DzvuCIKa.js","../chunks/Bu0Dv00G.js","../chunks/Bo5l4fk8.js","../chunks/TEMnSu_8.js","../chunks/CQmZIYPi.js","../chunks/DsEHuRPb.js","../chunks/BARRAGjD.js","../chunks/DwIB5gq4.js","../chunks/BjGHVp5Q.js","../chunks/lEIzcqu9.js","../chunks/CtIxBnU3.js","../chunks/gJDQstGQ.js","../chunks/Cl8hT7Dy.js","../chunks/hngUoOdp.js","../chunks/BlT3hoGo.js","../chunks/DZpEp5b3.js","../chunks/GKolV7NZ.js","../chunks/PiqJyY-Z.js","../chunks/CWQ4Sji6.js","../chunks/Cc8znHts.js","../chunks/C9Yzh9th.js","../chunks/CMFr2xVw.js","../chunks/B8kDL1f4.js","../chunks/Bo-exx2O.js","../chunks/BFHafdW6.js","../chunks/D5cGnOsZ.js","../chunks/CCtOv0E5.js","../chunks/DhzudQro.js","../chunks/Qzt__3Yd.js","../chunks/mx71iuXv.js","../chunks/E5yhiq2t.js","../chunks/B2om5830.js","../chunks/CrUuvTSr.js","../chunks/DNQVkPqp.js","../chunks/WCLBMBm-.js","../chunks/BveQ3Yw2.js","../chunks/EGFv0f86.js","../chunks/BDRaqLVR.js","../chunks/BlaSF0Se.js","../chunks/mBdPBegd.js","../chunks/Cu3emot3.js","../chunks/qyF9FwQ9.js","../chunks/XI-Li77m.js","../chunks/DS8kW6UP.js","../chunks/1BM1gK8E.js","../chunks/DPb6J-GU.js","../chunks/BxTLSXBH.js","../chunks/BGyY2giR.js","../chunks/D28RTRrm.js","../chunks/C65Zrur8.js","../chunks/DwnB9djr.js","../chunks/CUTkbj50.js","../chunks/DE7psHTV.js","../chunks/Fla_WrMr.js","../chunks/CVRs03iK.js","../chunks/g8mGjH5g.js","../chunks/D1UBzOg5.js","../chunks/C8HgMPMV.js","../chunks/BqUxlKJa.js","../chunks/CzWdKr8p.js","../chunks/C2FvnhIN.js","../chunks/B0DG5wVw.js","../chunks/CaYZrGFV.js"])))=>i.map(i=>d[i]);
import"../chunks/DsnmJJEf.js";import{a as Ft,o as Pt}from"../chunks/B12Xl85d.js";import{p as Y,f as C,a as J,v as r,a8 as $,c as p,n as se,r as w,aG as N,av as K,ar as _,u as ee,a7 as A,T as Q,W as ce}from"../chunks/l2HDBFeU.js";import{p as zt,c as E,a as l,f as V,t as me}from"../chunks/D3mgKXxP.js";import{p as Z,i as z,r as ut,s as Et,a as Ot,b as Gt}from"../chunks/amrQSy0T.js";import{_ as ge}from"../chunks/PPVm8Dsz.js";import{s as ae,e as ue,i as ke}from"../chunks/Dv6QOWAw.js";import{b as Be}from"../chunks/CPWKExeQ.js";import{k as Ut,a as We,m as Rt,S as de}from"../chunks/p_qY5EvW.js";import{c as q}from"../chunks/BULd4hFL.js";import{T as jt,O as ht,a as Bt,G as at,F as nt,b as Wt,c as Ie,d as vt,t as le,e as qt,f as Xt,g as Zt,h as Qt,i as Yt,S as Ce,C as ot,j as Jt,I as Kt,k as $t,l as ei,m as ti,L as ii,n as ri,V as st,o as ai,p as ni}from"../chunks/a4NLgDxh.js";import{a as oi,d as De,b as He,s as ye,e as si}from"../chunks/B2XAts-z.js";import{s as re}from"../chunks/CPxvWa6q.js";import{h as pe}from"../chunks/fvInIvwb.js";import{e as Ae}from"../chunks/7Q11sfri.js";import{C as li,X as di,a as ci,b as ui,g as hi}from"../chunks/B_Cz5uwL.js";import{c as vi}from"../chunks/DzE4wJgV.js";import{C as Ke}from"../chunks/CJ2y2uxK.js";import{C as $e}from"../chunks/Cgb8ZoOw.js";import{C as fi}from"../chunks/DnU6zaW9.js";import{S as gi,j as yi,f as mi,g as wi,h as bi,i as pi}from"../chunks/xE6fRQiE.js";import{B as fe}from"../chunks/Cycc-Qfx.js";import{s as _i}from"../chunks/BNqVFuyK.js";import{S as Si}from"../chunks/DqC0T5S3.js";var Ii=V("<div><!></div>");function Ci(d,e){const t=zt();Y(e,!0);let i=Z(e,"id",19,()=>Ut(t)),a=Z(e,"ref",15,null),n=ut(e,["$$slots","$$events","$$legacy","children","child","id","ref","value"]);const s=jt.create({value:We(()=>e.value),id:We(()=>i()),ref:We(()=>a(),o=>a(o))}),m=$(()=>Rt(n,s.props));var c=E(),h=C(c);{var g=o=>{var y=E(),u=C(y);ae(u,()=>e.child,()=>({props:r(m)})),l(o,y)},b=o=>{var y=Ii();oi(y,()=>({...r(m)}));var u=p(y);ae(u,()=>e.children??se),w(y),l(o,y)};z(h,o=>{e.child?o(g):o(b,!1)})}l(d,c),J()}const ki=()=>{const d=_i;return{page:{subscribe:d.page.subscribe},navigating:{subscribe:d.navigating.subscribe},updated:d.updated}},Hi={subscribe(d){return ki().page.subscribe(d)}};function Ai(d,e){Y(e,!0);let t=Z(e,"ref",15,null),i=ut(e,["$$slots","$$events","$$legacy","ref","class"]);var a=E(),n=C(a);{let s=$(()=>vi("flex-1 outline-none",e.class));q(n,()=>Ci,(m,c)=>{c(m,Et({"data-slot":"tabs-content",get class(){return r(s)}},()=>i,{get ref(){return t()},set ref(h){t(h)}}))})}l(d,a),J()}class Li{#e=N(K({featureLayerView:null,areaInfos:[]}));get layerHighlightState(){return r(this.#e)}set layerHighlightState(e){_(this.#e,e,!0)}#t=N(null);get lastAddedArea(){return r(this.#t)}set lastAddedArea(e){_(this.#t,e,!0)}#a=N(null);get lastRemovedArea(){return r(this.#a)}set lastRemovedArea(e){_(this.#a,e,!0)}#i=N(null);get currentHoveredArea(){return r(this.#i)}set currentHoveredArea(e){_(this.#i,e,!0)}#r=[];#o=new de;setNameFields(e){console.log("Setting name fields:",e),this.#r=e}setSelectedLayerView(e){this.layerHighlightState?.featureLayerView!==e&&(this.layerHighlightState&&this.layerHighlightState.areaInfos.forEach(t=>{t.handle.remove()}),this.layerHighlightState={featureLayerView:e,areaInfos:[]})}clearSelectedLayerView(){this.layerHighlightState.featureLayerView!==null&&(this.resetSelectedAreas(),this.layerHighlightState.featureLayerView=null)}resetSelectedAreas(){!this.layerHighlightState.featureLayerView&&this.layerHighlightState.areaInfos.length===0||(this.layerHighlightState&&this.layerHighlightState.areaInfos.forEach(e=>{e.handle.remove()}),this.layerHighlightState={featureLayerView:null,areaInfos:[]})}addSelectedArea(e,t){if(console.log("Adding selected area with ID:",e),!this.layerHighlightState){console.warn("SelectedAreasStore: No feature layer view is set.");return}const i={id:e,handle:t};this.layerHighlightState.areaInfos.push(i),this.lastAddedArea=i}removeSelectedArea(e){if(console.log("Removing selected area with ID:",e),!this.layerHighlightState){console.warn("SelectedAreasStore: No feature layer view is set.");return}const t=this.layerHighlightState.areaInfos.findIndex(i=>i.id===e);t!==-1&&(this.lastRemovedArea={id:e,handle:this.layerHighlightState.areaInfos[t].handle},this.layerHighlightState.areaInfos[t].handle.remove(),this.layerHighlightState.areaInfos.splice(t,1))}async getAreaNamesById(e){if(!this.layerHighlightState?.featureLayerView)return[];const t=this.getNameFieldForCurrentLayer();if(!t)return[];const i=this.layerHighlightState.featureLayerView.layer;let a=this.#o.get(i.uid);a||(a=new de,this.#o.set(i.uid,a));const n=new Array(e.length),s=new de,m=[];if(e.forEach((g,b)=>{s.set(g,b);const o=a.get(g);o!==void 0?n[b]=o:m.push(g)}),m.length===0)return n.map(g=>g??"");const c=i.objectIdField,h=await i.queryFeatures({objectIds:m,outFields:[t,c],returnGeometry:!1});for(const g of h.features){const b=g.attributes[c],o=g.attributes[t],y=s.get(b);y!==void 0&&(n[y]=o??"",a.set(b,o??""))}return n.map(g=>g??"")}setHoveredArea(e,t){this.currentHoveredArea&&this.clearHoveredArea(),this.currentHoveredArea={id:e,handle:t}}clearHoveredArea(){this.currentHoveredArea&&(this.currentHoveredArea?.handle.remove(),this.currentHoveredArea=null)}getNameFieldForCurrentLayer(){if(!this.layerHighlightState||!this.layerHighlightState.featureLayerView)return null;const e=this.#r.find(t=>t.layerName===this.layerHighlightState?.featureLayerView?.layer?.title)?.field;return e||(console.warn(`SelectedAreasStore: No name field configured for layer ${this.layerHighlightState.featureLayerView.layer.title}`,this.#r),null)}}const G=new Li;class xi{#e=N(null);get mapView(){return r(this.#e)}set mapView(e){_(this.#e,e,!0)}#t=N(K(new Set));get interactableLayers(){return r(this.#t)}set interactableLayers(e){_(this.#t,e,!0)}pointerMoveHandle=null;clickHandle=null;leaveHandle=null;enterHandle=null;#a=N(!1);get isInitialized(){return r(this.#a)}set isInitialized(e){_(this.#a,e,!0)}#i=N(!0);get pointerInsideMap(){return r(this.#i)}set pointerInsideMap(e){_(this.#i,e,!0)}initializationInProgress=!1;async initializeAsync(e,t){if(console.log("[map-interaction-store] Initializing with MapView"),this.mapView===e&&this.isInitialized){console.log("[map-interaction-store] MapView is already initialized"),this.interactableLayers=t;return}if(this.initializationInProgress){console.log("[map-interaction-store] Initialization already in progress");return}this.initializationInProgress=!0,console.log("[map-interaction-store] Cleaning up previous MapView if any"),this.cleanup(),this.mapView=e,this.interactableLayers=t,await e.when(),this.setupHighlights(e),this.setupPointerMoveHandler(e),this.setupClickHandler(e),this.setupLeaveHandler(e),this.setupEnterHandler(e),this.isInitialized=!0,this.initializationInProgress=!1,console.log("[map-interaction-store] Initialized with MapView")}updateInteractableLayers(e){this.interactableLayers=e}setupHighlights(e){const t={name:"hover",color:"lightgreen",haloOpacity:1,fillOpacity:.2},i={name:"selected",color:"green",haloOpacity:1,fillOpacity:.3};e.highlights.push(t),e.highlights.push(i)}setupPointerMoveHandler(e){this.pointerMoveHandle=e.on("pointer-move",async t=>{if(!this.pointerInsideMap)return;const{results:i}=await e.hitTest(t),a=i[0];if(!a){this.clearHoverHighlight();return}const n=a.graphic,s=n.layer;if(!n||!s||!this.isLayerInteractable(s.id)||n.attributes?.[s.objectIdField]===void 0){this.clearHoverHighlight();return}const m=n.attributes?.[s.objectIdField];if(!(G.currentHoveredArea&&G.currentHoveredArea.id===m))try{const c=await e.whenLayerView(s);G.layerHighlightState.featureLayerView!==c&&G.setSelectedLayerView(c),this.clearHoverHighlight();const h=c;if(!h){console.warn("LayerView is not a FeatureLayerView");return}if(!this.pointerInsideMap)return;const g=h.highlight(n,{name:"hover"});G.setHoveredArea(m,g)}catch(c){console.error("Error in pointer-move handler:",c),this.clearHoverHighlight()}})}setupClickHandler(e){this.clickHandle=e.on("click",async t=>{const{results:i}=await e.hitTest(t),a=i[0];if(!a)return;const n=a.graphic,s=n.layer;if(console.log("Clicked graphic:",n),!n||!s||!this.isLayerInteractable(s.id)||n.attributes?.[s.objectIdField]===void 0)return;const m=n.attributes?.[s.objectIdField];try{const c=await e.whenLayerView(s),h=c;if(!h){console.warn("Layer is not a FeatureLayerView");return}G.layerHighlightState.featureLayerView!==c&&G.setSelectedLayerView(c);const b=(G.layerHighlightState.areaInfos||[]).find(o=>o.id===m);if(b)G.removeSelectedArea(b.id);else{const o=h.highlight(n,{name:"selected"});G.addSelectedArea(m,o)}}catch(c){console.error("Error in click handler:",c)}})}setupLeaveHandler(e){this.leaveHandle=e.on("pointer-leave",()=>{this.pointerInsideMap=!1,this.clearHoverHighlight()})}setupEnterHandler(e){this.enterHandle=e.on("pointer-enter",()=>{this.pointerInsideMap=!0})}isLayerInteractable(e){return this.interactableLayers.has(e)}clearHoverHighlight(){G.currentHoveredArea&&G.clearHoveredArea()}cleanup(){this.pointerMoveHandle&&(this.pointerMoveHandle.remove(),this.pointerMoveHandle=null),this.clickHandle&&(this.clickHandle.remove(),this.clickHandle=null),this.leaveHandle&&(this.leaveHandle.remove(),this.leaveHandle=null),this.enterHandle&&(this.enterHandle.remove(),this.enterHandle=null),this.clearHoverHighlight(),this.isInitialized=!1,this.mapView=null,this.pointerInsideMap=!0,this.interactableLayers=new Set,console.log("[map-interaction-store] Cleaned up")}get currentMapView(){return this.mapView}get initialized(){return this.isInitialized}}const Te=new xi;var Vi=V('<div class="esri-ui-element svelte-xggl6e"><!></div>'),Ni=V('<div class="esri-ui-element svelte-xggl6e"><!></div>'),Ti=V('<div class="map-view svelte-xggl6e"></div> <!> <!>',1);function Mi(d,e){Y(e,!0);const t=Z(e,"webMap",3,null),i=Z(e,"panelPosition",3,"top-left"),a=Z(e,"menuPosition",3,"top-right");let n=null,s=N(null),m=N(null),c=N(null),h=N(!1);const g="streets-vector";let b,o;async function y(){if(!o){const[{default:I},{default:x},{default:D}]=await Promise.all([ge(()=>import("../chunks/BEZFO2vt.js").then(O=>O.M),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36]),import.meta.url),ge(()=>import("../chunks/CZyMpCUL.js").then(O=>O.a2),__vite__mapDeps([37,1,2,3,5,38,39,24,40,21,6,7,41,31,32,42,19,20,43,8,9,10,11,22,44,45,16,46,47,48,49,23,50,51,52,53,12,54,55,56,57,58,59,33,60,61,62,25,63,64,65,66,14,67,0,4,13,15,17,18,26,27,28,29,30,34,35,36,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94]),import.meta.url),ge(()=>import("../chunks/DpAKiq6K.js").then(O=>O.W),__vite__mapDeps([95,1,2,3,5,6,7,0,4,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,38,39,40,41,42,43,96,97,98,69,99,100,78,79,73,47,48,49,50,51,52,53,54,55,56,57,58,59,101,102,103,72,104,44,45,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,71,121,68,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,64,175,176,177,178,179,180]),import.meta.url)]);b=I,o=x}}async function u(I,x){const D=new o({container:x,popupEnabled:!1,map:I});return await D.when(),D}function f(I){I.ui.move("zoom","top-right"),r(m)&&i()&&I.ui.add(r(m),i()),r(c)&&a()&&I.ui.add(r(c),a()),_(h,!0)}async function M(){return new b({basemap:g})}async function L(){if(t())try{if(await y(),await k(),!r(s)){console.error("MapView is not initialized");return}r(s).map=t(),console.log("[uprn-map-view] MapView updated with new webMap")}catch(I){console.error("Error updating MapView with new webMap:",I)}}ee(()=>{t()&&L()});async function k(){if(!n){console.error("Map container element was not found");return}try{_(s,await u(t()??void 0,n),!0),f(r(s)),console.log("[uprn-map-view] Map loaded successfully")}catch(I){console.error("Error loading map:",I),await v()}}async function v(){try{const I=await M();_(s,await u(I,n),!0),f(r(s)),console.log("[uprn-map-view] Fallback map loaded")}catch(I){console.error("Error loading fallback map:",I)}}ee(()=>{if(!r(s)||!e.areaSelectionTreeviewStore.initialized)return;const I=e.areaSelectionTreeviewStore.getNonHiddenNodes().map(x=>x.id);Te.initialized?Te.updateInteractableLayers(new Set(I)):Te.initializeAsync(r(s),new Set(I))});async function S(I){if(!r(s))return;const x=await r(s).whenLayerView(I);if(!x){console.warn("Could not get LayerView for the visible node layer");return}G.setSelectedLayerView(x)}ee(()=>{if(!e.areaSelectionTreeviewStore.initialized)return;if(!e.areaSelectionTreeviewStore.getVisibleNodes().length){G.resetSelectedAreas();return}const I=e.areaSelectionTreeviewStore.getVisibleNodes()[0].layer;if(!I){console.warn("Visible node layer is not a FeatureLayer");return}S(I)});function T(){Te.cleanup(),r(s)&&r(s).destroy()}Ft(()=>{T()});var H=Ti(),j=C(H);Be(j,I=>n=I,()=>n);var F=A(j,2);{var U=I=>{var x=Vi(),D=p(x);{var O=P=>{var W=E(),B=C(W);ae(B,()=>e.panel),l(P,W)};z(D,P=>{r(h)&&P(O)})}w(x),Be(x,P=>_(m,P),()=>r(m)),l(I,x)};z(F,I=>{e.panel&&I(U)})}var R=A(F,2);{var X=I=>{var x=Ni(),D=p(x);{var O=P=>{var W=E(),B=C(W);ae(B,()=>e.menu),l(P,W)};z(D,P=>{r(h)&&P(O)})}w(x),Be(x,P=>_(c,P),()=>r(c)),l(I,x)};z(R,I=>{e.menu&&I(X)})}l(d,H),J()}var Di=V('<div class="tree-node-item svelte-1ehc80l"><!></div>'),Fi=V('<div class="tree-children relative ml-4 w-full svelte-1ehc80l"><div class="tree-guide-line tree-guide-line-animate svelte-1ehc80l"></div> <!></div>'),Pi=V('<div class="w-full"><!>  <!></div>');function ft(d,e){const t=Z(e,"isOpen",3,!1),i=Z(e,"childNodes",3,null);var a=Pi(),n=p(a);ae(n,()=>e.content??se);var s=A(n,2);{var m=c=>{var h=Fi(),g=A(p(h),2);ue(g,19,()=>i()??[],b=>b.id,(b,o,y)=>{var u=Di(),f=p(u);ae(f,()=>e.childNode??se,()=>r(o)),w(u),Q(()=>De(u,`animation-delay: ${100+r(y)*50}ms;`)),l(b,u)}),w(h),l(c,h)};z(s,c=>{t()&&i()&&c(m)})}w(a),l(d,a)}const gt="mb-1 cursor-pointer rounded-md border border-border/30 p-2 text-left",yt="transform-gpu transition-all duration-150 ease-out hover:border-border/50 hover:bg-card/70 hover:shadow-sm",zi="transition-colors hover:bg-card/70",Ye="text-sm font-normal",Je="bg-card/50",mt="bg-accent text-accent-foreground";function Ei(d){const{enhancedHover:e=!1,includeFont:t=!1,pressed:i=!1}=d;let a=gt;return e?a+=" "+yt:a+=" "+zi,t&&(a+=" "+Ye),i?a+=" "+mt:a+=" "+Je,a}const Oi="!h-auto !min-h-9 !whitespace-normal data-[state=on]:!bg-accent data-[state=on]:!text-accent-foreground data-[state=on]:hover:!bg-accent data-[state=on]:hover:!text-accent-foreground";var Gi=V('<div class="flex w-full !items-center !justify-between gap-2"><div class="pointer-events-none !flex min-w-0 flex-1 !items-center gap-1"><span class="inline-block size-4" aria-hidden="true"><!></span> <span class="block w-full text-left break-words"> </span></div> <!></div>'),Ui=V('<button><div class="flex w-full items-center justify-between gap-2"><div class="pointer-events-none flex min-w-0 flex-1 items-center gap-1"><!> <span class="inline-block size-4" aria-hidden="true"><!></span> <span class="block w-full text-left break-words"> </span></div> <!></div></button>');function lt(d,e){const t=`calc(100% - ${e.depth*1}rem)`,i=`${gt} ${yt}`,a=`${i} ${Oi} ${Je} ${Ye}`,n=`${i} ${Ye}`;var s=E(),m=C(s);{var c=g=>{Bt(g,{get pressed(){return e.pressed},get class(){return a},variant:"outline",get style(){return`width: ${t};`},get onPressedChange(){return e.onclick},children:(b,o)=>{var y=Gi(),u=p(y),f=p(u),M=p(f);pe(M,()=>e.icon),w(f);var L=A(f,2),k=p(L,!0);w(L),w(u);var v=A(u,2);ae(v,()=>e.children??se),w(y),Q(()=>re(k,e.name)),l(b,y)},$$slots:{default:!0}})},h=g=>{var b=Ui();b.__click=function(...S){e.onclick?.apply(this,S)};var o=p(b),y=p(o),u=p(y);ht(u,{get isOpen(){return e.isOpen}});var f=A(u,2),M=p(f);pe(M,()=>e.icon),w(f);var L=A(f,2),k=p(L,!0);w(L),w(y);var v=A(y,2);ae(v,()=>e.children??se),w(o),w(b),Q(()=>{He(b,1,`${n} ${e.pressed?mt:Je}`),De(b,`width: ${t};`),re(k,e.name)}),l(g,b)};z(m,g=>{e.isTogglable?g(c):g(h,!1)})}l(d,s)}Ae(["click"]);const wt=(d,e,t,i)=>e?Ri(d,t):t?i?'<path d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/>':'<path d="M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/>':'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14,2 14,8 20,8"/>',Ri=(d,e)=>{switch(d.type){case"group":return at;case"feature":return nt;case"tile":return Wt;default:return e?at:nt}};function bt(d,e){Y(e,!0);const t=f=>{var M=E(),L=C(M);{var k=v=>{var S=E(),T=C(S);{var H=F=>{lt(F,{isTogglable:!1,get pressed(){return r(h)},get icon(){return r(g)},get name(){return e.node.name},get depth(){return a()},onclick:u,get isOpen(){return r(c)}})},j=F=>{lt(F,{isTogglable:!0,get pressed(){return r(h)},get icon(){return r(g)},get name(){return e.node.name},get depth(){return a()},onclick:y,get isOpen(){return r(c)}})};z(T,F=>{m?F(H):F(j,!1)})}l(v,S)};z(L,v=>{e.treeviewConfigStore.getItemConfig(e.node.id)?.isHidden||v(k)})}l(f,M)},i=(f,M=se)=>{var L=E(),k=C(L);{var v=S=>{{let T=$(()=>a()+1);bt(S,{get treeviewConfigStore(){return e.treeviewConfigStore},get node(){return M()},get onNodeClick(){return e.onNodeClick},get onNodeVisibilityChange(){return e.onNodeVisibilityChange},get getNodeVisibility(){return e.getNodeVisibility},get depth(){return r(T)},get useLayerTypeIcon(){return n()}})}};z(k,S=>{m&&r(c)&&!e.treeviewConfigStore.getItemConfig(M().id)?.isHidden&&S(v)})}l(f,L)},a=Z(e,"depth",3,0),n=Z(e,"useLayerTypeIcon",3,!1),s=!!e.node.layer&&"visible"in e.node.layer,m=!!(e.node.children&&e.node.children.length);let c=N(!1),h=N(!1),g=N("");function b(){return!e.node.children||!e.getNodeVisibility?!1:e.node.children.some(f=>{const M=e.getNodeVisibility(f.id);return M!==void 0?M:f.layer.visible})}ee(()=>{if(e.node){if(m)_(h,b(),!0);else{const f=e.getNodeVisibility?e.getNodeVisibility(e.node.id):void 0;_(h,f!==void 0?f:e.node.layer.visible,!0)}_(g,wt(e.node.layer,n(),m,r(c)),!0)}});function o(){!s||!e.onNodeVisibilityChange||m||(_(h,!r(h)),e.onNodeVisibilityChange(e.node,r(h)))}function y(){m||o(),e.onNodeClick?.(e.node)}function u(){_(c,!r(c)),e.onNodeClick?.(e.node)}{let f=$(()=>m?e.node.children:null);ft(d,{get isOpen(){return r(c)},get content(){return t},get childNodes(){return r(f)},get childNode(){return i}})}J()}class pt{#e=N(!1);get initialized(){return r(this.#e)}set initialized(e){_(this.#e,e,!0)}#t=null;#a=N(K([]));#i=$(()=>{const e=new de;return this.#w(r(this.#a),e),e});#r=N(K(new de));#o=N(K(new de));initialize(e,t){if(this.initialized)throw new Error("TreeviewStore is already initialized.");if(this.initialized=!0,!t)throw new Error("TreeviewStore requires a valid TreeviewConfigStore to initialize.");if(this.#t=t,!e)throw new Error("TreeviewStore requires a valid array of layers to initialize.");_(this.#a,this.#u(e),!0)}getNodeById(e){return this.#l(),r(this.#i).get(e)}getNodes(){return this.#l(),r(this.#a)}getVisibleNodes(){this.#l();const e=[];for(const[t,i]of r(this.#r)){if(!i)continue;const a=r(this.#i).get(t);a&&e.push(a)}return e}getNonHiddenNodes(){return this.#l(),this.#d(r(this.#a))}#d(e){this.#l();const t=[];for(const i of e){const a=this.#n(i.id);if(!(a&&a.isHidden)&&(t.push(i),i.children?.length)){const n=this.#d(i.children);t.push(...n)}}return t}getVisibilityState(e){return this.#l(),r(this.#r).get(e)??!1}setVisibilityState(e,t){this.#l();const i=r(this.#i).get(e);if(!i)throw new Error(`Tree node not found for ID: ${e}`);if(r(this.#r).set(e,t),i.layer.visible=t,this.#s(i,t),i.visibilityDependencyIds?.length&&this.#c(i,t),!i.visibilityGroupId)return;const a=i.visibilityGroupId;console.log(`Node ${e} is part of visibility group ${a}`);let n=r(this.#o).get(a);n||(n=[],r(this.#o).set(a,n));const s=this.#f(a);if(!s)throw new Error(`Visibility group config not found for group ID: ${a}`);if(!t){const c=n.indexOf(e);n.splice(c,1);return}const m=c=>{r(this.#r).set(c,!1);const h=r(this.#i).get(c);h&&(h.layer.visible=!1,this.#s(h,!1),h.visibilityDependencyIds?.length&&this.#c(h,!1));const g=n.indexOf(c);g>=0&&n.splice(g,1)};for(;n.length>=s.maxVisibleLayers;){const c=n[0];m(c)}n.push(e),this.#s(i,t),i.visibilityDependencyIds?.length&&this.#c(i,t)}#s(e,t){e.parent&&(r(this.#r).set(e.parent.id,t),e.parent.layer.visible=t,this.#s(e.parent,t))}#c(e,t){if(e.visibilityDependencyIds?.length)for(const i of e.visibilityDependencyIds){const a=r(this.#i).get(i);a&&(r(this.#r).set(i,t),a.layer.visible=t,this.#s(a,t))}}#f(e){if(e&&this.#t)return this.#t.getVisibilityGroupConfig(e)}#u(e){const t=e.map(i=>{const a=this.#n(i.id);return this.#v(i,void 0,a)});return this.#h([...t])}#n(e){if(e&&this.#t)return this.#t.getItemConfig(e)}#h(e){e.reverse();for(const t of e)t.children?.length&&this.#h(t.children);return e}#v(e,t,i){const a={id:e.id,name:e.title,layer:e,visibilityDependencyIds:i?.visibilityDependencyIds,visibilityGroupId:i?.visibilityGroupId,children:[],parent:t};if(e.visible=i?.isVisibleOnInit??!1,r(this.#r).set(e.id,e.visible),this.#b(e)){const n=e;return a.children=n.layers.toArray().map(s=>{const m=this.#g(s,i);return this.#v(s,a,m)}),a}if(this.#y(e)){const n=e;if(n.sublayers&&n.sublayers.length>0){const s=n.sublayers;a.children=s.toArray().map(this.#m)}}return a}#g(e,t){if(!this.#t||!t)return;const i=this.#t.getItemConfig(e.id);return{id:e.id,type:Ie.None,isDownloadable:i?.isDownloadable,isVisibleOnInit:i?.isVisibleOnInit,isHidden:i?.isHidden,visibilityDependencyIds:i?.visibilityDependencyIds??t.visibilityDependencyIds,visibilityGroupId:i?.visibilityGroupId??t.visibilityGroupId}}#y(e){return e.type==="map-image"||e.type==="wms"}#m(e){const t={id:e.uid,name:e.title,layer:e,children:[]};return e.sublayers?.length&&(t.children=e.sublayers.toArray().map(this.#m)),t}#w(e,t){for(const i of e)t.set(i.id,i),i.children?.length&&this.#w(i.children,t)}#b(e){return e.type==="group"}#l(){if(!this.initialized)throw new Error("TreeviewStore is not initialized. Call initialize() first.")}}function ji(d,e){Y(e,!0);const t=Z(e,"webMap",3,null);ee(()=>{!t()||e.treeviewStore.initialized||e.treeviewStore.initialize(t().layers.toArray(),e.treeviewConfigStore)});var i=E(),a=C(i);{var n=s=>{var m=E(),c=C(m);q(c,()=>vt,(h,g)=>{g(h,{children:(b,o)=>{var y=E(),u=C(y);ue(u,17,()=>e.treeviewStore.getNodes(),f=>f.id,(f,M)=>{bt(f,{get treeviewConfigStore(){return e.treeviewConfigStore},get node(){return r(M)},onNodeClick:()=>{},onNodeVisibilityChange:(L,k)=>e.treeviewStore.setVisibilityState(L.id,k),getNodeVisibility:L=>e.treeviewStore.getVisibilityState(L),depth:0,useLayerTypeIcon:!0})}),l(b,y)},$$slots:{default:!0}})}),l(s,m)};z(a,s=>{e.treeviewStore.initialized&&s(n)})}l(d,i),J()}function Bi(d,e){Y(e,!0),ee(()=>{if(!G.lastAddedArea)return;(async()=>{if(G.lastAddedArea===null)return;const i=await G.getAreaNamesById([G.lastAddedArea.id]);!i||i.length===0||!i[0]||le.success(`Area added: ${i?.[0]}`)})()}),ee(()=>{if(!G.lastRemovedArea)return;(async()=>{if(G.lastRemovedArea===null)return;const i=await G.getAreaNamesById([G.lastRemovedArea.id]);!i||i.length===0||!i[0]||le.success(`Area removed: ${i?.[0]}`)})()}),J()}var Wi=V("<!> <!>",1),qi=V("<!> <!>",1);function Xi(d,e){Y(e,!0);const t=Z(e,"triggers",19,()=>[]);var i=E(),a=C(i);q(a,()=>Xt,(n,s)=>{s(n,{get value(){return e.value},get onValueChange(){return e.onValueChange},class:"w-full",children:(m,c)=>{var h=qi(),g=C(h);q(g,()=>qt,(o,y)=>{y(o,{class:"tab-list",children:(u,f)=>{var M=E(),L=C(M);ue(L,17,t,ke,(k,v,S,T)=>{let H=()=>r(v).value,j=()=>r(v).label;var F=Wi(),U=C(F);q(U,()=>Zt,(I,x)=>{x(I,{get value(){return H()},class:"tab-trigger",children:(D,O)=>{ce();var P=me();Q(()=>re(P,j())),l(D,P)},$$slots:{default:!0}})});var R=A(U,2);{var X=I=>{li(I,{class:"separator"})};z(R,I=>{H()!==t()[t().length-1]?.value&&I(X)})}l(k,F)}),l(u,M)},$$slots:{default:!0}})});var b=A(g,2);ae(b,()=>e.children??se),l(m,h)},$$slots:{default:!0}})}),l(d,i),J()}var Zi=V('<div class="min-w-0 space-y-2 overflow-hidden p-4"><!></div>'),Qi=V("<!> <!>",1);function Me(d,e){var t=E(),i=C(t);q(i,()=>Ai,(a,n)=>{n(a,{get value(){return e.value},class:"w-full",children:(s,m)=>{var c=E(),h=C(c);q(h,()=>Ke,(g,b)=>{b(g,{class:"w-full overflow-hidden",children:(o,y)=>{var u=Qi(),f=C(u);q(f,()=>$e,(k,v)=>{v(k,{class:"card-content overflow-hidden p-0",children:(S,T)=>{gi(S,{class:"h-[400px] w-full",children:(H,j)=>{var F=Zi(),U=p(F);ae(U,()=>e.children??se),w(F),l(H,F)},$$slots:{default:!0}})},$$slots:{default:!0}})});var M=A(f,2);{var L=k=>{var v=E(),S=C(v);q(S,()=>fi,(T,H)=>{H(T,{class:"flex items-center justify-between",children:(j,F)=>{var U=E(),R=C(U);ae(R,()=>e.footer),l(j,U)},$$slots:{default:!0}})}),l(k,v)};z(M,k=>{e.footer&&k(L)})}l(o,u)},$$slots:{default:!0}})}),l(s,c)},$$slots:{default:!0}})}),l(d,t)}class Yi{#e=N(!1);get isLoaded(){return r(this.#e)}set isLoaded(e){_(this.#e,e,!0)}#t=N(null);get data(){return r(this.#t)}set data(e){_(this.#t,e,!0)}#a=$(()=>{const e=new de;function t(i){e.set(i.id,i),i.type==="group"&&i.layers.forEach(n=>{t(n)})}return this.data&&this.data.layers.forEach(i=>{t(i)}),e});get dataLookup(){return r(this.#a)}set dataLookup(e){_(this.#a,e)}#i=N(!1);get loading(){return r(this.#i)}set loading(e){_(this.#i,e,!0)}#r=N(null);get error(){return r(this.#r)}set error(e){_(this.#r,e,!0)}async initializeAsync(e){if(!this.data){this.loading=!0,this.error=null;try{const{portalUrl:t,itemId:i,proxy:a}=e;await this.configurePortalAsync(t,a),await this.loadwebmapAsync(i)}catch(t){console.error("Error initializing webmap:",t),this.error=t.message}finally{this.loading=!1}}}async configurePortalAsync(e,t){if(!e)return;const i=await $i();if(i.portalUrl=e,console.log(i),!t)return;const{addProxyRule:a}=await er();console.log("Adding proxy rule for portal traffic"),a({urlPrefix:t?.urlPrefix,proxyUrl:t?.proxyUrl})}async loadwebmapAsync(e){if(this.data)return;const[t,i]=await Promise.all([Ji(),Ki()]),a=new i({id:e}),n=new t({portalItem:a});this.data=n,await this.data.when(),this.data.loaded&&(this.isLoaded=!0)}clear(){this.data=null,this.loading=!1,this.error=null}clearError(){this.error=null}getWebmap(){return this.data}}let qe=null,Xe=null,Ze=null,Qe=null;async function Ji(){return qe||(qe=ge(()=>import("../chunks/DpAKiq6K.js").then(d=>d.W),__vite__mapDeps([95,1,2,3,5,6,7,0,4,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,38,39,40,41,42,43,96,97,98,69,99,100,78,79,73,47,48,49,50,51,52,53,54,55,56,57,58,59,101,102,103,72,104,44,45,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,71,121,68,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,64,175,176,177,178,179,180]),import.meta.url).then(d=>d.default)),qe}async function Ki(){return Xe||(Xe=ge(()=>import("../chunks/EmFT8XhJ.js"),__vite__mapDeps([15,5,1,2,3,6,7,10]),import.meta.url).then(d=>d.default)),Xe}async function $i(){return Ze||(Ze=ge(()=>import("../chunks/CEBETtrS.js").then(d=>d.a4),[],import.meta.url).then(d=>d.default)),Ze}async function er(){return Qe||(Qe=ge(()=>import("../chunks/D0nkGZIM.js").then(d=>d.O),__vite__mapDeps([7,2,3]),import.meta.url)),Qe}class tr{#e=N(K(new de));get DataSelections(){return r(this.#e)}set DataSelections(e){_(this.#e,e,!0)}addSelection(e){this.DataSelections.set(e.layerId,e),le.success(`'${e.name}' Added`)}removeSelection(e){const t=this.DataSelections.get(e);this.DataSelections.delete(e),le.success(`'${t?.name}' Removed`)}}const ie=new tr;function ir(d,e){d.stopPropagation(),e.onFilterClicked?.(e.layerId)}var rr=V("<button><!></button>");function _t(d,e){Y(e,!0);let t=N(K(e.hasFiltersApplied?.(e.layerId)??!1));ee(()=>{_(t,e.hasFiltersApplied?.(e.layerId)??!1,!0)});const i=$(()=>r(t)?Qt:Yt);var a=rr();let n;a.__click=[ir,e];var s=p(a);pe(s,()=>r(i)),w(a),Q(m=>{n=He(a,1,"filter-btn svelte-effqed",null,n,m),ye(a,"aria-pressed",r(t))},[()=>({active:r(t)})]),l(d,a),J()}Ae(["click"]);class ar{#e=N(null);get ActiveLayer(){return r(this.#e)}set ActiveLayer(e){_(this.#e,e,!0)}}var nr=V('<li class="area-item svelte-1eawb4y"><span class="area-name svelte-1eawb4y"> </span> <!></li>'),or=V('<ul class="selected-list svelte-1eawb4y"></ul> <p class="count svelte-1eawb4y"> </p>',1),sr=V('<p class="no-selection svelte-1eawb4y">No areas selected</p>'),lr=V('<li class="data-item svelte-1eawb4y"><span class="data-name svelte-1eawb4y"> </span> <div class="data-actions svelte-1eawb4y"><!> <!></div></li>'),dr=V('<ul class="selected-list svelte-1eawb4y"></ul> <p class="count svelte-1eawb4y"> </p>',1),cr=V('<p class="no-selection svelte-1eawb4y">No data selected</p>'),ur=V('<h2 class="svelte-1eawb4y">Export Options</h2> <div class="section svelte-1eawb4y"><h3 class="svelte-1eawb4y"> </h3> <h4 class="svelte-1eawb4y">Selected Areas</h4> <!></div> <div class="section svelte-1eawb4y"><h4 class="svelte-1eawb4y">Selected Data</h4> <!></div>',1);function hr(d,e){Y(e,!0);const t=Z(e,"fieldFilterMenuStore",7);let i=N(K([]));ee(()=>{if(!G.layerHighlightState.areaInfos.length){_(i,[],!0);return}(async()=>{const S=await G.getAreaNamesById(G.layerHighlightState.areaInfos.map(H=>H.id)),T=[];for(let H=0;H<S.length;H++)T.push({name:S[H]||"Unknown Area",HighlightAreaInfo:G.layerHighlightState.areaInfos[H]});_(i,T,!0)})()});function a(v){const S=r(i).findIndex(T=>T.name===v);S!==-1&&G.removeSelectedArea(r(i)[S]?.HighlightAreaInfo.id)}function n(v){console.log("[export-menu] Removing data selection for layerId:",v),ie.DataSelections.delete(v),console.log("[export-menu] Current SelectedData:",yi(ie.DataSelections))}function s(v){t().ActiveLayer?.id===v?t().ActiveLayer=null:t().ActiveLayer=e.webMapStore.dataLookup.get(v)}function m(v){const S=ie.DataSelections.get(v);return!(!S||!S.fields||S.fields.size===0||S.fields.size===e.webMapStore.dataLookup.get(v).fields?.length)}var c=ur(),h=A(C(c),2),g=p(h),b=p(g,!0);w(g);var o=A(g,4);{var y=v=>{var S=or(),T=C(S);ue(T,21,()=>r(i),ke,(F,U)=>{var R=nr(),X=p(R),I=p(X,!0);w(X);var x=A(X,2);fe(x,{variant:"ghost",size:"sm",class:"area-remove-btn",onclick:()=>a(r(U).name),children:(D,O)=>{ce();var P=me("Ã—");l(D,P)},$$slots:{default:!0}}),w(R),Q(()=>re(I,r(U).name)),l(F,R)}),w(T);var H=A(T,2),j=p(H);w(H),Q(()=>re(j,`${r(i).length??""} area(s) selected`)),l(v,S)},u=v=>{var S=sr();l(v,S)};z(o,v=>{r(i).length>0?v(y):v(u,!1)})}w(h);var f=A(h,2),M=A(p(f),2);{var L=v=>{var S=dr(),T=C(S);ue(T,21,()=>[...ie.DataSelections.values()],ke,(F,U)=>{var R=lr(),X=p(R),I=p(X,!0);w(X);var x=A(X,2),D=p(x);{var O=W=>{_t(W,{get layerId(){return r(U).layerId},onFilterClicked:s,hasFiltersApplied:m})};z(D,W=>{r(U).fields&&W(O)})}var P=A(D,2);fe(P,{variant:"ghost",size:"sm",class:"data-remove-btn",onclick:()=>n(r(U).layerId),children:(W,B)=>{ce();var ne=me("Ã—");l(W,ne)},$$slots:{default:!0}}),w(x),w(R),Q(()=>re(I,r(U).name)),l(F,R)}),w(T);var H=A(T,2),j=p(H);w(H),Q(()=>re(j,`${ie.DataSelections.size??""} data layer(s) selected`)),l(v,S)},k=v=>{var S=cr();l(v,S)};z(M,v=>{ie.DataSelections.size>0?v(L):v(k,!1)})}w(f),Q(v=>re(b,v),[()=>e.areaSelectionTreeviewStore.initialized?e.areaSelectionTreeviewStore.getVisibleNodes()[0]?.name:"Loading..."]),l(d,c),J()}class vr{#e=N(K([]));get downloads(){return r(this.#e)}set downloads(e){_(this.#e,e,!0)}}const be=new vr;var fr=V('<p class="text-sm text-muted-foreground">Click "Export" to begin the download.</p> <!>',1);function gr(d,e){Y(e,!0);const t=()=>Gt(Hi,"$page",i),[i,a]=Ot();function n(){if(G.layerHighlightState.areaInfos.length<=0){le.error("Please select at least one area to export.");return}if(ie.DataSelections.size<=0){le.error("Please select at least one data layer to export.");return}console.log("Starting export..."),le.info("Export started successfully.",{duration:4e3});const c=crypto.randomUUID();be.downloads.push({id:c,url:`${t().url}/${c}`,status:"pending"}),e.onExportSuccess?.()}var s=fr(),m=A(C(s),2);fe(m,{onclick:n,children:(c,h)=>{ce();var g=me("Export");l(c,g)},$$slots:{default:!0}}),l(d,s),J(),a()}var yr=V('<p class="text-sm font-medium"> </p>'),mr=V('<div class="pointer-events-none fixed z-50 transition-opacity duration-200"><!></div>');function wr(d,e){Y(e,!0);let t=N(null),i=N(K({x:0,y:0})),a=0;const n=h=>{_(i,{x:h.clientX,y:h.clientY},!0)};ee(()=>(document.addEventListener("mousemove",n),()=>{document.removeEventListener("mousemove",n)})),ee(()=>{const h=G.currentHoveredArea?.id,g=++a;if(!h){_(t,null);return}(async()=>{const b=await G.getAreaNamesById([h]);g===a&&G.currentHoveredArea?.id===h&&_(t,b[0]??null,!0)})()});var s=E(),m=C(s);{var c=h=>{var g=mr(),b=p(g);q(b,()=>Ke,(o,y)=>{y(o,{class:"max-w-xs border !py-2 shadow-lg",children:(u,f)=>{var M=E(),L=C(M);q(L,()=>$e,(k,v)=>{v(k,{class:"!px-3 !py-0",children:(S,T)=>{var H=yr(),j=p(H,!0);w(H),Q(()=>re(j,r(t))),l(S,H)},$$slots:{default:!0}})}),l(u,M)},$$slots:{default:!0}})}),w(g),Q(()=>De(g,`left: ${r(i).x+10}px; top: ${r(i).y-10}px;`)),l(h,g)};z(m,h=>{r(t)&&h(c)})}l(d,s),J()}function br(d,e){d.target===d.currentTarget&&e()}var pr=(d,e)=>d.key==="Escape"&&e(),_r=(d,e,t)=>e(r(t).name),Sr=V('<div class="info-icon-container svelte-18b92yu"><!></div>'),Ir=V('<div class="field-content-wrapper svelte-18b92yu"><!> <button class="field-content svelte-18b92yu" tabindex="0"><div class="field-name-container svelte-18b92yu"><span class="field-name svelte-18b92yu"> </span> <!></div></button></div>'),Cr=V('<div class="master-checkbox-container svelte-18b92yu"><!> <span class="master-checkbox-label svelte-18b92yu">Select All Fields</span></div> <!> <!>',1),kr=V("<!> <!>",1),Hr=V("<!> <!>",1),Ar=V('<button class="close-button svelte-18b92yu" aria-label="Close"><!></button> <!>',1),Lr=V('<div class="card-container svelte-18b92yu" role="dialog" aria-modal="true" tabindex="-1"><!></div>');function xr(d,e){Y(e,!0);const t=Z(e,"fieldFilterMenuStore",7);let i=N(null),a=N(K(new Ce)),n=$(()=>{if(!r(i)||!r(i).fields)return{checked:!1,indeterminate:!1};const u=r(i).fields.length,f=r(a)?.size||0;return f===0?{checked:!1,indeterminate:!1}:f===u?{checked:!0,indeterminate:!1}:{checked:!1,indeterminate:!0}});ee(()=>{console.log("Active Layer to Filter:",t().ActiveLayer);const u=t().ActiveLayer;if(_(i,u,!0),u){const f=ie.DataSelections.get(u.id);f?.fields?_(a,new Ce([...f.fields]),!0):_(a,new Ce,!0)}});function s(){m(),t().ActiveLayer=null}function m(){if(!r(i))return;let u=ie.DataSelections.get(r(i).id);if(u){if((u.fields===void 0||u.fields===null)&&(u.fields=new Ce),r(a).size===0){ie.removeSelection(r(i).id);return}u.fields.clear(),r(a).forEach(f=>{u.fields?.add(f)})}}function c(u){r(i)&&(r(a).has(u)?r(a).delete(u):r(a).add(u))}function h(){if(!r(i)?.fields)return;(r(a)?.size||0)===0?r(i).fields.forEach(f=>{r(a).add(f.name)}):r(a).clear()}function g(){return r(i)?.fields?r(i).fields.filter(u=>!e.fieldsToHide?.has(u.alias?.toLowerCase()??"")):[]}var b=E(),o=C(b);{var y=u=>{var f=Lr();f.__click=[br,s],f.__keydown=[pr,s];var M=p(f);q(M,()=>Ke,(L,k)=>{k(L,{class:"command-card",children:(v,S)=>{var T=Ar(),H=C(T);H.__click=s;var j=p(H);di(j,{size:20}),w(H);var F=A(H,2);q(F,()=>$e,(U,R)=>{R(U,{class:"card-content",children:(X,I)=>{var x=E(),D=C(x);q(D,()=>mi,(O,P)=>{P(O,{children:(W,B)=>{var ne=Hr(),te=C(ne);q(te,()=>ci,(he,ve)=>{ve(he,{placeholder:"Search for fields..."})});var _e=A(te,2);q(_e,()=>wi,(he,ve)=>{ve(he,{children:(we,Fe)=>{var Le=kr(),xe=C(Le);q(xe,()=>bi,(Pe,ze)=>{ze(Pe,{children:(Ee,Ct)=>{ce();var Ve=me("No results found.");l(Ee,Ve)},$$slots:{default:!0}})});var It=A(xe,2);q(It,()=>ui,(Pe,ze)=>{ze(Pe,{heading:"Fields",children:(Ee,Ct)=>{var Ve=Cr(),Oe=C(Ve),kt=p(Oe);ot(kt,{get checked(){return r(n).checked},get indeterminate(){return r(n).indeterminate},onCheckedChange:h}),ce(2),w(Oe);var et=A(Oe,2);q(et,()=>Jt,(Ge,oe)=>{oe(Ge,{})});var Ht=A(et,2);ue(Ht,17,g,ke,(Ge,oe)=>{var tt=E(),At=C(tt);q(At,()=>pi,(Lt,xt)=>{xt(Lt,{class:"field-item",onselect:()=>c(r(oe).name),children:(Vt,Qr)=>{var Ue=Ir(),it=p(Ue);{let Se=$(()=>r(a)?.has(r(oe).name)??!1);ot(it,{class:"field-checkbox",get checked(){return r(Se)},onCheckedChange:()=>c(r(oe).name)})}var Re=A(it,2);Re.__click=[_r,c,oe];var rt=p(Re),je=p(rt),Nt=p(je,!0);w(je);var Tt=A(je,2);{var Mt=Se=>{var Ne=Sr(),Dt=p(Ne);pe(Dt,()=>Kt),w(Ne),Q(()=>ye(Ne,"title",r(oe).description)),l(Se,Ne)};z(Tt,Se=>{r(oe).description&&Se(Mt)})}w(rt),w(Re),w(Ue),Q(()=>re(Nt,r(oe).alias||r(oe).name)),l(Vt,Ue)},$$slots:{default:!0}})}),l(Ge,tt)}),l(Ee,Ve)},$$slots:{default:!0}})}),l(we,Le)},$$slots:{default:!0}})}),l(W,ne)},$$slots:{default:!0}})}),l(X,x)},$$slots:{default:!0}})}),l(v,T)},$$slots:{default:!0}})}),w(f),l(u,f)};z(o,u=>{r(i)&&u(y)})}l(d,b),J()}Ae(["click","keydown"]);var Vr=V('<li class="download-item svelte-ynwhdm"><div class="download-info svelte-ynwhdm"><span class="download-url svelte-ynwhdm"> </span></div> <div class="download-actions svelte-ynwhdm"><div><!></div> <!> <!> <!></div></li>'),Nr=V('<ul class="selected-list svelte-ynwhdm"></ul> <p class="count svelte-ynwhdm"> </p>',1),Tr=V('<p class="no-selection svelte-ynwhdm">No downloads in queue</p>'),Mr=V('<div class="section svelte-ynwhdm"><h4 class="svelte-ynwhdm">Download Queue</h4> <!></div>');function Dr(d,e){Y(e,!0);let t=N(K(new Set));function i(o){const y=be.downloads.findIndex(u=>u.url===o);y!==-1&&be.downloads.splice(y,1)}async function a(o){try{await navigator.clipboard.writeText(o),_(t,new Set(r(t)).add(o),!0),le.success("URL copied to clipboard"),setTimeout(()=>{const y=new Set(r(t));y.delete(o),_(t,y,!0)},2e3)}catch(y){console.error("Failed to copy URL:",y),le.error("Failed to copy URL to clipboard")}}function n(o){switch(o){case"completed":return"#059669";case"in-progress":return"#2563eb";case"failed":return"#dc2626";case"pending":default:return"#6b7280"}}function s(o){switch(o){case"completed":return"Completed";case"in-progress":return"In Progress";case"failed":return"Failed";case"pending":default:return"Pending"}}function m(o){switch(o){case"completed":return ri;case"in-progress":return ii;case"failed":return ti;case"pending":default:return Si}}var c=Mr(),h=A(p(c),2);{var g=o=>{var y=Nr(),u=C(y);ue(u,21,()=>be.downloads,ke,(L,k)=>{var v=Vr(),S=p(v),T=p(S),H=p(T,!0);w(T),w(S);var j=A(S,2),F=p(j),U=p(F);{let D=$(()=>n(r(k).status));fe(U,{variant:"ghost",size:"sm",class:"download-status-btn",get style(){return`color: ${r(D)??""}`},disabled:!0,children:(O,P)=>{const W=$(()=>m(r(k).status));var B=E(),ne=C(B);{let te=$(()=>r(k).status==="in-progress"?"spinning":"");q(ne,()=>r(W),(_e,he)=>{he(_e,{size:14,get class(){return r(te)}})})}l(O,B)},$$slots:{default:!0}})}w(F);var R=A(F,2);fe(R,{variant:"ghost",size:"sm",class:"download-clipboard-btn",onclick:()=>a(r(k).url),title:"Copy URL to clipboard",children:(D,O)=>{var P=E(),W=C(P);{var B=te=>{$t(te,{size:14})},ne=te=>{ei(te,{size:14})};z(W,te=>{r(t).has(r(k).url)?te(B):te(ne,!1)})}l(D,P)},$$slots:{default:!0}});var X=A(R,2);{var I=D=>{fe(D,{variant:"ghost",size:"sm",class:"download-action-btn",onclick:()=>window.open(r(k).url,"_blank"),title:"Open download",children:(O,P)=>{ce();var W=me("ðŸ“¥");l(O,W)},$$slots:{default:!0}})};z(X,D=>{r(k).status==="completed"&&D(I)})}var x=A(X,2);fe(x,{variant:"ghost",size:"sm",class:"download-remove-btn",onclick:()=>i(r(k).url),title:"Remove from queue",children:(D,O)=>{ce();var P=me("Ã—");l(D,P)},$$slots:{default:!0}}),w(j),w(v),Q(D=>{ye(T,"title",r(k).url),re(H,r(k).id),ye(F,"title",D)},[()=>s(r(k).status)]),l(L,v)}),w(u);var f=A(u,2),M=p(f);w(f),Q(()=>re(M,`${be.downloads.length??""} download(s) in queue`)),l(o,y)},b=o=>{var y=Tr();l(o,y)};z(h,o=>{be.downloads.length>0?o(g):o(b,!1)})}w(c),l(d,c),J()}var Fr=V('<button><div class="flex w-full items-center justify-between gap-2"><div class="pointer-events-none flex min-w-0 flex-1 items-center gap-1"><!> <span class="inline-block size-4" aria-hidden="true"><!></span> <span class="block w-full text-left break-words"> </span></div> <!></div></button>');function dt(d,e){Y(e,!0);const t=Z(e,"isGroup",3,!1),i=Z(e,"isOpen",3,!1),a=`calc(100% - ${e.depth*1}rem)`;var n=Fr();n.__click=function(...f){e.onclick?.apply(this,f)};var s=p(n),m=p(s),c=p(m);{var h=f=>{ht(f,{get isOpen(){return i()}})};z(c,f=>{t()&&f(h)})}var g=A(c,2),b=p(g);pe(b,()=>e.icon),w(g);var o=A(g,2),y=p(o,!0);w(o),w(m);var u=A(m,2);ae(u,()=>e.children??se),w(s),w(n),Q(f=>{He(n,1,f),De(n,`width: ${a};`),re(y,e.name)},[()=>si(Ei({enhancedHover:!0,includeFont:!0}))]),l(d,n),J()}Ae(["click"]);const Pr='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-down-to-line-icon lucide-arrow-down-to-line"><path d="M12 17V3"/><path d="m6 11 6 6 6-6"/><path d="M19 21H5"/></svg>';function zr(d,e,t){d.stopPropagation(),_(e,!r(e)),t.onDownloadStateChanged?.(t.node,r(e))}var Er=V("<button><!></button>");function Or(d,e){Y(e,!0);let t=N(K(e.getDownloadState?.(e.node)??!1));ee(()=>{if(e.getDownloadState){const s=e.getDownloadState(e.node);_(t,s??!1,!0)}});var i=Er();let a;i.__click=[zr,t,e];var n=p(i);pe(n,()=>Pr),w(i),Q(s=>{a=He(i,1,"download-btn svelte-1gynj9v",null,a,s),ye(i,"title",`Download ${e.node.name??""}`),ye(i,"aria-label",`Download ${e.node.name??""}`),ye(i,"aria-pressed",r(t))},[()=>({active:r(t)})]),l(d,i),J()}Ae(["click"]);var Gr=V('<div class="flex items-center gap-2"><!></div>'),Ur=V("<div><!></div>"),Rr=V("<!> <!>",1),jr=V('<div class="flex items-center gap-2"><!> <!></div>');function St(d,e){Y(e,!0);const t=L=>{var k=E(),v=C(k);{var S=T=>{var H=E(),j=C(H);{var F=R=>{dt(R,{get icon(){return r(b)},get name(){return e.node.name},get depth(){return n()},onclick:M,isGroup:!0,get isOpen(){return r(h)},children:I=>{var x=Gr(),D=p(x);{var O=P=>{st(P,{get checked(){return r(g)},onCheckedChange:u})};z(D,P=>{c&&P(O)})}w(x),l(I,x)},$$slots:{default:!0}})},U=R=>{dt(R,{get icon(){return r(b)},get name(){return e.node.name},get depth(){return n()},onclick:f,isGroup:!1,children:I=>{var x=jr(),D=p(x);{var O=B=>{var ne=Rr(),te=C(ne);{var _e=ve=>{var we=Ur();let Fe;var Le=p(we);_t(Le,{get layerId(){return e.node.id},get onFilterClicked(){return e.onFilterClicked},get hasFiltersApplied(){return e.hasFiltersApplied}}),w(we),Q(xe=>Fe=He(we,1,"filter-transition-wrapper svelte-42m3ms",null,Fe,xe),[()=>({"fade-in":!r(y),"fade-out":r(y)})]),l(ve,we)};z(te,ve=>{r(o)&&ve(_e)})}var he=A(te,2);Or(he,{get node(){return e.node},get onDownloadStateChanged(){return e.onDownloadStateChanged},get getDownloadState(){return e.getDownloadState}}),l(B,ne)};z(D,B=>{e.isDownloadable&&B(O)})}var P=A(D,2);{var W=B=>{st(B,{get checked(){return r(g)},onCheckedChange:u})};z(P,B=>{c&&B(W)})}w(x),l(I,x)},$$slots:{default:!0}})};z(j,R=>{m?R(F):R(U,!1)})}l(T,H)};z(v,T=>{a()?.getItemConfig(e.node.id)?.isHidden||T(S)})}l(L,k)},i=(L,k=se)=>{var v=E(),S=C(v);{var T=H=>{{let j=$(()=>a()?.getItemConfig(k().id)?.isDownloadable??!0),F=$(()=>n()+1);St(H,{get node(){return k()},get isDownloadable(){return r(j)},get onNodeClick(){return e.onNodeClick},get onNodeVisibilityChange(){return e.onNodeVisibilityChange},get onDownloadStateChanged(){return e.onDownloadStateChanged},get getDownloadState(){return e.getDownloadState},get onFilterClicked(){return e.onFilterClicked},get hasFiltersApplied(){return e.hasFiltersApplied},get getNodeVisibility(){return e.getNodeVisibility},get depth(){return r(F)},get useLayerTypeIcon(){return s()}})}};z(S,H=>{m&&r(h)&&!a()?.getItemConfig(k().id)?.isHidden&&H(T)})}l(L,v)},a=Z(e,"treeviewConfigStore",3,null),n=Z(e,"depth",3,0),s=Z(e,"useLayerTypeIcon",3,!1),m=!!(e.node.children&&e.node.children.length),c=!!e.node.layer&&"visible"in e.node.layer&&!m;let h=N(!1),g=N(!1),b=N(""),o=N(!1),y=N(!1);ee(()=>{if(!e.node)return;const L=e.getNodeVisibility?e.getNodeVisibility(e.node.id):void 0;_(g,L!==void 0?L:e.node.layer.visible,!0),_(b,wt(e.node.layer,s(),m,r(h)),!0)}),ee(()=>{const L=(e.getDownloadState?.(e.node)&&e.node.layer.type==="feature")??!1;L&&!r(o)?(_(o,!0),_(y,!1)):!L&&r(o)&&(_(y,!0),setTimeout(()=>{_(o,!1),_(y,!1)},180))});function u(){!c||!e.onNodeVisibilityChange||(_(g,!r(g)),e.onNodeVisibilityChange(e.node,r(g)))}function f(){e.onNodeClick?.(e.node)}function M(){_(h,!r(h)),e.onNodeClick?.(e.node)}{let L=$(()=>m?e.node.children:null);ft(d,{get isOpen(){return r(h)},get content(){return t},get childNodes(){return r(L)},get childNode(){return i}})}J()}function Br(d,e){Y(e,!0);const t=Z(e,"webMap",3,null),i=Z(e,"fieldFilterMenuStore",7),a=new pt;ee(()=>{if(!t()||a.initialized)return;(async()=>{a.initialize(t().layers.toArray(),e.treeviewConfigStore),console.log("TreeView initialized with layers:",a.getNodes())})()});function n(o,y){if(y){const u={layerId:o.id,name:o.layer.title||"",fields:new Ce(o.layer.fields?.map(f=>f.name)||[])};ie.addSelection(u)}else ie.removeSelection(o.id)}function s(o){return ie.DataSelections.has(o.id)}function m(o){if(i().ActiveLayer?.uid===o)i().ActiveLayer=null;else{const u=a.getNodeById(o)?.layer;i().ActiveLayer=u}}function c(o){const y=ie.DataSelections.get(o);if(!y?.fields)return!1;const u=a.getNodeById(o);if(!u)return!1;const f=u.layer.fields?.length||0,M=y.fields.size;return M>0&&M!==f}var h=E(),g=C(h);{var b=o=>{var y=E(),u=C(y);q(u,()=>vt,(f,M)=>{M(f,{children:(L,k)=>{var v=E(),S=C(v);ue(S,17,()=>a.getNodes(),T=>T.id,(T,H)=>{{let j=$(()=>e.treeviewConfigStore.getItemConfig(r(H).id)?.isDownloadable??!1);St(T,{get treeviewConfigStore(){return e.treeviewConfigStore},get node(){return r(H)},get isDownloadable(){return r(j)},onNodeClick:()=>{},onNodeVisibilityChange:(F,U)=>a.setVisibilityState(F.id,U),getNodeVisibility:F=>a.getVisibilityState(F),onDownloadStateChanged:n,getDownloadState:s,onFilterClicked:m,hasFiltersApplied:c,depth:0,useLayerTypeIcon:!0})}}),l(L,v)},$$slots:{default:!0}})}),l(o,y)};z(g,o=>{a.initialized&&o(b)})}l(d,h),J()}class ct{#e=[];#t=new Map;#a=[];#i=new Map;#r=[];#o=new Map;#d=new Set;constructor(e){if(!e)throw new Error("TreeviewConfigStore requires a valid configuration object.");this.#e=e.items??[],this.#t=new Map(this.#e.map(t=>[t.id,t])),this.#a=e.visibilityGroups??[],this.#i=new Map(this.#a.map(t=>[t.id,t])),this.#r=e.inheritanceGroups??[],this.#o=new Map(this.#r.map(t=>[t.id,t])),e.fieldsToHide&&(this.#d=new Set(e.fieldsToHide.map(t=>t.trim().toLowerCase())))}getItemConfig(e){return this.#t.get(e)}getVisibilityGroupConfig(e){return this.#i.get(e)}getInheritanceGroupConfig(e){return this.#o.get(e)}resolveInheritance(e){if(!(e.length===0||!this.#e||this.#e.length===0))for(const t of e)this.#s(t)}#s(e,t){const i=this.#c(e,t);if(this.#y(e)&&i.showFields){const a=e;a.loaded||console.warn(`Layer not loaded: ${e.id}`);for(const n of a.fields??[])this.#f(this.#v(e.id,n.name),n.alias||n.name,i)}if(this.#g(e)){const a=e;for(const n of a.layers.toArray())this.#s(n,i)}}#c(e,t){const i=this.#u(e.id,t);return i.type===Ie.None&&(i.type=ai(e)),i}#f(e,t,i){const a=this.#u(e,i);return a.type===Ie.None&&(a.type=Ie.Field),this.#d.has(t.trim().toLowerCase())&&(a.isHidden=!0),a}#u(e,t){let i=this.getItemConfig(e);const a=i!==void 0,n=i?.inheritanceGroupId?this.getInheritanceGroupConfig(i.inheritanceGroupId):this.getInheritanceGroupConfig(t?.inheritanceGroupId??"");return i={id:e,type:Ie.None,isDownloadable:this.#n(n,"isDownloadable",i,t,!0),isVisibleOnInit:this.#n(n,"isVisibleOnInit",i,t,!1),isHidden:this.#n(n,"isHidden",i,t,!1),showFields:this.#n(n,"showFields",i,t,!1),visibilityDependencyIds:this.#n(n,"visibilityDependencyIds",i,t,[]),visibilityGroupId:this.#n(n,"visibilityGroupId",i,t,void 0),inheritanceGroupId:this.#n(n,"inheritanceGroupId",i,t,void 0)},a===!1&&this.#h(i),i}#n(e,t,i,a,n){const s=i?.[t];return s!==void 0?s:e?.inheritedProperties.includes(t)&&a?a[t]??n:n}#h(e){if(this.#t.has(e.id))throw new Error(`Item with id ${e.id} already exists.`);this.#e.push(e),this.#t.set(e.id,e)}#v(e,t){return`${e}-${t}`}#g(e){return e.type==="group"}#y(e){return e.type==="feature"}}const Wr=[{value:"define-areas",label:"Define Areas"},{value:"select-data",label:"Select Data"},{value:"export",label:"Export"},{value:"downloads",label:"Download"}];var qr=V("<!> <!> <!> <!>",1),Xr=V('<div class="flex w-120 min-w-0 flex-col gap-6"><!></div>'),Zr=V('<!> <!> <!> <!> <div class="map-section svelte-zapjb6"><!></div>',1);function pa(d,e){Y(e,!0);const t=v=>{var S=Xr(),T=p(S);Xi(T,{get value(){return r(s)},get triggers(){return Wr},onValueChange:g,children:(H,j)=>{var F=qr(),U=C(F);Me(U,{value:"define-areas",children:(x,D)=>{var O=E(),P=C(O);{var W=B=>{ji(B,{get webMap(){return i.data},get treeviewStore(){return n},get treeviewConfigStore(){return r(h)}})};z(P,B=>{i.isLoaded&&B(W)})}l(x,O)}});var R=A(U,2);Me(R,{value:"select-data",children:(x,D)=>{var O=E(),P=C(O);{var W=B=>{Br(B,{get webMap(){return i.data},get treeviewConfigStore(){return r(c)},get fieldFilterMenuStore(){return a}})};z(P,B=>{i.isLoaded&&B(W)})}l(x,O)}});var X=A(R,2);Me(X,{value:"export",footer:D=>{gr(D,{onExportSuccess:b})},children:(D,O)=>{hr(D,{get webMapStore(){return i},get areaSelectionTreeviewStore(){return n},get fieldFilterMenuStore(){return a}})}});var I=A(X,2);Me(I,{value:"downloads",children:(x,D)=>{Dr(x,{})}}),l(H,F)},$$slots:{default:!0}}),w(S),l(v,S)},i=K(new Yi),a=K(new ar),n=K(new pt);let s=N("define-areas"),m=N(K(new Set)),c=N(void 0),h=N(void 0);Pt(async()=>{const v=await hi();_(m,new Set(v.serviceUprnConfig.fieldsToHide||[]),!0),G.setNameFields(v.serviceUprnConfig.selectionLayersNameFields||[]),_(c,new ct(v.serviceUprnConfig.dataSelectionTreeviewConfig),!0),_(h,new ct(v.serviceUprnConfig.areaSelectionTreeviewConfig),!0),await i.initializeAsync({portalUrl:v.serviceUprnConfig.portalUrl,itemId:v.serviceUprnConfig.portalItemId||"",proxy:v.serviceUprnConfig.proxy}),console.log("[page] WebMap loaded")});function g(v){_(s,v,!0)}function b(){_(s,"downloads")}var o=Zr(),y=C(o);ni(y,{});var u=A(y,2);wr(u,{});var f=A(u,2);xr(f,{get fieldFilterMenuStore(){return a},get fieldsToHide(){return r(m)}});var M=A(f,2);Bi(M,{});var L=A(M,2),k=p(L);Mi(k,{get webMap(){return i.data},get areaSelectionTreeviewStore(){return n},panelPosition:"top-left",menuPosition:"top-right",get panel(){return t}}),w(L),l(d,o),J()}export{pa as component};
