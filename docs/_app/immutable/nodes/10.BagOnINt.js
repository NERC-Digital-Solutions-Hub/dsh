const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/DpAKiq6K.js","../chunks/BW0zoJTm.js","../chunks/CEBETtrS.js","../chunks/CaNW5Bx0.js","../chunks/PPVm8Dsz.js","../chunks/BUsxo-Ec.js","../chunks/D0nkGZIM.js","../chunks/BEZFO2vt.js","../chunks/CjBjO1Km.js","../chunks/CVQPxYbx.js","../chunks/DwerzRSF.js","../chunks/y1GB1Svy.js","../chunks/AlyPEkJM.js","../chunks/DFYTeVXP.js","../chunks/Cn9cIaVC.js","../chunks/BTNr9f9k.js","../chunks/EmFT8XhJ.js","../chunks/jYVHtrPb.js","../chunks/Cp_8tW2x.js","../chunks/BAWfW4Tu.js","../chunks/CumW50Sh.js","../chunks/Ci6C1k20.js","../chunks/bnayRBMH.js","../chunks/TJ-VhDZ5.js","../chunks/B0gOzRRh.js","../chunks/TW8D_o5j.js","../chunks/Oe6SV2kF.js","../chunks/B_yBz6pZ.js","../chunks/MtSiOt06.js","../chunks/C0wm8_Yw.js","../chunks/CW6Redn4.js","../chunks/BnQsZfR4.js","../chunks/BYduSOTS.js","../chunks/PJHcqbvL.js","../chunks/DS2ZxNQA.js","../chunks/Djp3mnm5.js","../chunks/DjNaDsmS.js","../chunks/C-w03I0l.js","../chunks/D9kT-sgB.js","../chunks/Bu0s_rAF.js","../chunks/B87vTgcy.js","../chunks/C3_gy5al.js","../chunks/CfBiQUdY.js","../chunks/BABeDC_w.js","../chunks/XEmGDYB_.js","../chunks/BVFIxAn9.js","../chunks/CAO_3SU9.js","../chunks/0N6-HNAU.js","../chunks/CglP3OMz.js","../chunks/DCBLidga.js","../chunks/B934cuUn.js","../chunks/C1gSvD9v.js","../chunks/PWd9QCpP.js","../chunks/BwN_j92a.js","../chunks/Bde99gqs.js","../chunks/C7fxqwFZ.js","../chunks/CVwTD0fV.js","../chunks/9eAP65Ji.js","../chunks/mOc398RU.js","../chunks/DPJXGPFY.js","../chunks/B8cN3yAo.js","../chunks/BIj_QgNJ.js","../chunks/q_b6UJoq.js","../chunks/CYI1luaL.js","../chunks/DTEZVyiP.js","../chunks/BCTmL8G8.js","../chunks/DhMSIuCj.js","../chunks/CSXZNpHb.js","../chunks/xXH_AyYh.js","../chunks/CTnd5cvu.js","../chunks/CHAiFIco.js","../chunks/Dj-cqQsY.js","../chunks/B128_oTY.js","../chunks/6Jo1niE7.js","../chunks/DjNuiUVf.js","../chunks/CpqG7TFG.js","../chunks/D_dxbuU-.js","../chunks/jQbrml54.js","../chunks/uHWM1awI.js","../chunks/CYEJx0Wq.js","../chunks/BteoTDFn.js","../chunks/B7Ex7sMf.js","../chunks/DocBEfKB.js","../chunks/B2jVc7id.js","../chunks/Da4sQo3R.js","../chunks/CAGdFHZB.js","../chunks/DzvuCIKa.js","../chunks/Bu0Dv00G.js","../chunks/Bo5l4fk8.js","../chunks/48RKFPo7.js","../chunks/TEMnSu_8.js","../chunks/Ch4klalT.js","../chunks/CQmZIYPi.js","../chunks/DsEHuRPb.js","../chunks/BARRAGjD.js","../chunks/DwIB5gq4.js","../chunks/BjGHVp5Q.js","../chunks/lEIzcqu9.js","../chunks/CtIxBnU3.js","../chunks/gJDQstGQ.js","../chunks/Cl8hT7Dy.js","../chunks/hngUoOdp.js","../chunks/BlT3hoGo.js","../chunks/DZpEp5b3.js","../chunks/GKolV7NZ.js","../chunks/PiqJyY-Z.js","../chunks/CWQ4Sji6.js","../chunks/Cc8znHts.js","../chunks/C9Yzh9th.js","../chunks/CMFr2xVw.js","../chunks/B8kDL1f4.js","../chunks/Bo-exx2O.js","../chunks/BFHafdW6.js","../chunks/D5cGnOsZ.js","../chunks/CCtOv0E5.js","../chunks/DhzudQro.js","../chunks/Qzt__3Yd.js","../chunks/mx71iuXv.js","../chunks/E5yhiq2t.js","../chunks/B2om5830.js","../chunks/CrUuvTSr.js","../chunks/DNQVkPqp.js","../chunks/WCLBMBm-.js","../chunks/BveQ3Yw2.js","../chunks/EGFv0f86.js","../chunks/BDRaqLVR.js","../chunks/BlaSF0Se.js","../chunks/mBdPBegd.js","../chunks/Cu3emot3.js","../chunks/qyF9FwQ9.js","../chunks/XI-Li77m.js","../chunks/DS8kW6UP.js","../chunks/1BM1gK8E.js","../chunks/DPb6J-GU.js","../chunks/BxTLSXBH.js","../chunks/BGyY2giR.js","../chunks/D28RTRrm.js","../chunks/C65Zrur8.js","../chunks/DwnB9djr.js","../chunks/CUTkbj50.js","../chunks/DE7psHTV.js","../chunks/Fla_WrMr.js","../chunks/CVRs03iK.js","../chunks/g8mGjH5g.js","../chunks/D1UBzOg5.js","../chunks/DvKU1K2H.js","../chunks/C8HgMPMV.js","../chunks/BqUxlKJa.js","../chunks/CzWdKr8p.js","../chunks/C2FvnhIN.js","../chunks/B0DG5wVw.js","../chunks/CaYZrGFV.js","../chunks/BRIeeldl.js","../chunks/B-myf1ZS.js","../chunks/B45SJMf_.js","../assets/jsxFactory.CQED0rIl.css","../chunks/2dBEZGc-.js","../assets/component-utils.R4SXog4D.css","../chunks/BqXNu7b5.js","../chunks/Ba6e521d.js","../chunks/DER5P13g.js","../chunks/Byx8h0ay.js","../chunks/BQBvadb7.js","../chunks/D-YQ4CHs.js","../chunks/BpMm_bKu.js","../chunks/DN8pD2EM.js","../chunks/GCVPM2bX.js","../chunks/3vzEJNVc.js","../chunks/C1a7zHTx.js","../chunks/BWEUlARE.js","../chunks/Cba5hWeF.js","../chunks/06ySslQQ.js","../chunks/DlHjpvET.js","../chunks/Dp15eoVC.js","../chunks/DtjklSP3.js","../chunks/Bl9gULnU.js","../chunks/upW12MZ5.js","../chunks/DGnEEsyW.js","../chunks/-tLY_6gf.js","../chunks/DhDrCS8X.js","../chunks/s7y6ZYeW.js","../chunks/COsUduS5.js","../chunks/fxczVhmx.js","../chunks/tfsDxZdG.js","../chunks/D6zlzagn.js","../chunks/Caulfaw_.js","../chunks/DCTsuy_4.js","../chunks/CnyFIUVt.js","../chunks/DKzVzLpH.js","../chunks/BEQnBRaB.js","../chunks/BvOub3JO.js","../chunks/e98d0pcw.js","../chunks/CUjVhFqY.js","../chunks/CXu_ESHL.js","../chunks/DRPDV87L.js","../chunks/DUN1HABK.js","../chunks/Pg2iTJw5.js","../chunks/8WtPGj6h.js","../chunks/CG7ZQ6BV.js","../chunks/BeVzuV2m.js","../chunks/Cef1xHaC.js","../chunks/BvER9tXK.js","../chunks/B9Dt7Ynm.js","../chunks/COg86Xge.js","../chunks/DWpwVUOd.js","../chunks/DeOh5xmU.js","../chunks/B3KWAeZ2.js","../chunks/C34EDYhX.js","../chunks/Bxxl7NsE.js","../chunks/CaVKkSa6.js","../chunks/CUzevAry.js","../chunks/C8zGwbjb.js","../chunks/DOU46fny.js","../chunks/CxntQxa8.js","../chunks/B21jgz5M.js","../chunks/CHMqct6U.js","../chunks/DJfmhI_b.js","../chunks/CqSK9vE_.js","../chunks/teoI27Zt.js","../chunks/BgIfDPrD.js","../chunks/Bl0cSKE5.js","../chunks/HTOW8iPe.js","../chunks/BzyQLkBI.js","../chunks/DuIgqnlY.js","../chunks/CbvgmFLt.js","../chunks/DaQyK3nQ.js","../chunks/CZyMpCUL.js","../chunks/7808le4B.js","../chunks/DqwAHjQA.js","../chunks/CFxQi9ff.js","../chunks/CRNKQexD.js","../chunks/DfDynnwy.js","../chunks/Cgb6qxNH.js","../chunks/_r5V6nso.js","../chunks/TQki0tx9.js","../chunks/Bb7XCc95.js","../chunks/BrT4CCe6.js","../chunks/B1N-tmtC.js","../chunks/CEtlHNOR.js","../chunks/BZKeGk9D.js","../chunks/D-qJO60r.js","../chunks/QQC62dOK.js","../chunks/BpZHOvkG.js","../chunks/DQOO6RKE.js","../chunks/Bi6C4OG6.js"])))=>i.map(i=>d[i]);
import{_ as Pe}from"../chunks/PPVm8Dsz.js";import"../chunks/DsnmJJEf.js";import{o as ot,a as st}from"../chunks/B12Xl85d.js";import{f as x,p as Re,c as _,n as It,r as g,a as Ee,a7 as ne,T as re,v as e,a8 as J,W as Be,aG as I,av as Ye,u as He,ar as r,aX as Qt,aY as Yt,aK as Xt}from"../chunks/l2HDBFeU.js";import{e as Jt,g as ht}from"../chunks/7Q11sfri.js";import{c as D,a as o,f as w,t as je}from"../chunks/D3mgKXxP.js";import{l as Zt,s as Xe,p as ue,r as xt,i as W}from"../chunks/amrQSy0T.js";import{c as Y}from"../chunks/BULd4hFL.js";import{a as er,e as St,b as it,s as Je,f as _t}from"../chunks/B2XAts-z.js";import{b as at}from"../chunks/CPWKExeQ.js";import{s as le}from"../chunks/CPxvWa6q.js";import{s as At,e as Qe,i as tr}from"../chunks/Dv6QOWAw.js";import{I as rr,s as ar,e as nr,f as or,S as wt,g as lt,h as ct,i as ut}from"../chunks/xE6fRQiE.js";import{c as dt}from"../chunks/DzE4wJgV.js";import{X as ir,A as sr,a as lr,b as cr}from"../chunks/De6S0tni.js";import"../chunks/69_IOA4Y.js";import{C as ur}from"../chunks/Cgb8ZoOw.js";import{S as nt,a as dr}from"../chunks/DqC0T5S3.js";import{B as fr}from"../chunks/Cycc-Qfx.js";import{I as mr}from"../chunks/D9YRtp1B.js";import{H as pr}from"../chunks/BUsxo-Ec.js";import{c as Ot,S as vr}from"../chunks/Kx36ldNz.js";import{a as gr,b as $t}from"../chunks/35ztFtFj.js";import"../chunks/B17Q6ahh.js";import{S as _r}from"../chunks/p_qY5EvW.js";import"../chunks/DhMSIuCj.js";import"../chunks/CaNW5Bx0.js";import"../chunks/BW0zoJTm.js";import"../chunks/CEBETtrS.js";function hr($){return(gr||$t)+$}function wr($,t){const i=Zt(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const h=[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3"}]];rr($,Xe({name:"command"},()=>i,{get iconNode(){return h},children:(m,S)=>{var n=D(),M=x(n);ar(M,t,"default",{}),o(m,n)},$$slots:{default:!0}}))}var yr=w("<span><!></span>");function xr($,t){Re(t,!0);let i=ue(t,"ref",15,null),h=xt(t,["$$slots","$$events","$$legacy","ref","class","children"]);var m=yr();er(m,n=>({"data-slot":"command-shortcut",class:n,...h}),[()=>dt("text-muted-foreground ml-auto text-xs tracking-widest",t.class)]);var S=_(m);At(S,()=>t.children??It),g(m),at(m,n=>i(n),()=>i()),o($,m),Ee()}function br($,t){Re(t,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let i=xt(t,["$$slots","$$events","$$legacy"]);const h=[["path",{d:"m12 19-7-7 7-7"}],["path",{d:"M19 12H5"}]];mr($,Xe({name:"arrow-left"},()=>i,{get iconNode(){return h},children:(m,S)=>{var n=D(),M=x(n);At(M,()=>t.children??It),o(m,n)},$$slots:{default:!0}})),Ee()}function Cr($,t){$.stopPropagation(),t()?.()}var Pr=w('<button type="button" class="pointer-events-none flex h-4 w-0 items-center justify-center rounded text-muted-foreground opacity-0 transition-[width,margin-left,opacity] group-hover:pointer-events-auto group-hover:ml-1 group-hover:w-4 group-hover:opacity-100"><!></button>'),Ir=w('<div><span class="truncate"> </span> <!></div>');function Rt($,t){Re(t,!0);let i=ue(t,"onClose",3,null);const h=t.title??t.value;var m=Ir(),S=_(m),n=_(S,!0);g(S);var M=ne(S,2);{var A=R=>{var E=Pr();E.__click=[Cr,i];var b=_(E);ir(b,{class:"size-3"}),g(E),re(()=>Je(E,"aria-label",`Clear ${t.value}`)),o(R,E)};W(M,R=>{i()&&R(A)})}g(m),re(R=>{it(m,1,R),Je(m,"title",h),le(n,t.value)},[()=>St(dt("group inline-flex max-w-[10rem] items-center overflow-hidden rounded border border-border px-1 py-0.5 text-xs font-medium text-muted-foreground transition-all",t.class))]),o($,m),Ee()}Jt(["click"]);var Sr=w('<!> <span aria-hidden="true" class="h-5 w-px bg-border"></span>',1),Ar=w('<div class="flex h-9 items-center gap-2 border-b pl-2" data-slot="command-input-wrapper"><span class="flex h-full min-w-[1.25rem] shrink-0 items-center justify-center text-muted-foreground"><!></span> <!> <!></div>');function Or($,t){Re(t,!0);let i=ue(t,"ref",15,null),h=ue(t,"value",15,""),m=ue(t,"iconProps",19,()=>({})),S=ue(t,"onCommandClose",3,null),n=xt(t,["$$slots","$$events","$$legacy","ref","class","value","icon","iconProps","commandId","onCommandClose"]);var M=Ar(),A=_(M),R=_(A);{var E=O=>{const Z=J(()=>t.icon);var ee=D(),v=x(ee);Y(v,()=>e(Z),(d,C)=>{C(d,Xe(m))}),o(O,ee)},b=O=>{wr(O,{class:"size-4 opacity-50"})};W(R,O=>{t.icon?O(E):O(b,!1)})}g(A);var F=ne(A,2);{var j=O=>{var Z=Sr(),ee=x(Z);Rt(ee,{get value(){return t.commandId},get title(){return t.commandId},get onClose(){return S()}}),Be(2),o(O,Z)};W(F,O=>{t.commandId&&O(j)})}var U=ne(F,2);{let O=J(()=>dt("flex h-10 flex-1 rounded-md bg-transparent py-3 text-sm outline-hidden placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t.class));Y(U,()=>nr,(Z,ee)=>{ee(Z,Xe({"data-slot":"command-input",get class(){return e(O)}},()=>n,{get ref(){return i()},set ref(v){i(v)},get value(){return h()},set value(v){h(v)}}))})}g(M),o($,M),Ee()}function $r($,t){Re(t,!0);const i=ue(t,"disabled",3,!1);fr($,{class:"m-0 flex size-7 shrink-0 items-center justify-center rounded-md border-none bg-transparent p-0 text-muted-foreground opacity-50 shadow-none transition hover:bg-transparent hover:text-accent-foreground focus:outline-none focus-visible:border-transparent focus-visible:ring-0 focus-visible:ring-offset-0 focus-visible:outline-none active:ring-0 active:outline-none disabled:pointer-events-none disabled:opacity-50 has-[>svg]:px-0",onclick:()=>{i()||t.onPress?.()},"aria-label":"Return to command search",get disabled(){return i()},children:(h,m)=>{{let S=J(()=>`size-4 ${t.class}`.trim());br(h,{get class(){return e(S)}})}},$$slots:{default:!0}}),Ee()}var Rr=w('<div class="flex flex-wrap gap-2 px-2 py-0.5"></div>'),Er=w('<span class="text-xs text-muted-foreground"> </span>'),Mr=w('<div class="flex flex-col gap-0.5"><span class="text-sm leading-tight font-medium"> </span> <!></div> <!>',1),Vr=w("<!> <!>",1),Lr=w('<div class="px-4 pb-3"><!></div>'),kr=w("<!> <!>",1),Dr=w('<div class="px-4 pb-3"><!></div>'),Tr=w('<p class="text-sm text-muted-foreground">No panel registered for this command.</p>'),Nr=w('<div class="pr-2 pb-2 pl-2"><!></div>'),Wr=w("<!> <!> <!>",1),Fr=w("<!> <!>",1),Br=w("<!> <!>",1),jr=w("<div><!></div>");function zr($,t){Re(t,!0);let i=ue(t,"ref",15,null),h=ue(t,"commands",19,()=>[]),m=ue(t,"placeholder",3,"Search commands..."),S=ue(t,"emptyMessage",3,"No commands found."),n=I(null),M=I(null),A=I(null),R=I(null),E=I(null),b=I(null),F=I(Ye([])),j=I(""),U=I(!1),O=I(Ye(m())),Z=I(null),ee=!1,v=I(null),d=!1,C=null,f=null,y=0,P=null;const V=J(()=>{const a=new Map;for(const u of h())a.set(u.id,u);return Array.from(a.values())}),oe=J(()=>{const a=new Map;for(const u of e(V)){const s=u.group??null,p=a.get(s);p?p.push(u):a.set(s,[u])}return a});ot(()=>{We()});function K(a,u=!1){u&&(ee=!0),r(j,a,!0)}function te(a=null,u){if(!P||a&&P!==a)return;r(Z,null),P.placeholderOverridden&&r(O,m()),(u?.forceReset??(u?.skipReset?!1:P.resetValueOnDetach))&&(K("",!0),P.onInput("")),P.onDetach?.(),P=null}function we(){te(null,{forceReset:!0}),r(Z,null),r(O,m()),ee=!1}He(()=>{const a=e(Z);if(a){if(ee){ee=!1;return}a(e(j))}}),He(()=>{e(n)||r(O,m())});function l(){if(f)try{f()}catch(a){console.error("Failed to dispose command session",a)}f=null,r(A,null),r(R,null),we(),r(M,null)}function c(){e(n)&&(l(),r(n,null),r(b,null),r(E,null),K("",!0),r(U,!0))}function L(a){try{t.commandSearchContext.get(a.classType).clear()}catch(u){console.error("Failed to clear global variable",u)}finally{We()}}function z(){e(v)?.blur()}function ie(a,u){if(!a.component)return null;const s=a.props;return s?{component:a.component,props:()=>s(u)}:{component:a.component}}function G(a,u){const s=a.createSession?.(u);if(s){f=s.dispose??null,Object.prototype.hasOwnProperty.call(s,"input")?r(A,s.input??null,!0):r(A,null),Object.prototype.hasOwnProperty.call(s,"content")?r(R,s.content??null,!0):r(R,ie(a,u),!0);return}f=null,r(A,null),r(R,ie(a,u),!0)}function X(a){const u=a.id;return{deactivate:()=>{!e(n)||e(n).id!==u||(c(),We())},isActive:s=>!e(n)||e(n).id!==u?!1:s?e(n).id===s:!0,setIsOpen:(s,p)=>{if(!e(n)||e(n).id!==u)return;if(s){d=!1,r(U,!0);return}const q=p?.preserveActive??!0;Me(q)},setInputSurface:s=>{!e(n)||e(n).id!==u||r(A,s,!0)},setContentSurface:s=>{!e(n)||e(n).id!==u||r(R,s,!0)},getInputValue:()=>e(j),setInputValue:s=>{!e(n)||e(n).id!==u||K(s,!0)},setInputHandler:s=>{if(!(!e(n)||e(n).id!==u)){if(te(null,{skipReset:!0}),r(Z,s,!0),!s){ee=!1;return}s(e(j))}},setPlaceholder:s=>{!e(n)||e(n).id!==u||r(O,s,!0)},resetPlaceholder:()=>{!e(n)||e(n).id!==u||r(O,m())},attachInputBinding:s=>{if(!e(n)||e(n).id!==u)return()=>{};te(null,{skipReset:!0});const p=s.placeholder??e(n).inputPlaceholder??m(),q={id:++y,commandId:u,onInput:s.onInput,onDetach:s.onDetach,placeholderOverridden:!!p,resetValueOnDetach:s.resetValueOnDetach??!0};P=q,q.placeholderOverridden&&p&&r(O,p,!0),r(Z,Le=>{!P||P.id!==q.id||s.onInput(Le)});const Q=s.resetValueOnAttach??!0,ge=s.replayInitialValue??!Q;return Q?(K("",!0),s.onInput("")):ge&&s.onInput(e(j)),()=>{te(q)}}}}function B(a){const u=e(M);if(!a)return u?{runtime:u}:{};if(!u)return{};const{props:s}=a;return s?{...typeof s=="function"?s(u):s,runtime:u}:{runtime:u}}function T(a){return`${a.name} ${a.description??""}`.trim()}async function H(a){if(e(n)?.id===a.id){c();return}l(),r(b,null),r(E,a.id,!0),r(U,!0),e(v)&&e(v).focus();const u=X(a);r(M,u,!0),r(n,a,!0),G(a,u);try{await a.execute(u)}catch(s){r(b,s instanceof Error?s:new Error("Failed to execute the command."),!0)}finally{r(E,null),K("",!0),We()}}function Ne(a){const u=a.key.toLowerCase();if((a.metaKey||a.ctrlKey)&&u==="p"){if(a.preventDefault(),e(n)){c();return}e(v)&&e(v).focus();return}if(u==="escape"){if(e(n)){a.preventDefault(),c(),z();return}e(U)&&(a.preventDefault(),r(U,!1),z());return}if(!e(n))for(const p of e(V)){if(!p.shortcut)continue;const q=p.shortcut.join(" ").toLowerCase(),Q=[];if(a.metaKey&&Q.push("âŒ˜"),a.ctrlKey&&Q.push("Ctrl"),a.altKey&&Q.push("Alt"),a.shiftKey&&Q.push("Shift"),Q.push(a.key.length===1?a.key.toUpperCase():a.key),Q.join(" ").toLowerCase()===q.toLowerCase()){a.preventDefault(),H(p);break}}}function Ze(){r(U,!0)}function Me(a=!1){d=a,r(U,!1)}function et(a){const u=C;if(!u)return;const s=a.target;s&&u.contains(s)||e(U)&&Me(!!e(n))}He(()=>{if(!e(U)){if(K("",!0),!e(n)){d=!1;return}if(d){d=!1;return}l(),r(n,null),r(b,null)}});function We(){if(!t.commandSearchContext){r(F,[],!0);return}const a=t.commandSearchContext.getGlobalVariables(),u=[];for(const s of a){const p=s.getId();p&&u.push({displayName:s.displayName,id:p,classType:s.constructor})}r(F,u,!0)}var Ve=jr();ht("keydown",Qt,Ne),ht("pointerdown",Yt,et);var ye=_(Ve);Y(ye,()=>or,(a,u)=>{u(a,{children:(s,p)=>{var q=Br(),Q=x(q);{let ke=J(()=>e(n)?e(n).inputPlaceholder??e(O):e(O)),Ie=J(()=>e(n)?$r:void 0),Se=J(()=>e(n)?{onPress:c,disabled:e(E)===e(n).id}:void 0),Fe=J(()=>e(n)?.id),tt=J(()=>e(n)?c:null);Or(Q,{get placeholder(){return e(ke)},onfocus:()=>Ze(),get icon(){return e(Ie)},get iconProps(){return e(Se)},get commandId(){return e(Fe)},get onCommandClose(){return e(tt)},get value(){return e(j)},set value(ze){r(j,ze,!0)},get ref(){return e(v)},set ref(ze){r(v,ze,!0)}})}var ge=ne(Q,2);{var Le=ke=>{var Ie=Fr(),Se=x(Ie);{var Fe=ce=>{var de=Rr();Qe(de,21,()=>e(F),_e=>_e.id,(_e,fe)=>{{let xe=J(()=>`${e(fe).displayName}: ${e(fe).id}`),Ae=J(()=>`${e(fe).displayName}: ${e(fe).id}`);Rt(_e,{get value(){return e(xe)},get title(){return e(Ae)},onClose:()=>L(e(fe))})}}),g(de),o(ce,de)};W(Se,ce=>{e(F).length&&ce(Fe)})}var tt=ne(Se,2);{var ze=ce=>{wt(ce,{children:(de,_e)=>{var fe=D(),xe=x(fe);Y(xe,()=>lt,(Ae,rt)=>{rt(Ae,{children:(ve,De)=>{var me=Vr(),Oe=x(me);Y(Oe,()=>ct,(be,k)=>{k(be,{children:(N,ae)=>{Be();var he=je();re(()=>le(he,S())),o(N,he)},$$slots:{default:!0}})});var Te=ne(Oe,2);Qe(Te,17,()=>Array.from(e(oe).entries()),tr,(be,k)=>{var N=J(()=>Xt(e(k),2));let ae=()=>e(N)[1];var he=D(),Ce=x(he);Qe(Ce,17,ae,pe=>pe.id,(pe,se)=>{var qe=D(),Ue=x(qe);{let Vt=J(()=>T(e(se)));Y(Ue,()=>ut,(Lt,kt)=>{kt(Lt,{get value(){return e(Vt)},onclick:()=>H(e(se)),children:(Dt,pa)=>{var bt=Mr(),mt=x(bt),pt=_(mt),Tt=_(pt,!0);g(pt);var Nt=ne(pt,2);{var Wt=$e=>{var Ge=Er(),vt=_(Ge,!0);g(Ge),re(()=>le(vt,e(se).description)),o($e,Ge)};W(Nt,$e=>{e(se).description&&$e(Wt)})}g(mt);var Ft=ne(mt,2);{var Bt=$e=>{nt($e,{class:"ml-auto size-4 text-muted-foreground"})},jt=$e=>{var Ge=D(),vt=x(Ge);{var zt=gt=>{var Ct=D(),Ut=x(Ct);Y(Ut,()=>xr,(Kt,qt)=>{qt(Kt,{children:(Gt,va)=>{Be();var Pt=je();re(Ht=>le(Pt,Ht),[()=>e(se).shortcut?.join(" + ")]),o(Gt,Pt)},$$slots:{default:!0}})}),o(gt,Ct)};W(vt,gt=>{e(se).shortcut?.length&&gt(zt)},!0)}o($e,Ge)};W(Ft,$e=>{e(E)===e(se).id?$e(Bt):$e(jt,!1)})}re(()=>le(Tt,e(se).name)),o(Dt,bt)},$$slots:{default:!0}})})}o(pe,qe)}),o(be,he)}),o(ve,me)},$$slots:{default:!0}})}),o(de,fe)},$$slots:{default:!0}})},ft=ce=>{var de=Wr(),_e=x(de);{var fe=ve=>{const De=J(()=>e(A).component);var me=Lr(),Oe=_(me);{let Te=J(()=>B(e(A)));Y(Oe,()=>e(De),(be,k)=>{k(be,Xe(()=>e(Te)))})}g(me),o(ve,me)};W(_e,ve=>{e(A)&&ve(fe)})}var xe=ne(_e,2);{var Ae=ve=>{var De=Dr(),me=_(De);Y(me,()=>sr,(Oe,Te)=>{Te(Oe,{variant:"destructive",children:(be,k)=>{var N=kr(),ae=x(N);Y(ae,()=>lr,(Ce,pe)=>{pe(Ce,{children:(se,qe)=>{Be();var Ue=je();re(()=>le(Ue,`${e(n).name??""} failed`)),o(se,Ue)},$$slots:{default:!0}})});var he=ne(ae,2);Y(he,()=>cr,(Ce,pe)=>{pe(Ce,{children:(se,qe)=>{Be();var Ue=je();re(()=>le(Ue,e(b).message)),o(se,Ue)},$$slots:{default:!0}})}),o(be,N)},$$slots:{default:!0}})}),g(De),o(ve,De)};W(xe,ve=>{e(b)&&ve(Ae)})}var rt=ne(xe,2);wt(rt,{children:(ve,De)=>{var me=Nr(),Oe=_(me);{var Te=k=>{const N=J(()=>e(R).component);var ae=D(),he=x(ae);{let Ce=J(()=>B(e(R)));Y(he,()=>e(N),(pe,se)=>{se(pe,Xe(()=>e(Ce)))})}o(k,ae)},be=k=>{var N=D(),ae=x(N);Y(ae,()=>ur,(he,Ce)=>{Ce(he,{class:"px-0",children:(pe,se)=>{var qe=Tr();o(pe,qe)},$$slots:{default:!0}})}),o(k,N)};W(Oe,k=>{e(R)?k(Te):k(be,!1)})}g(me),o(ve,me)},$$slots:{default:!0}}),o(ce,de)};W(tt,ce=>{e(n)?ce(ft,!1):ce(ze)})}o(ke,Ie)};W(ge,ke=>{e(U)&&ke(Le)})}o(s,q)},$$slots:{default:!0}})}),g(Ve),at(Ve,a=>C=a,()=>C),at(Ve,a=>i(a),()=>i()),re(a=>it(Ve,1,a),[()=>St(dt("space-y-4",t.class))]),o($,Ve),Ee()}class yt{#e=[];constructor(t){this.#e=t}get organisations(){return this.#e}}class Et{#e=I(null);#t=I(!1);#r=I(null);load=async(t,i)=>{r(this.#t,!0),r(this.#r,null);try{const h=await pr(t,{...i,responseType:"json"});console.log("Esri Request Response:",h,h.data.url),r(this.#e,h.data,!0)}catch(h){r(this.#r,h,!0)}finally{r(this.#t,!1)}};get data(){return e(this.#e)}get isLoading(){return e(this.#t)}get error(){return e(this.#r)}}class Mt{colour=null;id=null;getId(){return this.id}setId(t){this.id=t}clear(){this.setId(null)}}class Ke extends Mt{displayName="org";organisations;constructor(t){super(),this.organisations=new Map(t.map(i=>[i.id,i])),t.length>0&&this.setId(t[0].id)}setActiveOrganisation(t){this.setId(t)}getActiveOrganisationId(){return this.id}getActiveOrganisationPortalUrl(){const t=this.organisations.get(this.getActiveOrganisationIdInternal());if(!t)throw new Error("No organisation is currently selected.");return t.portalUrl}getActiveOrganisationEndpoint(){const t=this.organisations.get(this.getActiveOrganisationIdInternal());if(!t)throw new Error("No organisation is currently selected.");return t.endpoint}getActiveOrganisationQueryParams(){const t=this.organisations.get(this.getActiveOrganisationIdInternal());if(!t)throw new Error("No organisation is currently selected.");return t.queryParams||{}}getActiveOrganisationIdInternal(){if(!this.id)throw new Error("No organisation is currently selected.");return this.id}}var Ur=w('<div class="error-message svelte-11six79"><p class="text-sm text-red-600"> </p></div>'),Kr=w('<div class="flex items-center justify-center p-4"><!></div>'),qr=w('<div class="flex items-center gap-2"><!> <span class="title-text w-full font-medium text-foreground svelte-11six79"> </span></div>'),Gr=w('<span class="description-text text-xs text-gray-500 svelte-11six79"> </span>'),Hr=w('<div class="flex w-full min-w-0 flex-col gap-0.5"><span class="title-text font-medium text-foreground svelte-11six79"> </span> <!></div>'),Qr=w('<div class="item-container svelte-11six79"><!></div>');function Yr($,t){Re(t,!0);const i=ue(t,"mapView",7),h=ue(t,"runtime",3,null),m=new Et;let S=I(null),n=I(null),M=I(""),A=I(Ye([]));const R=J(()=>{const v=e(A);console.log("Filtering web maps with data:",v);const d=e(M).trim().toLowerCase();return d?v.filter(C=>{const f=C?.title?.toLowerCase()??"",y=C?.description?.toLowerCase()??"";return f.includes(d)||y.includes(d)}):v});ot(async()=>{const d=t.commandSearchContext.get(Ke).getActiveOrganisationId();if(!d){console.warn("No active organisation selected in OrganisationCommandService");return}try{const C=await fetch(`${$t}/api/maps?id=${d}`);if(!C.ok)throw new Error(`Failed to fetch maps: ${C.status} ${C.statusText}`);const f=await C.json();r(A,(f.results??[]).filter(y=>y.type==="Web Map").map(y=>({id:y.id,title:y.title,description:Ot(y.description),owner:y.owner,tags:y.tags})),!0)}catch(C){console.error("Error fetching web maps:",C),r(n,C instanceof Error?C.message:"Failed to fetch web maps",!0)}});let E=null,b=null,F=t.inputPlaceholder??"Search...";He(()=>{const v=h(),d=t.inputPlaceholder??"Search...";if(!v){E?.(),E=null,b=null,F=d,r(M,"");return}if(v===b){d!==F&&(v.setPlaceholder(d),F=d);return}E?.(),E=null,F=d,E=v.attachInputBinding({placeholder:d,onInput:C=>{r(M,C,!0)}}),b=v}),st(()=>{E?.(),E=null,b=null});async function j(v){if(!i()){console.error("MapView is not initialized"),r(n,"MapView is not ready. Please wait and try again.");return}r(S,v,!0),r(n,null);try{console.log(`Loading web map with ID: ${v}`);const d=t.commandSearchContext.get(Ke);if(!d.getActiveOrganisationId()){console.warn("No active organisation selected in OrganisationCommandService");return}const f=d.getActiveOrganisationPortalUrl(),{default:y}=await Pe(async()=>{const{default:K}=await import("../chunks/DpAKiq6K.js").then(te=>te.W);return{default:K}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151]),import.meta.url),P=new y({portalItem:{id:v,portal:{url:f}}});await P.load(),console.log("Web map loaded successfully"),console.log("Applying web map to MapView",i().ui),i().map=P,console.log("Web map applied to MapView"),await(await Pe(()=>import("../chunks/DwerzRSF.js").then(K=>K.m),__vite__mapDeps([10,1,2,3,11,4,5,6]),import.meta.url)).whenOnce(()=>i().ready),console.log("MapView updated with new web map");const oe=P.initialViewProperties?.viewpoint?.targetGeometry;oe&&(console.log("Navigating to web map initial viewpoint"),await i().goTo(oe),console.log("MapView navigated to web map initial viewpoint")),h()?.setIsOpen(!1)}catch(d){console.error("Error loading web map:",d),r(n,d instanceof Error?d.message:"Failed to load web map",!0)}finally{r(S,null)}}var U=Qr(),O=_(U);{var Z=v=>{var d=Ur(),C=_(d),f=_(C);g(C),g(d),re(()=>le(f,`${m.error.message??""}. ${m.error?.details?.httpStatus===0?"Reason: CORS Error. See console for more information.":""}`)),o(v,d)},ee=v=>{var d=D(),C=x(d);{var f=P=>{var V=Kr(),oe=_(V);nt(oe,{class:"size-5"}),g(V),o(P,V)},y=P=>{var V=D(),oe=x(V);Y(oe,()=>lt,(K,te)=>{te(K,{children:(we,l)=>{var c=D(),L=x(c);{var z=G=>{var X=D(),B=x(X);Y(B,()=>ct,(T,H)=>{H(T,{children:(Ne,Ze)=>{Be();var Me=je("No web maps match your search.");o(Ne,Me)},$$slots:{default:!0}})}),o(G,X)},ie=G=>{var X=D(),B=x(X);Qe(B,17,()=>e(R),T=>T.id,(T,H)=>{var Ne=D(),Ze=x(Ne);Y(Ze,()=>ut,(Me,et)=>{et(Me,{onclick:()=>j(e(H).id),children:(We,Ve)=>{var ye=D(),a=x(ye);{var u=p=>{var q=qr(),Q=_(q);nt(Q,{class:"size-4"});var ge=ne(Q,2),Le=_(ge);g(ge),g(q),re(()=>le(Le,`Loading ${e(H).title??"Untitled web map"??""}...`)),o(p,q)},s=p=>{var q=Hr(),Q=_(q),ge=_(Q,!0);g(Q);var Le=ne(Q,2);{var ke=Ie=>{var Se=Gr(),Fe=_(Se,!0);g(Se),re(()=>{Je(Se,"title",e(H).description),le(Fe,e(H).description)}),o(Ie,Se)};W(Le,Ie=>{e(H).description&&Ie(ke)})}g(q),re(()=>{Je(Q,"title",e(H).title),le(ge,e(H).title??"Untitled web map")}),o(p,q)};W(a,p=>{e(S)===e(H).id?p(u):p(s,!1)})}o(We,ye)},$$slots:{default:!0}})}),o(T,Ne)}),o(G,X)};W(L,G=>{e(R).length===0?G(z):G(ie,!1)})}o(we,c)},$$slots:{default:!0}})}),o(P,V)};W(C,P=>{m.isLoading?P(f):P(y,!1)},!0)}o(v,d)};W(O,v=>{m.error?v(Z):v(ee,!1)})}g(U),o($,U),Ee()}var Xr=w('<div class="flex w-full min-w-0 flex-col gap-0.5"><span class="title-text font-medium text-foreground svelte-1w2u78y"> </span></div>'),Jr=w('<div class="item-container svelte-1w2u78y"><!></div>');function Zr($,t){Re(t,!0);const i=ue(t,"runtime",3,null);let h=I(Ye([])),m=I("");ot(async()=>{const b=t.commandSearchContext.get(yt)?.organisations;if(!b){console.warn("No organisation configuration found in MapsConfig");return}r(h,b,!0)});let S=null,n=null,M=t.inputPlaceholder??"Search...";He(()=>{const b=i(),F=t.inputPlaceholder??"Search...";if(!b){S?.(),S=null,n=null,M=F,r(m,"");return}if(b===n){F!==M&&(b.setPlaceholder(F),M=F);return}S?.(),S=null,M=F,S=b.attachInputBinding({placeholder:F,onInput:j=>{r(m,j,!0)}}),n=b}),st(()=>{S?.(),S=null,n=null});function A(b){t.commandSearchContext.get(Ke).setActiveOrganisation(b),i()&&i().deactivate()}var R=Jr(),E=_(R);Y(E,()=>lt,(b,F)=>{F(b,{children:(j,U)=>{var O=D(),Z=x(O);{var ee=d=>{var C=D(),f=x(C);Y(f,()=>ct,(y,P)=>{P(y,{children:(V,oe)=>{Be();var K=je("No organisations match your search.");o(V,K)},$$slots:{default:!0}})}),o(d,C)},v=d=>{var C=D(),f=x(C);Qe(f,17,()=>e(h),y=>y.name,(y,P)=>{var V=D(),oe=x(V);Y(oe,()=>ut,(K,te)=>{te(K,{onclick:()=>A(e(P).id),children:(we,l)=>{var c=Xr(),L=_(c),z=_(L,!0);g(L),g(c),re(()=>le(z,e(P).name??"Untitled organisation")),o(we,c)},$$slots:{default:!0}})}),o(y,V)}),o(d,C)};W(Z,d=>{e(h).length===0?d(ee):d(v,!1)})}o(j,O)},$$slots:{default:!0}})}),g(R),o($,R),Ee()}class ea{services=new Map;globalVariables=new Map;add(t,i){this.services.set(t,i),i instanceof Mt&&this.globalVariables.set(t,i)}get(t){const i=this.services.get(t);if(!i)throw new Error(`Service not found for token: ${t.name}`);return i}has(t){return this.services.has(t)}getGlobalVariables(){return Array.from(this.globalVariables.values())}}globalThis.process?.versions?.webcontainer;Pe(()=>import("../chunks/BIHI7g3E.js"),[],import.meta.url).then($=>new $.AsyncLocalStorage).catch(()=>{});var ta=w('<div class="error-message svelte-1lap2l5"><p class="text-sm text-red-600"> </p></div>'),ra=w('<div class="flex items-center justify-center p-4"><!></div>'),aa=w('<div class="flex items-center gap-2"><!> <span class="title-text w-full font-medium text-foreground svelte-1lap2l5"> </span></div>'),na=w('<div class="flex items-center gap-2"><!></div>'),oa=w('<span class="description-text text-xs text-gray-500 svelte-1lap2l5"> </span>'),ia=w('<span class="text-[11px] text-muted-foreground"> </span>'),sa=w('<span class="text-[11px] text-muted-foreground"> <!></span>'),la=w('<!> <div class="flex w-full min-w-0 flex-col gap-0.5"><span class="title-text font-medium text-foreground svelte-1lap2l5"> </span> <!> <!> <!></div>',1),ca=w('<div class="item-container svelte-1lap2l5"><!></div>');function ua($,t){Re(t,!0);const i=ue(t,"mapView",7),h=ue(t,"runtime",3,null),m=new Et;let S=I(null),n=I(null),M=I(""),A=I(Ye(new _r)),R=I(Ye([]));const E=new Map,b={27700:"OS_Open_Background"},F=J(()=>{const l=e(R),c=e(M).trim().toLowerCase();return c?l.filter(L=>{const z=L?.title?.toLowerCase()??"",ie=L?.description?.toLowerCase()??"";return z.includes(c)||ie.includes(c)}):l});ot(async()=>{const l=t.commandSearchContext.get(Ke);if(!l.getActiveOrganisationId()){console.warn("No active organisation selected in OrganisationCommandService");return}const L=l.getActiveOrganisationPortalUrl(),z=l.getActiveOrganisationEndpoint(),G=`type:(${["Feature Layer","Feature Service","Map Service","Image Service"].map(T=>`"${T}"`).join(" OR ")})`,X=l.getActiveOrganisationQueryParams(),B=Object.entries(X).map(([T,H])=>`${T}:"${H}"`).join(" AND ");await m.load(L+z,{query:{q:`${G}`+(B?` AND ${B}`:""),num:100,f:"json"}}),r(R,(m.data?.results??[]).map(T=>({id:T.id,title:T.title,description:Ot(T.description),owner:T.owner,type:T.type,spatialReferenceWkid:T.spatialReference?.wkid??T.spatialReference?.latestWkid})),!0),E.clear();for(const T of e(R))E.set(T.id,T)});let j=null,U=null,O=t.inputPlaceholder??"Search...";He(()=>{const l=h(),c=t.inputPlaceholder??"Search...";if(!l){j?.(),j=null,U=null,O=c,r(M,"");return}if(l===U){c!==O&&(l.setPlaceholder(c),O=c);return}j?.(),j=null,O=c,j=l.attachInputBinding({placeholder:c,onInput:L=>{r(M,L,!0)}}),U=l}),st(()=>{j?.(),j=null,U=null});async function Z(l){e(A).has(l)?ee(l):await d(l)}function ee(l){const c=e(A).get(l);!c||!i()||!i().map||(i().map.remove(c),e(A).delete(l),r(A,e(A),!0),console.log(`Layer removed from the map: ${l}`))}function v(l){for(const c of i()?.map?.allLayers??[])if(c.portalItem?.id===l)return!0;return!1}async function d(l){if(!i()||!i().map){console.error("Map or MapView is not initialized"),r(n,"Map is not ready. Please wait and try again.");return}r(S,l,!0),r(n,null);try{console.log(`Loading layer with portal item ID: ${l}`);const c=t.commandSearchContext.get(Ke);if(!c.getActiveOrganisationId()){console.warn("No active organisation selected in OrganisationCommandService");return}const z=c.getActiveOrganisationPortalUrl(),[{default:ie},{default:G}]=await Promise.all([Pe(()=>import("../chunks/BTNr9f9k.js").then(H=>H.u),__vite__mapDeps([15,1,2,3,5,4,6,9,10,11,12]),import.meta.url),Pe(()=>import("../chunks/y1GB1Svy.js").then(H=>H.P),__vite__mapDeps([11,4,1,2,3,5,6]),import.meta.url)]),X=new G({url:z}),B=await ie.fromPortalItem({portalItem:{id:l,portal:X}});await B.load();const T=await C(B,l);await V(T),i().map.add(B),e(A).set(l,B),r(A,e(A),!0),console.log("Layer added to the map");try{await i().whenLayerView(B),B.fullExtent&&await i().goTo(B.fullExtent)}catch(H){console.warn("Layer view not ready for navigation",H)}}catch(c){console.error("Error loading layer:",c),r(n,c instanceof Error?c.message:"Failed to add layer",!0)}finally{r(S,null)}}async function C(l,c){const L=f(l);if(L)return L;const z=E.get(c);if(z?.spatialReferenceWkid){const{default:G}=await Pe(async()=>{const{default:X}=await import("../chunks/BUsxo-Ec.js").then(B=>B.bc);return{default:X}},__vite__mapDeps([5,1,2,3,4,6]),import.meta.url);return new G({wkid:z.spatialReferenceWkid})}const ie=l.portalItem?.spatialReference;return ie||null}function f(l){return l?.spatialReference??null}function y(l){if(!l)return;const c=l;return l.wkid??c?.latestWkid??void 0}async function P(l){if(!i()||!i().map)return console.warn("MapView or Map is not available for basemap loading"),null;if(!l)return i().map.basemap;const c=b[l];if(!c)return i().map.basemap;const{default:L}=await Pe(async()=>{const{default:z}=await import("../chunks/CjBjO1Km.js").then(ie=>ie.B);return{default:z}},__vite__mapDeps([8,4,1,2,3,5,6,9,10,11,12,13,14,15,16,17,18,19]),import.meta.url);try{return await L.fromId(c)}catch(z){return console.warn(`Failed to load basemap ${c}`,z),i().map.basemap}}async function V(l){if(!i()||!i().map||!l){console.log("MapView or target spatial reference is not available","mapView:",i(),"target:",l);return}const c=y(l),L=y(i().spatialReference??void 0);if(console.log(`Ensuring map view spatial reference compatibility: target WKID=${c}, current WKID=${L}`),!c||c===L)return;const[{default:z}]=await Promise.all([Pe(()=>import("../chunks/BEZFO2vt.js").then(T=>T.M),__vite__mapDeps([7,1,2,3,8,4,5,6,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37]),import.meta.url)]),ie=await P(c),G=i().map.layers.toArray(),X=i().map.ground;i().map.removeAll();const B=new z({basemap:ie??void 0,ground:X});B.spatialReference=l,B.layers.addMany(G),i().map=B,await i().when()}var oe=ca(),K=_(oe);{var te=l=>{var c=ta(),L=_(c),z=_(L);g(L),g(c),re(()=>le(z,`${m.error.message??""}. ${m.error?.details?.httpStatus===0?"Reason: CORS Error. See console for more information.":""}`)),o(l,c)},we=l=>{var c=D(),L=x(c);{var z=G=>{var X=ra(),B=_(X);nt(B,{class:"size-5"}),g(X),o(G,X)},ie=G=>{var X=D(),B=x(X);Y(B,()=>lt,(T,H)=>{H(T,{children:(Ne,Ze)=>{var Me=D(),et=x(Me);{var We=ye=>{var a=D(),u=x(a);Y(u,()=>ct,(s,p)=>{p(s,{children:(q,Q)=>{Be();var ge=je("No layers match your search.");o(q,ge)},$$slots:{default:!0}})}),o(ye,a)},Ve=ye=>{var a=D(),u=x(a);Qe(u,17,()=>e(F),s=>s.id,(s,p)=>{var q=D(),Q=x(q);{let ge=J(()=>e(A).has(e(p).id)?"layer-selected":"");Y(Q,()=>ut,(Le,ke)=>{ke(Le,{onclick:()=>Z(e(p).id),get class(){return e(ge)},children:(Ie,Se)=>{var Fe=D(),tt=x(Fe);{var ze=ce=>{var de=aa(),_e=_(de);nt(_e,{class:"size-4"});var fe=ne(_e,2),xe=_(fe);g(fe),g(de),re(()=>le(xe,`Loading ${e(p).title??"Untitled layer"??""}...`)),o(ce,de)},ft=ce=>{var de=la(),_e=x(de);{var fe=k=>{var N=na(),ae=_(N);dr(ae,{}),g(N),o(k,N)};W(_e,k=>{v(e(p).id)&&k(fe)})}var xe=ne(_e,2),Ae=_(xe),rt=_(Ae,!0);g(Ae);var ve=ne(Ae,2);{var De=k=>{var N=oa(),ae=_(N,!0);g(N),re(()=>{Je(N,"title",e(p).description),le(ae,e(p).description)}),o(k,N)};W(ve,k=>{e(p).description&&k(De)})}var me=ne(ve,2);{var Oe=k=>{var N=ia(),ae=_(N,!0);g(N),re(()=>le(ae,e(p).type??"")),o(k,N)};W(me,k=>{e(p).type&&k(Oe)})}var Te=ne(me,2);{var be=k=>{var N=sa(),ae=_(N),he=ne(ae);{var Ce=pe=>{var se=je();se.nodeValue=" (auto aligns view)",o(pe,se)};W(he,pe=>{b[e(p).spatialReferenceWkid]&&pe(Ce)})}g(N),re(()=>le(ae,`WKID ${e(p).spatialReferenceWkid??""} `)),o(k,N)};W(Te,k=>{e(p).spatialReferenceWkid&&k(be)})}g(xe),re(()=>{Je(Ae,"title",e(p).title),le(rt,e(p).title??"Untitled layer")}),o(ce,de)};W(tt,ce=>{e(S)===e(p).id?ce(ze):ce(ft,!1)})}o(Ie,Fe)},$$slots:{default:!0}})})}o(s,q)}),o(ye,a)};W(et,ye=>{e(F).length===0?ye(We):ye(Ve,!1)})}o(Ne,Me)},$$slots:{default:!0}})}),o(G,X)};W(L,G=>{m.isLoading?G(z):G(ie,!1)},!0)}o(l,c)};W(K,l=>{m.error?l(te):l(we,!1)})}g(oe),o($,oe),Ee()}var da=w("<arcgis-layer-list></arcgis-layer-list>",2),fa=w('<div id="search-slot" class="absolute top-3 left-1/2 z-10 -translate-x-1/2"><!></div>'),ma=w("<arcgis-map><!></arcgis-map>",2);function Ka($,t){Re(t,!0);const i=new ea;let h=I(null),m=I(null),S=I(null),n=I(null),M=I(null),A=I(null),R=I(null),E=I(null),b=I(!1);ot(async()=>{const f=await F(),y=new Ke(f.organisations);i.add(yt,f),i.add(Ke,y),await U(),r(M,O(),!0),r(A,Z(),!0),r(R,ee(),!0),r(E,v(),!0)});async function F(){const f=await fetch(hr("/config/maps/config.json"));if(!f.ok)throw new Error(`Failed to load maps config: ${f.status} ${f.statusText}`);const y=await f.json();return new yt(y.organisations)}async function j(){e(S)&&(r(h,e(S).view,!0),e(n)&&(e(n).view=e(h),e(n).listItemCreatedFunction=f=>{const{item:y}=f;y.layer.type!="group"&&(y.panel={content:"legend",open:!0})}))}async function U(){await Pe(()=>import("../chunks/BRIeeldl.js").then(f=>f.a),__vite__mapDeps([152,153,154,145,1,2,3,10,11,4,5,6,155,156,12,157,9,158,159,17,26,15,160,161,162,54,25,55,24,20,21,22,163,164]),import.meta.url),await Pe(()=>import("../chunks/DN8pD2EM.js"),__vite__mapDeps([165,166,154,145,1,2,3,10,11,4,5,6,155,167,168,169,170,171,172,173,174,175,156,176,177,153,12,157,17,161,178,59,9,15,55,179,20,21,22,33,79,80,35,36,180,129,130,121,122,57,24,58,13,25,60,61,62,63,64,65,181,132,133,182,102,103,104,183,184,185,186,84,187,83,188,189,190,118,119,120,97,98,99,100,53,54,41,32,42,56,94,101,107,123,43,124,125,47,126,127,128,131,96,105,106,108,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,164]),import.meta.url),await Pe(()=>import("../chunks/BgIfDPrD.js"),__vite__mapDeps([219,166,154,145,1,2,3,10,11,4,5,6,155,167,168,220,171,173,221,176,156,175,222,223,224,225,183,153,12,157,226,38,39,25,40,22,41,32,33,42,20,21,43,9,23,71,72,17,227,53,54,55,24,56,57,58,59,13,60,61,62,63,64,65,34,228,229,159,26,230,15,231,7,8,14,16,18,19,27,28,29,30,31,35,36,37,91,47,158,89,69,52,232,182,233,234,50,51,209,235,236,237,238,239,240,241,208,242,243,214,244,218,163,0,44,45,46,48,49,66,67,68,70,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,90,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,146,147,148,149,150,151]),import.meta.url)}st(()=>{r(M,null),r(A,null),r(R,null),r(E,null)});function O(){const f={id:"add-web-map",name:"Add web map",description:"Fetch and display web maps.",group:"Maps",shortcut:["Ctrl","M"],inputPlaceholder:"Search web maps...",execute:async y=>{},component:Yr,props:y=>({commandSearchContext:i,mapView:e(h),inputPlaceholder:f.inputPlaceholder})};return f}function Z(){const f={id:"add-layer",name:"Add layers",description:"Fetch and display layers.",group:"Maps",shortcut:["Ctrl","L"],execute:async y=>{},component:ua,props:y=>({commandSearchContext:i,mapView:e(h),inputPlaceholder:f.inputPlaceholder})};return f}function ee(){return{id:"add-organisation",name:"Add organisation",description:"Find and add an organisation to filter items by.",group:"Maps",shortcut:["Ctrl","O"],inputPlaceholder:"Search organisations...",component:Zr,execute:async f=>{},props:f=>({commandSearchContext:i,inputPlaceholder:"Search organisations..."})}}function v(){return{id:"clear-map",name:"Clear map",description:"Clear all layers and reset the map view.",shortcut:["Ctrl","C"],execute:async f=>{e(h)&&e(h).map&&(e(h).map.layers.removeAll(),e(h).map.basemap="gray"),f.deactivate()}}}var d=D(),C=x(d);{const f=P=>{wt(P,{class:"h-full",children:(V,oe)=>{var K=da();it(K,1,"mx-2 min-h-20"),at(K,te=>r(n,te),()=>e(n)),o(V,K)},$$slots:{default:!0}})},y=P=>{var V=ma();it(V,1,"relative h-full w-full"),_t(V,"basemap","gray"),_t(V,"center","-2.231774828836059,53.46531847221502"),_t(V,"zoom","15");var oe=_(V);{var K=te=>{var we=fa(),l=_(we);{let c=J(()=>[e(R),e(M),e(A),e(E)]);zr(l,{class:"w-full max-w-md",get commandSearchContext(){return i},get commands(){return e(c)},get ref(){return e(m)},set ref(L){r(m,L,!0)}})}g(we),o(te,we)};W(oe,te=>{e(M)&&e(A)&&e(R)&&e(E)&&te(K)})}g(V),at(V,te=>r(S,te),()=>e(S)),ht("arcgisViewReadyChange",V,j),o(P,V)};Y(C,()=>vr,(P,V)=>{V(P,{get isOpen(){return e(b)},onToggle:()=>r(b,!e(b)),sidebarContent:f,mainContent:y,$$slots:{sidebarContent:!0,mainContent:!0}})})}o($,d),Ee()}export{Ka as component};
