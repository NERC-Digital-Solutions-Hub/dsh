const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/DVzVZBBg.js","../chunks/DvUDi2Se.js","../chunks/CnfuZz2S.js","../chunks/BYatcg2i.js","../chunks/DSvukMJ1.js","../chunks/PPVm8Dsz.js","../chunks/DedWa6hQ.js","../chunks/CbAk7Q2g.js","../chunks/Dtl6Huvk.js","../chunks/JZrX1DQH.js","../chunks/InWWYu7p.js","../chunks/BtRNH9HO.js","../chunks/C3DztaFN.js","../chunks/Fd-zc6xv.js","../chunks/CLdLWz9D.js","../chunks/Bx7Drccn.js","../chunks/Bstk8l7f.js","../chunks/Bs5I5-7o.js","../chunks/BJ6KxFoX.js","../chunks/Dg2Cy1wG.js","../chunks/Cfk1RgA5.js","../chunks/CJqWAG8q.js","../chunks/BNRAtZeH.js","../chunks/DTbuUgvd.js","../chunks/eb6qfy6k.js","../chunks/CdZ5E7Js.js","../chunks/D6wORzA5.js","../chunks/D6KPPgz5.js","../chunks/Hpj2QL01.js","../chunks/DHdURl-u.js","../chunks/B8bQhW-6.js","../chunks/Cl5lrJ4c.js","../chunks/CSgXBDAV.js","../chunks/MtSiOt06.js","../chunks/C0wm8_Yw.js","../chunks/XEWFwhUy.js","../chunks/Bcw4sJLc.js","../chunks/BDErjlP0.js","../chunks/elf00Mmu.js","../chunks/BTzO5B6K.js","../chunks/Djp3mnm5.js","../chunks/BkkzFYiK.js","../chunks/DQOJ18NT.js","../chunks/BfvMWYA7.js","../chunks/C2A-cDAk.js","../chunks/pZ2g7Ohf.js","../chunks/DPRDD1To.js","../chunks/DZNpV-Fi.js","../chunks/EzLf78vY.js","../chunks/Ct-FuPNe.js","../chunks/BmZQD3Tc.js","../chunks/Dp3s0ZcO.js","../chunks/B7VbszFd.js","../chunks/CWwez7Ew.js","../chunks/CL2NbQte.js","../chunks/C-gotZDZ.js","../chunks/BYWLb-qP.js","../chunks/Dtr09YEc.js","../chunks/5_frVxKl.js","../chunks/kro8eSGX.js","../chunks/Cj7IhThc.js","../chunks/CsmaOzwV.js","../chunks/WcbF0m06.js","../chunks/D2fJSBL9.js","../chunks/BTFaZ95N.js","../chunks/Db_cRbTq.js","../chunks/9YvG7tFv.js","../chunks/DwIAbcbk.js","../chunks/Bunn428X.js","../chunks/aQeO9QTD.js","../chunks/BVStbsji.js","../chunks/muspHcCn.js","../chunks/BSsBqB8a.js","../chunks/BfUcY0IH.js","../chunks/CVqfDkJl.js","../chunks/C5CzMsLd.js","../chunks/C9lK54Hu.js","../chunks/D26fh4vX.js","../chunks/Cigsg82C.js","../chunks/BwvlIeVB.js","../chunks/Cu2J4Q4w.js","../chunks/DI4_79_v.js","../chunks/ZfJYk1lX.js","../chunks/Cv9IkvcT.js","../chunks/CzgEe7_M.js","../chunks/Co6MM1WB.js","../chunks/L9sxntLJ.js","../chunks/Dz9nnGQp.js","../chunks/BZVu3XrO.js","../chunks/nDOBqX6c.js","../chunks/DPeJS9ie.js","../chunks/GKolV7NZ.js","../chunks/CLfdaVZL.js","../chunks/BvI0vjxO.js","../chunks/BoVlFCoi.js","../chunks/Byb_ddQ1.js","../chunks/DayGv1xo.js","../chunks/DFa2M8Ih.js","../chunks/CB8DDl4O.js","../chunks/Cvu3dz6j.js","../chunks/CjV58eza.js","../chunks/VMSlSy0z.js","../chunks/B9TnOdWG.js","../chunks/B-KfLzZb.js","../chunks/D7MNnqkP.js","../chunks/OVZo4xRf.js","../chunks/DWtdFFwQ.js","../chunks/X9GVov2f.js","../chunks/CEn1iOYu.js","../chunks/BpCBUT2X.js","../chunks/DZpgY3Wp.js","../chunks/BXcKK5tC.js","../chunks/qWbuC5Wj.js","../chunks/B0YVZ3UN.js","../chunks/CTVS09Kb.js","../chunks/ThCcySDx.js","../chunks/BkCRFj7C.js","../chunks/K4FY9oqR.js","../chunks/CL2yxhDV.js","../chunks/COhKi5I6.js","../chunks/hpPpwecu.js","../chunks/C2-YgiZF.js","../chunks/C03-sIHu.js","../chunks/DBzD8FIy.js","../chunks/Ct5BCk5d.js","../chunks/KcazVFlU.js","../chunks/CYsUaMUi.js","../chunks/mxPIBlca.js","../chunks/B1Bh4S2o.js","../chunks/BzFyVeiR.js","../chunks/Bb0xX_Fn.js","../chunks/CFX_YiyI.js","../chunks/CefFkNr2.js","../chunks/DOAJfpyz.js","../chunks/B6Hh54jn.js","../chunks/DKMbv1dP.js","../chunks/BXfupK_G.js","../chunks/BkQcsSCB.js","../chunks/DPb6J-GU.js","../chunks/CwFyj4KC.js","../chunks/JI8MBgth.js","../chunks/QYHQISVP.js","../chunks/Cn-KJRkU.js","../chunks/VEGSGQ51.js","../chunks/CeqSKNOq.js","../chunks/BpS0eVY-.js","../chunks/C9BgZYvd.js","../chunks/D5QddsNZ.js","../chunks/BTdrrTIi.js","../chunks/DqGAFGWo.js","../chunks/CRfvaNoS.js","../chunks/BfuGwL9X.js","../chunks/DyEdvwqw.js","../chunks/Ca0GnHj9.js","../chunks/D7XwZUDn.js","../chunks/DsHDw-MJ.js","../chunks/CTXKbNVE.js","../chunks/B68-e1i2.js","../chunks/DZd6gJy7.js","../chunks/Cm1FCrMa.js","../chunks/C8BmVxiO.js","../chunks/SKPvM9nl.js","../chunks/CJcipZJa.js","../chunks/t7YI7jjt.js","../chunks/BzGHCuFd.js","../chunks/Chk7YAAL.js","../chunks/C4eyRFHZ.js","../chunks/Cgb6qxNH.js","../chunks/CMQCdq-P.js","../chunks/BZbOVUP0.js","../chunks/RkHh7_F4.js","../chunks/DKpmsPfl.js","../chunks/CaVKkSa6.js","../chunks/CKJW_hzu.js","../chunks/_KzNjohN.js","../chunks/B1N-tmtC.js","../chunks/DPw1_jRx.js","../chunks/_rUCDO1N.js","../chunks/QQC62dOK.js","../chunks/CASyCajO.js","../chunks/BiphejqT.js","../chunks/CRKBOk0z.js","../chunks/pDuGEAnG.js","../chunks/NzVRVRqD.js","../chunks/BrScpkSj.js","../chunks/Dqz3n4A5.js","../chunks/rxpTDz6e.js","../chunks/D-YQ4CHs.js","../chunks/D7TOvjcp.js","../chunks/BRjzZcZp.js","../chunks/COHLhXik.js","../chunks/BQBvadb7.js","../chunks/cUAizdnp.js","../chunks/Caulfaw_.js","../chunks/CnOjiBQ4.js","../chunks/9DHXOnVc.js","../chunks/n6UOt7ty.js","../chunks/LQ8II5qk.js","../chunks/BvOub3JO.js","../chunks/DAOJ2vkn.js","../chunks/Bt46m4pd.js","../chunks/bexxTcmF.js","../chunks/Cw4sh3xC.js","../chunks/BjhwDpSk.js","../chunks/B8l_M83k.js","../chunks/CB8wlU_f.js","../chunks/CQM3m500.js","../chunks/UjjEJtDR.js","../chunks/CpiU6G5c.js","../chunks/DwqrsEzQ.js","../chunks/QXap_35O.js","../chunks/DV_D_ms-.js","../chunks/D_qA3yb9.js","../chunks/BBYFSOBi.js","../chunks/CtDOi6ec.js","../chunks/BOEID1Kf.js","../chunks/BRxoU36Y.js","../chunks/CUzevAry.js","../chunks/C8zGwbjb.js","../chunks/BXMBYno9.js","../chunks/BSRsT1j9.js","../chunks/CqGmR_uN.js","../chunks/NpbZkYhY.js"])))=>i.map(i=>d[i]);
import{_ as ze}from"../chunks/PPVm8Dsz.js";import"../chunks/DsnmJJEf.js";import{o as Xe,a as Fe}from"../chunks/BvQjZ8fx.js";import{f as h,p as le,c as C,n as ut,r as I,a as ie,g as e,aG as g,ar as r,a8 as O,u as L,X as xe,U as K,av as Lt,o as be,aZ as ot,aM as kt}from"../chunks/C3YAFalO.js";import{c as R,a as u,f as x,t as Se}from"../chunks/C_zlMU_v.js";import{l as Et,s as Pe,p as N,r as Ze,i as z}from"../chunks/CG7dtwR-.js";import{b as Ye}from"../chunks/1eP6wkfH.js";import{s as X}from"../chunks/BssK7A_K.js";import{s as dt,e as Qe,i as Rt}from"../chunks/D3_op0xR.js";import{c as E}from"../chunks/cB9eePE-.js";import{g as st}from"../chunks/2TaPjkhc.js";import{a as zt,s as Ft,b as Dt,d as Ut}from"../chunks/ClCOGCSH.js";import{I as jt,s as Ot,e as Wt,f as Kt,S as lt,g as ct,h as ft,i as pt}from"../chunks/Uhz644kk.js";import{c as et}from"../chunks/Hj8sYXvt.js";import"../chunks/69_IOA4Y.js";import{C as Nt}from"../chunks/C79VbXc-.js";import{A as Ht,a as Tt,b as Bt}from"../chunks/CnXnFF9a.js";import{S as mt}from"../chunks/B2Sah5Hx.js";import{B as Gt}from"../chunks/D7RGRiPY.js";import{I as qt}from"../chunks/CvnG0RHB.js";import{s as it}from"../chunks/CnfuZz2S.js";import{J as Jt}from"../chunks/CbAk7Q2g.js";import{j as Qt}from"../chunks/CJqWAG8q.js";import{a as Xt,b as Zt}from"../chunks/Bymf4Lh8.js";function Yt(b){return(Xt||Zt)+b}function er(b,s){const i=Et(s,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const f=[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3"}]];jt(b,Pe({name:"command"},()=>i,{get iconNode(){return f},children:(p,P)=>{var a=R(),y=h(a);Ot(y,s,"default",{}),u(p,a)},$$slots:{default:!0}}))}var tr=x("<span><!></span>");function rr(b,s){le(s,!0);let i=N(s,"ref",15,null),f=Ze(s,["$$slots","$$events","$$legacy","ref","class","children"]);var p=tr();zt(p,a=>({"data-slot":"command-shortcut",class:a,...f}),[()=>et("text-muted-foreground ml-auto text-xs tracking-widest",s.class)]);var P=C(p);dt(P,()=>s.children??ut),I(p),Ye(p,a=>i(a),()=>i()),u(b,p),ie()}function ar(b,s){le(s,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let i=Ze(s,["$$slots","$$events","$$legacy"]);const f=[["path",{d:"m12 19-7-7 7-7"}],["path",{d:"M19 12H5"}]];qt(b,Pe({name:"arrow-left"},()=>i,{get iconNode(){return f},children:(p,P)=>{var a=R(),y=h(a);dt(y,()=>s.children??ut),u(p,a)},$$slots:{default:!0}})),ie()}var nr=x('<div class="map-view svelte-1s3dmqi"></div>');function or(b,s){le(s,!0);const i=N(s,"mapView",7);let f=g(null);Xe(()=>{i().container=e(f)}),Fe(()=>{console.log("Destroying MapView in MapView component"),i()&&(i().container=null)});var p=nr();Ye(p,P=>r(f,P),()=>e(f)),u(b,p),ie()}class sr{#r=g(null);#e=g(!1);#t=g(null);async fetchWebMaps(s){r(this.#e,!0),r(this.#t,null);try{console.log("[useFetchWebMaps] Fetching web maps from URL:",s);const i=await fetch(s);if(!i.ok)throw new Error(`Failed to fetch web maps: ${i.status} ${i.statusText}`);const f=await i.json();r(this.#r,f,!0)}catch(i){r(this.#t,i,!0)}finally{r(this.#e,!1)}}get response(){return e(this.#r)}get isLoading(){return e(this.#e)}get error(){return e(this.#t)}}var lr=x('<span class="m-0 ml-[-5px] inline-flex max-w-[10rem] items-center overflow-hidden rounded border border-border px-1 py-0.5 text-xs font-medium text-ellipsis whitespace-nowrap text-muted-foreground"> </span> <span aria-hidden="true" class="h-5 w-px bg-border"></span>',1),ir=x('<div class="flex h-9 items-center gap-2 border-b pl-2" data-slot="command-input-wrapper"><span class="flex h-full min-w-[1.25rem] shrink-0 items-center justify-center text-muted-foreground"><!></span> <!> <!></div>');function ur(b,s){le(s,!0);let i=N(s,"ref",15,null),f=N(s,"value",15,""),p=N(s,"iconProps",19,()=>({})),P=Ze(s,["$$slots","$$events","$$legacy","ref","class","value","icon","iconProps","commandId"]);var a=ir(),y=C(a),k=C(y);{var w=v=>{const c=L(()=>s.icon);var m=R(),l=h(m);E(l,()=>e(c),(d,_)=>{_(d,Pe(p))}),u(v,m)},M=v=>{er(v,{class:"size-4 opacity-50"})};z(k,v=>{s.icon?v(w):v(M,!1)})}I(y);var S=O(y,2);{var D=v=>{var c=lr(),m=h(c),l=C(m,!0);I(m),xe(2),K(()=>{Ft(m,"title",s.commandId),X(l,s.commandId)}),u(v,c)};z(S,v=>{s.commandId&&v(D)})}var V=O(S,2);{let v=L(()=>et("flex h-10 flex-1 rounded-md bg-transparent py-3 text-sm outline-hidden placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",s.class));E(V,()=>Wt,(c,m)=>{m(c,Pe({"data-slot":"command-input",get class(){return e(v)}},()=>P,{get ref(){return i()},set ref(l){i(l)},get value(){return f()},set value(l){f(l)}}))})}I(a),u(b,a),ie()}function dr(b,s){le(s,!0);const i=N(s,"disabled",3,!1);Gt(b,{class:"m-0 flex size-7 shrink-0 items-center justify-center rounded-md border-none bg-transparent p-0 text-muted-foreground opacity-50 shadow-none transition hover:bg-transparent hover:text-accent-foreground focus:outline-none focus-visible:border-transparent focus-visible:ring-0 focus-visible:ring-offset-0 focus-visible:outline-none active:ring-0 active:outline-none disabled:pointer-events-none disabled:opacity-50 has-[>svg]:px-0",onclick:()=>{i()||s.onPress?.()},"aria-label":"Return to command search",get disabled(){return i()},children:(f,p)=>{{let P=L(()=>`size-4 ${s.class}`.trim());ar(f,{get class(){return e(P)}})}},$$slots:{default:!0}}),ie()}var cr=x('<span class="text-xs text-muted-foreground"> </span>'),fr=x('<div class="flex flex-col gap-0.5"><span class="text-sm leading-tight font-medium"> </span> <!></div> <!>',1),pr=x("<!> <!>",1),mr=x('<div class="px-4 pb-3"><!></div>'),vr=x("<!> <!>",1),_r=x('<div class="px-4 pb-3"><!></div>'),hr=x('<p class="text-sm text-muted-foreground">No panel registered for this command.</p>'),gr=x('<div class="pr-2 pb-2 pl-2"><!></div>'),wr=x("<!> <!> <!>",1),yr=x("<!> <!>",1),xr=x("<div><!></div>");function br(b,s){le(s,!0);let i=N(s,"ref",15,null),f=N(s,"commands",19,()=>[]),p=N(s,"placeholder",3,"Search commands..."),P=N(s,"emptyMessage",3,"No commands found."),a=g(null),y=g(null),k=g(null),w=g(null),M=g(null),S=g(null),D=g(""),V=g(!1),v=g(Lt(p())),c=g(null),m=!1,l=g(null),d=!1,_=null,$=null;const U=L(()=>{const t=new Map;for(const n of f())t.set(n.id,n);return Array.from(t.values())}),me=L(()=>{const t=new Map;for(const n of e(U)){const o=n.group??null,A=t.get(o);A?A.push(n):t.set(o,[n])}for(const[,n]of t)n.sort((o,A)=>o.name.localeCompare(A.name));return t});function re(t,n=!1){n&&(m=!0),r(D,t,!0)}function De(){r(c,null),r(v,p()),m=!1}be(()=>{const t=e(c);if(t){if(m){m=!1;return}t(e(D))}}),be(()=>{e(a)||r(v,p())});function H(){if($)try{$()}catch(t){console.error("Failed to dispose command session",t)}$=null,r(k,null),r(w,null),De(),r(y,null)}function T(){e(a)&&(H(),r(a,null),r(S,null),r(M,null),re("",!0),r(V,!0))}function ve(){e(l)?.blur()}function oe(t,n){if(!t.component)return null;const o=t.props;return o?{component:t.component,props:()=>o(n)}:{component:t.component}}function Z(t,n){const o=t.createSession?.(n);if(o){$=o.dispose??null,Object.prototype.hasOwnProperty.call(o,"input")?r(k,o.input??null,!0):r(k,null),Object.prototype.hasOwnProperty.call(o,"content")?r(w,o.content??null,!0):r(w,oe(t,n),!0);return}$=null,r(k,null),r(w,oe(t,n),!0)}function _e(t){const n=t.id;return{deactivate:()=>{!e(a)||e(a).id!==n||T()},isActive:o=>!e(a)||e(a).id!==n?!1:o?e(a).id===o:!0,setIsOpen:(o,A)=>{if(!e(a)||e(a).id!==n)return;if(o){d=!1,r(V,!0);return}const Y=A?.preserveActive??!0;Ie(Y)},setInputSurface:o=>{!e(a)||e(a).id!==n||r(k,o,!0)},setContentSurface:o=>{!e(a)||e(a).id!==n||r(w,o,!0)},getInputValue:()=>e(D),setInputValue:o=>{!e(a)||e(a).id!==n||re(o,!0)},setInputHandler:o=>{if(!(!e(a)||e(a).id!==n)){if(r(c,o,!0),!o){m=!1;return}o(e(D))}},setPlaceholder:o=>{!e(a)||e(a).id!==n||r(v,o,!0)},resetPlaceholder:()=>{!e(a)||e(a).id!==n||r(v,p())}}}function $e(t){const n=e(y);if(!t)return n?{runtime:n}:{};if(!n)return{};const{props:o}=t;return o?{...typeof o=="function"?o(n):o,runtime:n}:{runtime:n}}function Ce(t){return`${t.name} ${t.description??""}`.trim()}async function Ae(t){if(e(a)?.id===t.id){T();return}H(),r(S,null),r(M,t.id,!0),r(V,!0),e(l)&&e(l).focus();const n=_e(t);r(y,n,!0),r(a,t,!0),Z(t,n);try{await t.execute(n)}catch(o){r(S,o instanceof Error?o:new Error("Failed to execute the command."),!0)}finally{r(M,null),re("",!0)}}function Ue(t){const n=t.key.toLowerCase();if((t.metaKey||t.ctrlKey)&&n==="p"){if(t.preventDefault(),e(a)){T();return}e(l)&&e(l).focus();return}if(n==="escape"){if(e(a)){t.preventDefault(),T(),ve();return}e(V)&&(t.preventDefault(),r(V,!1),ve());return}if(!e(a))for(const A of e(U)){if(!A.shortcut)continue;const Y=A.shortcut.join(" ").toLowerCase(),B=[];if(t.metaKey&&B.push("âŒ˜"),t.ctrlKey&&B.push("Ctrl"),t.altKey&&B.push("Alt"),t.shiftKey&&B.push("Shift"),B.push(t.key.length===1?t.key.toUpperCase():t.key),B.join(" ").toLowerCase()===Y.toLowerCase()){t.preventDefault(),Ae(A);break}}}function tt(){r(V,!0)}function Ie(t=!1){d=t,r(V,!1)}function je(t){const n=_;if(!n)return;const o=t.target;o&&n.contains(o)||e(V)&&Ie(!!e(a))}be(()=>{if(!e(V)){if(re("",!0),!e(a)){d=!1;return}if(d){d=!1;return}H(),r(a,null),r(S,null)}}),be(()=>{i(_)}),Fe(()=>{H(),r(a,null),r(S,null),r(M,null),r(y,null),r(k,null),r(w,null),$=null,d=!1,r(V,!1),re("",!0),r(l,null),_=null,i(null)});var ue=xr();st("pointerdown",ot,je),st("keydown",ot,Ue);var Oe=C(ue);E(Oe,()=>Kt,(t,n)=>{n(t,{children:(o,A)=>{var Y=yr(),B=h(Y);{let de=L(()=>e(a)?e(a).inputPlaceholder??e(v):e(v)),Le=L(()=>e(a)?dr:void 0),We=L(()=>e(a)?{onPress:T,disabled:e(M)===e(a).id}:void 0),Ke=L(()=>e(a)?.id);ur(B,{get placeholder(){return e(de)},onfocus:()=>tt(),get icon(){return e(Le)},get iconProps(){return e(We)},get commandId(){return e(Ke)},get value(){return e(D)},set value(Ve){r(D,Ve,!0)},get ref(){return e(l)},set ref(Ve){r(l,Ve,!0)}})}var he=O(B,2);{var Me=de=>{var Le=R(),We=h(Le);{var Ke=ge=>{lt(ge,{children:(ke,Ne)=>{var Ee=R(),Re=h(Ee);E(Re,()=>ct,(He,Te)=>{Te(He,{children:(G,ce)=>{var W=pr(),se=h(W);E(se,()=>ft,(ae,j)=>{j(ae,{children:(q,ee)=>{xe();var J=Se();K(()=>X(J,P())),u(q,J)},$$slots:{default:!0}})});var fe=O(se,2);Qe(fe,17,()=>Array.from(e(me).entries()),Rt,(ae,j)=>{var q=L(()=>kt(e(j),2));let ee=()=>e(q)[1];var J=R(),ne=h(J);Qe(ne,17,ee,Q=>Q.id,(Q,F)=>{var we=R(),pe=h(we);{let vt=L(()=>Ce(e(F)));E(pe,()=>pt,(_t,ht)=>{ht(_t,{get value(){return e(vt)},onclick:()=>Ae(e(F)),children:(gt,Ar)=>{var rt=fr(),Be=h(rt),Ge=C(Be),wt=C(Ge,!0);I(Ge);var yt=O(Ge,2);{var xt=te=>{var ye=cr(),qe=C(ye,!0);I(ye),K(()=>X(qe,e(F).description)),u(te,ye)};z(yt,te=>{e(F).description&&te(xt)})}I(Be);var bt=O(Be,2);{var Pt=te=>{mt(te,{class:"ml-auto size-4 text-muted-foreground"})},$t=te=>{var ye=R(),qe=h(ye);{var Ct=Je=>{var at=R(),It=h(at);E(It,()=>rr,(Mt,Vt)=>{Vt(Mt,{children:(St,Lr)=>{xe();var nt=Se();K(At=>X(nt,At),[()=>e(F).shortcut?.join(" + ")]),u(St,nt)},$$slots:{default:!0}})}),u(Je,at)};z(qe,Je=>{e(F).shortcut?.length&&Je(Ct)},!0)}u(te,ye)};z(bt,te=>{e(M)===e(F).id?te(Pt):te($t,!1)})}K(()=>X(wt,e(F).name)),u(gt,rt)},$$slots:{default:!0}})})}u(Q,we)}),u(ae,J)}),u(G,W)},$$slots:{default:!0}})}),u(ke,Ee)},$$slots:{default:!0}})},Ve=ge=>{var ke=wr(),Ne=h(ke);{var Ee=G=>{const ce=L(()=>e(k).component);var W=mr(),se=C(W);{let fe=L(()=>$e(e(k)));E(se,()=>e(ce),(ae,j)=>{j(ae,Pe(()=>e(fe)))})}I(W),u(G,W)};z(Ne,G=>{e(k)&&G(Ee)})}var Re=O(Ne,2);{var He=G=>{var ce=_r(),W=C(ce);E(W,()=>Ht,(se,fe)=>{fe(se,{variant:"destructive",children:(ae,j)=>{var q=vr(),ee=h(q);E(ee,()=>Tt,(ne,Q)=>{Q(ne,{children:(F,we)=>{xe();var pe=Se();K(()=>X(pe,`${e(a).name??""} failed`)),u(F,pe)},$$slots:{default:!0}})});var J=O(ee,2);E(J,()=>Bt,(ne,Q)=>{Q(ne,{children:(F,we)=>{xe();var pe=Se();K(()=>X(pe,e(S).message)),u(F,pe)},$$slots:{default:!0}})}),u(ae,q)},$$slots:{default:!0}})}),I(ce),u(G,ce)};z(Re,G=>{e(S)&&G(He)})}var Te=O(Re,2);lt(Te,{children:(G,ce)=>{var W=gr(),se=C(W);{var fe=j=>{const q=L(()=>e(w).component);var ee=R(),J=h(ee);{let ne=L(()=>$e(e(w)));E(J,()=>e(q),(Q,F)=>{F(Q,Pe(()=>e(ne)))})}u(j,ee)},ae=j=>{var q=R(),ee=h(q);E(ee,()=>Nt,(J,ne)=>{ne(J,{class:"px-0",children:(Q,F)=>{var we=hr();u(Q,we)},$$slots:{default:!0}})}),u(j,q)};z(se,j=>{e(w)?j(fe):j(ae,!1)})}I(W),u(G,W)},$$slots:{default:!0}}),u(ge,ke)};z(We,ge=>{e(a)?ge(Ve,!1):ge(Ke)})}u(de,Le)};z(he,de=>{e(V)&&de(Me)})}u(o,Y)},$$slots:{default:!0}})}),I(ue),Ye(ue,t=>_=t,()=>_),K(t=>Ut(ue,1,t),[()=>Dt(et("space-y-4",s.class))]),u(b,ue),ie()}var Pr=x('<div class="error-message svelte-11six79"><p class="text-sm text-red-600"> </p></div>'),$r=x('<div class="flex items-center gap-2"><!> <span class="title-text w-full font-medium text-foreground svelte-11six79"> </span></div>'),Cr=x('<span class="description-text text-xs text-gray-500 svelte-11six79"> </span>'),Ir=x('<div class="flex w-full min-w-0 flex-col gap-0.5"><span class="title-text font-medium text-foreground svelte-11six79"> </span> <!></div>'),Mr=x('<div class="item-container svelte-11six79"><!> <!></div>');function Vr(b,s){le(s,!0);const i=N(s,"mapView",7),f=N(s,"runtime",3,null),p=new sr;let P=g(null),a=g(null),y=g("");const k=L(()=>{const l=p.response?.results??[],d=e(y).trim().toLowerCase();return d?l.filter(_=>{const $=typeof _?.title=="string"?_.title.toLowerCase():"",U=typeof _?.description=="string"?_.description.toLowerCase():"";return $.includes(d)||U.includes(d)}):l});Xe(async()=>{const l=Yt("/maps-web-map.json");await p.fetchWebMaps(l)});let w=null,M=null,S=s.inputPlaceholder??"Search...";be(()=>{const l=f(),d=s.inputPlaceholder??"Search...";if(!l){M?.(),M=null,w=null,r(y,""),S=d;return}if(l===w){d!==S&&(l.setPlaceholder(d),S=d);return}M?.(),M=null,w=null,S=d;const _=U=>{r(y,U,!0)};l.setPlaceholder(d),l.setInputHandler(_);const $=l.getInputValue();r(y,$,!0),$&&(l.setInputValue(""),r(y,"")),M=()=>{l.setInputHandler(null),l.resetPlaceholder(),l.setInputValue(""),w===l&&(w=null),r(y,"")},w=l}),Fe(()=>{M?.(),M=null,w=null});async function D(l){if(!i()){console.error("MapView is not initialized"),r(a,"MapView is not ready. Please wait and try again.");return}r(P,l,!0),r(a,null);try{console.log(`Loading web map with ID: ${l}`);const[{default:d}]=await Promise.all([ze(()=>import("../chunks/DVzVZBBg.js").then(re=>re.W),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155]),import.meta.url)]),_="https://nercdsh.dev.azure.manchester.ac.uk/portal";it.portalUrl=_,console.log("Portal URL configured:",it.portalUrl);const{addProxyRule:$}=Jt;console.log("Adding proxy rule for portal traffic"),$({urlPrefix:"https://nercdsh.dev.azure.manchester.ac.uk",proxyUrl:"/proxy/Java/proxy.jsp"});const U=new d({portalItem:{id:l,portal:{url:_}}});await U.load(),console.log("Web map loaded successfully"),i().map=U,console.log("Web map applied to MapView"),await Qt(()=>i().ready),console.log("MapView updated with new web map");const me=U.initialViewProperties?.viewpoint?.targetGeometry;me&&(await i().goTo(me),console.log("MapView navigated to web map initial viewpoint")),f()?.setIsOpen(!1)}catch(d){console.error("Error loading web map:",d),r(a,d instanceof Error?d.message:"Failed to load web map",!0)}finally{r(P,null)}}var V=Mr(),v=C(V);{var c=l=>{var d=Pr(),_=C(d),$=C(_,!0);I(_),I(d),K(()=>X($,e(a))),u(l,d)};z(v,l=>{e(a)&&l(c)})}var m=O(v,2);E(m,()=>ct,(l,d)=>{d(l,{children:(_,$)=>{var U=R(),me=h(U);{var re=H=>{var T=R(),ve=h(T);E(ve,()=>ft,(oe,Z)=>{Z(oe,{children:(_e,$e)=>{xe();var Ce=Se("No web maps match your search.");u(_e,Ce)},$$slots:{default:!0}})}),u(H,T)},De=H=>{var T=R(),ve=h(T);Qe(ve,17,()=>e(k),oe=>oe.id,(oe,Z)=>{var _e=R(),$e=h(_e);E($e,()=>pt,(Ce,Ae)=>{Ae(Ce,{onclick:()=>D(e(Z).id),children:(Ue,tt)=>{var Ie=R(),je=h(Ie);{var ue=t=>{var n=$r(),o=C(n);mt(o,{class:"size-4"});var A=O(o,2),Y=C(A);I(A),I(n),K(()=>X(Y,`Loading ${e(Z).title??"Untitled web map"??""}...`)),u(t,n)},Oe=t=>{var n=Ir(),o=C(n),A=C(o,!0);I(o);var Y=O(o,2);{var B=he=>{var Me=Cr(),de=C(Me,!0);I(Me),K(()=>X(de,e(Z).description)),u(he,Me)};z(Y,he=>{e(Z).description&&he(B)})}I(n),K(()=>X(A,e(Z).title??"Untitled web map")),u(t,n)};z(je,t=>{e(P)===e(Z).id?t(ue):t(Oe,!1)})}u(Ue,Ie)},$$slots:{default:!0}})}),u(oe,_e)}),u(H,T)};z(me,H=>{e(k).length===0?H(re):H(De,!1)})}u(_,U)},$$slots:{default:!0}})}),I(V),u(b,V),ie()}var Sr=x('<!> <div class="map-layout svelte-10vgo84"><!></div>',1);function ra(b,s){le(s,!0);let i=g(null),f=g(null),p=g(null),P=g(null),a=g(null);Xe(async()=>{const[{default:c}]=await Promise.all([ze(()=>import("../chunks/CTXKbNVE.js").then($=>$.a2),__vite__mapDeps([156,1,2,3,4,5,47,29,48,27,15,6,7,17,49,37,50,25,26,51,10,11,12,13,30,21,102,103,23,38,39,157,158,159,31,160,161,19,20,162,8,9,14,16,18,22,24,28,32,33,34,35,36,40,41,42,43,44,45,46,163,62,63,64,65,66,67,68,69,70,71,72,73,78,56,164,83,77,61,165,166,167,168,169,170,59,60,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187]),import.meta.url)]);r(i,new c({map:{basemap:"streets-vector"},zoom:15,center:[-90.1928,38.6226]}),!0),e(i).ui.move("zoom","bottom-right");const[{default:m}]=await Promise.all([ze(()=>import("../chunks/D7TOvjcp.js").then($=>$.L),__vite__mapDeps([188,5,1,2,3,4,10,11,12,13,7,45,164,21,159,23,6,31,160,20,189,190,191,65,187]),import.meta.url)]),l=new m({view:e(i)});e(i).ui.add(l,{position:"top-left"});const[{default:d}]=await Promise.all([ze(()=>import("../chunks/cUAizdnp.js"),__vite__mapDeps([192,1,2,3,4,21,6,5,7,159,23,11,12,31,160,10,13,193,25,26,27,69,64,194,111,40,41,37,15,17,42,110,115,195,114,196,197,19,20,198,122,123,124,28,85,86,29,87,88,62,63,65,45,49,50,66,67,68,14,16,70,71,72,73,81,89,90,91,94,125,126,127,51,128,129,56,130,131,132,133,134,135,136,137,138,84,92,93,95,199,200,201,202,203,168,204,205,206,46,207,187,208,209,210,211,212,213,214,179,215,216,166,172,217,218,219,220,183,221,222,185,190]),import.meta.url)]),_=new d({view:e(i)});e(i).ui.add(_,{position:"top-right"}),r(P,y(),!0),r(a,k(),!0)}),be(()=>{if(!e(i)||!e(f))return;const c=e(i),m=e(f);return c.ui.add(m,{position:"manual"}),()=>{c.ui.remove(m)}}),Fe(()=>{r(P,null),r(a,null),e(i)&&e(i).destroy()});function y(){const c={id:"add-web-map",name:"Add web map",description:"Fetch and display our web maps.",group:"Maps",shortcut:["Ctrl","M"],inputPlaceholder:"Search web maps...",execute:async m=>{r(p,"show-web-maps")},component:Vr,props:m=>({mapView:e(i),inputPlaceholder:c.inputPlaceholder})};return c}function k(){return{id:"add-layer",name:"Add layers",description:"Fetch and display our layers.",group:"Maps",shortcut:["Ctrl","L"],execute:async c=>{}}}var w=Sr(),M=h(w);{var S=c=>{{let m=L(()=>[e(P),e(a)]);br(c,{class:"position-absolute top-3 left-1/2 z-1 -translate-x-1/2 transform",get commands(){return e(m)},get ref(){return e(f)},set ref(l){r(f,l,!0)}})}};z(M,c=>{e(P)&&e(a)&&c(S)})}var D=O(M,2),V=C(D);{var v=c=>{or(c,{get mapView(){return e(i)}})};z(V,c=>{e(i)&&c(v)})}I(D),u(b,w),ie()}export{ra as component};
