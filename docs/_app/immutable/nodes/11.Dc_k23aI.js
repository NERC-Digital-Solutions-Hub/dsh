const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/Bs6xTxvz.js","../chunks/CDGqq53N.js","../chunks/BzZgUCJc.js","../chunks/C9_KfL0q.js","../chunks/PPVm8Dsz.js","../chunks/Cad-p0g1.js","../chunks/COT3swUQ.js","../chunks/BsJbwhv8.js","../chunks/Cm7AOsqL.js","../chunks/D1sKJjB8.js","../chunks/C3oh_tnt.js","../chunks/C_1gjxB4.js","../chunks/fh0BQpDQ.js","../chunks/BNR3I_eR.js","../chunks/Cp_8tW2x.js","../chunks/Dy3IPmu3.js","../chunks/CicY3o9G.js","../chunks/bnayRBMH.js","../chunks/DHehJAQP.js","../chunks/NEmuse4e.js","../chunks/DyeKTZUU.js","../chunks/Bcsiu1z4.js","../chunks/C-nwrPug.js","../chunks/C0wm8_Yw.js","../chunks/B0eu-fbb.js","../chunks/B92oQJPd.js","../chunks/BPKnb2Ep.js","../chunks/BP3dapwT.js","../chunks/9ka9skRU.js","../chunks/BzQEzIrU.js","../chunks/ByYe5JNT.js","../chunks/B87vTgcy.js","../chunks/CPwmGbun.js","../chunks/clW6bTka.js","../chunks/CY1ScL2v.js","../chunks/C6j0c8D7.js","../chunks/BnIkuiB_.js","../chunks/BobhZSEo.js","../chunks/DGRj8LLO.js","../chunks/BuFC1hBS.js","../chunks/Di9axRGX.js","../chunks/BcU1P1CV.js","../chunks/BkaRJQOf.js","../chunks/DujhAnCs.js","../chunks/CWMNWfLw.js","../chunks/CmkbQrYx.js","../chunks/EQ54Yfcd.js","../chunks/DuNa-JhG.js","../chunks/3SbGqcbX.js","../chunks/OuCfdC0r.js","../chunks/Cbf23dJy.js","../chunks/CWaspPwN.js","../chunks/vu8FjO6O.js","../chunks/CvbnrAEx.js","../chunks/BJLSrlOq.js","../chunks/2al6WD4b.js","../chunks/CyyW12qt.js","../chunks/Dpaauiqf.js","../chunks/DstbFQD6.js","../chunks/CxKE0Jjq.js","../chunks/BDmhfu3R.js","../chunks/DxjXvSCh.js","../chunks/qyF9FwQ9.js","../chunks/XI-Li77m.js","../chunks/DjsBn23O.js","../chunks/DbEENCEu.js","../chunks/Cy-nR8IT.js","../chunks/DX8bWC0d.js","../chunks/CjvOpC9P.js","../chunks/BaNElx7S.js","../chunks/DMoBPOW4.js","../chunks/UcZE3skJ.js","../chunks/CaYZrGFV.js","../chunks/B8B24qty.js","../chunks/BCXDwddQ.js","../chunks/DOBtub6T.js","../assets/index.CQED0rIl.css","../chunks/CdDXOJ3Y.js","../assets/component-utils.R4SXog4D.css","../chunks/DL5OcIt-.js","../chunks/DY7bJyoW.js","../chunks/CZ1cFYIj.js","../chunks/HoNWw-UZ.js","../chunks/DnsAcW94.js","../chunks/BQBvadb7.js","../chunks/D-YQ4CHs.js","../chunks/DLVnMPmE.js","../chunks/DPxGaGY-.js","../chunks/Bc_TmxSc.js","../chunks/4u0wcz6f.js","../chunks/C6pzAkdR.js","../chunks/Bkm1woOz.js","../chunks/DkWWe1YB.js","../chunks/DXGw_0Ww.js","../chunks/DlHjpvET.js","../chunks/DHAweUE4.js","../chunks/DtjklSP3.js","../chunks/CEIZYuf2.js","../chunks/CYB2EK_d.js","../chunks/SyT8jeOM.js","../chunks/DY-T12td.js","../chunks/BLoUYHSD.js","../chunks/CYsY5VfR.js","../chunks/B1ogp8lg.js","../chunks/BNEZVyfC.js","../chunks/BBNU7JHv.js","../chunks/Dex61Jy7.js","../chunks/ACUHQZfM.js","../chunks/Caulfaw_.js","../chunks/DLgHIcDL.js","../chunks/DU7d-98y.js","../chunks/DKzVzLpH.js","../chunks/BEQnBRaB.js","../chunks/BvOub3JO.js","../chunks/W0UZelZr.js","../chunks/BkBiEG3b.js","../chunks/BVxmDY2A.js","../chunks/B2s4jCtj.js","../chunks/BRnTRT3N.js","../chunks/JS31i3T8.js","../chunks/8WtPGj6h.js","../chunks/CG7ZQ6BV.js","../chunks/Bb2UHNFn.js","../chunks/BaQT-5Wt.js","../chunks/BvER9tXK.js","../chunks/hsUCLHdy.js","../chunks/DB_HFzqz.js","../chunks/Ce7ly0LS.js","../chunks/awhkIg9R.js","../chunks/DQqmTwIq.js","../chunks/Cnxitj77.js","../chunks/Bxxl7NsE.js","../chunks/CaVKkSa6.js","../chunks/CUzevAry.js","../chunks/C8zGwbjb.js","../chunks/BXRzsev0.js","../chunks/DGkpPXov.js","../chunks/CpKt4gnm.js","../chunks/C7_IYguP.js","../chunks/CaDenjTi.js","../chunks/DcH0oO2S.js","../chunks/C7e3Z5XT.js","../chunks/COzYCy8P.js","../chunks/CHwVPrQX.js","../chunks/HTOW8iPe.js","../chunks/DYslx7It.js","../chunks/DuIgqnlY.js","../chunks/D-Nm-cDg.js","../chunks/DaQyK3nQ.js","../chunks/BBnDJw94.js","../chunks/BqBW39kE.js","../chunks/Ncy6WYEt.js","../chunks/Bsvdop-J.js","../chunks/CwswxHzg.js","../chunks/DmK00UBb.js","../chunks/Cgb6qxNH.js","../chunks/iGtE-x7J.js","../chunks/BMEoQDn3.js","../chunks/BzPGhKjT.js","../chunks/BW5FX2Vq.js","../chunks/B1N-tmtC.js","../chunks/BirX00qr.js","../chunks/y-H9M8xu.js","../chunks/D-qJO60r.js","../chunks/QQC62dOK.js","../chunks/DWdJ8y7A.js","../chunks/DQOO6RKE.js","../chunks/Bi6C4OG6.js"])))=>i.map(i=>d[i]);
import{_ as Re}from"../chunks/PPVm8Dsz.js";import"../chunks/DsnmJJEf.js";import{o as it,a as Pt}from"../chunks/BI5Gp87m.js";import{f as C,p as Ne,n as Et,c as ze,d as g,r as p,ad as Y,Y as J,g as e,a0 as K,$ as Ke,s as O,aA as Fe,w as Ze,b as s,b3 as ar,b4 as nr,aP as or}from"../chunks/Dg8B37cN.js";import{e as sr,g as yt}from"../chunks/2p-loE3l.js";import{c as D,a as o,f as h,t as Ge}from"../chunks/Lqxt2u0_.js";import{l as ir,s as tt,r as It,p as _e,i as M}from"../chunks/DX-cJOE_.js";import{c as Q}from"../chunks/C27fUA72.js";import{a as lr,f as Vt,b as ct,s as qe,e as wt}from"../chunks/ZHUHaqSd.js";import{b as nt}from"../chunks/DRG7OQx7.js";import{s as ae}from"../chunks/Dy6t_wds.js";import{s as Mt,e as et,i as cr}from"../chunks/B3syFVNQ.js";import{e as dr,f as ur,g as dt,h as ut,i as ft}from"../chunks/CZwPzpMR.js";import{c as vt}from"../chunks/DOQyJ1lj.js";import{X as fr,A as vr,a as mr,b as pr,C as gr}from"../chunks/BCYlfsdq.js";import"../chunks/69_IOA4Y.js";import{I as hr,s as _r,S as xt}from"../chunks/Kyo2J1YB.js";import{C as wr}from"../chunks/DLy_QKZY.js";import{S as ot,C as Lt}from"../chunks/B3bwBiAo.js";import{B as yr}from"../chunks/DAMheLE7.js";import{I as xr}from"../chunks/Bc9iEGYw.js";import{a as Cr,b as br}from"../chunks/CUvm1Ruv.js";import{S as Sr}from"../chunks/BzjoCI4e.js";import{H as Pr}from"../chunks/Cad-p0g1.js";import{c as kt}from"../chunks/C8hn-AFl.js";import{S as Ct}from"../chunks/BZOnCu_P.js";import"../chunks/B17Q6ahh.js";import"../chunks/C6j0c8D7.js";function $t(d){return(Cr||br)+d}function Ir(d,t){const m=ir(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const y=[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3"}]];hr(d,tt({name:"command"},()=>m,{get iconNode(){return y},children:(i,x)=>{var n=D(),A=C(n);_r(A,t,"default",{}),o(i,n)},$$slots:{default:!0}}))}function $r(d,t){Ne(t,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let m=It(t,["$$slots","$$events","$$legacy"]);const y=[["path",{d:"m12 19-7-7 7-7"}],["path",{d:"M19 12H5"}]];xr(d,tt({name:"arrow-left"},()=>m,{get iconNode(){return y},children:(i,x)=>{var n=D(),A=C(n);Mt(A,()=>t.children??Et),o(i,n)},$$slots:{default:!0}})),ze()}var Or=h("<span><!></span>");function Rr(d,t){Ne(t,!0);let m=_e(t,"ref",15,null),y=It(t,["$$slots","$$events","$$legacy","ref","class","children"]);var i=Or();lr(i,n=>({"data-slot":"command-shortcut",class:n,...y}),[()=>vt("text-muted-foreground ml-auto text-xs tracking-widest",t.class)]);var x=g(i);Mt(x,()=>t.children??Et),p(i),nt(i,n=>m(n),()=>m()),o(d,i),ze()}function Ar(d,t){d.stopPropagation(),t()?.()}var Er=h('<button type="button" class="pointer-events-none flex h-4 w-0 items-center justify-center rounded text-muted-foreground opacity-0 transition-[width,margin-left,opacity] group-hover:pointer-events-auto group-hover:ml-1 group-hover:w-4 group-hover:opacity-100"><!></button>'),Vr=h('<div><span class="truncate"> </span> <!></div>');function Dt(d,t){Ne(t,!0);let m=_e(t,"onClose",3,null);const y=t.title??t.value;var i=Vr(),x=g(i),n=g(x,!0);p(x);var A=Y(x,2);{var S=L=>{var k=Er();k.__click=[Ar,m];var I=g(k);fr(I,{class:"size-3"}),p(k),J(()=>qe(k,"aria-label",`Clear ${t.value}`)),o(L,k)};M(A,L=>{m()&&L(S)})}p(i),J(L=>{ct(i,1,L),qe(i,"title",y),ae(n,t.value)},[()=>Vt(vt("group inline-flex max-w-[10rem] items-center overflow-hidden rounded border border-border px-1 py-0.5 text-xs font-medium text-muted-foreground transition-all",t.class))]),o(d,i),ze()}sr(["click"]);var Mr=h('<!> <span aria-hidden="true" class="h-5 w-px bg-border"></span>',1),Lr=h('<div class="flex h-9 items-center gap-2 border-b pl-2" data-slot="command-input-wrapper"><span class="flex h-full min-w-[1.25rem] shrink-0 items-center justify-center text-muted-foreground"><!></span> <!> <!></div>');function kr(d,t){Ne(t,!0);let m=_e(t,"ref",15,null),y=_e(t,"value",15,""),i=_e(t,"iconProps",19,()=>({})),x=_e(t,"onCommandClose",3,null),n=It(t,["$$slots","$$events","$$legacy","ref","class","value","icon","iconProps","commandId","onCommandClose"]);var A=Lr(),S=g(A),L=g(S);{var k=_=>{const N=K(()=>t.icon);var $=D(),v=C($);Q(v,()=>e(N),(u,w)=>{w(u,tt(i))}),o(_,$)},I=_=>{Ir(_,{class:"size-4 opacity-50"})};M(L,_=>{t.icon?_(k):_(I,!1)})}p(S);var T=Y(S,2);{var W=_=>{var N=Mr(),$=C(N);Dt($,{get value(){return t.commandId},get title(){return t.commandId},get onClose(){return x()}}),Ke(2),o(_,N)};M(T,_=>{t.commandId&&_(W)})}var b=Y(T,2);{let _=K(()=>vt("flex h-10 flex-1 rounded-md bg-transparent py-3 text-sm outline-hidden placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t.class));Q(b,()=>dr,(N,$)=>{$(N,tt({"data-slot":"command-input",get class(){return e(_)}},()=>n,{get ref(){return m()},set ref(v){m(v)},get value(){return y()},set value(v){y(v)}}))})}p(A),o(d,A),ze()}function Dr(d,t){Ne(t,!0);const m=_e(t,"disabled",3,!1);yr(d,{class:"m-0 flex size-7 shrink-0 items-center justify-center rounded-md border-none bg-transparent p-0 text-muted-foreground opacity-50 shadow-none transition hover:bg-transparent hover:text-accent-foreground focus:outline-none focus-visible:border-transparent focus-visible:ring-0 focus-visible:ring-offset-0 focus-visible:outline-none active:ring-0 active:outline-none disabled:pointer-events-none disabled:opacity-50 has-[>svg]:px-0",onclick:()=>{m()||t.onPress?.()},"aria-label":"Return to command search",get disabled(){return m()},children:(y,i)=>{{let x=K(()=>`size-4 ${t.class}`.trim());$r(y,{get class(){return e(x)}})}},$$slots:{default:!0}}),ze()}var Tr=h('<div class="flex flex-wrap gap-2 px-2 py-0.5"></div>'),Nr=h('<span class="text-xs text-muted-foreground"> </span>'),zr=h('<div class="flex flex-col gap-0.5"><span class="text-sm leading-tight font-medium"> </span> <!></div> <!>',1),Br=h("<!> <!>",1),Fr=h('<div class="px-4 pb-3"><!></div>'),Wr=h("<!> <!>",1),jr=h('<div class="px-4 pb-3"><!></div>'),Ur=h('<p class="text-sm text-muted-foreground">No panel registered for this command.</p>'),Kr=h('<div class="pr-2 pb-2 pl-2"><!></div>'),Gr=h("<!> <!> <!>",1),qr=h("<!> <!>",1),Hr=h("<!> <!>",1),Qr=h("<div><!></div>");function Yr(d,t){Ne(t,!0);let m=_e(t,"ref",15,null),y=_e(t,"commands",19,()=>[]),i=_e(t,"placeholder",3,"Commands..."),x=_e(t,"emptyMessage",3,"No commands found."),n=O(null),A=O(null),S=O(null),L=O(null),k=O(null),I=O(null),T=O(Fe([])),W=O(""),b=O(!1),_=O(Fe(i())),N=O(null),$=!1,v=O(null),u=!1,w=null,F=null,j=0,E=null;const ne=K(()=>{const a=new Map;for(const l of y())a.set(l.id,l);return Array.from(a.values())}),we=K(()=>{const a=new Map;for(const l of e(ne)){const r=l.group??null,G=a.get(r);G?G.push(l):a.set(r,[l])}return a});it(()=>{je()});function oe(a,l=!1){l&&($=!0),s(W,a,!0)}function Ce(a=null,l){if(!E||a&&E!==a)return;s(N,null),E.placeholderOverridden&&s(_,i()),(l?.forceReset??(l?.skipReset?!1:E.resetValueOnDetach))&&(oe("",!0),E.onInput("")),E.onDetach?.(),E=null}function c(){Ce(null,{forceReset:!0}),s(N,null),s(_,i()),$=!1}Ze(()=>{const a=e(N);if(a){if($){$=!1;return}a(e(W))}}),Ze(()=>{e(n)||s(_,i())});function f(){if(F)try{F()}catch(a){console.error("Failed to dispose command session",a)}F=null,s(S,null),s(L,null),c(),s(A,null)}function P(){e(n)&&(f(),s(n,null),s(I,null),s(k,null),oe("",!0),s(b,!0))}function z(a){try{t.commandSearchContext.get(a.classType).clear()}catch(l){console.error("Failed to clear global variable",l)}finally{je()}}function X(){e(v)?.blur()}function B(a,l){if(!a.component)return null;const r=a.props;return r?{component:a.component,props:()=>r(l)}:{component:a.component}}function Z(a,l){const r=a.createSession?.(l);if(r){F=r.dispose??null,Object.prototype.hasOwnProperty.call(r,"input")?s(S,r.input??null,!0):s(S,null),Object.prototype.hasOwnProperty.call(r,"content")?s(L,r.content??null,!0):s(L,B(a,l),!0);return}F=null,s(S,null),s(L,B(a,l),!0)}function U(a){const l=a.id;return{getContext:()=>t.commandSearchContext,deactivate:()=>{!e(n)||e(n).id!==l||(P(),je())},isActive:r=>!e(n)||e(n).id!==l?!1:r?e(n).id===r:!0,setIsOpen:(r,G)=>{if(!e(n)||e(n).id!==l)return;if(r){u=!1,s(b,!0);return}const ee=G?.preserveActive??!0;We(ee)},setInputSurface:r=>{!e(n)||e(n).id!==l||s(S,r,!0)},setContentSurface:r=>{!e(n)||e(n).id!==l||s(L,r,!0)},getInputValue:()=>e(W),setInputValue:r=>{!e(n)||e(n).id!==l||oe(r,!0)},setInputHandler:r=>{if(!(!e(n)||e(n).id!==l)){if(Ce(null,{skipReset:!0}),s(N,r,!0),!r){$=!1;return}r(e(W))}},setPlaceholder:r=>{!e(n)||e(n).id!==l||s(_,r,!0)},resetPlaceholder:()=>{!e(n)||e(n).id!==l||s(_,i())},attachInputBinding:r=>{if(!e(n)||e(n).id!==l)return()=>{};Ce(null,{skipReset:!0});const G=r.placeholder??e(n).inputPlaceholder??i(),ee={id:++j,commandId:l,onInput:r.onInput,onDetach:r.onDetach,placeholderOverridden:!!G,resetValueOnDetach:r.resetValueOnDetach??!0};E=ee,ee.placeholderOverridden&&G&&s(_,G,!0),s(N,Ae=>{!E||E.id!==ee.id||r.onInput(Ae)});const q=r.resetValueOnAttach??!0,ge=r.replayInitialValue??!q;return q?(oe("",!0),r.onInput("")):ge&&r.onInput(e(W)),()=>{Ce(ee)}}}}function be(a){const l=e(A);if(!a)return l?{runtime:l}:{};if(!l)return{};const{props:r}=a;return r?{...typeof r=="function"?r(l):r,runtime:l}:{runtime:l}}function ce(a){return`${a.name} ${a.description??""}`.trim()}async function ie(a){if(e(n)?.id===a.id){P();return}f(),s(I,null),s(k,a.id,!0),s(b,!0),e(v)&&e(v).focus();const l=U(a);s(A,l,!0),s(n,a,!0),Z(a,l);try{await a.execute(l)}catch(r){s(I,r instanceof Error?r:new Error("Failed to execute the command."),!0)}finally{s(k,null),oe("",!0),je()}}function He(a){const l=a.key.toLowerCase();if((a.metaKey||a.ctrlKey)&&l==="p"){if(a.preventDefault(),e(n)){P();return}e(v)&&e(v).focus();return}if(l==="escape"){if(e(n)){a.preventDefault(),P(),X();return}e(b)&&(a.preventDefault(),s(b,!1),X());return}if(!e(n))for(const G of e(ne)){if(!G.shortcut)continue;const ee=G.shortcut.join(" ").toLowerCase(),q=[];if(a.metaKey&&q.push("âŒ˜"),a.ctrlKey&&q.push("Ctrl"),a.altKey&&q.push("Alt"),a.shiftKey&&q.push("Shift"),q.push(a.key.length===1?a.key.toUpperCase():a.key),q.join(" ").toLowerCase()===ee.toLowerCase()){a.preventDefault(),ie(G);break}}}function Qe(){s(b,!0)}function We(a=!1){u=a,s(b,!1),X()}function rt(a){const l=w;if(!l)return;const r=a.target;r&&l.contains(r)||e(b)&&We(!!e(n))}Ze(()=>{if(!e(b)){if(oe("",!0),!e(n)){u=!1;return}if(u){u=!1;return}f(),s(n,null),s(I,null)}});function je(){if(!t.commandSearchContext){s(T,[],!0);return}const a=t.commandSearchContext.getGlobalVariables(),l=[];for(const r of a){const G=r.getId();G&&l.push({displayName:r.displayName,id:G,classType:r.constructor})}s(T,l,!0)}var pe=Qr();yt("keydown",ar,He),yt("pointerdown",nr,rt);var Ie=g(pe);Q(Ie,()=>ur,(a,l)=>{l(a,{children:(r,G)=>{var ee=Hr(),q=C(ee);{let Se=K(()=>e(n)?e(n).inputPlaceholder??e(_):e(_)),Ye=K(()=>e(n)?Dr:void 0),Ee=K(()=>e(n)?{onPress:P,disabled:e(k)===e(n).id}:void 0),Ue=K(()=>e(n)?.id),ye=K(()=>e(n)?P:null);kr(q,{get placeholder(){return e(Se)},onfocus:()=>Qe(),get icon(){return e(Ye)},get iconProps(){return e(Ee)},get commandId(){return e(Ue)},get onCommandClose(){return e(ye)},get value(){return e(W)},set value(de){s(W,de,!0)},get ref(){return e(v)},set ref(de){s(v,de,!0)}})}var ge=Y(q,2);{var Ae=Se=>{var Ye=qr(),Ee=C(Ye);{var Ue=te=>{var se=Tr();et(se,21,()=>e(T),ue=>ue.id,(ue,fe)=>{{let $e=K(()=>`${e(fe).displayName}: ${e(fe).id}`),Me=K(()=>`${e(fe).displayName}: ${e(fe).id}`);Dt(ue,{get value(){return e($e)},get title(){return e(Me)},onClose:()=>z(e(fe))})}}),p(se),o(te,se)};M(Ee,te=>{e(T).length&&te(Ue)})}var ye=Y(Ee,2);{var de=te=>{xt(te,{children:(se,ue)=>{var fe=D(),$e=C(fe);Q($e,()=>dt,(Me,at)=>{at(Me,{children:(he,Be)=>{var ve=Br(),Le=C(ve);Q(Le,()=>ut,(Oe,me)=>{me(Oe,{children:(xe,V)=>{Ke();var R=Ge();J(()=>ae(R,x())),o(xe,R)},$$slots:{default:!0}})});var ke=Y(Le,2);et(ke,17,()=>Array.from(e(we).entries()),cr,(Oe,me)=>{var xe=K(()=>or(e(me),2));let V=()=>e(xe)[1];var R=D(),H=C(R);et(H,17,V,le=>le.id,(le,re)=>{var Pe=D(),De=C(Pe);{let Ft=K(()=>ce(e(re)));Q(De,()=>ft,(Wt,jt)=>{jt(Wt,{get value(){return e(Ft)},onclick:()=>ie(e(re)),children:(Ut,Ia)=>{var Ot=zr(),pt=C(Ot),gt=g(pt),Kt=g(gt,!0);p(gt);var Gt=Y(gt,2);{var qt=Te=>{var Je=Nr(),ht=g(Je,!0);p(Je),J(()=>ae(ht,e(re).description)),o(Te,Je)};M(Gt,Te=>{e(re).description&&Te(qt)})}p(pt);var Ht=Y(pt,2);{var Qt=Te=>{ot(Te,{class:"ml-auto size-4 text-muted-foreground"})},Yt=Te=>{var Je=D(),ht=C(Je);{var Xt=_t=>{var Rt=D(),Jt=C(Rt);Q(Jt,()=>Rr,(Zt,er)=>{er(Zt,{children:(tr,$a)=>{Ke();var At=Ge();J(rr=>ae(At,rr),[()=>e(re).shortcut?.join(" + ")]),o(tr,At)},$$slots:{default:!0}})}),o(_t,Rt)};M(ht,_t=>{e(re).shortcut?.length&&_t(Xt)},!0)}o(Te,Je)};M(Ht,Te=>{e(k)===e(re).id?Te(Qt):Te(Yt,!1)})}J(()=>ae(Kt,e(re).name)),o(Ut,Ot)},$$slots:{default:!0}})})}o(le,Pe)}),o(Oe,R)}),o(he,ve)},$$slots:{default:!0}})}),o(se,fe)},$$slots:{default:!0}})},Ve=te=>{var se=Gr(),ue=C(se);{var fe=he=>{const Be=K(()=>e(S).component);var ve=Fr(),Le=g(ve);{let ke=K(()=>be(e(S)));Q(Le,()=>e(Be),(Oe,me)=>{me(Oe,tt(()=>e(ke)))})}p(ve),o(he,ve)};M(ue,he=>{e(S)&&he(fe)})}var $e=Y(ue,2);{var Me=he=>{var Be=jr(),ve=g(Be);Q(ve,()=>vr,(Le,ke)=>{ke(Le,{variant:"destructive",children:(Oe,me)=>{var xe=Wr(),V=C(xe);Q(V,()=>mr,(H,le)=>{le(H,{children:(re,Pe)=>{Ke();var De=Ge();J(()=>ae(De,`${e(n).name??""} failed`)),o(re,De)},$$slots:{default:!0}})});var R=Y(V,2);Q(R,()=>pr,(H,le)=>{le(H,{children:(re,Pe)=>{Ke();var De=Ge();J(()=>ae(De,e(I).message)),o(re,De)},$$slots:{default:!0}})}),o(Oe,xe)},$$slots:{default:!0}})}),p(Be),o(he,Be)};M($e,he=>{e(I)&&he(Me)})}var at=Y($e,2);xt(at,{children:(he,Be)=>{var ve=Kr(),Le=g(ve);{var ke=me=>{const xe=K(()=>e(L).component);var V=D(),R=C(V);{let H=K(()=>be(e(L)));Q(R,()=>e(xe),(le,re)=>{re(le,tt(()=>e(H)))})}o(me,V)},Oe=me=>{var xe=D(),V=C(xe);Q(V,()=>wr,(R,H)=>{H(R,{class:"px-0",children:(le,re)=>{var Pe=Ur();o(le,Pe)},$$slots:{default:!0}})}),o(me,xe)};M(Le,me=>{e(L)?me(ke):me(Oe,!1)})}p(ve),o(he,ve)},$$slots:{default:!0}}),o(te,se)};M(ye,te=>{e(n)?te(Ve,!1):te(de)})}o(Se,Ye)};M(ge,Se=>{e(b)&&Se(Ae)})}o(r,ee)},$$slots:{default:!0}})}),p(pe),nt(pe,a=>w=a,()=>w),nt(pe,a=>m(a),()=>m()),J(a=>ct(pe,1,a),[()=>Vt(vt("space-y-4",t.class))]),o(d,pe),ze()}class Tt{colour=null;id=null;getId(){return this.id}setId(t){this.id=t}clear(){this.setId(null)}}class Xr{services=new Map;globalVariables=new Map;add(t,m){this.services.set(t,m),m instanceof Tt&&this.globalVariables.set(t,m)}get(t){const m=this.services.get(t);if(!m)throw new Error(`Service not found for token: ${t.name}`);return m}has(t){return this.services.has(t)}getGlobalVariables(){return Array.from(this.globalVariables.values())}}class bt{#e=[];constructor(t){this.#e=t}get organisations(){return this.#e}}class Xe extends Tt{displayName="org";organisations;constructor(t){super(),this.organisations=new Map(t.map(m=>[m.id,m])),t.length>0&&this.setId(t[0].id)}setActiveOrganisation(t){this.setId(t)}getActiveOrganisationId(){return this.id}getActiveOrganisationPortalUrl(){const t=this.organisations.get(this.getActiveOrganisationIdInternal());if(!t)throw new Error("No organisation is currently selected.");return t.portalUrl}getActiveOrganisationEndpoint(){const t=this.organisations.get(this.getActiveOrganisationIdInternal());if(!t)throw new Error("No organisation is currently selected.");return t.endpoint}getActiveOrganisationQueryParams(){const t=this.organisations.get(this.getActiveOrganisationIdInternal());if(!t)throw new Error("No organisation is currently selected.");return t.queryParams||{}}getActiveOrganisationIdInternal(){if(!this.id)throw new Error("No organisation is currently selected.");return this.id}}class st{_mapView;constructor(t){this._mapView=t}get mapView(){return this._mapView}}const St=new Map;function Jr(d,t){St.has(d)&&console.warn(`[registerCommand] Command "${d}" already registered, overriding.`),St.set(d,t)}function lt(d){return St.get(d)}function mt(d,t){return Jr(d,t),t}class Nt{#e=O(null);#t=O(!1);#r=O(null);load=async(t,m)=>{s(this.#t,!0),s(this.#r,null);try{const y=await Pr(t,{...m,responseType:"json"});console.log("Esri Request Response:",y,y.data.url),s(this.#e,y.data,!0)}catch(y){s(this.#r,y,!0)}finally{s(this.#t,!1)}};get data(){return e(this.#e)}get isLoading(){return e(this.#t)}get error(){return e(this.#r)}}var Zr=h('<div class="error-message svelte-11six79"><p class="text-sm text-red-600 svelte-11six79"> </p></div>'),ea=h('<div class="flex items-center justify-center p-4"><!></div>'),ta=h('<div class="flex items-center gap-2"><!> <span class="title-text w-full font-medium text-foreground svelte-11six79"> </span></div>'),ra=h('<span class="description-text text-xs text-gray-500 svelte-11six79"> </span>'),aa=h('<div class="error-message svelte-11six79"><!> <p class="text-sm text-red-600 svelte-11six79"> </p></div>'),na=h('<div class="flex w-full min-w-0 flex-col gap-0.5"><span class="title-text font-medium text-foreground svelte-11six79"> </span> <!> <!></div>'),oa=h('<div class="item-container svelte-11six79"><!></div>');function sa(d,t){Ne(t,!0);const m=_e(t,"runtime",3,null),y=new Nt;let i=O(null),x=O(null),n=Fe(new Ct),A=O(""),S=O(Fe([]));const L=K(()=>{const v=e(S);console.log("Filtering web maps with data:",v);const u=e(A).trim().toLowerCase();return u?v.filter(w=>{const F=w?.title?.toLowerCase()??"",j=w?.description?.toLowerCase()??"";return F.includes(u)||j.includes(u)}):v});it(async()=>{s(i,t.commandSearchContext.get(st).mapView,!0);const u=t.commandSearchContext.get(Xe).getActiveOrganisationId();if(!u){console.warn("No active organisation selected in OrganisationCommandService");return}try{const w=await fetch($t(`/api/maps/${u}.json`));if(!w.ok)throw new Error(`Failed to fetch maps: ${w.status} ${w.statusText}`);const F=await w.json();s(S,(F.results??[]).filter(j=>j.type.toLowerCase()==="web map").map(j=>({id:j.id,title:j.title,description:kt(j.description),owner:j.owner,tags:j.tags})),!0)}catch(w){console.error("Error fetching web maps:",w)}});let k=null,I=null,T=t.inputPlaceholder??"Search...";Ze(()=>{const v=m(),u=t.inputPlaceholder??"Search...";if(!v){k?.(),k=null,I=null,T=u,s(A,"");return}if(v===I){u!==T&&(v.setPlaceholder(u),T=u);return}k?.(),k=null,T=u,k=v.attachInputBinding({placeholder:u,onInput:w=>{s(A,w,!0)}}),I=v}),Pt(()=>{k?.(),k=null,I=null});async function W(v){if(!e(i)){console.error("MapView is not initialized"),n.set(v,new Error("MapView is not ready. Please wait and try again."));return}s(x,v,!0),n.delete(v);try{console.log(`Loading web map with ID: ${v}`);const u=t.commandSearchContext.get(Xe);if(!u.getActiveOrganisationId()){console.warn("No active organisation selected in OrganisationCommandService");return}const F=u.getActiveOrganisationPortalUrl(),{default:j}=await Re(async()=>{const{default:oe}=await import("../chunks/Bs6xTxvz.js").then(Ce=>Ce.W);return{default:oe}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72]),import.meta.url),E=new j({portalItem:{id:v,portal:{url:F}}});await E.load(),console.log("Web map loaded successfully"),console.log("Applying web map to MapView",e(i).ui),e(i).map=E,console.log("Web map applied to MapView"),await(await Re(()=>import("../chunks/D1sKJjB8.js").then(oe=>oe.y),__vite__mapDeps([9,1,2,3,6,10,4,5]),import.meta.url)).whenOnce(()=>e(i)?.ready),console.log("MapView updated with new web map");const we=E.initialViewProperties?.viewpoint?.targetGeometry;we&&(console.log("Navigating to web map initial viewpoint"),await e(i).goTo(we),console.log("MapView navigated to web map initial viewpoint")),m()?.setIsOpen(!1)}catch(u){console.error("Error loading web map:",u),n.set(v,u),s(x,null)}finally{s(x,null)}}var b=oa(),_=g(b);{var N=v=>{var u=Zr(),w=g(u),F=g(w);p(w),p(u),J(()=>ae(F,`${y.error.message??""}. ${y.error?.details?.httpStatus===0?"Reason: CORS Error. See console for more information.":""}`)),o(v,u)},$=v=>{var u=D(),w=C(u);{var F=E=>{var ne=ea(),we=g(ne);ot(we,{class:"size-5"}),p(ne),o(E,ne)},j=E=>{var ne=D(),we=C(ne);Q(we,()=>dt,(oe,Ce)=>{Ce(oe,{children:(c,f)=>{var P=D(),z=C(P);{var X=Z=>{var U=D(),be=C(U);Q(be,()=>ut,(ce,ie)=>{ie(ce,{children:(He,Qe)=>{Ke();var We=Ge("No web maps match your search.");o(He,We)},$$slots:{default:!0}})}),o(Z,U)},B=Z=>{var U=D(),be=C(U);et(be,17,()=>e(L),ce=>ce.id,(ce,ie)=>{var He=D(),Qe=C(He);Q(Qe,()=>ft,(We,rt)=>{rt(We,{onclick:()=>W(e(ie).id),children:(je,pe)=>{const Ie=K(()=>n.get(e(ie).id));var a=D(),l=C(a);{var r=ee=>{var q=ta(),ge=g(q);ot(ge,{class:"size-4"});var Ae=Y(ge,2),Se=g(Ae);p(Ae),p(q),J(()=>ae(Se,`Loading ${e(ie).title??"Untitled web map"??""}...`)),o(ee,q)},G=ee=>{var q=na(),ge=g(q),Ae=g(ge,!0);p(ge);var Se=Y(ge,2);{var Ye=ye=>{var de=ra(),Ve=g(de,!0);p(de),J(()=>{qe(de,"title",e(ie).description),ae(Ve,e(ie).description)}),o(ye,de)};M(Se,ye=>{e(ie).description&&ye(Ye)})}var Ee=Y(Se,2);{var Ue=ye=>{const de=K(()=>`${e(Ie).message}. ${e(Ie).details?.error?.details?.httpStatus===0?"Reason: CORS Error. See console for more information.":""}`);var Ve=aa(),te=g(Ve);Lt(te,{class:"error-icon",size:16});var se=Y(te,2),ue=g(se,!0);p(se),p(Ve),J(()=>{qe(Ve,"title",e(de)),ae(ue,e(de))}),o(ye,Ve)};M(Ee,ye=>{e(Ie)&&ye(Ue)})}p(q),J(()=>{qe(ge,"title",e(ie).title),ae(Ae,e(ie).title??"Untitled web map")}),o(ee,q)};M(l,ee=>{e(x)===e(ie).id?ee(r):ee(G,!1)})}o(je,a)},$$slots:{default:!0}})}),o(ce,He)}),o(Z,U)};M(z,Z=>{e(L).length===0?Z(X):Z(B,!1)})}o(c,P)},$$slots:{default:!0}})}),o(E,ne)};M(w,E=>{y.isLoading?E(F):E(j,!1)},!0)}o(v,u)};M(_,v=>{y.error?v(N):v($,!1)})}p(b),o(d,b),ze()}const zt={id:"add-web-map",name:"Add web map",description:"Fetch and display web maps.",group:"Maps",shortcut:["Ctrl","M"],inputPlaceholder:"Search web maps...",execute:async()=>{},component:sa,props:d=>({commandSearchContext:d.getContext(),inputPlaceholder:zt.inputPlaceholder})};mt("add-web-map",zt);globalThis.process?.versions?.webcontainer;Re(()=>import("../chunks/BIHI7g3E.js"),[],import.meta.url).then(d=>new d.AsyncLocalStorage).catch(()=>{});var ia=h('<div class="error-message svelte-1lap2l5"><p class="text-sm text-red-600 svelte-1lap2l5"> </p></div>'),la=h('<div class="flex items-center justify-center p-4"><!></div>'),ca=h('<div class="flex items-center gap-2"><!> <span class="title-text w-full font-medium text-foreground svelte-1lap2l5"> </span></div>'),da=h('<div class="flex items-center gap-2"><!></div>'),ua=h('<span class="description-text text-xs text-gray-500 svelte-1lap2l5"> </span>'),fa=h('<span class="text-[11px] text-muted-foreground"> </span>'),va=h('<span class="text-[11px] text-muted-foreground"> <!></span>'),ma=h('<div class="error-message svelte-1lap2l5"><!> <p class="text-sm text-red-600 svelte-1lap2l5"> </p></div>'),pa=h('<!> <div class="flex w-full min-w-0 flex-col gap-0.5"><span class="title-text font-medium text-foreground svelte-1lap2l5"> </span> <!> <!> <!> <!></div>',1),ga=h('<div class="item-container svelte-1lap2l5"><!></div>');function ha(d,t){Ne(t,!0);const m=_e(t,"runtime",3,null),y=new Nt;let i=O(null),x=O(null),n=Fe(new Ct),A=O(""),S=O(Fe(new Ct)),L=O(Fe([]));const k=new Map,I={27700:"OS_Open_Background"},T=K(()=>{const c=e(L),f=e(A).trim().toLowerCase();return f?c.filter(P=>{const z=P?.title?.toLowerCase()??"",X=P?.description?.toLowerCase()??"";return z.includes(f)||X.includes(f)}):c});it(async()=>{s(i,t.commandSearchContext.get(st).mapView,!0);const c=t.commandSearchContext.get(Xe),f=c.getActiveOrganisationId();if(!f){console.warn("No active organisation selected in OrganisationCommandService");return}c.getActiveOrganisationPortalUrl(),c.getActiveOrganisationEndpoint();const P=["Feature Layer","Feature Service","Map Service","Image Service"],z=await fetch($t(`/api/maps/${f}.json`));if(!z.ok)throw new Error(`Failed to fetch maps: ${z.status} ${z.statusText}`);const X=await z.json();s(L,(X.results??[]).filter(B=>P.includes(B.type)).map(B=>({id:B.id,title:B.title,description:kt(B.description),owner:B.owner,tags:B.tags})),!0),k.clear();for(const B of e(L))k.set(B.id,B)});let W=null,b=null,_=t.inputPlaceholder??"Search...";Ze(()=>{const c=m(),f=t.inputPlaceholder??"Search...";if(!c){W?.(),W=null,b=null,_=f,s(A,"");return}if(c===b){f!==_&&(c.setPlaceholder(f),_=f);return}W?.(),W=null,_=f,W=c.attachInputBinding({placeholder:f,onInput:P=>{s(A,P,!0)}}),b=c}),Pt(()=>{W?.(),W=null,b=null});async function N(c){e(S).has(c)?$(c):await v(c)}function $(c){const f=e(S).get(c);!f||!e(i)||!e(i).map||(e(i).map.remove(f),e(S).delete(c),s(S,e(S),!0),console.log(`Layer removed from the map: ${c}`))}async function v(c){if(!e(i)||!e(i).map){console.error("Map or MapView is not initialized"),n.set(c,new Error("Map is not ready. Please wait and try again."));return}s(x,c,!0),n.delete(c);try{console.log(`Loading layer with portal item ID: ${c}`);const f=t.commandSearchContext.get(Xe);if(!f.getActiveOrganisationId()){console.warn("No active organisation selected in OrganisationCommandService");return}const z=f.getActiveOrganisationPortalUrl(),[{default:X},{default:B}]=await Promise.all([Re(()=>import("../chunks/fh0BQpDQ.js").then(ce=>ce.P),__vite__mapDeps([12,9,1,2,3,6,10,4,5]),import.meta.url),Re(()=>import("../chunks/C3oh_tnt.js").then(ce=>ce.P),__vite__mapDeps([10,4,1,2,3,5,6]),import.meta.url)]),Z=new B({url:z}),U=await X.fromPortalItem({portalItem:{id:c,portal:Z}});await U.load();const be=await u(U,c);await E(be),e(i).map.add(U),e(S).set(c,U),s(S,e(S),!0),console.log("Layer added to the map");try{await e(i).whenLayerView(U),U.fullExtent&&await e(i).goTo(U.fullExtent)}catch(ce){console.warn("Layer view not ready for navigation",ce)}}catch(f){console.error("Error loading layer:",f),n.set(c,f),s(x,null)}finally{s(x,null)}}async function u(c,f){const P=w(c);if(P)return P;const z=k.get(f);if(z?.spatialReferenceWkid){const{default:B}=await Re(async()=>{const{default:Z}=await import("../chunks/Cad-p0g1.js").then(U=>U.bd);return{default:Z}},__vite__mapDeps([5,1,2,3,4,6]),import.meta.url);return new B({wkid:z.spatialReferenceWkid})}const X=c.portalItem?.spatialReference;return X||null}function w(c){return c?.spatialReference??null}function F(c){if(!c)return;const f=c;return c.wkid??f?.latestWkid??void 0}async function j(c){if(!e(i)||!e(i).map)return console.warn("MapView or Map is not available for basemap loading"),null;if(!c)return e(i).map.basemap;const f=I[c];if(!f)return e(i).map.basemap;const{default:P}=await Re(async()=>{const{default:z}=await import("../chunks/Cm7AOsqL.js").then(X=>X.B);return{default:z}},__vite__mapDeps([8,4,1,2,3,5,6,9,10,11,12,13,14,15]),import.meta.url);try{return await P.fromId(f)}catch(z){return console.warn(`Failed to load basemap ${f}`,z),e(i).map.basemap}}async function E(c){if(!e(i)||!e(i).map||!c){console.log("MapView or target spatial reference is not available","mapView:",e(i),"target:",c);return}const f=F(c),P=F(e(i).spatialReference??void 0);if(console.log(`Ensuring map view spatial reference compatibility: target WKID=${f}, current WKID=${P}`),!f||f===P)return;const[{default:z}]=await Promise.all([Re(()=>import("../chunks/BsJbwhv8.js").then(be=>be.M),__vite__mapDeps([7,1,2,3,8,4,5,6,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28]),import.meta.url)]),X=await j(f),B=e(i).map.layers.toArray(),Z=e(i).map.ground;e(i).map.removeAll();const U=new z({basemap:X??void 0,ground:Z});U.spatialReference=c,U.layers.addMany(B),e(i).map=U,await e(i).when()}var ne=ga(),we=g(ne);{var oe=c=>{var f=ia(),P=g(f),z=g(P);p(P),p(f),J(()=>ae(z,`${y.error.message??""}. ${y.error?.details?.httpStatus===0?"Reason: CORS Error. See console for more information.":""}`)),o(c,f)},Ce=c=>{var f=D(),P=C(f);{var z=B=>{var Z=la(),U=g(Z);ot(U,{class:"size-5"}),p(Z),o(B,Z)},X=B=>{var Z=D(),U=C(Z);Q(U,()=>dt,(be,ce)=>{ce(be,{children:(ie,He)=>{var Qe=D(),We=C(Qe);{var rt=pe=>{var Ie=D(),a=C(Ie);Q(a,()=>ut,(l,r)=>{r(l,{children:(G,ee)=>{Ke();var q=Ge("No layers match your search.");o(G,q)},$$slots:{default:!0}})}),o(pe,Ie)},je=pe=>{var Ie=D(),a=C(Ie);et(a,17,()=>e(T),l=>l.id,(l,r)=>{var G=D(),ee=C(G);{let q=K(()=>e(S).has(e(r).id)?"layer-selected":"");Q(ee,()=>ft,(ge,Ae)=>{Ae(ge,{onclick:()=>N(e(r).id),get class(){return e(q)},children:(Se,Ye)=>{const Ee=K(()=>n.get(e(r).id));var Ue=D(),ye=C(Ue);{var de=te=>{var se=ca(),ue=g(se);ot(ue,{class:"size-4"});var fe=Y(ue,2),$e=g(fe);p(fe),p(se),J(()=>ae($e,`Loading ${e(r).title??"Untitled layer"??""}...`)),o(te,se)},Ve=te=>{var se=pa(),ue=C(se);{var fe=V=>{var R=da(),H=g(R);gr(H,{}),p(R),o(V,R)};M(ue,V=>{e(S).has(e(r).id)&&V(fe)})}var $e=Y(ue,2),Me=g($e),at=g(Me,!0);p(Me);var he=Y(Me,2);{var Be=V=>{var R=ua(),H=g(R,!0);p(R),J(()=>{qe(R,"title",e(r).description),ae(H,e(r).description)}),o(V,R)};M(he,V=>{e(r).description&&V(Be)})}var ve=Y(he,2);{var Le=V=>{var R=fa(),H=g(R,!0);p(R),J(()=>ae(H,e(r).type??"")),o(V,R)};M(ve,V=>{e(r).type&&V(Le)})}var ke=Y(ve,2);{var Oe=V=>{var R=va(),H=g(R),le=Y(H);{var re=Pe=>{var De=Ge();De.nodeValue=" (auto aligns view)",o(Pe,De)};M(le,Pe=>{I[e(r).spatialReferenceWkid]&&Pe(re)})}p(R),J(()=>ae(H,`WKID ${e(r).spatialReferenceWkid??""} `)),o(V,R)};M(ke,V=>{e(r).spatialReferenceWkid&&V(Oe)})}var me=Y(ke,2);{var xe=V=>{const R=K(()=>`${e(Ee).message}. ${e(Ee).details?.error?.details?.httpStatus===0?"Reason: CORS Error. See console for more information.":""}`);var H=ma(),le=g(H);Lt(le,{size:16});var re=Y(le,2),Pe=g(re,!0);p(re),p(H),J(()=>{qe(H,"title",e(R)),ae(Pe,e(R))}),o(V,H)};M(me,V=>{e(Ee)&&V(xe)})}p($e),J(()=>{qe(Me,"title",e(r).title),ae(at,e(r).title??"Untitled layer")}),o(te,se)};M(ye,te=>{e(x)===e(r).id?te(de):te(Ve,!1)})}o(Se,Ue)},$$slots:{default:!0}})})}o(l,G)}),o(pe,Ie)};M(We,pe=>{e(T).length===0?pe(rt):pe(je,!1)})}o(ie,Qe)},$$slots:{default:!0}})}),o(B,Z)};M(P,B=>{y.isLoading?B(z):B(X,!1)},!0)}o(c,f)};M(we,c=>{y.error?c(oe):c(Ce,!1)})}p(ne),o(d,ne),ze()}const Bt={id:"add-layer",name:"Add layers",description:"Fetch and display layers.",group:"Maps",shortcut:["Ctrl","L"],execute:async()=>{},component:ha,props:d=>({commandSearchContext:d.getContext(),inputPlaceholder:Bt.inputPlaceholder})};mt("add-layer",Bt);var _a=h('<div class="flex w-full min-w-0 flex-col gap-0.5"><span class="title-text font-medium text-foreground svelte-1w2u78y"> </span></div>'),wa=h('<div class="item-container svelte-1w2u78y"><!></div>');function ya(d,t){Ne(t,!0);const m=_e(t,"runtime",3,null);let y=O(Fe([])),i=O("");it(async()=>{const I=t.commandSearchContext.get(bt)?.organisations;if(!I){console.warn("No organisation configuration found in MapsConfig");return}s(y,I,!0)});let x=null,n=null,A=t.inputPlaceholder??"Search...";Ze(()=>{const I=m(),T=t.inputPlaceholder??"Search...";if(!I){x?.(),x=null,n=null,A=T,s(i,"");return}if(I===n){T!==A&&(I.setPlaceholder(T),A=T);return}x?.(),x=null,A=T,x=I.attachInputBinding({placeholder:T,onInput:W=>{s(i,W,!0)}}),n=I}),Pt(()=>{x?.(),x=null,n=null});function S(I){t.commandSearchContext.get(Xe).setActiveOrganisation(I),m()&&m().deactivate()}var L=wa(),k=g(L);Q(k,()=>dt,(I,T)=>{T(I,{children:(W,b)=>{var _=D(),N=C(_);{var $=u=>{var w=D(),F=C(w);Q(F,()=>ut,(j,E)=>{E(j,{children:(ne,we)=>{Ke();var oe=Ge("No organisations match your search.");o(ne,oe)},$$slots:{default:!0}})}),o(u,w)},v=u=>{var w=D(),F=C(w);et(F,17,()=>e(y),j=>j.name,(j,E)=>{var ne=D(),we=C(ne);Q(we,()=>ft,(oe,Ce)=>{Ce(oe,{onclick:()=>S(e(E).id),children:(c,f)=>{var P=_a(),z=g(P),X=g(z,!0);p(z),p(P),J(()=>ae(X,e(E).name??"Untitled organisation")),o(c,P)},$$slots:{default:!0}})}),o(j,ne)}),o(u,w)};M(N,u=>{e(y).length===0?u($):u(v,!1)})}o(W,_)},$$slots:{default:!0}})}),p(L),o(d,L),ze()}const xa={id:"add-organisation",name:"Add organisation",description:"Find and add an organisation to filter items by.",group:"Maps",shortcut:["Ctrl","O"],inputPlaceholder:"Search organisations...",component:ya,execute:async()=>{},props:d=>({commandSearchContext:d.getContext(),inputPlaceholder:"Search organisations..."})};mt("add-organisation",xa);const Ca={id:"clear-map",name:"Clear map",description:"Clear all layers and reset the map view.",shortcut:["Ctrl","C"],execute:async d=>{const t=d.getContext().get(st).mapView;t&&t.map&&(t.map.layers.removeAll(),t.map.basemap="gray"),d.deactivate()}};mt("clear-map",Ca);var ba=h("<arcgis-layer-list></arcgis-layer-list>",2),Sa=h('<div id="search-slot" class="absolute top-3 left-1/2 z-10 -translate-x-1/2"><!></div>'),Pa=h("<arcgis-map><!></arcgis-map>",2);function rn(d,t){Ne(t,!0);const m=new Xr;let y=O(null),i=O(null),x=O(null),n=O(null),A=O(!0),S=O(Fe([]));it(async()=>{const b=await L(),_=new Xe(b.organisations);m.add(bt,b),m.add(Xe,_),await I(),s(S,[lt("add-web-map"),lt("add-layer"),lt("add-organisation"),lt("clear-map")],!0)});async function L(){const b=await fetch($t("/config/maps/config.json"));if(!b.ok)throw new Error(`Failed to load maps config: ${b.status} ${b.statusText}`);const _=await b.json();return new bt(_.organisations)}async function k(){if(!e(x))return;s(y,e(x).view,!0),m.add(st,new st(e(y)));const b="#cfd3d4";e(x).background={color:b},e(n)&&(e(n).view=e(y),e(n).listItemCreatedFunction=_=>{const{item:N}=_;N.layer.type!="group"&&(N.panel={content:"legend",open:!0})})}async function I(){await Re(()=>import("../chunks/B8B24qty.js").then(b=>b.a),__vite__mapDeps([73,74,75,76,9,1,2,3,6,10,4,5,77,78,79,80,12,20,21,17,81,34,16,32,19,33,82,83,84,85,86]),import.meta.url),await Re(()=>import("../chunks/DPxGaGY-.js"),__vite__mapDeps([87,88,75,76,89,90,91,92,93,94,95,96,97,77,98,99,74,9,1,2,3,6,10,4,5,78,12,83,100,33,16,17,32,19,21,101,37,38,20,102,62,63,56,57,103,65,81,34,104,46,47,105,86,106,107,108,109,41,26,42,43,44,45,39,48,49,50,51,110,53,111,112,113,55,58,59,60,61,64,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141]),import.meta.url),await Re(()=>import("../chunks/COzYCy8P.js"),__vite__mapDeps([142,88,75,76,89,90,143,93,95,144,98,77,97,145,146,147,148,106,74,9,1,2,3,6,10,4,5,78,149,29,30,19,31,17,32,16,21,33,34,12,18,150,26,151,152,80,20,81,153,154,7,8,11,13,14,15,22,23,24,25,27,28,79,155,104,156,157,68,69,132,158,159,160,161,162,163,164,131,165,166,137,167,141,85,0,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,70,71,72]),import.meta.url)}var T=D(),W=C(T);{const b=N=>{xt(N,{class:"h-full",children:($,v)=>{var u=ba();ct(u,1,"mx-2 min-h-20"),nt(u,w=>s(n,w),()=>e(n)),o($,u)},$$slots:{default:!0}})},_=N=>{var $=Pa();ct($,1,"relative h-full w-full"),wt($,"basemap","gray"),wt($,"center","-2.231774828836059,53.46531847221502"),wt($,"zoom","15");var v=g($);{var u=w=>{var F=Sa(),j=g(F);Yr(j,{class:"w-full max-w-md",get commandSearchContext(){return m},get commands(){return e(S)},get ref(){return e(i)},set ref(E){s(i,E,!0)}}),p(F),o(w,F)};M(v,w=>{e(S).length>0&&w(u)})}p($),nt($,w=>s(x,w),()=>e(x)),yt("arcgisViewReadyChange",$,k),o(N,$)};Q(W,()=>Sr,(N,$)=>{$(N,{get isOpen(){return e(A)},onToggle:()=>s(A,!e(A)),sidebarContent:b,mainContent:_,$$slots:{sidebarContent:!0,mainContent:!0}})})}o(d,T),ze()}export{rn as component};
