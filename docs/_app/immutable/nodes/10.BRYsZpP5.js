const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/DpAKiq6K.js","../chunks/BW0zoJTm.js","../chunks/CEBETtrS.js","../chunks/CaNW5Bx0.js","../chunks/PPVm8Dsz.js","../chunks/BUsxo-Ec.js","../chunks/D0nkGZIM.js","../chunks/BEZFO2vt.js","../chunks/CjBjO1Km.js","../chunks/CVQPxYbx.js","../chunks/DwerzRSF.js","../chunks/y1GB1Svy.js","../chunks/AlyPEkJM.js","../chunks/DFYTeVXP.js","../chunks/Cn9cIaVC.js","../chunks/BTNr9f9k.js","../chunks/EmFT8XhJ.js","../chunks/jYVHtrPb.js","../chunks/Cp_8tW2x.js","../chunks/BAWfW4Tu.js","../chunks/CumW50Sh.js","../chunks/Ci6C1k20.js","../chunks/bnayRBMH.js","../chunks/TJ-VhDZ5.js","../chunks/B0gOzRRh.js","../chunks/TW8D_o5j.js","../chunks/Oe6SV2kF.js","../chunks/B_yBz6pZ.js","../chunks/MtSiOt06.js","../chunks/C0wm8_Yw.js","../chunks/CW6Redn4.js","../chunks/BnQsZfR4.js","../chunks/BYduSOTS.js","../chunks/PJHcqbvL.js","../chunks/DS2ZxNQA.js","../chunks/Djp3mnm5.js","../chunks/DjNaDsmS.js","../chunks/C-w03I0l.js","../chunks/D9kT-sgB.js","../chunks/Bu0s_rAF.js","../chunks/B87vTgcy.js","../chunks/C3_gy5al.js","../chunks/CfBiQUdY.js","../chunks/BABeDC_w.js","../chunks/XEmGDYB_.js","../chunks/BVFIxAn9.js","../chunks/CAO_3SU9.js","../chunks/0N6-HNAU.js","../chunks/CglP3OMz.js","../chunks/DCBLidga.js","../chunks/B934cuUn.js","../chunks/C1gSvD9v.js","../chunks/PWd9QCpP.js","../chunks/BwN_j92a.js","../chunks/Bde99gqs.js","../chunks/C7fxqwFZ.js","../chunks/CVwTD0fV.js","../chunks/9eAP65Ji.js","../chunks/mOc398RU.js","../chunks/DPJXGPFY.js","../chunks/B8cN3yAo.js","../chunks/BIj_QgNJ.js","../chunks/q_b6UJoq.js","../chunks/CYI1luaL.js","../chunks/DTEZVyiP.js","../chunks/BCTmL8G8.js","../chunks/DhMSIuCj.js","../chunks/CSXZNpHb.js","../chunks/xXH_AyYh.js","../chunks/CTnd5cvu.js","../chunks/CHAiFIco.js","../chunks/Dj-cqQsY.js","../chunks/B128_oTY.js","../chunks/6Jo1niE7.js","../chunks/DjNuiUVf.js","../chunks/CpqG7TFG.js","../chunks/D_dxbuU-.js","../chunks/jQbrml54.js","../chunks/uHWM1awI.js","../chunks/CYEJx0Wq.js","../chunks/BteoTDFn.js","../chunks/B7Ex7sMf.js","../chunks/DocBEfKB.js","../chunks/B2jVc7id.js","../chunks/Da4sQo3R.js","../chunks/CAGdFHZB.js","../chunks/DzvuCIKa.js","../chunks/Bu0Dv00G.js","../chunks/Bo5l4fk8.js","../chunks/48RKFPo7.js","../chunks/TEMnSu_8.js","../chunks/Ch4klalT.js","../chunks/CQmZIYPi.js","../chunks/DsEHuRPb.js","../chunks/BARRAGjD.js","../chunks/DwIB5gq4.js","../chunks/BjGHVp5Q.js","../chunks/lEIzcqu9.js","../chunks/CtIxBnU3.js","../chunks/gJDQstGQ.js","../chunks/Cl8hT7Dy.js","../chunks/hngUoOdp.js","../chunks/BlT3hoGo.js","../chunks/DZpEp5b3.js","../chunks/GKolV7NZ.js","../chunks/PiqJyY-Z.js","../chunks/CWQ4Sji6.js","../chunks/Cc8znHts.js","../chunks/C9Yzh9th.js","../chunks/CMFr2xVw.js","../chunks/B8kDL1f4.js","../chunks/Bo-exx2O.js","../chunks/BFHafdW6.js","../chunks/D5cGnOsZ.js","../chunks/CCtOv0E5.js","../chunks/DhzudQro.js","../chunks/Qzt__3Yd.js","../chunks/mx71iuXv.js","../chunks/E5yhiq2t.js","../chunks/B2om5830.js","../chunks/CrUuvTSr.js","../chunks/DNQVkPqp.js","../chunks/WCLBMBm-.js","../chunks/BveQ3Yw2.js","../chunks/EGFv0f86.js","../chunks/BDRaqLVR.js","../chunks/BlaSF0Se.js","../chunks/mBdPBegd.js","../chunks/Cu3emot3.js","../chunks/qyF9FwQ9.js","../chunks/XI-Li77m.js","../chunks/DS8kW6UP.js","../chunks/1BM1gK8E.js","../chunks/DPb6J-GU.js","../chunks/BxTLSXBH.js","../chunks/BGyY2giR.js","../chunks/D28RTRrm.js","../chunks/C65Zrur8.js","../chunks/DwnB9djr.js","../chunks/CUTkbj50.js","../chunks/DE7psHTV.js","../chunks/Fla_WrMr.js","../chunks/CVRs03iK.js","../chunks/g8mGjH5g.js","../chunks/D1UBzOg5.js","../chunks/DvKU1K2H.js","../chunks/C8HgMPMV.js","../chunks/BqUxlKJa.js","../chunks/CzWdKr8p.js","../chunks/C2FvnhIN.js","../chunks/B0DG5wVw.js","../chunks/CaYZrGFV.js","../chunks/BRIeeldl.js","../chunks/B-myf1ZS.js","../chunks/B45SJMf_.js","../assets/jsxFactory.CQED0rIl.css","../chunks/2dBEZGc-.js","../assets/component-utils.R4SXog4D.css","../chunks/BqXNu7b5.js","../chunks/Ba6e521d.js","../chunks/DER5P13g.js","../chunks/Byx8h0ay.js","../chunks/BQBvadb7.js","../chunks/D-YQ4CHs.js","../chunks/BpMm_bKu.js","../chunks/DN8pD2EM.js","../chunks/GCVPM2bX.js","../chunks/3vzEJNVc.js","../chunks/C1a7zHTx.js","../chunks/BWEUlARE.js","../chunks/Cba5hWeF.js","../chunks/06ySslQQ.js","../chunks/DlHjpvET.js","../chunks/Dp15eoVC.js","../chunks/DtjklSP3.js","../chunks/Bl9gULnU.js","../chunks/upW12MZ5.js","../chunks/DGnEEsyW.js","../chunks/-tLY_6gf.js","../chunks/DhDrCS8X.js","../chunks/s7y6ZYeW.js","../chunks/COsUduS5.js","../chunks/fxczVhmx.js","../chunks/tfsDxZdG.js","../chunks/D6zlzagn.js","../chunks/Caulfaw_.js","../chunks/DCTsuy_4.js","../chunks/CnyFIUVt.js","../chunks/DKzVzLpH.js","../chunks/BEQnBRaB.js","../chunks/BvOub3JO.js","../chunks/e98d0pcw.js","../chunks/CUjVhFqY.js","../chunks/CXu_ESHL.js","../chunks/DRPDV87L.js","../chunks/DUN1HABK.js","../chunks/Pg2iTJw5.js","../chunks/8WtPGj6h.js","../chunks/CG7ZQ6BV.js","../chunks/BeVzuV2m.js","../chunks/Cef1xHaC.js","../chunks/BvER9tXK.js","../chunks/B9Dt7Ynm.js","../chunks/COg86Xge.js","../chunks/DWpwVUOd.js","../chunks/DeOh5xmU.js","../chunks/B3KWAeZ2.js","../chunks/C34EDYhX.js","../chunks/Bxxl7NsE.js","../chunks/CaVKkSa6.js","../chunks/CUzevAry.js","../chunks/C8zGwbjb.js","../chunks/DOU46fny.js","../chunks/CxntQxa8.js","../chunks/B21jgz5M.js","../chunks/CHMqct6U.js","../chunks/DJfmhI_b.js","../chunks/CqSK9vE_.js","../chunks/teoI27Zt.js","../chunks/BgIfDPrD.js","../chunks/Bl0cSKE5.js","../chunks/HTOW8iPe.js","../chunks/BzyQLkBI.js","../chunks/DuIgqnlY.js","../chunks/CbvgmFLt.js","../chunks/DaQyK3nQ.js","../chunks/CZyMpCUL.js","../chunks/7808le4B.js","../chunks/DqwAHjQA.js","../chunks/CFxQi9ff.js","../chunks/CRNKQexD.js","../chunks/DfDynnwy.js","../chunks/Cgb6qxNH.js","../chunks/_r5V6nso.js","../chunks/TQki0tx9.js","../chunks/Bb7XCc95.js","../chunks/BrT4CCe6.js","../chunks/B1N-tmtC.js","../chunks/CEtlHNOR.js","../chunks/BZKeGk9D.js","../chunks/D-qJO60r.js","../chunks/QQC62dOK.js","../chunks/BpZHOvkG.js","../chunks/DQOO6RKE.js","../chunks/Bi6C4OG6.js"])))=>i.map(i=>d[i]);
import{_ as Ae}from"../chunks/PPVm8Dsz.js";import"../chunks/DsnmJJEf.js";import{o as st,a as lt}from"../chunks/B12Xl85d.js";import{f as x,p as Ne,c as m,n as $t,r as p,a as We,a7 as Y,T as X,v as e,a8 as B,W as Ue,aG as A,av as Ge,u as Ze,ar as n,aX as Xt,aY as Jt,aK as Zt}from"../chunks/l2HDBFeU.js";import{e as er,g as ht}from"../chunks/7Q11sfri.js";import{c as N,a as s,f as _,t as Ke}from"../chunks/D3mgKXxP.js";import{l as tr,s as tt,p as de,r as bt,i as D}from"../chunks/amrQSy0T.js";import{c as Q}from"../chunks/BULd4hFL.js";import{a as rr,e as Ot,b as it,s as qe,f as _t}from"../chunks/B2XAts-z.js";import{b as nt}from"../chunks/CPWKExeQ.js";import{s as se}from"../chunks/CPxvWa6q.js";import{s as At,e as et,i as ar}from"../chunks/Dv6QOWAw.js";import{I as nr,s as or,e as sr,f as ir,S as wt,g as ct,h as ut,i as dt}from"../chunks/xE6fRQiE.js";import{c as ft}from"../chunks/DzE4wJgV.js";import{X as lr,A as cr,a as ur,b as dr,C as fr}from"../chunks/Ch0XtY6M.js";import"../chunks/69_IOA4Y.js";import{C as vr}from"../chunks/Cgb8ZoOw.js";import{S as ot,a as Rt}from"../chunks/Doo2pteY.js";import{B as pr}from"../chunks/Cycc-Qfx.js";import{I as mr}from"../chunks/D9YRtp1B.js";import{H as gr}from"../chunks/BUsxo-Ec.js";import{c as Et,S as _r}from"../chunks/xZ58n3t9.js";import{a as hr,b as wr}from"../chunks/AUgTM6k-.js";import{S as yt}from"../chunks/p_qY5EvW.js";import"../chunks/B17Q6ahh.js";import"../chunks/DhMSIuCj.js";import"../chunks/CaNW5Bx0.js";import"../chunks/BW0zoJTm.js";import"../chunks/CEBETtrS.js";function Ct(R){return(hr||wr)+R}function yr(R,t){const i=tr(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const h=[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3"}]];nr(R,tt({name:"command"},()=>i,{get iconNode(){return h},children:(g,y)=>{var o=N(),V=x(o);or(V,t,"default",{}),s(g,o)},$$slots:{default:!0}}))}var xr=_("<span><!></span>");function br(R,t){Ne(t,!0);let i=de(t,"ref",15,null),h=bt(t,["$$slots","$$events","$$legacy","ref","class","children"]);var g=xr();rr(g,o=>({"data-slot":"command-shortcut",class:o,...h}),[()=>ft("text-muted-foreground ml-auto text-xs tracking-widest",t.class)]);var y=m(g);At(y,()=>t.children??$t),p(g),nt(g,o=>i(o),()=>i()),s(R,g),We()}function Cr(R,t){Ne(t,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let i=bt(t,["$$slots","$$events","$$legacy"]);const h=[["path",{d:"m12 19-7-7 7-7"}],["path",{d:"M19 12H5"}]];mr(R,tt({name:"arrow-left"},()=>i,{get iconNode(){return h},children:(g,y)=>{var o=N(),V=x(o);At(V,()=>t.children??$t),s(g,o)},$$slots:{default:!0}})),We()}function Sr(R,t){R.stopPropagation(),t()?.()}var Pr=_('<button type="button" class="pointer-events-none flex h-4 w-0 items-center justify-center rounded text-muted-foreground opacity-0 transition-[width,margin-left,opacity] group-hover:pointer-events-auto group-hover:ml-1 group-hover:w-4 group-hover:opacity-100"><!></button>'),Ir=_('<div><span class="truncate"> </span> <!></div>');function Mt(R,t){Ne(t,!0);let i=de(t,"onClose",3,null);const h=t.title??t.value;var g=Ir(),y=m(g),o=m(y,!0);p(y);var V=Y(y,2);{var C=E=>{var M=Pr();M.__click=[Sr,i];var S=m(M);lr(S,{class:"size-3"}),p(M),X(()=>qe(M,"aria-label",`Clear ${t.value}`)),s(E,M)};D(V,E=>{i()&&E(C)})}p(g),X(E=>{it(g,1,E),qe(g,"title",h),se(o,t.value)},[()=>Ot(ft("group inline-flex max-w-[10rem] items-center overflow-hidden rounded border border-border px-1 py-0.5 text-xs font-medium text-muted-foreground transition-all",t.class))]),s(R,g),We()}er(["click"]);var $r=_('<!> <span aria-hidden="true" class="h-5 w-px bg-border"></span>',1),Or=_('<div class="flex h-9 items-center gap-2 border-b pl-2" data-slot="command-input-wrapper"><span class="flex h-full min-w-[1.25rem] shrink-0 items-center justify-center text-muted-foreground"><!></span> <!> <!></div>');function Ar(R,t){Ne(t,!0);let i=de(t,"ref",15,null),h=de(t,"value",15,""),g=de(t,"iconProps",19,()=>({})),y=de(t,"onCommandClose",3,null),o=bt(t,["$$slots","$$events","$$legacy","ref","class","value","icon","iconProps","commandId","onCommandClose"]);var V=Or(),C=m(V),E=m(C);{var M=I=>{const te=B(()=>t.icon);var re=N(),v=x(re);Q(v,()=>e(te),(d,$)=>{$(d,tt(g))}),s(I,re)},S=I=>{yr(I,{class:"size-4 opacity-50"})};D(E,I=>{t.icon?I(M):I(S,!1)})}p(C);var z=Y(C,2);{var F=I=>{var te=$r(),re=x(te);Mt(re,{get value(){return t.commandId},get title(){return t.commandId},get onClose(){return y()}}),Ue(2),s(I,te)};D(z,I=>{t.commandId&&I(F)})}var U=Y(z,2);{let I=B(()=>ft("flex h-10 flex-1 rounded-md bg-transparent py-3 text-sm outline-hidden placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t.class));Q(U,()=>sr,(te,re)=>{re(te,tt({"data-slot":"command-input",get class(){return e(I)}},()=>o,{get ref(){return i()},set ref(v){i(v)},get value(){return h()},set value(v){h(v)}}))})}p(V),s(R,V),We()}function Rr(R,t){Ne(t,!0);const i=de(t,"disabled",3,!1);pr(R,{class:"m-0 flex size-7 shrink-0 items-center justify-center rounded-md border-none bg-transparent p-0 text-muted-foreground opacity-50 shadow-none transition hover:bg-transparent hover:text-accent-foreground focus:outline-none focus-visible:border-transparent focus-visible:ring-0 focus-visible:ring-offset-0 focus-visible:outline-none active:ring-0 active:outline-none disabled:pointer-events-none disabled:opacity-50 has-[>svg]:px-0",onclick:()=>{i()||t.onPress?.()},"aria-label":"Return to command search",get disabled(){return i()},children:(h,g)=>{{let y=B(()=>`size-4 ${t.class}`.trim());Cr(h,{get class(){return e(y)}})}},$$slots:{default:!0}}),We()}var Er=_('<div class="flex flex-wrap gap-2 px-2 py-0.5"></div>'),Mr=_('<span class="text-xs text-muted-foreground"> </span>'),Vr=_('<div class="flex flex-col gap-0.5"><span class="text-sm leading-tight font-medium"> </span> <!></div> <!>',1),Lr=_("<!> <!>",1),kr=_('<div class="px-4 pb-3"><!></div>'),Tr=_("<!> <!>",1),Dr=_('<div class="px-4 pb-3"><!></div>'),Nr=_('<p class="text-sm text-muted-foreground">No panel registered for this command.</p>'),Wr=_('<div class="pr-2 pb-2 pl-2"><!></div>'),zr=_("<!> <!> <!>",1),Br=_("<!> <!>",1),Fr=_("<!> <!>",1),jr=_("<div><!></div>");function Ur(R,t){Ne(t,!0);let i=de(t,"ref",15,null),h=de(t,"commands",19,()=>[]),g=de(t,"placeholder",3,"Search commands..."),y=de(t,"emptyMessage",3,"No commands found."),o=A(null),V=A(null),C=A(null),E=A(null),M=A(null),S=A(null),z=A(Ge([])),F=A(""),U=A(!1),I=A(Ge(g())),te=A(null),re=!1,v=A(null),d=!1,$=null,f=null,P=0,w=null;const O=B(()=>{const a=new Map;for(const c of h())a.set(c.id,c);return Array.from(a.values())}),le=B(()=>{const a=new Map;for(const c of e(O)){const r=c.group??null,G=a.get(r);G?G.push(c):a.set(r,[c])}return a});st(()=>{Fe()});function K(a,c=!1){c&&(re=!0),n(F,a,!0)}function ae(a=null,c){if(!w||a&&w!==a)return;n(te,null),w.placeholderOverridden&&n(I,g()),(c?.forceReset??(c?.skipReset?!1:w.resetValueOnDetach))&&(K("",!0),w.onInput("")),w.onDetach?.(),w=null}function l(){ae(null,{forceReset:!0}),n(te,null),n(I,g()),re=!1}Ze(()=>{const a=e(te);if(a){if(re){re=!1;return}a(e(F))}}),Ze(()=>{e(o)||n(I,g())});function u(){if(f)try{f()}catch(a){console.error("Failed to dispose command session",a)}f=null,n(C,null),n(E,null),l(),n(V,null)}function b(){e(o)&&(u(),n(o,null),n(S,null),n(M,null),K("",!0),n(U,!0))}function k(a){try{t.commandSearchContext.get(a.classType).clear()}catch(c){console.error("Failed to clear global variable",c)}finally{Fe()}}function J(){e(v)?.blur()}function W(a,c){if(!a.component)return null;const r=a.props;return r?{component:a.component,props:()=>r(c)}:{component:a.component}}function Z(a,c){const r=a.createSession?.(c);if(r){f=r.dispose??null,Object.prototype.hasOwnProperty.call(r,"input")?n(C,r.input??null,!0):n(C,null),Object.prototype.hasOwnProperty.call(r,"content")?n(E,r.content??null,!0):n(E,W(a,c),!0);return}f=null,n(C,null),n(E,W(a,c),!0)}function j(a){const c=a.id;return{deactivate:()=>{!e(o)||e(o).id!==c||(b(),Fe())},isActive:r=>!e(o)||e(o).id!==c?!1:r?e(o).id===r:!0,setIsOpen:(r,G)=>{if(!e(o)||e(o).id!==c)return;if(r){d=!1,n(U,!0);return}const ee=G?.preserveActive??!0;Be(ee)},setInputSurface:r=>{!e(o)||e(o).id!==c||n(C,r,!0)},setContentSurface:r=>{!e(o)||e(o).id!==c||n(E,r,!0)},getInputValue:()=>e(F),setInputValue:r=>{!e(o)||e(o).id!==c||K(r,!0)},setInputHandler:r=>{if(!(!e(o)||e(o).id!==c)){if(ae(null,{skipReset:!0}),n(te,r,!0),!r){re=!1;return}r(e(F))}},setPlaceholder:r=>{!e(o)||e(o).id!==c||n(I,r,!0)},resetPlaceholder:()=>{!e(o)||e(o).id!==c||n(I,g())},attachInputBinding:r=>{if(!e(o)||e(o).id!==c)return()=>{};ae(null,{skipReset:!0});const G=r.placeholder??e(o).inputPlaceholder??g(),ee={id:++P,commandId:c,onInput:r.onInput,onDetach:r.onDetach,placeholderOverridden:!!G,resetValueOnDetach:r.resetValueOnDetach??!0};w=ee,ee.placeholderOverridden&&G&&n(I,G,!0),n(te,Re=>{!w||w.id!==ee.id||r.onInput(Re)});const q=r.resetValueOnAttach??!0,we=r.replayInitialValue??!q;return q?(K("",!0),r.onInput("")):we&&r.onInput(e(F)),()=>{ae(ee)}}}}function Ce(a){const c=e(V);if(!a)return c?{runtime:c}:{};if(!c)return{};const{props:r}=a;return r?{...typeof r=="function"?r(c):r,runtime:c}:{runtime:c}}function fe(a){return`${a.name} ${a.description??""}`.trim()}async function ce(a){if(e(o)?.id===a.id){b();return}u(),n(S,null),n(M,a.id,!0),n(U,!0),e(v)&&e(v).focus();const c=j(a);n(V,c,!0),n(o,a,!0),Z(a,c);try{await a.execute(c)}catch(r){n(S,r instanceof Error?r:new Error("Failed to execute the command."),!0)}finally{n(M,null),K("",!0),Fe()}}function He(a){const c=a.key.toLowerCase();if((a.metaKey||a.ctrlKey)&&c==="p"){if(a.preventDefault(),e(o)){b();return}e(v)&&e(v).focus();return}if(c==="escape"){if(e(o)){a.preventDefault(),b(),J();return}e(U)&&(a.preventDefault(),n(U,!1),J());return}if(!e(o))for(const G of e(O)){if(!G.shortcut)continue;const ee=G.shortcut.join(" ").toLowerCase(),q=[];if(a.metaKey&&q.push("âŒ˜"),a.ctrlKey&&q.push("Ctrl"),a.altKey&&q.push("Alt"),a.shiftKey&&q.push("Shift"),q.push(a.key.length===1?a.key.toUpperCase():a.key),q.join(" ").toLowerCase()===ee.toLowerCase()){a.preventDefault(),ce(G);break}}}function Qe(){n(U,!0)}function Be(a=!1){d=a,n(U,!1)}function rt(a){const c=$;if(!c)return;const r=a.target;r&&c.contains(r)||e(U)&&Be(!!e(o))}Ze(()=>{if(!e(U)){if(K("",!0),!e(o)){d=!1;return}if(d){d=!1;return}u(),n(o,null),n(S,null)}});function Fe(){if(!t.commandSearchContext){n(z,[],!0);return}const a=t.commandSearchContext.getGlobalVariables(),c=[];for(const r of a){const G=r.getId();G&&c.push({displayName:r.displayName,id:G,classType:r.constructor})}n(z,c,!0)}var he=jr();ht("keydown",Xt,He),ht("pointerdown",Jt,rt);var Ie=m(he);Q(Ie,()=>ir,(a,c)=>{c(a,{children:(r,G)=>{var ee=Fr(),q=x(ee);{let Se=B(()=>e(o)?e(o).inputPlaceholder??e(I):e(I)),Ye=B(()=>e(o)?Rr:void 0),Ee=B(()=>e(o)?{onPress:b,disabled:e(M)===e(o).id}:void 0),je=B(()=>e(o)?.id),xe=B(()=>e(o)?b:null);Ar(q,{get placeholder(){return e(Se)},onfocus:()=>Qe(),get icon(){return e(Ye)},get iconProps(){return e(Ee)},get commandId(){return e(je)},get onCommandClose(){return e(xe)},get value(){return e(F)},set value(ve){n(F,ve,!0)},get ref(){return e(v)},set ref(ve){n(v,ve,!0)}})}var we=Y(q,2);{var Re=Se=>{var Ye=Br(),Ee=x(Ye);{var je=ne=>{var ie=Er();et(ie,21,()=>e(z),pe=>pe.id,(pe,me)=>{{let $e=B(()=>`${e(me).displayName}: ${e(me).id}`),Ve=B(()=>`${e(me).displayName}: ${e(me).id}`);Mt(pe,{get value(){return e($e)},get title(){return e(Ve)},onClose:()=>k(e(me))})}}),p(ie),s(ne,ie)};D(Ee,ne=>{e(z).length&&ne(je)})}var xe=Y(Ee,2);{var ve=ne=>{wt(ne,{children:(ie,pe)=>{var me=N(),$e=x(me);Q($e,()=>ct,(Ve,at)=>{at(Ve,{children:(ye,ze)=>{var ge=Lr(),Le=x(ge);Q(Le,()=>ut,(Oe,_e)=>{_e(Oe,{children:(be,T)=>{Ue();var L=Ke();X(()=>se(L,y())),s(be,L)},$$slots:{default:!0}})});var ke=Y(Le,2);et(ke,17,()=>Array.from(e(le).entries()),ar,(Oe,_e)=>{var be=B(()=>Zt(e(_e),2));let T=()=>e(be)[1];var L=N(),H=x(L);et(H,17,T,ue=>ue.id,(ue,oe)=>{var Pe=N(),Te=x(Pe);{let kt=B(()=>fe(e(oe)));Q(Te,()=>dt,(Tt,Dt)=>{Dt(Tt,{get value(){return e(kt)},onclick:()=>ce(e(oe)),children:(Nt,_a)=>{var St=Vr(),vt=x(St),pt=m(vt),Wt=m(pt,!0);p(pt);var zt=Y(pt,2);{var Bt=De=>{var Je=Mr(),mt=m(Je,!0);p(Je),X(()=>se(mt,e(oe).description)),s(De,Je)};D(zt,De=>{e(oe).description&&De(Bt)})}p(vt);var Ft=Y(vt,2);{var jt=De=>{ot(De,{class:"ml-auto size-4 text-muted-foreground"})},Ut=De=>{var Je=N(),mt=x(Je);{var Kt=gt=>{var Pt=N(),Gt=x(Pt);Q(Gt,()=>br,(qt,Ht)=>{Ht(qt,{children:(Qt,ha)=>{Ue();var It=Ke();X(Yt=>se(It,Yt),[()=>e(oe).shortcut?.join(" + ")]),s(Qt,It)},$$slots:{default:!0}})}),s(gt,Pt)};D(mt,gt=>{e(oe).shortcut?.length&&gt(Kt)},!0)}s(De,Je)};D(Ft,De=>{e(M)===e(oe).id?De(jt):De(Ut,!1)})}X(()=>se(Wt,e(oe).name)),s(Nt,St)},$$slots:{default:!0}})})}s(ue,Pe)}),s(Oe,L)}),s(ye,ge)},$$slots:{default:!0}})}),s(ie,me)},$$slots:{default:!0}})},Me=ne=>{var ie=zr(),pe=x(ie);{var me=ye=>{const ze=B(()=>e(C).component);var ge=kr(),Le=m(ge);{let ke=B(()=>Ce(e(C)));Q(Le,()=>e(ze),(Oe,_e)=>{_e(Oe,tt(()=>e(ke)))})}p(ge),s(ye,ge)};D(pe,ye=>{e(C)&&ye(me)})}var $e=Y(pe,2);{var Ve=ye=>{var ze=Dr(),ge=m(ze);Q(ge,()=>cr,(Le,ke)=>{ke(Le,{variant:"destructive",children:(Oe,_e)=>{var be=Tr(),T=x(be);Q(T,()=>ur,(H,ue)=>{ue(H,{children:(oe,Pe)=>{Ue();var Te=Ke();X(()=>se(Te,`${e(o).name??""} failed`)),s(oe,Te)},$$slots:{default:!0}})});var L=Y(T,2);Q(L,()=>dr,(H,ue)=>{ue(H,{children:(oe,Pe)=>{Ue();var Te=Ke();X(()=>se(Te,e(S).message)),s(oe,Te)},$$slots:{default:!0}})}),s(Oe,be)},$$slots:{default:!0}})}),p(ze),s(ye,ze)};D($e,ye=>{e(S)&&ye(Ve)})}var at=Y($e,2);wt(at,{children:(ye,ze)=>{var ge=Wr(),Le=m(ge);{var ke=_e=>{const be=B(()=>e(E).component);var T=N(),L=x(T);{let H=B(()=>Ce(e(E)));Q(L,()=>e(be),(ue,oe)=>{oe(ue,tt(()=>e(H)))})}s(_e,T)},Oe=_e=>{var be=N(),T=x(be);Q(T,()=>vr,(L,H)=>{H(L,{class:"px-0",children:(ue,oe)=>{var Pe=Nr();s(ue,Pe)},$$slots:{default:!0}})}),s(_e,be)};D(Le,_e=>{e(E)?_e(ke):_e(Oe,!1)})}p(ge),s(ye,ge)},$$slots:{default:!0}}),s(ne,ie)};D(xe,ne=>{e(o)?ne(Me,!1):ne(ve)})}s(Se,Ye)};D(we,Se=>{e(U)&&Se(Re)})}s(r,ee)},$$slots:{default:!0}})}),p(he),nt(he,a=>$=a,()=>$),nt(he,a=>i(a),()=>i()),X(a=>it(he,1,a),[()=>Ot(ft("space-y-4",t.class))]),s(R,he),We()}class Vt{#e=A(null);#t=A(!1);#r=A(null);load=async(t,i)=>{n(this.#t,!0),n(this.#r,null);try{const h=await gr(t,{...i,responseType:"json"});console.log("Esri Request Response:",h,h.data.url),n(this.#e,h.data,!0)}catch(h){n(this.#r,h,!0)}finally{n(this.#t,!1)}};get data(){return e(this.#e)}get isLoading(){return e(this.#t)}get error(){return e(this.#r)}}class Lt{colour=null;id=null;getId(){return this.id}setId(t){this.id=t}clear(){this.setId(null)}}class Xe extends Lt{displayName="org";organisations;constructor(t){super(),this.organisations=new Map(t.map(i=>[i.id,i])),t.length>0&&this.setId(t[0].id)}setActiveOrganisation(t){this.setId(t)}getActiveOrganisationId(){return this.id}getActiveOrganisationPortalUrl(){const t=this.organisations.get(this.getActiveOrganisationIdInternal());if(!t)throw new Error("No organisation is currently selected.");return t.portalUrl}getActiveOrganisationEndpoint(){const t=this.organisations.get(this.getActiveOrganisationIdInternal());if(!t)throw new Error("No organisation is currently selected.");return t.endpoint}getActiveOrganisationQueryParams(){const t=this.organisations.get(this.getActiveOrganisationIdInternal());if(!t)throw new Error("No organisation is currently selected.");return t.queryParams||{}}getActiveOrganisationIdInternal(){if(!this.id)throw new Error("No organisation is currently selected.");return this.id}}var Kr=_('<div class="error-message svelte-11six79"><p class="text-sm text-red-600 svelte-11six79"> </p></div>'),Gr=_('<div class="flex items-center justify-center p-4"><!></div>'),qr=_('<div class="flex items-center gap-2"><!> <span class="title-text w-full font-medium text-foreground svelte-11six79"> </span></div>'),Hr=_('<span class="description-text text-xs text-gray-500 svelte-11six79"> </span>'),Qr=_('<div class="error-message svelte-11six79"><!> <p class="text-sm text-red-600 svelte-11six79"> </p></div>'),Yr=_('<div class="flex w-full min-w-0 flex-col gap-0.5"><span class="title-text font-medium text-foreground svelte-11six79"> </span> <!> <!></div>'),Xr=_('<div class="item-container svelte-11six79"><!></div>');function Jr(R,t){Ne(t,!0);const i=de(t,"mapView",7),h=de(t,"runtime",3,null),g=new Vt;let y=A(null),o=Ge(new yt),V=A(""),C=A(Ge([]));const E=B(()=>{const v=e(C);console.log("Filtering web maps with data:",v);const d=e(V).trim().toLowerCase();return d?v.filter($=>{const f=$?.title?.toLowerCase()??"",P=$?.description?.toLowerCase()??"";return f.includes(d)||P.includes(d)}):v});st(async()=>{const d=t.commandSearchContext.get(Xe).getActiveOrganisationId();if(!d){console.warn("No active organisation selected in OrganisationCommandService");return}try{const $=await fetch(Ct(`/api/maps/${d}.json`));if(!$.ok)throw new Error(`Failed to fetch maps: ${$.status} ${$.statusText}`);const f=await $.json();n(C,(f.results??[]).filter(P=>P.type.toLowerCase()==="web map").map(P=>({id:P.id,title:P.title,description:Et(P.description),owner:P.owner,tags:P.tags})),!0)}catch($){console.error("Error fetching web maps:",$)}});let M=null,S=null,z=t.inputPlaceholder??"Search...";Ze(()=>{const v=h(),d=t.inputPlaceholder??"Search...";if(!v){M?.(),M=null,S=null,z=d,n(V,"");return}if(v===S){d!==z&&(v.setPlaceholder(d),z=d);return}M?.(),M=null,z=d,M=v.attachInputBinding({placeholder:d,onInput:$=>{n(V,$,!0)}}),S=v}),lt(()=>{M?.(),M=null,S=null});async function F(v){if(!i()){console.error("MapView is not initialized"),o.set(v,new Error("MapView is not ready. Please wait and try again."));return}n(y,v,!0),o.delete(v);try{console.log(`Loading web map with ID: ${v}`);const d=t.commandSearchContext.get(Xe);if(!d.getActiveOrganisationId()){console.warn("No active organisation selected in OrganisationCommandService");return}const f=d.getActiveOrganisationPortalUrl(),{default:P}=await Ae(async()=>{const{default:K}=await import("../chunks/DpAKiq6K.js").then(ae=>ae.W);return{default:K}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151]),import.meta.url),w=new P({portalItem:{id:v,portal:{url:f}}});await w.load(),console.log("Web map loaded successfully"),console.log("Applying web map to MapView",i().ui),i().map=w,console.log("Web map applied to MapView"),await(await Ae(()=>import("../chunks/DwerzRSF.js").then(K=>K.m),__vite__mapDeps([10,1,2,3,11,4,5,6]),import.meta.url)).whenOnce(()=>i().ready),console.log("MapView updated with new web map");const le=w.initialViewProperties?.viewpoint?.targetGeometry;le&&(console.log("Navigating to web map initial viewpoint"),await i().goTo(le),console.log("MapView navigated to web map initial viewpoint")),h()?.setIsOpen(!1)}catch(d){console.error("Error loading web map:",d),o.set(v,d),n(y,null)}finally{n(y,null)}}var U=Xr(),I=m(U);{var te=v=>{var d=Kr(),$=m(d),f=m($);p($),p(d),X(()=>se(f,`${g.error.message??""}. ${g.error?.details?.httpStatus===0?"Reason: CORS Error. See console for more information.":""}`)),s(v,d)},re=v=>{var d=N(),$=x(d);{var f=w=>{var O=Gr(),le=m(O);ot(le,{class:"size-5"}),p(O),s(w,O)},P=w=>{var O=N(),le=x(O);Q(le,()=>ct,(K,ae)=>{ae(K,{children:(l,u)=>{var b=N(),k=x(b);{var J=Z=>{var j=N(),Ce=x(j);Q(Ce,()=>ut,(fe,ce)=>{ce(fe,{children:(He,Qe)=>{Ue();var Be=Ke("No web maps match your search.");s(He,Be)},$$slots:{default:!0}})}),s(Z,j)},W=Z=>{var j=N(),Ce=x(j);et(Ce,17,()=>e(E),fe=>fe.id,(fe,ce)=>{var He=N(),Qe=x(He);Q(Qe,()=>dt,(Be,rt)=>{rt(Be,{onclick:()=>F(e(ce).id),children:(Fe,he)=>{const Ie=B(()=>o.get(e(ce).id));var a=N(),c=x(a);{var r=ee=>{var q=qr(),we=m(q);ot(we,{class:"size-4"});var Re=Y(we,2),Se=m(Re);p(Re),p(q),X(()=>se(Se,`Loading ${e(ce).title??"Untitled web map"??""}...`)),s(ee,q)},G=ee=>{var q=Yr(),we=m(q),Re=m(we,!0);p(we);var Se=Y(we,2);{var Ye=xe=>{var ve=Hr(),Me=m(ve,!0);p(ve),X(()=>{qe(ve,"title",e(ce).description),se(Me,e(ce).description)}),s(xe,ve)};D(Se,xe=>{e(ce).description&&xe(Ye)})}var Ee=Y(Se,2);{var je=xe=>{const ve=B(()=>`${e(Ie).message}. ${e(Ie).details?.error?.details?.httpStatus===0?"Reason: CORS Error. See console for more information.":""}`);var Me=Qr(),ne=m(Me);Rt(ne,{class:"error-icon",size:16});var ie=Y(ne,2),pe=m(ie,!0);p(ie),p(Me),X(()=>{qe(Me,"title",e(ve)),se(pe,e(ve))}),s(xe,Me)};D(Ee,xe=>{e(Ie)&&xe(je)})}p(q),X(()=>{qe(we,"title",e(ce).title),se(Re,e(ce).title??"Untitled web map")}),s(ee,q)};D(c,ee=>{e(y)===e(ce).id?ee(r):ee(G,!1)})}s(Fe,a)},$$slots:{default:!0}})}),s(fe,He)}),s(Z,j)};D(k,Z=>{e(E).length===0?Z(J):Z(W,!1)})}s(l,b)},$$slots:{default:!0}})}),s(w,O)};D($,w=>{g.isLoading?w(f):w(P,!1)},!0)}s(v,d)};D(I,v=>{g.error?v(te):v(re,!1)})}p(U),s(R,U),We()}class xt{#e=[];constructor(t){this.#e=t}get organisations(){return this.#e}}var Zr=_('<div class="flex w-full min-w-0 flex-col gap-0.5"><span class="title-text font-medium text-foreground svelte-1w2u78y"> </span></div>'),ea=_('<div class="item-container svelte-1w2u78y"><!></div>');function ta(R,t){Ne(t,!0);const i=de(t,"runtime",3,null);let h=A(Ge([])),g=A("");st(async()=>{const S=t.commandSearchContext.get(xt)?.organisations;if(!S){console.warn("No organisation configuration found in MapsConfig");return}n(h,S,!0)});let y=null,o=null,V=t.inputPlaceholder??"Search...";Ze(()=>{const S=i(),z=t.inputPlaceholder??"Search...";if(!S){y?.(),y=null,o=null,V=z,n(g,"");return}if(S===o){z!==V&&(S.setPlaceholder(z),V=z);return}y?.(),y=null,V=z,y=S.attachInputBinding({placeholder:z,onInput:F=>{n(g,F,!0)}}),o=S}),lt(()=>{y?.(),y=null,o=null});function C(S){t.commandSearchContext.get(Xe).setActiveOrganisation(S),i()&&i().deactivate()}var E=ea(),M=m(E);Q(M,()=>ct,(S,z)=>{z(S,{children:(F,U)=>{var I=N(),te=x(I);{var re=d=>{var $=N(),f=x($);Q(f,()=>ut,(P,w)=>{w(P,{children:(O,le)=>{Ue();var K=Ke("No organisations match your search.");s(O,K)},$$slots:{default:!0}})}),s(d,$)},v=d=>{var $=N(),f=x($);et(f,17,()=>e(h),P=>P.name,(P,w)=>{var O=N(),le=x(O);Q(le,()=>dt,(K,ae)=>{ae(K,{onclick:()=>C(e(w).id),children:(l,u)=>{var b=Zr(),k=m(b),J=m(k,!0);p(k),p(b),X(()=>se(J,e(w).name??"Untitled organisation")),s(l,b)},$$slots:{default:!0}})}),s(P,O)}),s(d,$)};D(te,d=>{e(h).length===0?d(re):d(v,!1)})}s(F,I)},$$slots:{default:!0}})}),p(E),s(R,E),We()}class ra{services=new Map;globalVariables=new Map;add(t,i){this.services.set(t,i),i instanceof Lt&&this.globalVariables.set(t,i)}get(t){const i=this.services.get(t);if(!i)throw new Error(`Service not found for token: ${t.name}`);return i}has(t){return this.services.has(t)}getGlobalVariables(){return Array.from(this.globalVariables.values())}}globalThis.process?.versions?.webcontainer;Ae(()=>import("../chunks/BIHI7g3E.js"),[],import.meta.url).then(R=>new R.AsyncLocalStorage).catch(()=>{});var aa=_('<div class="error-message svelte-1lap2l5"><p class="text-sm text-red-600 svelte-1lap2l5"> </p></div>'),na=_('<div class="flex items-center justify-center p-4"><!></div>'),oa=_('<div class="flex items-center gap-2"><!> <span class="title-text w-full font-medium text-foreground svelte-1lap2l5"> </span></div>'),sa=_('<div class="flex items-center gap-2"><!></div>'),ia=_('<span class="description-text text-xs text-gray-500 svelte-1lap2l5"> </span>'),la=_('<span class="text-[11px] text-muted-foreground"> </span>'),ca=_('<span class="text-[11px] text-muted-foreground"> <!></span>'),ua=_('<div class="error-message svelte-1lap2l5"><!> <p class="text-sm text-red-600 svelte-1lap2l5"> </p></div>'),da=_('<!> <div class="flex w-full min-w-0 flex-col gap-0.5"><span class="title-text font-medium text-foreground svelte-1lap2l5"> </span> <!> <!> <!> <!></div>',1),fa=_('<div class="item-container svelte-1lap2l5"><!></div>');function va(R,t){Ne(t,!0);const i=de(t,"mapView",7),h=de(t,"runtime",3,null),g=new Vt;let y=A(null),o=Ge(new yt),V=A(""),C=A(Ge(new yt)),E=A(Ge([]));const M=new Map,S={27700:"OS_Open_Background"},z=B(()=>{const l=e(E),u=e(V).trim().toLowerCase();return u?l.filter(b=>{const k=b?.title?.toLowerCase()??"",J=b?.description?.toLowerCase()??"";return k.includes(u)||J.includes(u)}):l});st(async()=>{const l=t.commandSearchContext.get(Xe),u=l.getActiveOrganisationId();if(!u){console.warn("No active organisation selected in OrganisationCommandService");return}l.getActiveOrganisationPortalUrl(),l.getActiveOrganisationEndpoint();const b=["Feature Layer","Feature Service","Map Service","Image Service"],k=await fetch(Ct(`/api/maps/${u}.json`));if(!k.ok)throw new Error(`Failed to fetch maps: ${k.status} ${k.statusText}`);const J=await k.json();n(E,(J.results??[]).filter(W=>b.includes(W.type)).map(W=>({id:W.id,title:W.title,description:Et(W.description),owner:W.owner,tags:W.tags})),!0),M.clear();for(const W of e(E))M.set(W.id,W)});let F=null,U=null,I=t.inputPlaceholder??"Search...";Ze(()=>{const l=h(),u=t.inputPlaceholder??"Search...";if(!l){F?.(),F=null,U=null,I=u,n(V,"");return}if(l===U){u!==I&&(l.setPlaceholder(u),I=u);return}F?.(),F=null,I=u,F=l.attachInputBinding({placeholder:u,onInput:b=>{n(V,b,!0)}}),U=l}),lt(()=>{F?.(),F=null,U=null});async function te(l){e(C).has(l)?re(l):await v(l)}function re(l){const u=e(C).get(l);!u||!i()||!i().map||(i().map.remove(u),e(C).delete(l),n(C,e(C),!0),console.log(`Layer removed from the map: ${l}`))}async function v(l){if(!i()||!i().map){console.error("Map or MapView is not initialized"),o.set(l,new Error("Map is not ready. Please wait and try again."));return}n(y,l,!0),o.delete(l);try{console.log(`Loading layer with portal item ID: ${l}`);const u=t.commandSearchContext.get(Xe);if(!u.getActiveOrganisationId()){console.warn("No active organisation selected in OrganisationCommandService");return}const k=u.getActiveOrganisationPortalUrl(),[{default:J},{default:W}]=await Promise.all([Ae(()=>import("../chunks/BTNr9f9k.js").then(fe=>fe.u),__vite__mapDeps([15,1,2,3,5,4,6,9,10,11,12]),import.meta.url),Ae(()=>import("../chunks/y1GB1Svy.js").then(fe=>fe.P),__vite__mapDeps([11,4,1,2,3,5,6]),import.meta.url)]),Z=new W({url:k}),j=await J.fromPortalItem({portalItem:{id:l,portal:Z}});await j.load();const Ce=await d(j,l);await w(Ce),i().map.add(j),e(C).set(l,j),n(C,e(C),!0),console.log("Layer added to the map");try{await i().whenLayerView(j),j.fullExtent&&await i().goTo(j.fullExtent)}catch(fe){console.warn("Layer view not ready for navigation",fe)}}catch(u){console.error("Error loading layer:",u),o.set(l,u),n(y,null)}finally{n(y,null)}}async function d(l,u){const b=$(l);if(b)return b;const k=M.get(u);if(k?.spatialReferenceWkid){const{default:W}=await Ae(async()=>{const{default:Z}=await import("../chunks/BUsxo-Ec.js").then(j=>j.bc);return{default:Z}},__vite__mapDeps([5,1,2,3,4,6]),import.meta.url);return new W({wkid:k.spatialReferenceWkid})}const J=l.portalItem?.spatialReference;return J||null}function $(l){return l?.spatialReference??null}function f(l){if(!l)return;const u=l;return l.wkid??u?.latestWkid??void 0}async function P(l){if(!i()||!i().map)return console.warn("MapView or Map is not available for basemap loading"),null;if(!l)return i().map.basemap;const u=S[l];if(!u)return i().map.basemap;const{default:b}=await Ae(async()=>{const{default:k}=await import("../chunks/CjBjO1Km.js").then(J=>J.B);return{default:k}},__vite__mapDeps([8,4,1,2,3,5,6,9,10,11,12,13,14,15,16,17,18,19]),import.meta.url);try{return await b.fromId(u)}catch(k){return console.warn(`Failed to load basemap ${u}`,k),i().map.basemap}}async function w(l){if(!i()||!i().map||!l){console.log("MapView or target spatial reference is not available","mapView:",i(),"target:",l);return}const u=f(l),b=f(i().spatialReference??void 0);if(console.log(`Ensuring map view spatial reference compatibility: target WKID=${u}, current WKID=${b}`),!u||u===b)return;const[{default:k}]=await Promise.all([Ae(()=>import("../chunks/BEZFO2vt.js").then(Ce=>Ce.M),__vite__mapDeps([7,1,2,3,8,4,5,6,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37]),import.meta.url)]),J=await P(u),W=i().map.layers.toArray(),Z=i().map.ground;i().map.removeAll();const j=new k({basemap:J??void 0,ground:Z});j.spatialReference=l,j.layers.addMany(W),i().map=j,await i().when()}var O=fa(),le=m(O);{var K=l=>{var u=aa(),b=m(u),k=m(b);p(b),p(u),X(()=>se(k,`${g.error.message??""}. ${g.error?.details?.httpStatus===0?"Reason: CORS Error. See console for more information.":""}`)),s(l,u)},ae=l=>{var u=N(),b=x(u);{var k=W=>{var Z=na(),j=m(Z);ot(j,{class:"size-5"}),p(Z),s(W,Z)},J=W=>{var Z=N(),j=x(Z);Q(j,()=>ct,(Ce,fe)=>{fe(Ce,{children:(ce,He)=>{var Qe=N(),Be=x(Qe);{var rt=he=>{var Ie=N(),a=x(Ie);Q(a,()=>ut,(c,r)=>{r(c,{children:(G,ee)=>{Ue();var q=Ke("No layers match your search.");s(G,q)},$$slots:{default:!0}})}),s(he,Ie)},Fe=he=>{var Ie=N(),a=x(Ie);et(a,17,()=>e(z),c=>c.id,(c,r)=>{var G=N(),ee=x(G);{let q=B(()=>e(C).has(e(r).id)?"layer-selected":"");Q(ee,()=>dt,(we,Re)=>{Re(we,{onclick:()=>te(e(r).id),get class(){return e(q)},children:(Se,Ye)=>{const Ee=B(()=>o.get(e(r).id));var je=N(),xe=x(je);{var ve=ne=>{var ie=oa(),pe=m(ie);ot(pe,{class:"size-4"});var me=Y(pe,2),$e=m(me);p(me),p(ie),X(()=>se($e,`Loading ${e(r).title??"Untitled layer"??""}...`)),s(ne,ie)},Me=ne=>{var ie=da(),pe=x(ie);{var me=T=>{var L=sa(),H=m(L);fr(H,{}),p(L),s(T,L)};D(pe,T=>{e(C).has(e(r).id)&&T(me)})}var $e=Y(pe,2),Ve=m($e),at=m(Ve,!0);p(Ve);var ye=Y(Ve,2);{var ze=T=>{var L=ia(),H=m(L,!0);p(L),X(()=>{qe(L,"title",e(r).description),se(H,e(r).description)}),s(T,L)};D(ye,T=>{e(r).description&&T(ze)})}var ge=Y(ye,2);{var Le=T=>{var L=la(),H=m(L,!0);p(L),X(()=>se(H,e(r).type??"")),s(T,L)};D(ge,T=>{e(r).type&&T(Le)})}var ke=Y(ge,2);{var Oe=T=>{var L=ca(),H=m(L),ue=Y(H);{var oe=Pe=>{var Te=Ke();Te.nodeValue=" (auto aligns view)",s(Pe,Te)};D(ue,Pe=>{S[e(r).spatialReferenceWkid]&&Pe(oe)})}p(L),X(()=>se(H,`WKID ${e(r).spatialReferenceWkid??""} `)),s(T,L)};D(ke,T=>{e(r).spatialReferenceWkid&&T(Oe)})}var _e=Y(ke,2);{var be=T=>{const L=B(()=>`${e(Ee).message}. ${e(Ee).details?.error?.details?.httpStatus===0?"Reason: CORS Error. See console for more information.":""}`);var H=ua(),ue=m(H);Rt(ue,{size:16});var oe=Y(ue,2),Pe=m(oe,!0);p(oe),p(H),X(()=>{qe(H,"title",e(L)),se(Pe,e(L))}),s(T,H)};D(_e,T=>{e(Ee)&&T(be)})}p($e),X(()=>{qe(Ve,"title",e(r).title),se(at,e(r).title??"Untitled layer")}),s(ne,ie)};D(xe,ne=>{e(y)===e(r).id?ne(ve):ne(Me,!1)})}s(Se,je)},$$slots:{default:!0}})})}s(c,G)}),s(he,Ie)};D(Be,he=>{e(z).length===0?he(rt):he(Fe,!1)})}s(ce,Qe)},$$slots:{default:!0}})}),s(W,Z)};D(b,W=>{g.isLoading?W(k):W(J,!1)},!0)}s(l,u)};D(le,l=>{g.error?l(K):l(ae,!1)})}p(O),s(R,O),We()}var pa=_("<arcgis-layer-list></arcgis-layer-list>",2),ma=_('<div id="search-slot" class="absolute top-3 left-1/2 z-10 -translate-x-1/2"><!></div>'),ga=_("<arcgis-map><!></arcgis-map>",2);function Ha(R,t){Ne(t,!0);const i=new ra;let h=A(null),g=A(null),y=A(null),o=A(null),V=A(null),C=A(null),E=A(null),M=A(null),S=A(!1);st(async()=>{const f=await z(),P=new Xe(f.organisations);i.add(xt,f),i.add(Xe,P),await U(),n(V,I(),!0),n(C,te(),!0),n(E,re(),!0),n(M,v(),!0)});async function z(){const f=await fetch(Ct("/config/maps/config.json"));if(!f.ok)throw new Error(`Failed to load maps config: ${f.status} ${f.statusText}`);const P=await f.json();return new xt(P.organisations)}async function F(){if(!e(y))return;n(h,e(y).view,!0);const f="#cfd3d4";e(y).background={color:f},e(o)&&(e(o).view=e(h),e(o).listItemCreatedFunction=P=>{const{item:w}=P;w.layer.type!="group"&&(w.panel={content:"legend",open:!0})})}async function U(){await Ae(()=>import("../chunks/BRIeeldl.js").then(f=>f.a),__vite__mapDeps([152,153,154,145,1,2,3,10,11,4,5,6,155,156,12,157,9,158,159,17,26,15,160,161,162,54,25,55,24,20,21,22,163,164]),import.meta.url),await Ae(()=>import("../chunks/DN8pD2EM.js"),__vite__mapDeps([165,166,154,145,1,2,3,10,11,4,5,6,155,167,168,169,170,171,172,173,174,175,156,176,177,153,12,157,17,161,178,59,9,15,55,179,20,21,22,33,79,80,35,36,180,129,130,121,122,57,24,58,13,25,60,61,62,63,64,65,181,132,133,182,102,103,104,183,184,185,186,84,187,83,188,189,190,118,119,120,97,98,99,100,53,54,41,32,42,56,94,101,107,123,43,124,125,47,126,127,128,131,96,105,106,108,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,164]),import.meta.url),await Ae(()=>import("../chunks/BgIfDPrD.js"),__vite__mapDeps([219,166,154,145,1,2,3,10,11,4,5,6,155,167,168,220,171,173,221,176,156,175,222,223,224,225,183,153,12,157,226,38,39,25,40,22,41,32,33,42,20,21,43,9,23,71,72,17,227,53,54,55,24,56,57,58,59,13,60,61,62,63,64,65,34,228,229,159,26,230,15,231,7,8,14,16,18,19,27,28,29,30,31,35,36,37,91,47,158,89,69,52,232,182,233,234,50,51,209,235,236,237,238,239,240,241,208,242,243,214,244,218,163,0,44,45,46,48,49,66,67,68,70,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,90,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,146,147,148,149,150,151]),import.meta.url)}lt(()=>{n(V,null),n(C,null),n(E,null),n(M,null)});function I(){const f={id:"add-web-map",name:"Add web map",description:"Fetch and display web maps.",group:"Maps",shortcut:["Ctrl","M"],inputPlaceholder:"Search web maps...",execute:async P=>{},component:Jr,props:P=>({commandSearchContext:i,mapView:e(h),inputPlaceholder:f.inputPlaceholder})};return f}function te(){const f={id:"add-layer",name:"Add layers",description:"Fetch and display layers.",group:"Maps",shortcut:["Ctrl","L"],execute:async P=>{},component:va,props:P=>({commandSearchContext:i,mapView:e(h),inputPlaceholder:f.inputPlaceholder})};return f}function re(){return{id:"add-organisation",name:"Add organisation",description:"Find and add an organisation to filter items by.",group:"Maps",shortcut:["Ctrl","O"],inputPlaceholder:"Search organisations...",component:ta,execute:async f=>{},props:f=>({commandSearchContext:i,inputPlaceholder:"Search organisations..."})}}function v(){return{id:"clear-map",name:"Clear map",description:"Clear all layers and reset the map view.",shortcut:["Ctrl","C"],execute:async f=>{e(h)&&e(h).map&&(e(h).map.layers.removeAll(),e(h).map.basemap="gray"),f.deactivate()}}}var d=N(),$=x(d);{const f=w=>{wt(w,{class:"h-full",children:(O,le)=>{var K=pa();it(K,1,"mx-2 min-h-20"),nt(K,ae=>n(o,ae),()=>e(o)),s(O,K)},$$slots:{default:!0}})},P=w=>{var O=ga();it(O,1,"relative h-full w-full"),_t(O,"basemap","gray"),_t(O,"center","-2.231774828836059,53.46531847221502"),_t(O,"zoom","15");var le=m(O);{var K=ae=>{var l=ma(),u=m(l);{let b=B(()=>[e(E),e(V),e(C),e(M)]);Ur(u,{class:"w-full max-w-md",get commandSearchContext(){return i},get commands(){return e(b)},get ref(){return e(g)},set ref(k){n(g,k,!0)}})}p(l),s(ae,l)};D(le,ae=>{e(V)&&e(C)&&e(E)&&e(M)&&ae(K)})}p(O),nt(O,ae=>n(y,ae),()=>e(y)),ht("arcgisViewReadyChange",O,F),s(w,O)};Q($,()=>_r,(w,O)=>{O(w,{get isOpen(){return e(S)},onToggle:()=>n(S,!e(S)),sidebarContent:f,mainContent:P,$$slots:{sidebarContent:!0,mainContent:!0}})})}s(R,d),We()}export{Ha as component};
