const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/CVaFVXl_.js","../chunks/DEfw6_ef.js","../chunks/BsH20_Vs.js","../chunks/Cg-g7sfq.js","../chunks/PPVm8Dsz.js","../chunks/CbSHxjnO.js","../chunks/CuDkSQ9K.js","../chunks/tWIlYmLc.js","../chunks/CxlgmuS0.js","../chunks/H0QphIdm.js","../chunks/CYlsogSb.js","../chunks/DiDKkOPS.js","../chunks/CupCqN7H.js","../chunks/XDfhPTz9.js","../chunks/i1FBtECX.js","../chunks/DEofI9xF.js","../chunks/CXxgNwmb.js","../chunks/BvZUr92_.js","../chunks/ClNG7cqw.js","../chunks/CpmMRAq-.js","../chunks/Cp_8tW2x.js","../chunks/BsdKzw5M.js","../chunks/C_0-aHjr.js","../chunks/Ci6C1k20.js","../chunks/bnayRBMH.js","../chunks/62qj6Kpw.js","../chunks/CErz6YiP.js","../chunks/GBH_ff3h.js","../chunks/Oe6SV2kF.js","../chunks/CTb2irFk.js","../chunks/MtSiOt06.js","../chunks/C0wm8_Yw.js","../chunks/3slrYEkV.js","../chunks/D0AGBp4m.js","../chunks/BXgHj_R5.js","../chunks/v-Ii51UH.js","../chunks/FGXSRGVg.js","../chunks/C0i3V7C8.js","../chunks/Djp3mnm5.js","../chunks/DKyYFRGo.js","../chunks/DYawoE1a.js","../chunks/B48eeFnl.js","../chunks/BYatnZGe.js","../chunks/B87vTgcy.js","../chunks/6L2SN8qu.js","../chunks/CVfonb79.js","../chunks/wCjEFJCX.js","../chunks/DmBOxXOl.js","../chunks/DRBpbFTt.js","../chunks/CIVnWVW-.js","../chunks/Cs8pR8So.js","../chunks/l8ODxJLy.js","../chunks/BXmoyKZo.js","../chunks/CnMVBO6H.js","../chunks/D_njKkhs.js","../chunks/DzMNFj8U.js","../chunks/DV4r8n6I.js","../chunks/B2U_oPpb.js","../chunks/CNDan-Rx.js","../chunks/DGDScQxG.js","../chunks/CVwTD0fV.js","../chunks/D2jIvlkk.js","../chunks/Bwyp3dnI.js","../chunks/DPJXGPFY.js","../chunks/ExwrXyXn.js","../chunks/BGpT5vjv.js","../chunks/q_b6UJoq.js","../chunks/ktuqrY34.js","../chunks/Ctgqef5D.js","../chunks/CMiA3YQc.js","../chunks/kwrskX6P.js","../chunks/CSXZNpHb.js","../chunks/B5sfERVE.js","../chunks/DrKQjMrE.js","../chunks/DYatL6-0.js","../chunks/D3qbIiMo.js","../chunks/Bc4mpJhY.js","../chunks/SKHDfhet.js","../chunks/x-rwtYAj.js","../chunks/CnMl1gv8.js","../chunks/S1-2yIgm.js","../chunks/_Pe164bs.js","../chunks/CuL02vTr.js","../chunks/DgVWghap.js","../chunks/-RG-nG9T.js","../chunks/fsKfK0sy.js","../chunks/DQbAsBwU.js","../chunks/spAbxKnx.js","../chunks/CX3ZFNfL.js","../chunks/BmF0IJ7E.js","../chunks/36uNJNa5.js","../chunks/CEKE62pQ.js","../chunks/B5qWImIY.js","../chunks/CiTlTuUs.js","../chunks/Bdxq8yCu.js","../chunks/CNS1QZY8.js","../chunks/Dsdk2tBG.js","../chunks/CbFgluc7.js","../chunks/B5Hsb4hi.js","../chunks/C0kKYzrM.js","../chunks/kRFlM29_.js","../chunks/CzKZmtx0.js","../chunks/DLaSncW_.js","../chunks/ByqZcsO_.js","../chunks/4JtatMd6.js","../chunks/rk55UWB4.js","../chunks/queAb42C.js","../chunks/B6ZUGniA.js","../chunks/Dlz37zDM.js","../chunks/GKolV7NZ.js","../chunks/BBdCmBkR.js","../chunks/vZpAfLDx.js","../chunks/x3RVuiyh.js","../chunks/88DWifGA.js","../chunks/Bmgo1H0I.js","../chunks/8AGV1qtY.js","../chunks/92klRbLe.js","../chunks/DJbTxK2-.js","../chunks/ggylUvPH.js","../chunks/Cto6YqlL.js","../chunks/DhzudQro.js","../chunks/BNpAlv8J.js","../chunks/BeANzU7s.js","../chunks/B_Z9OVhx.js","../chunks/DJ9aDd4R.js","../chunks/DKwqxe3-.js","../chunks/D8ujzhvG.js","../chunks/BZQvkt3k.js","../chunks/DLLlF3RK.js","../chunks/Dt79-m9U.js","../chunks/CcIpjlrY.js","../chunks/m4Bs3uz7.js","../chunks/B5rM3F5M.js","../chunks/JCteah4Q.js","../chunks/qyF9FwQ9.js","../chunks/XI-Li77m.js","../chunks/BmnLPdqE.js","../chunks/BTIdS9sW.js","../chunks/DPb6J-GU.js","../chunks/CEe-6-vO.js","../chunks/wviEkgi6.js","../chunks/LY0Drczk.js","../chunks/CKHFt-LJ.js","../chunks/CHyjlL6-.js","../chunks/BfrB-kUx.js","../chunks/DzoO0ETS.js","../chunks/noHA0x_k.js","../chunks/CxJOUKnC.js","../chunks/BJ6k9N22.js","../chunks/DOTCkzsN.js","../chunks/DvKU1K2H.js","../chunks/HwIixIZ0.js","../chunks/DVPBzQS7.js","../chunks/0vDwWQHq.js","../chunks/WnwY1cq9.js","../chunks/BZA5O26k.js","../chunks/CaYZrGFV.js","../chunks/BmdmkRWj.js","../chunks/SBtBj7ez.js","../chunks/BlOilgcx.js","../assets/index.CQED0rIl.css","../chunks/C86rxpFH.js","../assets/component-utils.R4SXog4D.css","../chunks/BgGtT-vP.js","../chunks/WNRSLWWh.js","../chunks/D7sjVwUC.js","../chunks/Bqr-YjQV.js","../chunks/Dev14Fca.js","../chunks/BQBvadb7.js","../chunks/D-YQ4CHs.js","../chunks/BsPoaGfF.js","../chunks/BAhz9MKi.js","../chunks/CeqJsXbK.js","../chunks/A2K4dE1a.js","../chunks/CX3IZWTl.js","../chunks/Bth7Ll1g.js","../chunks/Cye58NZd.js","../chunks/CutkEP18.js","../chunks/DlHjpvET.js","../chunks/BJnaOA66.js","../chunks/DtjklSP3.js","../chunks/DertmneE.js","../chunks/D-VB-ZHk.js","../chunks/CiMdwfzi.js","../chunks/Chviu7eU.js","../chunks/C-PjMKIB.js","../chunks/Dijr96_X.js","../chunks/PhPQlpzX.js","../chunks/Bz66wGT9.js","../chunks/uk9lHvW8.js","../chunks/B2QWAqRw.js","../chunks/DPiLst09.js","../chunks/Caulfaw_.js","../chunks/BSy61h9h.js","../chunks/BkJOCBBA.js","../chunks/DKzVzLpH.js","../chunks/BEQnBRaB.js","../chunks/BvOub3JO.js","../chunks/C80vPeWo.js","../chunks/TKtbiHGB.js","../chunks/V8jMxd6d.js","../chunks/Cy3_dJ8V.js","../chunks/vJMhwmKd.js","../chunks/DcUFvIsU.js","../chunks/8WtPGj6h.js","../chunks/CG7ZQ6BV.js","../chunks/CBX-opEd.js","../chunks/Dia7qMWH.js","../chunks/BvER9tXK.js","../chunks/BE-WLbqu.js","../chunks/BEk5HM00.js","../chunks/DcgBexGX.js","../chunks/CrZlqb-i.js","../chunks/qhy4d8zv.js","../chunks/DxGTYUg1.js","../chunks/Bxxl7NsE.js","../chunks/CaVKkSa6.js","../chunks/CUzevAry.js","../chunks/C8zGwbjb.js","../chunks/B8OzWm2-.js","../chunks/C6E8A4ZY.js","../chunks/B-bZALxR.js","../chunks/DcQChemz.js","../chunks/BEgDNHW-.js","../chunks/DFGzAbS1.js","../chunks/CJXkYEXo.js","../chunks/Ck5vB1rg.js","../chunks/DV-2e58y.js","../chunks/HTOW8iPe.js","../chunks/DFdJa-Hs.js","../chunks/DuIgqnlY.js","../chunks/CWUMMnSV.js","../chunks/DaQyK3nQ.js","../chunks/DBuKqDYo.js","../chunks/DQaHheF0.js","../chunks/DS9C8gJc.js","../chunks/fHzmurrr.js","../chunks/DqbAVxMv.js","../chunks/B_nYcLPE.js","../chunks/Cgb6qxNH.js","../chunks/Bc6r6iEs.js","../chunks/F0BUsLjt.js","../chunks/lHHrw-Fy.js","../chunks/B8u0uflR.js","../chunks/B1N-tmtC.js","../chunks/DfmE7muS.js","../chunks/CawG38_V.js","../chunks/D-qJO60r.js","../chunks/QQC62dOK.js","../chunks/B2f5VqqG.js","../chunks/DQOO6RKE.js","../chunks/Bi6C4OG6.js"])))=>i.map(i=>d[i]);
import{_ as Re}from"../chunks/PPVm8Dsz.js";import"../chunks/DsnmJJEf.js";import{o as it,a as Pt}from"../chunks/CsvHgo6E.js";import{f as C,p as Ne,c as g,n as Et,r as p,a as Fe,a8 as X,t as Y,F as e,X as K,l as Ke,aG as O,ax as Be,y as Ze,ar as s,b2 as ar,b3 as nr,aK as or}from"../chunks/C2G-U2Rp.js";import{f as sr,e as yt}from"../chunks/B7MCGzuW.js";import{c as D,a as o,f as h,t as Ge}from"../chunks/Bw9dopYk.js";import{l as ir,s as tt,p as _e,r as It,i as M}from"../chunks/BwRR2sz5.js";import{c as Q}from"../chunks/YPopVK-T.js";import{a as lr,f as Vt,b as ct,s as qe,d as wt}from"../chunks/P7z0ujPM.js";import{b as nt}from"../chunks/Ck-qfSU1.js";import{s as ae}from"../chunks/VHBl3xBG.js";import{s as Mt,e as et,i as cr}from"../chunks/DDY_L61N.js";import{e as dr,f as ur,g as dt,h as ut,i as ft}from"../chunks/BODOddys.js";import{c as vt}from"../chunks/DjSD7d6X.js";import{X as fr,A as vr,a as mr,b as pr,C as gr}from"../chunks/Da6FASpp.js";import"../chunks/69_IOA4Y.js";import{I as hr,s as _r,S as xt}from"../chunks/ByBLjScv.js";import{C as wr}from"../chunks/DHKFkDmX.js";import{S as ot,C as Lt}from"../chunks/BH_a3QLS.js";import{B as yr}from"../chunks/B-p-siuQ.js";import{I as xr}from"../chunks/Ctr-s97A.js";import{a as Cr,b as br}from"../chunks/Gfo-GZxB.js";import{S as Sr}from"../chunks/D0uXYRFJ.js";import{H as Pr}from"../chunks/CbSHxjnO.js";import{c as kt}from"../chunks/C8hn-AFl.js";import{S as Ct}from"../chunks/BbM6OCzS.js";import"../chunks/B17Q6ahh.js";import"../chunks/kwrskX6P.js";function $t(d){return(Cr||br)+d}function Ir(d,t){const m=ir(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const y=[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3"}]];hr(d,tt({name:"command"},()=>m,{get iconNode(){return y},children:(i,x)=>{var n=D(),A=C(n);_r(A,t,"default",{}),o(i,n)},$$slots:{default:!0}}))}var $r=h("<span><!></span>");function Or(d,t){Ne(t,!0);let m=_e(t,"ref",15,null),y=It(t,["$$slots","$$events","$$legacy","ref","class","children"]);var i=$r();lr(i,n=>({"data-slot":"command-shortcut",class:n,...y}),[()=>vt("text-muted-foreground ml-auto text-xs tracking-widest",t.class)]);var x=g(i);Mt(x,()=>t.children??Et),p(i),nt(i,n=>m(n),()=>m()),o(d,i),Fe()}function Rr(d,t){Ne(t,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let m=It(t,["$$slots","$$events","$$legacy"]);const y=[["path",{d:"m12 19-7-7 7-7"}],["path",{d:"M19 12H5"}]];xr(d,tt({name:"arrow-left"},()=>m,{get iconNode(){return y},children:(i,x)=>{var n=D(),A=C(n);Mt(A,()=>t.children??Et),o(i,n)},$$slots:{default:!0}})),Fe()}function Ar(d,t){d.stopPropagation(),t()?.()}var Er=h('<button type="button" class="pointer-events-none flex h-4 w-0 items-center justify-center rounded text-muted-foreground opacity-0 transition-[width,margin-left,opacity] group-hover:pointer-events-auto group-hover:ml-1 group-hover:w-4 group-hover:opacity-100"><!></button>'),Vr=h('<div><span class="truncate"> </span> <!></div>');function Dt(d,t){Ne(t,!0);let m=_e(t,"onClose",3,null);const y=t.title??t.value;var i=Vr(),x=g(i),n=g(x,!0);p(x);var A=X(x,2);{var S=L=>{var k=Er();k.__click=[Ar,m];var I=g(k);fr(I,{class:"size-3"}),p(k),Y(()=>qe(k,"aria-label",`Clear ${t.value}`)),o(L,k)};M(A,L=>{m()&&L(S)})}p(i),Y(L=>{ct(i,1,L),qe(i,"title",y),ae(n,t.value)},[()=>Vt(vt("group inline-flex max-w-[10rem] items-center overflow-hidden rounded border border-border px-1 py-0.5 text-xs font-medium text-muted-foreground transition-all",t.class))]),o(d,i),Fe()}sr(["click"]);var Mr=h('<!> <span aria-hidden="true" class="h-5 w-px bg-border"></span>',1),Lr=h('<div class="flex h-9 items-center gap-2 border-b pl-2" data-slot="command-input-wrapper"><span class="flex h-full min-w-[1.25rem] shrink-0 items-center justify-center text-muted-foreground"><!></span> <!> <!></div>');function kr(d,t){Ne(t,!0);let m=_e(t,"ref",15,null),y=_e(t,"value",15,""),i=_e(t,"iconProps",19,()=>({})),x=_e(t,"onCommandClose",3,null),n=It(t,["$$slots","$$events","$$legacy","ref","class","value","icon","iconProps","commandId","onCommandClose"]);var A=Lr(),S=g(A),L=g(S);{var k=_=>{const N=K(()=>t.icon);var $=D(),v=C($);Q(v,()=>e(N),(u,w)=>{w(u,tt(i))}),o(_,$)},I=_=>{Ir(_,{class:"size-4 opacity-50"})};M(L,_=>{t.icon?_(k):_(I,!1)})}p(S);var T=X(S,2);{var W=_=>{var N=Mr(),$=C(N);Dt($,{get value(){return t.commandId},get title(){return t.commandId},get onClose(){return x()}}),Ke(2),o(_,N)};M(T,_=>{t.commandId&&_(W)})}var b=X(T,2);{let _=K(()=>vt("flex h-10 flex-1 rounded-md bg-transparent py-3 text-sm outline-hidden placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t.class));Q(b,()=>dr,(N,$)=>{$(N,tt({"data-slot":"command-input",get class(){return e(_)}},()=>n,{get ref(){return m()},set ref(v){m(v)},get value(){return y()},set value(v){y(v)}}))})}p(A),o(d,A),Fe()}function Dr(d,t){Ne(t,!0);const m=_e(t,"disabled",3,!1);yr(d,{class:"m-0 flex size-7 shrink-0 items-center justify-center rounded-md border-none bg-transparent p-0 text-muted-foreground opacity-50 shadow-none transition hover:bg-transparent hover:text-accent-foreground focus:outline-none focus-visible:border-transparent focus-visible:ring-0 focus-visible:ring-offset-0 focus-visible:outline-none active:ring-0 active:outline-none disabled:pointer-events-none disabled:opacity-50 has-[>svg]:px-0",onclick:()=>{m()||t.onPress?.()},"aria-label":"Return to command search",get disabled(){return m()},children:(y,i)=>{{let x=K(()=>`size-4 ${t.class}`.trim());Rr(y,{get class(){return e(x)}})}},$$slots:{default:!0}}),Fe()}var Tr=h('<div class="flex flex-wrap gap-2 px-2 py-0.5"></div>'),Nr=h('<span class="text-xs text-muted-foreground"> </span>'),Fr=h('<div class="flex flex-col gap-0.5"><span class="text-sm leading-tight font-medium"> </span> <!></div> <!>',1),zr=h("<!> <!>",1),Br=h('<div class="px-4 pb-3"><!></div>'),Wr=h("<!> <!>",1),jr=h('<div class="px-4 pb-3"><!></div>'),Ur=h('<p class="text-sm text-muted-foreground">No panel registered for this command.</p>'),Kr=h('<div class="pr-2 pb-2 pl-2"><!></div>'),Gr=h("<!> <!> <!>",1),qr=h("<!> <!>",1),Hr=h("<!> <!>",1),Qr=h("<div><!></div>");function Xr(d,t){Ne(t,!0);let m=_e(t,"ref",15,null),y=_e(t,"commands",19,()=>[]),i=_e(t,"placeholder",3,"Search commands..."),x=_e(t,"emptyMessage",3,"No commands found."),n=O(null),A=O(null),S=O(null),L=O(null),k=O(null),I=O(null),T=O(Be([])),W=O(""),b=O(!1),_=O(Be(i())),N=O(null),$=!1,v=O(null),u=!1,w=null,B=null,j=0,E=null;const ne=K(()=>{const a=new Map;for(const l of y())a.set(l.id,l);return Array.from(a.values())}),we=K(()=>{const a=new Map;for(const l of e(ne)){const r=l.group??null,G=a.get(r);G?G.push(l):a.set(r,[l])}return a});it(()=>{je()});function oe(a,l=!1){l&&($=!0),s(W,a,!0)}function Ce(a=null,l){if(!E||a&&E!==a)return;s(N,null),E.placeholderOverridden&&s(_,i()),(l?.forceReset??(l?.skipReset?!1:E.resetValueOnDetach))&&(oe("",!0),E.onInput("")),E.onDetach?.(),E=null}function c(){Ce(null,{forceReset:!0}),s(N,null),s(_,i()),$=!1}Ze(()=>{const a=e(N);if(a){if($){$=!1;return}a(e(W))}}),Ze(()=>{e(n)||s(_,i())});function f(){if(B)try{B()}catch(a){console.error("Failed to dispose command session",a)}B=null,s(S,null),s(L,null),c(),s(A,null)}function P(){e(n)&&(f(),s(n,null),s(I,null),s(k,null),oe("",!0),s(b,!0))}function F(a){try{t.commandSearchContext.get(a.classType).clear()}catch(l){console.error("Failed to clear global variable",l)}finally{je()}}function J(){e(v)?.blur()}function z(a,l){if(!a.component)return null;const r=a.props;return r?{component:a.component,props:()=>r(l)}:{component:a.component}}function Z(a,l){const r=a.createSession?.(l);if(r){B=r.dispose??null,Object.prototype.hasOwnProperty.call(r,"input")?s(S,r.input??null,!0):s(S,null),Object.prototype.hasOwnProperty.call(r,"content")?s(L,r.content??null,!0):s(L,z(a,l),!0);return}B=null,s(S,null),s(L,z(a,l),!0)}function U(a){const l=a.id;return{getContext:()=>t.commandSearchContext,deactivate:()=>{!e(n)||e(n).id!==l||(P(),je())},isActive:r=>!e(n)||e(n).id!==l?!1:r?e(n).id===r:!0,setIsOpen:(r,G)=>{if(!e(n)||e(n).id!==l)return;if(r){u=!1,s(b,!0);return}const ee=G?.preserveActive??!0;We(ee)},setInputSurface:r=>{!e(n)||e(n).id!==l||s(S,r,!0)},setContentSurface:r=>{!e(n)||e(n).id!==l||s(L,r,!0)},getInputValue:()=>e(W),setInputValue:r=>{!e(n)||e(n).id!==l||oe(r,!0)},setInputHandler:r=>{if(!(!e(n)||e(n).id!==l)){if(Ce(null,{skipReset:!0}),s(N,r,!0),!r){$=!1;return}r(e(W))}},setPlaceholder:r=>{!e(n)||e(n).id!==l||s(_,r,!0)},resetPlaceholder:()=>{!e(n)||e(n).id!==l||s(_,i())},attachInputBinding:r=>{if(!e(n)||e(n).id!==l)return()=>{};Ce(null,{skipReset:!0});const G=r.placeholder??e(n).inputPlaceholder??i(),ee={id:++j,commandId:l,onInput:r.onInput,onDetach:r.onDetach,placeholderOverridden:!!G,resetValueOnDetach:r.resetValueOnDetach??!0};E=ee,ee.placeholderOverridden&&G&&s(_,G,!0),s(N,Ae=>{!E||E.id!==ee.id||r.onInput(Ae)});const q=r.resetValueOnAttach??!0,ge=r.replayInitialValue??!q;return q?(oe("",!0),r.onInput("")):ge&&r.onInput(e(W)),()=>{Ce(ee)}}}}function be(a){const l=e(A);if(!a)return l?{runtime:l}:{};if(!l)return{};const{props:r}=a;return r?{...typeof r=="function"?r(l):r,runtime:l}:{runtime:l}}function ce(a){return`${a.name} ${a.description??""}`.trim()}async function ie(a){if(e(n)?.id===a.id){P();return}f(),s(I,null),s(k,a.id,!0),s(b,!0),e(v)&&e(v).focus();const l=U(a);s(A,l,!0),s(n,a,!0),Z(a,l);try{await a.execute(l)}catch(r){s(I,r instanceof Error?r:new Error("Failed to execute the command."),!0)}finally{s(k,null),oe("",!0),je()}}function He(a){const l=a.key.toLowerCase();if((a.metaKey||a.ctrlKey)&&l==="p"){if(a.preventDefault(),e(n)){P();return}e(v)&&e(v).focus();return}if(l==="escape"){if(e(n)){a.preventDefault(),P(),J();return}e(b)&&(a.preventDefault(),s(b,!1),J());return}if(!e(n))for(const G of e(ne)){if(!G.shortcut)continue;const ee=G.shortcut.join(" ").toLowerCase(),q=[];if(a.metaKey&&q.push("âŒ˜"),a.ctrlKey&&q.push("Ctrl"),a.altKey&&q.push("Alt"),a.shiftKey&&q.push("Shift"),q.push(a.key.length===1?a.key.toUpperCase():a.key),q.join(" ").toLowerCase()===ee.toLowerCase()){a.preventDefault(),ie(G);break}}}function Qe(){s(b,!0)}function We(a=!1){u=a,s(b,!1)}function rt(a){const l=w;if(!l)return;const r=a.target;r&&l.contains(r)||e(b)&&We(!!e(n))}Ze(()=>{if(!e(b)){if(oe("",!0),!e(n)){u=!1;return}if(u){u=!1;return}f(),s(n,null),s(I,null)}});function je(){if(!t.commandSearchContext){s(T,[],!0);return}const a=t.commandSearchContext.getGlobalVariables(),l=[];for(const r of a){const G=r.getId();G&&l.push({displayName:r.displayName,id:G,classType:r.constructor})}s(T,l,!0)}var pe=Qr();yt("keydown",ar,He),yt("pointerdown",nr,rt);var Ie=g(pe);Q(Ie,()=>ur,(a,l)=>{l(a,{children:(r,G)=>{var ee=Hr(),q=C(ee);{let Se=K(()=>e(n)?e(n).inputPlaceholder??e(_):e(_)),Xe=K(()=>e(n)?Dr:void 0),Ee=K(()=>e(n)?{onPress:P,disabled:e(k)===e(n).id}:void 0),Ue=K(()=>e(n)?.id),ye=K(()=>e(n)?P:null);kr(q,{get placeholder(){return e(Se)},onfocus:()=>Qe(),get icon(){return e(Xe)},get iconProps(){return e(Ee)},get commandId(){return e(Ue)},get onCommandClose(){return e(ye)},get value(){return e(W)},set value(de){s(W,de,!0)},get ref(){return e(v)},set ref(de){s(v,de,!0)}})}var ge=X(q,2);{var Ae=Se=>{var Xe=qr(),Ee=C(Xe);{var Ue=te=>{var se=Tr();et(se,21,()=>e(T),ue=>ue.id,(ue,fe)=>{{let $e=K(()=>`${e(fe).displayName}: ${e(fe).id}`),Me=K(()=>`${e(fe).displayName}: ${e(fe).id}`);Dt(ue,{get value(){return e($e)},get title(){return e(Me)},onClose:()=>F(e(fe))})}}),p(se),o(te,se)};M(Ee,te=>{e(T).length&&te(Ue)})}var ye=X(Ee,2);{var de=te=>{xt(te,{children:(se,ue)=>{var fe=D(),$e=C(fe);Q($e,()=>dt,(Me,at)=>{at(Me,{children:(he,ze)=>{var ve=zr(),Le=C(ve);Q(Le,()=>ut,(Oe,me)=>{me(Oe,{children:(xe,V)=>{Ke();var R=Ge();Y(()=>ae(R,x())),o(xe,R)},$$slots:{default:!0}})});var ke=X(Le,2);et(ke,17,()=>Array.from(e(we).entries()),cr,(Oe,me)=>{var xe=K(()=>or(e(me),2));let V=()=>e(xe)[1];var R=D(),H=C(R);et(H,17,V,le=>le.id,(le,re)=>{var Pe=D(),De=C(Pe);{let Bt=K(()=>ce(e(re)));Q(De,()=>ft,(Wt,jt)=>{jt(Wt,{get value(){return e(Bt)},onclick:()=>ie(e(re)),children:(Ut,Ia)=>{var Ot=Fr(),pt=C(Ot),gt=g(pt),Kt=g(gt,!0);p(gt);var Gt=X(gt,2);{var qt=Te=>{var Je=Nr(),ht=g(Je,!0);p(Je),Y(()=>ae(ht,e(re).description)),o(Te,Je)};M(Gt,Te=>{e(re).description&&Te(qt)})}p(pt);var Ht=X(pt,2);{var Qt=Te=>{ot(Te,{class:"ml-auto size-4 text-muted-foreground"})},Xt=Te=>{var Je=D(),ht=C(Je);{var Yt=_t=>{var Rt=D(),Jt=C(Rt);Q(Jt,()=>Or,(Zt,er)=>{er(Zt,{children:(tr,$a)=>{Ke();var At=Ge();Y(rr=>ae(At,rr),[()=>e(re).shortcut?.join(" + ")]),o(tr,At)},$$slots:{default:!0}})}),o(_t,Rt)};M(ht,_t=>{e(re).shortcut?.length&&_t(Yt)},!0)}o(Te,Je)};M(Ht,Te=>{e(k)===e(re).id?Te(Qt):Te(Xt,!1)})}Y(()=>ae(Kt,e(re).name)),o(Ut,Ot)},$$slots:{default:!0}})})}o(le,Pe)}),o(Oe,R)}),o(he,ve)},$$slots:{default:!0}})}),o(se,fe)},$$slots:{default:!0}})},Ve=te=>{var se=Gr(),ue=C(se);{var fe=he=>{const ze=K(()=>e(S).component);var ve=Br(),Le=g(ve);{let ke=K(()=>be(e(S)));Q(Le,()=>e(ze),(Oe,me)=>{me(Oe,tt(()=>e(ke)))})}p(ve),o(he,ve)};M(ue,he=>{e(S)&&he(fe)})}var $e=X(ue,2);{var Me=he=>{var ze=jr(),ve=g(ze);Q(ve,()=>vr,(Le,ke)=>{ke(Le,{variant:"destructive",children:(Oe,me)=>{var xe=Wr(),V=C(xe);Q(V,()=>mr,(H,le)=>{le(H,{children:(re,Pe)=>{Ke();var De=Ge();Y(()=>ae(De,`${e(n).name??""} failed`)),o(re,De)},$$slots:{default:!0}})});var R=X(V,2);Q(R,()=>pr,(H,le)=>{le(H,{children:(re,Pe)=>{Ke();var De=Ge();Y(()=>ae(De,e(I).message)),o(re,De)},$$slots:{default:!0}})}),o(Oe,xe)},$$slots:{default:!0}})}),p(ze),o(he,ze)};M($e,he=>{e(I)&&he(Me)})}var at=X($e,2);xt(at,{children:(he,ze)=>{var ve=Kr(),Le=g(ve);{var ke=me=>{const xe=K(()=>e(L).component);var V=D(),R=C(V);{let H=K(()=>be(e(L)));Q(R,()=>e(xe),(le,re)=>{re(le,tt(()=>e(H)))})}o(me,V)},Oe=me=>{var xe=D(),V=C(xe);Q(V,()=>wr,(R,H)=>{H(R,{class:"px-0",children:(le,re)=>{var Pe=Ur();o(le,Pe)},$$slots:{default:!0}})}),o(me,xe)};M(Le,me=>{e(L)?me(ke):me(Oe,!1)})}p(ve),o(he,ve)},$$slots:{default:!0}}),o(te,se)};M(ye,te=>{e(n)?te(Ve,!1):te(de)})}o(Se,Xe)};M(ge,Se=>{e(b)&&Se(Ae)})}o(r,ee)},$$slots:{default:!0}})}),p(pe),nt(pe,a=>w=a,()=>w),nt(pe,a=>m(a),()=>m()),Y(a=>ct(pe,1,a),[()=>Vt(vt("space-y-4",t.class))]),o(d,pe),Fe()}class Tt{colour=null;id=null;getId(){return this.id}setId(t){this.id=t}clear(){this.setId(null)}}class Yr{services=new Map;globalVariables=new Map;add(t,m){this.services.set(t,m),m instanceof Tt&&this.globalVariables.set(t,m)}get(t){const m=this.services.get(t);if(!m)throw new Error(`Service not found for token: ${t.name}`);return m}has(t){return this.services.has(t)}getGlobalVariables(){return Array.from(this.globalVariables.values())}}class bt{#e=[];constructor(t){this.#e=t}get organisations(){return this.#e}}class Ye extends Tt{displayName="org";organisations;constructor(t){super(),this.organisations=new Map(t.map(m=>[m.id,m])),t.length>0&&this.setId(t[0].id)}setActiveOrganisation(t){this.setId(t)}getActiveOrganisationId(){return this.id}getActiveOrganisationPortalUrl(){const t=this.organisations.get(this.getActiveOrganisationIdInternal());if(!t)throw new Error("No organisation is currently selected.");return t.portalUrl}getActiveOrganisationEndpoint(){const t=this.organisations.get(this.getActiveOrganisationIdInternal());if(!t)throw new Error("No organisation is currently selected.");return t.endpoint}getActiveOrganisationQueryParams(){const t=this.organisations.get(this.getActiveOrganisationIdInternal());if(!t)throw new Error("No organisation is currently selected.");return t.queryParams||{}}getActiveOrganisationIdInternal(){if(!this.id)throw new Error("No organisation is currently selected.");return this.id}}class st{_mapView;constructor(t){this._mapView=t}get mapView(){return this._mapView}}const St=new Map;function Jr(d,t){St.has(d)&&console.warn(`[registerCommand] Command "${d}" already registered, overriding.`),St.set(d,t)}function lt(d){return St.get(d)}function mt(d,t){return Jr(d,t),t}class Nt{#e=O(null);#t=O(!1);#r=O(null);load=async(t,m)=>{s(this.#t,!0),s(this.#r,null);try{const y=await Pr(t,{...m,responseType:"json"});console.log("Esri Request Response:",y,y.data.url),s(this.#e,y.data,!0)}catch(y){s(this.#r,y,!0)}finally{s(this.#t,!1)}};get data(){return e(this.#e)}get isLoading(){return e(this.#t)}get error(){return e(this.#r)}}var Zr=h('<div class="error-message svelte-11six79"><p class="text-sm text-red-600 svelte-11six79"> </p></div>'),ea=h('<div class="flex items-center justify-center p-4"><!></div>'),ta=h('<div class="flex items-center gap-2"><!> <span class="title-text w-full font-medium text-foreground svelte-11six79"> </span></div>'),ra=h('<span class="description-text text-xs text-gray-500 svelte-11six79"> </span>'),aa=h('<div class="error-message svelte-11six79"><!> <p class="text-sm text-red-600 svelte-11six79"> </p></div>'),na=h('<div class="flex w-full min-w-0 flex-col gap-0.5"><span class="title-text font-medium text-foreground svelte-11six79"> </span> <!> <!></div>'),oa=h('<div class="item-container svelte-11six79"><!></div>');function sa(d,t){Ne(t,!0);const m=_e(t,"runtime",3,null),y=new Nt;let i=O(null),x=O(null),n=Be(new Ct),A=O(""),S=O(Be([]));const L=K(()=>{const v=e(S);console.log("Filtering web maps with data:",v);const u=e(A).trim().toLowerCase();return u?v.filter(w=>{const B=w?.title?.toLowerCase()??"",j=w?.description?.toLowerCase()??"";return B.includes(u)||j.includes(u)}):v});it(async()=>{s(i,t.commandSearchContext.get(st).mapView,!0);const u=t.commandSearchContext.get(Ye).getActiveOrganisationId();if(!u){console.warn("No active organisation selected in OrganisationCommandService");return}try{const w=await fetch($t(`/api/maps/${u}.json`));if(!w.ok)throw new Error(`Failed to fetch maps: ${w.status} ${w.statusText}`);const B=await w.json();s(S,(B.results??[]).filter(j=>j.type.toLowerCase()==="web map").map(j=>({id:j.id,title:j.title,description:kt(j.description),owner:j.owner,tags:j.tags})),!0)}catch(w){console.error("Error fetching web maps:",w)}});let k=null,I=null,T=t.inputPlaceholder??"Search...";Ze(()=>{const v=m(),u=t.inputPlaceholder??"Search...";if(!v){k?.(),k=null,I=null,T=u,s(A,"");return}if(v===I){u!==T&&(v.setPlaceholder(u),T=u);return}k?.(),k=null,T=u,k=v.attachInputBinding({placeholder:u,onInput:w=>{s(A,w,!0)}}),I=v}),Pt(()=>{k?.(),k=null,I=null});async function W(v){if(!e(i)){console.error("MapView is not initialized"),n.set(v,new Error("MapView is not ready. Please wait and try again."));return}s(x,v,!0),n.delete(v);try{console.log(`Loading web map with ID: ${v}`);const u=t.commandSearchContext.get(Ye);if(!u.getActiveOrganisationId()){console.warn("No active organisation selected in OrganisationCommandService");return}const B=u.getActiveOrganisationPortalUrl(),{default:j}=await Re(async()=>{const{default:oe}=await import("../chunks/CVaFVXl_.js").then(Ce=>Ce.W);return{default:oe}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156]),import.meta.url),E=new j({portalItem:{id:v,portal:{url:B}}});await E.load(),console.log("Web map loaded successfully"),console.log("Applying web map to MapView",e(i).ui),e(i).map=E,console.log("Web map applied to MapView"),await(await Re(()=>import("../chunks/CYlsogSb.js").then(oe=>oe.m),__vite__mapDeps([10,1,2,3,11]),import.meta.url)).whenOnce(()=>e(i).ready),console.log("MapView updated with new web map");const we=E.initialViewProperties?.viewpoint?.targetGeometry;we&&(console.log("Navigating to web map initial viewpoint"),await e(i).goTo(we),console.log("MapView navigated to web map initial viewpoint")),m()?.setIsOpen(!1)}catch(u){console.error("Error loading web map:",u),n.set(v,u),s(x,null)}finally{s(x,null)}}var b=oa(),_=g(b);{var N=v=>{var u=Zr(),w=g(u),B=g(w);p(w),p(u),Y(()=>ae(B,`${y.error.message??""}. ${y.error?.details?.httpStatus===0?"Reason: CORS Error. See console for more information.":""}`)),o(v,u)},$=v=>{var u=D(),w=C(u);{var B=E=>{var ne=ea(),we=g(ne);ot(we,{class:"size-5"}),p(ne),o(E,ne)},j=E=>{var ne=D(),we=C(ne);Q(we,()=>dt,(oe,Ce)=>{Ce(oe,{children:(c,f)=>{var P=D(),F=C(P);{var J=Z=>{var U=D(),be=C(U);Q(be,()=>ut,(ce,ie)=>{ie(ce,{children:(He,Qe)=>{Ke();var We=Ge("No web maps match your search.");o(He,We)},$$slots:{default:!0}})}),o(Z,U)},z=Z=>{var U=D(),be=C(U);et(be,17,()=>e(L),ce=>ce.id,(ce,ie)=>{var He=D(),Qe=C(He);Q(Qe,()=>ft,(We,rt)=>{rt(We,{onclick:()=>W(e(ie).id),children:(je,pe)=>{const Ie=K(()=>n.get(e(ie).id));var a=D(),l=C(a);{var r=ee=>{var q=ta(),ge=g(q);ot(ge,{class:"size-4"});var Ae=X(ge,2),Se=g(Ae);p(Ae),p(q),Y(()=>ae(Se,`Loading ${e(ie).title??"Untitled web map"??""}...`)),o(ee,q)},G=ee=>{var q=na(),ge=g(q),Ae=g(ge,!0);p(ge);var Se=X(ge,2);{var Xe=ye=>{var de=ra(),Ve=g(de,!0);p(de),Y(()=>{qe(de,"title",e(ie).description),ae(Ve,e(ie).description)}),o(ye,de)};M(Se,ye=>{e(ie).description&&ye(Xe)})}var Ee=X(Se,2);{var Ue=ye=>{const de=K(()=>`${e(Ie).message}. ${e(Ie).details?.error?.details?.httpStatus===0?"Reason: CORS Error. See console for more information.":""}`);var Ve=aa(),te=g(Ve);Lt(te,{class:"error-icon",size:16});var se=X(te,2),ue=g(se,!0);p(se),p(Ve),Y(()=>{qe(Ve,"title",e(de)),ae(ue,e(de))}),o(ye,Ve)};M(Ee,ye=>{e(Ie)&&ye(Ue)})}p(q),Y(()=>{qe(ge,"title",e(ie).title),ae(Ae,e(ie).title??"Untitled web map")}),o(ee,q)};M(l,ee=>{e(x)===e(ie).id?ee(r):ee(G,!1)})}o(je,a)},$$slots:{default:!0}})}),o(ce,He)}),o(Z,U)};M(F,Z=>{e(L).length===0?Z(J):Z(z,!1)})}o(c,P)},$$slots:{default:!0}})}),o(E,ne)};M(w,E=>{y.isLoading?E(B):E(j,!1)},!0)}o(v,u)};M(_,v=>{y.error?v(N):v($,!1)})}p(b),o(d,b),Fe()}const Ft={id:"add-web-map",name:"Add web map",description:"Fetch and display web maps.",group:"Maps",shortcut:["Ctrl","M"],inputPlaceholder:"Search web maps...",execute:async()=>{},component:sa,props:d=>({commandSearchContext:d.getContext(),inputPlaceholder:Ft.inputPlaceholder})};mt("add-web-map",Ft);globalThis.process?.versions?.webcontainer;Re(()=>import("../chunks/BIHI7g3E.js"),[],import.meta.url).then(d=>new d.AsyncLocalStorage).catch(()=>{});var ia=h('<div class="error-message svelte-1lap2l5"><p class="text-sm text-red-600 svelte-1lap2l5"> </p></div>'),la=h('<div class="flex items-center justify-center p-4"><!></div>'),ca=h('<div class="flex items-center gap-2"><!> <span class="title-text w-full font-medium text-foreground svelte-1lap2l5"> </span></div>'),da=h('<div class="flex items-center gap-2"><!></div>'),ua=h('<span class="description-text text-xs text-gray-500 svelte-1lap2l5"> </span>'),fa=h('<span class="text-[11px] text-muted-foreground"> </span>'),va=h('<span class="text-[11px] text-muted-foreground"> <!></span>'),ma=h('<div class="error-message svelte-1lap2l5"><!> <p class="text-sm text-red-600 svelte-1lap2l5"> </p></div>'),pa=h('<!> <div class="flex w-full min-w-0 flex-col gap-0.5"><span class="title-text font-medium text-foreground svelte-1lap2l5"> </span> <!> <!> <!> <!></div>',1),ga=h('<div class="item-container svelte-1lap2l5"><!></div>');function ha(d,t){Ne(t,!0);const m=_e(t,"runtime",3,null),y=new Nt;let i=O(null),x=O(null),n=Be(new Ct),A=O(""),S=O(Be(new Ct)),L=O(Be([]));const k=new Map,I={27700:"OS_Open_Background"},T=K(()=>{const c=e(L),f=e(A).trim().toLowerCase();return f?c.filter(P=>{const F=P?.title?.toLowerCase()??"",J=P?.description?.toLowerCase()??"";return F.includes(f)||J.includes(f)}):c});it(async()=>{s(i,t.commandSearchContext.get(st).mapView,!0);const c=t.commandSearchContext.get(Ye),f=c.getActiveOrganisationId();if(!f){console.warn("No active organisation selected in OrganisationCommandService");return}c.getActiveOrganisationPortalUrl(),c.getActiveOrganisationEndpoint();const P=["Feature Layer","Feature Service","Map Service","Image Service"],F=await fetch($t(`/api/maps/${f}.json`));if(!F.ok)throw new Error(`Failed to fetch maps: ${F.status} ${F.statusText}`);const J=await F.json();s(L,(J.results??[]).filter(z=>P.includes(z.type)).map(z=>({id:z.id,title:z.title,description:kt(z.description),owner:z.owner,tags:z.tags})),!0),k.clear();for(const z of e(L))k.set(z.id,z)});let W=null,b=null,_=t.inputPlaceholder??"Search...";Ze(()=>{const c=m(),f=t.inputPlaceholder??"Search...";if(!c){W?.(),W=null,b=null,_=f,s(A,"");return}if(c===b){f!==_&&(c.setPlaceholder(f),_=f);return}W?.(),W=null,_=f,W=c.attachInputBinding({placeholder:f,onInput:P=>{s(A,P,!0)}}),b=c}),Pt(()=>{W?.(),W=null,b=null});async function N(c){e(S).has(c)?$(c):await v(c)}function $(c){const f=e(S).get(c);!f||!e(i)||!e(i).map||(e(i).map.remove(f),e(S).delete(c),s(S,e(S),!0),console.log(`Layer removed from the map: ${c}`))}async function v(c){if(!e(i)||!e(i).map){console.error("Map or MapView is not initialized"),n.set(c,new Error("Map is not ready. Please wait and try again."));return}s(x,c,!0),n.delete(c);try{console.log(`Loading layer with portal item ID: ${c}`);const f=t.commandSearchContext.get(Ye);if(!f.getActiveOrganisationId()){console.warn("No active organisation selected in OrganisationCommandService");return}const F=f.getActiveOrganisationPortalUrl(),[{default:J},{default:z}]=await Promise.all([Re(()=>import("../chunks/CXxgNwmb.js").then(ce=>ce.L),__vite__mapDeps([16,1,2,3,10,11,4,5,6,9,12]),import.meta.url),Re(()=>import("../chunks/BvZUr92_.js").then(ce=>ce.P),__vite__mapDeps([17,4,1,2,3,5,6,11]),import.meta.url)]),Z=new z({url:F}),U=await J.fromPortalItem({portalItem:{id:c,portal:Z}});await U.load();const be=await u(U,c);await E(be),e(i).map.add(U),e(S).set(c,U),s(S,e(S),!0),console.log("Layer added to the map");try{await e(i).whenLayerView(U),U.fullExtent&&await e(i).goTo(U.fullExtent)}catch(ce){console.warn("Layer view not ready for navigation",ce)}}catch(f){console.error("Error loading layer:",f),n.set(c,f),s(x,null)}finally{s(x,null)}}async function u(c,f){const P=w(c);if(P)return P;const F=k.get(f);if(F?.spatialReferenceWkid){const{default:z}=await Re(async()=>{const{default:Z}=await import("../chunks/CbSHxjnO.js").then(U=>U.bd);return{default:Z}},__vite__mapDeps([5,1,2,3,4,6]),import.meta.url);return new z({wkid:F.spatialReferenceWkid})}const J=c.portalItem?.spatialReference;return J||null}function w(c){return c?.spatialReference??null}function B(c){if(!c)return;const f=c;return c.wkid??f?.latestWkid??void 0}async function j(c){if(!e(i)||!e(i).map)return console.warn("MapView or Map is not available for basemap loading"),null;if(!c)return e(i).map.basemap;const f=I[c];if(!f)return e(i).map.basemap;const{default:P}=await Re(async()=>{const{default:F}=await import("../chunks/CxlgmuS0.js").then(J=>J.B);return{default:F}},__vite__mapDeps([8,4,1,2,3,5,6,9,10,11,12,13,14,15,16,17,18,19,20,21]),import.meta.url);try{return await P.fromId(f)}catch(F){return console.warn(`Failed to load basemap ${f}`,F),e(i).map.basemap}}async function E(c){if(!e(i)||!e(i).map||!c){console.log("MapView or target spatial reference is not available","mapView:",e(i),"target:",c);return}const f=B(c),P=B(e(i).spatialReference??void 0);if(console.log(`Ensuring map view spatial reference compatibility: target WKID=${f}, current WKID=${P}`),!f||f===P)return;const[{default:F}]=await Promise.all([Re(()=>import("../chunks/tWIlYmLc.js").then(be=>be.M),__vite__mapDeps([7,1,2,3,8,4,5,6,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40]),import.meta.url)]),J=await j(f),z=e(i).map.layers.toArray(),Z=e(i).map.ground;e(i).map.removeAll();const U=new F({basemap:J??void 0,ground:Z});U.spatialReference=c,U.layers.addMany(z),e(i).map=U,await e(i).when()}var ne=ga(),we=g(ne);{var oe=c=>{var f=ia(),P=g(f),F=g(P);p(P),p(f),Y(()=>ae(F,`${y.error.message??""}. ${y.error?.details?.httpStatus===0?"Reason: CORS Error. See console for more information.":""}`)),o(c,f)},Ce=c=>{var f=D(),P=C(f);{var F=z=>{var Z=la(),U=g(Z);ot(U,{class:"size-5"}),p(Z),o(z,Z)},J=z=>{var Z=D(),U=C(Z);Q(U,()=>dt,(be,ce)=>{ce(be,{children:(ie,He)=>{var Qe=D(),We=C(Qe);{var rt=pe=>{var Ie=D(),a=C(Ie);Q(a,()=>ut,(l,r)=>{r(l,{children:(G,ee)=>{Ke();var q=Ge("No layers match your search.");o(G,q)},$$slots:{default:!0}})}),o(pe,Ie)},je=pe=>{var Ie=D(),a=C(Ie);et(a,17,()=>e(T),l=>l.id,(l,r)=>{var G=D(),ee=C(G);{let q=K(()=>e(S).has(e(r).id)?"layer-selected":"");Q(ee,()=>ft,(ge,Ae)=>{Ae(ge,{onclick:()=>N(e(r).id),get class(){return e(q)},children:(Se,Xe)=>{const Ee=K(()=>n.get(e(r).id));var Ue=D(),ye=C(Ue);{var de=te=>{var se=ca(),ue=g(se);ot(ue,{class:"size-4"});var fe=X(ue,2),$e=g(fe);p(fe),p(se),Y(()=>ae($e,`Loading ${e(r).title??"Untitled layer"??""}...`)),o(te,se)},Ve=te=>{var se=pa(),ue=C(se);{var fe=V=>{var R=da(),H=g(R);gr(H,{}),p(R),o(V,R)};M(ue,V=>{e(S).has(e(r).id)&&V(fe)})}var $e=X(ue,2),Me=g($e),at=g(Me,!0);p(Me);var he=X(Me,2);{var ze=V=>{var R=ua(),H=g(R,!0);p(R),Y(()=>{qe(R,"title",e(r).description),ae(H,e(r).description)}),o(V,R)};M(he,V=>{e(r).description&&V(ze)})}var ve=X(he,2);{var Le=V=>{var R=fa(),H=g(R,!0);p(R),Y(()=>ae(H,e(r).type??"")),o(V,R)};M(ve,V=>{e(r).type&&V(Le)})}var ke=X(ve,2);{var Oe=V=>{var R=va(),H=g(R),le=X(H);{var re=Pe=>{var De=Ge();De.nodeValue=" (auto aligns view)",o(Pe,De)};M(le,Pe=>{I[e(r).spatialReferenceWkid]&&Pe(re)})}p(R),Y(()=>ae(H,`WKID ${e(r).spatialReferenceWkid??""} `)),o(V,R)};M(ke,V=>{e(r).spatialReferenceWkid&&V(Oe)})}var me=X(ke,2);{var xe=V=>{const R=K(()=>`${e(Ee).message}. ${e(Ee).details?.error?.details?.httpStatus===0?"Reason: CORS Error. See console for more information.":""}`);var H=ma(),le=g(H);Lt(le,{size:16});var re=X(le,2),Pe=g(re,!0);p(re),p(H),Y(()=>{qe(H,"title",e(R)),ae(Pe,e(R))}),o(V,H)};M(me,V=>{e(Ee)&&V(xe)})}p($e),Y(()=>{qe(Me,"title",e(r).title),ae(at,e(r).title??"Untitled layer")}),o(te,se)};M(ye,te=>{e(x)===e(r).id?te(de):te(Ve,!1)})}o(Se,Ue)},$$slots:{default:!0}})})}o(l,G)}),o(pe,Ie)};M(We,pe=>{e(T).length===0?pe(rt):pe(je,!1)})}o(ie,Qe)},$$slots:{default:!0}})}),o(z,Z)};M(P,z=>{y.isLoading?z(F):z(J,!1)},!0)}o(c,f)};M(we,c=>{y.error?c(oe):c(Ce,!1)})}p(ne),o(d,ne),Fe()}const zt={id:"add-layer",name:"Add layers",description:"Fetch and display layers.",group:"Maps",shortcut:["Ctrl","L"],execute:async()=>{},component:ha,props:d=>({commandSearchContext:d.getContext(),inputPlaceholder:zt.inputPlaceholder})};mt("add-layer",zt);var _a=h('<div class="flex w-full min-w-0 flex-col gap-0.5"><span class="title-text font-medium text-foreground svelte-1w2u78y"> </span></div>'),wa=h('<div class="item-container svelte-1w2u78y"><!></div>');function ya(d,t){Ne(t,!0);const m=_e(t,"runtime",3,null);let y=O(Be([])),i=O("");it(async()=>{const I=t.commandSearchContext.get(bt)?.organisations;if(!I){console.warn("No organisation configuration found in MapsConfig");return}s(y,I,!0)});let x=null,n=null,A=t.inputPlaceholder??"Search...";Ze(()=>{const I=m(),T=t.inputPlaceholder??"Search...";if(!I){x?.(),x=null,n=null,A=T,s(i,"");return}if(I===n){T!==A&&(I.setPlaceholder(T),A=T);return}x?.(),x=null,A=T,x=I.attachInputBinding({placeholder:T,onInput:W=>{s(i,W,!0)}}),n=I}),Pt(()=>{x?.(),x=null,n=null});function S(I){t.commandSearchContext.get(Ye).setActiveOrganisation(I),m()&&m().deactivate()}var L=wa(),k=g(L);Q(k,()=>dt,(I,T)=>{T(I,{children:(W,b)=>{var _=D(),N=C(_);{var $=u=>{var w=D(),B=C(w);Q(B,()=>ut,(j,E)=>{E(j,{children:(ne,we)=>{Ke();var oe=Ge("No organisations match your search.");o(ne,oe)},$$slots:{default:!0}})}),o(u,w)},v=u=>{var w=D(),B=C(w);et(B,17,()=>e(y),j=>j.name,(j,E)=>{var ne=D(),we=C(ne);Q(we,()=>ft,(oe,Ce)=>{Ce(oe,{onclick:()=>S(e(E).id),children:(c,f)=>{var P=_a(),F=g(P),J=g(F,!0);p(F),p(P),Y(()=>ae(J,e(E).name??"Untitled organisation")),o(c,P)},$$slots:{default:!0}})}),o(j,ne)}),o(u,w)};M(N,u=>{e(y).length===0?u($):u(v,!1)})}o(W,_)},$$slots:{default:!0}})}),p(L),o(d,L),Fe()}const xa={id:"add-organisation",name:"Add organisation",description:"Find and add an organisation to filter items by.",group:"Maps",shortcut:["Ctrl","O"],inputPlaceholder:"Search organisations...",component:ya,execute:async()=>{},props:d=>({commandSearchContext:d.getContext(),inputPlaceholder:"Search organisations..."})};mt("add-organisation",xa);const Ca={id:"clear-map",name:"Clear map",description:"Clear all layers and reset the map view.",shortcut:["Ctrl","C"],execute:async d=>{const t=d.getContext().get(st).mapView;t&&t.map&&(t.map.layers.removeAll(),t.map.basemap="gray"),d.deactivate()}};mt("clear-map",Ca);var ba=h("<arcgis-layer-list></arcgis-layer-list>",2),Sa=h('<div id="search-slot" class="absolute top-3 left-1/2 z-10 -translate-x-1/2"><!></div>'),Pa=h("<arcgis-map><!></arcgis-map>",2);function rn(d,t){Ne(t,!0);const m=new Yr;let y=O(null),i=O(null),x=O(null),n=O(null),A=O(!1),S=O(Be([]));it(async()=>{const b=await L(),_=new Ye(b.organisations);m.add(bt,b),m.add(Ye,_),await I(),s(S,[lt("add-web-map"),lt("add-layer"),lt("add-organisation"),lt("clear-map")],!0)});async function L(){const b=await fetch($t("/config/maps/config.json"));if(!b.ok)throw new Error(`Failed to load maps config: ${b.status} ${b.statusText}`);const _=await b.json();return new bt(_.organisations)}async function k(){if(!e(x))return;s(y,e(x).view,!0),m.add(st,new st(e(y)));const b="#cfd3d4";e(x).background={color:b},e(n)&&(e(n).view=e(y),e(n).listItemCreatedFunction=_=>{const{item:N}=_;N.layer.type!="group"&&(N.panel={content:"legend",open:!0})})}async function I(){await Re(()=>import("../chunks/BmdmkRWj.js").then(b=>b.a),__vite__mapDeps([157,158,159,160,10,1,2,3,11,161,12,162,4,9,6,163,164,19,5,28,165,150,16,166,167,168,59,169,170]),import.meta.url),await Re(()=>import("../chunks/BAhz9MKi.js"),__vite__mapDeps([171,172,159,160,173,174,175,176,177,178,179,180,181,161,182,183,158,10,1,2,3,11,12,162,19,5,4,6,167,184,63,9,16,58,185,22,23,24,15,35,83,84,85,38,39,186,134,135,126,127,61,26,62,13,17,27,64,65,66,67,68,69,187,137,138,165,150,188,107,108,109,189,190,170,191,192,193,89,194,88,195,196,197,123,124,125,102,103,104,105,56,57,59,44,34,45,60,99,106,112,128,46,129,130,50,131,132,133,136,101,110,111,113,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225]),import.meta.url),await Re(()=>import("../chunks/Ck5vB1rg.js"),__vite__mapDeps([226,172,159,160,173,174,227,177,179,228,182,161,181,229,230,231,232,190,158,10,1,2,3,11,12,162,233,4,41,42,27,43,24,5,6,44,34,35,45,22,23,46,9,25,75,76,19,234,56,57,58,26,59,60,61,62,63,13,17,64,65,66,67,68,69,36,235,236,164,28,165,150,237,15,16,238,7,8,14,18,20,21,29,30,31,32,33,37,38,39,40,96,50,163,94,73,55,239,188,240,241,53,54,216,242,243,244,245,246,247,248,215,249,250,221,251,225,169,0,47,48,49,51,52,70,71,72,74,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,95,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,151,152,153,154,155,156]),import.meta.url)}var T=D(),W=C(T);{const b=N=>{xt(N,{class:"h-full",children:($,v)=>{var u=ba();ct(u,1,"mx-2 min-h-20"),nt(u,w=>s(n,w),()=>e(n)),o($,u)},$$slots:{default:!0}})},_=N=>{var $=Pa();ct($,1,"relative h-full w-full"),wt($,"basemap","gray"),wt($,"center","-2.231774828836059,53.46531847221502"),wt($,"zoom","15");var v=g($);{var u=w=>{var B=Sa(),j=g(B);Xr(j,{class:"w-full max-w-md",get commandSearchContext(){return m},get commands(){return e(S)},get ref(){return e(i)},set ref(E){s(i,E,!0)}}),p(B),o(w,B)};M(v,w=>{e(S).length>0&&w(u)})}p($),nt($,w=>s(x,w),()=>e(x)),yt("arcgisViewReadyChange",$,k),o(N,$)};Q(W,()=>Sr,(N,$)=>{$(N,{get isOpen(){return e(A)},onToggle:()=>s(A,!e(A)),sidebarContent:b,mainContent:_,$$slots:{sidebarContent:!0,mainContent:!0}})})}o(d,T),Fe()}export{rn as component};
