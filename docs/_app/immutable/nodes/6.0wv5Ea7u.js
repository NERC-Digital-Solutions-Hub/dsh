const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/huXfT4GN.js","../chunks/DtUpcSZL.js","../chunks/DHq0rblm.js","../chunks/BfhsIlKo.js","../chunks/D9Z9MdNV.js","../chunks/Bwh84WyQ.js","../chunks/BgvLO-3W.js","../chunks/Bo-Ws7j2.js","../chunks/qs4PuqLF.js","../chunks/BPWMfk3L.js","../chunks/B5FfC49X.js","../chunks/Cw1pwOU3.js","../chunks/Ab6_LQF8.js","../chunks/BzdAE8IO.js","../chunks/C1i-M2aP.js","../chunks/DpT7IovD.js","../chunks/DwaPv9Xz.js","../chunks/DxjcXvGa.js","../chunks/CU7c9CMG.js","../chunks/129gMYlb.js","../chunks/v8BQWUBe.js","../chunks/b9L_h0zx.js","../chunks/D6wORzA5.js","../chunks/D6KPPgz5.js","../chunks/BsbEhHPI.js","../chunks/1paoQEYR.js","../chunks/CbQpSWi7.js","../chunks/Cl5lrJ4c.js","../chunks/DS3I1QGm.js","../chunks/MtSiOt06.js","../chunks/C0wm8_Yw.js","../chunks/C4HJhmWz.js","../chunks/BL_xGwnO.js","../chunks/CJDxRR2q.js","../chunks/Djp3mnm5.js","../chunks/5FB5fp0p.js","../chunks/DQOJ18NT.js","../chunks/BXRubaki.js","../chunks/CO7wCLMN.js","../chunks/BcYzNU04.js","../chunks/EzLf78vY.js","../chunks/DJcANb4D.js","../chunks/CYIjw6v6.js","../chunks/BHJeQD3W.js","../chunks/CFcsbxo9.js","../chunks/9YvG7tFv.js","../chunks/0RWeYtrz.js","../chunks/D63lrzPI.js","../chunks/aQeO9QTD.js","../chunks/thXDNXE5.js","../chunks/C8mSainR.js","../chunks/BMX0GFJS.js","../chunks/DoXK2rGs.js","../chunks/Ctm-fIfE.js","../chunks/CL2NbQte.js","../chunks/CpiZ4wIO.js","../chunks/D2J_WLS8.js","../chunks/BASHandG.js","../chunks/8QcYoK8I.js","../chunks/Bm1xQlw6.js","../chunks/XNewhKeX.js","../chunks/B7w94aGg.js","../chunks/NPoLgU3x.js","../chunks/C5CzMsLd.js","../chunks/deFn64y_.js","../chunks/C1lBXX5P.js","../chunks/BAf2E7HJ.js","../chunks/Y387DGzA.js","../chunks/CFIXdoHM.js","../chunks/JBhdCoOi.js","../chunks/CQ7_HgKN.js","../chunks/CHZSYXvn.js","../chunks/BML_M8sQ.js","../chunks/Dnb1jllm.js","../chunks/DfNP466Y.js","../chunks/eWXUghTg.js","../chunks/BE7embxS.js","../chunks/B2pz97Mw.js","../chunks/iS9MPUWn.js","../chunks/GKolV7NZ.js","../chunks/B7so6aiN.js","../chunks/D_jxB2M9.js","../chunks/C70Wcz7U.js","../chunks/Cp7iBt0A.js","../chunks/f7qLKxBD.js","../chunks/4c7MyKAz.js","../chunks/DbuHlGOH.js","../chunks/5Hu3Tj1O.js","../chunks/BDRwM1Gy.js","../chunks/VMSlSy0z.js","../chunks/DzdGX2zJ.js","../chunks/BBxgwA0n.js","../chunks/lYnSLSOW.js","../chunks/C9yb1cMp.js","../chunks/BlVJDMPv.js","../chunks/DKdVR8l2.js","../chunks/DZ6eIUka.js","../chunks/n8j1sCwN.js","../chunks/L_yqRdqL.js","../chunks/BPsRHx0w.js","../chunks/CJzbRXVH.js","../chunks/DVkWVZrr.js","../chunks/Cbt3oAQ3.js","../chunks/C6-4EbnJ.js","../chunks/DdaJqb9x.js","../chunks/BQ9eRUBJ.js","../chunks/yMNjucUt.js","../chunks/DYWnz87V.js","../chunks/dDFQnWwh.js","../chunks/TngxyDh1.js","../chunks/6Dn7lewd.js","../chunks/DfJNYC5A.js","../chunks/zTkdiH1w.js","../chunks/KcazVFlU.js","../chunks/CYsUaMUi.js","../chunks/Bu2dLfoR.js","../chunks/uNqxL_S-.js","../chunks/BVskHUjz.js","../chunks/iUYx5jDy.js","../chunks/B5kADfHL.js","../chunks/CfrNlpsM.js","../chunks/DdSLmJ2d.js","../chunks/BS3H3l-F.js","../chunks/DCdj6Lab.js","../chunks/BXfupK_G.js","../chunks/BkQcsSCB.js","../chunks/DPb6J-GU.js","../chunks/Di4P92Bn.js","../chunks/ChlOomCl.js","../chunks/B8TggrAl.js","../chunks/BH-QLa3i.js","../chunks/Bt_bao6a.js","../chunks/CpOLeWL8.js","../chunks/Cy_9-Fvw.js","../chunks/CEiIohNf.js","../chunks/CNvMJFKk.js","../chunks/DqlQ8lc_.js","../chunks/CZQNMlVz.js","../chunks/uuiBM66S.js","../chunks/VStmm7cP.js","../chunks/BqnxlNxI.js","../chunks/BXAqi3_T.js","../chunks/D8UNv0pX.js","../chunks/DsHDw-MJ.js","../chunks/CISklr1W.js","../chunks/CWhDOlk9.js","../chunks/DZd6gJy7.js","../chunks/DxShpBdY.js","../chunks/C8BmVxiO.js","../chunks/NT2Bw9Xs.js","../chunks/NdScq7k1.js","../chunks/BNxyGXCQ.js","../chunks/DQ8jsygj.js","../chunks/Chk7YAAL.js","../chunks/D0t3l1UW.js","../chunks/Cgb6qxNH.js","../chunks/CQSPGXrE.js","../chunks/BHlmUX6D.js","../chunks/QQC62dOK.js","../chunks/DJa1hCZQ.js","../chunks/BM6Wwexr.js","../chunks/DKpmsPfl.js","../chunks/Sc2kLiW3.js","../chunks/B55yQsaB.js","../chunks/B1N-tmtC.js","../chunks/CASyCajO.js","../chunks/BiphejqT.js","../chunks/CWKudsnk.js","../chunks/pDuGEAnG.js","../chunks/CmGkajPk.js","../chunks/BrScpkSj.js","../chunks/rxpTDz6e.js"])))=>i.map(i=>d[i]);
import"../chunks/DsnmJJEf.js";import{o as qe,a as lr}from"../chunks/BTUtnK6b.js";import{O as dr,E as cr,be as ur,bf as fr,Y as hr,y as vr,bg as gr,bh as mr,bi as pr,a1 as Wt,as as yr,_ as br,a9 as ae,aH as z,J as r,ah as w,b5 as wr,p as Q,c as E,b as I,a as v,d as ee,f as N,a6 as S,a7 as _,aG as T,am as ie,u as ce,N as oe,a8 as M,G as _r,n as Ve,aI as Ge}from"../chunks/DehUWplH.js";import{p as X,i as U,r as Ae,l as Qe,s as xe,a as Sr,b as Cr}from"../chunks/TLwjHNuO.js";import{e as Ir,a as se,s as he}from"../chunks/BTpQzbbG.js";import{c as K}from"../chunks/B1MLz82n.js";import{a as ft,e as Oe,s as ut,d as Fe,b as xr}from"../chunks/CZEBf6kI.js";import{I as et,m as tt,d as Lt,c as qt,s as Tr,X as Lr,f as kr,g as Ar,h as Hr,i as Mr,j as zr,k as Nr,S as Fr,e as Pr,C as Or,l as Er}from"../chunks/Dn0Ja4xK.js";import{C as Vr,D as Dr,l as Rr,o as Gr,z as Br,b as ot,B as Ur,p as Me,c as jr}from"../chunks/B3jgurcF.js";import{t as Ee,k as Wr,l as qr,m as Yr,n as Zr,L as Xr,o as $r,S as Ke,p as Kr,h as Jr,i as Qr,C as Mt,j as ei,I as ti,G as zt,F as Nt,a as ri,O as Yt,T as ii,c as Zt,s as ni,M as ai,V as Ft,g as oi,d as si,e as li,f as di,u as ci,b as st,q as ui,r as fi}from"../chunks/CAP2RiZk.js";import{I as kt,a as ke,i as Ye}from"../chunks/B--_NR5U.js";import{g as Pt,d as ht}from"../chunks/CG5SEHFF.js";import{b as Ie}from"../chunks/BquELpeJ.js";import{c as vt,B as Ce}from"../chunks/CLqO5gQz.js";import{I as hi}from"../chunks/C6YRNg3b.js";import{h as Je}from"../chunks/DYCabrYF.js";import{_ as Pe}from"../chunks/D9Z9MdNV.js";import"../chunks/DajHuwdy.js";const vi=()=>performance.now(),He={tick:s=>requestAnimationFrame(s),now:()=>vi(),tasks:new Set};function Xt(){const s=He.now();He.tasks.forEach(e=>{e.c(s)||(He.tasks.delete(e),e.f())}),He.tasks.size!==0&&He.tick(Xt)}function gi(s){let e;return He.tasks.size===0&&He.tick(Xt),{promise:new Promise(t=>{He.tasks.add(e={c:s,f:t})}),abort(){He.tasks.delete(e)}}}function lt(s,e){Wt(()=>{s.dispatchEvent(new CustomEvent(e))})}function mi(s){if(s==="float")return"cssFloat";if(s==="offset")return"cssOffset";if(s.startsWith("--"))return s;const e=s.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function Ot(s){const e={},t=s.split(";");for(const i of t){const[n,a]=i.split(":");if(!n||a===void 0)break;const o=mi(n.trim());e[o]=a.trim()}return e}const pi=s=>s;function Et(s,e,t,i){var n=(s&mr)!==0,a=(s&pr)!==0,o=n&&a,f=(s&gr)!==0,g=o?"both":n?"in":"out",u,d=e.inert,p=e.style.overflow,m,c;function l(){return Wt(()=>u??=t()(e,i?.()??{},{direction:g}))}var h={is_global:f,in(){if(e.inert=d,!n){c?.abort(),c?.reset?.();return}a||m?.abort(),lt(e,"introstart"),m=St(e,l(),c,1,()=>{lt(e,"introend"),m?.abort(),m=u=void 0,e.style.overflow=p})},out(b){if(!a){b?.(),u=void 0;return}e.inert=!0,lt(e,"outrostart"),c=St(e,l(),m,0,()=>{lt(e,"outroend"),b?.()})},stop:()=>{m?.abort(),c?.abort()}},C=dr;if((C.transitions??=[]).push(h),n&&Ir){var x=f;if(!x){for(var k=C.parent;k&&(k.f&cr)!==0;)for(;(k=k.parent)&&(k.f&ur)===0;);x=!k||(k.f&fr)!==0}x&&hr(()=>{vr(()=>h.in())})}}function St(s,e,t,i,n){var a=i===1;if(yr(e)){var o,f=!1;return br(()=>{if(!f){var C=e({direction:a?"in":"out"});o=St(s,C,t,i,n)}}),{abort:()=>{f=!0,o?.abort()},deactivate:()=>o.deactivate(),reset:()=>o.reset(),t:()=>o.t()}}if(t?.deactivate(),!e?.duration)return n(),{abort:ae,deactivate:ae,reset:ae,t:()=>i};const{delay:g=0,css:u,tick:d,easing:p=pi}=e;var m=[];if(a&&t===void 0&&(d&&d(0,1),u)){var c=Ot(u(0,1));m.push(c,c)}var l=()=>1-i,h=s.animate(m,{duration:g,fill:"forwards"});return h.onfinish=()=>{h.cancel();var C=t?.t()??1-i;t?.abort();var x=i-C,k=e.duration*Math.abs(x),b=[];if(k>0){var y=!1;if(u)for(var F=Math.ceil(k/16.666666666666668),A=0;A<=F;A+=1){var W=C+x*p(A/F),R=Ot(u(W,1-W));b.push(R),y||=R.overflow==="hidden"}y&&(s.style.overflow="hidden"),l=()=>{var q=h.currentTime;return C+x*p(q/k)},d&&gi(()=>{if(h.playState!=="running")return!1;var q=l();return d(q,1-q),!0})}h=s.animate(b,{duration:k,fill:"forwards"}),h.onfinish=()=>{l=()=>i,d?.(i,1-i),n()}},{abort:()=>{h&&(h.cancel(),h.effect=null,h.onfinish=ae)},deactivate:()=>{n=ae},reset:()=>{i===0&&d?.(1,0)},t:()=>l()}}const yi=Gr({component:"avatar",parts:["root","image","fallback"]}),bi=new Vr("Avatar.Root");class At{static create(e){return bi.set(new At(e))}opts;domContext;attachment;constructor(e){this.opts=e,this.domContext=new Dr(this.opts.ref),this.loadImage=this.loadImage.bind(this),this.attachment=Rr(this.opts.ref)}loadImage(e,t,i){if(this.opts.loadingStatus.current==="loaded")return;let n;const a=new Image;return a.src=e,t!==void 0&&(a.crossOrigin=t),i&&(a.referrerPolicy=i),this.opts.loadingStatus.current="loading",a.onload=()=>{n=this.domContext.setTimeout(()=>{this.opts.loadingStatus.current="loaded"},this.opts.delayMs.current)},a.onerror=()=>{this.opts.loadingStatus.current="error"},()=>{n&&this.domContext.clearTimeout(n)}}#e=z(()=>({id:this.opts.id.current,[yi.root]:"","data-status":this.opts.loadingStatus.current,...this.attachment}));get props(){return r(this.#e)}set props(e){w(this.#e,e)}}var wi=N("<div><!></div>");function _i(s,e){const t=wr();Q(e,!0);let i=X(e,"delayMs",3,0),n=X(e,"loadingStatus",15,"loading"),a=X(e,"id",19,()=>Br(t)),o=X(e,"ref",15,null),f=Ae(e,["$$slots","$$events","$$legacy","delayMs","loadingStatus","onLoadingStatusChange","child","children","id","ref"]);const g=At.create({delayMs:ot(()=>i()),loadingStatus:ot(()=>n(),l=>{n()!==l&&(n(l),e.onLoadingStatusChange?.(l))}),id:ot(()=>a()),ref:ot(()=>o(),l=>o(l))}),u=z(()=>Ur(f,g.props));var d=E(),p=I(d);{var m=l=>{var h=E(),C=I(h);se(C,()=>e.child,()=>({props:r(u)})),v(l,h)},c=l=>{var h=wi();ft(h,()=>({...r(u)}));var C=S(h);se(C,()=>e.children??ae),_(h),v(l,h)};U(p,l=>{e.child?l(m):l(c,!1)})}v(s,d),ee()}function Si(s,e){const t=Qe(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const i=[["path",{d:"M12 8V4H8"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2"}],["path",{d:"M2 14h2"}],["path",{d:"M20 14h2"}],["path",{d:"M15 13v2"}],["path",{d:"M9 13v2"}]];et(s,xe({name:"bot"},()=>t,{get iconNode(){return i},children:(n,a)=>{var o=E(),f=I(o);tt(f,e,"default",{}),v(n,o)},$$slots:{default:!0}}))}function Ci(s,e){const t=Qe(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const i=[["path",{d:"m6 9 6 6 6-6"}]];et(s,xe({name:"chevron-down"},()=>t,{get iconNode(){return i},children:(n,a)=>{var o=E(),f=I(o);tt(f,e,"default",{}),v(n,o)},$$slots:{default:!0}}))}function Ii(s,e){const t=Qe(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const i=[["path",{d:"m15 18-6-6 6-6"}]];et(s,xe({name:"chevron-left"},()=>t,{get iconNode(){return i},children:(n,a)=>{var o=E(),f=I(o);tt(f,e,"default",{}),v(n,o)},$$slots:{default:!0}}))}function xi(s,e){const t=Qe(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const i=[["path",{d:"m18 15-6-6-6 6"}]];et(s,xe({name:"chevron-up"},()=>t,{get iconNode(){return i},children:(n,a)=>{var o=E(),f=I(o);tt(f,e,"default",{}),v(n,o)},$$slots:{default:!0}}))}function Ti(s,e){const t=Qe(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const i=[["path",{d:"M4 5h16"}],["path",{d:"M4 12h16"}],["path",{d:"M4 19h16"}]];et(s,xe({name:"menu"},()=>t,{get iconNode(){return i},children:(n,a)=>{var o=E(),f=I(o);tt(f,e,"default",{}),v(n,o)},$$slots:{default:!0}}))}function Li(s,e){Q(e,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=Ae(e,["$$slots","$$events","$$legacy"]);const i=[["path",{d:"M12 17V3"}],["path",{d:"m6 11 6 6 6-6"}],["path",{d:"M19 21H5"}]];kt(s,xe({name:"arrow-down-to-line"},()=>t,{get iconNode(){return i},children:(n,a)=>{var o=E(),f=I(o);se(f,()=>e.children??ae),v(n,o)},$$slots:{default:!0}})),ee()}function ki(s,e){Q(e,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=Ae(e,["$$slots","$$events","$$legacy"]);const i=[["path",{d:"M12 5v14"}],["path",{d:"m19 12-7 7-7-7"}]];kt(s,xe({name:"arrow-down"},()=>t,{get iconNode(){return i},children:(n,a)=>{var o=E(),f=I(o);se(f,()=>e.children??ae),v(n,o)},$$slots:{default:!0}})),ee()}function Ai(s,e){Q(e,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=Ae(e,["$$slots","$$events","$$legacy"]);const i=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"}],["path",{d:"m21.854 2.147-10.94 10.939"}]];kt(s,xe({name:"send"},()=>t,{get iconNode(){return i},children:(n,a)=>{var o=E(),f=I(o);se(f,()=>e.children??ae),v(n,o)},$$slots:{default:!0}})),ee()}class Hi{#e=T(ie({featureLayerView:null,areaInfos:[]}));get layerHighlightState(){return r(this.#e)}set layerHighlightState(e){w(this.#e,e,!0)}#t=T(null);get lastAddedArea(){return r(this.#t)}set lastAddedArea(e){w(this.#t,e,!0)}#r=T(null);get lastRemovedArea(){return r(this.#r)}set lastRemovedArea(e){w(this.#r,e,!0)}#n=T(null);get currentHoveredArea(){return r(this.#n)}set currentHoveredArea(e){w(this.#n,e,!0)}#i=[];#o=new Me;setNameFields(e){console.log("Setting name fields:",e),this.#i=e}setSelectedLayerView(e){this.layerHighlightState?.featureLayerView!==e&&(this.layerHighlightState&&this.layerHighlightState.areaInfos.forEach(t=>{t.handle.remove()}),this.layerHighlightState={featureLayerView:e,areaInfos:[]})}clearSelectedLayerView(){this.layerHighlightState.featureLayerView!==null&&(this.resetSelectedAreas(),this.layerHighlightState.featureLayerView=null)}resetSelectedAreas(){!this.layerHighlightState.featureLayerView&&this.layerHighlightState.areaInfos.length===0||(this.layerHighlightState&&this.layerHighlightState.areaInfos.forEach(e=>{e.handle.remove()}),this.layerHighlightState={featureLayerView:null,areaInfos:[]})}addSelectedArea(e,t){if(!this.layerHighlightState){console.warn("SelectedAreasStore: No feature layer view is set.");return}const i={id:e,handle:t};this.layerHighlightState.areaInfos.push(i),this.lastAddedArea=i}removeSelectedArea(e){if(!this.layerHighlightState){console.warn("SelectedAreasStore: No feature layer view is set.");return}const t=this.layerHighlightState.areaInfos.findIndex(i=>i.id===e);t!==-1&&(this.lastRemovedArea={id:e,handle:this.layerHighlightState.areaInfos[t].handle},this.layerHighlightState.areaInfos[t].handle.remove(),this.layerHighlightState.areaInfos.splice(t,1))}async getAreaNamesById(e){if(!this.layerHighlightState?.featureLayerView)return[];const t=this.getNameFieldForCurrentLayer();if(!t)return[];const i=this.layerHighlightState.featureLayerView.layer;let n=this.#o.get(i.uid);n||(n=new Me,this.#o.set(i.uid,n));const a=new Array(e.length),o=new Me,f=[];if(e.forEach((d,p)=>{o.set(d,p);const m=n.get(d);m!==void 0?a[p]=m:f.push(d)}),f.length===0)return a.map(d=>d??"");const g=i.objectIdField,u=await i.queryFeatures({objectIds:f,outFields:[t,g],returnGeometry:!1});for(const d of u.features){const p=d.attributes[g],m=d.attributes[t],c=o.get(p);c!==void 0&&(a[c]=m??"",n.set(p,m??""))}return a.map(d=>d??"")}setHoveredArea(e,t){this.currentHoveredArea&&this.clearHoveredArea(),this.currentHoveredArea={id:e,handle:t}}clearHoveredArea(){this.currentHoveredArea&&(this.currentHoveredArea?.handle.remove(),this.currentHoveredArea=null)}getNameFieldForCurrentLayer(){if(!this.layerHighlightState||!this.layerHighlightState.featureLayerView)return null;const e=this.#i.find(t=>t.layerName===this.layerHighlightState?.featureLayerView?.layer?.title)?.field;return e||(console.warn(`SelectedAreasStore: No name field configured for layer ${this.layerHighlightState.featureLayerView.layer.title}`,this.#i),null)}}const J=new Hi;var Mi=N('<p class="text-sm font-medium"> </p>'),zi=N('<div class="pointer-events-none fixed z-50 transition-opacity duration-200"><!></div>');function Ni(s,e){Q(e,!0);let t=T(null),i=T(ie({x:0,y:0})),n=0;const a=u=>{w(i,{x:u.clientX,y:u.clientY},!0)};ce(()=>(document.addEventListener("mousemove",a),()=>{document.removeEventListener("mousemove",a)})),ce(()=>{const u=J.currentHoveredArea?.id,d=++n;if(!u){w(t,null);return}(async()=>{const p=await J.getAreaNamesById([u]);d===n&&J.currentHoveredArea?.id===u&&w(t,p[0]??null,!0)})()});var o=E(),f=I(o);{var g=u=>{var d=zi(),p=S(d);K(p,()=>qt,(m,c)=>{c(m,{class:"max-w-xs border !py-2 shadow-lg",children:(l,h)=>{var C=E(),x=I(C);K(x,()=>Lt,(k,b)=>{b(k,{class:"!px-3 !py-0",children:(y,F)=>{var A=Mi(),W=S(A,!0);_(A),oe(()=>he(W,r(t))),v(y,A)},$$slots:{default:!0}})}),v(l,C)},$$slots:{default:!0}})}),_(d),oe(()=>Oe(d,`left: ${r(i).x+10}px; top: ${r(i).y-10}px;`)),v(u,d)};U(f,u=>{r(t)&&u(g)})}v(s,o),ee()}function Fi(s,e){Q(e,!0);async function t(i,n){const a=await J.getAreaNamesById([i]);if(!a||a.length===0||!a[0])return;const o=`Area ${n}: ${a[0]}`;Ee.success(o)}ce(()=>{J.lastAddedArea&&t(J.lastAddedArea.id,"added")}),ce(()=>{J.lastRemovedArea&&t(J.lastRemovedArea.id,"removed")}),ee()}var Pi=N("<div><!></div>");function Vt(s,e){Q(e,!0);let t=X(e,"ref",15,null),i=Ae(e,["$$slots","$$events","$$legacy","ref","variant","children"]);var n=Pi();ft(n,()=>({...i,class:"group/chat-bubble flex max-w-[80%] flex-row place-items-end gap-2 data-[variant='sent']:place-self-end","data-variant":e.variant}));var a=S(n);se(a,()=>e.children??ae),_(n),Ie(n,o=>t(o),()=>t()),v(s,n),ee()}var Oi=N('<span class="inline-block size-(--loading-dots-size) rounded-full bg-primary svelte-k2x6sv"></span>'),Ei=N('<div class="inline-flex items-center gap-1 svelte-k2x6sv"></div>');function Vi(s,e){let t=X(e,"size",3,4);var i=Ei();let n;ke(i,20,()=>({length:3}),Ye,(a,o)=>{var f=Oi();v(a,f)}),_(i),oe(a=>n=Oe(i,"",n,a),[()=>({"--loading-dots-size":`${t()??""}px`})]),v(s,i)}var Di=N('<div class="flex size-full place-items-center justify-center"><!></div>'),Ri=N("<div><!></div>");function Dt(s,e){Q(e,!0);let t=X(e,"ref",15,null),i=X(e,"typing",3,!1),n=Ae(e,["$$slots","$$events","$$legacy","ref","typing","class","children"]);var a=Ri();ft(a,u=>({...n,class:u}),[()=>vt("order-2 rounded-lg bg-secondary p-4 text-sm group-data-[variant='received']/chat-bubble:rounded-bl-none group-data-[variant='sent']/chat-bubble:order-1 group-data-[variant='sent']/chat-bubble:rounded-br-none group-data-[variant='sent']/chat-bubble:bg-primary group-data-[variant='sent']/chat-bubble:text-primary-foreground",e.class)]);var o=S(a);{var f=u=>{var d=Di(),p=S(d);Vi(p,{}),_(d),v(u,d)},g=u=>{var d=E(),p=I(d);se(p,()=>e.children??ae),v(u,d)};U(o,u=>{i()?u(f):u(g,!1)})}_(a),Ie(a,u=>t(u),()=>t()),v(s,a),ee()}function Gi(s,e){Q(e,!0);let t=X(e,"ref",15,null),i=Ae(e,["$$slots","$$events","$$legacy","ref","class"]);var n=E(),a=I(n);{let o=z(()=>vt("relative flex size-8 shrink-0 overflow-hidden rounded-full",e.class));K(a,()=>_i,(f,g)=>{g(f,xe({"data-slot":"avatar",get class(){return r(o)}},()=>i,{get ref(){return t()},set ref(u){t(u)}}))})}v(s,n),ee()}function Bi(s,e){Q(e,!0);let t=X(e,"ref",15,null),i=Ae(e,["$$slots","$$events","$$legacy","ref","class"]);{let n=z(()=>vt("order-1 group-data-[variant='sent']/chat-bubble:order-2",e.class));Gi(s,xe({get class(){return r(n)}},()=>i,{get ref(){return t()},set ref(a){t(a)}}))}ee()}function Ui(s){const e=s-1;return e*e*e+1}function Rt(s,{delay:e=0,duration:t=400,easing:i=Ui,start:n=0,opacity:a=0}={}){const o=getComputedStyle(s),f=+o.opacity,g=o.transform==="none"?"":o.transform,u=1-n,d=f*(1-a);return{delay:e,duration:t,easing:i,css:(p,m)=>`
			transform: ${g} scale(${1-u*m});
			opacity: ${f-d*m}
		`}}class ji{#e=T();#t=T(0);#r=T(!1);lastScrollHeight=0;set ref(e){if(w(this.#e,e,!0),!r(this.#e))return;this.lastScrollHeight=r(this.#e).scrollHeight,r(this.#e).scrollTo(0,r(this.#t)?r(this.#t):r(this.#e).scrollHeight),r(this.#e).addEventListener("scroll",()=>{r(this.#e)&&(w(this.#t,r(this.#e).scrollTop,!0),this.disableAutoScroll())}),window.addEventListener("resize",()=>{this.scrollToBottom(!0)}),new MutationObserver(()=>{r(this.#e)&&(r(this.#e).scrollHeight!==this.lastScrollHeight&&this.scrollToBottom(!0),this.lastScrollHeight=r(this.#e).scrollHeight)}).observe(r(this.#e),{childList:!0,subtree:!0})}get ref(){return r(this.#e)}get scrollY(){return r(this.#t)}get isAtBottom(){return r(this.#e)?r(this.#t)+r(this.#e).offsetHeight>=r(this.#e).scrollHeight:!0}disableAutoScroll(){this.isAtBottom?w(this.#r,!1):w(this.#r,!0)}scrollToBottom(e=!1){r(this.#e)&&(e&&r(this.#r)||r(this.#e).scrollTo(0,r(this.#e).scrollHeight))}}var Wi=N("<div><!></div>"),qi=N('<div class="relative"><div><!></div> <!></div>');function Yi(s,e){Q(e,!0);let t=X(e,"ref",15,null),i=Ae(e,["$$slots","$$events","$$legacy","ref","children","class"]),n=T(!1);const a=new ji;qe(()=>{w(n,!0)});var o=qi(),f=S(o);ft(f,p=>({...i,class:p}),[()=>vt("no-scrollbar flex h-full w-full flex-col gap-4 overflow-y-auto p-4",e.class,{"scroll-smooth":r(n)})]);var g=S(f);se(g,()=>e.children??ae),_(f),Ie(f,p=>t(p),()=>t()),Ie(f,p=>a.ref=p,()=>a?.ref);var u=M(f,2);{var d=p=>{var m=Wi(),c=S(m);Ce(c,{onclick:()=>a.scrollToBottom(),variant:"outline",size:"icon",class:"absolute bottom-2 left-1/2 inline-flex -translate-x-1/2 transform rounded-full shadow-md",children:(l,h)=>{ki(l,{})},$$slots:{default:!0}}),_(m),Et(1,m,()=>Rt,()=>({start:.85,duration:100,delay:250})),Et(2,m,()=>Rt,()=>({start:.85,duration:100})),v(p,m)};U(u,p=>{a.isAtBottom||p(d)})}_(o),v(s,o),ee()}var Zi=N(`<p> </p> <div class="w-full text-xs group-data-[variant='sent']/chat-bubble:text-end"> </div>`,1),Xi=N("<!> <!>",1),$i=N("<!> <!>",1),Ki=N('<div class="flex h-full w-full flex-col border border-border"><div class="flex-1 overflow-auto [scroll-behavior:smooth]"><div class="flex min-h-full flex-col justify-end gap-2 p-2"><!></div></div> <form class="flex shrink-0 items-center gap-2 border-t border-border bg-background p-2"><!> <!></form></div>');function Ji(s,e){Q(e,!0);let t=T(""),i=T(void 0),n=T(void 0),a=T(void 0),o=T(!0);const f=8,g=ie([{senderId:2,message:"How do I use the treeview?",sentAt:"10:00 AM"},{senderId:1,message:"The UPRN treeview enables you to select and download data...",sentAt:"10:01 AM"},{senderId:2,message:"Can you show me how?",sentAt:"10:02 AM"}]);function u(y){return`${y.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})} ${y.getHours()>=12?"PM":"AM"}`}function d(){return r(n)?r(n).scrollHeight-r(n).scrollTop-r(n).clientHeight<=f:!0}async function p(y="smooth"){await _r(),r(n)&&r(n).scrollTo({top:r(n).scrollHeight,behavior:y})}function m(){w(o,d(),!0)}ce(()=>{g.length,r(o)&&p("smooth")}),qe(()=>{p("auto");const y=new ResizeObserver(()=>{r(n)&&r(o)&&p("smooth")});r(i)&&y.observe(r(i));let F=0;const A=new ResizeObserver(()=>{if(!r(n))return;const W=r(a)?.scrollHeight||0;if(r(o))p("smooth");else{const R=W-F;R!==0&&(r(n).scrollTop+=R)}F=W});return r(a)&&(F=r(a).scrollHeight,A.observe(r(a))),()=>{y.disconnect(),A.disconnect()}});var c=Ki(),l=S(c),h=S(l),C=S(h);K(C,()=>Yi,(y,F)=>{F(y,{children:(A,W)=>{var R=$i(),q=I(R);ke(q,16,()=>g,V=>V,(V,L)=>{var P=E(),Z=I(P);{let G=z(()=>L.senderId===2?"sent":"received");K(Z,()=>Vt,(D,j)=>{j(D,{get variant(){return r(G)},children:(Y,le)=>{var fe=Xi(),ne=I(fe);K(ne,()=>Bi,(ue,Te)=>{Te(ue,{})});var ge=M(ne,2);K(ge,()=>Dt,(ue,Te)=>{Te(ue,{class:"flex flex-col gap-1",children:(we,ye)=>{var ve=Zi(),_e=I(ve),H=S(_e,!0);_(_e);var B=M(_e,2),te=S(B,!0);_(B),oe(()=>{he(H,L.message),he(te,L.sentAt)}),v(we,ve)},$$slots:{default:!0}})}),v(Y,fe)},$$slots:{default:!0}})})}v(V,P)});var $=M(q,2);K($,()=>Vt,(V,L)=>{L(V,{variant:"received",children:(P,Z)=>{var G=E(),D=I(G);K(D,()=>Dt,(j,Y)=>{Y(j,{typing:!0})}),v(P,G)},$$slots:{default:!0}})}),v(A,R)},$$slots:{default:!0}})}),_(h),Ie(h,y=>w(a,y),()=>r(a)),_(l),Ie(l,y=>w(n,y),()=>r(n));var x=M(l,2),k=S(x);hi(k,{class:"rounded-full",placeholder:"Type a message...",get value(){return r(t)},set value(y){w(t,y,!0)}});var b=M(k,2);{let y=z(()=>r(t)==="");Ce(b,{type:"submit",variant:"default",size:"icon",class:"shrink-0 rounded-full",get disabled(){return r(y)},children:(F,A)=>{Ai(F,{})},$$slots:{default:!0}})}_(x),_(c),Ie(c,y=>w(i,y),()=>r(i)),Pt("scroll",l,m),Pt("submit",x,y=>{y.preventDefault(),r(t)&&(g.push({message:r(t),senderId:2,sentAt:u(new Date)}),w(t,""),w(o,!0),p("smooth"))}),v(s,c),ee()}class Qi{#e=T(ie([]));get downloads(){return r(this.#e)}set downloads(e){w(this.#e,e,!0)}}const We=new Qi;var en=N('<li class="download-item svelte-vgw5fc"><div class="download-info svelte-vgw5fc"><span class="download-url svelte-vgw5fc"> </span></div> <div class="download-actions svelte-vgw5fc"><div><!></div> <!> <!> <!></div></li>'),tn=N('<ul class="selected-list svelte-vgw5fc"></ul> <p class="count svelte-vgw5fc"> </p>',1),rn=N('<p class="no-selection svelte-vgw5fc">No downloads in queue</p>'),nn=N('<div class="section svelte-vgw5fc"><h4 class="svelte-vgw5fc">Download Queue</h4> <!></div>');function an(s,e){Q(e,!0);let t=T(ie(new Set));const i={completed:{color:"#059669",text:"Completed",icon:$r},"in-progress":{color:"#2563eb",text:"In Progress",icon:Xr},failed:{color:"#dc2626",text:"Failed",icon:Zr},pending:{color:"#6b7280",text:"Pending",icon:Yr}};function n(c){const l=We.downloads.findIndex(h=>h.url===c);l!==-1&&We.downloads.splice(l,1)}async function a(c){try{await navigator.clipboard.writeText(c),w(t,new Set(r(t)).add(c),!0),Ee.success("URL copied to clipboard"),setTimeout(()=>{const l=new Set(r(t));l.delete(c),w(t,l,!0)},2e3)}catch(l){console.error("Failed to copy URL:",l),Ee.error("Failed to copy URL to clipboard")}}function o(c){return i[c]?.color??i.pending.color}function f(c){return i[c]?.text??i.pending.text}function g(c){return i[c]?.icon??i.pending.icon}var u=nn(),d=M(S(u),2);{var p=c=>{var l=tn(),h=I(l);ke(h,21,()=>We.downloads,Ye,(k,b)=>{var y=en(),F=S(y),A=S(F),W=S(A,!0);_(A),_(F);var R=M(F,2),q=S(R),$=S(q);{let G=z(()=>o(r(b).status));Ce($,{variant:"ghost",size:"sm",class:"download-status-btn",get style(){return`color: ${r(G)??""}`},disabled:!0,children:(D,j)=>{const Y=z(()=>g(r(b).status));var le=E(),fe=I(le);{let ne=z(()=>r(b).status==="in-progress"?"spinning":"");K(fe,()=>r(Y),(ge,ue)=>{ue(ge,{size:14,get class(){return r(ne)}})})}v(D,le)},$$slots:{default:!0}})}_(q);var V=M(q,2);Ce(V,{variant:"ghost",size:"sm",class:"download-clipboard-btn",onclick:()=>a(r(b).url),title:"Copy URL to clipboard",children:(G,D)=>{var j=E(),Y=I(j);{var le=ne=>{Wr(ne,{size:14})},fe=ne=>{qr(ne,{size:14})};U(Y,ne=>{r(t).has(r(b).url)?ne(le):ne(fe,!1)})}v(G,j)},$$slots:{default:!0}});var L=M(V,2);{var P=G=>{Ce(G,{variant:"ghost",size:"sm",class:"download-action-btn",onclick:()=>window.open(r(b).url,"_blank"),title:"Open download",children:(D,j)=>{Ve();var Y=Ge("ðŸ“¥");v(D,Y)},$$slots:{default:!0}})};U(L,G=>{r(b).status==="completed"&&G(P)})}var Z=M(L,2);Ce(Z,{variant:"ghost",size:"sm",class:"download-remove-btn",onclick:()=>n(r(b).url),title:"Remove from queue",children:(G,D)=>{Ve();var j=Ge("Ã—");v(G,j)},$$slots:{default:!0}}),_(R),_(y),oe(G=>{ut(A,"title",r(b).url),he(W,r(b).id),ut(q,"title",G)},[()=>f(r(b).status)]),v(k,y)}),_(h);var C=M(h,2),x=S(C);_(C),oe(()=>he(x,`${We.downloads.length??""} download(s) in queue`)),v(c,l)},m=c=>{var l=rn();v(c,l)};U(d,c=>{We.downloads.length>0?c(p):c(m,!1)})}_(u),v(s,u),ee()}class $t{id;name;children;parent;constructor(e,t,i=[],n=null){this.id=e,this.name=t,this.children=i,this.parent=n}}class de extends $t{layer;constructor(e,t,i,n=[],a=null){super(e,t,n,a),this.layer=i}}class Ze extends de{featureLayer;field;constructor(e,t,i,n,a=[],o=null){super(e,t,i,a,o),this.field=n,this.featureLayer=i}}var re=(s=>(s.Inactive="inactive",s.Indeterminate="indeterminate",s.Active="active",s))(re||{});class on{#e=T(ie(new Me));get DataSelections(){return r(this.#e)}set DataSelections(e){w(this.#e,e,!0)}addSelection(e){this.DataSelections.set(e.layerId,e),Ee.success(`'${e.name}' Added`)}removeSelection(e){const t=this.DataSelections.get(e);this.DataSelections.delete(e),Ee.success(`'${t?.name}' Removed`)}updateSelection(e,t){if(!(e instanceof de)){this.updateChildrenSelection(e,t);return}if(e instanceof Ze){this.updateFieldSelection(e,t);return}this.updateLayerSelection(e,t)}getSelectionState(e){if(!(e instanceof de))return this.determineSelectionStateFromChildren(e);if(this.isGroupLayer(e))return this.determineSelectionStateFromChildren(e);let t;return e instanceof Ze?(t=this.DataSelections.get(e.featureLayer.id),t&&t.fields.has(e.field.name)?re.Active:re.Inactive):(t=this.DataSelections.get(e.id),t?this.isFeatureLayer(e)&&e.children&&e.children.length>0?this.determineSelectionStateFromChildren(e):re.Active:re.Inactive)}updateLayerSelection(e,t){let i=this.DataSelections.get(e.id);switch(t){case re.Active:!i&&!this.isGroupLayer(e)&&(i=this.createAndAddDataSelection(e.id,e.layer.title||""));for(const n of e.children||[])this.updateSelection(n,t);break;case re.Inactive:i&&!this.isGroupLayer(e)&&this.removeSelection(e.id),this.updateChildrenSelection(e,t);break}}updateFieldSelection(e,t){let i=this.DataSelections.get(e.featureLayer.id);switch(t){case re.Active:i||(i=this.createAndAddDataSelection(e.featureLayer.id,e.featureLayer.title||"")),i.fields.add(e.field.name);break;case re.Inactive:if(!i)break;i.fields.delete(e.field.name),i.fields.size===0&&this.removeSelection(i.layerId);break}}updateChildrenSelection(e,t){for(const i of e.children||[])this.updateSelection(i,t)}determineSelectionStateFromChildren(e){let t=0,i=0;for(const n of e.children||[]){i++;const a=this.getSelectionState(n);if(a===re.Active||this.isFeatureLayer(n)&&a!==re.Inactive)t++;else if(a===re.Indeterminate)return re.Indeterminate}return t===0?re.Inactive:t===i?re.Active:re.Indeterminate}createAndAddDataSelection(e,t){const i={layerId:e,name:t,fields:new Ke};return this.addSelection(i),i}isGroupLayer(e){return e instanceof de&&e.layer.type==="group"}isFeatureLayer(e){return e instanceof de&&e.layer.type==="feature"}}const pe=new on;var sn=N('<p class="text-sm text-muted-foreground">Click "Export" to begin the download.</p> <!>',1);function ln(s,e){Q(e,!0);const t=()=>Cr(Kr,"$page",i),[i,n]=Sr();function a(){if(J.layerHighlightState.areaInfos.length<=0){Ee.error("Please select at least one area to export.");return}if(pe.DataSelections.size<=0){Ee.error("Please select at least one data layer to export.");return}console.log("Starting export..."),Ee.info("Export started successfully.",{duration:4e3});const g=crypto.randomUUID();We.downloads.push({id:g,url:`${t().url}/${g}`,status:"pending"}),e.onExportSuccess?.()}var o=sn(),f=M(I(o),2);Ce(f,{onclick:a,children:(g,u)=>{Ve();var d=Ge("Export");v(g,d)},$$slots:{default:!0}}),v(s,o),ee(),n()}class dn{#e=T(null);get ActiveLayer(){return r(this.#e)}set ActiveLayer(e){w(this.#e,e,!0)}}class cn{#e=T(!1);get isLoaded(){return r(this.#e)}set isLoaded(e){w(this.#e,e,!0)}#t=T(null);get data(){return r(this.#t)}set data(e){w(this.#t,e,!0)}#r=z(()=>{const e=new Me;function t(i){e.set(i.id,i),i.type==="group"&&i.layers.forEach(a=>{t(a)})}return this.data&&this.data.layers.forEach(i=>{t(i)}),e});get dataLookup(){return r(this.#r)}set dataLookup(e){w(this.#r,e)}#n=T(!1);get loading(){return r(this.#n)}set loading(e){w(this.#n,e,!0)}#i=T(null);get error(){return r(this.#i)}set error(e){w(this.#i,e,!0)}async initializeAsync(e){if(!this.data){this.loading=!0,this.error=null;try{const{portalUrl:t,itemId:i,proxy:n}=e;await this.configurePortalAsync(t,n),await this.loadwebmapAsync(i)}catch(t){console.error("Error initializing webmap:",t),this.error=t.message}finally{this.loading=!1}}}async configurePortalAsync(e,t){if(!e)return;const i=await hn();if(i.portalUrl=e,console.log(i),!t)return;const{addProxyRule:n}=await vn();console.log("Adding proxy rule for portal traffic"),n({urlPrefix:t?.urlPrefix,proxyUrl:t?.proxyUrl})}async loadwebmapAsync(e){if(this.data)return;const[t,i]=await Promise.all([un(),fn()]),n=new i({id:e}),a=new t({portalItem:n});this.data=a,await this.data.when(),this.data.loaded&&(this.isLoaded=!0)}clear(){this.data=null,this.loading=!1,this.error=null}clearError(){this.error=null}getWebmap(){return this.data}}let yt=null,bt=null,wt=null,_t=null;async function un(){return yt||(yt=Pe(()=>import("../chunks/huXfT4GN.js").then(s=>s.W),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143]),import.meta.url).then(s=>s.default)),yt}async function fn(){return bt||(bt=Pe(()=>import("../chunks/DxjcXvGa.js"),__vite__mapDeps([17,4,1,2,3,5,6,14,11]),import.meta.url).then(s=>s.default)),bt}async function hn(){return wt||(wt=Pe(()=>import("../chunks/DHq0rblm.js").then(s=>s.Z),[],import.meta.url).then(s=>s.default)),wt}async function vn(){return _t||(_t=Pe(()=>import("../chunks/BgvLO-3W.js").then(s=>s.O),__vite__mapDeps([6,2,3]),import.meta.url)),_t}function gn(s,e){s.stopPropagation(),e.onFilterClicked?.(e.layerId)}var mn=N("<button><!></button>");function pn(s,e){Q(e,!0);let t=T(ie(e.hasFiltersApplied?.(e.layerId)??!1));ce(()=>{w(t,e.hasFiltersApplied?.(e.layerId)??!1,!0)});const i=z(()=>r(t)?Jr:Qr);var n=mn();let a;n.__click=[gn,e];var o=S(n);Je(o,()=>r(i)),_(n),oe(f=>{a=Fe(n,1,"filter-btn svelte-k95pvd",null,a,f),ut(n,"aria-pressed",r(t))},[()=>({active:r(t)})]),v(s,n),ee()}ht(["click"]);var yn=N('<li class="area-item svelte-81yb5c"><span class="area-name svelte-81yb5c"> </span> <!></li>'),bn=N('<ul class="selected-list svelte-81yb5c"></ul> <p class="count svelte-81yb5c"> </p>',1),wn=N('<p class="no-selection svelte-81yb5c">No areas selected</p>'),_n=N('<li class="data-item svelte-81yb5c"><span class="data-name svelte-81yb5c"> </span> <div class="data-actions svelte-81yb5c"><!> <!></div></li>'),Sn=N('<ul class="selected-list svelte-81yb5c"></ul> <p class="count svelte-81yb5c"> </p>',1),Cn=N('<p class="no-selection svelte-81yb5c">No data selected</p>'),In=N('<h2 class="svelte-81yb5c">Export Options</h2> <div class="section svelte-81yb5c"><h3 class="svelte-81yb5c"> </h3> <h4 class="svelte-81yb5c">Selected Areas</h4> <!></div> <div class="section svelte-81yb5c"><h4 class="svelte-81yb5c">Selected Data</h4> <!></div>',1);function xn(s,e){Q(e,!0);const t=X(e,"fieldFilterMenuStore",7);let i=T(ie([]));ce(()=>{if(!J.layerHighlightState.areaInfos.length){w(i,[],!0);return}(async()=>{const y=await J.getAreaNamesById(J.layerHighlightState.areaInfos.map(A=>A.id)),F=[];for(let A=0;A<y.length;A++)F.push({name:y[A]||"Unknown Area",HighlightAreaInfo:J.layerHighlightState.areaInfos[A]});w(i,F,!0)})()});function n(b){const y=r(i).findIndex(F=>F.name===b);y!==-1&&J.removeSelectedArea(r(i)[y]?.HighlightAreaInfo.id)}function a(b){console.log("[export-menu] Removing data selection for layerId:",b),pe.DataSelections.delete(b),console.log("[export-menu] Current SelectedData:",Tr(pe.DataSelections))}function o(b){if(t().ActiveLayer?.id===b){t().ActiveLayer=null;return}const y=e.webMapStore.dataLookup.get(b);if(!y){console.warn(`[export-menu] Layer with ID ${b} not found in web map store.`);return}t().ActiveLayer=y}function f(b){const y=pe.DataSelections.get(b);return!(!y||!y.fields||y.fields.size===0||y.fields.size===e.webMapStore.dataLookup.get(b)?.fields?.length)}var g=In(),u=M(I(g),2),d=S(u),p=S(d,!0);_(d);var m=M(d,4);{var c=b=>{var y=bn(),F=I(y);ke(F,21,()=>r(i),Ye,(R,q)=>{var $=yn(),V=S($),L=S(V,!0);_(V);var P=M(V,2);Ce(P,{variant:"ghost",size:"sm",class:"area-remove-btn",onclick:()=>n(r(q).name),children:(Z,G)=>{Ve();var D=Ge("Ã—");v(Z,D)},$$slots:{default:!0}}),_($),oe(()=>he(L,r(q).name)),v(R,$)}),_(F);var A=M(F,2),W=S(A);_(A),oe(()=>he(W,`${r(i).length??""} area(s) selected`)),v(b,y)},l=b=>{var y=wn();v(b,y)};U(m,b=>{r(i).length>0?b(c):b(l,!1)})}_(u);var h=M(u,2),C=M(S(h),2);{var x=b=>{var y=Sn(),F=I(y);ke(F,21,()=>[...pe.DataSelections.values()],Ye,(R,q)=>{var $=_n(),V=S($),L=S(V,!0);_(V);var P=M(V,2),Z=S(P);{var G=j=>{pn(j,{get layerId(){return r(q).layerId},onFilterClicked:o,hasFiltersApplied:f})};U(Z,j=>{r(q).fields&&j(G)})}var D=M(Z,2);Ce(D,{variant:"ghost",size:"sm",class:"data-remove-btn",onclick:()=>a(r(q).layerId),children:(j,Y)=>{Ve();var le=Ge("Ã—");v(j,le)},$$slots:{default:!0}}),_(P),_($),oe(()=>he(L,r(q).name)),v(R,$)}),_(F);var A=M(F,2),W=S(A);_(A),oe(()=>he(W,`${pe.DataSelections.size??""} data layer(s) selected`)),v(b,y)},k=b=>{var y=Cn();v(b,y)};U(C,b=>{pe.DataSelections.size>0?b(x):b(k,!1)})}_(h),oe(b=>he(p,b),[()=>e.areaSelectionTreeviewStore.initialized?e.areaSelectionTreeviewStore.getVisibleNodes()[0]?.name:"Loading..."]),v(s,g),ee()}function Tn(s,e){s.target===s.currentTarget&&e()}var Ln=(s,e)=>s.key==="Escape"&&e(),kn=(s,e,t)=>e(r(t).name),An=N('<div class="info-icon-container svelte-fp5rsc"><!></div>'),Hn=N('<div class="field-content-wrapper svelte-fp5rsc"><!> <button class="field-content svelte-fp5rsc" tabindex="0"><div class="field-name-container svelte-fp5rsc"><span class="field-name svelte-fp5rsc"> </span> <!></div></button></div>'),Mn=N('<div class="master-checkbox-container svelte-fp5rsc"><!> <span class="master-checkbox-label svelte-fp5rsc">Select All Fields</span></div> <!> <!>',1),zn=N("<!> <!>",1),Nn=N("<!> <!>",1),Fn=N('<button class="close-button svelte-fp5rsc" aria-label="Close"><!></button> <!>',1),Pn=N('<div class="card-container svelte-fp5rsc" role="dialog" aria-modal="true" tabindex="-1"><!></div>');function On(s,e){Q(e,!0);const t=X(e,"fieldFilterMenuStore",7);let i=T(null),n=T(ie(new Ke)),a=z(()=>{if(!r(i)||!r(i).fields)return{checked:!1,indeterminate:!1};const l=r(i).fields.length,h=r(n)?.size||0;return h===0?{checked:!1,indeterminate:!1}:h===l?{checked:!0,indeterminate:!1}:{checked:!1,indeterminate:!0}});ce(()=>{console.log("Active Layer to Filter:",t().ActiveLayer);const l=t().ActiveLayer;if(w(i,l,!0),l){const h=pe.DataSelections.get(l.id);h?.fields?w(n,new Ke([...h.fields]),!0):w(n,new Ke,!0)}});function o(){f(),t().ActiveLayer=null}function f(){if(!r(i))return;let l=pe.DataSelections.get(r(i).id);if(l){if((l.fields===void 0||l.fields===null)&&(l.fields=new Ke),r(n).size===0){pe.removeSelection(r(i).id);return}l.fields.clear(),r(n).forEach(h=>{l.fields?.add(h)})}}function g(l){r(i)&&(r(n).has(l)?r(n).delete(l):r(n).add(l))}function u(){if(!r(i)?.fields)return;(r(n)?.size||0)===0?r(i).fields.forEach(h=>{r(n).add(h.name)}):r(n).clear()}function d(){return r(i)?.fields?r(i).fields:[]}var p=E(),m=I(p);{var c=l=>{var h=Pn();h.__click=[Tn,o],h.__keydown=[Ln,o];var C=S(h);K(C,()=>qt,(x,k)=>{k(x,{class:"command-card",children:(b,y)=>{var F=Fn(),A=I(F);A.__click=o;var W=S(A);Lr(W,{size:20}),_(A);var R=M(A,2);K(R,()=>Lt,(q,$)=>{$(q,{class:"card-content",children:(V,L)=>{var P=E(),Z=I(P);K(Z,()=>kr,(G,D)=>{D(G,{children:(j,Y)=>{var le=Nn(),fe=I(le);K(fe,()=>Ar,(ge,ue)=>{ue(ge,{placeholder:"Search for fields..."})});var ne=M(fe,2);K(ne,()=>Hr,(ge,ue)=>{ue(ge,{children:(Te,we)=>{var ye=zn(),ve=I(ye);K(ve,()=>Mr,(H,B)=>{B(H,{children:(te,Se)=>{Ve();var me=Ge("No results found.");v(te,me)},$$slots:{default:!0}})});var _e=M(ve,2);K(_e,()=>zr,(H,B)=>{B(H,{heading:"Fields",children:(te,Se)=>{var me=Mn(),Le=I(me),ze=S(Le);Mt(ze,{get checked(){return r(a).checked},get indeterminate(){return r(a).indeterminate},onCheckedChange:u}),Ve(2),_(Le);var Be=M(Le,2);K(Be,()=>ei,(Ue,be)=>{be(Ue,{})});var rt=M(Be,2);ke(rt,17,d,Ye,(Ue,be)=>{var it=E(),gt=I(it);K(gt,()=>Nr,(Ne,Xe)=>{Xe(Ne,{class:"field-item",onselect:()=>g(r(be).name),children:(De,nt)=>{var Re=Hn(),je=S(Re);{let $e=z(()=>r(n)?.has(r(be).name)??!1);Mt(je,{class:"field-checkbox",get checked(){return r($e)},onCheckedChange:()=>g(r(be).name)})}var mt=M(je,2);mt.__click=[kn,g,be];var Ht=S(mt),pt=S(Ht),nr=S(pt,!0);_(pt);var ar=M(pt,2);{var or=$e=>{var at=An(),sr=S(at);Je(sr,()=>ti),_(at),oe(()=>ut(at,"title",r(be).description)),v($e,at)};U(ar,$e=>{r(be).description&&$e(or)})}_(Ht),_(mt),_(Re),oe(()=>he(nr,r(be).alias||r(be).name)),v(De,Re)},$$slots:{default:!0}})}),v(Ue,it)}),v(te,me)},$$slots:{default:!0}})}),v(Te,ye)},$$slots:{default:!0}})}),v(j,le)},$$slots:{default:!0}})}),v(V,P)},$$slots:{default:!0}})}),v(b,F)},$$slots:{default:!0}})}),_(h),v(l,h)};U(m,l=>{r(i)&&l(c)})}v(s,p),ee()}ht(["click","keydown"]);class Kt{#e=T(!1);get initialized(){return r(this.#e)}set initialized(e){w(this.#e,e,!0)}#t=null;#r=T(ie([]));#n=z(()=>{const e=new Me;return this.#b(r(this.#r),e),e});#i=T(ie(new Me));#o=T(ie(new Me));#c=T(ie(new Me));initialize(e,t,i){if(this.initialized)throw new Error("TreeviewStore is already initialized.");if(this.initialized=!0,!t)throw new Error("TreeviewStore requires a valid TreeviewConfigStore to initialize.");if(this.#t=t,i)for(const n of i)r(this.#c).set(n.id,n);if(!e)throw new Error("TreeviewStore requires a valid array of layers to initialize.");this.#a(e),w(this.#r,this.#m(e),!0)}getNodeById(e){return this.#d(),r(this.#n).get(e)}getNodes(){return this.#d(),r(this.#r)}getVisibleNodes(){this.#d();const e=[];for(const[t,i]of r(this.#i)){if(!i)continue;const n=r(this.#n).get(t);n&&e.push(n)}return e}getNonHiddenNodes(){return this.#d(),this.#u(r(this.#r))}#u(e){this.#d();const t=[];for(const i of e){const n=this.#l(i.id);if(!(n&&n.isHidden)&&(t.push(i),i.children?.length)){const a=this.#u(i.children);t.push(...a)}}return t}getVisibilityState(e){return this.#d(),r(this.#i).get(e)??!1}setVisibilityState(e,t){this.#d();const i=r(this.#n).get(e);if(!i)throw new Error(`Tree node not found for ID: ${e}`);if(!(i instanceof de))throw new Error(`Tree node is not a layer node: ${e}`);r(this.#i).set(e,t),i.layer.visible=t,i instanceof Ze&&(i.featureLayer.displayField=t?i.field.name:""),this.#s(i,t);const n=this.#l(e);if(!n||n.isHidden||(console.log(`Setting visibility of node ${e} to ${t}`,n,i),n.visibilityDependencyIds?.length&&this.#f(i,t),!n.visibilityGroupId))return;const a=n.visibilityGroupId;console.log(`Node ${e} is part of visibility group ${a}`);let o=r(this.#o).get(a);o||(o=[],r(this.#o).set(a,o));const f=this.#h(a);if(!f)throw new Error(`Visibility group config not found for group ID: ${a}`);if(!t){const u=o.indexOf(e);o.splice(u,1);return}const g=u=>{r(this.#i).set(u,!1);const d=r(this.#n).get(u);if(d&&d instanceof de){d.layer.visible=!1,this.#s(d,!1);const m=this.#l(u);m&&m.visibilityDependencyIds?.length&&this.#f(d,!1)}const p=o.indexOf(u);p>=0&&o.splice(p,1)};for(;o.length>=f.maxVisibleLayers;){const u=o[0];g(u)}o.push(e),this.#s(i,t),n.visibilityDependencyIds?.length&&this.#f(i,t)}#s(e,t){const i=e.parent;if(i){if(!(i instanceof de)){this.#s(i,t);return}r(this.#i).set(i.id,t),i.layer.visible=t,this.#s(i,t)}}#f(e,t){const i=this.#l(e.id);if(i&&i.visibilityDependencyIds?.length)for(const n of i.visibilityDependencyIds){const a=r(this.#n).get(n);a&&a instanceof de&&(r(this.#i).set(n,t),a.layer.visible=t,this.#s(a,t))}}#h(e){if(e&&this.#t)return this.#t.getVisibilityGroupConfig(e)}#a(e){this.#t&&this.#t.resolveInheritance(e)}#m(e){const t=e.map(i=>this.#g(i,void 0));return this.#v([...t])}#l(e){if(e&&this.#t)return this.#t.getItemConfig(e)}#v(e){e.reverse();for(const t of e)t.children?.length&&this.#v(t.children);return e}#g(e,t){const i=this.#l(e.id);if(i&&i.customConverterId){if(!r(this.#c).has(i.customConverterId))throw new Error(`Custom converter not found: ${i.customConverterId}`);const a=r(this.#c).get(i.customConverterId);if(!a)throw new Error(`Custom converter not found: ${i.customConverterId}`);return a.layerToNode(e,t??null)}const n=new de(e.id,e.title,e,[],t);if(e.visible=i?.isVisibleOnInit??!1,r(this.#i).set(e.id,e.visible),this.#C(e)&&i?.showFields){const a=e;a.loaded||console.warn(`Layer not loaded: ${e.id}`);for(const o of a.fields??[]){const f=this.#p(o,n);n.children.push(f)}}if(this.#S(e)){const a=e;return n.children=a.layers.toArray().map(o=>this.#g(o,n)),n}if(this.#w(e)){const a=e;if(a.sublayers&&a.sublayers.length>0){const o=a.sublayers;n.children=o.toArray().map(this.#y)}}return n}#p(e,t){const i=this.#_(t.id,e.name),n=new Ze(i,e.alias||e.name,t.layer,e,[],t),a=this.#l(i);return r(this.#i).set(i,a?.isVisibleOnInit??!1),n}#w(e){return e.type==="map-image"||e.type==="wms"}#y(e){const t=new de(e.uid,e.title,e);return e.sublayers?.length&&(t.children=e.sublayers.toArray().map(this.#y)),t}#b(e,t){for(const i of e)t.set(i.id,i),i.children?.length&&this.#b(i.children,t)}#_(e,t){return`${e}-${t}`}#S(e){return e.type==="group"}#C(e){return e.type==="feature"}#d(){if(!this.initialized)throw new Error("TreeviewStore is not initialized. Call initialize() first.")}}const En='<path d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/>',Vn='<path d="M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/>',Dn='<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14,2 14,8 20,8"/>',Jt=(s,e,t,i)=>e?Rn(s,t):t?i?En:Vn:Dn,Rn=(s,e)=>{switch(s.type){case"group":return zt;case"feature":return Nt;case"tile":return ri;default:return e?zt:Nt}};var Gn=N('<div class="tree-node-item svelte-1y72o5r"><!></div>'),Bn=N('<div class="tree-children relative ml-4 w-full svelte-1y72o5r"><div class="tree-guide-line tree-guide-line-animate svelte-1y72o5r"></div> <!></div>'),Un=N('<div class="w-full"><!>  <!></div>');function Qt(s,e){const t=X(e,"isOpen",3,!1),i=X(e,"childNodes",3,null);var n=Un(),a=S(n);se(a,()=>e.content??ae);var o=M(a,2);{var f=g=>{var u=Bn(),d=M(S(u),2);ke(d,19,()=>i()??[],p=>p.id,(p,m,c)=>{var l=Gn(),h=S(l);se(h,()=>e.childNode??ae,()=>r(m)),_(l),oe(()=>Oe(l,`animation-delay: ${100+r(c)*50}ms;`)),v(p,l)}),_(u),v(g,u)};U(o,g=>{t()&&i()&&g(f)})}_(n),v(s,n)}const Ct="mb-1 cursor-pointer rounded-md border border-border/30 p-2 text-left",It="transform-gpu transition-all duration-150 ease-out hover:border-border/50 hover:bg-card/70 hover:shadow-sm",jn="transition-colors hover:bg-card/70",xt="text-sm font-normal",Tt="bg-card/50",er="bg-accent text-accent-foreground",Wn="!h-auto !min-h-9 !whitespace-normal data-[state=on]:!bg-accent data-[state=on]:!text-accent-foreground data-[state=on]:hover:!bg-accent data-[state=on]:hover:!text-accent-foreground";function qn(s={}){const{enhancedHover:e=!1,includeFont:t=!1,pressed:i=!1}=s;let n=Ct;return e?n+=" "+It:n+=" "+jn,t&&(n+=" "+xt),i?n+=" "+er:n+=" "+Tt,n}var Yn=N('<div class="flex w-full !items-center !justify-between gap-2"><div class="pointer-events-none !flex min-w-0 flex-1 !items-center gap-1"><span class="inline-block size-4" aria-hidden="true"><!></span> <span class="block w-full text-left break-words"> </span></div> <!></div>'),Zn=N('<button><div class="flex w-full items-center justify-between gap-2"><div class="pointer-events-none flex min-w-0 flex-1 items-center gap-1"><!> <span class="inline-block size-4" aria-hidden="true"><!></span> <span class="block w-full text-left break-words"> </span></div> <!></div></button>');function Gt(s,e){const t=`calc(100% - ${e.depth*1}rem)`,i=`${Ct} ${It} ${Wn} ${Tt} ${xt}`,n=`${Ct} ${It} ${xt}`;var a=E(),o=I(a);{var f=u=>{ii(u,{get pressed(){return e.pressed},get class(){return i},variant:"outline",get style(){return`width: ${t};`},get onPressedChange(){return e.onclick},children:(d,p)=>{var m=Yn(),c=S(m),l=S(c),h=S(l);Je(h,()=>e.icon),_(l);var C=M(l,2),x=S(C,!0);_(C),_(c);var k=M(c,2);se(k,()=>e.children??ae),_(m),oe(()=>he(x,e.name)),v(d,m)},$$slots:{default:!0}})},g=u=>{var d=Zn();d.__click=function(...b){e.onclick?.apply(this,b)};var p=S(d),m=S(p),c=S(m);Yt(c,{get isOpen(){return e.isOpen}});var l=M(c,2),h=S(l);Je(h,()=>e.icon),_(l);var C=M(l,2),x=S(C,!0);_(C),_(m);var k=M(m,2);se(k,()=>e.children??ae),_(p),_(d),oe(()=>{Fe(d,1,`${n} ${e.pressed?er:Tt}`),Oe(d,`width: ${t};`),he(x,e.name)}),v(u,d)};U(o,u=>{e.isTogglable?u(f):u(g,!1)})}v(s,a)}ht(["click"]);function tr(s,e){Q(e,!0);const t=h=>{var C=E(),x=I(C);{var k=b=>{var y=E(),F=I(y);{var A=R=>{Gt(R,{isTogglable:!1,get pressed(){return r(u)},get icon(){return r(d)},get name(){return e.node.name},get depth(){return n()},onclick:l,get isOpen(){return r(g)}})},W=R=>{Gt(R,{isTogglable:!0,get pressed(){return r(u)},get icon(){return r(d)},get name(){return e.node.name},get depth(){return n()},onclick:c,get isOpen(){return r(g)}})};U(F,R=>{o?R(A):R(W,!1)})}v(b,y)};U(x,b=>{e.treeviewConfigStore.getItemConfig(e.node.id)?.isHidden||b(k)})}v(h,C)},i=(h,C=ae)=>{var x=E(),k=I(x);{var b=y=>{{let F=z(()=>n()+1);tr(y,{get treeviewConfigStore(){return e.treeviewConfigStore},get node(){return C()},get onNodeClick(){return e.onNodeClick},get onNodeVisibilityChange(){return e.onNodeVisibilityChange},get getNodeVisibility(){return e.getNodeVisibility},get depth(){return r(F)},get useLayerTypeIcon(){return a()}})}};U(k,y=>{o&&r(g)&&!e.treeviewConfigStore.getItemConfig(C().id)?.isHidden&&y(b)})}v(h,x)},n=X(e,"depth",3,0),a=X(e,"useLayerTypeIcon",3,!1),o=!!(e.node.children&&e.node.children.length),f=!o;let g=T(!1),u=T(!1),d=T("");function p(){return!e.node.children||!e.getNodeVisibility?!1:e.node.children.some(h=>{const C=e.getNodeVisibility(h.id);return C!==void 0?C:h instanceof de?h.layer.visible:!1})}ce(()=>{if(!(!e.node||!(e.node instanceof de))){if(o)w(u,p(),!0);else{const h=e.getNodeVisibility?e.getNodeVisibility(e.node.id):void 0;w(u,h!==void 0?h:e.node.layer.visible,!0)}w(d,Jt(e.node.layer,a(),o,r(g)),!0)}});function m(){!f||!e.onNodeVisibilityChange||o||(w(u,!r(u)),e.onNodeVisibilityChange(e.node,r(u)))}function c(){o||m(),e.onNodeClick?.(e.node)}function l(){w(g,!r(g)),e.onNodeClick?.(e.node)}{let h=z(()=>o?e.node.children:null);Qt(s,{get isOpen(){return r(g)},get content(){return t},get childNodes(){return r(h)},get childNode(){return i}})}ee()}function Xn(s,e){Q(e,!0);const t=X(e,"webMap",3,null);ce(()=>{!t()||e.treeviewStore.initialized||e.treeviewStore.initialize(t().layers.toArray(),e.treeviewConfigStore)});var i=E(),n=I(i);{var a=o=>{var f=E(),g=I(f);K(g,()=>Zt,(u,d)=>{d(u,{children:(p,m)=>{var c=E(),l=I(c);ke(l,17,()=>e.treeviewStore.getNodes(),h=>h.id,(h,C)=>{tr(h,{get treeviewConfigStore(){return e.treeviewConfigStore},get node(){return r(C)},onNodeClick:()=>{},onNodeVisibilityChange:(x,k)=>e.treeviewStore.setVisibilityState(x.id,k),getNodeVisibility:x=>e.treeviewStore.getVisibilityState(x),depth:0,useLayerTypeIcon:!0})}),v(p,c)},$$slots:{default:!0}})}),v(o,f)};U(n,o=>{e.treeviewStore.initialized&&o(a)})}v(s,i),ee()}class $n{configStore;constructor(e){this.configStore=e}}function Kn(s){return s.replace(/&deg;/gi,"Â°").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&lt;/gi,"<").replace(/&gt;/gi,">")}class Jn extends $n{id="aliasPath";layerToNode(e,t){const i=new de(e.id,e.title,e,[],t),n=this.configStore.getItemConfig(e.id);if(this.#r(e)&&n?.showFields){const a=e;a.loaded||console.warn(`Layer not loaded: ${e.id}`);const o=new Map;for(const f of a.fields??[]){const g=this.configStore.getItemConfig(this.#t(e.id,f.name));!g||g.isHidden||this.#e(f,i,o)}i.children.sort((f,g)=>f.children.length>0&&g.children.length===0?1:f.children.length===0&&g.children.length>0?-1:0)}return i}#e(e,t,i=new Map){const n=this.#t(t.id,e.name),o=Kn(e.alias||"")?.split("|").map(m=>m.trim()).filter(Boolean)??[];if(o.length===0){const m=new Ze(n,e.alias||e.name,t.layer,e,[],t);return t.children.push(m),m}const f=o.slice(0,-1),g=o[o.length-1];let u=t;const d=(m,c)=>{m.children??=[],m.children.includes(c)||m.children.push(c)};for(let m=0;m<f.length;m++){const c=f[m],l=o.slice(0,m+1).join("::"),h=`${t.id}::${l}`;let C=i.get(h);C||(C=new $t(h,c,[],u),i.set(h,C),d(u,C)),u=C}const p=new Ze(n,g||e.name,t.layer,e,[],u);return d(u,p),p}#t(e,t){return`${e}-${t}`}#r(e){return e.type==="feature"}}var Qn=N('<div data-slot="checkbox-indicator" class="text-current transition-none"><!></div>');function ea(s,e){Q(e,!0);let t=X(e,"ref",15,null),i=X(e,"checked",11,!1),n=X(e,"indeterminate",11,!1),a=Ae(e,["$$slots","$$events","$$legacy","ref","checked","indeterminate","class"]),o=T(ie(i())),f=T(ie(n()));ce(()=>{w(o,i())}),ce(()=>{w(f,n())});var g=E(),u=I(g);{const d=(m,c)=>{let l=()=>c?.().checked,h=()=>c?.().indeterminate;var C=Qn(),x=S(C);{var k=y=>{Li(y,{class:"size-3.5"})},b=y=>{var F=E(),A=I(F);{var W=R=>{ai(R,{class:"size-3.5"})};U(A,R=>{h()&&R(W)},!0)}v(y,F)};U(x,y=>{l()?y(k):y(b,!1)})}_(C),v(m,C)};let p=z(()=>jr("peer flex size-4 shrink-0 items-center justify-center rounded-[4px] border border-input shadow-xs transition-shadow outline-none focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50 disabled:cursor-not-allowed disabled:opacity-50 aria-invalid:border-destructive aria-invalid:ring-destructive/20 data-[state=checked]:border-primary data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:bg-input/30 dark:aria-invalid:ring-destructive/40 dark:data-[state=checked]:bg-primary",e.class));K(u,()=>ni,(m,c)=>{c(m,xe({"data-slot":"checkbox",get class(){return r(p)}},()=>a,{get ref(){return t()},set ref(l){t(l)},get checked(){return r(o)},set checked(l){w(o,l,!0)},get indeterminate(){return r(f)},set indeterminate(l){w(f,l,!0)},children:d,$$slots:{default:!0}}))})}v(s,g),ee()}var ta=N("<div><!></div>");function Bt(s,e){Q(e,!0);let t=z(()=>e.getDownloadState?.(e.node)??re.Inactive),i=z(()=>r(t)===re.Active),n=z(()=>r(t)===re.Indeterminate);function a(g){g.stopPropagation();const u=r(t)===re.Active?re.Inactive:re.Active;e.onDownloadStateChanged?.(e.node,u)}var o=ta(),f=S(o);ea(f,{get checked(){return r(i)},get indeterminate(){return r(n)},onclick:a}),_(o),v(s,o),ee()}var ra=N('<button><div class="flex w-full items-center justify-between gap-2"><div class="pointer-events-none flex min-w-0 flex-1 items-center gap-1"><!> <span class="inline-block size-4" aria-hidden="true"><!></span> <span class="block w-full text-left break-words"> </span></div> <!></div></button>');function Ut(s,e){Q(e,!0);const t=X(e,"isFolder",3,!1),i=X(e,"isOpen",3,!1),n=`calc(100% - ${e.depth*1}rem)`;var a=ra();a.__click=function(...h){e.onclick?.apply(this,h)};var o=S(a),f=S(o),g=S(f);{var u=h=>{Yt(h,{get isOpen(){return i()}})};U(g,h=>{t()&&h(u)})}var d=M(g,2),p=S(d);Je(p,()=>e.icon),_(d);var m=M(d,2),c=S(m,!0);_(m),_(f);var l=M(f,2);se(l,()=>e.children??ae),_(o),_(a),oe(h=>{Fe(a,1,h),Oe(a,`width: ${n};`),he(c,e.name)},[()=>xr(qn({enhancedHover:!0,includeFont:!0}))]),v(s,a),ee()}ht(["click"]);var ia=N('<div class="flex items-center gap-2"><!> <!></div>'),na=N('<div class="flex items-center gap-2"><!> <!></div>');function rr(s,e){Q(e,!0);const t=x=>{var k=E(),b=I(k);{var y=F=>{var A=E(),W=I(A);{var R=$=>{Ut($,{get icon(){return r(p)},get name(){return e.node.name},get depth(){return a()},onclick:C,get isFolder(){return f},get isOpen(){return r(u)},children:L=>{var P=ia(),Z=S(P);{var G=Y=>{Bt(Y,{get node(){return e.node},get onDownloadStateChanged(){return e.onDownloadStateChanged},get getDownloadState(){return e.getDownloadState}})};U(Z,Y=>{e.isDownloadable&&Y(G)})}var D=M(Z,2);{var j=Y=>{Ft(Y,{get checked(){return r(d)},onCheckedChange:l})};U(D,Y=>{g&&Y(j)})}_(P),v(L,P)},$$slots:{default:!0}})},q=$=>{Ut($,{get icon(){return r(p)},get name(){return e.node.name},get depth(){return a()},onclick:h,get isFolder(){return f},children:L=>{var P=na(),Z=S(P);{var G=Y=>{Bt(Y,{get node(){return e.node},get onDownloadStateChanged(){return e.onDownloadStateChanged},get getDownloadState(){return e.getDownloadState}})};U(Z,Y=>{e.isDownloadable&&Y(G)})}var D=M(Z,2);{var j=Y=>{Ft(Y,{get checked(){return r(d)},onCheckedChange:l})};U(D,Y=>{g&&Y(j)})}_(P),v(L,P)},$$slots:{default:!0}})};U(W,$=>{f?$(R):$(q,!1)})}v(F,A)};U(b,F=>{n()?.getItemConfig(e.node.id)?.isHidden||F(y)})}v(x,k)},i=(x,k=ae)=>{var b=E(),y=I(b);{var F=A=>{{let W=z(()=>n()?.getItemConfig(k().id)?.isDownloadable??!0),R=z(()=>a()+1);rr(A,{get treeviewConfigStore(){return n()},get node(){return k()},get isDownloadable(){return r(W)},get onNodeClick(){return e.onNodeClick},get onNodeVisibilityChange(){return e.onNodeVisibilityChange},get onDownloadStateChanged(){return e.onDownloadStateChanged},get getDownloadState(){return e.getDownloadState},get onFilterClicked(){return e.onFilterClicked},get hasFiltersApplied(){return e.hasFiltersApplied},get getNodeVisibility(){return e.getNodeVisibility},get depth(){return r(R)},get useLayerTypeIcon(){return o()}})}};U(y,A=>{f&&r(u)&&!n()?.getItemConfig(k().id)?.isHidden&&A(F)})}v(x,b)},n=X(e,"treeviewConfigStore",3,null),a=X(e,"depth",3,0),o=X(e,"useLayerTypeIcon",3,!1),f=!!(e.node.children&&e.node.children.length),g=!f;let u=T(!1),d=T(!1),p=T(""),m=T(!1),c=T(!1);ce(()=>{if(!e.node)return;const x=e.getNodeVisibility?e.getNodeVisibility(e.node.id):!1;w(d,x??!1,!0),e.node instanceof de&&w(p,Jt(e.node.layer,o(),f,r(u)),!0)}),ce(()=>{if(!(e.node instanceof de))return;const x=(e.getDownloadState?.(e.node)===re.Active&&e.node.layer.type==="feature")??!1;x&&!r(m)?(w(m,!0),w(c,!1)):!x&&r(m)&&(w(c,!0),setTimeout(()=>{w(m,!1),w(c,!1)},180))});function l(){!g||!e.onNodeVisibilityChange||(w(d,!r(d)),e.onNodeVisibilityChange(e.node,r(d)))}function h(){e.onNodeClick?.(e.node)}function C(){w(u,!r(u)),e.onNodeClick?.(e.node)}{let x=z(()=>f?e.node.children:null);Qt(s,{get isOpen(){return r(u)},get content(){return t},get childNodes(){return r(x)},get childNode(){return i}})}ee()}function aa(s,e){Q(e,!0);const t=X(e,"webMap",3,null),i=X(e,"fieldFilterMenuStore",7),n=new Kt;ce(()=>{if(!t()||n.initialized)return;(async()=>{await t().when(),await a(t().layers.toArray());const l=new Jn(e.treeviewConfigStore);n.initialize(t().layers.toArray(),e.treeviewConfigStore,[l])})()});async function a(c){for(const l of c)l.type==="feature"&&!l.loaded&&(await l.load(),console.log("Loaded feature layer:",l.title)),l.type==="group"&&await a(l.layers.toArray())}function o(c,l){pe.updateSelection(c,l)}function f(c){return pe.getSelectionState(c)}function g(c){if(i().ActiveLayer?.uid===c){i().ActiveLayer=null;return}const h=n.getNodeById(c);!h||!(h instanceof de)||(i().ActiveLayer=h.layer)}function u(c){const l=pe.DataSelections.get(c);if(!l?.fields)return!1;const h=n.getNodeById(c);if(!h||!(h instanceof de))return!1;const C=h.layer.fields?.length||0,x=l.fields.size;return x>0&&x!==C}var d=E(),p=I(d);{var m=c=>{var l=E(),h=I(l);K(h,()=>Zt,(C,x)=>{x(C,{children:(k,b)=>{var y=E(),F=I(y);ke(F,17,()=>n.getNodes(),A=>A.id,(A,W)=>{{let R=z(()=>e.treeviewConfigStore.getItemConfig(r(W).id)?.isDownloadable??!0);rr(A,{get treeviewConfigStore(){return e.treeviewConfigStore},get node(){return r(W)},get isDownloadable(){return r(R)},onNodeClick:()=>{},onNodeVisibilityChange:(q,$)=>n.setVisibilityState(q.id,$),getNodeVisibility:q=>n.getVisibilityState(q),onDownloadStateChanged:o,getDownloadState:f,onFilterClicked:g,hasFiltersApplied:u,depth:0,useLayerTypeIcon:!0})}}),v(k,y)},$$slots:{default:!0}})}),v(c,l)};U(p,c=>{n.initialized&&c(m)})}v(s,d),ee()}class oa{#e=T(null);get mapView(){return r(this.#e)}set mapView(e){w(this.#e,e,!0)}#t=T(ie(new Set));get interactableLayers(){return r(this.#t)}set interactableLayers(e){w(this.#t,e,!0)}pointerMoveHandle=null;clickHandle=null;leaveHandle=null;enterHandle=null;#r=T(!1);get isInitialized(){return r(this.#r)}set isInitialized(e){w(this.#r,e,!0)}#n=T(!0);get pointerInsideMap(){return r(this.#n)}set pointerInsideMap(e){w(this.#n,e,!0)}initializationInProgress=!1;async initializeAsync(e,t){if(console.log("[map-interaction-store] Initializing with MapView"),this.mapView===e&&this.isInitialized){console.log("[map-interaction-store] MapView is already initialized"),this.interactableLayers=t;return}if(this.initializationInProgress){console.log("[map-interaction-store] Initialization already in progress");return}this.initializationInProgress=!0,console.log("[map-interaction-store] Cleaning up previous MapView if any"),this.cleanup(),this.mapView=e,this.interactableLayers=t,await e.when(),this.setupHighlights(e),this.setupPointerMoveHandler(e),this.setupClickHandler(e),this.setupLeaveHandler(e),this.setupEnterHandler(e),this.isInitialized=!0,console.log("[map-interaction-store] Initialized with MapView"),this.initializationInProgress=!1}updateInteractableLayers(e){this.interactableLayers=e}setupHighlights(e){const t={name:"hover",color:"lightgreen",haloOpacity:1,fillOpacity:.2},i={name:"selected",color:"green",haloOpacity:1,fillOpacity:.3};e.highlights.push(t),e.highlights.push(i)}setupPointerMoveHandler(e){this.pointerMoveHandle=e.on("pointer-move",async t=>{if(!this.pointerInsideMap)return;const{results:i}=await e.hitTest(t),n=i[0];if(!n){this.clearHoverHighlight();return}const a=n.graphic,o=a.layer;if(!a||!o||!this.isLayerInteractable(o.id)||a.attributes?.[o.objectIdField]===void 0){this.clearHoverHighlight();return}const f=a.attributes?.[o.objectIdField];if(!(J.currentHoveredArea&&J.currentHoveredArea.id===f))try{const g=await e.whenLayerView(o);J.layerHighlightState.featureLayerView!==g&&J.setSelectedLayerView(g),this.clearHoverHighlight();const u=g;if(!u){console.warn("LayerView is not a FeatureLayerView");return}if(!this.pointerInsideMap)return;const d=u.highlight(a,{name:"hover"});J.setHoveredArea(f,d)}catch(g){console.error("Error in pointer-move handler:",g),this.clearHoverHighlight()}})}setupClickHandler(e){this.clickHandle=e.on("click",async t=>{const{results:i}=await e.hitTest(t),n=i[0];if(!n)return;const a=n.graphic,o=a.layer;if(!a||!o||!this.isLayerInteractable(o.id)||a.attributes?.[o.objectIdField]===void 0)return;const f=a.attributes?.[o.objectIdField];try{const g=await e.whenLayerView(o),u=g;if(!u){console.warn("Layer is not a FeatureLayerView");return}J.layerHighlightState.featureLayerView!==g&&J.setSelectedLayerView(g);const p=(J.layerHighlightState.areaInfos||[]).find(m=>m.id===f);if(p)J.removeSelectedArea(p.id);else{const m=u.highlight(a,{name:"selected"});J.addSelectedArea(f,m)}}catch(g){console.error("Error in click handler:",g)}})}setupLeaveHandler(e){this.leaveHandle=e.on("pointer-leave",()=>{this.pointerInsideMap=!1,this.clearHoverHighlight()})}setupEnterHandler(e){this.enterHandle=e.on("pointer-enter",()=>{this.pointerInsideMap=!0})}isLayerInteractable(e){return this.interactableLayers.has(e)}clearHoverHighlight(){J.currentHoveredArea&&J.clearHoveredArea()}cleanup(){this.pointerMoveHandle&&(this.pointerMoveHandle.remove(),this.pointerMoveHandle=null),this.clickHandle&&(this.clickHandle.remove(),this.clickHandle=null),this.leaveHandle&&(this.leaveHandle.remove(),this.leaveHandle=null),this.enterHandle&&(this.enterHandle.remove(),this.enterHandle=null),this.clearHoverHighlight(),this.isInitialized=!1,this.mapView=null,this.pointerInsideMap=!0,this.interactableLayers=new Set,console.log("[map-interaction-store] Cleaned up")}get currentMapView(){return this.mapView}get initialized(){return this.isInitialized}}const dt=new oa;var sa=N('<div class="esri-ui-element svelte-i0p9uk"><!></div>'),la=N('<div class="esri-ui-element svelte-i0p9uk"><!></div>'),da=N('<div class="map-view svelte-i0p9uk"></div> <!> <!>',1);function ca(s,e){Q(e,!0);const t=X(e,"webMap",3,null),i=X(e,"panelPosition",3,"top-left"),n=X(e,"menuPosition",3,"top-right");let a=null,o=T(null),f=T(null),g=T(null),u=T(!1);const d="streets-vector";let p,m;qe(async()=>{await c(),await k()});async function c(){if(!m){const[{default:L},{default:P},{default:Z},{default:G}]=await Promise.all([Pe(()=>import("../chunks/Bo-Ws7j2.js").then(D=>D.M),__vite__mapDeps([7,1,2,3,8,4,5,6,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38]),import.meta.url),Pe(()=>import("../chunks/CISklr1W.js").then(D=>D.a3),__vite__mapDeps([144,1,2,3,4,39,25,5,6,23,40,41,42,43,9,10,11,12,44,24,21,22,45,46,47,48,13,14,49,50,51,26,90,91,18,33,145,146,147,27,148,149,16,150,7,8,15,17,19,20,28,29,30,31,32,34,35,36,37,38,151,65,56,152,70,61,153,154,155,156,157,158,159,160,59,60,161,162,163,164,165,166,167,168,169,170,171]),import.meta.url),Pe(()=>import("../chunks/huXfT4GN.js").then(D=>D.W),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143]),import.meta.url),Pe(()=>import("../chunks/NPoLgU3x.js"),__vite__mapDeps([62,4,1,2,3,43,25,5,6,23,9,10,11,12,44,24,21,22,52,63,64,61,65,66,67,68,38,14,56,69,16,27,70,41,42,45,46,47,48,13,49,50,20,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,53,33,90,91,18,92,93,94,95,96,97,98,99,34,35,36,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,51,116,117,118,119,120,121,122,123,124,125,126,29,127,128,129,17,130,131,132,55,133,134,135,136,137,138,139,140,54]),import.meta.url)]);p=L,m=P}}async function l(L,P){const Z=new m({container:P,popupEnabled:!1,map:L});return await Z.when(),Z}function h(L){L.ui.move("zoom","top-right"),r(f)&&i()&&L.ui.add(r(f),i()),r(g)&&n()&&L.ui.add(r(g),n()),w(u,!0)}async function C(){return new p({basemap:d})}async function x(){if(t())try{if(await c(),await k(),!r(o)){console.error("MapView is not initialized");return}r(o).map=t(),console.log("[uprn-map-view] MapView updated with new webMap")}catch(L){console.error("Error updating MapView with new webMap:",L)}}async function k(){if(!a){console.error("Map container element was not found");return}try{w(o,await l(t()??void 0,a),!0),h(r(o)),console.log("[uprn-map-view] Map loaded successfully")}catch(L){console.error("Error loading map:",L),await b()}}async function b(){try{const L=await C();w(o,await l(L,a),!0),h(r(o)),console.log("[uprn-map-view] Fallback map loaded")}catch(L){console.error("Error loading fallback map:",L)}}ce(()=>{t()&&x()}),ce(()=>{if(!r(o)||!e.areaSelectionTreeviewStore.initialized)return;const L=e.areaSelectionTreeviewStore.getNonHiddenNodes().map(P=>P.id);dt.initialized?dt.updateInteractableLayers(new Set(L)):dt.initializeAsync(r(o),new Set(L))}),ce(()=>{if(!e.areaSelectionTreeviewStore.initialized)return;if(!e.areaSelectionTreeviewStore.getVisibleNodes().length){J.resetSelectedAreas();return}const L=e.areaSelectionTreeviewStore.getVisibleNodes()[0];if(!L||!(L instanceof de)){console.warn("Visible node is not a FeatureLayer");return}if(!L.layer){console.warn("Visible node layer is not a FeatureLayer");return}y(L.layer)});async function y(L){if(!r(o))return;const P=await r(o).whenLayerView(L);if(!P){console.warn("Could not get LayerView for the visible node layer");return}J.setSelectedLayerView(P)}function F(){dt.cleanup(),r(o)&&r(o).destroy()}lr(()=>{F()});var A=da(),W=I(A);Ie(W,L=>a=L,()=>a);var R=M(W,2);{var q=L=>{var P=sa(),Z=S(P);{var G=D=>{var j=E(),Y=I(j);se(Y,()=>e.panel),v(D,j)};U(Z,D=>{r(u)&&D(G)})}_(P),Ie(P,D=>w(f,D),()=>r(f)),v(L,P)};U(R,L=>{e.panel&&L(q)})}var $=M(R,2);{var V=L=>{var P=la(),Z=S(P);{var G=D=>{var j=E(),Y=I(j);se(Y,()=>e.menu),v(D,j)};U(Z,D=>{r(u)&&D(G)})}_(P),Ie(P,D=>w(g,D),()=>r(g)),v(L,P)};U($,L=>{e.menu&&L(V)})}v(s,A),ee()}var ua=N('<div class="min-w-0 space-y-2 overflow-hidden p-4"><!></div>'),fa=N("<!> <!>",1);function ct(s,e){var t=E(),i=I(t);K(i,()=>oi,(n,a)=>{a(n,{get value(){return e.value},class:"flex min-h-0 flex-1 flex-col",children:(o,f)=>{var g=fa(),u=I(g);K(u,()=>Lt,(m,c)=>{c(m,{class:"card-content flex min-h-0 flex-1 flex-col overflow-hidden p-0",children:(l,h)=>{Fr(l,{class:"h-full w-full",children:(C,x)=>{var k=ua(),b=S(k);se(b,()=>e.children??ae),_(k),v(C,k)},$$slots:{default:!0}})},$$slots:{default:!0}})});var d=M(u,2);{var p=m=>{var c=E(),l=I(c);K(l,()=>Pr,(h,C)=>{C(h,{class:"flex flex-shrink-0 items-center justify-between",children:(x,k)=>{var b=E(),y=I(b);se(y,()=>e.footer),v(x,b)},$$slots:{default:!0}})}),v(m,c)};U(d,m=>{e.footer&&m(p)})}v(o,g)},$$slots:{default:!0}})}),v(s,t)}var ha=N("<!> <!>",1),va=N('<div class="tab-list-wrapper flex-shrink-0 svelte-rohqkk"><!></div> <!>',1);function ga(s,e){Q(e,!0);const t=X(e,"triggers",19,()=>[]);var i=E(),n=I(i);K(n,()=>di,(a,o)=>{o(a,{get value(){return e.value},get onValueChange(){return e.onValueChange},class:"flex h-full w-full flex-col",children:(f,g)=>{var u=va(),d=I(u),p=S(d);K(p,()=>si,(c,l)=>{l(c,{class:"tab-list",children:(h,C)=>{var x=E(),k=I(x);ke(k,17,t,Ye,(b,y,F,A)=>{let W=()=>r(y).value,R=()=>r(y).label;var q=ha(),$=I(q);K($,()=>li,(P,Z)=>{Z(P,{get value(){return W()},class:"tab-trigger",children:(G,D)=>{Ve();var j=Ge();oe(()=>he(j,R())),v(G,j)},$$slots:{default:!0}})});var V=M($,2);{var L=P=>{Or(P,{class:"separator"})};U(V,P=>{W()!==t()[t().length-1]?.value&&P(L)})}v(b,q)}),v(h,x)},$$slots:{default:!0}})}),_(d);var m=M(d,2);se(m,()=>e.children??ae),v(f,u)},$$slots:{default:!0}})}),v(s,i),ee()}const O=Object.freeze({LEFT:"left",RIGHT:"right",TOP:"top",BOTTOM:"bottom"});var ma=N("<!> <div><aside><div><div><!></div></div></aside></div> <!>",1);function ir(s,e){Q(e,!0);const t=X(e,"position",19,()=>O.LEFT),i=X(e,"openIcon",3,Ti),n=X(e,"overlay",3,!1),a=8,o="500px",f="calc(var(--header-height, 64px) + 1rem)";let g,u=T(0),d=T(ie(e.originalSize??o)),p=T(!1),m=T(!1);const c=z(()=>t()===O.LEFT||t()===O.RIGHT),l=z(()=>t()===O.LEFT||t()===O.TOP),h=z(()=>r(c)?"500px":"100px"),C=z(()=>e.minSize??r(h)),x=z(()=>parseFloat(r(C))),k=z(()=>r(c)?"width":"height"),b=z(()=>r(c)?"ew-resize":"ns-resize");ce(()=>{r(m)||(w(d,e.originalSize??r(C),!0),console.log("Sidebar size updated due to minSize/originalSize change:",r(d),e.originalSize))}),qe(()=>{if(!g)return;const H=new ResizeObserver(B=>{for(const te of B)w(u,r(c)?te.contentRect.width:te.contentRect.height,!0)});return H.observe(g),()=>H.disconnect()});function y(H){if(!e.isOpen)return;w(p,!0),H.preventDefault();const B=r(c)?H.clientX:H.clientY,te=parseFloat(r(d));function Se(Le){const ze=r(c)?Le.clientX:Le.clientY,Be=r(l)?ze-B:B-ze,rt=Math.max(r(x),te+Be);w(d,`${rt}px`),w(m,!0)}function me(){w(p,!1),document.removeEventListener("mousemove",Se),document.removeEventListener("mouseup",me),document.body.style.cursor="",document.body.style.userSelect=""}document.addEventListener("mousemove",Se),document.addEventListener("mouseup",me),document.body.style.cursor=r(b),document.body.style.userSelect="none"}const F=z(()=>()=>{const H=e.isOpen?r(d):"0px";return n()?{[O.LEFT]:{top:"1rem",left:H},[O.RIGHT]:{top:"1rem",right:H},[O.TOP]:{top:H,left:"1rem"},[O.BOTTOM]:{bottom:H,left:"1rem"}}[t()]:{[O.LEFT]:{top:f,left:H},[O.RIGHT]:{top:f,right:H},[O.TOP]:{top:H,left:"1rem"},[O.BOTTOM]:{bottom:H,left:"1rem"}}[t()]}),A=z(()=>()=>({[O.LEFT]:"rounded-l-none rounded-r-md",[O.RIGHT]:"rounded-r-none rounded-l-md",[O.TOP]:"rounded-t-none rounded-b-md",[O.BOTTOM]:"rounded-b-none rounded-t-md"})[t()]),W=z(()=>()=>!n()&&e.isOpen?"":{[O.LEFT]:"box-shadow: 4px 0 8px -2px rgb(0 0 0 / 0.1), 2px 0 4px -2px rgb(0 0 0 / 0.1);",[O.RIGHT]:"box-shadow: -4px 0 8px -2px rgb(0 0 0 / 0.1), -2px 0 4px -2px rgb(0 0 0 / 0.1);",[O.TOP]:"box-shadow: 0 4px 8px -2px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);",[O.BOTTOM]:"box-shadow: 0 -4px 8px -2px rgb(0 0 0 / 0.1), 0 -2px 4px -2px rgb(0 0 0 / 0.1);"}[t()]),R=z(()=>()=>({[O.LEFT]:Ii,[O.RIGHT]:ci,[O.TOP]:xi,[O.BOTTOM]:Ci})[t()]),q=z(()=>()=>({[O.LEFT]:`padding-right: ${a}px`,[O.RIGHT]:`padding-left: ${a}px`,[O.TOP]:`padding-bottom: ${a}px`,[O.BOTTOM]:`padding-top: ${a}px`})[t()]),$=z(()=>()=>{if(!e.isOpen)return{};const H=`${a}px`,B=e.isOpen?`calc(${r(d)} + ${-a/2}px)`:"0px";return n()?{[O.LEFT]:{left:B,top:"0",width:H,height:"100%"},[O.RIGHT]:{right:B,top:"0",width:H,height:"100%"},[O.TOP]:{top:B,left:"0",height:H,width:"100%"},[O.BOTTOM]:{bottom:B,left:"0",height:H,width:"100%"}}[t()]:{[O.LEFT]:{left:B,top:"0",width:H,height:"100%"},[O.RIGHT]:{right:B,top:"0",width:H,height:"100%"},[O.TOP]:{top:B,left:"0",height:H,width:"100%"},[O.BOTTOM]:{bottom:B,left:"0",height:H,width:"100%"}}[t()]});function V(H){return Object.entries(H).map(([B,te])=>`${B}: ${te}`).join("; ")}const L=z(()=>r(l)?0:1),P=z(()=>()=>e.isOpen?"translate(0, 0)":{[O.LEFT]:`translate(-${r(d)}, 0)`,[O.RIGHT]:`translate(${r(d)}, 0)`,[O.TOP]:`translate(0, -${r(d)})`,[O.BOTTOM]:`translate(0, ${r(d)})`}[t()]),Z=z(()=>()=>{const H=e.isOpen?r(d):"0px";if(n()){if(r(c)){const te={position:"absolute",top:"0",bottom:"0",width:H,height:"100%","z-index":"30"};return te[t()===O.LEFT?"left":"right"]="0",te}const B={position:"absolute",left:"0",right:"0",height:H,width:"100%","z-index":"30"};return B[t()===O.TOP?"top":"bottom"]="0",B}return{[r(k)]:H,order:`${r(L)}`}});var G=ma(),D=I(G);{let H=z(()=>n()?"absolute":"fixed"),B=z(()=>r(A)()),te=z(()=>r(p)?"":"transition-all duration-300"),Se=z(()=>V(r(F)())),me=z(()=>r(W)()),Le=z(()=>r(p)?"transition: none !important;":""),ze=z(()=>e.isOpen?"Close sidebar":"Open sidebar");Ce(D,{get onclick(){return e.onToggle},variant:"default",size:"icon",get class(){return`${r(H)??""} z-[40] !bg-background hover:scale-105 hover:!bg-background/90 ${r(B)??""} ${r(te)??""}`},get style(){return`${r(Se)??""}; pointer-events: auto; ${r(me)??""} ${r(Le)??""}`},get"aria-label"(){return r(ze)},get"aria-expanded"(){return e.isOpen},children:(Be,rt)=>{var Ue=E(),be=I(Ue);{var it=Ne=>{const Xe=z(()=>r(R)());var De=E(),nt=I(De);K(nt,()=>r(Xe),(Re,je)=>{je(Re,{class:"h-6 w-6 text-primary"})}),v(Ne,De)},gt=Ne=>{const Xe=z(i);var De=E(),nt=I(De);K(nt,()=>r(Xe),(Re,je)=>{je(Re,{class:"h-6 w-6 text-primary"})}),v(Ne,De)};U(be,Ne=>{e.isOpen?Ne(it):Ne(gt,!1)})}v(Be,Ue)},$$slots:{default:!0}})}var j=M(D,2);let Y;var le=S(j);let fe;var ne=S(le);let ge;var ue=S(ne);let Te;var we=S(ue);{var ye=H=>{var B=E(),te=I(B);se(te,()=>e.children),v(H,B)};U(we,H=>{e.children&&H(ye)})}_(ue),_(ne),_(le),Ie(le,H=>g=H,()=>g),_(j);var ve=M(j,2);{var _e=H=>{{let B=z(()=>n()?"absolute":"fixed"),te=z(()=>r(c)?"cursor-ew-resize":"cursor-ns-resize"),Se=z(()=>r(p)?"":"transition-all duration-300"),me=z(()=>V(r($)()));Ce(H,{get class(){return`${r(B)??""} z-50 border-0 bg-transparent p-0 ring-0 transition-colors outline-none hover:!bg-primary/50 focus-visible:ring-0 ${r(te)??""} ${r(Se)??""}`},onmousedown:y,"aria-label":"Resize sidebar by dragging",get style(){return`${r(me)??""}; outline: none !important; box-shadow: none !important; border: none !important;`}})}};U(ve,H=>{e.isOpen&&H(_e)})}oe((H,B,te,Se,me,Le,ze)=>{Y=Fe(j,1,"relative",null,Y,H),Oe(j,B),fe=Fe(le,1,`relative flex bg-card text-card-foreground ${n()?"shadow-2xl":"shadow-lg"}`,null,fe,te),Oe(le,`${r(k)??""}: ${r(d)??""}; transform: ${Se??""};`),ge=Fe(ne,1,"flex overflow-hidden",null,ge,me),Oe(ne,Le),Te=Fe(ue,1,"flex overflow-hidden",null,Te,ze)},[()=>({"overflow-hidden":!n(),"overflow-visible":n(),"h-full":r(c),"w-full":!r(c),"transition-all":!r(p),"duration-300":!r(p),"z-30":n()}),()=>V(r(Z)()),()=>({"flex-col":r(c),"flex-row":!r(c),"h-full":r(c),"w-full":!r(c),"border-r":t()===O.LEFT,"border-l":t()===O.RIGHT,"border-b":t()===O.TOP,"border-t":t()===O.BOTTOM,"border-sidebar-border":!0,"transition-transform":!r(p),"duration-300":!r(p),"pointer-events-auto":n(),"z-30":n()}),()=>r(P)(),()=>({"flex-col":r(c),"flex-row":!r(c),"h-full":r(c),"w-full":!r(c)}),()=>r(q)(),()=>({"flex-col":r(c),"flex-row":!r(c),"h-full":r(c),"w-full":!r(c)})]),v(s,G),ee()}var pa=N('<div><!> <div class="main-content svelte-1drp0rm"><!></div></div>');function ya(s,e){Q(e,!0);const t=X(e,"position",19,()=>O.LEFT),i=z(()=>t()===O.TOP||t()===O.BOTTOM);var n=pa();let a;var o=S(n);ir(o,{get isOpen(){return e.isOpen},get onToggle(){return e.onToggle},get position(){return t()},get originalSize(){return e.originalSize},get minSize(){return e.minSize},get openIcon(){return e.openIcon},children:(d,p)=>{var m=E(),c=I(m);{var l=h=>{var C=E(),x=I(C);se(x,()=>e.sidebarContent),v(h,C)};U(c,h=>{e.sidebarContent&&h(l)})}v(d,m)},$$slots:{default:!0}});var f=M(o,2),g=S(f);{var u=d=>{var p=E(),m=I(p);se(m,()=>e.mainContent),v(d,p)};U(g,d=>{e.mainContent&&d(u)})}_(f),_(n),oe(d=>a=Fe(n,1,"sidebar-layout svelte-1drp0rm",null,a,d),[()=>({vertical:r(i)})]),v(s,n),ee()}class jt{#e=[];#t=new Map;#r=[];#n=new Map;#i=[];#o=new Map;#c=new Set;constructor(e){if(!e)throw new Error("TreeviewConfigStore requires a valid configuration object.");this.#e=e.items??[],this.#t=new Map(this.#e.map(t=>[t.id,t])),this.#r=e.visibilityGroups??[],this.#n=new Map(this.#r.map(t=>[t.id,t])),this.#i=e.inheritanceGroups??[],this.#o=new Map(this.#i.map(t=>[t.id,t])),e.fieldsToHide&&(this.#c=new Set(e.fieldsToHide.map(t=>t.trim().toLowerCase())))}getItemConfig(e){return this.#t.get(e)}getVisibilityGroupConfig(e){return this.#n.get(e)}getInheritanceGroupConfig(e){return this.#o.get(e)}resolveInheritance(e){if(!(e.length===0||!this.#e||this.#e.length===0))for(const t of e){const i=this.getItemConfig(t.id);this.#u(t,i)}}#u(e,t){const i=this.#s(e,t);if(this.#p(e)&&i.showFields){const n=e;n.loaded||console.warn(`Layer not loaded: ${e.id}`);for(const a of n.fields??[])this.#f(this.#v(e.id,a.name),a.alias||a.name,i)}if(this.#g(e)){const n=e;for(const a of n.layers.toArray())this.#u(a,i)}}#s(e,t){const i=this.#h(e.id,t);return i.type===st.None&&(i.type=ui(e)),i}#f(e,t,i){const n=this.#h(e,i);return n.type===st.None&&(n.type=st.Field),this.#c.has(t.trim().toLowerCase())&&(n.isHidden=!0),n}#h(e,t){let i=this.getItemConfig(e);const n=i?.inheritanceGroupId?this.getInheritanceGroupConfig(i.inheritanceGroupId):this.getInheritanceGroupConfig(t?.inheritanceGroupId??"");return i={id:e,type:st.None,isDownloadable:this.#a(n,"isDownloadable",i,t,!0),isVisibleOnInit:this.#a(n,"isVisibleOnInit",i,t,!1),isHidden:this.#a(n,"isHidden",i,t,!1),showFields:this.#a(n,"showFields",i,t,!1),visibilityDependencyIds:this.#a(n,"visibilityDependencyIds",i,t,[]),visibilityGroupId:this.#a(n,"visibilityGroupId",i,t,void 0),customConverterId:this.#a(n,"customConverterId",i,t,void 0),inheritanceGroupId:this.#a(n,"inheritanceGroupId",i,t,void 0)},this.#l(i),this.#m(i),i}#a(e,t,i,n,a){const o=i?.[t];return o!==void 0?o:e?.inheritedProperties.includes(t)&&n?n[t]??a:a}#m(e){if(this.#t.has(e.id))throw new Error(`Item with id ${e.id} already exists.`);this.#e.push(e),this.#t.set(e.id,e)}#l(e){this.#t.has(e.id)&&(this.#e=this.#e.filter(t=>t.id!==e.id),this.#t.delete(e.id))}#v(e,t){return`${e}-${t}`}#g(e){return e.type==="group"}#p(e){return e.type==="feature"}}const ba=[{value:"define-areas",label:"Define Areas"},{value:"select-data",label:"Select Data"},{value:"export",label:"Export"},{value:"downloads",label:"Download"}];var wa=N("<!> <!> <!> <!>",1),_a=N('<div class="relative flex h-full w-full min-w-0 overflow-visible"><div class="flex h-full w-full min-w-0 flex-col overflow-hidden"><!></div> <!></div>'),Sa=N("<!> <!> <!> <!> <!>",1);function Ga(s,e){Q(e,!0);const t=ie(new cn),i=ie(new dn),n=ie(new Kt);let a=T("define-areas"),o=T(void 0),f=T(void 0),g=T(!0),u=ie(O.LEFT),d=T(!0),p=ie(O.BOTTOM),m=T(ie([])),c=T(ie(typeof window<"u"?window.innerWidth:1280)),l=z(()=>C(r(m),V=>V.originalSize)),h=z(()=>C(r(m),V=>V.minSize));function C(V,L){if(!V||V.length===0)return;const Z=[...V].sort((G,D)=>D.breakpoint-G.breakpoint).find(G=>r(c)>=G.breakpoint);return Z?L(Z):"0"}function x(){w(g,!r(g))}function k(){w(d,!r(d))}function b(V){w(a,V,!0)}function y(){w(a,"downloads")}qe(async()=>{const V=await Er();J.setNameFields(V.serviceUprn2Config.selectionLayersNameFields||[]),w(m,V.serviceUprn2Config.mainSidebarSizes||[],!0),w(o,new jt(V.serviceUprn2Config.dataSelectionTreeviewConfig),!0),w(f,new jt(V.serviceUprn2Config.areaSelectionTreeviewConfig),!0),await t.initializeAsync({portalUrl:V.serviceUprn2Config.portalUrl,itemId:V.serviceUprn2Config.portalItemId||"",proxy:V.serviceUprn2Config.proxy}),console.log("[page] WebMap loaded")}),qe(()=>{const V=()=>{w(c,window.innerWidth,!0)};return window.addEventListener("resize",V),()=>{window.removeEventListener("resize",V)}});var F=Sa(),A=I(F);fi(A,{});var W=M(A,2);Ni(W,{});var R=M(W,2);On(R,{get fieldFilterMenuStore(){return i}});var q=M(R,2);Fi(q,{});var $=M(q,2);ya($,{get isOpen(){return r(g)},onToggle:x,get position(){return u},get originalSize(){return r(l)},get minSize(){return r(h)},sidebarContent:P=>{var Z=_a(),G=S(Z),D=S(G);ga(D,{get value(){return r(a)},get triggers(){return ba},onValueChange:b,children:(Y,le)=>{var fe=wa(),ne=I(fe);ct(ne,{value:"define-areas",children:(we,ye)=>{var ve=E(),_e=I(ve);{var H=B=>{Xn(B,{get webMap(){return t.data},get treeviewStore(){return n},get treeviewConfigStore(){return r(f)}})};U(_e,B=>{t.isLoaded&&B(H)})}v(we,ve)}});var ge=M(ne,2);ct(ge,{value:"select-data",children:(we,ye)=>{var ve=E(),_e=I(ve);{var H=B=>{aa(B,{get webMap(){return t.data},get treeviewConfigStore(){return r(o)},get fieldFilterMenuStore(){return i}})};U(_e,B=>{t.isLoaded&&B(H)})}v(we,ve)}});var ue=M(ge,2);ct(ue,{value:"export",footer:ye=>{ln(ye,{onExportSuccess:y})},children:(ye,ve)=>{xn(ye,{get webMapStore(){return t},get areaSelectionTreeviewStore(){return n},get fieldFilterMenuStore(){return i}})}});var Te=M(ue,2);ct(Te,{value:"downloads",children:(we,ye)=>{an(we,{})}}),v(Y,fe)},$$slots:{default:!0}}),_(G);var j=M(G,2);ir(j,{get isOpen(){return r(d)},onToggle:k,get position(){return p},originalSize:"300px",overlay:!0,get openIcon(){return Si},children:le=>{Ji(le,{})},$$slots:{default:!0}}),_(Z),v(P,Z)},mainContent:P=>{ca(P,{get webMap(){return t.data},get areaSelectionTreeviewStore(){return n},panelPosition:"top-left",menuPosition:"top-right"})},$$slots:{sidebarContent:!0,mainContent:!0}}),v(s,F),ee()}export{Ga as component};
