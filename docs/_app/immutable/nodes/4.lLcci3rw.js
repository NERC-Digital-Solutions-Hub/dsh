const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/COzYCy8P.js","../chunks/Bc_TmxSc.js","../chunks/DOBtub6T.js","../assets/index.CQED0rIl.css","../chunks/4u0wcz6f.js","../chunks/C6pzAkdR.js","../chunks/CHwVPrQX.js","../chunks/DXGw_0Ww.js","../chunks/DHAweUE4.js","../chunks/HTOW8iPe.js","../chunks/CYB2EK_d.js","../chunks/CdDXOJ3Y.js","../chunks/CEIZYuf2.js","../chunks/DYslx7It.js","../chunks/DuIgqnlY.js","../chunks/D-Nm-cDg.js","../chunks/DaQyK3nQ.js","../chunks/Dex61Jy7.js","../chunks/BCXDwddQ.js","../chunks/D1sKJjB8.js","../chunks/CDGqq53N.js","../chunks/BzZgUCJc.js","../chunks/C9_KfL0q.js","../chunks/COT3swUQ.js","../chunks/C3oh_tnt.js","../chunks/PPVm8Dsz.js","../chunks/Cad-p0g1.js","../assets/component-utils.R4SXog4D.css","../chunks/BBnDJw94.js","../chunks/BzQEzIrU.js","../chunks/ByYe5JNT.js","../chunks/NEmuse4e.js","../chunks/B87vTgcy.js","../chunks/bnayRBMH.js","../chunks/CPwmGbun.js","../chunks/CicY3o9G.js","../chunks/Bcsiu1z4.js","../chunks/clW6bTka.js","../chunks/CY1ScL2v.js","../chunks/fh0BQpDQ.js","../chunks/DHehJAQP.js","../chunks/BqBW39kE.js","../chunks/BPKnb2Ep.js","../chunks/Ncy6WYEt.js","../chunks/Bsvdop-J.js","../chunks/DY7bJyoW.js","../chunks/DyeKTZUU.js","../chunks/CZ1cFYIj.js","../chunks/CwswxHzg.js","../chunks/DmK00UBb.js","../chunks/BsJbwhv8.js","../chunks/Cm7AOsqL.js","../chunks/C_1gjxB4.js","../chunks/BNR3I_eR.js","../chunks/Cp_8tW2x.js","../chunks/Dy3IPmu3.js","../chunks/C-nwrPug.js","../chunks/C0wm8_Yw.js","../chunks/B0eu-fbb.js","../chunks/B92oQJPd.js","../chunks/BP3dapwT.js","../chunks/9ka9skRU.js","../chunks/DL5OcIt-.js","../chunks/Cgb6qxNH.js","../chunks/BNEZVyfC.js","../chunks/iGtE-x7J.js","../chunks/BMEoQDn3.js","../chunks/CjvOpC9P.js","../chunks/BaNElx7S.js","../chunks/CaVKkSa6.js","../chunks/BzPGhKjT.js","../chunks/BW5FX2Vq.js","../chunks/B1N-tmtC.js","../chunks/BirX00qr.js","../chunks/y-H9M8xu.js","../chunks/D-qJO60r.js","../chunks/QQC62dOK.js","../chunks/Bxxl7NsE.js","../chunks/DWdJ8y7A.js","../chunks/DQOO6RKE.js","../chunks/CpKt4gnm.js","../chunks/Bi6C4OG6.js","../chunks/C7e3Z5XT.js","../chunks/D-YQ4CHs.js","../chunks/Bs6xTxvz.js","../chunks/C6j0c8D7.js","../chunks/BnIkuiB_.js","../chunks/BobhZSEo.js","../chunks/DGRj8LLO.js","../chunks/BuFC1hBS.js","../chunks/Di9axRGX.js","../chunks/BcU1P1CV.js","../chunks/BkaRJQOf.js","../chunks/DujhAnCs.js","../chunks/CWMNWfLw.js","../chunks/CmkbQrYx.js","../chunks/EQ54Yfcd.js","../chunks/DuNa-JhG.js","../chunks/3SbGqcbX.js","../chunks/OuCfdC0r.js","../chunks/Cbf23dJy.js","../chunks/CWaspPwN.js","../chunks/vu8FjO6O.js","../chunks/CvbnrAEx.js","../chunks/BJLSrlOq.js","../chunks/2al6WD4b.js","../chunks/CyyW12qt.js","../chunks/Dpaauiqf.js","../chunks/DstbFQD6.js","../chunks/CxKE0Jjq.js","../chunks/BDmhfu3R.js","../chunks/DxjXvSCh.js","../chunks/qyF9FwQ9.js","../chunks/XI-Li77m.js","../chunks/DjsBn23O.js","../chunks/DbEENCEu.js","../chunks/Cy-nR8IT.js","../chunks/DX8bWC0d.js","../chunks/DMoBPOW4.js","../chunks/UcZE3skJ.js","../chunks/CaYZrGFV.js","../chunks/B0_dgftV.js","../chunks/ChwpPGxO.js","../chunks/DlHjpvET.js","../chunks/h2nqTh5L.js","../chunks/BBNU7JHv.js","../chunks/DLVnMPmE.js","../chunks/BQBvadb7.js","../chunks/B-5BUh9O.js","../chunks/B8B24qty.js","../chunks/HoNWw-UZ.js","../chunks/DnsAcW94.js"])))=>i.map(i=>d[i]);
import{_ as U}from"../chunks/PPVm8Dsz.js";import"../chunks/DsnmJJEf.js";import{o as de}from"../chunks/BI5Gp87m.js";import{p as G,f as E,g as i,a0 as Q,s as x,r as j,c as z,b as A,n as X,ad as D,$ as me,w as ge,d as Y,Y as N}from"../chunks/Dg8B37cN.js";import{g as he}from"../chunks/2p-loE3l.js";import{f as k,c as F,a as S,t as ve}from"../chunks/Lqxt2u0_.js";import{s as Z,r as ee,i as ie}from"../chunks/DX-cJOE_.js";import{c as q}from"../chunks/C27fUA72.js";import{b as se,e as O}from"../chunks/ZHUHaqSd.js";import{b as le}from"../chunks/DRG7OQx7.js";import{B as ye}from"../chunks/DAMheLE7.js";import{S as be}from"../chunks/BzjoCI4e.js";import{A as we,a as _e,L as Ae,M as Se,S as Le}from"../chunks/D485tY-B.js";import"../chunks/69_IOA4Y.js";import{e as Ie,i as xe,s as te}from"../chunks/B3syFVNQ.js";import{n as ce}from"../chunks/Drooys_N.js";import"../chunks/BzZgUCJc.js";import"../chunks/YLQ5vOCl.js";import"../chunks/DzkR_YJJ.js";import"../chunks/D_y4h6AR.js";import"../chunks/Cad-p0g1.js";import"../chunks/Bcsiu1z4.js";import"../chunks/B2P5vDMv.js";import{u as H,m as Ce,i as Pe}from"../chunks/CwMvEZwR.js";import{p as fe}from"../chunks/D6GRoFuc.js";import{_ as re}from"../chunks/CPwmGbun.js";import{z as ue}from"../chunks/C6j0c8D7.js";import Me from"../chunks/CV4TFxLl.js";import{n as pe}from"../chunks/CWuMonRC.js";import{I as ne}from"../chunks/Bc9iEGYw.js";var Te=k('<div class="map-sidebar svelte-1gk88h6" role="navigation" aria-label="Map tools"></div>');function Ee(t,e){G(e,!0);let n=x("");const r=async a=>{i(n)===a?(A(n,""),e.onToggleItem?.(a,!1)):(A(n,a,!0),e.onToggleItem?.(a,!0))};var o=Te();Ie(o,21,()=>e.options,xe,(a,s)=>{var c=F(),u=E(c);{let d=Q(()=>`sidebar-button ${i(s).id===i(n)?"active":""}`),p=Q(()=>i(s).id===i(n));q(u,()=>ye,(v,m)=>{m(v,{get class(){return i(d)},variant:"ghost",size:"icon",get"aria-label"(){return i(s).label},get"aria-pressed"(){return i(p)},get title(){return i(s).label},onclick:()=>void r(i(s).id),children:(L,R)=>{const b=Q(()=>i(s).icon);var _=F(),I=E(_);q(I,()=>i(b),(g,C)=>{C(g,{"aria-hidden":"true",class:"sidebar-icon"})}),S(L,_)},$$slots:{default:!0}})})}S(a,c)}),j(o),S(t,o),z()}async function Re(t){const{view:e,inputLayer:n,polygonId:r,clipLayer:o,targetLayer:a,idField:s,symbol:c}=t,u=await Ge(n,r,s,e);if(!u)return console.warn("clipPolygon: polygon not found for id:",r),null;if(u.type!=="polygon")return console.warn("clipPolygon: input geometry is not a polygon."),null;const d=await Be(o,u,e);if(!d)return console.info("clipPolygon: no geometries in clipLayer intersect the polygon."),null;if(!$e(u,d))return null;const p=Ve(d,r,c);return Fe(a,p,e),e&&e.goTo(d).catch(v=>console.warn("goTo failed:",v)),p}function $e(t,e){return t.spatialReference?.wkid!==e.spatialReference?.wkid&&t.spatialReference?.wkt!==e.spatialReference?.wkt?(console.error("clipPolygon: polygon and union clip geometry must be in the same spatial reference."),console.log("polygon SR",t.spatialReference?.toJSON()),console.log("unionClipGeometry SR",e.spatialReference?.toJSON()),!1):!0}function Ve(t,e,n){return new re({geometry:t,attributes:{sourceId:e,clipped:!0},symbol:n||{type:"simple-fill",color:[0,0,0,.2],outline:{color:[255,0,0,1],width:1.5}}})}function Fe(t,e,n){n?.map&&!n.map.layers.includes(t)&&n.map.add(t),t.add(e)}async function Ge(t,e,n,r){return t.type==="feature"?ze(t,e,n,r):t.type==="graphics"?ke(t,e,n):(console.warn("getPolygonGeometryById: unsupported layer type:",t.type),null)}async function ze(t,e,n,r){const o=n||t.objectIdField||"OBJECTID",a=t.createQuery();a.where=Oe(o,e),a.returnGeometry=!0,a.outFields=["*"],a.num=1,r?.spatialReference&&(a.outSpatialReference=r.spatialReference);const u=(await t.queryFeatures(a)).features[0]?.geometry;return u&&u.type==="polygon"?u:null}function ke(t,e,n){const r=n||"id",a=t.graphics.find(s=>{const u=(s.attributes||{})[r];return u===e||String(u)===String(e)})?.geometry;return a&&a.type==="polygon"?a:null}function Oe(t,e){return typeof e=="number"?`${t} = ${e}`:`${t} = '${String(e).replace(/'/g,"''")}'`}async function Be(t,e,n){const r=await Ne(t,e,n);return r.length?qe(e,r):null}async function Ne(t,e,n){return t.type==="feature"?je(t,e,n):t.type==="graphics"?De(t,e):(console.warn("getClipGeometries: unsupported layer type:",t.type),[])}async function je(t,e,n){const r=t.createQuery();return r.geometry=e,r.spatialRelationship="intersects",r.returnGeometry=!0,r.outFields=[],r.num=1e3,n?.spatialReference&&(r.outSpatialReference=n.spatialReference),(await t.queryFeatures(r)).features.map(a=>a.geometry).filter(a=>!!a)}function De(t,e){const n=e.extent,r=[];return t.graphics.forEach(o=>{if(!o.geometry)return;const a=o.geometry,s="extent"in a?a.extent:null;(!n||!s||We(n,s))&&r.push(a)}),r}function qe(t,e){H(t);const n=Ce(e,t);if(!n.length)return null;const r=n.filter(a=>!!a&&a.type==="polygon");if(!r.length)return null;const o=fe(r);return!o||o.type!=="polygon"?null:o}function We(t,e){return!(t.xmax<e.xmin||t.xmin>e.xmax||t.ymax<e.ymin||t.ymin>e.ymax)}function Je(t,e){console.log("[merge-clipped-polygons] merging in layer:",t.id,"opts:",e);const n=Ke(t);if(n.length<=1)return n;console.log("[merge-clipped-polygons] candidate polygons:",n.length);const r=Ue(n);if(console.log("[merge-clipped-polygons] overlay pieces count:",r.length),!r.length)return[];const o=He(r);console.log("[merge-clipped-polygons] groups by layer set:",o.size);const a=Xe(o);return console.log("[merge-clipped-polygons] replacing",n.length,"originals with",a.length,"final polygons."),t.graphics.removeMany(n),t.graphics.addMany(a),a}function Ke(t,e){return t.graphics.toArray().filter(r=>!(!r.geometry||r.geometry.type!=="polygon"))}function Ue(t){let e=[];for(const n of t)e=Qe(n,e);return e}function Qe(t,e){let r=t.geometry;if(!r)return e;H(r);const o=[];for(const a of e){const s=Ye(a,r,t);o.push(...s.pieces),r=s.remaining,r&&H(r)}return r&&o.push({geometry:r,members:[t]}),o}function Ye(t,e,n){const r=t.geometry;if(!e)return{pieces:[t],remaining:null};const o=r.extent,a=e.extent;if(!tt(o,a))return{pieces:[t],remaining:e};const s=Pe(r,e);if(!s||s.type!=="polygon")return{pieces:[t],remaining:e};const c=pe(r,e),u=pe(e,r),d=[];c&&c.type==="polygon"&&d.push({geometry:c,members:t.members.slice()}),d.push({geometry:s,members:[...t.members,n]});const p=u&&u.type==="polygon"?u:null;return{pieces:d,remaining:p}}function He(t){const e=new Map;for(const n of t){const{key:r,ids:o}=Ze(n.members);if(o.length===0)continue;let a=e.get(r);a||(a={geometries:[],members:n.members,comboKey:r},e.set(r,a)),a.geometries.push(n.geometry)}return e}function Xe(t){const e=[];for(const[,n]of t.entries()){if(!n.geometries.length)continue;const r=fe(n.geometries);if(!r||r.type!=="polygon")continue;const o=et(n.members),a=new re({geometry:r,attributes:o,symbol:{type:"simple-fill",color:[0,0,0,.3],outline:{color:[0,0,0,1],width:1}}});e.push(a)}return e}function Ze(t){const e=new Set,n=new Set;for(const s of t){const c=s.attributes??{},u=c.layerId,d=c.layerIds,p=c.layerTitle,v=c.layerTitles;u&&e.add(u),Array.isArray(d)&&d.forEach(m=>{m&&e.add(m)}),p&&n.add(p),Array.isArray(v)&&v.forEach(m=>{m&&n.add(m)})}const r=Array.from(e).sort(),o=Array.from(n).sort();return{key:r.join("|"),ids:r,titles:o}}function et(t){const e={};if(!t.length)return e;const n=t[0].attributes??{};Object.assign(e,n),"sourceId"in n&&(e.sourceId=n.sourceId),"clipped"in n&&(e.clipped=n.clipped);const r=new Map,o=(d,p,v)=>{if(!d)return;let m=r.get(d);m||(m={titles:new Set,values:new Set},r.set(d,m)),p&&m.titles.add(p),Array.isArray(v)&&v.forEach(L=>{L!=null&&m.values.add(String(L))})};for(const d of t){const p=d.attributes??{},v=p.layerId,m=p.layerTitle,L=p.layerValues,R=p.value!=null?String(p.value):void 0,b=p.layerIds,_=p.layerTitles,I=Array.isArray(L)&&L.length?L:R?[R]:void 0;if(v&&o(v,m,I),Array.isArray(b))for(let g=0;g<b.length;g++){const C=b[g],$=Array.isArray(_)?_[g]:void 0;o(C,$,I)}}const a=[],s=[],c=[],u=Array.from(r.keys()).sort();for(const d of u){const p=r.get(d),v=Array.from(p.titles).sort(),m=Array.from(p.values);a.push(d),s.push(v.join(" / ")),c.push(m.join(", "))}return e.layerIds=a,e.layerTitles=s,e.layerValues=c,e.layerTitlesCsv=s.join(", "),e}function tt(t,e){return!(t.xmax<e.xmin||t.xmin>e.xmax||t.ymax<e.ymin||t.ymin>e.ymax)}async function rt(t,e,n){let r=[];const o=t.createQuery();return o.geometry=e.geometry,o.spatialRelationship="intersects",o.returnGeometry=!1,o.outFields=[n],o.num=10,r=(await t.queryFeatures(o)).features.map(s=>s.attributes?.[n]).filter(s=>s!=null).map(s=>String(s)),r.length===0?null:(r=Array.from(new Set(r)),r)}function nt(t,e){G(e,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let n=ee(e,["$$slots","$$events","$$legacy"]);const r=[["path",{d:"M12 18V5"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77"}]];ne(t,Z({name:"brain"},()=>n,{get iconNode(){return r},children:(o,a)=>{var s=F(),c=E(s);te(c,()=>e.children??X),S(o,s)},$$slots:{default:!0}})),z()}function ot(t,e){G(e,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let n=ee(e,["$$slots","$$events","$$legacy"]);const r=[["path",{d:"M3 5h.01"}],["path",{d:"M3 12h.01"}],["path",{d:"M3 19h.01"}],["path",{d:"M8 5h13"}],["path",{d:"M8 12h13"}],["path",{d:"M8 19h13"}]];ne(t,Z({name:"list"},()=>n,{get iconNode(){return r},children:(o,a)=>{var s=F(),c=E(s);te(c,()=>e.children??X),S(o,s)},$$slots:{default:!0}})),z()}function at(t,e){G(e,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let n=ee(e,["$$slots","$$events","$$legacy"]);const r=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z"}],["path",{d:"M15 5.764v15"}],["path",{d:"M9 3.236v15"}]];ne(t,Z({name:"map"},()=>n,{get iconNode(){return r},children:(o,a)=>{var s=F(),c=E(s);te(c,()=>e.children??X),S(o,s)},$$slots:{default:!0}})),z()}function it(t,e){if(!t||!t.map)throw new Error("MapView is not initialized");const n=new ce({title:e,listMode:"show"}),r=new ce({listMode:"hide"});return t.map.add(r),t.on("click",async o=>{if(!t)return;const s=(await t.hitTest(o)).results.find(u=>u.layer===n);if(!s){r.removeAll();return}const c=s.graphic;r.removeAll(),r.add(new re({geometry:c.geometry,symbol:{type:"simple-fill",color:[0,0,0,0],outline:{type:"simple-line",color:[255,255,0,1],width:3}}})),t.popup?.open({features:[c],location:o.mapPoint})}),t.map.add(n),n}var st=k(`<p>This is the Analysis Tab component. This is where the user and initiate analysis for a polygon or
	area (e.g. Ward).</p> <!>`,1);function lt(t,e){G(e,!0);let n=x(null),r=x(null),o=x(null),a=x(null),s=x(null);const c="UK Wards (Boundary Fully Clipped) (2022)";de(async()=>{A(a,it(e.mapView,"Analysis Results Layer"),!0),await u(),d()});async function u(){if(!e.mapView)throw new Error("[analysis-tab] MapView is not initialized");A(n,new we,!0),A(r,new _e(i(n),new Ae(e.mapView)),!0),A(o,new Se(e.mapView,i(r),new Set([c])),!0),console.log("[analysis-tab] Initialized stores",i(n).layerId),await i(r).refreshLayerView(),await i(r).refreshAreas()}function d(){if(!i(n)){console.warn("[analysis-tab] AreaSelectionStore not initialized yet");return}const l=e.mapView.map?.allLayers.find(f=>f.title===c);l?(i(n).setLayerId(l.uid),console.log(`[analysis-tab] Set default area layer to ID: ${l.uid}`)):console.warn("[analysis-tab] Default area layer not found on the map")}function p(l){const f=[];for(const y of l)y instanceof Me?f.push(...p(y.layers.toArray())):y instanceof ue&&f.push(y);return f}function v(l,f=.3){let y=0;for(let P=0;P<l.length;P++)y=l.charCodeAt(P)+((y<<5)-y);const h=y>>0&255,w=y>>8&255,M=y>>16&255;return[h,w,M,f]}function m(l,f=.3,y=[255,0,0,1],h=2){return{type:"simple-fill",color:v(l,f),outline:{color:y,width:h}}}function L(){return{title:"Clipped region",content:[{type:"custom",creator:l=>{const f=l.graphic,y=f.attributes.layerTitles??[],h=f.attributes.layerValues??[],w=document.createElement("table");w.className="esri-widget__table";const M=document.createElement("tbody"),P=document.createElement("tr"),B=document.createElement("th"),T=document.createElement("th");return B.textContent="Layer",T.textContent="Value",P.appendChild(B),P.appendChild(T),M.appendChild(P),y.forEach((V,J)=>{const K=document.createElement("tr"),oe=document.createElement("td");oe.textContent=V;const ae=document.createElement("td");ae.textContent=h[J]??"",K.appendChild(oe),K.appendChild(ae),M.appendChild(K)}),w.appendChild(M),w}}]}}function R(){return!e.mapView||!e.mapView.map?(console.warn("[analysis-tab] MapView not initialized yet"),!1):!i(n)||!i(r)||!i(o)?(console.warn("[analysis-tab] Stores not initialized yet"),!1):i(a)?!0:(console.warn("[analysis-tab] Graphic layer not initialized yet"),!1)}function b(){const l=e.mapView.map.findLayerById("19a9760b651-layer-105");return l&&console.log("Parcels Layer:",l.title),l}async function _(l,f,y){const h=await Re({view:e.mapView,inputLayer:f,polygonId:y,idField:"OBJECTID",clipLayer:l,targetLayer:i(a)});if(!h){console.log(`No polygon clipped for layer: ${l.title}`);return}h.attributes??={},h.attributes.layerTitle=l.title,h.attributes.layerId=l.id,l.displayField&&(h.attributes.value=await rt(l,h,l.displayField)),h.attributes.layerTitles=[l.title],h.symbol=m(l.id,.3,[255,0,0,1],2),console.log("Clipped Polygon:",h)}function I(l){for(const f of l){const y=f.attributes.layerTitles.join("; ");f.symbol=m(y,.3,[0,0,0,1],1),f.popupTemplate=L()}}async function g(){if(!R())return;const l=C();if(l.length===0){console.warn("[analysis-tab] No area selected for analysis");return}if(i(s)===`analyzed-${l.join("-")}`){console.log("[analysis-tab] Analysis already performed for the selected area(s)");return}const f=b();if(!f){console.warn("[analysis-tab] Parcels layer not found");return}const y=p(e.mapView.map.layers.toArray());for(const w of y){if(!(w instanceof ue)){console.log(`Skipping non-feature layer: ${w.title}, type: ${w.type}`);continue}if(w.id===f.id){console.log(`Skipping parcels layer itself: ${w.title}`);continue}await _(w,f,l[0])}console.log("Merging clipped polygons in layer:",i(a).id);const h=Je(i(a));I(h),i(n)?.clearSelectedAreas(),await i(r)?.refreshAreas(),i(r)?.clearSelections(),A(s,`analyzed-${l.join("-")}`)}function C(){return!i(r)||!i(n)?[]:Array.from(i(n).selectedAreaIds)}var $=st(),W=D(E($),2);ye(W,{onclick:g,children:(l,f)=>{me();var y=ve("Analyze");S(l,y)},$$slots:{default:!0}}),S(t,$),z()}var ct=k("<div><!></div>"),ut=k('<arcgis-layer-list></arcgis-layer-list> <div class="basemap-container svelte-1q0t0hd"><arcgis-basemap-gallery></arcgis-basemap-gallery></div> <!>',3),pt=k("<arcgis-map></arcgis-map>",2),dt=k('<div class="layout svelte-1q0t0hd"><!> <!></div>');function Dt(t,e){G(e,!0);let n=x(null),r=x(null),o=x(null),a=x(!1),s=x(null),c=x(!1);const u=[{id:"layers",label:"Layers",icon:ot},{id:"basemap",label:"Basemap Gallery",icon:at},{id:"analysis",label:"Analysis",icon:nt}];de(async()=>{await U(()=>import("../chunks/COzYCy8P.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120]),import.meta.url),await U(()=>import("../chunks/B0_dgftV.js"),__vite__mapDeps([121,122,2,3,123,12,11,124,7,5,4,1,6,8,9,10,18,19,20,21,22,23,24,25,26,27,125,126,17,51,52,39,53,54,55,42,36,33,127,60,46,128,88,35,37,43,44]),import.meta.url),await U(()=>import("../chunks/B8B24qty.js").then(b=>b.a),__vite__mapDeps([129,18,2,3,19,20,21,22,23,24,25,26,11,27,62,45,39,46,36,33,47,38,35,34,31,37,130,131,127,83,126]),import.meta.url)}),ge(()=>{!i(r)||!i(o)||(i(r).view=i(o),i(r).listItemCreatedFunction=b=>{const{item:_}=b;_.layer.type!="group"&&(_.panel={content:"legend",open:!0})})});async function d(){A(o,i(n)?.view??null,!0),i(r)&&i(o)&&(i(r).view=i(o)),!i(c)&&(A(c,!0),!(!i(o)||!i(o).map)&&await i(o).when())}function p(b,_){A(a,_,!0),A(s,_?b:null,!0)}var v=dt(),m=Y(v);{var L=b=>{Ee(b,{get options(){return u},onToggleItem:p})};ie(m,b=>{i(o)&&b(L)})}var R=D(m,2);{const b=I=>{var g=F(),C=E(g);q(C,()=>Le,($,W)=>{W($,{children:(l,f)=>{var y=ut(),h=E(y);N(()=>O(h,"hidden",i(s)!=="layers")),le(h,T=>A(r,T),()=>i(r));var w=D(h,2),M=Y(w);se(M,1,"basemap-gallery svelte-1q0t0hd"),N(()=>O(M,"view",i(o))),j(w);var P=D(w,2);{var B=T=>{var V=ct(),J=Y(V);lt(J,{get mapView(){return i(o)}}),j(V),N(()=>V.hidden=i(s)!=="analysis"),S(T,V)};ie(P,T=>{i(o)&&T(B)})}N(()=>w.hidden=i(s)!=="basemap"),S(l,y)},$$slots:{default:!0}})}),S(I,g)},_=I=>{var g=pt();se(g,1,"relative h-full w-full"),O(g,"item-id","331ba640fe6c4fa5b4c3d025160c2ec5"),O(g,"center","-2.231774828836059,53.46531847221502"),O(g,"zoom","15"),le(g,C=>A(n,C),()=>i(n)),he("arcgisViewReadyChange",g,d),S(I,g)};q(R,()=>be,(I,g)=>{g(I,{get isOpen(){return i(a)},hideToggleButton:!0,sidebarContent:b,mainContent:_,$$slots:{sidebarContent:!0,mainContent:!0}})})}j(v),S(t,v),z()}export{Dt as component};
