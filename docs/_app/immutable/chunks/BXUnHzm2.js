import{r as H}from"./D6KPPgz5.js";import{o as h,_ as X,A as m,P as T,u as L,g as v,H as p,c as s}from"./_KzNjohN.js";import{n as g}from"./BDErjlP0.js";import"./BkQcsSCB.js";import{r as j,c as f,a as P}from"./DQtv-ldw.js";function nr(r){const n=r[0]*r[0]+r[4]*r[4]+r[8]*r[8],u=r[1]*r[1]+r[5]*r[5]+r[9]*r[9],I=r[2]*r[2]+r[6]*r[6]+r[10]*r[10];return Math.sqrt(Math.max(n,u,I))}function ur(r,n){const u=Math.sqrt(n[0]*n[0]+n[4]*n[4]+n[8]*n[8]),I=Math.sqrt(n[1]*n[1]+n[5]*n[5]+n[9]*n[9]),t=Math.sqrt(n[2]*n[2]+n[6]*n[6]+n[10]*n[10]);return h(r,u,I,t),r}function k(r,n,u){Math.abs(r[0])>Math.abs(r[1])?h(n,0,1,0):h(n,1,0,0),X(u,r,n),X(n,u,r),m(u,u),m(n,n)}function x(r=_){return[r[0],r[1],r[2],r[3]]}function Ir(r=_[0],n=_[1],u=_[2],I=_[3]){return d(r,n,u,I,j.get())}function w(r,n){return d(n[0],n[1],n[2],n[3],r)}function tr(r){return r}function d(r,n,u,I,t=x()){return t[0]=r,t[1]=n,t[2]=u,t[3]=I,t}function z(r,n,u){const I=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],t=Math.abs(I-1)>1e-5&&I>1e-12?1/Math.sqrt(I):1;return u[0]=n[0]*t,u[1]=n[1]*t,u[2]=n[2]*t,u[3]=-(u[0]*r[0]+u[1]*r[1]+u[2]*r[2]),u}function G(r,n,u,I=x()){const t=u[0]-n[0],c=u[1]-n[1],e=u[2]-n[2],o=r[0]-n[0],D=r[1]-n[1],O=r[2]-n[2],S=c*O-e*D,$=e*o-t*O,R=t*D-c*o,q=S*S+$*$+R*R,b=Math.abs(q-1)>1e-5&&q>1e-12?1/Math.sqrt(q):1;return I[0]=S*b,I[1]=$*b,I[2]=R*b,I[3]=-(I[0]*r[0]+I[1]*r[1]+I[2]*r[2]),I}function y(r,n,u,I=0,t=Math.floor(u*(1/3)),c=Math.floor(u*(2/3))){if(u<3)return!1;n(M,I);let e=t,o=!1;for(;e<u-1&&!o;)n(a,e),e++,o=!p(M,a);if(!o)return!1;for(e=Math.max(e,c),o=!1;e<u&&!o;)n(E,e),e++,s(U,M,a),m(U,U),s(l,a,E),m(l,l),o=!p(M,E)&&!p(a,E)&&Math.abs(T(U,l))<J;return o?(G(M,a,E,r),!0):(I!==0||t!==1||c!==2)&&y(r,n,u,0,1,2)}function or(r,n,u=!0){const I=n.length/3;return y(r,((t,c)=>h(t,n[3*c+0],n[3*c+1],n[3*c+2])),u?I-1:I)}const J=.99619469809,M=g(),a=g(),E=g(),U=g(),l=g();function er(r,n,u){return n!==r&&w(r,n),r[3]=-T(r,u),r}function cr(r,n){return n[0]=-r[0],n[1]=-r[1],n[2]=-r[2],n[3]=-r[3],n}function Nr(r,n,u,I){return X(E,n,r),z(u,E,I)}function ir(r,n,u,I){return C(F(r,n,s(f.get(),u,n),Q,I))}function fr(r,n,u){return n!=null&&C(F(r,n.origin,n.direction,V,u))}function Er(r,n,u){return C(F(r,n.origin,n.vector,i.NONE,u))}function ar(r,n,u){return C(F(r,n.origin,n.vector,i.CLAMP,u))}function sr(r,n){return A(r,n)>=0}function Tr(r,n){const u=T(r,n.ray.direction),I=-A(r,n.ray.origin);if(u>-1e-6&&u<1e-6)return I>0;const t=I/u;return u>0?t<n.c1&&(n.c1=t):t>n.c0&&(n.c0=t),n.c0<=n.c1}function Sr(r,n,u){const I=v(f.get(),r,-r[3]),t=K(r,s(f.get(),n,I),f.get());return L(u,t,I),u}function Mr(r,n,u,I){const t=r,c=f.get(),e=f.get();k(t,c,e);const o=s(f.get(),u,n),D=P(c,o),O=P(e,o),S=P(t,o);return h(I,D,O,S)}function K(r,n,u){const I=v(f.get(),r,T(r,n));return s(u,n,I),u}function _r(r,n){return Math.abs(A(r,n))}function A(r,n){return T(r,n)+r[3]}var N;function C(r){return r===N.INTERSECTS_INSIDE_OUT||r===N.INTERSECTS_OUTSIDE_IN}function F(r,n,u,I,t){const c=T(r,u),e=A(r,n);if(c===0)return e>=0?N.INSIDE:N.OUTSIDE;let o=-e/c;return I&i.CLAMP&&(o=H(o,0,1)),!(I&i.INFINITE_MIN)&&o<0||!(I&i.INFINITE_MAX)&&o>1?e>=0?N.INSIDE:N.OUTSIDE:(L(t,n,v(t,u,o)),e>=0?N.INTERSECTS_INSIDE_OUT:N.INTERSECTS_OUTSIDE_IN)}(function(r){r[r.INTERSECTS_INSIDE_OUT=0]="INTERSECTS_INSIDE_OUT",r[r.INTERSECTS_OUTSIDE_IN=1]="INTERSECTS_OUTSIDE_IN",r[r.INSIDE=2]="INSIDE",r[r.OUTSIDE=3]="OUTSIDE"})(N||(N={}));const _=[0,0,1,0];var i;(function(r){r[r.NONE=0]="NONE",r[r.CLAMP=1]="CLAMP",r[r.INFINITE_MIN=4]="INFINITE_MIN",r[r.INFINITE_MAX=8]="INFINITE_MAX"})(i||(i={}));const Q=i.INFINITE_MIN|i.INFINITE_MAX,V=i.INFINITE_MAX;export{or as A,Ir as D,Tr as G,Sr as H,Mr as J,cr as L,x as M,tr as O,Nr as P,_r as Q,d as U,A as V,k as a,ur as g,w as h,ir as k,z as l,nr as m,G as p,fr as q,y as v,ar as w,Er as x,er as y,sr as z};
