import{H as b}from"./Q08H8bVX.js";import{s as y}from"./DGjcIG0n.js";import{a as d}from"./w-2V2ENZ.js";import{d as p}from"./Bcg-2HKw.js";import{R as w,K as h}from"./BmSLGRn-.js";import{C as g,a as R}from"./DQRImjaO.js";const c=new Map;async function U(e,s){try{return{data:(await k(e,s)).data,baseUrl:w(e),styleUrl:e}}catch(t){return p(t),null}}function N(e,s,t){const r=s.portal!=null?s.portal:g.getDefault();let o;const a=`${r.url} - ${r.user?.username} - ${e}`,n=c.get(a);if(n)return n;const f=$(e,r,t).then((l=>(o=l,l.fetchData()))).then((l=>({data:l,baseUrl:o.itemUrl??"",styleName:e})));return c.set(a,f),f}function $(e,s,t){return s.load(t).then((()=>{const r=new R({disableExtraQuery:!0,query:`owner:${i} AND type:${m} AND typekeywords:"${e}"`});return s.queryItems(r,t)})).then((({results:r})=>{let o=null;const a=e.toLowerCase();if(r&&Array.isArray(r)){for(const n of r)if(n.typeKeywords?.some((l=>l.toLowerCase()===a))&&n.type===m&&n.owner===i){o=n;break}}if(!o)throw new y("symbolstyleutils:style-not-found",`The style '${e}' could not be found`,{styleName:e});return o.load(t)}))}function S(e,s,t){return e?.styleUrl!=null?U(e.styleUrl,t):e?.styleName!=null?N(e.styleName,s,t):Promise.reject(new y("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function M(e){return e===null||e.type==="CIMSymbolReference"?e:{type:"CIMSymbolReference",symbol:e}}function x(e,s){for(const t of s)switch(t){case"cim":if(e.cimRef)return{format:t,url:encodeURI(e.cimRef)};break;case"web-gltf-basisu":{const r=u(e,"gltf_basisu");if(r)return{format:t,url:r};break}case"web-gltf":{const r=u(e,"gltf");if(r)return{format:t,url:r};break}case"web":{const r=u(e,"gltf");if(r)return{format:"web-gltf",url:r};if(e.webRef)return{format:t,url:encodeURI(e.webRef)};break}}}function u(e,s){if(!d("enable-feature:force-wosr"))return e.formatInfos?.find((t=>t.type===s))?.href}function k(e,s){const t={responseType:"json",query:{f:"json"},...s};return b(h(e),t)}const i="esri_en",m="Style",E="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";export{E as h,S as i,M as m,k as p,x as y};
