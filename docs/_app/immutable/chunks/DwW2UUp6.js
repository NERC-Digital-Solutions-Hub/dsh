const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CTBv4vVY.js","./CXWgbL7n.js","./CBds6lNF.js","./waHvktcX.js","./hffy0Rzx.js","./BK_j0vCJ.js","./BtvBu1eD.js","./C6w_XvRs.js","./PYsgr6Cv.js","./DVw19XEV.js","./w5_0AqOC.js","./DUv5Dx4o.js","./CzZNEXbc.js","./PPVm8Dsz.js","./DWglCDHL.js","./31lkbN3K.js","./Bu5rTcQm.js","./2QX-518d.js","./Ca7rWSR3.js","./C0D_VUqv.js","./Cf-tPqwv.js","./Bl2MZOXM.js","./D6KPPgz5.js","./D9YC7l4A.js","./BLADGlsv.js","./wufSWGKb.js","./CMalCdhA.js","./DVFGfKmI.js","./0ZOWt6Zk.js","./DWdn-gc2.js","./-UPQzl-i.js","./BCEvhry1.js","./C3hpUfwZ.js","./C0wm8_Yw.js","./DvXX8WIZ.js","./D1-bb5K_.js","./Djp3mnm5.js","./sZon5vxQ.js","./DQOJ18NT.js","./DAO_oeHl.js","./DnfAzPqj.js","./Cl5lrJ4c.js","./C9DKB5KZ.js","./D7HcNFEo.js","./B1WkbkqS.js","./iDRwGU5l.js","./C6ceJEB9.js","./DRZePt2j.js","./C6Du7acc.js","./X0qAyRpB.js","./D136DD96.js","./DCeYhTVW.js","./Ddv3h-S7.js","./CEkMdQX5.js","./tGUNNaGr.js","./KBCwGpJQ.js","./C5g0-b5x.js","./B5lkJr4T.js","./DmxrO30_.js","./BbbEEtGm.js"])))=>i.map(i=>d[i]);
import{r as i,m as o,a as u,l as c,f as ge,C as ye,aN as Kt,o as x,b as j,O as Ir,g as Yt,K as Sr,u as Tr,aM as jr,j as Qt,Q as Xt,d as Nr,x as Er}from"./CBds6lNF.js";import{_ as I}from"./PPVm8Dsz.js";import{ab as _r,a6 as $r,f as We,aB as xr,H as me,p as Bt,z as Ar}from"./CzZNEXbc.js";import{L as kr}from"./D2R8NS53.js";import{m as he,a as Rt,s as De,n as er}from"./i7Vcu2FR.js";import{a as W,e as mt,L as Rr}from"./waHvktcX.js";import{V as yt}from"./CXWgbL7n.js";import{s as z,i as Le}from"./hffy0Rzx.js";import{C as Or,p as Ot}from"./31lkbN3K.js";import{t as tr}from"./Cm-vM7rO.js";import{S as rr,a as Cr}from"./BCEvhry1.js";import{m as Lr}from"./BtvBu1eD.js";import{e as Ur,j as Pr}from"./BK_j0vCJ.js";import{d as Vr,e as ir,B as Fr,o as Mr,I as Br}from"./PYsgr6Cv.js";import qe from"./Bu5rTcQm.js";import{E as Jr}from"./C0D_VUqv.js";import{u as D}from"./B4vD1BGx.js";import{A as Ze}from"./CL2NbQte.js";import{e as Gr,a as or}from"./E_1-hsoR.js";import{e as Dr}from"./DvXX8WIZ.js";import{p as qr,n as zr}from"./CMalCdhA.js";import{g as Wr}from"./BCOEBfat.js";import{r as q}from"./B5AOUoSS.js";import{i as sr}from"./DQxgXym9.js";import{n as Hr}from"./BdbjiLX5.js";import{a as N}from"./SroC6Bde.js";import nr from"./D7uDWCVN.js";import ar from"./Gr_8PAej.js";import{f as Zr}from"./DfVx0eoU.js";import{f as lr}from"./DVFGfKmI.js";import{g as Jt,c as ht,l as Kr,h as Yr,t as Gt,i as Dt,a as qt}from"./DCeYhTVW.js";import{R as Qr}from"./BBku-UyD.js";import{g as ur,u as Xr}from"./DUv5Dx4o.js";import{t as S,o as Ke,s as ze,e as ei}from"./C6Du7acc.js";import"./Ch0BYLJI.js";import{j as pr,V as ti,r as gt,u as zt}from"./Csib0GOI.js";import{e as ri}from"./DsHDw-MJ.js";import{y as Ct,m as ii,P as oi}from"./Bl2MZOXM.js";import{s as dr}from"./X0qAyRpB.js";import{l as si}from"./j4iyJSzk.js";let te=class extends c{constructor(t){super(t),this.facilityIdField=null,this.layerId=null,this.nameField=null,this.siteIdField=null,this.sublayerId=null}};i([o({type:String,json:{write:{isRequired:!0}}})],te.prototype,"facilityIdField",void 0),i([o({type:String,json:{write:{isRequired:!0}}})],te.prototype,"layerId",void 0),i([o({type:String,json:{write:{isRequired:!0}}})],te.prototype,"nameField",void 0),i([o({type:String,json:{write:!0}})],te.prototype,"siteIdField",void 0),i([o({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],te.prototype,"sublayerId",void 0),te=i([u("esri.layers.support.FacilityLayerInfo")],te);const ni=te;let U=class extends c{constructor(t){super(t),this.facilityIdField=null,this.layerId=null,this.levelIdField=null,this.levelNumberField=null,this.longNameField=null,this.shortNameField=null,this.sublayerId=null,this.verticalOrderField=null}};i([o({type:String,json:{write:{isRequired:!0}}})],U.prototype,"facilityIdField",void 0),i([o({type:String,json:{write:{isRequired:!0}}})],U.prototype,"layerId",void 0),i([o({type:String,json:{write:{isRequired:!0}}})],U.prototype,"levelIdField",void 0),i([o({type:String,json:{write:{isRequired:!0}}})],U.prototype,"levelNumberField",void 0),i([o({type:String,json:{write:{isRequired:!0}}})],U.prototype,"longNameField",void 0),i([o({type:String,json:{write:{isRequired:!0}}})],U.prototype,"shortNameField",void 0),i([o({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],U.prototype,"sublayerId",void 0),i([o({type:String,json:{write:{isRequired:!0}}})],U.prototype,"verticalOrderField",void 0),U=i([u("esri.layers.support.LevelLayerInfo")],U);const ai=U;let ae=class extends c{constructor(t){super(t),this.layerId=null,this.nameField=null,this.siteIdField=null,this.sublayerId=null}};i([o({type:String,json:{write:{isRequired:!0}}})],ae.prototype,"layerId",void 0),i([o({type:String,json:{write:{isRequired:!0}}})],ae.prototype,"nameField",void 0),i([o({type:String,json:{write:{isRequired:!0}}})],ae.prototype,"siteIdField",void 0),i([o({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],ae.prototype,"sublayerId",void 0),ae=i([u("esri.layers.support.SiteLayerInfo")],ae);const li=ae;let ve=class extends c{constructor(t){super(t),this.levelLayer=null,this.facilityLayer=null,this.siteLayer=null}};i([o({type:ai,json:{write:{isRequired:!0}}})],ve.prototype,"levelLayer",void 0),i([o({type:ni,json:{write:{isRequired:!0}}})],ve.prototype,"facilityLayer",void 0),i([o({type:li,json:{write:!0}})],ve.prototype,"siteLayer",void 0),ve=i([u("esri.support.MapFloorInfo")],ve);const ui=ve;var wt;let be=wt=class extends c{constructor(e){super(e),this.activeRange=null,this.currentRangeExtent=null,this.fullRangeExtent=null}clone(){return new wt(W({activeRange:this.activeRange,currentRangeExtent:this.currentRangeExtent,fullRangeExtent:this.fullRangeExtent}))}};i([o({type:String,nonNullable:!0,json:{read:{source:"activeRangeName"},write:{target:"activeRangeName",isRequired:!0}}})],be.prototype,"activeRange",void 0),i([o({type:[Number],json:{write:!0}})],be.prototype,"currentRangeExtent",void 0),i([o({type:[Number],json:{write:!0}})],be.prototype,"fullRangeExtent",void 0),be=wt=i([u("esri.webdoc.RangeInfo")],be);const Lt=be;var ft;let F=ft=class extends c{constructor(e){super(e),this.enabled=!1,this.longNames=!1,this.minimized=!1,this.pinnedLevels=!1,this.site=null,this.facility=null,this.level=null}clone(){return new ft(W({enabled:this.enabled,longNames:this.longNames,minimized:this.minimized,pinnedLevels:this.pinnedLevels,site:this.site,facility:this.facility,level:this.level}))}};i([o({type:Boolean,json:{read:{source:"enabled"},write:{target:"enabled"}}})],F.prototype,"enabled",void 0),i([o({type:Boolean,json:{read:{source:"longNames"},write:{target:"longNames"}}})],F.prototype,"longNames",void 0),i([o({type:Boolean,json:{read:{source:"minimized"},write:{target:"minimized"}}})],F.prototype,"minimized",void 0),i([o({type:Boolean,json:{read:{source:"pinnedLevels"},write:{target:"pinnedLevels"}}})],F.prototype,"pinnedLevels",void 0),i([o({type:String,json:{read:{source:"site"},write:{target:"site"}}})],F.prototype,"site",void 0),i([o({type:String,json:{read:{source:"facility"},write:{target:"facility"}}})],F.prototype,"facility",void 0),i([o({type:String,json:{read:{source:"level"},write:{target:"level"}}})],F.prototype,"level",void 0),F=ft=i([u("esri.webdoc.widgets.FloorFilter")],F);const pi=F;var vt;const Ye=new ge({slider:"slider",picker:"picker"});let Ie=vt=class extends c{constructor(e){super(e),this.interactionMode=null,this.numStops=null,this.stopInterval=null}clone(){return new vt({interactionMode:this.interactionMode,numStops:this.numStops,stopInterval:this.stopInterval})}};i([o({type:Ye.apiValues,nonNullable:!0,json:{type:Ye.jsonValues,default:null,read:{reader:Ye.read},write:{isRequired:!0,writer:Ye.write}}})],Ie.prototype,"interactionMode",void 0),i([o({type:ye,json:{read:{source:"numberOfStops"},write:{target:"numberOfStops",overridePolicy(){const e=this.stopInterval!=null;return{enabled:!e,isRequired:!e}}}}})],Ie.prototype,"numStops",void 0),i([o({type:Number,json:{write:{overridePolicy(){return{isRequired:this.numStops==null}}}}})],Ie.prototype,"stopInterval",void 0),Ie=vt=i([u("esri.webdoc.widgets.Range")],Ie);const di=Ie;var bt;let T=bt=class extends c{constructor(e){super(e),this.currentTimeExtent=null,this.fullTimeExtent=null,this.loop=!1,this.numStops=null,this.numThumbs=null,this.stopDelay=null,this.stopInterval=null,this.stops=null}readCurrentTimeExtent(e){return e?D.fromArray(e):void 0}writeCurrentTimeExtent(e,t,r){e&&mt(r,e.toArray(),t)}readFullTimeExtent(e,t){const r=t.properties;if(!r)return;const s=r.endTime!=null?new Date(r.endTime):null,n=r.startTime!=null?new Date(r.startTime):null;return new D({start:n,end:s})}writeFullTimeExtent(e,t){if(!e)return;const r=t.properties=t.properties||{},s=e.end,n=e.start;s&&(r.endTime=s!=null?s.getTime():null),n&&(r.startTime=n!=null?n.getTime():null)}readStopInterval(e,t,r){return e?or.fromJSON({value:e.interval,unit:e.units},r):null}writeStopInterval(e,t,r,s){if(!e)return;const n=e.toJSON(s);mt("properties.timeStopInterval",{interval:n.value,units:n.unit},t)}readStops(e){return e?.length?e.map((t=>new Date(t))):null}writeStops(e,t,r){e?.length&&mt(r,e.map((s=>s.getTime())),t)}clone(){return new bt(W({currentTimeExtent:this.currentTimeExtent,fullTimeExtent:this.fullTimeExtent,loop:this.loop,numStops:this.numStops,numThumbs:this.numThumbs,stopDelay:this.stopDelay,stopInterval:this.stopInterval,stops:this.stops}))}};i([o({type:D,json:{type:[[ye,Kt]],read:{source:"properties.currentTimeExtent"},write:{target:"properties.currentTimeExtent"}}})],T.prototype,"currentTimeExtent",void 0),i([x("currentTimeExtent")],T.prototype,"readCurrentTimeExtent",null),i([j("currentTimeExtent")],T.prototype,"writeCurrentTimeExtent",null),i([o({type:D,json:{read:{source:["properties.endTime","properties.startTime"]},write:{target:{"properties.endTime":{type:Number},"properties.startTime":{type:Number}}}}})],T.prototype,"fullTimeExtent",void 0),i([x("fullTimeExtent")],T.prototype,"readFullTimeExtent",null),i([j("fullTimeExtent")],T.prototype,"writeFullTimeExtent",null),i([o({type:Boolean,nonNullable:!0,json:{default:!1,read:{source:"properties.loop"},write:{target:"properties.loop"}}})],T.prototype,"loop",void 0),i([o({type:ye,json:{read:{source:"properties.numberOfStops"},write:{target:"properties.numberOfStops",overridePolicy(){const e=!!this.stopInterval,t=!!this.stops?.length,r=!(e||t);return{enabled:r,isRequired:r}}}}})],T.prototype,"numStops",void 0),i([o({type:[1,2],nonNullable:!0,json:{type:ye,read:{source:"properties.thumbCount"},write:{target:"properties.thumbCount",isRequired:!0}}})],T.prototype,"numThumbs",void 0),i([o({type:Number,nonNullable:!0,json:{read:{source:"properties.thumbMovingRate"},write:{target:"properties.thumbMovingRate",isRequired:!0}}})],T.prototype,"stopDelay",void 0),i([o({type:or,json:{read:{source:"properties.timeStopInterval"},write:{target:{"properties.timeStopInterval.interval":{type:Number},"properties.timeStopInterval.units":{type:Gr.jsonValues.filter((e=>e!=="esriTimeUnitsUnknown"))}},overridePolicy(){const e=this.numStops!=null,t=!!this.stops?.length;return{enabled:!t,isRequired:!(e||t)}}}}})],T.prototype,"stopInterval",void 0),i([x("stopInterval")],T.prototype,"readStopInterval",null),i([j("stopInterval")],T.prototype,"writeStopInterval",null),i([o({type:[Date],json:{type:[ye],read:{source:"properties.stops"},write:{target:"properties.stops",overridePolicy(){return{isRequired:this.numStops==null&&!this.stopInterval}}}}})],T.prototype,"stops",void 0),i([x("stops")],T.prototype,"readStops",null),i([j("stops")],T.prototype,"writeStops",null),T=bt=i([u("esri.webdoc.widgets.TimeSlider")],T);const ci=T;var It;let Se=It=class extends c{constructor(e){super(e),this.range=null,this.timeSlider=null,this.floorFilter=null}clone(){return new It(W({range:this.range,timeSlider:this.timeSlider,floorFilter:this.floorFilter}))}};i([o({type:di,json:{write:!0}})],Se.prototype,"range",void 0),i([o({type:ci,json:{write:!0}})],Se.prototype,"timeSlider",void 0),i([o({type:pi,json:{write:!0}})],Se.prototype,"floorFilter",void 0),Se=It=i([u("esri.webdoc.Widgets")],Se);const yi=Se,mi={width:600,height:400},Qe=1.5;function hi(e,t){t=t||mi;let{width:r,height:s}=t;const n=r/s;return n<Qe?s=r/Qe:n>Qe&&(r=s*Qe),r>e.width&&(s*=e.width/r,r=e.width),s>e.height&&(r*=e.height/s,s=e.height),{width:Math.round(r),height:Math.round(s)}}function gi(e,t){return t.resourceInfo?cr(t,t.resourceInfo,{origin:e.origin}):t.portalItem?.id?wi(e,t,t.portalItem):Promise.resolve()}function cr(e,t,r){const s={context:{...r,layerContainerType:"operational-layers"}};return e.portalItem&&(s.context.portal=e.portalItem.portal||Or.getDefault()),I(()=>import("./CTBv4vVY.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]),import.meta.url).then((({populateOperationalLayers:n})=>{const a=[],l=t.operationalLayers;l?.length&&a.push(n(e.layers,l,s));const p={...s,context:{...s.context,layerContainerType:"tables"},defaultLayerType:"ArcGISFeatureLayer"},d=t.tables;return d?.length&&a.push(n(e.tables,d,p)),Promise.allSettled(a).then((()=>{}))}))}async function wi(e,t,r){if(await r.load().catch((l=>{throw new z(`${e.name}:load-portal-item`,"Failed to load portal item",{error:l})})),r.type!==e.itemType)throw new z(`${e.name}:invalid-portal-item`,`Invalid portal item type '${r.type}', expected '${e.itemType}'`,{type:r.type});const s=await r.fetchData();t.resourceInfo=s;const n=Dr(r,e.origin);await fi(e,t,s,n),t.resourceReferences={portalItem:r,paths:n.readResourcePaths};const a=await bi(t.initialViewProperties,r,Le.getLogger(t));if(a){const l=t.initialViewProperties?.clone()??e.createInitialViewProperties();l.viewpoint=a,t.initialViewProperties=l}}function fi(e,t,r,s){const n=vi(e,r);return t.read(n,s),cr(t,n,s)}function vi(e,t){const r=e.parseVersion(t.version||"",e.name);return e.currentVersion.validate(r),t.version=`${r.major}.${r.minor}`,t}async function bi(e,t,r){if(e?.viewpoint?.targetGeometry)return null;const n=await Ii(e,t,r);return n?new he({targetGeometry:n}):null}async function Ii(e,t,r){const s=e?.spatialReference,n=t?.extent;if(!s||!n)return null;if(s.isWGS84)return n.clone();if(s.isWebMercator)return _r(n);const{getGeometryServiceURL:a}=await I(()=>import("./wufSWGKb.js"),__vite__mapDeps([25,3,4,15,13,2,12,8,6,26,27,21,22,28,29]),import.meta.url);try{const l=await a(t),p=new qr({geometries:[n],outSpatialReference:s});return(await zr(l,p))[0]}catch(l){r.error("Error projecting item's extent:",l)}return null}function Wt(e){return{enabled:!!e?.length}}var St;let Te=St=class extends c{constructor(e){super(e),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new St({exactMatch:this.exactMatch,type:this.type,name:this.name})}};i([o({type:Boolean,json:{write:!0}})],Te.prototype,"exactMatch",void 0),i([o({type:String,json:{write:!0}})],Te.prototype,"name",void 0),i([q(sr)],Te.prototype,"type",void 0),Te=St=i([u("esri.webdoc.applicationProperties.SearchLayerField")],Te);const Si=Te;var Tt;let je=Tt=class extends c{constructor(e){super(e),this.field=null,this.id=null,this.subLayer=null}clone(){return new Tt(W({field:this.field,id:this.id,subLayer:this.subLayer}))}};i([o({type:Si,json:{write:{isRequired:!0}}})],je.prototype,"field",void 0),i([o({type:String,json:{write:{isRequired:!0}}})],je.prototype,"id",void 0),i([o({type:ye,json:{write:!0}})],je.prototype,"subLayer",void 0),je=Tt=i([u("esri.webdoc.applicationProperties.SearchLayer")],je);const Ti=je;var jt;let Ne=jt=class extends c{constructor(e){super(e),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new jt({exactMatch:this.exactMatch,type:this.type,name:this.name})}};i([o({type:Boolean,json:{write:!0}})],Ne.prototype,"exactMatch",void 0),i([o({type:String,json:{write:!0}})],Ne.prototype,"name",void 0),i([q(sr)],Ne.prototype,"type",void 0),Ne=jt=i([u("esri.webdoc.applicationProperties.SearchTableField")],Ne);const ji=Ne;var Nt;let Ve=Nt=class extends c{constructor(e){super(e),this.field=null,this.id=null}clone(){return new Nt(W({field:this.field,id:this.id}))}};i([o({type:ji,json:{write:{isRequired:!0}}})],Ve.prototype,"field",void 0),i([o({type:String,json:{write:{isRequired:!0}}})],Ve.prototype,"id",void 0),Ve=Nt=i([u("esri.webdoc.applicationProperties.SearchTable")],Ve);const Ni=Ve;var Et;const yr=yt.ofType(Ti),mr=yt.ofType(Ni);let M=Et=class extends c{constructor(e){super(e),this.addressSearchEnabled=!0,this.enabled=!0,this.hintText=null,this.layers=new yr,this.tables=new mr}readAddressSearchEnabled(e){return!e}writeAddressSearchEnabled(e,t,r){t[r]=!e}clone(){return new Et(W({addressSearchEnabled:this.addressSearchEnabled,enabled:this.enabled,hintText:this.hintText,layers:this.layers,tables:this.tables}))}};i([o({type:Boolean,nonNullable:!0,json:{read:{source:"disablePlaceFinder"},write:{target:"disablePlaceFinder",isRequired:!0},origins:{"web-scene":{read:!1,write:!1}}}})],M.prototype,"addressSearchEnabled",void 0),i([x("addressSearchEnabled")],M.prototype,"readAddressSearchEnabled",null),i([j("addressSearchEnabled")],M.prototype,"writeAddressSearchEnabled",null),i([o({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-map":{write:{isRequired:!0}},"web-scene":{default:!0,write:!0}}}})],M.prototype,"enabled",void 0),i([o({type:String,json:{write:!0}})],M.prototype,"hintText",void 0),i([o({type:yr,json:{write:{overridePolicy:Wt},origins:{"web-scene":{write:{isRequired:!0}}}}})],M.prototype,"layers",void 0),i([o({type:mr,json:{read:!0,write:{overridePolicy:Wt}}})],M.prototype,"tables",void 0),M=Et=i([u("esri.webdoc.applicationProperties.Search")],M);const Ei=M;var _t;let st=_t=class extends c{constructor(e){super(e),this.search=null}clone(){return new _t(W({search:this.search}))}};i([o({type:Ei,json:{write:!0}})],st.prototype,"search",void 0),st=_t=i([u("esri.webdoc.applicationProperties.Viewing")],st);const _i=st;var $t;let Ee=$t=class extends c{constructor(e){super(e),this.editing=null,this.offline=null,this.viewing=null}clone(){return new $t(W({editing:this.editing,offline:this.offline,viewing:this.viewing}))}};i([o({json:{write:!0}})],Ee.prototype,"editing",void 0),i([o({json:{write:!0}})],Ee.prototype,"offline",void 0),i([o({type:_i,json:{write:!0}})],Ee.prototype,"viewing",void 0),Ee=$t=i([u("esri.webmap.ApplicationProperties")],Ee);const $i=Ee;var xt;let ee=xt=class extends c{constructor(){super(...arguments),this.url=""}destroy(){this.url=""}get isSecureUrl(){return Vr(this.url)}get isDataURI(){return ir(this.url)}clone(){return new xt({url:this.url})}};i([o({type:String,json:{write:{isRequired:!0}}})],ee.prototype,"url",void 0),i([o()],ee.prototype,"isSecureUrl",null),i([o()],ee.prototype,"isDataURI",null),ee=xt=i([u("esri.webdoc.support.SlideThumbnail")],ee);const xi={type:D,json:{read:{source:"timeExtent",reader:e=>e?Array.isArray(e)?D.fromArray(e):D.fromJSON(e):null},write:{writer:(e,t,r,s)=>{e&&(e.isEmpty?s?.messages&&s.messages.push(new z("invalid-timeExtent","TimeExtent cannot be empty")):t[r]=e.toArray())},target:{timeExtent:{type:[[ye,Kt]]}}}}};var At;let B=At=class extends Hr.IdentifiableMixin(c){constructor(e){super(e),this.name=null,this.thumbnail=new ee,this.timeExtent=null}castThumbnail(e){return typeof e=="string"?new ee({url:e}):Ir(ee,e)}set viewpoint(e){const{targetGeometry:t,scale:r}=e;t!=null&&t.type==="point"&&r==null&&Le.getLogger(this).warn("Bookmark.viewpoint should include 'scale' when its targetGeometry is a point.",e),this._set("viewpoint",e)}readViewpoint(e,t){const{extent:r,viewpoint:s}=t;return he.fromJSON(s||{targetGeometry:r})}writeViewpoint(e,t,r,s){if(!e)return;const{targetGeometry:n}=e;if(n==null||n.type==="extent")n!=null&&(t.extent=n.toJSON()),t[r]=e.toJSON();else{const a="Bookmark.viewpoint cannot be written to JSON when the viewpoint's targetGeometry is not an extent.";s?.messages?s.messages.push(new z("property:unsupported",a)):Le.getLogger(this).error(a)}}clone(){return new At(W({name:this.name,thumbnail:this.thumbnail,timeExtent:this.timeExtent,viewpoint:this.viewpoint}))}};i([o({type:String,nonNullable:!0,json:{write:{isRequired:!0}}})],B.prototype,"name",void 0),i([o({type:ee,json:{write:{overridePolicy:e=>({enabled:!(!e||!e.url)})}}})],B.prototype,"thumbnail",void 0),i([$r("thumbnail")],B.prototype,"castThumbnail",null),i([o(xi)],B.prototype,"timeExtent",void 0),i([o({type:he,nonNullable:!0,json:{write:!0}})],B.prototype,"viewpoint",null),i([x("viewpoint",["extent","viewpoint"])],B.prototype,"readViewpoint",null),i([j("viewpoint")],B.prototype,"writeViewpoint",null),B=At=i([u("esri.webmap.Bookmark")],B);const Ai=B;let Z=class extends N.ClonableMixin(Yt){constructor(t){super(t),this.background=null,this.rangeInfo=null,this.spatialReference=null,this.timeExtent=null,this.timeZone=Ur,this.viewpoint=null}};i([o({type:Rt})],Z.prototype,"background",void 0),i([o({type:Lt})],Z.prototype,"rangeInfo",void 0),i([o({type:We})],Z.prototype,"spatialReference",void 0),i([o({type:D})],Z.prototype,"timeExtent",void 0),i([o({nonNullable:!0})],Z.prototype,"timeZone",void 0),i([o({type:he})],Z.prototype,"viewpoint",void 0),Z=i([u("esri.webmap.InitialViewProperties")],Z);const dt=Z,hr=yt.ofType(Ai),ki=new Map([["image/jpeg","jpeg"],["image/jpg","jpg"],["image/png","png"],["image/gif","gif"]]),Ri="ArcGIS Pro",Oi=Jr.JSAPI;let w=class extends rr(Ot.LoadableMixin(Lr.EsriPromiseMixin(kr))){constructor(e){super(e),this._isAuthoringAppSetByUser=!1,this._isAuthoringAppVersionSetByUser=!1,this._thumbnailFilename=null,this._updateFromPromise=null,this.resourceReferences={portalItem:null,paths:[]},this.applicationProperties=null,this.bookmarks=new hr,this.floorInfo=null,this.initialViewProperties=new dt,this.portalItem=null,this.sourceVersion=null,this.widgets=null,this._debouncedSaveOperations=Sr((async(t,r,s)=>{const{save:n,saveAs:a}=await I(()=>import("./-UPQzl-i.js"),__vite__mapDeps([30,13,4,3,31,2,5,6,8,32,33,12,11,1,7,15,16,34,19,20,21,22,26,27,28,29,35,36,37,38,39,40,41,42,43]),import.meta.url);switch(t){case Ze.SAVE:return n(this.context,this,r);case Ze.SAVE_AS:return a(this.context,this,s,r)}})),this.authoringApp=this.authoringAppVersion=null,this._isAuthoringAppSetByUser=this._isAuthoringAppVersionSetByUser=!1}destroy(){this.portalItem=Tr(this.portalItem)}initialize(){if(this.when().catch((e=>{Le.getLogger(this).error("#load()","Failed to load web map",e)})),this.resourceInfo){let e;try{e=this._validateJSON(this.resourceInfo)}catch(t){return void this.addResolvingPromise(Promise.reject(t))}this.read(e)}}set authoringApp(e){this._isAuthoringAppSetByUser=!0,this._set("authoringApp",e)}writeAuthoringApp(e,t){e&&this._isAuthoringAppSetByUser?t.authoringApp=e:t.authoringApp=Oi}set authoringAppVersion(e){this._isAuthoringAppVersionSetByUser=!0,this._set("authoringAppVersion",e)}writeAuthoringAppVersion(e,t){e&&this._isAuthoringAppVersionSetByUser?t.authoringAppVersion=e:t.authoringAppVersion=xr}readInitialViewProperties(e,t){const r=new dt;t.background&&(r.background=Rt.fromJSON(t.background));const s=t.initialState?.timeExtent;s&&(r.timeExtent=D.fromArray(s));const n=t.initialState?.viewpoint;return n&&(n.rotation&&De.parse(t.version||"","webmap").lessThan(2,20)&&t.authoringApp===Ri&&(n.rotation*=-1),r.viewpoint=he.fromJSON(n)),t.mapRangeInfo&&(r.rangeInfo=Lt.fromJSON(t.mapRangeInfo)),t.spatialReference&&(r.spatialReference=We.fromJSON(t.spatialReference)),t.timeZone&&(r.timeZone=t.timeZone),r}writeInitialViewProperties(e,t,r,s){if(!e)return;e.background?.color&&(t.background=e.background.write({},s));const{timeExtent:n,viewpoint:a}=e;if(a||n){const l={};a&&(l.viewpoint=a.write({},s)),n&&(l.timeExtent=n.toArray()),t.initialState=l}e.rangeInfo&&(t.mapRangeInfo=e.rangeInfo.toJSON(s)),e.spatialReference&&(t.spatialReference=e.spatialReference.write({},s)),t.timeZone=e.timeZone}writeLayers(e,t,r,s){t[r]=this._writeLayers(e,s,"operational-layers")}readSourceVersion(e,t){const[r,s]=t.version.split(".");return new De(parseInt(r,10),parseInt(s,10))}writeSourceVersion(e,t,r){t[r]=`${this.context.currentVersion.major}.${this.context.currentVersion.minor}`}writeTables(e,t,r,s){const n=this._writeLayers(e,s,"tables");n.length&&(t[r]=n)}get thumbnailUrl(){return this.portalItem?.thumbnailUrl||null}set thumbnailUrl(e){e?(this._override("thumbnailUrl",e),this._thumbnailFilename=this._generateCustomThumbnailFilename(e)):this._clearThumbnailOverride()}get updatingFromView(){return!!this._updateFromPromise}load(e){return this.addResolvingPromise(gi(this.context,this)),Promise.resolve(this)}loadAll(){return tr(this,(e=>{e(this.ground,this.basemap,this.layers,this.tables)}))}read(e,t){t={...t,origin:this.context.origin};const r=this._getAuthoringPropsState();jr(this,e,(s=>super.read(e,s)),t),this._restoreAuthoringPropsFromState(r)}write(e,t){if(this.loadStatus!=="loaded"){const r=new z("webmap:not-loaded","Web map must be loaded before it can be serialized");throw Le.getLogger(this).error("#toJSON()","Web map must be loaded before it can be serialized",this.loadError||this.loadStatus),r}return this._removeDanglingLayerRefs(),t={...t,origin:this.context.origin,restrictedWebMapWriting:!0,webmap:this},super.write(e,t)}async save(e){return this._debouncedSaveOperations(Ze.SAVE,e)}async saveAs(e,t){return this._debouncedSaveOperations(Ze.SAVE_AS,t,e)}async updateFrom(e,t){const r=this._updateFromInternal(e,t);this._updateFromPromise=r,await r,r===this._updateFromPromise&&(this._updateFromPromise=null)}getLayerJSONFromResourceInfo(e){const t=this.resourceInfo;return this._collectAllLayersJSON([...t?.baseMap?.baseMapLayers||[],...t?.operationalLayers||[],...this.basemap?.resourceInfo?.data?.baseMapLayers||[]]).find((r=>r.id===e.id))}async updateItemThumbnail(){this.thumbnailUrl&&this._isOverridden("thumbnailUrl")&&(await this.portalItem?.updateThumbnail({thumbnail:this.thumbnailUrl,filename:this._thumbnailFilename}),this._clearThumbnailOverride())}getThumbnailState(){let e=this.thumbnailUrl;return e&&(e=this._isOverridden("thumbnailUrl")?e:Fr(e,"w","8192")),{thumbnailUrl:e,filename:this._thumbnailFilename}}restoreThumbnailFromState(e){this.thumbnailUrl=e.thumbnailUrl,this._thumbnailFilename=e.filename}_collectAllLayersJSON(e){return e.reduce(((t,r)=>(t.push(r),r.layerType==="GroupLayer"&&(t=t.concat(this._collectAllLayersJSON(r.layers||[]))),t)),[])}_writeLayers(e,t,r){return t={...t,layerContainerType:r},e.map((s=>Wr(s,r==="tables"?null:this.getLayerJSONFromResourceInfo(s),t))).filter(Rr).toArray()}_validateJSON(e){const t=De.parse(e.version||"","webmap");return this.context.currentVersion.validate(t),e.version=`${t.major}.${t.minor}`,e}_removeDanglingLayerRefs(){const e=this.applicationProperties,t=e?.viewing?.search,r=a=>this.allLayers.some((l=>l.id===a));if(t?.layers&&(t.layers=t.layers.filter((a=>r(a.id)))),t?.tables&&(t.tables=t.tables.filter((a=>this.tables.some((l=>l.id===a.id))))),e){const a=e.editing?.locationTracking;a?.info&&!r(a.info.layerId)&&(e.editing=null)}const s="presentation"in this?this.presentation:null,n=s?.slides;n&&n.forEach((a=>{a.visibleLayers&&(a.visibleLayers=a.visibleLayers.filter((l=>r(l.id))))}))}async _updateFromInternal(e,t){if(t??={},await Pr((()=>e.ready)),this._updateInitialViewProperties(e,t),e.map===this)for(const r of e.allLayerViews)"visible"in r&&"visible"in r.layer&&r._isOverridden("visible")&&(r.layer.visible=r.visible),"featureEffect"in r&&"featureEffect"in r.layer&&r._isOverridden("featureEffect")&&(r.layer.featureEffect=r.featureEffect);await this._updateThumbnailUrl(e,t)}_updateInitialViewProperties(e,t){if(t.backgroundExcluded||(this.initialViewProperties.background=e.background?.clone()),this.initialViewProperties.spatialReference=e.spatialReference?.clone(),this.initialViewProperties.timeZone=e.timeZone,t.viewpointExcluded||(this.initialViewProperties.viewpoint=new he({rotation:e.rotation,scale:t.scalePreserved?e.scale:null,targetGeometry:this._getViewExtent(e)})),!t.widgetsExcluded)for(const r of e.persistableViewModels)r.updateWebDocument(this)}_getViewExtent(e){const t=e.center.clone().normalize(),r=e.extent.clone(),s=r.width/2;return r.xmin=t.x-s,r.xmax=t.x+s,r}async _updateThumbnailUrl(e,t){if(t.thumbnailExcluded)return;const r=hi(e,t.thumbnailSize),s=await e.takeScreenshot({format:"png",width:r.width,height:r.height});this._setAutoGeneratedThumbnail(s.dataUrl)}_setAutoGeneratedThumbnail(e){this.thumbnailUrl=e,this._thumbnailFilename=null}_clearThumbnailOverride(){this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"),this._thumbnailFilename=null}_generateCustomThumbnailFilename(e){if(ir(e)){const t=Mr(e),r=t?.mediaType,s=r&&ki.get(r.toLowerCase())||null,n=`thumbnail${Date.now()}`;return s?`${n}.${s}`:n}return null}_getAuthoringPropsState(){return{authoringApp:this.authoringApp,authoringAppVersion:this.authoringAppVersion,isAuthoringAppSetByUser:this._isAuthoringAppSetByUser,isAuthoringAppVersionSetByUser:this._isAuthoringAppVersionSetByUser}}_restoreAuthoringPropsFromState(e){e.isAuthoringAppSetByUser?this.authoringApp=e.authoringApp:this._isAuthoringAppSetByUser=!1,e.isAuthoringAppVersionSetByUser?this.authoringAppVersion=e.authoringAppVersion:this._isAuthoringAppVersionSetByUser=!1}};i([o()],w.prototype,"_updateFromPromise",void 0),i([o({type:$i,json:{write:!0}})],w.prototype,"applicationProperties",void 0),i([o({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],w.prototype,"authoringApp",null),i([j("authoringApp")],w.prototype,"writeAuthoringApp",null),i([o({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],w.prototype,"authoringAppVersion",null),i([j("authoringAppVersion")],w.prototype,"writeAuthoringAppVersion",null),i([o({type:hr,json:{write:{overridePolicy:e=>({enabled:!!(e&&e.length>0),ignoreOrigin:!0})}}})],w.prototype,"bookmarks",void 0),i([o({type:ui,json:{name:"mapFloorInfo",write:!0}})],w.prototype,"floorInfo",void 0),i([o({type:dt,nonNullable:!0,json:{read:{source:["background","initialState.timeExtent","initialState.viewpoint","mapRangeInfo","spatialReference","timeZone"]},write:{ignoreOrigin:!0,target:{background:{type:Rt},"initialState.timeExtent":{type:D},"initialState.viewpoint":{type:he},mapRangeInfo:{type:Lt},spatialReference:{type:We},"timeZone:":{type:String}}}}})],w.prototype,"initialViewProperties",void 0),i([x("initialViewProperties")],w.prototype,"readInitialViewProperties",null),i([j("initialViewProperties")],w.prototype,"writeInitialViewProperties",null),i([o({json:{read:!1,write:{target:"operationalLayers",ignoreOrigin:!0}}})],w.prototype,"layers",void 0),i([j("layers")],w.prototype,"writeLayers",null),i([o({type:qe})],w.prototype,"portalItem",void 0),i([o()],w.prototype,"resourceInfo",void 0),i([o({readOnly:!0,type:De,json:{read:{source:"version"},write:{allowNull:!0,ignoreOrigin:!0,target:"version",isRequired:!0}}})],w.prototype,"sourceVersion",void 0),i([x("sourceVersion")],w.prototype,"readSourceVersion",null),i([j("sourceVersion")],w.prototype,"writeSourceVersion",null),i([o({json:{read:!1,write:{ignoreOrigin:!0}}})],w.prototype,"tables",void 0),i([j("tables")],w.prototype,"writeTables",null),i([o()],w.prototype,"thumbnailUrl",null),i([o()],w.prototype,"updatingFromView",null),i([o({type:yi,json:{write:!0}})],w.prototype,"widgets",void 0),w=i([u("esri.WebDocument2D")],w);const Ci=w;let K=class extends c{constructor(t){super(t),this.moment=null,this.fullUpdate=!1,this.validateErrorsCreated=!1,this.exceededTransferLimit=null,this.serviceEdits=null,this.discoveredSubnetworks=null}};i([o({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.moment=e?e.getTime():null}}}})],K.prototype,"moment",void 0),i([o({type:Boolean,json:{write:!0}})],K.prototype,"fullUpdate",void 0),i([o({type:Boolean,json:{write:!0}})],K.prototype,"validateErrorsCreated",void 0),i([o({type:Boolean,json:{write:!0}})],K.prototype,"exceededTransferLimit",void 0),i([o({type:[Object],json:{write:!0}})],K.prototype,"serviceEdits",void 0),i([o({type:[Object],json:{write:!0}})],K.prototype,"discoveredSubnetworks",void 0),K=i([u("esri.rest.networks.support.ValidateNetworkTopologyResult")],K);const Li=K,Ui=Qt()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let re=class extends Li{constructor(t){super(t),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(t){const r={...t,query:{f:"json"}},{data:s}=await me(this.statusUrl,r);return this.read(s),this.editsResolver&&this.editsResolver.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],exceededTransferLimit:!0,historicMoment:null}),this}async waitForJobCompletion(t={}){const{interval:r=1e3,statusCallback:s}=t;return new Promise(((n,a)=>{this._clearTimer();const l=setInterval((()=>{this._timer||a(Xt()),this.checkJobStatus().then((p=>{const{status:d}=p;switch(this.status=d,d){case"job-succeeded":this._clearTimer(),n(this);break;case"job-waiting":case"job-executing":s&&s(this)}}),(p=>{this._clearTimer(),a(p)}))}),r);this._timer=l}))}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};i([o()],re.prototype,"editsResolver",void 0),i([o({type:String,json:{write:!0}})],re.prototype,"statusUrl",void 0),i([q(Ui)],re.prototype,"status",void 0),i([o({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.submissionTime=e?e.getTime():null}}}})],re.prototype,"submissionTime",void 0),i([o({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.lastUpdatedTime=e?e.getTime():null}}}})],re.prototype,"lastUpdatedTime",void 0),re=i([u("esri.networks.support.TopologyValidationJobInfo")],re);const Pi=re;function Vi(e,t,r="from"){const{fromRuleElement:s,viaRuleElement:n,toRuleElement:a}=gr(e),l=[];switch(e.ruleType){case S.RTContainment:case S.RTAttachment:r==="from"&&V(t,s,!1)?l.push(a):r==="to"&&V(t,a,!1)&&l.push(s);break;case S.RTJunctionEdgeConnectivity:case S.RTJunctionJunctionConnectivity:V(t,s,!0)?l.push(a):V(t,a,!0)&&l.push(s);break;case S.RTEdgeJunctionEdgeConnectivity:n&&(V(t,n,!0)?(l.push(s),l.push(a)):(V(t,s,!0)||V(t,a,!0))&&l.push(n));break;default:return[]}return l}function Fe(e,t,r){const{fromRuleElement:s,viaRuleElement:n,toRuleElement:a}=gr(e);switch(e.ruleType){case S.RTContainment:case S.RTAttachment:return Xe(t,r,s,a,!1,!1);case S.RTJunctionEdgeConnectivity:case S.RTJunctionJunctionConnectivity:return Xe(t,r,s,a,!0,!0);case S.RTEdgeJunctionEdgeConnectivity:return Xe(t,r,s,n,!0,!0)||Xe(t,r,a,n,!0,!0);default:return!1}}function Xe(e,t,r,s,n,a){if(!r||!s)return!1;const l=V(e,r,a),p=V(t,s,a);if(n){const d=V(e,s,a),y=V(t,r,a);return l&&p||d&&y}return l&&p}function Fi(e,t){const r=e.terminal?.terminalId,s=t.terminalId;return r==null&&s==null||(r===1?s==null||s===1:r===s)}function V(e,t,r){const{assetGroupCode:s,assetTypeCode:n}=e;return("layerId"in e?e.layerId===t.networkSource?.layerId:e.networkSourceId===t.networkSource?.sourceId)&&(s==null||s===t.assetGroup?.assetGroupCode)&&(n==null||n===t.assetType?.assetTypeCode)&&(!r||!("terminalId"in e)||Fi(t,e))}function gr(e){return{fromRuleElement:{networkSource:e.fromNetworkSource,assetGroup:e.fromAssetGroup,assetType:e.fromAssetType,terminal:e.fromTerminal},viaRuleElement:e.viaNetworkSource?{networkSource:e.viaNetworkSource,assetGroup:e.viaAssetGroup,assetType:e.viaAssetType,terminal:e.viaTerminal}:void 0,toRuleElement:{networkSource:e.toNetworkSource,assetGroup:e.toAssetGroup,assetType:e.toAssetType,terminal:e.toTerminal}}}function fe(e){let t=null,r=null,s=null;if(pr(e))t=kt(e),[r,s]=Mi(e);else if(ur(e)){t=e.parent?.layerId??null;const[n]=ct(e);n===e.subtypeField&&(r=e.subtypeCode)}else t=e.layerId??null;return{layerId:t,assetGroupCode:r,assetTypeCode:s}}function kt(e){const{sourceLayer:t}=e;let r;return Xr(t)?r=t.layerId:ur(t)&&(r=t.parent?.layerId),r??null}function Mi(e){const[t,r]=ct(e.sourceLayer);return[t?e.attributes[t]:null,r?e.attributes[r]:null]}function ct(e){return!e||!("fieldsIndex"in e)?[null,null]:[e.fieldsIndex.normalizeFieldName("assetGroup")??null,e.fieldsIndex.normalizeFieldName("assetType")??null]}async function Ht(e,t){if(e==="Utility Network Layer"){const{default:r}=await I(()=>Promise.resolve().then(()=>Qi),void 0,import.meta.url);return new r({layerUrl:t})}return null}async function Bi(e){let t="portalItem"in e?e:{portalItem:e};!t.portalItem||t.portalItem instanceof qe||(t={...t,portalItem:new qe(t.portalItem)});const r=t.portalItem;if(await r.load(),r.type!=="Feature Service")throw new z("portal:unknown-item-type","Unknown item type '${type}'",{type:r.type});const s=r.url,n=await me(s,{responseType:"json",query:{f:"json"}}),a="Network Layer";if(n.data.type?.includes(a))return Ht(n.data.type,s);if(n.data.layers){const l=n.data.layers.find((p=>p.type.includes(a)));if(l){const p=`${s}/${l.id}`;return Ht(l.type,p)}}return null}let b=class extends rr(Ot){static fromPortalItem(e){return Bi(e)}constructor(e){super(e),this.id=null,this.title=null,this.layerUrl=null,this.dataElement=null,this.fullExtent=null,this.spatialReference=null,this.type=null,this.sourceJSON=null,this.gdbVersion=null,this.historicMoment=null,this._sourceIdByLayerId=new Map,this._layerIdBySourceId=new Map,this._applyEditsHandler=t=>{const{serviceUrl:r,gdbVersion:s,result:n}=t,a=r===this.featureServiceUrl,l=Jt(r,s,this.gdbVersion);a&&l&&n.then((p=>{ht(r,s)&&(this.historicMoment=p.historicMoment)}))},this._updateMomentHandler=t=>{const{serviceUrl:r,gdbVersion:s,moment:n}=t,a=r===this.featureServiceUrl,l=Jt(r,s,this.gdbVersion);a&&l&&(this.historicMoment=n)},this.when().then((()=>{this.addHandles([Kr(this._applyEditsHandler),Yr(this._updateMomentHandler)])}),(()=>{}))}initialize(){this.when().catch((e=>{Nr(e)||Le.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})}))}get datasetName(){return this.dataElement?.name??null}get owner(){return this.dataElement?.userIdentity??null}get schemaGeneration(){return this.dataElement?.schemaGeneration??null}get parsedUrl(){return Br(this.layerUrl)}get featureServiceUrl(){return Bt(this.parsedUrl.path).url.path}get networkServiceUrl(){return this.featureServiceUrl.replace(/\/FeatureServer/i,"/UtilityNetworkServer")}get layerId(){return Bt(this.parsedUrl.path).sublayer}get networkSystemLayers(){return null}async load(e){return this.addResolvingPromise(this._fetchDataElement(this.featureServiceUrl,this.layerId.toString(),e)),this.addResolvingPromise(this._fetchLayerMetaData(this.layerUrl,e)),this}getLayerIdBySourceId(e){if(!this.dataElement)return null;const t=this._layerIdBySourceId.get(e);if(t!=null)return t;const r=this.dataElement.domainNetworks,s=this._traverseNetworkSources(r,this._layerIdBySourceId,"sourceId","layerId",e);return s>=0?s:null}getSourceIdByLayerId(e){if(!this.dataElement)return null;const t=this._sourceIdByLayerId.get(e);if(t!=null)return t;const r=this.dataElement.domainNetworks,s=this._traverseNetworkSources(r,this._sourceIdByLayerId,"layerId","sourceId",e);return s>=0?s:null}getObjectIdsFromElements(e){const t=[],r=new Map;for(const n of e){const a=this.getLayerIdBySourceId(n.networkSourceId);if(a==null)continue;let l=r.get(a);l===void 0&&(l=[]),l.push(n.objectId),r.set(a,l)}const s=this.featureServiceUrl;return r.forEach(((n,a)=>t.push({layerUrl:`${s}/${a}`,objectIds:n}))),t}async queryNamedTraceConfigurations(e,t){const[{queryNamedTraceConfigurations:r},{default:s}]=await Promise.all([I(()=>import("./B1WkbkqS.js"),__vite__mapDeps([44,12,2,3,4,13,8,28]),import.meta.url),I(()=>import("./iDRwGU5l.js"),__vite__mapDeps([45,2,3,4]),import.meta.url)]),n=this.networkServiceUrl,a=s.from(e);return(await r(n,a,{...t}))?.namedTraceConfigurations}async validateTopology(e,t){if(!e.validateArea)throw new z("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");const[{validateNetworkTopology:r},{default:s}]=await Promise.all([I(()=>import("./C6ceJEB9.js"),__vite__mapDeps([46,12,2,3,4,13,8,28]),import.meta.url),I(()=>import("./DRZePt2j.js"),__vite__mapDeps([47,2,3,4,12,13,8,48,49]),import.meta.url)]),n=s.from(e);ht(this.featureServiceUrl,this.gdbVersion||null)?(n.sessionID=Gt,await Dt(this.featureServiceUrl,this.gdbVersion,!0)):n.sessionID=null,n.gdbVersion=this.gdbVersion;const a=this.networkServiceUrl,l=this.featureServiceUrl,p=qt(l,null,this.gdbVersion,!0),d=await r(a,n,{...t});if(d?.serviceEdits){const y=[];for(const f of d.serviceEdits){const{editedFeatures:h}=f,m=h?.spatialReference?new We(h.spatialReference):null;y.push({layerId:f.layerId,editedFeatures:{adds:h?.adds?.map((E=>et(E,m)))||[],updates:h?.updates?.map((E=>({original:et(E[0],m),current:et(E[1],m)})))||[],deletes:h?.deletes?.map((E=>et(E,m)))||[],spatialReference:m}})}p.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],editedFeatures:y,exceededTransferLimit:!1,historicMoment:d.moment})}return d}async submitTopologyValidationJob(e,t){let r=null;if(!e.validateArea)throw new z("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");if(!this.gdbVersion){const y=this.layerUrl.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");r=(await me(y,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}const[{submitValidateNetworkTopologyJob:s},{default:n}]=await Promise.all([I(()=>import("./C6ceJEB9.js"),__vite__mapDeps([46,12,2,3,4,13,8,28]),import.meta.url),I(()=>import("./DRZePt2j.js"),__vite__mapDeps([47,2,3,4,12,13,8,48,49]),import.meta.url)]),a=n.from(e);ht(this.featureServiceUrl,this.gdbVersion||null)?(a.sessionID=Gt,await Dt(this.featureServiceUrl,this.gdbVersion,!0)):a.sessionID=null,a.gdbVersion=this.gdbVersion||r;const l=this.networkServiceUrl,p=this.featureServiceUrl?qt(this.featureServiceUrl,null,this.gdbVersion,!0):void 0,d=await s(l,a,{...t});return new Pi({statusUrl:d,editsResolver:p})}getSourceTypeById(e){if(!this.dataElement)return null;for(const t of this.dataElement.domainNetworks)for(const r of[t.edgeSources??[],t.junctionSources??[]])for(const s of r)if(s.sourceId===e)return r===t.edgeSources?"edge":"junction";return null}_traverseNetworkSources(e,t,r,s,n){for(const a of e)for(const l of[a.edgeSources??[],a.junctionSources??[]])for(const p of l)if(p[r]===n)return t.set(n,p[s]),p[s];return-1}async _fetchLayerMetaData(e,t){const r=await me(e,{responseType:"json",query:{f:"json"},...t});this.sourceJSON=r.data,this.read(r.data,{origin:"service"})}async _fetchDataElement(e,t,r){if(this.dataElement)return;const s=await me(`${e}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([t]),f:"json"},...r}).then((n=>n.data.layerDataElements?.[0]));s&&this.read(s,{origin:"service"})}};function et(e,t){return new nr({attributes:e.attributes,geometry:lr({...e.geometry,spatialReference:t})})}i([o({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:!0}},read:!1}})],b.prototype,"id",void 0),i([o({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:{source:"name"}}},read:!1}})],b.prototype,"title",void 0),i([o({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"url"},write:{target:"url",isRequired:!0}}},read:!1}})],b.prototype,"layerUrl",void 0),i([o({type:Object,json:{origins:{service:{read:!0}},read:!1}})],b.prototype,"dataElement",void 0),i([o({type:Ar,json:{origins:{service:{read:{source:"extent"}}},read:!1}})],b.prototype,"fullExtent",void 0),i([o({type:We,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:!1}})],b.prototype,"spatialReference",void 0),i([o({type:["utility","trace"],readOnly:!0,json:{read:!1,write:!1}})],b.prototype,"type",void 0),i([o({readOnly:!0})],b.prototype,"datasetName",null),i([o({readOnly:!0})],b.prototype,"owner",null),i([o({readOnly:!0})],b.prototype,"schemaGeneration",null),i([o({readOnly:!0})],b.prototype,"parsedUrl",null),i([o({readOnly:!0})],b.prototype,"featureServiceUrl",null),i([o({readOnly:!0})],b.prototype,"networkServiceUrl",null),i([o({readOnly:!0})],b.prototype,"layerId",null),i([o()],b.prototype,"sourceJSON",void 0),i([o({readOnly:!0})],b.prototype,"networkSystemLayers",null),i([o()],b.prototype,"gdbVersion",void 0),i([o({type:Date})],b.prototype,"historicMoment",void 0),b=i([u("esri.networks.Network")],b);const Ji=b;let ie=class extends c.JSONSupportMixin(Ot){constructor(t){super(t),this.rulesCategorized={attachment:[],containment:[],connectivity:[]},this.request=me}initialize(){}async load(t){const r=this.rulesLayer.load(t).then((()=>this._initializeRulesTable()));return this.addResolvingPromise(r),this}getFeaturesCanAssociateWithClause(t,r,s){const n=new Map,[a,l]=ct(t.sourceLayer);if(!a||!l)return"";const p=fe(t),d=fe(r);s.forEach((f=>{const{type:h,direction:m}=f;this._getRulesForAssociationType(h).forEach((E=>{Vi(E,p,m).filter((L=>L.networkSource?.layerId===d.layerId)).forEach((L=>{const H=L.assetGroup?.assetGroupCode,A=L.assetType?.assetTypeCode;if(H!=null&&A!=null){const oe=n.get(H)??new Set;oe.add(A),n.set(H,oe)}}))}))}));let y=[];return this._mergeAssetCodes(n).forEach(((f,h)=>{const m=`${a} IN (${h})`,E=ti(l,[...f]);m&&E&&y.push(gt(m,E))})),y.length>1&&(y=y.map((f=>`(${f})`))),y.join(" OR ")}getFeaturesCanAssociateWith(t,r,s){return kt(t)==null?[]:r.filter((n=>this.canAssociateFeatures(t,n,s)))}canAssociateFeatures(t,r,s){if(!this._canSupportAssociations([t,r]))return!1;const n=fe(t),a=fe(r);return s.some((l=>{const{type:p,direction:d}=l;return this._getRulesForAssociationType(p).some((y=>d==="to"?Fe(y,a,n):Fe(y,n,a)))}))}getLayersCanAssociateWith(t,r,s){return kt(t)==null?[]:r.filter((n=>this.canAssociateFeatureToLayer(t,n,s)))}canAssociateFeatureToLayer(t,r,s){if(!this._canSupportAssociations([t,r]))return!1;const n=fe(t),a=fe(r);return s.some((l=>{const{type:p,direction:d}=l;return this._getRulesForAssociationType(p).some((y=>d==="to"?Fe(y,a,n):Fe(y,n,a)))}))}getFeatureSQL(t,r){const s=t.layerId.toString(),n=t.fieldsIndex?.normalizeFieldName("assetGroup"),a=t.fieldsIndex?.normalizeFieldName("assetType"),l=n?r.attributes[n]:null,p=a?r.attributes[a]:null,d=this.rulesHash[s];if(d){const y=d.assetGroupHash[l];if(y)return y.assetTypeHash[p]||null}return null}async _initializeRulesTable(){const t={};let r;(function(n){n[n.from=0]="from",n[n.to=1]="to",n[n.via=2]="via"})(r||(r={}));const s=[{networkSourceId:"fromNetworkSource",assetGroupId:"fromAssetGroup",assetTypeId:"fromAssetType"},{networkSourceId:"toNetworkSource",assetGroupId:"toAssetGroup",assetTypeId:"toAssetType"},{networkSourceId:"viaNetworkSource",assetGroupId:"viaAssetGroup",assetTypeId:"viaAssetType"}];this.rulesCategorized={attachment:[],containment:[],connectivity:[]};for(const n of this.rules){if(n.ruleType===S.RTAttachment){this.rulesCategorized.attachment.push(n);continue}if(n.ruleType===S.RTContainment){this.rulesCategorized.containment.push(n);continue}if(n.ruleType===S.RTJunctionJunctionConnectivity){this.rulesCategorized.connectivity.push(n);continue}this.rulesCategorized.connectivity.push(n);let a=[[r.from,r.to],[r.to,r.from]];n.ruleType===S.RTEdgeJunctionEdgeConnectivity&&(a=[[r.from,r.via],[r.via,r.from],[r.to,r.via],[r.via,r.to]]);for(const l of a){const p=l.shift(),d=l.shift();let y=!1;switch(n.ruleType){case S.RTEdgeJunctionEdgeConnectivity:y=p===r.from||p===r.to;break;case S.RTJunctionEdgeConnectivity:y=p===r.to}const f=s[p],h=n[f.networkSourceId]?.layerId.toString()??"",m=n[f.assetGroupId]?.assetGroupCode?.toString(),E=n[f.assetTypeId],L=E?.assetTypeCode?.toString(),H=s[d],A=n[H.networkSourceId]?.layerId.toString()??"",oe=n[H.assetGroupId]?.assetGroupCode?.toString(),we=n[H.assetTypeId],He=we?.assetTypeCode?.toString(),Ue=t[h]??{assetGroupHash:{}};if(!(m&&L&&oe&&He))continue;const k=Ue.assetGroupHash[m]??{assetTypeHash:{}},v=k.assetTypeHash[L]??{};if(v[A]=v[A]??{},y){v[h]=v[h]??{};const se=gt(`assetgroup = ${m}`,`assettype = ${L}`);we?.connectivityPolicy==="esriNECPEndVertex"?v[h].endVertex=v[h]?.endVertex?`${v[h].endVertex}`:`(${se})`:v[h].anyVertex=v[h].anyVertex?`${v[h].anyVertex}`:`(${se})`}const _=gt(`assetgroup = ${oe}`,`assettype = ${He}`);we?.connectivityPolicy==="esriNECPEndVertex"?v[A].endVertex=v[A]?.endVertex?zt(v[A].endVertex,_):`(${_})`:v[A].anyVertex=v[A]?.anyVertex?zt(v[A].anyVertex,_):`(${_})`,k.assetTypeHash[L]=v,Ue.assetGroupHash[m]=k,t[h]=Ue}}this._set("rulesHash",t)}_getRulesForAssociationType(t){const{rulesCategorized:r}=this;switch(t){case"attachment":return r.attachment;case"containment":return r.containment;case"connectivity":case"junction-junction-connectivity":return r.connectivity.filter((s=>s.ruleType===S.RTJunctionJunctionConnectivity));case"junction-edge-from-connectivity":case"junction-edge-midspan-connectivity":case"junction-edge-to-connectivity":return r.connectivity.filter((s=>s.ruleType===S.RTJunctionEdgeConnectivity||s.ruleType===S.RTEdgeJunctionEdgeConnectivity));default:return[]}}_areSetsEqual(t,r){if(t.size!==r.size)return!1;for(const s of t)if(!r.has(s))return!1;return!0}_mergeAssetCodes(t){const r=new Map,s=new Set;for(const[n,a]of t){const l=new Set([n]);for(const[d,y]of t)n!==d&&!s.has(d)&&this._areSetsEqual(a,y)&&(l.add(d),s.add(d));const p=Array.from(l).sort().join(",");r.set(p,a)}return r}_canSupportAssociations(t){return t.every((r=>{const s=pr(r)?r.sourceLayer:r,[n,a]=ct(s);return n!=null&&a!=null}))}};i([o({constructOnly:!0})],ie.prototype,"rulesLayer",void 0),i([o({constructOnly:!0})],ie.prototype,"rules",void 0),i([o({readOnly:!0})],ie.prototype,"rulesHash",void 0),i([o()],ie.prototype,"rulesCategorized",void 0),i([o({constructOnly:!0})],ie.prototype,"request",void 0),ie=i([u("esri.networks.RulesTable")],ie);let O=class extends c{constructor(t){super(t),this.conditionBarriers=[],this.outputConditions=[],this.functions=[],this.functionBarriers=[],this.traversabilityScope=null,this.shortestPathNetworkAttributeName=null,this.includeBarriers=null,this.validateConsistency=null,this.ignoreBarriersAtStartingPoints=null}};i([o({type:[Object],json:{write:!0}})],O.prototype,"conditionBarriers",void 0),i([o({type:[Object],json:{write:!0}})],O.prototype,"outputConditions",void 0),i([o({type:[Object],json:{write:!0}})],O.prototype,"functions",void 0),i([o({type:[Object],json:{write:!0}})],O.prototype,"functionBarriers",void 0),i([o({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],O.prototype,"traversabilityScope",void 0),i([o({type:String,json:{write:!0}})],O.prototype,"shortestPathNetworkAttributeName",void 0),i([o({type:Boolean,json:{write:!0}})],O.prototype,"includeBarriers",void 0),i([o({type:Boolean,json:{write:!0}})],O.prototype,"validateConsistency",void 0),i([o({type:Boolean,json:{write:!0}})],O.prototype,"ignoreBarriersAtStartingPoints",void 0),O=i([u("esri.networks.support.TraceConfiguration")],O);const Ut=O;let g=class extends Ut{constructor(t){super(t),this.filterBarriers=[],this.arcadeExpressionBarrier=null,this.circuitName=null,this.domainNetworkName=null,this.filterBitsetNetworkAttributeName=null,this.filterFunctionBarriers=[],this.filterScope=null,this.includeContainers=null,this.includeContent=null,this.includeIsolated=null,this.includeStructures=null,this.allowIndeterminateFlow=null,this.includeUpToFirstSpatialContainer=null,this.inferConnectivity=null,this.maxHops=null,this.nearestNeighbor=null,this.numPaths=null,this.outputFilterCategories=[],this.outputFilters=[],this.propagators=[],this.subnetworkName=null,this.targetTierName=null,this.diagramTemplateName=null,this.tierName=null,this.validateLocatability=null}};i([o({type:[Object],json:{write:!0}})],g.prototype,"filterBarriers",void 0),i([o({type:String,json:{write:!0}})],g.prototype,"arcadeExpressionBarrier",void 0),i([o({type:String,json:{write:!0}})],g.prototype,"circuitName",void 0),i([o({type:String,json:{write:!0}})],g.prototype,"domainNetworkName",void 0),i([o({type:String,json:{write:!0}})],g.prototype,"filterBitsetNetworkAttributeName",void 0),i([o({type:[Object],json:{write:!0}})],g.prototype,"filterFunctionBarriers",void 0),i([o({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],g.prototype,"filterScope",void 0),i([o({type:Boolean,json:{write:!0}})],g.prototype,"includeContainers",void 0),i([o({type:Boolean,json:{write:!0}})],g.prototype,"includeContent",void 0),i([o({type:Boolean,json:{write:!0}})],g.prototype,"includeIsolated",void 0),i([o({type:Boolean,json:{write:!0}})],g.prototype,"includeStructures",void 0),i([o({type:Boolean,json:{write:!0}})],g.prototype,"allowIndeterminateFlow",void 0),i([o({type:Boolean,json:{write:!0}})],g.prototype,"includeUpToFirstSpatialContainer",void 0),i([o({type:Boolean,json:{write:!0}})],g.prototype,"inferConnectivity",void 0),i([o({type:Number,json:{write:!0}})],g.prototype,"maxHops",void 0),i([o({type:Object,json:{write:!0}})],g.prototype,"nearestNeighbor",void 0),i([o({type:Number,json:{write:!0}})],g.prototype,"numPaths",void 0),i([o({type:[Object],json:{write:!0}})],g.prototype,"outputFilterCategories",void 0),i([o({type:[Object],json:{write:!0}})],g.prototype,"outputFilters",void 0),i([o({type:[Object],json:{write:!0}})],g.prototype,"propagators",void 0),i([o({type:String,json:{write:!0}})],g.prototype,"subnetworkName",void 0),i([o({type:String,json:{write:!0}})],g.prototype,"targetTierName",void 0),i([o({type:String,json:{write:!0}})],g.prototype,"diagramTemplateName",void 0),i([o({type:String,json:{write:!0}})],g.prototype,"tierName",void 0),i([o({type:Boolean,json:{write:!0}})],g.prototype,"validateLocatability",void 0),g=i([u("esri.networks.support.UNTraceConfiguration")],g);const Gi=g;let $=class extends Cr{constructor(t){super(t),this.globalId=null,this.title=null,this.traceConfiguration=null,this.creationDate=null,this.creator=null,this.description=null,this.minStartingPoints=null,this.resultTypes=[],this.tags=[],this.traceType=null}readTraceConfiguration(t,r){return t.tierName!==void 0?Gi.fromJSON(t):Ut.fromJSON(t)}};i([o({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"id"},write:{target:"id",isRequired:!0}},service:{read:{source:"globalId"},write:{target:"globalId",isRequired:!0}}},read:!1}})],$.prototype,"globalId",void 0),i([o({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"title"},write:{target:"title",isRequired:!0}},service:{read:{source:"name"},write:{target:"name",isRequired:!0}}},read:!1}})],$.prototype,"title",void 0),i([o({type:Ut,json:{origins:{service:{read:!0,write:!0}},read:!1}})],$.prototype,"traceConfiguration",void 0),i([x("service","traceConfiguration")],$.prototype,"readTraceConfiguration",null),i([o({type:Date,json:{origins:{service:{read:!0,write:!0}},read:!1}})],$.prototype,"creationDate",void 0),i([o({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],$.prototype,"creator",void 0),i([o({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],$.prototype,"description",void 0),i([o({type:["none","one","many"],json:{origins:{service:{read:{source:"minNumStartingPoints"},write:{target:"minNumStartingPoints"}}},read:!1}})],$.prototype,"minStartingPoints",void 0),i([o({json:{origins:{service:{read:!0,write:!0}},read:!1}})],$.prototype,"resultTypes",void 0),i([o({type:[String],json:{origins:{service:{read:!0,write:!0}},read:!1}})],$.prototype,"tags",void 0),i([o({type:Ke.apiValues,json:{type:Ke.jsonValues,origins:{service:{read:Ke.read,write:Ke.write}},read:!1}})],$.prototype,"traceType",void 0),$=i([u("esri.networks.support.NamedTraceConfiguration")],$);const Di=$;let C=class extends Yt{constructor(t){super(t),this.rulesTableId=null,this.rulesTableUrl=null,this.subnetworksTableId=null,this.subnetworksTableUrl=null,this.dirtyAreasLayerId=null,this.dirtyAreasLayerUrl=null,this.associationsTable=null,this.associationsTableId=null,this.associationsTableUrl=null}destroy(){this.associationsTable?.destroy()}async loadAssociationsTable(){if(!this.associationsTable){const{associationsTableUrl:t}=this;if(!t)throw new z("utility-network-system-layers:missing-associations-table-url","Unable to load the associations table, as the `associationsTableUrl` is not set.");this.associationsTable=new ar({url:t})}return await this.associationsTable.load(),this.associationsTable}};i([o({constructOnly:!0})],C.prototype,"rulesTableId",void 0),i([o({constructOnly:!0})],C.prototype,"rulesTableUrl",void 0),i([o({constructOnly:!0})],C.prototype,"subnetworksTableId",void 0),i([o({constructOnly:!0})],C.prototype,"subnetworksTableUrl",void 0),i([o({constructOnly:!0})],C.prototype,"dirtyAreasLayerId",void 0),i([o({constructOnly:!0})],C.prototype,"dirtyAreasLayerUrl",void 0),i([o()],C.prototype,"associationsTable",void 0),i([o({constructOnly:!0})],C.prototype,"associationsTableId",void 0),i([o({constructOnly:!0})],C.prototype,"associationsTableUrl",void 0),C=i([u("esri.networks.support.NetworkSystemLayers")],C);let _e=class extends c{constructor(t){super(t),this.id=null,this.name=null}};i([o({type:Number,json:{read:{source:"terminalId"},write:{target:"terminalId"}}})],_e.prototype,"id",void 0),i([o({type:String,json:{read:{source:"terminalName"},write:{target:"terminalName"}}})],_e.prototype,"name",void 0),i([o({type:Boolean,json:{write:!0}})],_e.prototype,"isUpstreamTerminal",void 0),_e=i([u("esri.networks.support.Terminal")],_e);const qi=_e,tt=new ge({esriUNTMBidirectional:"bidirectional",esriUNTMDirectional:"directional"});let X=class extends c{constructor(t){super(t),this.defaultConfiguration=null,this.id=null,this.name=null,this.terminals=[],this.traversabilityModel=null}};i([o({type:String,json:{write:!0}})],X.prototype,"defaultConfiguration",void 0),i([o({type:Number,json:{read:{source:"terminalConfigurationId"},write:{target:"terminalConfigurationId"}}})],X.prototype,"id",void 0),i([o({type:String,json:{read:{source:"terminalConfigurationName"},write:{target:"terminalConfigurationName"}}})],X.prototype,"name",void 0),i([o({type:[qi],json:{write:!0}})],X.prototype,"terminals",void 0),i([o({type:tt.apiValues,json:{type:tt.jsonValues,read:tt.read,write:tt.write}})],X.prototype,"traversabilityModel",void 0),X=i([u("esri.networks.support.TerminalConfiguration")],X);let $e=class extends c{constructor(t){super(t),this.line=null,this.multipoint=null,this.polygon=null}};i([o({type:Ct,json:{write:!0},readOnly:!0})],$e.prototype,"line",void 0),i([o({type:ii,json:{read:{source:"point"},write:{target:"point"}},readOnly:!0})],$e.prototype,"multipoint",void 0),i([o({type:oi,json:{write:!0},readOnly:!0})],$e.prototype,"polygon",void 0),$e=i([u("esri.rest.networks.support.AggregatedGeometry")],$e);const zi=$e;let Y=class extends c{constructor(t){super(t),this.edgeElement=null,this.junctionElement=null}readEdgeElement(t,r){return new ze({networkSourceId:r.edgeNetworkSourceId,globalId:r.edgeGlobalId,objectId:r.edgeObjectId,positionFrom:r.edgePositionFrom,positionTo:r.edgePositionTo,firstUnit:r.edgeFirstUnit,numUnits:r.edgeNumUnits})}writeEdgeElement(t,r){r.edgeNetworkSourceId=t.networkSourceId,r.edgeGlobalId=t.globalId,r.edgeObjectId=t.objectId,r.edgePositionFrom=t.positionFrom,r.edgePositionTo=t.positionTo,r.edgeFirstUnit=t.firstUnit,r.edgeNumUnits=t.numUnits}readJunctionElement(t,r){return new ze({networkSourceId:r.junctionNetworkSourceId,globalId:r.junctionGlobalId,objectId:r.junctionObjectId,terminalId:r.junctionTerminalId,firstUnit:r.junctionFirstUnit,numUnits:r.junctionNumUnits})}writeJunctionElement(t,r){r.junctionNetworkSourceId=t.networkSourceId,r.junctionGlobalId=t.globalId,r.junctionObjectId=t.objectId,r.junctionTerminalId=t.terminalId,r.junctionFirstUnit=t.firstUnit,r.junctionNumUnits=t.numUnits}};i([o({type:ze,json:{read:{source:["edgeNetworkSourceId","edgeGlobalId","edgeObjectId","edgePositionFrom","edgePositionTo","edgeFirstUnit","edgeNumUnits"]},write:!0}})],Y.prototype,"edgeElement",void 0),i([x("edgeElement")],Y.prototype,"readEdgeElement",null),i([j("edgeElement")],Y.prototype,"writeEdgeElement",null),i([o({type:ze,json:{read:{source:["junctionNetworkSourceId","junctionGlobalId","junctionObjectId","junctionTerminalId","junctionFirstUnit","junctionNumUnits"]},write:!0}})],Y.prototype,"junctionElement",void 0),i([x("junctionElement")],Y.prototype,"readJunctionElement",null),i([j("junctionElement")],Y.prototype,"writeJunctionElement",null),Y=i([u("esri.rest.networks.support.CircuitPathConnectivityElement")],Y);const Wi=Y,rt=new ge({startingPoint:"starting-point",barrier:"barrier",stoppingPoint:"stopping-point"});let J=class extends c{constructor(t){super(t),this.globalId=null,this.isFilterBarrier=!1,this.percentAlong=null,this.terminalId=null,this.type=null,this.firstUnit=null,this.numUnits=null}};i([o({type:String,json:{write:!0}})],J.prototype,"globalId",void 0),i([o({type:Boolean,json:{write:!0}})],J.prototype,"isFilterBarrier",void 0),i([o({type:Number,json:{write:!0}})],J.prototype,"percentAlong",void 0),i([o({type:Number,json:{write:!0}})],J.prototype,"terminalId",void 0),i([o({type:rt.apiValues,json:{type:rt.jsonValues,read:{reader:rt.read,source:"traceLocationType"},write:{writer:rt.write,target:"traceLocationType"}}})],J.prototype,"type",void 0),i([o({type:Number,json:{write:!0}})],J.prototype,"firstUnit",void 0),i([o({type:Number,json:{write:!0}})],J.prototype,"numUnits",void 0),J=i([u("esri.rest.networks.support.TraceLocation")],J);const Zt=J;let Q=class extends c{constructor(t){super(t),this.pathId=null,this.orderId=null,this.startingPoint=null,this.stoppingPoint=null,this.pathConnectivity=[],this.geometry=null}};i([o({type:Number,json:{write:!0}})],Q.prototype,"pathId",void 0),i([o({type:Number,json:{write:!0}})],Q.prototype,"orderId",void 0),i([o({type:Zt,json:{write:!0}})],Q.prototype,"startingPoint",void 0),i([o({type:Zt,json:{write:!0}})],Q.prototype,"stoppingPoint",void 0),i([o({type:[Wi],json:{write:!0}})],Q.prototype,"pathConnectivity",void 0),i([o({type:Ct,json:{write:!0}})],Q.prototype,"geometry",void 0),Q=i([u("esri.rest.networks.support.CircuitPath")],Q);const Pt=Q;let le=class extends c{constructor(t){super(t),this.circuit=null,this.geometry=null,this.path=null}readCircuit(t,r){const s=r.sections?.map((n=>({...n,path:Pt.fromJSON(n.path)})));return{name:r.name,globalId:r.globalId,isSectioned:r.isSectioned,sectionOrder:r.sectionOrder,startLocation:r.startLocation,stopLocation:r.stopLocation,sections:s,subcircuits:r.subcircuits,lastVerifiedTime:r.lastVerifiedTime?new Date(r.lastVerifiedTime):null,lastExportedTime:r.lastExportedTime?new Date(r.lastExportedTime):null,circuitType:r.circuitType,status:r.status}}};i([o({type:Object,json:{write:!0,read:{source:["name","globalId","isSectioned","sectionOrder","startLocation","stopLocation","sections","subcircuits","lastVerifiedTime","lastExportedTime","circuitType","status"]}}})],le.prototype,"circuit",void 0),i([x("circuit")],le.prototype,"readCircuit",null),i([o({type:Ct,json:{write:!0}})],le.prototype,"geometry",void 0),i([o({type:Pt,json:{write:!0}})],le.prototype,"path",void 0),le=i([u("esri.rest.networks.support.CircuitTraceResult")],le);const Hi=le;let xe=class extends c{constructor(e){super(e),this.functionType=null,this.networkAttributeName=null,this.result=null}};i([o({type:["add","subtract","average","count","min","max"],json:{write:!0},readOnly:!0})],xe.prototype,"functionType",void 0),i([o({type:String,json:{write:!0},readOnly:!0})],xe.prototype,"networkAttributeName",void 0),i([o({type:Number,json:{write:!0},readOnly:!0})],xe.prototype,"result",void 0),xe=i([u("esri.rest.networks.support.FunctionResult")],xe);const Zi=xe;let R=class extends c{constructor(t){super(t),this.aggregatedGeometry=null,this.circuits=null,this.elements=null,this.globalFunctionResults=null,this.kFeaturesForKNNFound=!1,this.paths=null,this.startingPointsIgnored=!1,this.warnings=null}readNetworkElements(t,r){return r.elements!=null?r.elements.map((s=>"firstUnit"in s&&"numUnits"in s?new ze({...s}):new dr({...s}))):[]}writeNetworkElements(t,r){r.elements=t.map((s=>s.toJSON()))}};i([o({type:zi,json:{write:!0},readOnly:!0})],R.prototype,"aggregatedGeometry",void 0),i([o({type:[Hi],json:{write:!0},readOnly:!0})],R.prototype,"circuits",void 0),i([o({type:[dr],json:{write:!0},readOnly:!0})],R.prototype,"elements",void 0),i([x("elements")],R.prototype,"readNetworkElements",null),i([j("elements")],R.prototype,"writeNetworkElements",null),i([o({type:[Zi],json:{write:!0},readOnly:!0})],R.prototype,"globalFunctionResults",void 0),i([o({type:Boolean,json:{write:!0},readOnly:!0})],R.prototype,"kFeaturesForKNNFound",void 0),i([o({type:[Pt],json:{write:!0},readOnly:!0})],R.prototype,"paths",void 0),i([o({type:Boolean,json:{write:!0},readOnly:!0})],R.prototype,"startingPointsIgnored",void 0),i([o({type:[String],json:{write:!0},readOnly:!0})],R.prototype,"warnings",void 0),R=i([u("esri.rest.networks.support.TraceResult")],R);const Ki=Qt()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let ue=class extends R{constructor(t){super(t),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(t){const r={...t,query:{f:"json"}},{data:s}=await me(this.statusUrl,r),n=s.traceResults?{...s.traceResults,...s}:s;return this.read(n),this}async waitForJobCompletion(t={}){const{interval:r=1e3,statusCallback:s}=t;return new Promise(((n,a)=>{this._clearTimer();const l=setInterval((()=>{this._timer||a(Xt()),this.checkJobStatus().then((p=>{const{status:d}=p;switch(this.status=d,d){case"job-succeeded":this._clearTimer(),n(this);break;case"job-waiting":case"job-executing":s&&s(this)}}),(p=>{this._clearTimer(),a(p)}))}),r);this._timer=l}))}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};i([o({type:String,json:{write:!0}})],ue.prototype,"statusUrl",void 0),i([q(Ki)],ue.prototype,"status",void 0),i([o({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.submissionTime=e?e.getTime():null}}}})],ue.prototype,"submissionTime",void 0),i([o({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.lastUpdatedTime=e?e.getTime():null}}}})],ue.prototype,"lastUpdatedTime",void 0),ue=i([u("esri.networks.support.TraceJobInfo")],ue);let G=class extends Ji{constructor(e){super(e),this.sharedNamedTraceConfigurations=[],this.type="utility",this._terminalById=new Map,this._circuitManagerMap=new Map,this._unitIdentifierManager=null}get serviceTerritoryFeatureLayerId(){return this.dataElement?.serviceTerritoryFeatureLayerId??null}get networkSystemLayers(){return new C({rulesTableId:this.sourceJSON?.systemLayers.rulesTableId,rulesTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.rulesTableId}`:null,subnetworksTableId:this.sourceJSON?.systemLayers.subnetworksTableId,subnetworksTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.subnetworksTableId}`:null,dirtyAreasLayerId:this.sourceJSON?.systemLayers.dirtyAreasLayerId,dirtyAreasLayerUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.dirtyAreasLayerId}`:null,associationsTableId:this.sourceJSON?.systemLayers.associationsTableId,associationsTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.associationsTableId}`:null})}get terminalConfigurations(){return this.dataElement?.terminalConfigurations.map((e=>X.fromJSON(e)))||[]}get domainNetworkNames(){return this.dataElement?.domainNetworks.map((e=>e.domainNetworkName))||[]}get _utilityLayerList(){const e=new Set;return this.dataElement?.domainNetworks?.map((t=>{t?.edgeSources?.map((({layerId:r,sourceId:s})=>{this._layerIdBySourceId.set(s,r),this._sourceIdByLayerId.set(r,s),e.add(r)})),t?.junctionSources?.map((({layerId:r,sourceId:s})=>{this._layerIdBySourceId.set(s,r),this._sourceIdByLayerId.set(r,s),e.add(r)}))})),e}get hasTelecomNetwork(){return this.dataElement?.domainNetworks.some((e=>e.isTelecomNetwork))??!1}async load(e){return this.addResolvingPromise(super.load(e)),this.addResolvingPromise(this._loadNamedTraceConfigurationsFromNetwork(e)),this}getTerminalConfiguration(e){let t=null,r=null;const s=e.sourceLayer;let n=null;if(s?.type==="feature"){if(n=s.layerId,n===null)return null}else if(s?.type!=="subtype-sublayer"||(n=s?.parent?.layerId??null,n===null))return null;const a=e.attributes;if(a==null)return null;for(const d of Object.keys(a))d.toUpperCase()==="ASSETGROUP"&&(t=e.getAttribute(d)),d.toUpperCase()==="ASSETTYPE"&&(r=e.getAttribute(d));if(!this.dataElement)return null;let l=null;const p=this.dataElement.domainNetworks;for(const d of p){const y=d.junctionSources?.find((f=>f.layerId===n));if(y){const f=y.assetGroups?.find((h=>h.assetGroupCode===t));if(f){const h=f.assetTypes?.find((m=>m.assetTypeCode===r));if(h?.isTerminalConfigurationSupported){l=h.terminalConfigurationId;break}}}}if(l!=null){const d=this.dataElement.terminalConfigurations,y=d?.find((f=>f.terminalConfigurationId===l));return y?X.fromJSON(y):null}return null}getTierNames(e){return this.dataElement?.domainNetworks.find((r=>r.domainNetworkName===e))?.tiers?.map((r=>r.name))||[]}async getRulesTable(){return this._sharedRulesTable||(this._sharedRulesTable=this._createRulesTable()),await this._sharedRulesTable}async getCircuitManager(e){if(!this.hasTelecomNetwork)return null;const t=this.dataElement?.domainNetworks.find((s=>s.domainNetworkName===e&&s.isTelecomNetwork));if(!t)return null;const{default:r}=await I(()=>import("./D136DD96.js"),__vite__mapDeps([50,13,2,3,4,51,5,6,12,8,41]),import.meta.url);return Er(this._circuitManagerMap,e,(()=>new r({utilityNetwork:this,telecomDomainNetwork:t})))}async getUnitIdentifierManager(){if(!this.hasTelecomNetwork)return null;if(this._unitIdentifierManager)return this._unitIdentifierManager;const{default:e}=await I(()=>import("./Ddv3h-S7.js"),__vite__mapDeps([52,13,2,3,4,51,5,6,12,8,41]),import.meta.url);return this._unitIdentifierManager=new e({utilityNetwork:this}),this._unitIdentifierManager}getTerminalById(e){if(!this.dataElement||e==null)return null;const t=this._terminalById.get(e);return t??(this.terminalConfigurations.forEach((r=>{r.terminals.forEach((s=>{this._terminalById.set(s.id,s)}))})),this._terminalById.get(e))}isUtilityLayer(e){return"layerId"in e?this._utilityLayerList.has(e?.layerId)&&(e.url?.startsWith(this.featureServiceUrl)??!1):!(e.type!=="subtype-sublayer"||!e.parent)&&this._utilityLayerList.has(e.parent.layerId)&&(e.parent.url?.startsWith(this.featureServiceUrl)??!1)}async queryAssociations(e,t){const[{queryAssociations:r},{default:s}]=await Promise.all([I(()=>import("./CEkMdQX5.js"),__vite__mapDeps([53,12,2,3,4,13,8,48,49,28,54,21,22]),import.meta.url),I(()=>import("./KBCwGpJQ.js"),__vite__mapDeps([55,2,3,4,48,49]),import.meta.url)]),n=s.from(e);return n.gdbVersion=this.gdbVersion,n.moment=this.historicMoment,(await r(this.networkServiceUrl,n,t)).associations}async synthesizeAssociationGeometries(e){const[{synthesizeAssociationGeometries:t},{default:r}]=await Promise.all([I(()=>import("./C5g0-b5x.js"),__vite__mapDeps([56,12,2,3,4,13,8,28,54,21,22,48,49]),import.meta.url),I(()=>import("./B5lkJr4T.js"),__vite__mapDeps([57,2,3,4,12,13,8]),import.meta.url)]),s=r.from(e);return s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment,t(this.networkServiceUrl,s)}async trace(e){const[{trace:t},{default:r}]=await Promise.all([I(()=>import("./DmxrO30_.js"),__vite__mapDeps([58,12,2,3,4,13,8,28]),import.meta.url),I(()=>import("./BbbEEtGm.js"),__vite__mapDeps([59,2,3,4,12,13,8,48,49]),import.meta.url)]),s=r.from(e);return s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment,t(this.networkServiceUrl,s)}async submitTraceJob(e){const[{submitTraceJob:t},{default:r}]=await Promise.all([I(()=>import("./DmxrO30_.js"),__vite__mapDeps([58,12,2,3,4,13,8,28]),import.meta.url),I(()=>import("./BbbEEtGm.js"),__vite__mapDeps([59,2,3,4,12,13,8,48,49]),import.meta.url)]),s=r.from(e);s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment;const n=await t(this.networkServiceUrl,s);return new ue({statusUrl:n})}async canAddAssociation(e){const t=await this.getRulesTable();if(!t)return!1;const{fromNetworkElement:r,toNetworkElement:s}=e;if(!r||!s)return!1;await t.load();let n=null;switch(e.associationType){case"containment":n=t.rulesCategorized.containment;break;case"attachment":n=t.rulesCategorized.attachment;break;default:n=t.rulesCategorized.connectivity}return n.some((a=>Fe(a,r,s)))}generateAddAssociations(e){const{associationsTable:t}=this.networkSystemLayers,{fromNetworkSourceId:r,fromGlobalId:s,fromTerminalId:n,toNetworkSourceId:a,toGlobalId:l,toTerminalId:p,associationType:d,isContentVisible:y,percentAlong:f,globalId:h}=ri(t);return{addFeatures:e.map((m=>new nr({attributes:{[r]:m.fromNetworkElement?.networkSourceId,[s]:m.fromNetworkElement?.globalId,[n]:m.fromNetworkElement?.terminalId,[a]:m.toNetworkElement?.networkSourceId,[l]:m.toNetworkElement?.globalId,[p]:m.toNetworkElement?.terminalId,[d]:ei[m.associationType],[y]:m.isContentVisible==null?void 0:m.isContentVisible?1:0,[f]:m.percentAlong,[h]:m.globalId}}))),id:this.networkSystemLayers.associationsTableId,identifierFields:{globalIdField:t?.globalIdField??"globalid",objectIdField:t?.objectIdField??"objectid"}}}generateDeleteAssociations(e){const{associationsTable:t,associationsTableId:r}=this.networkSystemLayers;return{deleteFeatures:e.map((s=>({globalId:s.globalId}))),id:r,identifierFields:{globalIdField:t?.globalIdField??"globalid",objectIdField:t?.objectIdField??"objectid"}}}async loadAssociationsTable(){return this.networkSystemLayers.loadAssociationsTable()}async _loadNamedTraceConfigurationsFromNetwork(e){if(this.sharedNamedTraceConfigurations?.length===0)return;const t=this.sharedNamedTraceConfigurations.map((s=>s.globalId)),r=await this.queryNamedTraceConfigurations({globalIds:t},e);for(const s of this.sharedNamedTraceConfigurations){const n=r?.find((a=>a.globalId===s.globalId));if(n){const a=n.write({},{origin:"service"});s.read(a,{origin:"service"})}}}async _createRulesTable(){const e=this.networkSystemLayers.rulesTableUrl,t=new ar({url:e});await t.load();const r=this.dataElement?.domainNetworks;if(!r)return null;const s=r.flatMap((a=>[...a.edgeSources||[],...a.junctionSources||[]])),n=(await Yi(t)).map((a=>this._hydrateRuleInfo(t,s,a)));return new ie({rulesLayer:t,rules:n})}_hydrateRuleInfo(e,t,r){const s=e.fieldsIndex,n=s.get("RULETYPE"),a=s.get("CREATIONDATE"),l=s.get("FROMNETWORKSOURCEID"),p=s.get("FROMASSETGROUP"),d=s.get("FROMASSETTYPE"),y=s.get("FROMTERMINALID"),f=s.get("TONETWORKSOURCEID"),h=s.get("TOASSETGROUP"),m=s.get("TOASSETTYPE"),E=s.get("TOTERMINALID"),L=s.get("VIANETWORKSOURCEID"),H=s.get("VIAASSETGROUP"),A=s.get("VIAASSETTYPE"),oe=s.get("VIATERMINALID"),we=r.attributes[n.name],He=new Date(r.attributes[a.name]),Ue=[{networkSourceId:r.attributes[l.name],assetGroupId:r.attributes[p.name],assetTypeId:r.attributes[d.name],terminalId:r.attributes[y.name]},{networkSourceId:r.attributes[f.name],assetGroupId:r.attributes[h.name],assetTypeId:r.attributes[m.name],terminalId:r.attributes[E.name]},{networkSourceId:r.attributes[L.name],assetGroupId:r.attributes[H.name],assetTypeId:r.attributes[A.name],terminalId:r.attributes[oe.name]}];let k;(function(_){_[_.from=0]="from",_[_.to=1]="to",_[_.via=2]="via"})(k||(k={}));const v={ruleType:we,creationDate:He};for(const _ of[k.from,k.to,k.via]){if(we!==S.RTEdgeJunctionEdgeConnectivity&&_===k.via)continue;const se=Ue[_],Vt=t.find((Pe=>Pe.sourceId===se.networkSourceId)),Ft=Vt?.assetGroups.find((Pe=>Pe.assetGroupCode===se.assetGroupId)),Mt=Ft?.assetTypes.find((Pe=>Pe.assetTypeCode===se.assetTypeId)),br=this._getTerminal(Mt,se);let ne="";switch(_){case k.from:ne="from";break;case k.to:ne="to";break;case k.via:ne="via"}v[`${ne}NetworkSource`]=Vt,v[`${ne}AssetGroup`]=Ft,v[`${ne}AssetType`]=Mt,v[`${ne}Terminal`]=br?.toJSON()}return v}_getTerminal(e,t){const r=e?.terminalConfigurationId;return this.terminalConfigurations?.find((n=>n.id===r))?.terminals?.find((n=>n.id===t.terminalId))??null}};async function Yi(e){const t=new Qr({where:"1=1",outFields:["*"]});return(await Zr(e,t)).features}i([o({type:[Di],json:{origins:{"web-map":{read:{source:"traceConfigurations"},write:{target:"traceConfigurations"}},service:{read:{source:"traceConfigurations"}}},read:!1}})],G.prototype,"sharedNamedTraceConfigurations",void 0),i([o({type:["utility"],readOnly:!0,json:{read:!1,write:!1}})],G.prototype,"type",void 0),i([o({readOnly:!0})],G.prototype,"serviceTerritoryFeatureLayerId",null),i([o({readOnly:!0})],G.prototype,"networkSystemLayers",null),i([o({readOnly:!0})],G.prototype,"terminalConfigurations",null),i([o({readOnly:!0})],G.prototype,"domainNetworkNames",null),i([o({readOnly:!0})],G.prototype,"hasTelecomNetwork",null),G=i([u("esri.networks.UtilityNetwork")],G);const wr=G,Qi=Object.freeze(Object.defineProperty({__proto__:null,default:wr},Symbol.toStringTag,{value:"Module"}));let Ae=class extends N.ClonableMixin(c){constructor(t){super(t),this.expression=null,this.returnType="string",this.title=null}};i([o({type:String,json:{write:{isRequired:!0}}})],Ae.prototype,"expression",void 0),i([o({type:["number","string"],json:{write:!0}})],Ae.prototype,"returnType",void 0),i([o({type:String,json:{write:!0}})],Ae.prototype,"title",void 0),Ae=i([u("esri.webdoc.geotriggersInfo.ExpressionInfo")],Ae);const fr=Ae,it=new ge({deviceLocation:"device-location"});let Me=class extends N.ClonableMixin(c){constructor(t){super(t),this.filterExpression=null,this.type="device-location"}};i([o({type:fr,json:{write:!0}})],Me.prototype,"filterExpression",void 0),i([o({type:it.apiValues,readOnly:!0,json:{type:it.jsonValues,read:it.read,write:it.write}})],Me.prototype,"type",void 0),Me=i([u("esri.webdoc.geotriggersInfo.DeviceLocationFeed")],Me);const Xi=Me;let Be=class extends N.ClonableMixin(c){constructor(t){super(t),this.geometry=null,this.where=null}};i([o({types:si,json:{read:lr,write:!0}})],Be.prototype,"geometry",void 0),i([o({type:String,json:{write:!0}})],Be.prototype,"where",void 0),Be=i([u("esri.webdoc.geotriggersInfo.FeatureFilter")],Be);const eo=Be;let ke=class extends N.ClonableMixin(c){constructor(t){super(t),this.layerId=null,this.layerUrl=null,this.type="feature-layer"}};i([o({type:String,json:{write:{overridePolicy(){return{isRequired:this.layerUrl===null}}}}})],ke.prototype,"layerId",void 0),i([o({type:String,json:{write:{overridePolicy(){return{isRequired:this.layerId===null}}}}})],ke.prototype,"layerUrl",void 0),i([q({featureLayer:"feature-layer"},{readOnly:!0})],ke.prototype,"type",void 0),ke=i([u("esri.webdoc.geotriggersInfo.FeatureLayerSource")],ke);const to=ke;let pe=class extends N.ClonableMixin(c){constructor(t){super(t),this.fenceSource=null,this.filter=null,this.bufferDistance=null,this.type="features"}};i([o({type:to,json:{write:{isRequired:!0}}})],pe.prototype,"fenceSource",void 0),i([o({type:eo,json:{write:!0}})],pe.prototype,"filter",void 0),i([o({type:Number,json:{write:!0}})],pe.prototype,"bufferDistance",void 0),i([q({features:"features"},{readOnly:!0})],pe.prototype,"type",void 0),pe=i([u("esri.webdoc.geotriggersInfo.FeatureFenceParameters")],pe);const ro=pe;let nt=class extends N.ClonableMixin(c){constructor(t){super(t),this.type="fence"}};i([q({fence:"fence"},{readOnly:!0})],nt.prototype,"type",void 0),nt=i([u("esri.webdoc.geotriggersInfo.Geotrigger")],nt);const vr=nt;let Je=class extends N.ClonableMixin(c){constructor(t){super(t),this.expressionInfo=null,this.requestedActions=null}};i([o({type:fr,json:{write:!0}})],Je.prototype,"expressionInfo",void 0),i([o({type:[String],json:{write:!0}})],Je.prototype,"requestedActions",void 0),Je=i([u("esri.webdoc.geotriggersInfo.GeotriggerNotificationOptions")],Je);const io=Je,oo=new ge({enterContainsAndExitDoesNotContain:"enter-contains-and-exit-does-not-contain",enterContainsAndExitDoesNotIntersect:"enter-contains-and-exit-does-not-intersect",enterIntersectsAndExitDoesNotIntersect:"enter-intersects-and-exit-does-not-intersect"}),so=new ge({useGeometry:"use-geometry",useGeometryWithAccuracy:"use-geometry-with-accuracy"}),ot=new ge({enter:"enter",enterOrExit:"enter-or-exit",exit:"exit"});let P=class extends vr{constructor(e){super(e),this.enterExitRule="enter-contains-and-exit-does-not-intersect",this.feed=null,this.feedAccuracyMode="use-geometry",this.fenceNotificationRule=null,this.fenceParameters=null,this.name=null,this.notificationOptions=null,this.type="fence"}};i([q(oo)],P.prototype,"enterExitRule",void 0),i([o({type:Xi,json:{write:{isRequired:!0}}})],P.prototype,"feed",void 0),i([q(so)],P.prototype,"feedAccuracyMode",void 0),i([o({type:ot.apiValues,json:{type:ot.jsonValues,read:ot.read,write:{writer:ot.write,isRequired:!0}}})],P.prototype,"fenceNotificationRule",void 0),i([o({type:ro,json:{write:{isRequired:!0}}})],P.prototype,"fenceParameters",void 0),i([o({type:String,json:{write:!0}})],P.prototype,"name",void 0),i([o({type:io,json:{write:!0}})],P.prototype,"notificationOptions",void 0),i([q({fence:"fence"},{readOnly:!0})],P.prototype,"type",void 0),P=i([u("esri.webdoc.geotriggersInfo.FenceGeotrigger")],P);const no=P,ao={base:vr,key:"type",typeMap:{fence:no}};let at=class extends N.ClonableMixin(c){constructor(t){super(t),this.geotriggers=null}};i([o({types:[ao],json:{write:{isRequired:!0}}})],at.prototype,"geotriggers",void 0),at=i([u("esri.webdoc.GeotriggersInfo")],at);const lo=at;let lt=class extends N.ClonableMixin(c){constructor(t){super(t),this.enabled=!0}};i([o({type:Boolean,nonNullable:!0,json:{write:!0}})],lt.prototype,"enabled",void 0),lt=i([u("esri.webdoc.ips.AppleIPSProperties")],lt);const uo=lt;let ut=class extends N.ClonableMixin(c){constructor(t){super(t),this.enabled=!0}};i([o({type:Boolean,nonNullable:!0,json:{write:!0}})],ut.prototype,"enabled",void 0),ut=i([u("esri.webdoc.ips.GNSSProperties")],ut);const po=ut;let Re=class extends N.ClonableMixin(c){constructor(t){super(t),this.enabled=!0,this.distance=5,this.units="meter"}};i([o({type:Boolean,nonNullable:!0,json:{write:!0}})],Re.prototype,"enabled",void 0),i([o({type:Number,nonNullable:!0,json:{write:!0}})],Re.prototype,"distance",void 0),i([o({type:["feet","meter"],nonNullable:!0,json:{write:!0}})],Re.prototype,"units",void 0),Re=i([u("esri.webdoc.ips.PathSnappingProperties")],Re);const co=Re;let pt=class extends N.ClonableMixin(c){constructor(e){super(e),this.enabled=!0}};i([o({type:Boolean,nonNullable:!0,json:{write:!0}})],pt.prototype,"enabled",void 0),pt=i([u("esri.webdoc.ips.SmoothingProperties")],pt);const yo=pt;let de=class extends N.ClonableMixin(c){constructor(t){super(t),this.appleIPS=null,this.gnss=null,this.smoothing=null,this.pathSnapping=null}};i([o({type:uo,json:{name:"AppleIPS",write:!0}})],de.prototype,"appleIPS",void 0),i([o({type:po,json:{name:"GNSS",write:!0}})],de.prototype,"gnss",void 0),i([o({type:yo,json:{write:!0}})],de.prototype,"smoothing",void 0),i([o({type:co,json:{write:!0}})],de.prototype,"pathSnapping",void 0),de=i([u("esri.webdoc.ips.Configuration")],de);const mo=de;let Oe=class extends N.ClonableMixin(c){constructor(e){super(e),this.portalItem=null}readPortalItem(e,t,r){const{itemId:s}=t;if(s)return new qe({id:s,portal:r?.portal})}writePortalItem(e,t){e?.id&&(t.itemId=e.id)}};i([o({type:qe,json:{write:{isRequired:!0}}})],Oe.prototype,"portalItem",void 0),i([x("portalItem",["itemId"])],Oe.prototype,"readPortalItem",null),i([j("portalItem",{itemId:{type:String}})],Oe.prototype,"writePortalItem",null),Oe=i([u("esri.webdoc.ips.PositioningService")],Oe);const ho=Oe;let Ge=class extends N.ClonableMixin(c){constructor(e){super(e),this.positioningService=null,this.configuration=null}};i([o({type:ho,json:{write:{isRequired:!0}}})],Ge.prototype,"positioningService",void 0),i([o({type:mo,json:{write:!0}})],Ge.prototype,"configuration",void 0),Ge=i([u("esri.webdoc.IPSInfo")],Ge);const go=Ge,wo={currentVersion:er,createInitialViewProperties:()=>new dt,parseVersion:De.parse,itemType:"Web Map",name:"webmap",origin:"web-map"},fo=yt.ofType(wr);var Ce;let ce=(Ce=class extends Ci{constructor(t){super(t),this.geotriggersInfo=null,this.ipsInfo=null,this.presentation=null,this.utilityNetworks=null}destroy(){if(this.utilityNetworks){const t=this.utilityNetworks.removeAll();for(const r of t)r.destroy();this.utilityNetworks.destroy()}}get context(){return wo}loadAll(){return tr(this,(t=>{t(this.ground,this.basemap,this.layers,this.tables,this.ipsInfo?.positioningService?.portalItem)}))}static fromJSON(t){if(t)return new this({resourceInfo:t});throw new z("webmap:empty-resource","Expected a JSON resource but got nothing")}},Ce.VERSION=er,Ce);i([o({type:lo,json:{write:!0}})],ce.prototype,"geotriggersInfo",void 0),i([o({type:go,json:{write:!0,name:"mapIPSInfo"}})],ce.prototype,"ipsInfo",void 0),i([o({json:{write:!0}})],ce.prototype,"presentation",void 0),i([o({type:fo,json:{read:!0,write:!0}})],ce.prototype,"utilityNetworks",void 0),ce=i([u("esri.WebMap")],ce);const vo=ce,Fs=Object.freeze(Object.defineProperty({__proto__:null,default:vo},Symbol.toStringTag,{value:"Module"}));export{Fs as W,Gi as a,R as c,Di as d,Li as i,vo as j,Zt as n,wr as w};
