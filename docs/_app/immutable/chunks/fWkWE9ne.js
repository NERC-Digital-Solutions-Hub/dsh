import{n as y,_ as i,m as u,a as E,b as P,r as S}from"./DUlE1Kon.js";import{l as O}from"./CD2g8Juu.js";import"./BFGjv385.js";import"./DSdBzmdi.js";import{_ as m}from"./CdqyOKuv.js";import{P as C,y as v}from"./CEVkfTgd.js";import{k as b}from"./Ca-7ty7r.js";import{L as c}from"./ypvuBaub.js";let d=class extends O(y){constructor(r){super(r),this.frameCenter=null,this.frameOutline=null,this.lineOfSight=null,this.sensorLocation=null,this.sensorTrail=null}};i([u({type:m})],d.prototype,"frameCenter",void 0),i([u({type:C})],d.prototype,"frameOutline",void 0),i([u({type:v})],d.prototype,"lineOfSight",void 0),i([u({type:m})],d.prototype,"sensorLocation",void 0),i([u({type:v})],d.prototype,"sensorTrail",void 0),d=i([E("esri.layers.support.TelemetryData")],d);const g={type:Boolean,json:{write:!0}};let f=class extends O(y){constructor(r){super(r),this.frame=!1,this.frameCenter=!1,this.frameOutline=!0,this.lineOfSight=!0,this.sensorLocation=!0,this.sensorTrail=!0}};i([u(g)],f.prototype,"frame",void 0),i([u(g)],f.prototype,"frameCenter",void 0),i([u(g)],f.prototype,"frameOutline",void 0),i([u(g)],f.prototype,"lineOfSight",void 0),i([u(g)],f.prototype,"sensorLocation",void 0),i([u(g)],f.prototype,"sensorTrail",void 0),f=i([E("esri.layers.support.TelemetryDisplay")],f);let l=class extends O(y){constructor(e){super(e),this.duration=null,this.end=null,this.start=null,this.timezone="UTC"}readEnd(e,r){return r.end!=null?new Date(r.end):null}writeEnd(e,r){r.end=e?e.getTime():null}readStart(e,r){return r.start!=null?new Date(r.start):null}writeStart(e,r){r.start=e?e.getTime():null}};i([u({type:Number,json:{write:{allowNull:!0}}})],l.prototype,"duration",void 0),i([u({type:Date,json:{write:{allowNull:!0}}})],l.prototype,"end",void 0),i([P("end")],l.prototype,"readEnd",null),i([S("end")],l.prototype,"writeEnd",null),i([u({type:Date,json:{write:{allowNull:!0}}})],l.prototype,"start",void 0),i([P("start")],l.prototype,"readStart",null),i([S("start")],l.prototype,"writeStart",null),i([u({type:String})],l.prototype,"timezone",void 0),l=i([E("esri.layers.support.VideoTimeExtent")],l);const x=l,h="application/x-mpegURL",T="video/mp4",A="video/webm",t={PlatformHeadingAngle:10005,PlatformPitchAngle:10006,PlatformRollAngle:10007,SensorLatitude:10013,SensorLongitude:10014,SensorTrueAltitude:10015,SensorHorizontalFOV:10016,SensorVerticalFOV:10017,SensorAzimuthAngle:10018,SensorElevationAngle:10019,SensorRollAngle:10020,FrameCenterLatitude:10023,FrameCenterLongitude:10024,FrameCenterElevation:10025,OffsetCorner1Latitude:10026,OffsetCorner1Longitude:10027,OffsetCorner2Latitude:10028,OffsetCorner2Longitude:10029,OffsetCorner3Latitude:10030,OffsetCorner3Longitude:10031,OffsetCorner4Latitude:10032,OffsetCorner4Longitude:10033,SensorEllipsoidHeight:10075,FrameCenterAboveEllipsoid:10078,EsriVideoWidth:90001,EsriVideoHeight:90002,EsriFrameCenterLatitude:90050,EsriFrameCenterLongitude:90051,EsriCornerLatitudePt1:90052,EsriCornerLongitudePt1:90053,EsriCornerLatitudePt2:90054,EsriCornerLongitudePt2:90055,EsriCornerLatitudePt3:90056,EsriCornerLongitudePt3:90057,EsriCornerLatitudePt4:90058,EsriCornerLongitudePt4:90059,EsriFrameOutline:90060,EsriSensorPosition:90061,EsriHorizonPixelPack:90063,EsriGroundControlPoints:90064};function Q(e,r=1e4){if(!e||!e.length)return[];let n=[],o=[];for(let a=0;a<e.length;a++){const p=e[a],L=p?.text?JSON.parse(p.text):null;L?.source==="EsriVideoServer"&&(n=[...L.data])}const s=n.find(a=>a.tagId===r);return Array.isArray(s?.value)&&(o=[...s.value]),o}function X(e){const{duration:r,end:n,start:o,timezone:s="UTC"}=e||{};return typeof r!="number"?null:new x({duration:r||null,end:typeof n=="number"?new Date(n):null,start:typeof o=="number"?new Date(o):null,timezone:s})}function Y(e,r){const n=[...r],o=n.findIndex(s=>s.equals(e));return o>-1&&n.splice(o),n.push(e),n}function Z(e){if(!e?.size)return new d;const r=U(e),n=$(e),o=V(e),s=j(r,n);return new d({frameCenter:n,frameOutline:o,lineOfSight:s,sensorLocation:r})}function ee(e){return e?.size?e.get(t.EsriGroundControlPoints)?.value??null??null:null}function te(e){return e?.size?e.get(t.EsriHorizonPixelPack)?.value??null:null}function $(e){return D(e)??H(e)}function re(e){if(!e)return h;const r=e.match(/\.(\w{3,4})(?:$|\?)/i);if(!r)return h;switch(r[1].toLowerCase()){case"mp4":return T;case"webm":return A;default:return h}}function ne(e){const r=e?.layers;return r?.length?r.map(n=>({layerId:n.id,posterUrl:n.poster,sourceType:n.serviceType,title:n.name,type:n.type||"Video Layer"})):[]}function oe(e,r,n){if(!e)return null;const o=e.clone();switch(o.type){case"simple-fill":c(o,n),o.outline.color=r;break;case"simple-line":c(o,r);break;case"simple-marker":c(o,r),o?.outline?.color&&(o.outline.color=r);break;case"cim":b(o,r)}return o}function ie(e){const{cameraAzimuth:r,platformHeading:n,source:o=null,symbolOffset:s=0}=e||{};let a=0;if(!o)return a;a=o==="platformHeading"?n+s:n+r+s;const p=a>360?a-360:a;return Math.round(Math.abs(p))}function D(e){return e&&e.has(t.EsriFrameCenterLatitude)&&e.has(t.EsriFrameCenterLongitude)?new m({x:e.get(t.EsriFrameCenterLongitude).value,y:e.get(t.EsriFrameCenterLatitude).value,z:e.get(t.FrameCenterAboveEllipsoid)?.value??e.get(t.FrameCenterElevation)?.value}):null}function H(e){return e&&e.has(t.FrameCenterLatitude)&&e.has(t.FrameCenterLongitude)?new m({x:e.get(t.FrameCenterLongitude)?.value,y:e.get(t.FrameCenterLatitude)?.value,z:e.get(t.FrameCenterElevation)?.value}):null}function V(e){if(!e)return null;const r=e.get(t.EsriFrameOutline)?.value;return r?C.fromJSON(r.geometry):k(e)??N(e)}function k(e){if(!(e.has(t.EsriCornerLatitudePt1)&&e.has(t.EsriCornerLongitudePt1)&&e.has(t.EsriCornerLatitudePt2)&&e.has(t.EsriCornerLongitudePt2)&&e.has(t.EsriCornerLatitudePt3)&&e.has(t.EsriCornerLongitudePt3)&&e.has(t.EsriCornerLatitudePt4)&&e.has(t.EsriCornerLongitudePt4)))return null;const r=[e.get(t.EsriCornerLongitudePt1)?.value,e.get(t.EsriCornerLatitudePt1)?.value],n=[e.get(t.EsriCornerLongitudePt2)?.value,e.get(t.EsriCornerLatitudePt2)?.value],o=[e.get(t.EsriCornerLongitudePt3)?.value,e.get(t.EsriCornerLatitudePt3)?.value],s=[e.get(t.EsriCornerLongitudePt4)?.value,e.get(t.EsriCornerLatitudePt4)?.value];return new C({rings:[[r,n,o,s]]})}function N(e){if(!(e.has(t.OffsetCorner1Latitude)&&e.has(t.OffsetCorner1Longitude)&&e.has(t.OffsetCorner2Latitude)&&e.has(t.OffsetCorner2Longitude)&&e.has(t.OffsetCorner3Latitude)&&e.has(t.OffsetCorner3Longitude)&&e.has(t.OffsetCorner4Latitude)&&e.has(t.OffsetCorner4Longitude)&&e.has(t.FrameCenterLatitude)&&e.has(t.FrameCenterLongitude)))return null;const r=e.get(t.FrameCenterLatitude)?.value,n=e.get(t.FrameCenterLongitude)?.value,o=r+e.get(t.OffsetCorner1Latitude)?.value,s=n+e.get(t.OffsetCorner1Longitude)?.value,a=r+e.get(t.OffsetCorner2Latitude)?.value,p=n+e.get(t.OffsetCorner2Longitude)?.value,L=r+e.get(t.OffsetCorner3Latitude)?.value,w=n+e.get(t.OffsetCorner3Longitude)?.value,F=r+e.get(t.OffsetCorner4Latitude)?.value,z=n+e.get(t.OffsetCorner4Longitude)?.value;return new C({rings:[[[s,o],[p,a],[w,L],[z,F]]]})}function j(e,r){if(!e||!r)return null;const n=[e.x,e.y,e.z??0],o=[r.x,r.y,r.z??0];return new v({paths:[[n,o]]})}function U(e){if(!e?.size)return null;if(e.has(t.EsriSensorPosition)){const r=e.get(t.EsriSensorPosition)?.value;if(r)return m.fromJSON(r.geometry)}return e.has(t.SensorLongitude)&&e.has(t.SensorLatitude)?new m({x:e.get(t.SensorLongitude)?.value,y:e.get(t.SensorLatitude)?.value,z:e.get(t.SensorTrueAltitude)?.value}):null}export{Z as C,re as E,ee as L,ne as a,x as b,te as c,t as d,d as e,Q as f,X as g,ie as h,Y as m,f as p,oe as v};
