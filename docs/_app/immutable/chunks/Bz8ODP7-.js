import{X as c,q as d,aE as p,aF as _,aG as b,aH as h,aI as g,aJ as O,ai as y,aK as A,B as J,r as w,a as m,b as D,w as v}from"./BoGhUpgK.js";import{a as j,h as T}from"./BO0zSyDw.js";import{s as P,i as z}from"./k6TpQ-vv.js";let U=class S{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(r){const e=new S;return this._values.forEach(((t,s)=>{r&&r.has(s)||e.set(s,j(t.value),t.origin)})),e}get(r,e){e=this._normalizeOrigin(e);const t=this._values.get(r);return e==null||t?.origin===e?t?.value:void 0}originOf(r){return this._values.get(r)?.origin??c.USER}keys(r){r=this._normalizeOrigin(r);const e=[...this._values.keys()];return r==null?e:e.filter((t=>this._values.get(t)?.origin===r))}set(r,e,t){if((t=this._normalizeOrigin(t))===c.DEFAULTS){const s=this._values.get(r);if(s?.origin!=null&&s.origin>t)return}this._values.set(r,new q(e,t))}delete(r,e){(e=this._normalizeOrigin(e))!=null&&this._values.get(r)?.origin!==e||this._values.delete(r)}has(r,e){return(e=this._normalizeOrigin(e))!=null?this._values.get(r)?.origin===e:this._values.has(r)}isAtOrigin(r,e){return e=this._normalizeOrigin(e),this.has(r,e)&&this.originOf(r)===e}isBelowOrigin(r,e){return e=this._normalizeOrigin(e),!this.has(r)||this.originOf(r)<e}forEach(r){this._values.forEach((({value:e},t)=>r(e,t)))}_normalizeOrigin(r){if(r!=null)return r===c.DEFAULTS?r:c.USER}};class q{constructor(r,e){this.value=r,this.origin=e}}function x(i,r,e){r.keys().forEach((s=>{e.set(s,r.get(s),c.DEFAULTS)}));const t=i.metadata;Object.keys(t).forEach((s=>{i.internalGet(s)&&e.set(s,i.internalGet(s),c.DEFAULTS)}))}function C(i,r,e){if(!i?.read||i.read.enabled===!1||!i.read.source)return!1;const t=i.read.source;if(typeof t=="string"){if(t===r||t.includes(".")&&t.indexOf(r)===0&&h(t,e))return!0}else for(const s of t)if(s===r||s.includes(".")&&s.indexOf(r)===0&&h(s,e))return!0;return!1}function F(i){return i&&(!i.read||i.read.enabled!==!1&&!i.read.source)}function L(i,r,e,t,s){let n=p(r[e],s);F(n)&&(i[e]=!0);for(const o of Object.getOwnPropertyNames(r))n=p(r[o],s),C(n,e,t)&&(i[o]=!0)}function k(i,r,e,t){const s=e.metadata,n=b(s[r],t),o=n?.default;if(o===void 0)return;const a=typeof o=="function"?o.call(i,r,t):o;a!==void 0&&e.set(r,a)}const $={origin:"service"};function G(i,r,e=$){if(!r||typeof r!="object")return;const t=d(i),s=t.metadata,n={};for(const o of Object.getOwnPropertyNames(r))L(n,s,o,r,e);t.setDefaultOrigin(e.origin);for(const o of Object.getOwnPropertyNames(n)){const a=p(s[o],e).read,l=a?.source;let u;u=l&&typeof l=="string"?_(r,l):r[o],a?.reader&&(u=a.reader.call(i,u,r,e)),u!==void 0&&t.set(o,u)}if(!e||!e.ignoreDefaults){t.setDefaultOrigin("defaults");for(const o of Object.getOwnPropertyNames(s))n[o]||k(i,o,t,e)}t.setDefaultOrigin("user")}function X(i,r,e,t=$){const s={...t,messages:[]};e(s),s.messages?.forEach((n=>{n.type!=="warning"||i.loaded?t?.messages&&t.messages.push(n):i.loadWarnings.push(n)}))}function M(i,r,e,t,s){const n={};return r.write?.writer?.call(i,t,n,e,s),n}function N(i,r,e,t,s,n){if(!t?.write)return!1;const o=y(i,e);if(!s&&t.write.overridePolicy){const a=t.write.overridePolicy.call(i,o,e,n??void 0);a!==void 0&&(s=a)}if(s||(s=t.write),!s||s.enabled===!1||s.layerContainerTypes&&n?.layerContainerType&&!s.layerContainerTypes.includes(n.layerContainerType))return!1;if((o===null&&!s.allowNull&&!s.writerEnsuresNonNull||o===void 0)&&s.isRequired){const a=new P("web-document-write:property-required",`Missing value for required property '${e}' on '${i.declaredClass}'`,{propertyName:e,target:i});return a&&n?.messages?n.messages.push(a):a&&!n&&z.getLogger("esri.core.accessorSupport.write").error(a.name,a.message),!1}return!(o===void 0||o===null&&!s.allowNull&&!s.writerEnsuresNonNull||!s.alwaysWriteDefaults&&(!r.store.multipleOriginsSupported||r.store.originOf(e)===c.DEFAULTS)&&R(i,e,n,t,o)||!s.ignoreOrigin&&n?.origin&&r.store.multipleOriginsSupported&&r.store.originOf(e)<J(n.origin))}function R(i,r,e,t,s){const n=t.default;if(n===void 0)return!1;if(t.defaultEquals!=null)return t.defaultEquals(s);if(typeof n=="function"){if(Array.isArray(s)){const o=n.call(i,r,e??void 0);return T(o,s)}return!1}return n===s}function Q(i,r,e,t){const s=d(i),n=s.metadata,o=O(n[r],t);return!!o&&N(i,s,r,o,e,t)}function B(i,r,e){if(i&&typeof i.toJSON=="function"&&(!i.toJSON.isDefaultToJSON||!i.write))return g(r,i.toJSON(e));const t=d(i),s=t.metadata;for(const n in s){const o=O(s[n],e);if(!N(i,t,n,o,void 0,e))continue;const a=y(i,n),l=M(i,o,o.write&&typeof o.write.target=="string"?o.write.target:n,a,e);Object.keys(l).length>0&&(r=g(r,l),e?.resources?.pendingOperations?.length&&e.resources.pendingOperations.push(Promise.all(e.resources.pendingOperations).then((()=>g(r,l,(()=>"replace-arrays"))))),e?.writtenProperties&&e.writtenProperties.push({target:i,propName:n,oldOrigin:A(t.store.originOf(n)),newOrigin:e.origin}))}return r}const E=i=>{let r=class extends i{constructor(...e){super(...e);const t=d(this),s=t.store,n=new U;t.store=n,x(t,s,n)}read(e,t){G(this,e,t)}write(e,t){return B(this,e??{},t)}toJSON(e){return this.write({},e)}static fromJSON(e,t){return W.call(this,e,t)}};return r=w([m("esri.core.JSONSupport")],r),r.prototype.toJSON.isDefaultToJSON=!0,r};function W(i,r){if(!i)return null;if(i.declaredClass)throw new Error("JSON object is already hydrated");const e=new this;return e.read(i,r),e}let f=class extends E(D){};f=w([m("esri.core.JSONSupport")],f),(function(i){i.JSONSupportMixin=E})(f||(f={}));const V=f;function Y(i,r,e){let t,s;return r===void 0?(s=i,t=[void 0]):typeof r!="string"?(s=i,t=[void 0],e=r):(s=r,t=Array.isArray(i)?i:[i]),(n,o)=>{const a=n.constructor.prototype;for(const l of t){const u=v(n,l,s);u.write&&typeof u.write=="object"||(u.write={}),e&&(u.write.target=e),u.write.writer=a[o]}}}function Z(i,r,e){let t,s;return r===void 0||Array.isArray(r)?(s=i,e=r,t=[void 0]):(s=r,t=Array.isArray(i)?i:[i]),(n,o)=>{const a=n.constructor.prototype;t.forEach((l=>{const u=v(n,l,s);u.read&&typeof u.read=="object"||(u.read={}),u.read.reader=a[o],e&&(u.read.source=(u.read.source||[]).concat(e))}))}}export{X as a,B as d,x as e,Q as g,V as l,Z as o,Y as r,G as u};
