import{a as h}from"./gvnm7ut2.js";import{L as f}from"./BFGjv385.js";class d{constructor(e,s){this._observers=e,this._observer=s}remove(){f(this._observers,this._observer)}}class u{constructor(){this._observers=null,this.destroyed=!1}observe(e){if(this.destroyed||e.destroyed)return b;this._observers==null&&(this._observers=[]);const s=this._observers;let r=!1,t=!1;const l=s.length;for(let o=0;o<l;++o){const i=s[o];if(i.destroyed)t=!0;else if(i===e){r=!0;break}}return r||(s.push(e),t&&this._removeDestroyedObservers()),new d(s,e)}_removeDestroyedObservers(){const e=this._observers;if(!e||e.length===0)return;const s=e.length;let r=0;for(let t=0;t<s;++t){for(;t+r<s&&e[t+r].destroyed;)++r;if(r>0){if(!(t+r<s))break;e[t]=e[t+r]}}e.length=s-r}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this._observers;if(e!=null){for(const s of e)s.onCommitted();this._observers=null}}}const b=h();export{u as r};
