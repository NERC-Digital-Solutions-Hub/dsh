import{_ as a,m as o,a as y,e as b,a9 as d,I as g,H as h,G as c,f as m}from"./DEfw6_ef.js";import{H as v,s as w}from"./CbSHxjnO.js";import{O as _}from"./H0QphIdm.js";import"./CuDkSQ9K.js";import{o as $}from"./CXxgNwmb.js";function A(e,t,r){return c(e.map((n,i)=>t.apply(r,[n,i])))}async function D(e,t,r){return(await c(e.map((n,i)=>t.apply(r,[n,i])))).map(n=>n.value)}function u(e){return{ok:!0,value:e}}function l(e){return{ok:!1,error:e}}function j(e){return e!=null&&e.ok===!0?e.value:null}function C(e){return e!=null&&e.ok===!1?e.error:null}async function G(e){if(e==null)return{ok:!1,error:new Error("no promise provided")};try{return u(await e)}catch(t){return l(t)}}async function R(e){try{return u(await e)}catch(t){return m(t),l(t)}}function V(e,t){return new s(e,t)}let s=class extends b{get value(){return j(this._result)}get error(){return C(this._result)}get finished(){return this._result!=null}constructor(e,t){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=d(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:r}=this._abortController;this.promise=e(r),this.promise.then(n=>{this._result=u(n),this._cleanup()},n=>{this._result=l(n),this._cleanup()}),this._abortHandle=g(t,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=h(this._abortHandle),this._abortController=null}};a([o()],s.prototype,"value",null),a([o()],s.prototype,"error",null),a([o()],s.prototype,"finished",null),a([o()],s.prototype,"promise",void 0),a([o()],s.prototype,"_result",void 0),s=a([y("esri.core.asyncUtils.ReactiveTask")],s);function q(e){return S(e)||k(e)}function L(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="feature"}function z(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="graphics"}function F(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="map-image"}function J(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="knowledge-graph"&&"layers"in e}function K(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="knowledge-graph-sublayer"}function k(e){return e?.type==="scene"}function N(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="subtype-group"&&"sublayers"in e}function Q(e){return e?.type==="subtype-sublayer"}function S(e){const t=e?.type;return t==="imagery-tile"||t==="tile"||t==="open-street-map"||t==="vector-tile"||t==="web-tile"||t==="wmts"}function W(e){const t=e?.type;return t==="base-tile"||t==="tile"||t==="elevation"||t==="imagery-tile"||t==="base-elevation"||t==="open-street-map"||t==="wcs"||t==="web-tile"||t==="wmts"||t==="vector-tile"}const X={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function Y(e){const t=e?.type;return t==="building-scene"||t==="integrated-mesh"||t==="point-cloud"||t==="scene"}function Z(e){return e.type==="integrated-mesh"||e.type==="integrated-mesh-3dtiles"}function ee(e){return e.type==="integrated-mesh-3dtiles"}function te(e){return e?.type==="feature"&&!e.url&&e.source?.type==="memory"}function re(e){const t=e?.type;return(t==="feature"||t==="subtype-group"||t==="oriented-imagery")&&e?.source?.type==="feature-layer"}function E(e){return e?.type==="feature"&&e.source?.type==="feature-layer"}function ne(e){return L(e)&&E(e)}function se(e){if(e.activeLayer){const t=e.activeLayer.tileMatrixSet;if(t)return t;const r=e.activeLayer.tileMatrixSets;if(r)return r}return null}async function ae(e,t){const r=w?.findServerInfo(e);if(r?.currentVersion!=null)return r.owningSystemUrl||null;const n=e.toLowerCase().indexOf("/rest/services");if(n===-1)return null;const i=`${e.slice(0,n)}/rest/info`,p=t!=null?t.signal:null,{data:f}=await v(i,{query:{f:"json"},responseType:"json",signal:p});return f?.owningSystemUrl||null}function H(e){if(!("capabilities"in e))return!1;switch(e.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"sublayer":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function ie(e){return H(e)?"effectiveCapabilities"in e?e.effectiveCapabilities:e.capabilities:null}function x(e){if(!("editingEnabled"in e))return!1;switch(e.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":case"knowledge-graph-sublayer":return!0;default:return!1}}function oe(e){return!!x(e)&&("effectiveEditingEnabled"in e?e.effectiveEditingEnabled:e.editingEnabled)}function ue(e){const t=new _;for(const r of e.allLayers.concat(e.allTables))r.type==="csv"||$(r)||("charts"in r&&t.push(r),r.type==="subtype-group"&&t.push(...r.sublayers));return t}function I(e,t){return null}function le(e){return null}function M(e){return!e||e.type==="Feature Service"&&!e.sourceUrl}function ce(e,t){!t||!M(e)||I(e.url)}export{oe as $,H as D,ee as E,ie as G,ue as H,ne as I,se as J,I as K,Y as L,te as M,ae as N,re as O,le as Q,M as R,Z as S,ce as W,G as _,A as a,N as b,R as c,V as d,K as e,F as f,S as h,W as j,J as l,Q as m,L as o,D as p,z as s,q as u,X as w};
