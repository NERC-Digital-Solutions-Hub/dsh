import{i as sr,y as F,ay as ur}from"./-Rap9rN9.js";import{v as lr,D as cr}from"./DIQz3k7I.js";import{e as ir}from"./Buev1GnW.js";import{l as fr,y as ar,s as hr,u as gr}from"./Do8kswpP.js";import{s as k,e as P}from"./BVRF3Mep.js";import{e as mr}from"./BR8EEvDc.js";import{e as E}from"./9YvG7tFv.js";function w(r,o){return r?o?4:3:o?3:2}const z=()=>sr.getLogger("esri.layers.graphics.featureConversionUtils"),q={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryMultiPatch:3,esriGeometryEnvelope:0},dr=(r,o,n,t,u,e)=>{r[n]=u,r[n+1]=e},B=(r,o,n,t,u,e)=>{r[n]=u,r[n+1]=e,r[n+2]=o[t+2]},yr=(r,o,n,t,u,e)=>{r[n]=u,r[n+1]=e,r[n+2]=o[t+3]},pr=(r,o,n,t,u,e)=>{r[n]=u,r[n+1]=e,r[n+2]=o[t+2],r[n+3]=o[t+3]};function A(r,o,n,t){if(r){if(n)return o&&t?pr:B;if(o&&t)return yr}else if(o&&t)return B;return dr}function U({scale:r,translate:o},n){return Math.round((n-o[0])/r[0])}function R({scale:r,translate:o},n){return Math.round((o[1]-n)/r[1])}function S({scale:r,translate:o},n){return Math.round((n-o[0])/r[0])}function V({scale:r,translate:o},n){return Math.round((n-o[1])/r[1])}function Y({scale:r,translate:o},n,t){return n*r[t]+o[t]}function Dr(r,o,n){return r?o?n?O(r):C(r):n?D(r):L(r):null}function L(r){const o=r.coords;return{x:o[0],y:o[1]}}function K(r,o){return r.coords[0]=o.x,r.coords[1]=o.y,r}function C(r){const o=r.coords;return{x:o[0],y:o[1],z:o[2]}}function wr(r,o){return r.coords[0]=o.x,r.coords[1]=o.y,r.coords[2]=o.z,r}function D(r){const o=r.coords;return{x:o[0],y:o[1],m:o[2]}}function Mr(r,o){return r.coords[0]=o.x,r.coords[1]=o.y,r.coords[2]=o.m,r}function O(r){const o=r.coords;return{x:o[0],y:o[1],z:o[2],m:o[3]}}function Gr(r,o){return r.coords[0]=o.x,r.coords[1]=o.y,r.coords[2]=o.z,r.coords[3]=o.m,r}function br(r,o,n,t){let u=L;n&&t?u=O:n?u=C:t&&(u=D);for(const e of o){const{geometry:s,attributes:l}=e,i=s!=null?u(s):null;r.push({attributes:l,geometry:i})}return r}function j(r,o){return r&&o?Gr:r?wr:o?Mr:K}function Pr(r,o,n,t,u){const e=j(n,t);for(const s of o){const l=s.geometry!=null?e(new P,s.geometry):null;r.push(new k(l,s.attributes,null,E(s,u)))}return r}function Tr(r,o,n=j(o.z!=null,o.m!=null)){return n(r,o)}function Ir(r,o,n,t){for(const{geometry:u,attributes:e}of o)r.push({attributes:e,geometry:u!=null?Q(u,n,t):null});return r}function Q(r,o,n){if(r==null)return null;const t=w(o,n),u=[];for(let e=0;e<r.coords.length;e+=t){const s=[];for(let l=0;l<t;l++)s.push(r.coords[e+l]);u.push(s)}return o?n?{points:u,hasZ:o,hasM:n}:{points:u,hasZ:o}:n?{points:u,hasM:n}:{points:u}}function Zr(r,o,n,t,u){const e=w(n,t);for(const s of o){const l=s.geometry!=null?W(new P,s.geometry,e):null;r.push(new k(l,s.attributes,null,E(s,u)))}return r}function W(r,o,n=w(o.hasZ,o.hasM)){r.lengths[0]=o.points.length;const t=r.coords;let u=0;for(const e of o.points)for(let s=0;s<n;s++)t[u++]=e[s];return r}function Nr(r,o,n,t){for(const{geometry:u,attributes:e}of o)r.push({attributes:e,geometry:u!=null?X(u,n,t):null});return r}function X(r,o,n){if(!r)return null;const t=w(o,n),{coords:u,lengths:e}=r,s=[];let l=0;for(const i of e){const c=[];for(let f=0;f<i;f++){const a=[];for(let h=0;h<t;h++)a.push(u[l++]);c.push(a)}s.push(c)}return o?n?{paths:s,hasZ:o,hasM:n}:{paths:s,hasZ:o}:n?{paths:s,hasM:n}:{paths:s}}function xr(r,o,n,t,u){const e=w(n,t);for(const s of o){const l=s.geometry!=null?rr(new P,s.geometry,e):null,i=s.centroid!=null?Tr(new P,s.centroid):null;r.push(new k(l,s.attributes,i,E(s,u)))}return r}function rr(r,o,n=w(o.hasZ,o.hasM)){const{lengths:t,coords:u}=r;let e=0;for(const s of o.paths){for(const l of s)for(let i=0;i<n;i++)u[e++]=l[i];t.push(s.length)}return r}function $r(r,o,n,t){for(const{geometry:u,attributes:e,centroid:s}of o){const l=u!=null?or(u,n,t):null;if(s!=null){const i=L(s);r.push({attributes:e,centroid:i,geometry:l})}else r.push({attributes:e,geometry:l})}return r}function or(r,o,n){if(!r)return null;const t=w(o,n),{coords:u,lengths:e}=r,s=[];let l=0;for(const i of e){const c=[];for(let f=0;f<i;f++){const a=[];for(let h=0;h<t;h++)a.push(u[l++]);c.push(a)}s.push(c)}return o?n?{rings:s,hasZ:o,hasM:n}:{rings:s,hasZ:o}:n?{rings:s,hasM:n}:{rings:s}}function kr(r,o,n,t,u){for(const e of o){const s=e.geometry!=null?nr(new P,e.geometry,n,t):null,l=E(e,u);e.centroid!=null?r.push(new k(s,e.attributes,K(new P,e.centroid),l)):r.push(new k(s,e.attributes,null,l))}return r}function nr(r,o,n=o.hasZ,t=o.hasM){return vr(r,o.rings,n,t)}function vr(r,o,n,t){const u=w(n,t),{lengths:e,coords:s}=r;let l=0;Z(r);for(const i of o){for(const c of i)for(let f=0;f<u;f++)s[l++]=c[f];e.push(i.length)}return r}const $=[],v=[];function Or(r,o,n,t,u){$[0]=r;const[e]=tr(v,$,o,n,t,u);return T($),T(v),e}function tr(r,o,n,t,u,e){if(T(r),!n){for(const s of o){const l=E(s,e);r.push(new k(null,s.attributes,null,l))}return r}switch(n){case"esriGeometryPoint":return Pr(r,o,t,u,e);case"esriGeometryMultipoint":return Zr(r,o,t,u,e);case"esriGeometryPolyline":return xr(r,o,t,u,e);case"esriGeometryPolygon":case"esriGeometryMultiPatch":return kr(r,o,t,u,e);default:z().error("convertToFeatureSet:unknown-geometry",new F("internal:geometry",`Unable to parse unknown geometry type '${n}'`)),T(r)}return r}function jr(r,o,n,t){v[0]=r,er($,v,o,n,t);const u=$[0];return T($),T(v),u}function Br(r,o,n){if(r==null)return null;const t=new P;return"hasZ"in r&&o==null&&(o=r.hasZ),"hasM"in r&&n==null&&(n=r.hasM),fr(r)?j(o??r.z!=null,n??r.m!=null)(t,r):ar(r)?nr(t,r,o,n):hr(r)?rr(t,r,w(o,n)):gr(r)?W(t,r,w(o,n)):void z().error("convertFromGeometry:unknown-geometry",new F("internal:geometry",`Unable to parse unknown geometry type '${r}'`))}function Er(r,o,n,t){const u=r&&("coords"in r?r:r.geometry);if(u==null)return null;switch(o){case"esriGeometryPoint":{let e=L;return n&&t?e=O:n?e=C:t&&(e=D),e(u)}case"esriGeometryMultipoint":return Q(u,n,t);case"esriGeometryPolyline":return X(u,n,t);case"esriGeometryPolygon":return or(u,n,t);default:return z().error("convertToGeometry:unknown-geometry",new F("internal:geometry",`Unable to parse unknown geometry type '${o}'`)),null}}function Fr(r,o){for(const n of o)r.push({attributes:n.attributes});return r}function er(r,o,n,t,u){if(T(r),n==null)return Fr(r,o);switch(n){case"esriGeometryPoint":return br(r,o,t,u);case"esriGeometryMultipoint":return Ir(r,o,t,u);case"esriGeometryPolyline":return Nr(r,o,t,u);case"esriGeometryPolygon":return $r(r,o,t,u);default:z().error("convertToFeatureSet:unknown-geometry",new F("internal:geometry",`Unable to parse unknown geometry type '${n}'`))}return r}function Hr(r){const{spatialReference:o,transform:n,fields:t,hasM:u,hasZ:e,features:s,geometryType:l,exceededTransferLimit:i,queryGeometry:c,queryGeometryType:f}=r,a={features:er([],s,l,e,u),fields:t,geometryType:l,spatialReference:o,queryGeometry:Er(c,f,!1,!1)};return n&&(a.transform=n),i&&(a.exceededTransferLimit=i),u&&(a.hasM=u),e&&(a.hasZ=e),a}function Jr(r,o){const n=new mr,{hasM:t,hasZ:u,features:e,spatialReference:s,geometryType:l,exceededTransferLimit:i,transform:c,fields:f}=r;return f&&(n.fields=f),n.geometryType=l??null,n.spatialReference=s??null,e&&tr(n.features,e,l,u,t,o),i&&(n.exceededTransferLimit=i),t&&(n.hasM=t),u&&(n.hasZ=u),c&&(n.transform=c),n}function Kr(r){const{transform:o,features:n,hasM:t,hasZ:u}=r;if(!o)return r;for(const e of n)e.geometry!=null&&J(e.geometry,e.geometry,t,u,o),e.centroid!=null&&J(e.centroid,e.centroid,t,u,o);return r.transform=null,r}function Qr(r,o){const{geometryType:n,features:t,hasM:u,hasZ:e}=o;if(!r)return o;for(let s=0;s<t.length;s++){const l=t[s],i=l.weakClone();i.geometry=new P,H(i.geometry,l.geometry,u,e,n,r),l.centroid&&(i.centroid=new P,H(i.centroid,l.centroid,u,e,"esriGeometryPoint",r)),t[s]=i}return o.transform=r,o}function H(r,o,n,t,u,e,s=n,l=t){if(Z(r),!o?.coords.length)return null;const i=q[u],{coords:c,lengths:f}=o,a=w(n,t),h=w(n&&s,t&&l),m=A(n,t,s,l);if(!f.length)return m(r.coords,c,0,0,U(e,c[0]),R(e,c[1])),Z(r,a,0),r;let g,y,M,b,p=0,d=0,G=d;for(const N of f){if(N<i)continue;let I=0;d=G,M=g=U(e,c[p]),b=y=R(e,c[p+1]),m(r.coords,c,d,p,M,b),I++,p+=a,d+=h;for(let x=1;x<N;x++,p+=a)M=U(e,c[p]),b=R(e,c[p+1]),M===g&&b===y||(m(r.coords,c,d,p,M-g,b-y),d+=h,I++,g=M,y=b);I>=i&&(r.lengths.push(I),G=d)}return T(r.coords,G),r.coords.length?r:null}function Wr(r,o,n,t,u,e,s=n,l=t){if(Z(r),!o?.coords.length)return null;const i=q[u],{coords:c,lengths:f}=o,a=w(n,t),h=w(n&&s,t&&l),m=A(n,t,s,l);if(!f.length)return m(r.coords,c,0,0,c[0],c[1]),Z(r,a,0),r;let g=0;const y=e*e;for(const M of f){if(M<i){g+=M*a;continue}const b=r.coords.length/h,p=g,d=g+(M-1)*a;m(r.coords,c,r.coords.length,p,c[p],c[p+1]),_(r.coords,c,a,y,m,p,d),m(r.coords,c,r.coords.length,d,c[d],c[d+1]);const G=r.coords.length/h-b;G>=i?r.lengths.push(G):T(r.coords,b*h),g+=M*a}return r.coords.length?r:null}function zr(r,o,n,t){const u=r[o],e=r[o+1],s=r[n],l=r[n+1],i=r[t],c=r[t+1];let f=s,a=l,h=i-f,m=c-a;if(h!==0||m!==0){const g=((u-f)*h+(e-a)*m)/(h*h+m*m);g>1?(f=i,a=c):g>0&&(f+=h*g,a+=m*g)}return h=u-f,m=e-a,h*h+m*m}function _(r,o,n,t,u,e,s){let l,i=t,c=0;for(let f=e+n;f<s;f+=n)l=zr(o,f,e,s),l>i&&(c=f,i=l);i>t&&(c-e>n&&_(r,o,n,t,u,e,c),u(r,o,r.length,c,o[c],o[c+1]),s-c>n&&_(r,o,n,t,u,c,s))}function Xr(r,o,n,t){if(!o?.coords?.length)return null;const u=w(n,t);let e=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY;if(o&&o.coords){const c=o.coords;for(let f=0;f<c.length;f+=u){const a=c[f],h=c[f+1];e=Math.min(e,a),l=Math.max(l,a),s=Math.min(s,h),i=Math.max(i,h)}}return lr(r)?cr(r,e,s,l,i):ir(e,s,l,i,r),r}function J(r,o,n,t,u){const{coords:e,lengths:s}=o,l=w(n,t);if(!e.length)return r!==o&&Z(r),r;ur(u);const{originPosition:i,scale:c,translate:f}=u,a=Rr;a.originPosition=i;const h=a.scale;h[0]=c[0]??1,h[1]=-(c[1]??1),h[2]=c[2]??1,h[3]=c[3]??1;const m=a.translate;if(m[0]=f[0]??0,m[1]=f[1]??0,m[2]=f[2]??0,m[3]=f[3]??0,!s.length){for(let y=0;y<l;++y)r.coords[y]=Y(a,e[y],y);return r!==o&&Z(r,l,0),r}let g=0;for(let y=0;y<s.length;y++){const M=s[y];r.lengths[y]=M;for(let d=0;d<l;++d)r.coords[g+d]=Y(a,e[g+d],d);let b=r.coords[g],p=r.coords[g+1];g+=l;for(let d=1;d<M;d++,g+=l){b+=e[g]*h[0],p+=e[g+1]*h[1],r.coords[g]=b,r.coords[g+1]=p;for(let G=2;G<l;++G)r.coords[g+G]=Y(a,e[g+G],G)}}return r!==o&&Z(r,e.length,s.length),r}function ro(r,o,n,t,u,e){if(Z(r),r.lengths.push(...o.lengths),n===u&&t===e)for(let s=0;s<o.coords.length;s++)r.coords.push(o.coords[s]);else{const s=w(n,t),l=A(n,t,u,e),i=o.coords;for(let c=0;c<i.length;c+=s)l(r.coords,i,r.coords.length,c,i[c],i[c+1])}return r}function Lr(r,o,n,t){let u=0,e=r[t*o],s=r[t*(o+1)];for(let l=1;l<n;l++){const i=e+r[t*(o+l)],c=s+r[t*(o+l)+1],f=(i-e)*(c+s);e=i,s=c,u+=f}return .5*u}function oo(r,o){const{coords:n,lengths:t}=r;let u=0,e=0;for(let s=0;s<t.length;s++){const l=t[s];e+=Lr(n,u,l,o),u+=l}return Math.abs(e)}function Ur(r,o,n,t){return r*t-n*o===0&&r*n+o*t>0}function no(r,o,n,t,u){const e=w(t,u);if(!r.lengths.length){if(r.coords.length<2)return null;const[a,h]=r.coords,m=S(o,a),g=V(o,h);return new P([],[m,g])}const s=new P([],[0,0]),l=q[n],i=n==="esriGeometryPolygon"||n==="esriGeometryPolyline";let c=0,f=0;for(let a=0;a<r.lengths.length;a++){const h=r.lengths[a],m=f;let g=S(o,r.coords[e*c]),y=V(o,r.coords[e*c+1]);s.coords[f++]=g,s.coords[f++]=y;let M=0,b=0,p=1;for(let d=1;d<h;d++){const G=S(o,r.coords[e*(d+c)]),N=V(o,r.coords[e*(d+c)+1]);if(G!==g||N!==y){const I=G-g,x=N-y;i&&Ur(M,b,I,x)?(s.coords[f-2]+=I,s.coords[f-1]+=x,g+=I,y+=x):(s.coords[f++]=G,s.coords[f++]=N,g=G,y=N,M=I,b=x,p+=1)}}p<l?f=m:s.lengths.push(p),c+=h}return s.lengths.length===0?null:s}function Z(r,o=0,n=0){T(r.lengths,n),T(r.coords,o)}function T(r,o=0){r.length!==o&&(r.length=o)}const Rr={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};export{Q as $,X as D,Dr as E,ro as G,Xr as M,oo as N,or as Q,Tr as R,R as T,nr as X,Jr as a,U as b,Wr as d,Hr as f,H as g,Kr as h,Er as l,Qr as m,Or as o,tr as r,jr as s,vr as t,Br as u,J as w,no as x};
