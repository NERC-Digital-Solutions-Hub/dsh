import{l as c}from"./62qj6Kpw.js";import{_ as d,m as p,a as u,M as b}from"./DEfw6_ef.js";import{O as f}from"./H0QphIdm.js";import{n as m}from"./XDfhPTz9.js";import{i as l}from"./Cg-g7sfq.js";import"./BsH20_Vs.js";import{b as g}from"./CXxgNwmb.js";function M(i){return new c({getCollections:()=>[i.tables,i.layers],getChildrenFunction:o=>{const a=[];return"tables"in o&&a.push(o.tables),"layers"in o&&a.push(o.layers),a},itemFilterFunction:o=>{const a=o.parent;return!!a&&"tables"in a&&a.tables.includes(o)}})}function F(i){for(const o of i.values())o?.destroy();i.clear()}function y(i,o,a){let e,t;if(i)for(let r=0,n=i.length;r<n;r++){if(e=i.at(r),e?.[o]===a)return e;if(e?.type==="group"&&(t=y(e.layers,o,a),t))return t}}const B=i=>{const o=i;let a=class extends o{constructor(...e){super(...e),this.layers=new f;const t=s=>{s.parent&&s.removeFromParent()},r=s=>{s.parent=this,this.layerAdded(s),s.type!=="elevation"&&s.type!=="base-elevation"||l.getLogger(this).error(`Layer 'title:${s.title}, id:${s.id}' of type '${s.type}' is not supported as an operational layer and will therefore be ignored.`)},n=s=>{s.parent=null,this.layerRemoved(s)};this.addHandles([this.layers.on("before-add",s=>{if(s.item===this)return s.preventDefault(),void l.getLogger(this).error("#add()","Cannot add layer to itself.");t(s.item)}),this.layers.on("after-add",s=>r(s.item)),this.layers.on("after-remove",s=>n(s.item))])}destroy(){const e=this.layers.toArray();for(const t of e)t.destroy();this.layers.destroy()}removeChildLayer(e){this.layers.remove(e),super.removeChildLayer?.(e)}set layers(e){this._set("layers",m(e,this._get("layers")))}add(e,t){const r=this.layers;if(t=r.getNextIndex(t),e instanceof g){const n=e;n.parent===this?this.reorder(n,t):r.add(n,t)}else b(e)?e.then(n=>{this.destroyed||this.add(n,t)}):l.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(e,t){const r=this.layers;let n=r.getNextIndex(t);e.slice().forEach(s=>{s.parent!==this?(r.add(s,n),n+=1):this.reorder(s,n)})}findLayerById(e){return y(this.layers,"id",e)}findLayerByUid(e){return y(this.layers,"uid",e)}remove(e){return this.layers.remove(e)}removeMany(e){return this.layers.removeMany(e)}removeAll(){return this.layers.removeAll()}reorder(e,t){return this.layers.reorder(e,t)}layerAdded(e){}layerRemoved(e){}};return d([p()],a.prototype,"layers",null),a=d([u("esri.support.LayersMixin")],a),a},v=new Set(["feature","subtype-group"]);function h(i,o,a){if(i)for(let e=0,t=i.length;e<t;e++){const r=i.at(e);if(r[o]===a)return r;if(r?.type==="group"){const n=h(r.tables,o,a);if(n)return n}}}const I=i=>{const o=i;let a=class extends o{constructor(...e){super(...e),this.tables=new f,this.addHandles([this.tables.on("after-add",t=>{const r=t.item;r.parent&&r.parent!==this&&r.removeFromParent(),r.parent=this,v.has(r.type)||l.getLogger(this).error(`Layer 'title:${r.title}, id:${r.id}' of type '${r.type}' is not supported as a table and will therefore be ignored.`)}),this.tables.on("after-remove",t=>{t.item.parent=null})])}destroy(){const e=this.tables.toArray();for(const t of e)t.destroy();this.tables.destroy()}removeChildLayer(e){this.tables.remove(e),super.removeChildLayer?.(e)}set tables(e){this._set("tables",m(e,this._get("tables")))}findTableById(e){return h(this.tables,"id",e)}findTableByUid(e){return h(this.tables,"uid",e)}};return d([p()],a.prototype,"tables",null),a=d([u("esri.support.TablesMixin")],a),a};export{B as a,F as b,I as n,M as t};
