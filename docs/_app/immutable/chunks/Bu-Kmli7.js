import{_ as u,m as f,a as U}from"./Aa_nm3Tf.js";import{f as W}from"./BEM1Pz9A.js";import{l as M}from"./CvJVpgMV.js";import{a as V,L as G,a3 as q,a4 as Q,W as S,u as C,n as X,o as Y}from"./BHwe4xe6.js";import{a as J}from"./BFGjv385.js";import{i as F}from"./DSdBzmdi.js";import{m as K,b as Z}from"./BvZ8mO3n.js";import{watch as j,syncAndInitial as ee,when as te}from"./D5lfJVJF.js";import{n as re}from"./Oe6SV2kF.js";import{s as se}from"./CEIvA_E-.js";import{P as R,Q as oe,R as ne,S as ie,T as E,U as ae,V as de,v as le,W as T,X as ce,Y as he}from"./CxXLonmD.js";import{n as pe}from"./DPysyl42.js";import{_ as ue}from"./DzPnzJx5.js";function me(t){return typeof t=="string"?document.getElementById(t):t??null}function Me(t,e){for(;;){const r=t.firstChild;if(!r)break;e.appendChild(r)}}const fe={handleInterceptedEvent:(t,e,r,s)=>(t.scheduleRender(),e.properties[`on${s.type}`].apply(e.properties.bind||r,[s]))},ge={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,r)=>{e.startsWith("-")?t.style.setProperty(e,r):t.style[e]=r}},ye=t=>({...ge,...t}),ve=(t,e)=>{const r=[];for(;t&&t!==e;)r.push(t),t=t.parentNode;return r},_e=(t,e)=>t.find(e),H=(t,e,r=!1)=>{let s=t;return e.forEach((c,i)=>{const h=s?.children?_e(s.children,p=>p.domNode===c):void 0;r&&!h&&i!==e.length-1||(s=h)}),s},$e=t=>{let e;const r={...fe,...t},s=ye(r),c=s.performanceLogger;let i,h=!0,p=!1;const o=[],n=[],g=(d,a,P)=>{let y;s.eventHandlerInterceptor=(Ne,Le,Se,Ce)=>function(v){let w;c("domEvent",v);const b=ve(v.currentTarget,y.domNode),x=b.some($=>customElements.get($?.tagName?.toLowerCase()));if(v.eventPhase===Event.CAPTURING_PHASE||!x)b.reverse(),w=H(y.getLastRender(),b);else{const $=v.composedPath(),D=$.slice($.indexOf(v.currentTarget),$.indexOf(y.domNode)).reverse();w=H(y.getLastRender(),D,!0)}let L;return w&&(L=r.handleInterceptedEvent(e,w,this,v)),c("domEventProcessed",v),L},r.postProcessProjectionOptions?.(s);const N=P();y=d(a,N,s),s.eventHandlerInterceptor=void 0,o.push(y),n.push(P),r.afterFirstVNodeRendered&&r.afterFirstVNodeRendered(y,N)};let m=()=>{if(i=void 0,h){h=!1,c("renderStart",void 0);for(let d=0;d<o.length;d++){const a=n[d]();c("rendered",void 0);try{o[d].update(a)}catch(P){console.error(P)}c("patched",void 0)}c("renderDone",void 0),h=!0}};return r.modifyDoRenderImplementation&&(m=r.modifyDoRenderImplementation(m,o,n)),e={renderNow:m,scheduleRender:()=>{i||p||(i=requestAnimationFrame(m))},stop:()=>{i&&(cancelAnimationFrame(i),i=void 0),p=!0},resume:()=>{p=!1,h=!0,e.scheduleRender()},append:(d,a)=>{g(R.append,d,a)},insertBefore:(d,a)=>{g(R.insertBefore,d,a)},merge:(d,a)=>{g(R.merge,d,a)},replace:(d,a)=>{g(R.replace,d,a)},detach:d=>{for(let a=0;a<n.length;a++)if(n[a]===d)return n.splice(a,1),o.splice(a,1)[0];throw new Error("renderFunction was not found")}},e};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */let B=!1;const Pe=t=>{B=!0,oe(t)};let O;function we(){B||Pe(ue(pe(O)))}function Ve(t){const e=[];for(const r of Object.keys(t))customElements.get(`calcite-${r}`)||e.push(t[r]?.());return e.length>0?Promise.all(e):null}O="components/assets";const k=new Set;function Re(t){k.add(t),t.finally(()=>k.delete(t))}function be(t){return V()}var A;let Ee=0;function z(t,e){const r=Object.prototype.hasOwnProperty;for(const s in e)r.call(e,s)&&r.call(t,s)&&(t[s]!=null&&e[s]!=null&&typeof t[s]=="object"&&typeof e[s]=="object"?z(t[s],e[s]):t[s]=e[s]);return t}const Ie=$e({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,r=/capture$/i;t.eventHandlerInterceptor=(s,c,i,h)=>{const p=e?.(s,c,i,h),o=r.test(s);if(!((s=s.replace(r,"")).toLowerCase()in i)||o){const n=s[2].toLowerCase()+s.slice(3),g=a=>p?.call(i,a);i.addEventListener(n,g,o);const m=()=>i.removeEventListener(n,g,o),d=h.afterRemoved;h.afterRemoved=a=>{d?.(a),m()}}return p}},handleInterceptedEvent(t,e,r,s){const{eventPhase:c,type:i}=s,h=c===Event.CAPTURING_PHASE;let p=`on${i}${h?"capture":""}`;const o=e.properties;(o&&p in o||(p=`on${i[0].toUpperCase()}${i.slice(1)}${h?"Capture":""}`,o&&p in o))&&(he(),t.scheduleRender(),o[p].call(o.bind||r,s))}});let I=!1;var _;let l=(_=class extends K(M){constructor(e,r){super(e,r),this._attached=!1,this._projector=Ie,this._readyForTrueRender=!1,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=G(async()=>{if(this._messageBundleProps?.length){const o=await Promise.allSettled(this._messageBundleProps.map(async({bundlePath:n,propertyName:g})=>{if(this.destroyed)return;let m=await W(n);this.destroyed||(this.uiStrings&&Object.keys(this.uiStrings)&&(m=z(J(m),this.uiStrings)),this[g]=m)}));if(this.destroyed)return;for(const n of o)n.status==="rejected"&&F.getLogger(this).error("widget-intl:locale-error",this.declaredClass,n.reason)}await this.loadLocale()}),this.addHandles(be()),we();const s="esri-widget-uid-"+re(),c=this.render.bind(this);this._trackingTarget=new q(()=>{this.autoRenderingEnabled&&this.scheduleRender()});const i=()=>({vnodeSelector:"div",properties:{key:`${s}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}),h=()=>{if(!this._readyForTrueRender||this.destroyed)return null;const o=c()??i(),n=o.properties??={};if(n.key??=s,T(o.vnodeSelector)){if(!this.visible)return i()}else this.visible?n.styles||(n.styles={}):(n.class="",n.styles={display:"none"}),n.styles.display??="";let g=0;return o.children?.forEach(m=>{T(m.vnodeSelector)||(m.properties??={},m.properties.key??=`${this.id}--${g++}`)}),ce(this,o)};this.render=()=>{if(I)return h();let o=ne(this)??null;if(o)return o;this._trackingTarget.clear(),I=!0;try{o=Q(this._trackingTarget,h)}catch(n){throw F.getLogger(this).error(n),n}finally{I=!1}return o&&ie(this,o),o};const p=this.beforeFirstRender();p?this._resourcesFetch=p.then(()=>{this.destroyed||(this._readyForTrueRender=!0,this._postInitialize())}):(this._resourcesFetch=Promise.resolve().then(()=>{this.destroyed||this._postInitialize()}),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),Re(this._resourcesFetch)}normalizeCtorArgs(e,r){const s={...e};return r&&(s.container=r),s}postInitialize(){}beforeFirstRender(){const e=this.loadDependencies();return this._messageBundleProps?.length||e?Promise.all([e,this._loadLocale()]).then(()=>{}).catch(S):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||(C(this._trackingTarget),C(this.viewModel),this._detach(this.container),this._set("container",null),this.render=()=>null,this._projector=null,E(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return me(e)}get destroyed(){return super.destroyed}get domNode(){return this.container}set domNode(e){this.container=e}get icon(){return null}set icon(e){this._overrideIfSome("icon",e)}get id(){return this._get("id")||this.container?.id||Date.now().toString(16)+"-widget-"+Ee++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get[(A=ae,de)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(E(this),this._projector.scheduleRender())}classes(...e){return le.apply(this,e)}renderNow(){E(this),this._projector.renderNow()}_postInitialize(){if(this.destroyed)return;this.scheduleRender(),this._delegatedEventNames?.length&&this.addHandles(j(()=>this.viewModel,(r,s)=>{s&&this.removeHandles("delegated-events"),r&&X(r)&&this.addHandles(this._delegatedEventNames.map(c=>Y(r,c,i=>{this.emit(c,i)})),"delegated-events")},ee)),this.postInitialize();const e=async()=>{await this._loadLocale().catch(S),this.scheduleRender()};this.addHandles([Z(e),j(()=>this.uiStrings,e)]),this.addHandles(te(()=>this.container,r=>{this.destroyed||this._attach(r)},{initial:!0,once:!0}))}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){this._attached&&(this._projector.detach(this.render),this._attached=!1),e?.parentNode?.removeChild(e)}},_[A]=!0,_.vnodeSelector="div",_);u([f()],l.prototype,"_readyForTrueRender",void 0),u([f({value:null})],l.prototype,"container",null),u([se("container")],l.prototype,"castContainer",null),u([f()],l.prototype,"icon",null),u([f()],l.prototype,"id",null),u([f()],l.prototype,"label",null),u([f()],l.prototype,"renderable",null),u([f()],l.prototype,"uiStrings",void 0),u([f()],l.prototype,"viewModel",void 0),u([f({value:!0})],l.prototype,"visible",null),u([f()],l.prototype,"key",void 0),u([f()],l.prototype,"children",void 0),u([f()],l.prototype,"afterCreate",void 0),u([f()],l.prototype,"afterUpdate",void 0),u([f()],l.prototype,"afterRemoved",void 0),l=u([U("esri.widgets.Widget")],l);const Ge=l;function qe(t){return(e,r)=>{e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]),e._messageBundleProps.push({bundlePath:t,propertyName:r})}}export{Ge as B,Ve as c,qe as e,me as n,Me as t};
