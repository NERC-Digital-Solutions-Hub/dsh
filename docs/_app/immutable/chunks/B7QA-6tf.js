import{_,a as g,c as v}from"./ChMEnlEh.js";import{q as P,$ as u,c as f,d as R,a as d}from"./B2reeZpr.js";import"./DUQhet5j.js";let b=class{constructor(){this._resolver=u(),this._status=0,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=1,this._cleanUp()},()=>{this._status=2,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(i){this._resolvingPromises.push(i),this._tryResolve()}isResolved(){return this._status===1}isRejected(){return this._status===2}isFulfilled(){return this._status!==0}abort(){this._resolver.reject(f())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const i=u(),t=[...this._resolvingPromises,i.promise],e=this._allPromise=Promise.all(t);e.then(()=>{this.isFulfilled()||this._allPromise!==e||this._resolver.resolve()},o=>{this.isFulfilled()||this._allPromise!==e||R(o)||this._resolver.reject(o)}),i.resolve()}};const $=s=>{const i=s;let t=class extends i{constructor(...e){super(...e),this._promiseProps=new b,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(e,o){return this._promiseProps.promise.then(()=>this).then(e,o)}catch(e){return this.when(null,e)}addResolvingPromise(e){e&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in e?e.when():e)}addResolvingTask(e){e&&!this._promiseProps.isFulfilled()&&(this.addHandles(P(e)),this._promiseProps.addResolvingPromise(e.promise))}};return t=_([g("esri.core.Promise")],t),t},E=$(v);let r;const F=globalThis.esriConfig?.locale??globalThis.dojoConfig?.locale,a=globalThis.document?.documentElement;function m(){const s=a?.getAttribute("lang"),i=globalThis.navigator?.language;return F??s??i??"en"}function h(){return r===void 0&&(r=m()),r}const x=/^(?<language>[a-z]{2,3})(?:-(?<extlang>[a-z]{3}))?(?:-[A-Z][a-z]{3})?(?:-(?<region>[A-Z]{2}|\d{3}))?(?:-.*)?$/;function U(s=h()){return p(s)?.language}function z(s=h()){const i=p(s);return i?.language&&i?.extlang?s.replace(`${i.language}-`,""):s}function p(s=h()){return x.exec(s)?.groups}const l=[];function A(s){return l.push(s),d(()=>{l.splice(l.indexOf(s),1)})}const n=[];function O(s){return n.push(s),d(()=>n.splice(n.indexOf(s),1))}function c(){const s=m();r!==s&&([...n].forEach(i=>i(s)),r=s,[...l].forEach(i=>i(s)))}globalThis.addEventListener?.("languagechange",c),a&&new MutationObserver(()=>{c()}).observe(a,{attributeFilter:["lang"]});export{A as b,h as l,$ as m,E as n,U as s,z as u,O as v};
