import"./DsnmJJEf.js";import{w,f as p,n as y,p as T,a$ as R,c as L,g as F,a0 as A,s as V,aA as W,b as P}from"./Dg8B37cN.js";import{m as j,u as H}from"./Dy6t_wds.js";import{s as g}from"./B3syFVNQ.js";import{i as q,p as d}from"./DX-cJOE_.js";import{c as v,a as b}from"./Lqxt2u0_.js";import{C as U,a as u,w as C,h as E,D as z,j as N}from"./BZOnCu_P.js";import{k as G,n as f,d as J,e as Q,i as X,f as Y}from"./ljVO7sdT.js";import{i as Z,a as $,b as ee}from"./E04xfZlq.js";import{o as h}from"./2p-loE3l.js";function te(n){w(()=>()=>{n()})}function ne(n,e){var t=v(),r=p(t);G(r,()=>e.children,s=>{var i=v(),o=p(i);g(o,()=>e.children??y),b(s,i)}),b(n,t)}const re=new U("BitsConfig");function se(){const n=new ie(null,{});return re.getOr(n).opts}class ie{opts;constructor(e,t){const r=oe(e,t);this.opts={defaultPortalTo:r(s=>s.defaultPortalTo),defaultLocale:r(s=>s.defaultLocale)}}}function oe(n,e){return t=>u(()=>{const s=t(e)?.current;if(s!==void 0)return s;if(n!==null)return t(n.opts)?.current})}function x(n,e){return t=>{const r=se();return u(()=>{const s=t();if(s!==void 0)return s;const i=n(r).current;return i!==void 0?i:e})}}const Ce=x(n=>n.defaultLocale,"en"),ae=x(n=>n.defaultPortalTo,"body");function Oe(n,e){T(e,!0);const t=ae(()=>e.to),r=R();let s=A(i);function i(){if(!Z||e.disabled)return null;let c=null;return typeof t.current=="string"?c=document.querySelector(t.current):c=t.current,c}let o;function a(){o&&(H(o),o=null)}C([()=>F(s),()=>e.disabled],([c,m])=>{if(!c||m){a();return}return o=j(ne,{target:c,props:{children:e.children},context:r}),()=>{a()}});var l=v(),K=p(l);{var S=c=>{var m=v(),M=p(m);g(M,()=>e.children??y),b(c,m)};q(K,c=>{e.disabled&&c(S)})}b(n,l),L()}class De{eventName;options;constructor(e,t={bubbles:!0,cancelable:!0}){this.eventName=e,this.options=t}createEvent(e){return new CustomEvent(this.eventName,{...this.options,detail:e})}dispatch(e,t){const r=this.createEvent(t);return e.dispatchEvent(r),r}listen(e,t,r){const s=i=>{t(i)};return h(e,this.eventName,s,r)}}function I(n,e=500){let t=null;const r=(...s)=>{t!==null&&clearTimeout(t),t=setTimeout(()=>{n(...s)},e)};return r.destroy=()=>{t!==null&&(clearTimeout(t),t=null)},r}function B(n,e){return n===e||n.contains(e)}function _(n){return n?.ownerDocument??document}globalThis.bitsDismissableLayers??=new Map;class O{static create(e){return new O(e)}opts;#n;#e;#r={pointerdown:!1};#i=!1;#o=!1;#s=void 0;#u;#t=f;constructor(e){this.opts=e,this.#e=e.interactOutsideBehavior,this.#n=e.onInteractOutside,this.#u=e.onFocusOutside,w(()=>{this.#s=_(this.opts.ref.current)});let t=f;const r=()=>{this.#c(),globalThis.bitsDismissableLayers.delete(this),this.#a.destroy(),t()};C([()=>this.opts.enabled.current,()=>this.opts.ref.current],()=>{if(!(!this.opts.enabled.current||!this.opts.ref.current))return Q(1,()=>{this.opts.ref.current&&(globalThis.bitsDismissableLayers.set(this,this.#e),t(),t=this.#f())}),r}),te(()=>{this.#c.destroy(),globalThis.bitsDismissableLayers.delete(this),this.#a.destroy(),this.#t(),t()})}#l=e=>{e.defaultPrevented||this.opts.ref.current&&J(()=>{!this.opts.ref.current||this.#b(e.target)||e.target&&!this.#o&&this.#u.current?.(e)})};#f(){return E(h(this.#s,"pointerdown",E(this.#h,this.#v),{capture:!0}),h(this.#s,"pointerdown",E(this.#p,this.#a)),h(this.#s,"focusin",this.#l))}#d=e=>{let t=e;t.defaultPrevented&&(t=k(e)),this.#n.current(e)};#a=I(e=>{if(!this.opts.ref.current){this.#t();return}const t=this.opts.isValidEvent.current(e,this.opts.ref.current)||le(e,this.opts.ref.current);if(!this.#i||this.#m()||!t){this.#t();return}let r=e;if(r.defaultPrevented&&(r=k(r)),this.#e.current!=="close"&&this.#e.current!=="defer-otherwise-close"){this.#t();return}e.pointerType==="touch"?(this.#t(),this.#t=h(this.#s,"click",this.#d,{once:!0})):this.#n.current(r)},10);#h=e=>{this.#r[e.type]=!0};#p=e=>{this.#r[e.type]=!1};#v=()=>{this.opts.ref.current&&(this.#i=ce(this.opts.ref.current))};#b=e=>this.opts.ref.current?B(this.opts.ref.current,e):!1;#c=I(()=>{for(const e in this.#r)this.#r[e]=!1;this.#i=!1},20);#m(){return Object.values(this.#r).some(Boolean)}#y=()=>{this.#o=!0};#g=()=>{this.#o=!1};props={onfocuscapture:this.#y,onblurcapture:this.#g}}function ue(n=[...globalThis.bitsDismissableLayers]){return n.findLast(([e,{current:t}])=>t==="close"||t==="ignore")}function ce(n){const e=[...globalThis.bitsDismissableLayers],t=ue(e);if(t)return t[0].opts.ref.current===n;const[r]=e[0];return r.opts.ref.current===n}function le(n,e){if("button"in n&&n.button>0)return!1;const t=n.target;return $(t)?_(t).documentElement.contains(t)&&!B(e,t)&&X(n,e):!1}function k(n){const e=n.currentTarget,t=n.target;let r;n instanceof PointerEvent?r=new PointerEvent(n.type,n):r=new PointerEvent("pointerdown",n);let s=!1;return new Proxy(r,{get:(o,a)=>a==="currentTarget"?e:a==="target"?t:a==="preventDefault"?()=>{s=!0,typeof o.preventDefault=="function"&&o.preventDefault()}:a==="defaultPrevented"?s:a in o?o[a]:n[a]})}function Pe(n,e){T(e,!0);let t=d(e,"interactOutsideBehavior",3,"close"),r=d(e,"onInteractOutside",3,f),s=d(e,"onFocusOutside",3,f),i=d(e,"isValidEvent",3,()=>!1);const o=O.create({id:u(()=>e.id),interactOutsideBehavior:u(()=>t()),onInteractOutside:u(()=>r()),enabled:u(()=>e.enabled),onFocusOutside:u(()=>s()),isValidEvent:u(()=>i()),ref:e.ref});var a=v(),l=p(a);g(l,()=>e.children??y,()=>({props:o.props})),b(n,a),L()}globalThis.bitsEscapeLayers??=new Map;class D{static create(e){return new D(e)}opts;domContext;constructor(e){this.opts=e,this.domContext=new z(this.opts.ref);let t=f;C(()=>e.enabled.current,r=>(r&&(globalThis.bitsEscapeLayers.set(this,e.escapeKeydownBehavior),t=this.#n()),()=>{t(),globalThis.bitsEscapeLayers.delete(this)}))}#n=()=>h(this.domContext.getDocument(),"keydown",this.#e,{passive:!1});#e=e=>{if(e.key!==Y||!fe(this))return;const t=new KeyboardEvent(e.type,e);e.preventDefault();const r=this.opts.escapeKeydownBehavior.current;r!=="close"&&r!=="defer-otherwise-close"||this.opts.onEscapeKeydown.current(t)}}function fe(n){const e=[...globalThis.bitsEscapeLayers],t=e.findLast(([s,{current:i}])=>i==="close"||i==="ignore");if(t)return t[0]===n;const[r]=e[0];return r===n}function Ie(n,e){T(e,!0);let t=d(e,"escapeKeydownBehavior",3,"close"),r=d(e,"onEscapeKeydown",3,f);D.create({escapeKeydownBehavior:u(()=>t()),onEscapeKeydown:u(()=>r()),enabled:u(()=>e.enabled),ref:e.ref});var s=v(),i=p(s);g(i,()=>e.children??y),b(n,s),L()}const de={afterMs:1e4,onChange:f};function ke(n,e){const{afterMs:t,onChange:r,getWindow:s}={...de,...e};let i=null,o=V(W(n));function a(){return s().setTimeout(()=>{P(o,n,!0),r?.(n)},t)}return w(()=>()=>{i&&s().clearTimeout(i)}),u(()=>F(o),l=>{P(o,l,!0),r?.(l),i&&s().clearTimeout(i),i=a()})}function he(n,{select:e=!1}={}){if(!n||!n.focus)return;const t=N(n);if(t.activeElement===n)return;const r=t.activeElement;n.focus({preventScroll:!0}),n!==r&&ee(n)&&e&&n.select()}function Fe(n,{select:e=!1}={},t){const r=t();for(const s of n)if(he(s,{select:e}),t()!==r)return!0}function Ne(n){const e=[],r=N(n).createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const i=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||i?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}export{De as C,Pe as D,Ie as E,Oe as P,ke as b,Fe as f,Ne as g,te as o,Ce as r};
