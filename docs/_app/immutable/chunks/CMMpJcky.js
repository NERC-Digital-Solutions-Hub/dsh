import{k as U,L as M,aq as q,ar as G,an as C,u as F,aI as V,ac as W,_ as u,m as f,a as K}from"./Vj4mvAVU.js";import{g as Y}from"./BjBhzReJ.js";import{l as J,a as S,w as Q,f as X}from"./C8hxyIL3.js";import{a as Z}from"./BzZgUCJc.js";import{i as j}from"./C9_KfL0q.js";import{a as ee,b as te}from"./Dk327Tp9.js";import{n as re}from"./4IwU-EsI.js";import{Y as se,O as oe}from"./2lNp6ocP.js";import{b as w,e as ne,c as ie,o as E,t as ae,d as de,v as le,f as k,g as ce,h as he}from"./CKggWTKP.js";import{K as pe}from"./DOBtub6T.js";import{_ as ue}from"./COT3swUQ.js";function me(t){return typeof t=="string"?document.getElementById(t):t??null}function Ue(t,e){for(;;){const r=t.firstChild;if(!r)break;e.appendChild(r)}}const fe={handleInterceptedEvent:(t,e,r,s)=>(t.scheduleRender(),e.properties[`on${s.type}`].apply(e.properties.bind||r,[s]))},ge={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,r)=>{e.startsWith("-")?t.style.setProperty(e,r):t.style[e]=r}},ye=t=>({...ge,...t}),ve=(t,e)=>{const r=[];for(;t&&t!==e;)r.push(t),t=t.parentNode;return r},_e=(t,e)=>t.find(e),H=(t,e,r=!1)=>{let s=t;return e.forEach((c,i)=>{const h=s?.children?_e(s.children,p=>p.domNode===c):void 0;r&&!h&&i!==e.length-1||(s=h)}),s},$e=t=>{let e;const r={...fe,...t},s=ye(r),c=s.performanceLogger;let i,h=!0,p=!1;const o=[],n=[],g=(d,a,P)=>{let y;s.eventHandlerInterceptor=(Ne,Le,Ce,Fe)=>function(v){let b;c("domEvent",v);const R=ve(v.currentTarget,y.domNode),x=R.some($=>customElements.get($?.tagName?.toLowerCase()));if(v.eventPhase===Event.CAPTURING_PHASE||!x)R.reverse(),b=H(y.getLastRender(),R);else{const $=v.composedPath(),D=$.slice($.indexOf(v.currentTarget),$.indexOf(y.domNode)).reverse();b=H(y.getLastRender(),D,!0)}let L;return b&&(L=r.handleInterceptedEvent(e,b,this,v)),c("domEventProcessed",v),L},r.postProcessProjectionOptions?.(s);const N=P();y=d(a,N,s),s.eventHandlerInterceptor=void 0,o.push(y),n.push(P),r.afterFirstVNodeRendered&&r.afterFirstVNodeRendered(y,N)};let m=()=>{if(i=void 0,h){h=!1,c("renderStart",void 0);for(let d=0;d<o.length;d++){const a=n[d]();c("rendered",void 0);try{o[d].update(a)}catch(P){console.error(P)}c("patched",void 0)}c("renderDone",void 0),h=!0}};return r.modifyDoRenderImplementation&&(m=r.modifyDoRenderImplementation(m,o,n)),e={renderNow:m,scheduleRender:()=>{i||p||(i=requestAnimationFrame(m))},stop:()=>{i&&(cancelAnimationFrame(i),i=void 0),p=!0},resume:()=>{p=!1,h=!0,e.scheduleRender()},append:(d,a)=>{g(w.append,d,a)},insertBefore:(d,a)=>{g(w.insertBefore,d,a)},merge:(d,a)=>{g(w.merge,d,a)},replace:(d,a)=>{g(w.replace,d,a)},detach:d=>{for(let a=0;a<n.length;a++)if(n[a]===d)return n.splice(a,1),o.splice(a,1)[0];throw new Error("renderFunction was not found")}},e};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */let A=!1;const Pe=t=>{A=!0,pe(t)};let O;function be(){A||Pe(ue(se(O)))}function Me(t){const e=[];for(const r of Object.keys(t))customElements.get(`calcite-${r}`)||e.push(t[r]?.());return e.length>0?Promise.all(e):null}O="components/assets";const T=new Set;function we(t){T.add(t),t.finally(()=>T.delete(t))}function Re(t){return U()}var B;let Ee=0;function z(t,e){const r=Object.prototype.hasOwnProperty;for(const s in e)r.call(e,s)&&r.call(t,s)&&(t[s]!=null&&e[s]!=null&&typeof t[s]=="object"&&typeof e[s]=="object"?z(t[s],e[s]):t[s]=e[s]);return t}const Ie=$e({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,r=/capture$/i;t.eventHandlerInterceptor=(s,c,i,h)=>{const p=e?.(s,c,i,h),o=r.test(s);if(!((s=s.replace(r,"")).toLowerCase()in i)||o){const n=s[2].toLowerCase()+s.slice(3),g=a=>p?.call(i,a);i.addEventListener(n,g,o);const m=()=>i.removeEventListener(n,g,o),d=h.afterRemoved;h.afterRemoved=a=>{d?.(a),m()}}return p}},handleInterceptedEvent(t,e,r,s){const{eventPhase:c,type:i}=s,h=c===Event.CAPTURING_PHASE;let p=`on${i}${h?"capture":""}`;const o=e.properties;(o&&p in o||(p=`on${i[0].toUpperCase()}${i.slice(1)}${h?"Capture":""}`,o&&p in o))&&(he(),t.scheduleRender(),o[p].call(o.bind||r,s))}});let I=!1;var _;let l=(_=class extends ee(J){constructor(e,r){super(e,r),this._attached=!1,this._projector=Ie,this._readyForTrueRender=!1,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=M(async()=>{if(this._messageBundleProps?.length){const o=await Promise.allSettled(this._messageBundleProps.map(async({bundlePath:n,propertyName:g})=>{if(this.destroyed)return;let m=await Y(n);this.destroyed||(this.uiStrings&&Object.keys(this.uiStrings)&&(m=z(Z(m),this.uiStrings)),this[g]=m)}));if(this.destroyed)return;for(const n of o)n.status==="rejected"&&j.getLogger(this).error("widget-intl:locale-error",this.declaredClass,n.reason)}await this.loadLocale()}),this.addHandles(Re()),be();const s="esri-widget-uid-"+re(),c=this.render.bind(this);this._trackingTarget=new q(()=>{this.autoRenderingEnabled&&this.scheduleRender()});const i=()=>({vnodeSelector:"div",properties:{key:`${s}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}),h=()=>{if(!this._readyForTrueRender||this.destroyed)return null;const o=c()??i(),n=o.properties??={};if(n.key??=s,k(o.vnodeSelector)){if(!this.visible)return i()}else this.visible?n.styles||(n.styles={}):(n.class="",n.styles={display:"none"}),n.styles.display??="";let g=0;return o.children?.forEach(m=>{k(m.vnodeSelector)||(m.properties??={},m.properties.key??=`${this.id}--${g++}`)}),ce(this,o)};this.render=()=>{if(I)return h();let o=ne(this)??null;if(o)return o;this._trackingTarget.clear(),I=!0;try{o=G(this._trackingTarget,h)}catch(n){throw j.getLogger(this).error(n),n}finally{I=!1}return o&&ie(this,o),o};const p=this.beforeFirstRender();p?this._resourcesFetch=p.then(()=>{this.destroyed||(this._readyForTrueRender=!0,this._postInitialize())}):(this._resourcesFetch=Promise.resolve().then(()=>{this.destroyed||this._postInitialize()}),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),we(this._resourcesFetch)}normalizeCtorArgs(e,r){const s={...e};return r&&(s.container=r),s}postInitialize(){}beforeFirstRender(){const e=this.loadDependencies();return this._messageBundleProps?.length||e?Promise.all([e,this._loadLocale()]).then(()=>{}).catch(C):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||(F(this._trackingTarget),F(this.viewModel),this._detach(this.container),this._set("container",null),this.render=()=>null,this._projector=null,E(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return me(e)}get destroyed(){return super.destroyed}get domNode(){return this.container}set domNode(e){this.container=e}get icon(){return null}set icon(e){this._overrideIfSome("icon",e)}get id(){return this._get("id")||this.container?.id||Date.now().toString(16)+"-widget-"+Ee++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get[(B=ae,de)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(E(this),this._projector.scheduleRender())}classes(...e){return le.apply(this,e)}renderNow(){E(this),this._projector.renderNow()}_postInitialize(){if(this.destroyed)return;this.scheduleRender(),this._delegatedEventNames?.length&&this.addHandles(S(()=>this.viewModel,(r,s)=>{s&&this.removeHandles("delegated-events"),r&&V(r)&&this.addHandles(this._delegatedEventNames.map(c=>W(r,c,i=>{this.emit(c,i)})),"delegated-events")},Q)),this.postInitialize();const e=async()=>{await this._loadLocale().catch(C),this.scheduleRender()};this.addHandles([te(e),S(()=>this.uiStrings,e)]),this.addHandles(X(()=>this.container,r=>{this.destroyed||this._attach(r)},{initial:!0,once:!0}))}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){this._attached&&(this._projector.detach(this.render),this._attached=!1),e?.parentNode?.removeChild(e)}},_[B]=!0,_.vnodeSelector="div",_);u([f()],l.prototype,"_readyForTrueRender",void 0),u([f({value:null})],l.prototype,"container",null),u([oe("container")],l.prototype,"castContainer",null),u([f()],l.prototype,"icon",null),u([f()],l.prototype,"id",null),u([f()],l.prototype,"label",null),u([f()],l.prototype,"renderable",null),u([f()],l.prototype,"uiStrings",void 0),u([f()],l.prototype,"viewModel",void 0),u([f({value:!0})],l.prototype,"visible",null),u([f()],l.prototype,"key",void 0),u([f()],l.prototype,"children",void 0),u([f()],l.prototype,"afterCreate",void 0),u([f()],l.prototype,"afterUpdate",void 0),u([f()],l.prototype,"afterRemoved",void 0),l=u([K("esri.widgets.Widget")],l);const qe=l;function Ge(t){return(e,r)=>{e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]),e._messageBundleProps.push({bundlePath:t,propertyName:r})}}export{qe as B,Me as c,Ge as e,me as n,Ue as t};
