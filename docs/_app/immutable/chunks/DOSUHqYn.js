const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DXyHzKEH.js","./CNKkBltG.js","./cj780n54.js","./CuJjo2fS.js","./Ei29lXAh.js","./B92kdZ15.js","./-Rap9rN9.js","./CkfJ-xIb.js","./qExclXic.js","./DP7_WWTp.js","./Buev1GnW.js","./nr4b1jUc.js","./DJt6mz6N.js","./CuBBWuXO.js","./c4fXHdau.js","./BN-fQns9.js","./2AX6zFE-.js"])))=>i.map(i=>d[i]);
import{_ as $}from"./CkfJ-xIb.js";import{z as C,an as L,_ as V}from"./-Rap9rN9.js";import{c as R}from"./DtCJyMjv.js";function b(e,r){if(e.spatialReference.equals(r))return e;const t=L(e.spatialReference),i=L(r);if(t===i)return e;const a=t/i;return{x:e.x*a,y:e.y*a}}async function N(e,r,t){if(t.type==="extent")return B(e,r,t);const{width:i,height:a}=e,n=new Uint8Array(i*a);return(await $(async()=>{const{execute:h}=await import("./DXyHzKEH.js").then(x=>x.i);return{execute:h}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)).execute(r,t)?t.type==="polyline"?F(e,r,t):(await $(async()=>{const{execute:h}=await import("./2AX6zFE-.js").then(x=>x.c);return{execute:h}},__vite__mapDeps([16,1,2,3,4,5,6,7,8,9,10,11,12,13,15]),import.meta.url)).execute(t,r)?e:j(e,r,t):new R({pixelType:e.pixelType,width:i,height:a,mask:n,maskIsAlpha:!1,pixels:[...e.pixels]})}function j(e,r,t){if(!e)return e;const{width:i,height:a}=e,n=q({geometry:t,size:[i,a],srcExtent:r,srcMask:e.mask});return new R({pixelType:e.pixelType,width:i,height:a,mask:n,maskIsAlpha:!1,pixels:[...e.pixels]})}function q(e){const{geometry:r,size:t,srcExtent:i,srcMask:a}=e,[n,h]=t;let x;const l=i.width/n,u=i.height/h,{xmin:s,ymax:o}=i;if(r.type==="extent"){const f=(r.xmin-s)/l,p=(r.xmax-s)/l,c=(o-r.ymax)/u,y=(o-r.ymin)/u;x=[[[f,c],[f,y],[p,y],[p,c],[f,c]]]}else x=r.rings.map((f=>f.map((([p,c])=>[(p-s)/l,(o-c)/u]))));return Z(x,t,a)}function Z(e,r,t){const[i,a]=r,n=new OffscreenCanvas(i,a).getContext("2d");n.fillStyle="#f00",n.beginPath(),e.forEach((s=>{n.moveTo(s[0][0],s[0][1]);for(let o=0;o<s.length;o++)n.lineTo(s[o][0],s[o][1]);n.closePath()})),n.fill();const h=n.getImageData(0,0,i,a).data,x=i*a,l=new Uint8Array(x);let u=!1;for(let s=0;s<x;s++)t&&!t[s]||(h[4*s+3]>127?l[s]=255:u=!0);return u||t?l:void 0}function B(e,r,t){const{width:i,height:a}=e,n=new Uint8Array(i*a),h=r.width/i,x=r.height/a;if(t.width/h<.5||t.height/x<.5)return new R({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]});const{xmin:l,xmax:u,ymin:s,ymax:o}=r,{xmin:f,xmax:p,ymin:c,ymax:y}=t,m=Math.max(l,f),A=Math.min(u,p),g=Math.max(s,c),M=Math.min(o,y),w=.5*h,z=.5*x;if(A-m<w||M-g<z||A<l+w||m>u-w||g>o-z||M<s+z)return new R({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]});const d=Math.max(0,(m-l)/h),v=Math.min(i,Math.max(0,(A-l)/h)),P=Math.max(0,(o-M)/x),_=Math.min(a,Math.max(0,(o-g)/x)),T=Math.round(d),E=Math.round(v)-1,k=Math.round(P),I=Math.round(_)-1;if(T===E&&d%1>.5&&v%1<.5||k===I&&P%1>.5&&_%1<.5)return new R({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]});if(T===0&&k===0&&E===i&&I===a)return e;const D=e.mask;for(let S=k;S<=I;S++)for(let U=T;U<=E;U++){const O=S*i+U;n[O]=D?D[O]:255}return new R({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]})}function F(e,r,t){const{width:i,height:a}=e,n=new Uint8Array(i*a),h=r.width/i,x=r.height/a,{xmin:l,ymax:u}=r,{paths:s}=t,o=e.mask;for(let f=0;f<s.length;f++){const p=s[f];for(let c=0;c<p.length-1;c++){const[y,m]=p[c],[A,g]=p[c+1];let M=Math.floor((u-m)/x),w=Math.floor((u-g)/x);if(w<M){const d=M;M=w,w=d}M=Math.max(0,M),w=Math.min(a-1,w);const z=(A-y)/(g-m);for(let d=M;d<=w;d++){const v=d===M?Math.max(m,g):(a+1-d)*x,P=d===w?Math.min(m,g):v-x;let _=Math.floor(g===m?(y-l)/h:(z*(v-m)+y-l)/h),T=Math.floor(g===m?(A-l)/h:(z*(P-m)+y-l)/h);if(T<_){const k=_;_=T,T=k}const E=d*i;_=Math.max(0,_),T=Math.min(i-1,T);for(let k=E+_;k<=E+T;k++)n[k]=o?o[k]:255}}}return new R({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]})}function Q(e,r){const{extent:t}=G(e,r,new V({x:e.pixelSize.x,y:e.pixelSize.y,spatialReference:e.spatialReference})),{extent:i}=e.extent;if(t.xmax=Math.min(t.xmax,i.xmax),t.ymax=Math.min(t.ymax,i.ymax),t.xmin<t.xmax&&t.ymin<t.ymax){const{x:a,y:n}=e.pixelSize,h=Math.round(t.width/a),x=Math.round(t.height/n);e.extent=t,e.width=h,e.height=x}}function G(e,r,t,i=!0){const{spatialReference:a}=e,{x:n,y:h}=b(t,a);let x,l,u;const s=r.type==="extent"?r:r.extent;let{xmin:o,xmax:f,ymax:p,ymin:c}=s;const{xmin:y,ymax:m}=e.extent;return i?(o=y+(o>y?n*Math.round((o-y)/n):0),p=m-(p<m?h*Math.round((m-p)/h):0),f=y+(f>y?n*Math.round((f-y)/n):0),c=m-(c<m?h*Math.round((m-c)/h):0),x=new C({xmin:o,ymax:p,xmax:f,ymin:c,spatialReference:a}),l=Math.round(x.width/n),u=Math.round(x.height/h)):(l=Math.floor((f-o)/n+.8),u=Math.floor((p-c)/h+.8),o=y+(o>y?n*Math.floor((o-y)/n+.1):0),p=m-(p<m?h*Math.floor((m-p)/h+.1):0),f=o+l*n,c=p-u*h,x=new C({xmin:o,ymax:p,xmax:f,ymin:c,spatialReference:a})),{extent:x,width:l,height:u}}export{Q as l,G as p,N as r,q as x};
