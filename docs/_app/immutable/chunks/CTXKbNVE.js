const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./D5f-lHjI.js","./DvUDi2Se.js","./CnfuZz2S.js","./BYatcg2i.js","./DSvukMJ1.js","./CJqWAG8q.js","./Db_cRbTq.js","./pZ2g7Ohf.js","./PPVm8Dsz.js","./DTbuUgvd.js","./BtRNH9HO.js","./C3DztaFN.js","./DedWa6hQ.js","./CbAk7Q2g.js","./InWWYu7p.js","./Fd-zc6xv.js","./Bs5I5-7o.js","./Bx7Drccn.js","./D6KPPgz5.js","./BRjzZcZp.js","./Cm1FCrMa.js","./Cl5lrJ4c.js","./C8BmVxiO.js","./COHLhXik.js","./Bm2XoyXc.js","./BsxeN7wM.js","./EzLf78vY.js","./BqEomFx0.js","./WcbF0m06.js","./D2fJSBL9.js","./DHdURl-u.js","./BTFaZ95N.js","./Hpj2QL01.js","./CdZ5E7Js.js","./D6wORzA5.js","./Ct-FuPNe.js","./BDErjlP0.js","./BmZQD3Tc.js","./9YvG7tFv.js","./DwIAbcbk.js","./Bunn428X.js","./aQeO9QTD.js","./CLdLWz9D.js","./Bstk8l7f.js","./BVStbsji.js","./muspHcCn.js","./BSsBqB8a.js","./BfUcY0IH.js","./BmSEwv4k.js","./ZfJYk1lX.js","./Dg2Cy1wG.js","./Cfk1RgA5.js","./D26fh4vX.js","./CsmaOzwV.js","./Cv9IkvcT.js","./C2A-cDAk.js","./DPRDD1To.js","./CzgEe7_M.js","./Co6MM1WB.js","./L9sxntLJ.js","./Dz9nnGQp.js","./BZVu3XrO.js","./DI4_79_v.js","./nDOBqX6c.js","./DPeJS9ie.js","./GKolV7NZ.js","./CLfdaVZL.js","./BvI0vjxO.js","./BoVlFCoi.js","./Byb_ddQ1.js","./DayGv1xo.js","./DFa2M8Ih.js","./C4Jp8HMJ.js","./UjjEJtDR.js","./Djp3mnm5.js","./BkkzFYiK.js","./DQOJ18NT.js","./BYWLb-qP.js","./D-YQ4CHs.js","./CQM3m500.js","./DBzD8FIy.js","./Ct5BCk5d.js","./KcazVFlU.js","./CYsUaMUi.js","./mxPIBlca.js","./Dp3s0ZcO.js","./B1Bh4S2o.js","./BzFyVeiR.js","./Bb0xX_Fn.js","./CFX_YiyI.js","./CefFkNr2.js","./DOAJfpyz.js","./B6Hh54jn.js","./DKMbv1dP.js","./BXfupK_G.js","./BkQcsSCB.js","./DPb6J-GU.js","./Cw4sh3xC.js","./DZpgY3Wp.js","./BXcKK5tC.js","./Bt46m4pd.js","./9jLW-1Ig.js","./kro8eSGX.js","./DJrk0ZKs.js","./BZbOVUP0.js","./RkHh7_F4.js","./Cj7IhThc.js","./DMj-F556.js","./COsq1Oii.js","./BBYFSOBi.js","./D_qA3yb9.js","./3PNoDE1S.js","./BR8EEvDc.js","./OVZo4xRf.js","./elf00Mmu.js","./BTzO5B6K.js","./DWtdFFwQ.js","./Dqz3n4A5.js","./DRborcvU.js","./CVqfDkJl.js","./B7VbszFd.js","./C5CzMsLd.js","./C9lK54Hu.js","./Cigsg82C.js","./BwvlIeVB.js","./Cu2J4Q4w.js","./CB8DDl4O.js","./Cvu3dz6j.js","./CjV58eza.js","./VMSlSy0z.js","./CWwez7Ew.js","./B9TnOdWG.js","./B-KfLzZb.js","./D7MNnqkP.js","./X9GVov2f.js","./CEn1iOYu.js","./BpCBUT2X.js","./qWbuC5Wj.js","./B0YVZ3UN.js","./CTVS09Kb.js","./ThCcySDx.js","./BkCRFj7C.js","./K4FY9oqR.js","./CL2yxhDV.js","./COhKi5I6.js","./hpPpwecu.js","./C2-YgiZF.js","./C03-sIHu.js","./MtSiOt06.js","./CwFyj4KC.js","./JI8MBgth.js","./QYHQISVP.js","./BNRAtZeH.js","./Cn-KJRkU.js","./VEGSGQ51.js","./CeqSKNOq.js","./C-gotZDZ.js","./BpS0eVY-.js","./C9BgZYvd.js","./D5QddsNZ.js","./BTdrrTIi.js","./DqGAFGWo.js","./CRfvaNoS.js","./BfuGwL9X.js","./DyEdvwqw.js","./CL2NbQte.js","./BzGHCuFd.js","./D7XwZUDn.js","./TczBj6Ot.js","./bexxTcmF.js","./BjhwDpSk.js","./CMQCdq-P.js","./B8l_M83k.js","./CB8wlU_f.js","./Be5f_i9z.js","./f2dYmovg.js","./5_frVxKl.js","./DUHXxiGY.js","./Ch8h0jEw.js","./CRKBOk0z.js","./BiphejqT.js","./pDuGEAnG.js","./D7mer9Se.js","./wm1q4thl.js","./CnatBA7k.js","./CJcipZJa.js","./DV_D_ms-.js","./DFgV62uo.js","./DwqrsEzQ.js","./QXap_35O.js","./CtDOi6ec.js","./CASyCajO.js","./BOEID1Kf.js","./BRxoU36Y.js","./C4eyRFHZ.js","./CaVKkSa6.js","./CUzevAry.js","./C8zGwbjb.js","./DPw1_jRx.js","./_rUCDO1N.js","./QQC62dOK.js","./pk2C5RYg.js","./DyyB59KV.js","./BEaTEBLI.js","./BBwFZqyN.js","./wX_IZYNx.js","./SKPvM9nl.js","./Dc0P4aIE.js","./BFLErLYb.js","./DKpmsPfl.js","./BLyltQyJ.js","./CQas63dM.js","./pXWYIV6x.js","./_KzNjohN.js","./WCVSSNPR.js","./Cv5RNEM9.js","./CnOjiBQ4.js","./DPBCTJrm.js","./DHajyIwB.js","./D9gy186-.js","./Cgb6qxNH.js","./B_3Dpwt9.js","./CKwt2uXH.js","./BrScpkSj.js","./DyV-t9c4.js","./Cq_uRpfK.js","./DjYQ_S97.js","./Gs2F-WaC.js","./CqGmR_uN.js","./NpbZkYhY.js","./BwsikM5h.js","./BbmHmAoc.js","./CujHzHWW.js","./9eHUhQ3P.js","./Cxe4FlC8.js","./DZNpV-Fi.js","./xQkoQTBH.js","./B7DOPRQ6.js","./N86vRvDz.js","./Cj7KC756.js","./BSRsT1j9.js","./NzVRVRqD.js","./AYXxjNg8.js","./CFltr609.js","./Wa8cmqdu.js","./CojgTB6Q.js","./Bgl-fiX2.js","./ehcGqGxa.js","./CStUM1uE.js","./BbKDyuk8.js","./B92kdZ15.js","./Cii3SxBO.js","./DELXZ66D.js","./B5o_lm6j.js","./ET8FpOad.js","./BAOr8Xj9.js","./8hkYCngG.js","./BZlFB839.js","./UFzk0JzF.js","./BDqZTGJp.js","./DvAN1OYR.js","./Bo9YNstq.js","./Cak8Lj4v.js","./t7YI7jjt.js","./1jpX4O1e.js","./HVUYRykj.js","./C0VHaqbm.js","./CQJNv_Nf.js","./BQBvadb7.js","./DjcOUOcR.js","./DPfKLpB8.js","./BhDymatq.js","./BLRQmif8.js","./n6UOt7ty.js","./BB508QNf.js","./LQ8II5qk.js","./COK1gZQ_.js","./CKJW_hzu.js","./CIirV6xJ.js","./B8VY8sm6.js","./BjClzzth.js","./D7xFa75a.js","./C0bRxgYV.js","./Caulfaw_.js","./B4mRqufT.js","./B2FM5W1M.js","./DsHDw-MJ.js","./Do64kM6O.js","./CGNL2J5Z.js","./B0t42aOY.js","./B68-e1i2.js","./DZd6gJy7.js","./CkizjfpQ.js","./CMy4LKPw.js","./BNXDv57V.js","./V7VkGHts.js","./B7q0pfTH.js","./DVBYqTnk.js","./CrZ-CRp6.js","./DhykRZhl.js","./CGONrpgC.js","./BvOub3JO.js","./BeiFbaqB.js","./CIykmxdL.js","./Bve_o9CR.js","./CIK4fqRW.js","./bT-MzXSB.js","./DmTCRtwh.js","./CoKEmfr_.js","./SCpCGjGm.js","./E4MMgZee.js","./C9AedJs5.js","./9DHXOnVc.js","./DXnwvFFu.js","./D2pOvxEz.js","./C6O0098v.js","./C-ofTlKm.js","./DyJRGuTv.js","./C3Q9h1Ku.js","./B8bQhW-6.js","./DVZdrJBg.js","./DToRbzFw.js","./CHH1BaTn.js","./DnUthFrH.js","./x3lVDv0R.js","./CCluBH03.js","./DdLYVVED.js","./DOujPMkb.js","./B1N-tmtC.js","./DmHbg0Z1.js","./CLP4QvbA.js","./B5K9_F5J.js","./C6Di7ImA.js","./BOW0V25c.js","./D0VRMz_k.js","./SudRs-ni.js","./dpBs4h8s.js","./Bu7NDcrC.js","./Dh3ntRTM.js","./COvnNhxK.js","./CRKEELrl.js","./Dl6zhMD4.js","./BePQD5fN.js","./CSc9SsV7.js","./C45ab5Xw.js","./BYFE4roy.js","./EgqiBnp4.js","./hN_n3wnV.js"])))=>i.map(i=>d[i]);
import{r,m as h,a as _,b as x,f as To,h as ar,D as rr,I as lr,E as Po,c as Jn,o as hr,R as Qn,T as cr,U as ur,d as pr}from"./DvUDi2Se.js";import{b as z,L as It,d as Xn,G as dr,s as mr}from"./CnfuZz2S.js";import{i as k,s as T}from"./BYatcg2i.js";import{_ as M}from"./PPVm8Dsz.js";import{m as ne,r as Ai,a as gr}from"./DZNpV-Fi.js";import{V as I}from"./InWWYu7p.js";import{l as $o}from"./B8bQhW-6.js";import{M as qt,ap as ft,l as he,o as So,e as Lt,aq as fr,ar as yr,as as es,s as ze,at as _r,H as vr,L as xi,au as wr,t as ko,av as At,J as an,c as br,b as rn,m as ts,A as Mr,N as Gt,a as xr,u as le,p as Tr,S as Co,G as Pr,C as se,X,W as $r,q as Sr,I as is}from"./DSvukMJ1.js";import{l as w,h as G,w as ie,j as Cn,a as Ti,U as Rt,f as Je}from"./CJqWAG8q.js";import{m as kr}from"./B9TnOdWG.js";import{p as Cr,e as En}from"./DedWa6hQ.js";import{aa as Er,P as Eo,M as Ir,Q as Rr,b as Wt}from"./BDErjlP0.js";import{J as Vr,O as zt,k as In,L as Rn,K as Vn,U as Dr}from"./elf00Mmu.js";import{l as Or,j as Lr}from"./B68-e1i2.js";import{H as ns,M as Io,N as ss,I as Ar,P as zr,O as Pi,n as B,B as $i,j as Dn,A as Fr}from"./Cm1FCrMa.js";import{h as Si}from"./SKPvM9nl.js";import{d as On,g as at,b as os,e as Nr,s as Hr,_ as Zr}from"./Dg2Cy1wG.js";import{s as as}from"./B-KfLzZb.js";import{r as qr}from"./CJcipZJa.js";import{L as Gr}from"./Dtl6Huvk.js";import{n as Ro}from"./CLdLWz9D.js";import{o as Ft,e as Wr}from"./BtRNH9HO.js";import{p as rs}from"./Bstk8l7f.js";import{m as Vo,i as Ur,d as jr}from"./C3DztaFN.js";import{n as Br,c as Do,l as ls}from"./t7YI7jjt.js";import{s as ki,z as Qe,f as ci,N as Oo,Z as Lo,_ as L,c as Ao,d as zo,al as Ln,ar as Fo,r as Kr,aE as Yr,af as Jr,D as Qr,y as Xr}from"./Bs5I5-7o.js";import{m as Ci}from"./Cigsg82C.js";import{h as el,u as tl}from"./C2A-cDAk.js";import{p as il}from"./BYWLb-qP.js";import{c as F}from"./aQeO9QTD.js";import{s as nl}from"./BzGHCuFd.js";import{R as hs}from"./Cv9IkvcT.js";import{l as ge}from"./CdZ5E7Js.js";import{a as sl}from"./DHdURl-u.js";import{M as ol,r as ln,s as Ei,o as Ut}from"./D6KPPgz5.js";import{l as cs}from"./Chk7YAAL.js";import{n as zi}from"./BfvMWYA7.js";import{S as Pe,u as al,e as hn,v as us,y as rl,j as ll,q as ps,B as No,l as Ii,o as A,x as hl,r as Et,m as cl}from"./C4eyRFHZ.js";import{r as ul,n as D}from"./Cgb6qxNH.js";import{u as Ho,e as Fi}from"./DQOJ18NT.js";import{M as pl,c as An,f as Zo,s as Ri,i as Vt,h as dl,u as qo,n as ml,a as gl}from"./CMQCdq-P.js";import{P as zn,v as fl}from"./BZbOVUP0.js";import{l as yl}from"./Bx7Drccn.js";import{r as _l,o as vl,M as ds,h as wl,i as bl}from"./DKpmsPfl.js";import{r as ms}from"./CaVKkSa6.js";import{I as Ml,a as jt}from"./CKJW_hzu.js";import{n as Fn}from"./pZ2g7Ohf.js";import{g as xl}from"./_KzNjohN.js";import{t as Bt}from"./B1N-tmtC.js";import{i as Tl,a as gs,s as Pl,R as fs,h as $l}from"./DPw1_jRx.js";import{e as Sl}from"./_rUCDO1N.js";import{I as kl,K as Cl,V as Kt,a as ys}from"./CASyCajO.js";import{P as El,D as Ni,C as Il}from"./BiphejqT.js";import{a as Rl,S as Vl}from"./CRKBOk0z.js";import Dl from"./WcbF0m06.js";import{s as Ol}from"./NzVRVRqD.js";import{t as Ll}from"./BrScpkSj.js";import"./DTbuUgvd.js";import{i as Al}from"./Dqz3n4A5.js";import"./rxpTDz6e.js";import{e as fe}from"./D-YQ4CHs.js";const ti={widthBreakpoint:{getValue(t){const e=t.viewSize[0],i=t.breakpoints,n=this.values;return e<=i.xsmall?n.xsmall:e<=i.small?n.small:e<=i.medium?n.medium:e<=i.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],i=t.breakpoints,n=this.values;return e<=i.xsmall?n.xsmall:e<=i.small?n.small:e<=i.medium?n.medium:e<=i.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,i=e[0],n=e[1],s=this.values;return n>=i?s.portrait:s.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},Hi={xsmall:544,small:768,medium:992,large:1200};function zl(t){const e=t;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function Zi(t,e){return e?ti[t].valueToClassName[e].split(" "):[]}const Fl=t=>{let e=class extends t{constructor(...i){super(...i),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=Hi}initialize(){this.addHandles(w((()=>[this.breakpoints,this.size]),(()=>this._updateClassNames()),G))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(i){if(i!==this._get("breakpoints")){if(!zl(i)){const n=JSON.stringify(Hi,null,2);console.warn("provided breakpoints are not valid, using defaults:"+n),i=Hi}this._set("breakpoints",{...i})}}_updateClassNames(){if(!this.container)return;const i=qt.acquire(),n=qt.acquire();let s,o=!1;for(s in ti){const a=this[s],l=ti[s].getValue({viewSize:this.size,breakpoints:this.breakpoints});a!==l&&(o=!0,this[s]=l,Zi(s,a).forEach((c=>n.push(c))),Zi(s,l).forEach((c=>i.push(c))))}o&&(this._applyClassNameChanges(i,n),qt.release(i),qt.release(n))}_applyClassNameChanges(i,n){const s=this.container;s&&(n.forEach((o=>s.classList.remove(o))),i.forEach((o=>s.classList.add(o))))}_removeActiveClassNames(){const i=this.container;if(!i)return;let n;for(n in ti)Zi(n,this[n]).forEach((s=>i.classList.remove(s)))}};return r([h()],e.prototype,"breakpoints",null),r([h()],e.prototype,"orientation",void 0),r([h()],e.prototype,"widthBreakpoint",void 0),r([h()],e.prototype,"heightBreakpoint",void 0),e=r([_("esri.views.BreakpointsOwner")],e),e};let Ie=class extends x{constructor(){super(...arguments),this.items=new I,this._watchUpdatingTracking=new Si,this._callbacks=new Map,this._projector=ns(),this._hiddenProjector=ns()}get needsRender(){return this.items.length>0}get updating(){return this._watchUpdatingTracking?.updating??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange((()=>this.items),(i=>{for(const n of i.added){const s=()=>n.render();this._callbacks.set(n,s),this._projector.append(this.surface,s)}for(const n of i.removed){const s=this._projector.detach(this._callbacks.get(n));this.surface.removeChild(s.domNode),this._callbacks.delete(n)}}))}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach((e=>this._projector.detach(e))),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const i=this._hiddenSurface,n=this._hiddenProjector;let s;const o=()=>(s=e.render(),s);n.append(i,o),n.renderNow();const a={left:0,top:0,right:0,bottom:0};if(s?.domNode){const l=s.domNode.getBoundingClientRect();a.left=l.left,a.top=l.top,a.right=l.right,a.bottom=l.bottom}for(n.detach(o);i.firstChild;)i.removeChild(i.firstChild);return a}overlaps(e,i){const n=this.computeBoundingRect(e),s=this.computeBoundingRect(i);return Math.max(n.left,s.left)<=Math.min(n.right,s.right)&&Math.max(n.top,s.top)<=Math.min(n.bottom,s.bottom)}get hasVisibleItems(){return this.items.some((e=>e.visible))}async prepare(){await document.fonts.load(this._fontString()).catch((()=>{}))}renderCanvas(e,i){const n=!!i?.disableDecorations;if(!this.items.some((o=>o.visible&&!(n&&o.isDecoration))))return;const s=e.getContext("2d");s.save(),s.font=this._fontString(),this.items.forEach((o=>{n&&o.isDecoration||(s.save(),o.renderCanvas(s),s.restore())})),s.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};r([h({readOnly:!0})],Ie.prototype,"surface",void 0),r([h({readOnly:!0})],Ie.prototype,"items",void 0),r([h({readOnly:!0})],Ie.prototype,"needsRender",null),r([h({readOnly:!0})],Ie.prototype,"_watchUpdatingTracking",void 0),r([h({readOnly:!0})],Ie.prototype,"updating",null),Ie=r([_("esri.views.overlay.ViewOverlay")],Ie);const _s=Ie,qi=[0,0];function Nl(t){const e=(t.ownerDocument||window.document).defaultView,i=t.getBoundingClientRect();return qi[0]=i.left+(e?.pageXOffset??0),qi[1]=i.top+(e?.pageYOffset??0),qi}function vs(t){t&&(t.textContent="",t.parentNode&&t.parentNode.removeChild(t))}function Hl(t){const e=document.createElement("div");return t.appendChild(e),e}const tt=16,vt=750,Zl=512,ql=2,Gl=t=>{let e=class extends t{constructor(...i){super(...i),this._freqInfo={freq:tt,time:vt},this._overlayRenderTaskHandle=null,this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([w((()=>this.cursor),(n=>{const{surface:s}=this;s&&s.setAttribute("data-cursor",n)})),w((()=>this.navigating),(n=>{const{surface:s}=this;s&&s.setAttribute("data-navigating",n.toString())}))])}initialize(){this.addHandles([w((()=>this.ui),((i,n)=>this._handleUIChange(i,n)),G),this.on("focus",(()=>this.notifyChange("focused"))),this.on("blur",(()=>this.notifyChange("focused")))])}destroy(){this.destroyed||(this.ui?.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(i){const n=this._get("container"),s=Io(i);if(s||typeof i!="string"||k.getLogger(this).error("#container",`element with id '${i}' not found`),n===s)return;if(this._stopMeasuring(),n&&(n.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(vs(this.root),this._set("root",null)),this.userContent&&(ss(this.userContent,n),vs(this.userContent),this._set("userContent",null))),!s)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);s.classList.add("esri-view");const o=document.createElement("div");o.className="esri-view-user-storage",ss(s,o),s.appendChild(o),this._set("userContent",o);const a=document.createElement("div");a.className="esri-view-root",s.insertBefore(a,s.firstChild),this._set("root",a);const l=document.createElement("div");l.className="esri-view-surface",l.setAttribute("role","application"),l.tabIndex=0,a.appendChild(l),this._set("surface",l);const c=new _s;a.appendChild(c.surface),this._set("overlay",c),this.addHandles(w((()=>c.needsRender),(u=>{u&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=ft({render:()=>this.overlay?.render()}):this._overlayRenderTaskHandle=he(this._overlayRenderTaskHandle)}))),this.forceDOMReadyCycle(),this._set("container",s),this._startMeasuring()}get focused(){const i=document.activeElement===this.surface;return document.hasFocus()&&i}get size(){return[this.width,this.height]}set ui(i){const n=this._get("ui");n!==i&&n?.destroy(),this._set("ui",i)}blur(){this.surface?.blur()}focus(){this.surface?.focus()}pageToContainer(i,n,s){const o=this.position;return i-=o?o[0]:0,n-=o?o[1]:0,s?(s[0]=i,s[1]=n):s=[i,n],s}containerToPage(i,n,s){const o=this.position;return i+=o?o[0]:0,n+=o?o[1]:0,s?(s[0]=i,s[1]=n):s=[i,n],s}_handleUIChange(i,n){this.removeHandles("ui"),n&&n!==i&&n.destroy(),i&&(i.view=this,this.addHandles(w((()=>this.root),(s=>{i.container=s?Hl(s):null}),G),"ui")),this._set("ui",i)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const i=this._freqInfo;i.freq=tt,i.time=vt;const n=ft({prepare:a=>{const l=this._measure(),c=this._freqInfo;if(c.time+=a.deltaTime,l&&(c.freq=tt,this._get("resizing")||this._set("resizing",!0)),c.time<c.freq)return;c.time=0;const u=this._position();c.freq=u||l?tt:Math.min(vt,c.freq*ql),!l&&c.freq>=Zl&&(n.pause(),this._get("resizing")&&this._set("resizing",!1))}}),s=new ResizeObserver((a=>{i.freq=tt,i.time=vt,n.resume()}));this.container!=null&&s.observe(this.container);const o=Lt((()=>s.disconnect()));this.addHandles([So(window,"resize",(()=>{i.freq=tt,i.time=vt,n.resume()})),o,n],"measuring"),this._measure(),this._position()}_measure(){const i=this.container,n=i?i.clientWidth:0,s=i?i.clientHeight:0;if(n===0||s===0)return this.suspended||this._set("suspended",!0),!1;const o=this.width,a=this.height;return n===o&&s===a?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",n),this._set("height",s),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:o,oldHeight:a,width:n,height:s}),!0)}_position(){const i=this.container,n=this.position,s=i&&Nl(i);return!!s&&(!n||s[0]!==n[0]||s[1]!==n[1])&&(this._set("position",[s[0],s[1]]),!0)}forceDOMReadyCycle(){}};return r([h()],e.prototype,"container",null),r([h({readOnly:!0})],e.prototype,"focused",null),r([h({readOnly:!0})],e.prototype,"height",void 0),r([h()],e.prototype,"messagesCommon",void 0),r([h({type:_s})],e.prototype,"overlay",void 0),r([h({readOnly:!0})],e.prototype,"position",void 0),r([h({readOnly:!0})],e.prototype,"resizing",void 0),r([h({readOnly:!0})],e.prototype,"root",void 0),r([h({value:null,readOnly:!0})],e.prototype,"size",null),r([h({readOnly:!0})],e.prototype,"surface",void 0),r([h({readOnly:!0})],e.prototype,"suspended",void 0),r([h({nonNullable:!0})],e.prototype,"ui",null),r([h({readOnly:!0})],e.prototype,"userContent",void 0),r([h({readOnly:!0})],e.prototype,"width",void 0),r([h()],e.prototype,"widthBreakpoint",void 0),e=r([_("esri.views.DOMContainer")],e),e},Go=z("mac")?"Meta":"Control",Wl=new Set(["Alt","Control","Meta","Shift","Ctrl","Primary"]),Ul=t=>Wl.has(t);let jl=class{constructor(e,i=[]){this.eventType=e,this.keyModifiers=i}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const i=e.modifiers;for(const n of this.keyModifiers)if(!i.has(n))return!1;return!0}},O=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const i=this._incoming[e];for(const n of i)this._incomingEventMatches.push(n.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map((e=>e.eventType))),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager||(e.setEventCallback((i=>this._handleEvent(i))),e.setUninstallCallback((()=>this._onUninstall())),this._manager=e)}onUninstall(){}registerIncoming(e,i,n){let s;typeof i=="function"?(n=i,s=[]):s=i||[];const o=typeof e=="string"?new jl(e,s):e,a=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},l=p=>{const m=this._incoming[p.match.eventType];if(m){const d=m.indexOf(p);m.splice(d,1),a(),this._manager&&this._manager.updateDependencies()}},c=new Bl(o,n,{onPause:l,onRemove:l,onResume:p=>{const m=this._incoming[p.match.eventType];m&&!m.includes(p)&&(m.push(p),a(),this._manager&&this._manager.updateDependencies())}});let u=this._incoming[o.eventType];return u||(u=[],this._incoming[o.eventType]=u),u.push(c),a(),this._manager&&this._manager.updateDependencies(),c}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const i=new Kl(e,{onEmit:(n,s,o,a)=>{this._manager?.emit(n.eventType,s,o,a)},onRemove:n=>{delete this._outgoing[n.eventType],this._manager?.updateDependencies()}});return this._outgoing[e]=i,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),i}startCapturingPointer(e){this._manager?.setPointerCapture(e,!0)}stopCapturingPointer(e){this._manager?.setPointerCapture(e,!1)}refreshHasPendingInputs(){this._manager?.refreshHasPendingInputs()}_onUninstall(){this._manager&&(this.onUninstall(),this._manager=null)}_handleEvent(e){const i=this._incoming[e.type];if(i){for(const n of i)if(n.match.matches(e)&&(n.callback?.(e),e.shouldStopPropagation()))break}}},Bl=class{constructor(e,i,n){this.match=e,this._callback=i,this._handler=n}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},Kl=class{constructor(e,i){this.eventType=e,this._removed=!1,this._handler=i}emit(e,i,n){this._removed||this._handler.onEmit(this,e,i,n)}remove(){this._removed=!0,this._handler.onRemove(this)}},Yl=class extends O{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",(i=>this._update(i.data)))}_update(e){const i=e.native.pointerType==="touch"?"touch":"mouse",{x:n,y:s}=e;i===this._value&&this._x===n&&this._y===s||(this._value=i,this._x=n,this._y=s,this._onChange(i,n,s))}},Jl=class extends O{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=qr(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}},Ql=class{constructor(e,i){this._owner=i,this._properties={},this._afterDispatchHandle=null;for(const n in e){const s=e[n],o=new fr(s,void 0,void 0,2,2);this._properties[n]={pool:o,acquired:[]}}this._afterDispatchHandle=yr((()=>this._release()))}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const i=this._properties[e];for(const n of i.acquired)es(n)||i.pool.release(n);i.pool.destroy(),i.pool=null,i.acquired=null}this._properties=null,this._owner=null}get(e){const i=this._owner._get(e),n=this._properties[e];let s=n.pool.acquire();for(n.acquired.push(s);s===i;)n.acquired.push(s),s=n.pool.acquire();return s}_release(){for(const e in this._properties){const i=this._properties[e];let n=0;for(const s of i.acquired)es(s)?i.acquired[n++]=s:i.pool.release(s);i.acquired.length=n}}},ee=class extends x{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=Go,this._latestPointerType="mouse",this._propertiesPool=new Ql({latestPointerLocation:th},this),this.latestPointerLocation=null,this._paused=!1,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const i of e)this.uninstallHandlers(i);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some((e=>e.handler.hasPendingInputs))}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get updating(){return this.hasPendingInputs||this._paused}installHandlers(e,i,n=Se.INTERNAL){if(this._nameToGroup[e]||i.length===0)return;const s={name:e,handlers:i.map((o=>({handler:o,active:!0,removed:!1,priorityIndex:0,groupPriority:n,eventCallback:null,uninstallCallback:null})))};this._nameToGroup[e]=s;for(let o=s.handlers.length-1;o>=0;o--){const a=s.handlers[o];this._handlers.push(a),a.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(l,c,u,p,m)=>{this._emitInputEvent(a.priorityIndex+1,l,c,u,m,p)},setPointerCapture:(l,c)=>{this._setPointerCapture(s,a,l,c)},setEventCallback:l=>{a.eventCallback=l},setUninstallCallback:l=>{a.uninstallCallback=l},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const i=this._nameToGroup[e];i?(i.handlers.forEach((n=>{n.removed=!0,n.uninstallCallback?.()})),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):k.getLogger(this).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}isModifierKeyDown(e){return this._activeKeyModifiers.has(e)}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,i=new Set;this._handlersPriority=[];for(let n=this._handlers.length-1;n>=0;n--){const s=this._handlers[n];s.priorityIndex=n,this._handlersPriority.push(s)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let n=this._handlersPriority.length-1;n>=0;n--){const s=this._handlersPriority[n];s.priorityIndex=n;let o=s.handler.hasSideEffects;if(!o){for(const a of s.handler.outgoingEventTypes)if(e.has(a)){o=!0;break}}if(o)for(const a of s.handler.incomingEventMatches){e.add(a.eventType);for(const l of a.keyModifiers)Ul(l)||i.add(l)}s.active=o}this._sourceEvents=e,this._keyModifiers=i,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,i,n){this._latestPointerType=e;const s=this._get("latestPointerLocation");if(s==null||s.x!==i||s.y!==n){const o=this._propertiesPool.get("latestPointerLocation");o.x=i,o.y=n,this._set("latestPointerLocation",o)}}_onEventReceived(e,i){if(e==="pointer-capture-lost"){const o=i;this._pointerCaptures.delete(o.native.pointerId)}this._updateKeyModifiers(e,i);const n=this.test.timestamp!=null?this.test.timestamp:i.native?i.native.timestamp:void 0,s=i.native?i.native.cancelable:void 0;this._emitInputEventFromSource(e,i,n,s)}_updateKeyModifiers(e,i){if(!i)return;let n=!1;const s=()=>{n||(this._activeKeyModifiers=new Set(this._activeKeyModifiers),n=!0)},o=(l,c)=>{c&&!this._activeKeyModifiers.has(l)?(s(),this._activeKeyModifiers.add(l)):!c&&this._activeKeyModifiers.has(l)&&(s(),this._activeKeyModifiers.delete(l))};if(e==="key-down"||e==="key-up"){const l=i.key;this._keyModifiers.has(l)&&o(l,e==="key-down")}const a=i.native;o("Alt",!!a?.altKey),o("Control",!!a?.ctrlKey),o("Ctrl",!!a?.ctrlKey),o("Shift",!!a?.shiftKey),o("Meta",!!a?.metaKey),o("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new Yl(((e,i,n)=>this._setLatestPointer(e,i,n))),this._multiTouchHandler=new Jl,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],Se.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,Se.INTERNAL)}_setPointerCapture(e,i,n,s){const o=e.name+"-"+i.priorityIndex,a=this._pointerCaptures.get(n.pointerId)||new Set;this._pointerCaptures.set(n.pointerId,a),s?(a.add(o),a.size===1&&this.eventSource&&this.eventSource.setPointerCapture(n,!0)):a.has(o)&&(a.delete(o),a.size===0&&(this._pointerCaptures.delete(n.pointerId),this.eventSource&&this.eventSource.setPointerCapture(n,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter((e=>!e.removed)),this.updateDependencies()}_emitInputEventFromSource(e,i,n,s){this._emitInputEvent(0,e,i,n,s)}_emitInputEvent(e,i,n,s,o,a){const l=s!==void 0?s:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),c=o!==void 0&&o,u={event:new Xl(i,n,l,a||this._activeKeyModifiers,c),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(u):this._doNewPropagation(u)}_doNewPropagation(e){this._currentPropagation={events:new as,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){this._paused=!1;const e=this._currentPropagation;if(e){for(;e.events.length>0;){const{event:i,priorityIndex:n}=e.events.pop(),s=i.data?.eventId;if(!(s!=null&&this._stoppedPropagationEventIds.has(s)))for(e.currentHandler=this._handlersPriority[n];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!i.shouldStopPropagation()&&e.currentHandler.eventCallback?.(i),i.shouldStopPropagation()){s!=null&&this._stoppedPropagationEventIds.add(s);break}if(i.shouldPausePropagation((()=>this._continuePropagation())))return void this._pausePropagation({event:i,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(e){const i=new as;i.push(e);const n=this._currentPropagation;if(n){for(;n.events.length;)i.push(n.events.pop());n.events=i,n.currentHandler=null,this._paused=!0}}_compareHandlerPriority(e,i){if(e.handler.hasSideEffects!==i.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==i.groupPriority)return e.groupPriority>i.groupPriority?-1:1;for(const n of e.handler.incomingEventMatches)for(const s of i.handler.incomingEventMatches){if(n.eventType!==s.eventType)continue;const o=n.keyModifiers.filter((a=>s.keyModifiers.includes(a)));if(o.length===n.keyModifiers.length!=(o.length===s.keyModifiers.length))return n.keyModifiers.length>s.keyModifiers.length?-1:1}return e.priorityIndex>i.priorityIndex?-1:1}_sortHandlersPriority(e){const i=[];for(const n of e){let s=0;for(;s<i.length&&this._compareHandlerPriority(n,i[s])>=0;)s++;i.splice(s,0,n)}return i}get debug(){const e=i=>{const n=this._setPointerCapture;this._setPointerCapture=()=>{},i(),this._setPointerCapture=n};return{injectEvent:(i,n)=>{e((()=>this._onEventReceived(i,n)))},disablePointerCapture:e}}};r([h({readOnly:!0})],ee.prototype,"hasPendingInputs",null),r([h({constructOnly:!0})],ee.prototype,"eventSource",void 0),r([h({constructOnly:!0})],ee.prototype,"recognizers",void 0),r([h()],ee.prototype,"_latestPointerType",void 0),r([h()],ee.prototype,"latestPointerType",null),r([h()],ee.prototype,"multiTouchActive",null),r([h({readOnly:!0})],ee.prototype,"latestPointerLocation",void 0),r([h()],ee.prototype,"_paused",void 0),r([h({readOnly:!0})],ee.prototype,"updating",null),ee=r([_("esri.views.input.InputManager")],ee);let Xl=class{constructor(e,i,n,s,o){this.type=e,this.data=i,this.timestamp=n,this.modifiers=s,this.cancelable=o,this._propagationState=Ae.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=Ae.STOPPED}shouldStopPropagation(){return(this._propagationState&Ae.STOPPED)!==0}defer(e){this._propagationState|=Ae.PAUSED;const i=(n,s)=>{this._propagationState&=~Ae.PAUSED;const o=this._resumeCallback;if(this._resumeCallback=null,o&&o(),s)throw n;return n};return(typeof e=="function"?e():e).then((n=>i(n,!1)),(n=>i(n,!0)))}shouldPausePropagation(e){return!!(this._propagationState&Ae.PAUSED)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};var Ae;(function(t){t[t.NONE=0]="NONE",t[t.STOPPED=1]="STOPPED",t[t.PAUSED=2]="PAUSED"})(Ae||(Ae={}));const Se={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let eh=class{};const th=eh;function Ce(t){return t!=null&&"open"in t&&"declaredClass"in t}function ws(t){return t!=null&&"declaredClass"in t&&"dockOptions"in t}const ih=t=>{let e=class extends t{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([w((()=>[this.ui,this.popup]),(([i,n],s)=>{const o="popup",a="manual";if(s){const[l,c]=s;l&&Ce(c)&&(c.view=null,ws(c)&&(l.remove(c,o),c!==n&&n&&c.destroy()))}i&&Ce(n)&&(n.view=this,ws(n)&&i.add(n,{key:o,position:a,internal:!0}))}),ie),this.on("click",(i=>{this.popup&&this.popupEnabled&&(i.pointerType!=="mouse"||i.button===0)&&(Ce(this.popup)?this.popup.viewModel.handleViewClick(i):i.defer((async()=>{await this.setupPopup(),Ce(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(i)})))}),Se.WIDGET)]),Cn((()=>this.ready&&this.popupEnabled&&!this.updating)).then((()=>{M(()=>import("./D5f-lHjI.js").then(i=>i.P),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174]),import.meta.url)}))}destroy(){this.destroyed||this.closePopup()}async openPopup(i){if(Ce(this.popup))return this.popup.open(i);try{if(await this.setupPopup(),!this.popup)return void k.getLogger(this).error(new T("view:null-popup","Popup is null and can't be opened"));this.popup.open(i)}catch{}}closePopup(){this._popupSetupTask?.abort(),Ce(this.popup)&&this.popup.close()}async fetchPopupFeatures(i,n){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(i,n),n)}async setupPopup(){if(this._popupSetupTask?.abort(),this.popup&&!Ce(this.popup))return this._popupSetupTask=On((async i=>{const{default:n}=await M(()=>import("./D5f-lHjI.js").then(o=>o.P),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174]),import.meta.url);if(ze(i),!this.popup||Ce(this.popup))return;const s=this.popup;delete s.open,delete s.close,this.popup=new n(s)})),this._popupSetupTask.promise}async _popupHitsToFeatures({location:i,hits:n},s){const o=[],a=[];let l=!1;const c=_r(s,z("popup-view-fetch-timeout")??sh),u=d=>{const g=new nh(d);return a.push(g),o.push(g.promise),g},p=d=>{const g=a.at(-1);return g&&g.layerView===d&&!l?g:u(d)};for(const d of n)"graphic"in d?(p(d.layerView).graphics.push(d.graphic),l=!1):(o.push(d.layerView.fetchPopupFeaturesAtLocation(d.mapPoint,c)),l=!0);a.map((d=>d.resolve(c)));const m=vr(o).then((d=>d.filter((g=>!!g)).flat()));return{pendingFeatures:o,allGraphicsPromise:m,location:i}}async _getPopupHits(i,n){const{hits:s,location:o}=await this.popupHitTest(i);ze(n);const a=[];for(const l of s)if("graphic"in l){if(this._isValidPopupGraphic(l.graphic,n)){const c=this._isValidPopupGraphicsLayerView(l.layerView)?l.layerView:void 0;a.push({graphic:l.graphic,layerView:c})}}else this._isValidPopupLocationLayerView(l.layerView)&&a.push({mapPoint:l.mapPoint,layerView:l.layerView});return{hits:a,location:o}}_isValidPopupGraphic(i,n){return i&&!!i.getEffectivePopupTemplate(n?.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(i){return!i||(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesFromGraphics"in i}_isValidPopupLocationLayerView(i){return(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesAtLocation"in i}};return r([h()],e.prototype,"popup",void 0),r([h()],e.prototype,"popupEnabled",void 0),e=r([_("esri.views.PopupView")],e),e};let nh=class{constructor(e){this.layerView=e,this._resolver=xi(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(e){const{layerView:i,graphics:n,_resolver:s}=this;if(!i)return s.resolve(n),s.promise;let o;return i.fetchPopupFeaturesFromGraphics(n,e).catch((a=>(o=a,null))).then((a=>{a?s.resolve(a):s.reject(o)})),s.promise}};const sh=5e3;let ui=class extends Br{constructor(e){super(e),this.addHandles(this.on("before-add",(i=>{i.item!=null&&i.item.parent===this.owner&&(k.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),i.preventDefault())})))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};ui=r([_("esri.support.AnalysesCollection")],ui);let Re=class extends x{constructor(e){super(e),this.view=null,this.baseLayerViews=new I,this.referenceLayerViews=new I,this._loadingHandle=w((()=>this.view?.map?.basemap),(i=>{i&&i.load().catch((()=>{}))}),G)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(const e of this.baseLayerViews)e.destroy();this.baseLayerViews.length=0;for(const e of this.referenceLayerViews)e.destroy();this.referenceLayerViews.length=0}get suspended(){return this.view?.suspended??!0}get updating(){return this.view?.suspended?!1:!!this.view?.map?.basemap?.loaded&&(this.baseLayerViews.some((i=>i.updating))||this.referenceLayerViews.some((i=>i.updating)))}};r([h({constructOnly:!0})],Re.prototype,"view",void 0),r([h({readOnly:!0})],Re.prototype,"baseLayerViews",void 0),r([h({readOnly:!0})],Re.prototype,"referenceLayerViews",void 0),r([h({readOnly:!0})],Re.prototype,"suspended",null),r([h({type:Boolean,readOnly:!0})],Re.prototype,"updating",null),Re=r([_("esri.views.BasemapView")],Re);const oh=Re;let Y=class extends x{constructor(e){super(e),this.factor=1.5,this.offset=F(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};r([h({type:Number})],Y.prototype,"factor",void 0),r([h({nonNullable:!0})],Y.prototype,"offset",void 0),r([h()],Y.prototype,"position",void 0),r([h({type:Number,range:{min:0}})],Y.prototype,"size",void 0),r([h()],Y.prototype,"maskUrl",void 0),r([h()],Y.prototype,"maskEnabled",void 0),r([h()],Y.prototype,"overlayUrl",void 0),r([h()],Y.prototype,"overlayEnabled",void 0),r([h({readOnly:!0})],Y.prototype,"version",null),r([h({type:Boolean})],Y.prototype,"visible",void 0),Y=r([_("esri.views.Magnifier")],Y);const Wo=Y;function Ee(t){return!(t==null||typeof t!="object"||!("createQuery"in t)||!t.createQuery)}let te=class extends Ft.EventedAccessor{constructor(e){super(e),this._selectionMap=new nl,this._sources=new I,this._trashCan=[],this._layerEditHandles=new I,this._vizTaskId=0,this.view=null,this.showHighlight=!0,this.highlightName="default"}initialize(){this.addHandles([w((()=>[this.view,this.showHighlight]),(()=>this._refreshVisualization())),w((()=>this.view),(e=>{e?.when().then((()=>this.syncSources()))}),G),Ti((()=>this.sources),"change",(e=>{const i=this._selectionMap,n=[];for(const s of e.removed){const o=i.get(s);o&&(i.delete(s),o.highlightHandle?.remove(),n.push({layer:s,selection:[],added:[],removed:[...o.selection]}))}this._refreshListeners(),n.length&&this._onSelectionChange(n)}),{onListenerAdd:()=>this._refreshListeners()})])}destroy(){this.clear(),this._layerEditHandles.drain(he)}get selections(){return Array.from(this._selectionMap.entries()).map((e=>{const[i,n]=e;return{layer:i,selection:[...n.selection]}}))}get count(){let e=0;for(const i of this._selectionMap.values())e+=i.selection.length;return e}get hasSelection(){return this.count>0}get sources(){return this._sources}set sources(e){Ro(e,this._sources)}syncSources(){const e=new Set,i=this.view?.map;if(!i)return;const n=s=>{Nr(s)?(s.layers?.forEach(n),s.tables?.forEach(n)):Hr(s)?(s.sublayers?.forEach(n),s.subtables?.forEach(n)):os(s)?s.sublayers?.forEach(n):Ee(s)&&e.add(s)};i.allLayers.forEach(n),i.allTables.forEach(n),this.sources=[...e]}async getSelectedFeatures(e,i={},n="layerView"){const{view:s,selections:o}=this;if(!s&&n==="layerView")return k.getLogger(this).warn("Cannot query layer views without a view."),[];const a=(e?.length?o.filter((l=>e.includes(l.layer))):o).map((async l=>{const{layer:c,selection:u}=l;if(!u.length)return;const p=at(c)?c.parent:c;if(p!=null){if(s&&n==="layerView"&&!bs(p)&&Ms(p)){const m=await s.whenLayerView(p).catch((()=>null));if(m)return xs(m,u,i)}return xs(p,u,i)}})).filter(It);return(await Promise.all(a)).filter(It)}updateSelection(e){const i=new Map;for(const[o,a]of this._selectionMap)i.set(o,[...a.selection]);let n=!1;const s=e.current.concat(e.added);for(const o of s){const a=o.sourceLayer,l=o.getObjectId();if(this.sources.includes(a)&&(Ee(a)||at(a))&&l!==null){const c=To(i,a,(()=>[]));c.includes(l)||(c.push(l),n=!0)}}for(const o of e.removed){const a=o.sourceLayer,l=o.getObjectId();if(this.sources.includes(a)&&(Ee(a)||at(a))&&l!==null){const c=i.get(a),u=c?.indexOf(l);u!==void 0&&u>=0&&(c?.splice(u,1),n=!0)}}if(n){const{_selectionMap:o,_trashCan:a}=this,l=[];for(const[c,u]of i){const p=o.get(c);p!==void 0&&a.push(p),o.set(c,{selection:u}),l.push({layer:c,selection:u,...Xn(p!==void 0?p.selection:[],u)})}this._onSelectionChange(l)}}setSelection(e,i){this._setSelection(e,i)}getSelection(e){return this._selectionMap.get(e)?.selection}appendToSelection(e,i){const n=this._selectionMap.get(e),s=n!==void 0?[...n.selection]:[];for(const o of i)s.includes(o)||s.push(o);this._setSelection(e,s)}removeFromSelection(e,i){const n=this._selectionMap.get(e);if(!n)return;const s=[];for(const o of n.selection)i.includes(o)||s.push(o);this._setSelection(e,s)}toggleInSelection(e,i){const n=this._selectionMap.get(e);if(!n||n.selection.length===0)return void this._setSelection(e,i);const s=new Set(n.selection),o=new Set(i),a=wr(s,o);this._setSelection(e,Array.from(a))}clear(){const e=this._selectionMap.values();this._trashCan.push(...e);const i=[];for(const[n,s]of this._selectionMap.entries())i.push({layer:n,added:[],removed:[...s.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(i)}_onSelectionChange(e){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:e})}_refreshVisualization(){for(this._vizTaskId++;this._trashCan.length>0;)this._trashCan.pop()?.highlightHandle?.remove();if(this.view==null)return;const{sources:e,view:i,_selectionMap:n,showHighlight:s}=this,o=this._vizTaskId;for(const a of e){const l=n.get(a),c=at(a)?a.parent:a;if(c!=null&&Ms(c)){if(bs(c))continue;i.whenLayerView(c).then((u=>{l?.highlightHandle?.remove(),l!=null&&s&&o===this._vizTaskId&&"highlight"in u&&typeof u.highlight=="function"&&l.selection.length>0&&(l.highlightHandle=u.highlight(l.selection,this.highlightName))})).catch((()=>{l?.highlightHandle?.remove()}))}}}_refreshListeners(){this._layerEditHandles.drain(he);const e=new Set(this.sources.map((i=>at(i)?i.parent:i)));for(const i of e)Ee(i)&&"on"in i&&i.on&&this._layerEditHandles.push(i.on("edits",(n=>this._onLayerEdit(n,i))))}_onLayerEdit(e,i){if(os(i))this._onParentLayerEdit(e,i);else if(e.deletedFeatures.length&&this._selectionMap.has(i)){const n=[];e.deletedFeatures.forEach((({error:s,objectId:o})=>{o!=null&&s==null&&n.push(o)})),this.removeFromSelection(i,n)}}_onParentLayerEdit(e,i){const{deletedFeatures:n,edits:s,updatedFeatures:o}=e;if(s?.updateFeatures?.forEach((a=>{const l=a.getObjectId()??a.attributes[i.objectIdField];if(l==null||o.find((p=>p.objectId===l))?.error)return;const c=i.findSublayerForFeature(a);if(!Ee(c))return;const u=i.sublayers.find((p=>!(!Ee(p)||!this.getSelection(p)?.includes(l))));Ee(u)&&u!==c&&(this.removeFromSelection(u,[l]),this.appendToSelection(c,[l]))})),n.length){const a=[];n.forEach((({error:l,objectId:c})=>{c!=null&&l==null&&a.push(c)})),i.sublayers.forEach((l=>{Ee(l)&&this._selectionMap.has(l)&&this.removeFromSelection(l,a)}))}}_setSelection(e,i){if(!this.sources.includes(e))throw new Error(`Cannot set selection on layer ${e.title} because it is not in 'sources'`);const n=this._selectionMap.get(e);if(n===void 0||!rh(n,{selection:i})){n!==void 0&&this._trashCan.push(n),this._selectionMap.set(e,{selection:[...i]});const s={layer:e,selection:[...i],...Xn(n!==void 0?n.selection:[],i)};this._onSelectionChange([s])}}};r([h()],te.prototype,"_selectionMap",void 0),r([h()],te.prototype,"_sources",void 0),r([h({readOnly:!0,nonNullable:!0})],te.prototype,"selections",null),r([h({readOnly:!0,nonNullable:!0})],te.prototype,"count",null),r([h()],te.prototype,"view",void 0),r([h({readOnly:!0,nonNullable:!0})],te.prototype,"hasSelection",null),r([h()],te.prototype,"showHighlight",void 0),r([h()],te.prototype,"sources",null),r([h()],te.prototype,"highlightName",void 0),te=r([_("esri.views.SelectionManager")],te);const bs=t=>at(t)?t.parent?.isTable===!0:t.isTable,ah=t=>t.layer!==void 0,Ms=t=>t?.when!==void 0,rh=(t,e)=>{if(t==null&&e==null)return!0;if(t!=null&&e==null||t==null&&e!=null)return!1;if(t!=null&&e!=null&&t.selection!=null&&e.selection!=null){const i=[...t.selection],n=[...e.selection];if(i.length!==n.length)return!1;i.sort(),n.sort();for(let s=0;s<i.length;s++)if(i[s]!==n[s])return!1}return!0},xs=async(t,e,i={})=>{let n;if(ah(t)){const s=t;n=s===void 0?null:await s.queryFeatures(new hs({...i,objectIds:e})).then((o=>({data:o,layer:t.layer})))}else{const s=t;n=s===void 0?null:await s.queryFeatures(new hs({...i,objectIds:e})).then((o=>({data:o,layer:s})))}return n},lh=te;let Tt=class extends sl.ClonableMixin(x){constructor(e){super(e),this.accentColor=new ge([255,127,0]),this.textColor=new ge([255,255,255])}};r([h({type:ge,nonNullable:!0})],Tt.prototype,"accentColor",void 0),r([h({type:ge,nonNullable:!0})],Tt.prototype,"textColor",void 0),Tt=r([_("esri.views.Theme")],Tt);const cn=Tt;var Ts;(function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right"})(Ts||(Ts={}));const Uo=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],jo={};function Bo(t){return!!jo[t]}function hh(t){for(const e of t)if(!Bo(e))return!1;return!0}Uo.forEach((t=>{jo[t]=!0}));let Ko=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach((({handler:i,priority:n},s)=>this.inputManager?.installHandlers(s,[i],n)))}disconnect(){this.inputManager&&this._handlers.forEach(((e,i)=>this.inputManager?.uninstallHandlers(i))),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,i,n,s){const o=Array.isArray(e)?e:e.split(",");if(!hh(o))return o.some(Bo)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let a,l;Array.isArray(i)?l=i:(a=i,l=[]),typeof n=="function"?a=n:s=n,s=s??Se.DEFAULT;const c=this._createUniqueGroupName(),u=new ch(this.view,o,l,a);this._handlers.set(c,{handler:u,priority:s});for(const p of o){const m=this._handlerCounts.get(p)||0;this._handlerCounts.set(p,m+1)}return this.inputManager&&this.inputManager.installHandlers(c,[u],s),Lt((()=>this._removeHandler(c,o)))}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,i){if(this._handlers.has(e)){this._handlers.delete(e);for(const n of i){const s=this._handlerCounts.get(n);s===void 0||(s===1?this._handlerCounts.delete(n):this._handlerCounts.set(n,s-1))}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},ch=class extends O{constructor(e,i,n,s){super(!0),this._latestDragStart=void 0,this.view=e;for(const o of i)switch(o){case"click":this.registerIncoming("click",n,(a=>s(dh(e,a))));break;case"double-click":this.registerIncoming("double-click",n,(a=>s(mh(e,a))));break;case"immediate-click":this.registerIncoming("immediate-click",n,(a=>s(gh(e,a))));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",n,(a=>s(fh(e,a))));break;case"hold":this.registerIncoming("hold",n,(a=>s(yh(e,a))));break;case"drag":this.registerIncoming("drag",n,(a=>{const l=this._wrapDrag(a);l&&s(l)}));break;case"key-down":this.registerIncoming("key-down",n,(a=>s(_h(a))));break;case"key-up":this.registerIncoming("key-up",n,(a=>s(vh(a))));break;case"pointer-down":this.registerIncoming("pointer-down",n,(a=>s(wt(a,"pointer-down"))));break;case"pointer-move":this.registerIncoming("pointer-move",n,(a=>s(wt(a,"pointer-move"))));break;case"pointer-up":this.registerIncoming("pointer-up",n,(a=>s(wt(a,"pointer-up"))));break;case"pointer-drag":this.registerIncoming("pointer-drag",n,(a=>s(wh(a))));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",n,(a=>s(bh(a))));break;case"pointer-enter":this.registerIncoming("pointer-enter",n,(a=>s(wt(a,"pointer-enter"))));break;case"pointer-leave":this.registerIncoming("pointer-leave",n,(a=>s(wt(a,"pointer-leave"))));break;case"gamepad":this.registerIncoming("gamepad",n,(a=>{s(Mh(a))}));break;case"focus":this.registerIncoming("focus",n,(a=>{s(uh(a))}));break;case"blur":this.registerIncoming("blur",n,(a=>{s(ph(a))}))}}_wrapDrag(e){const i=e.data,{x:n,y:s}=i.center,{action:o,pointerType:a,button:l}=i;if(o==="start"&&(this._latestDragStart=i),!this._latestDragStart)return;const c=i.pointer.native,u=i.buttons,{cancelable:p,timestamp:m}=e,d={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return o==="end"&&(this._latestDragStart=void 0),{type:"drag",action:o,x:n,y:s,origin:d,pointerType:a,button:l,buttons:u,radius:i.radius,angle:ol(i.angle),native:c,timestamp:m,cancelable:p,stopPropagation:()=>e.stopPropagation(),defer:g=>e.defer(g),preventDefault:()=>e.preventDefault()}}};function uh(t){return{type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),defer:e=>t.defer(e),preventDefault:()=>t.preventDefault()}}function ph(t){return{type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),defer:e=>t.defer(e),preventDefault:()=>t.preventDefault()}}function dh(t,e){const{pointerType:i,button:n,buttons:s,x:o,y:a,native:l,eventId:c}=e.data,{cancelable:u,timestamp:p}=e;return{type:"click",pointerType:i,button:n,buttons:s,x:o,y:a,native:l,timestamp:p,screenPoint:F(o,a),mapPoint:Nt(t,o,a),eventId:c,cancelable:u,stopPropagation:()=>e.stopPropagation(),defer:m=>e.defer(m),preventDefault:()=>e.preventDefault()}}function mh(t,e){const{pointerType:i,button:n,buttons:s,x:o,y:a,native:l,eventId:c}=e.data,{cancelable:u,timestamp:p}=e;return{type:"double-click",pointerType:i,button:n,buttons:s,x:o,y:a,native:l,timestamp:p,mapPoint:Nt(t,o,a),eventId:c,cancelable:u,stopPropagation:()=>e.stopPropagation(),defer:m=>e.defer(m),preventDefault:()=>e.preventDefault()}}function gh(t,e){const{pointerType:i,button:n,buttons:s,x:o,y:a,native:l,eventId:c}=e.data,u=l.pointerId,{cancelable:p,timestamp:m}=e;return{type:"immediate-click",pointerId:u,pointerType:i,button:n,buttons:s,x:o,y:a,native:l,timestamp:m,mapPoint:Nt(t,o,a),eventId:c,cancelable:p,stopPropagation:()=>e.stopPropagation(),defer:d=>e.defer(d),preventDefault:()=>e.preventDefault()}}function fh(t,e){const{pointerType:i,button:n,buttons:s,x:o,y:a,native:l,eventId:c}=e.data,u=l.pointerId,{cancelable:p,timestamp:m}=e;return{type:"immediate-double-click",pointerId:u,pointerType:i,button:n,buttons:s,x:o,y:a,native:l,timestamp:m,mapPoint:Nt(t,o,a),eventId:c,cancelable:p,stopPropagation:()=>e.stopPropagation(),defer:d=>e.defer(d),preventDefault:()=>e.preventDefault()}}function yh(t,e){const{pointerType:i,button:n,buttons:s,x:o,y:a,native:l}=e.data,{cancelable:c,timestamp:u}=e;return{type:"hold",pointerType:i,button:n,buttons:s,x:o,y:a,native:l,timestamp:u,mapPoint:Nt(t,o,a),cancelable:c,stopPropagation:()=>e.stopPropagation(),defer:p=>e.defer(p),preventDefault:()=>e.preventDefault()}}function Nt(t,e,i){return t.toMap(F(e,i),{exclude:[]})}function _h(t){const{key:e,repeat:i,native:n}=t.data,{cancelable:s,timestamp:o}=t;return{type:"key-down",key:e,repeat:i,native:n,timestamp:o,cancelable:s,stopPropagation:()=>t.stopPropagation(),defer:a=>t.defer(a),preventDefault:()=>t.preventDefault()}}function vh(t){const{key:e,native:i}=t.data,{cancelable:n,timestamp:s}=t;return{type:"key-up",key:e,native:i,timestamp:s,cancelable:n,stopPropagation:()=>t.stopPropagation(),defer:o=>t.defer(o),preventDefault:()=>t.preventDefault()}}function wt(t,e){const{x:i,y:n,button:s,buttons:o,native:a,eventId:l}=t.data,c=a.pointerId,u=a.pointerType,{cancelable:p,timestamp:m}=t;return{type:e,x:i,y:n,pointerId:c,pointerType:u,button:s,buttons:o,native:a,timestamp:m,eventId:l,cancelable:p,stopPropagation:()=>t.stopPropagation(),defer:d=>t.defer(d),preventDefault:()=>t.preventDefault()}}function wh(t){const{x:e,y:i,buttons:n,native:s,eventId:o}=t.data.currentEvent,{button:a}=t.data.startEvent,l=t.data.startEvent.native.pointerId,c=t.data.startEvent.native.pointerType,u=t.data.action,p={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:m,timestamp:d}=t;return{type:"pointer-drag",x:e,y:i,pointerId:l,pointerType:c,button:a,buttons:n,action:u,origin:p,native:s,timestamp:d,eventId:o,cancelable:m,stopPropagation:()=>t.stopPropagation(),defer:g=>t.defer(g),preventDefault:()=>t.preventDefault()}}function bh(t){const{cancelable:e,data:i,timestamp:n}=t,{x:s,y:o,deltaY:a,native:l}=i;return{type:"mouse-wheel",x:s,y:o,deltaY:a,native:l,timestamp:n,cancelable:e,stopPropagation:()=>t.stopPropagation(),defer:c=>t.defer(c),preventDefault:()=>t.preventDefault()}}function Mh(t){const{action:e,state:i,device:n}=t.data,{cancelable:s,timestamp:o}=t,{buttons:a,axes:l}=i;return{type:"gamepad",device:n,timestamp:o,action:e,buttons:a,axes:l,cancelable:s,stopPropagation:()=>t.stopPropagation(),defer:c=>t.defer(c),preventDefault:()=>t.preventDefault()}}var Dt,Ps,$s;(function(t){t[t.USER=0]="USER",t[t.MANAGER=1]="MANAGER"})(Dt||(Dt={})),(function(t){t[t.None=0]="None",t[t.Unfocused=1]="Unfocused",t[t.Focused=2]="Focused",t[t.Unselected=4]="Unselected",t[t.Selected=8]="Selected",t[t.All=15]="All"})(Ps||(Ps={})),(function(t){t[t.None=0]="None",t[t.Custom1=16]="Custom1",t[t.Custom2=32]="Custom2",t[t.Custom3=64]="Custom3",t[t.Custom4=128]="Custom4",t[t.Custom5=256]="Custom5",t[t.Custom6=512]="Custom6",t[t.Custom7=1024]="Custom7",t[t.Custom8=2048]="Custom8",t[t.Custom9=4096]="Custom9",t[t.Custom10=8192]="Custom10",t[t.Custom11=16384]="Custom11",t[t.Custom12=32768]="Custom12",t[t.All=65520]="All"})($s||($s={}));const xh="z",Th="r",Yo={cancel:"Escape",complete:"Enter"},Rm={...Yo,redo:Th,undo:xh,center:"Alt",constraint:"Shift",delete:["Backspace","Delete"],vertexAdd:"f",pan:" "},Vm={toggle:"Control"},Dm={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},Om={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:Go,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0}};let Lm=class{constructor(){this._bindings=new Map}add(e,i){return this.addToggle(e,(n=>{n.type==="key-down"&&i(n)}))}addToggle(e,i){const n=Ph.fromDefinition(e,i),s=To(this._bindings,n.key,(()=>[]));return s.push(n),Lt((()=>dr(s,n)))}register(e,i=Se.WIDGET){return ko([e.on("key-down",(n=>this.dispatch(e.inputManager,n)),i),e.on("key-up",(n=>this.dispatch(e.inputManager,n)),i)])}dispatch(e,i){const n=i.key,s=this._bindings.get(n);if(s)for(const o of s)o.process(e,i)}},Ph=class un{constructor(e,i,n,s,o){this.key=e,this.modifiers=i,this.repeats=n,this.continuePropagation=s,this.callback=o}process(e,i){if(!(i.key!==this.key||"repeat"in i&&i.repeat&&!this.repeats)){for(const n of this.modifiers)if(!e.isModifierKeyDown(n))return;this.continuePropagation||i.stopPropagation(),this.callback(i)}}static fromDefinition(e,i){if(typeof e=="string")return new un(e,[],!1,!1,i);const{key:n,modifier:s,repeats:o,continuePropagation:a}=e;return new un(n,s?Array.isArray(s)?s:[s]:[],!!o,!!a,i)}};function $h(t){return[t.on("before-add",(e=>{const i=e.item;if(i==null||t.includes(i))return k.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();i.onAdd()})),t.on("after-remove",(e=>{const i=e.item;i.active&&(i.view.activeTool=null),i.destroy()}))]}function pn(t){return t.visible&&t.getEditableFlag!=null&&t.getEditableFlag(Dt.USER)&&t.getEditableFlag(Dt.MANAGER)}function Sh(t){return t.type==="key-down"&&t.key===Yo.cancel}function pe(t){return F(t.x,t.y)}function Jo(t,e){const i=(t instanceof HTMLElement?t:t.surface)?.getBoundingClientRect();return i?F(e.clientX-i.left,e.clientY-i.top):F(0,0)}function Qo(t,e){return e instanceof Event?Jo(t,e):pe(e)}function Xo(t){if(t instanceof Event)return!0;if(typeof t=="object"&&"type"in t)switch(t.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let kh=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._externallyDragging=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(e,i){const n=()=>e.stopPropagation();switch(e.type){case"pointer-move":ks(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0?this._stopDrag=!0:e.action==="start"?this._externallyDragging=!0:e.action==="end"&&(this._externallyDragging=!1),this._stopDrag&&(n(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!Cs(e))break;const s=pe(e),o=it(s,e.pointerType,i.forEachTool);if(o==null)break;const a=o.manipulator,l=o.tool;a==null||l==null||!a.interactive||a.grabbable&&a.grabbableForEvent(e)||!a.grabbing||a.dragging||this._releaseManipulatorBeforeDragging(a,e,i),a!=null&&l!=null&&a.interactive&&a.grabbable&&a.grabbableForEvent(e)&&!a.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:a,tool:l,start:s,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&i.activeTool==null&&(this._revertToNullActiveTool=!0,i.setActiveTool(o.tool)),a.grabbing=!0,a.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:s}),n());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,i);break;case"pointer-drag":{if(!Cs(e))break;const s=this._grabbedManipulators.get(e.pointerId),o=s?.manipulator,a=s?.tool;if(o==null||a==null)break;const l=pe(e);l.x=ln(l.x,0,i.view.width),l.y=ln(l.y,0,i.view.height);const c=s.start,u=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(o.dragging=!0,u?o.events.emit("drag",{action:"update",start:c,screenPoint:l}):o.events.emit("drag",{action:"start",start:c,screenPoint:l,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:a,manipulator:o,start:c}));break;case"end":o.dragging=!1,u&&o.events.emit("drag",{action:"end",start:c,screenPoint:l}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,i)}n();break}case"immediate-click":{const s=pe(e),o=it(s,e.pointerType,i.forEachTool);if(Ch(e)||i.forEachTool((u=>{if((o==null||o.tool!==u||u.automaticManipulatorSelection)&&u.manipulators){let p=!1;u.manipulators.forEach((({manipulator:m})=>{m.selected&&(m.selected=!1,p=!0)})),p&&u.onManipulatorSelectionChanged&&u.onManipulatorSelectionChanged()}})),o==null)break;const{manipulator:a,tool:l}=o;if(!a.interactive)break;a.selectable&&l.automaticManipulatorSelection&&(a.selected=!a.selected,l.onManipulatorSelectionChanged&&l.onManipulatorSelectionChanged());const c=e.native.shiftKey;a.events.emit("immediate-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:c,stopPropagation:n}),Gi(a,n);break}case"click":{const s=pe(e),o=it(s,e.pointerType,i.forEachTool),a=o?.manipulator;if(a==null||!a.interactive)break;const l=e.native.shiftKey;a.events.emit(e.type,{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:l}),n();break}case"double-click":{const s=pe(e),o=it(s,e.pointerType,i.forEachTool),a=o!=null?o.manipulator:null;if(a==null||!a.interactive)break;const l=e.native.shiftKey;a.events.emit("double-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:n}),Gi(a,n);break}case"immediate-double-click":{const s=pe(e),o=it(s,e.pointerType,i.forEachTool),a=o!=null?o.manipulator:null;if(a==null||!a.interactive)break;const l=e.native.shiftKey;a.events.emit("immediate-double-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:n}),e.pointerType==="mouse"&&Gi(a,n);break}}this._onFocusChange(i.forEachTool)}_releaseManipulatorBeforeDragging(e,i,n){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:i.pointerType,screenPoint:pe(i)}),this._grabbedManipulators.forEach((({manipulator:s},o)=>{s===e&&this._grabbedManipulators.delete(o)})),this._afterManipulatorRelease(n.setActiveTool)}_handlePointerEnd(e,i){const n=this._grabbedManipulators.get(e.pointerId)?.manipulator;n!=null&&n.grabbing&&(n.grabbing=!1,n.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:pe(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorRelease(i.setActiveTool))}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=Ss(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=Ss(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const i=new Set,n=new Set;this._grabbedManipulators.forEach((({tool:s})=>{i.add(s)})),this._hoveredManipulators.forEach((({tool:s})=>{n.add(s)})),e((s=>{s.hasGrabbedManipulators=i.has(s),s.hasHoveredManipulators=n.has(s);const o=this._grabbedManipulators.values(),a=ar(o,(({tool:l})=>l===s));s.firstGrabbedManipulator=a!=null?a.manipulator:null}))}clearPointers(e,{forEachTool:i,setActiveTool:n},s=!0,o){const a=(l,c)=>l===e&&(o==null||o===c);this._grabbedManipulators.forEach((({tool:l,manipulator:c,pointerType:u},p)=>{a(l,c)&&(this._grabbedManipulators.delete(p),c.grabbing=!1,c.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:u}))})),this._draggedManipulators.forEach((({tool:l,manipulator:c},u)=>{a(l,c)&&(this._draggedManipulators.delete(u),c.dragging=!1,c.events.emit("drag",{action:"cancel"}))})),s&&this._hoveredManipulators.forEach((({tool:l,manipulator:c},u)=>{a(l,c)&&(this._hoveredManipulators.delete(u),c.hovering=!1)})),this._afterManipulatorRelease(n),this._onFocusChange(i)}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach(((i,n)=>{this._updateHoveredStateForPointerAtScreenPosition(F(i.x,i.y),n,i.pointerType,e)}))}handleHoverEvent(e,i){const n=e.type;n!=="pointer-up"&&n!=="immediate-click"&&n!=="pointer-move"||!ks(e.pointerType)||(n!=="pointer-up"&&this._externallyDragging?this._clearHoveredManipulatorStates(e.pointerId):this._updateHoveredStateForPointerAtScreenPosition(pe(e),e.pointerId,e.pointerType,i))}_updateHoveredStateForPointerAtScreenPosition(e,i,n,s){let o=it(e,n,s);const a=this._hoveredManipulators.get(i)?.manipulator;o==null||o.manipulator.interactive||(o=null),o!=null&&a===o.manipulator||(a!=null&&(a.hovering=!1),o!=null?(o.manipulator.hovering=!0,this._hoveredManipulators.set(i,o)):this._hoveredManipulators.delete(i),this._onFocusChange(s))}_afterManipulatorRelease(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}_clearHoveredManipulatorStates(e){this._hoveredManipulators.forEach((({manipulator:i},n)=>{e===n&&(this._hoveredManipulators.delete(e),i.hovering=!1)}))}};function Ss(t){for(const{manipulator:e}of t.values())if(e!=null&&e.interactive){if(e.grabbing&&e.grabCursor)return e.grabCursor;if(e.cursor)return e.cursor}return null}function it(t,e,i){let n=null;return i((s=>{if(s.manipulators==null||!pn(s))return!1;const o=s.manipulators.intersect(t,e);return o!=null&&(n={tool:s,manipulator:o},!0)})),n}function ks(t){return t==="mouse"}function Cs(t){return t.pointerType!=="mouse"||t.button===0}function Ch(t){return!!t.native.shiftKey}function Gi(t,e){t?.consumesClicks&&e()}const Es="attached",Wi="tools",Eh=1e3;let de=class extends x{constructor(e){super(e),this._updatingHandles=new Si,this._clock=At,this._manipulatorState=new kh,this.tools=new I,this.cursor=null,this._interacting=!1,this._interactingTimeout=Eh,this._interactingTimeoutHandle=null,this._forEachTool=i=>{for(const n of this.tools.items)if(i(n))return}}initialize(){this.addHandles([this.view.on(Uo,(e=>{this._handleInputEvent(e)}),Se.TOOL),...$h(this.tools),this.tools.on("before-add",(({item:e})=>{this._updateToolEditableFlag(e)})),this.tools.on("before-remove",(({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()})),this.tools.on("change",(()=>{this._refreshToolWatchers()}))])}destroy(){this.activeTool=null,this.tools.drain((e=>e.destroy())),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(e!=null&&!this.view.ready)return void k.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const i=this.activeTool;this._set("activeTool",e),i?.deactivate(),e?.activate(),this._removeIncompleteTools(e);for(const n of this.tools){this._updateToolEditableFlag(n);const s=pn(n);this.activeTool!=null&&s||this._manipulatorState.clearPointers(n,this._manipulatorStateEventArgs,!s)}this._updateCursor()}get updating(){return this._updatingHandles.updating||this.tools.some((e=>e.updating))}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=he(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout((()=>this._interacting=!1),this._interactingTimeout)}attach(){this.view.type==="3d"?this.addHandles([w((()=>{const{state:e}=this.view;return"camera"in e&&e.camera}),(()=>this._forEachManipulator((e=>e.onViewChange())))),this.view.elevationProvider?.on("elevation-change",(e=>this._forEachManipulator((i=>i.onElevationChange(e)))))],Es):this.addHandles(w((()=>this.view.extent),(()=>this._forEachManipulator((e=>e.onViewChange())))))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(Es),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){this._forEachTool((i=>{i.manipulators&&i.manipulators.forEach((({manipulator:n})=>e(n,i)))}))}_handleInputEvent(e){let i=!1;const n={...e,stopPropagation:()=>{i=!0,e.stopPropagation()}};this.activeTool!=null?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(n):this._forEachTool((s=>{!i&&s.visible&&s.handleInputEvent(n)})),!i&&Sh(e)&&this.activeTool&&(e.stopPropagation(),e.preventDefault(),this.activeTool.cancel(),this.activeTool=null),this._manipulatorState.handleInputEvent(n,this._manipulatorStateEventArgs),i||this.activeTool==null||this.activeTool.handleInputEventAfter(n),this._manipulatorState.handleHoverEvent(n,this._forEachTool),this._updateCursor(),e.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(Wi),this._forEachTool((e=>{if(e instanceof x){const i=w((()=>[e.cursor,e.visible,e.editable]),(()=>{pn(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}));this.addHandles(i,Wi)}e.manipulators&&this.addHandles([e.manipulators.on("after-remove",(i=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,i.item.manipulator)})),e.manipulators.on("change",(()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}))],Wi)})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){e.setEditableFlag?.(Dt.MANAGER,this.activeTool==null||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;e==null&&this._forEachTool((i=>!(i.cursor==null||!i.visible)&&(e=i.cursor,!0))),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter((i=>(e==null||i!==e)&&!i.created&&i.removeIncompleteOnCancel)).forEach((i=>{this.tools.remove(i)}))}get test(){}};r([h({constructOnly:!0,nonNullable:!0})],de.prototype,"view",void 0),r([h({value:null})],de.prototype,"activeTool",null),r([h({readOnly:!0,type:I})],de.prototype,"tools",void 0),r([h({readOnly:!0})],de.prototype,"cursor",void 0),r([h({readOnly:!0})],de.prototype,"updating",null),r([h()],de.prototype,"_interacting",void 0),r([h({readOnly:!0})],de.prototype,"interacting",null),de=r([_("esri.views.ToolViewManager")],de);const Ih=new ge("cyan"),Rh=1,Vh=.25,Dh=new ge("black"),Oh=.4,Lh=.2,Nm=.25,ea="default",Ah="temporary",zh=new ge("yellow");var dn;let J=dn=class extends x{constructor(t){super(t),this.name=ea,this.color=Ih.clone(),this.haloColor=null,this.haloOpacity=Rh,this.fillOpacity=Vh,this.shadowColor=Dh.clone(),this.shadowOpacity=Oh,this.shadowDifference=Lh,this.haloWidth=2.1,this.haloBlur=.8/this.haloWidth}equals(t){return this.color.equals(t.color)&&(this.haloColor||this.color).equals(t.haloColor||t.color)&&this.haloOpacity===t.haloOpacity&&this.fillOpacity===t.fillOpacity&&this.haloWidth===t.haloWidth&&this.haloBlur===t.haloBlur&&this.shadowColor.equals(t.shadowColor)&&this.shadowOpacity===t.shadowOpacity&&this.shadowDifference===t.shadowDifference}clone(){return new dn({...this,color:this.color.clone(),haloColor:this.haloColor?.clone(),shadowColor:this.shadowColor?.clone()})}assignFrom(t){this.color=t.color.clone(),this.haloColor=t.haloColor?.clone(),this.haloOpacity=t.haloOpacity,this.fillOpacity=t.fillOpacity,this.shadowColor=t.shadowColor.clone(),this.shadowDifference=t.shadowDifference,this.shadowOpacity=t.shadowOpacity,this.haloBlur=t.haloBlur,this.haloWidth=t.haloWidth}};r([h({type:String,constructOnly:!0,nonNullable:!0})],J.prototype,"name",void 0),r([h({type:ge,nonNullable:!0})],J.prototype,"color",void 0),r([h({type:ge})],J.prototype,"haloColor",void 0),r([h({nonNullable:!0})],J.prototype,"haloOpacity",void 0),r([h({nonNullable:!0})],J.prototype,"fillOpacity",void 0),r([h({type:ge,nonNullable:!0})],J.prototype,"shadowColor",void 0),r([h({nonNullable:!0})],J.prototype,"shadowOpacity",void 0),r([h({nonNullable:!0})],J.prototype,"shadowDifference",void 0),r([h({nonNullable:!0})],J.prototype,"haloWidth",void 0),r([h({nonNullable:!0})],J.prototype,"haloBlur",void 0),J=dn=r([_("esri.views.support.HighlightOptions")],J);const Fe=J;function Fh(){return new(I.ofType(Fe))([new Fe({name:ea}),new Fe({name:Ah,color:zh})])}let rt=class extends x{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":Nh.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return Hh[this.deviceType]}};r([h({nonNullable:!0,readOnly:!0})],rt.prototype,"nativeIndex",void 0),r([h({type:String,readOnly:!0})],rt.prototype,"deviceType",null),r([h({type:Number,readOnly:!0})],rt.prototype,"axisThreshold",null),rt=r([_("esri.views.input.gamepad.GamepadInputDevice")],rt);const Nn=rt,Nh=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),Hh={standard:.15,spacemouse:.025,unknown:0};let Pt=class extends x{constructor(...e){super(...e),this.devices=new I,this.enabledFocusMode="document"}};r([h({type:I.ofType(Nn),readOnly:!0})],Pt.prototype,"devices",void 0),r([h({type:["document","view","none"]})],Pt.prototype,"enabledFocusMode",void 0),Pt=r([_("esri.views.input.gamepad.GamepadSettings")],Pt);const Zh=Pt;let ii=class extends x{constructor(){super(...arguments),this.gamepad=new Zh}};r([h({readOnly:!0})],ii.prototype,"gamepad",void 0),ii=r([_("esri.views.input.Input")],ii);const qh=ii,ta=()=>mr.respectPrefersReducedMotion&&window.matchMedia("(prefers-reduced-motion: reduce)").matches,Ui=()=>h({type:["pan","rotate","zoom","none"],nonNullable:!0});let Ze=class extends x{constructor(e){super(e),this.dragPrimary="pan",this.dragSecondary="rotate",this.dragTertiary="zoom",this.mouseWheel="zoom"}};r([Ui()],Ze.prototype,"dragPrimary",void 0),r([Ui()],Ze.prototype,"dragSecondary",void 0),r([Ui()],Ze.prototype,"dragTertiary",void 0),r([h({type:["zoom","none"],nonNullable:!0})],Ze.prototype,"mouseWheel",void 0),Ze=r([_("esri.views.navigation.NavigationActionMap")],Ze);const Hn=Ze;let Ve=class extends x{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};r([h({type:Boolean,nonNullable:!0})],Ve.prototype,"enabled",void 0),r([h({type:Nn})],Ve.prototype,"device",void 0),r([h({type:["pan","zoom"],nonNullable:!0})],Ve.prototype,"mode",void 0),r([h({type:["forward-down","forward-up"],nonNullable:!0})],Ve.prototype,"tiltDirection",void 0),r([h({type:Number,nonNullable:!0})],Ve.prototype,"velocityFactor",void 0),Ve=r([_("esri.views.navigation.gamepad.GamepadSettings")],Ve);const ia=Ve;let De=class extends x{constructor(e){super(e),this.actionMap=new Hn,this.browserTouchPanEnabled=!0,this.gamepad=new ia,this.momentumEnabled=!0}get effectiveMomentumEnabled(){return this.momentumEnabled&&!ta()}get mouseWheelZoomEnabled(){return this.actionMap.mouseWheel==="zoom"}set mouseWheelZoomEnabled(e){rr(k.getLogger(this),"mouseWheelZoomEnabled",{replacement:"actionMap.mouseWheel",version:"4.32",warnOnce:!0}),this.actionMap.mouseWheel=e?"zoom":"none"}};r([h({type:Hn,nonNullable:!0})],De.prototype,"actionMap",void 0),r([h({type:Boolean})],De.prototype,"browserTouchPanEnabled",void 0),r([h({type:ia,nonNullable:!0})],De.prototype,"gamepad",void 0),r([h({type:Boolean})],De.prototype,"momentumEnabled",void 0),r([h({type:Boolean})],De.prototype,"mouseWheelZoomEnabled",null),De=r([_("esri.views.navigation.Navigation")],De);const Vi=De;function jm(t,e,i){const n=na(t),s=e,o=Gh(n,s,i);if(n){const a=Ci.deriveUnitFromSR(n,t.spatialReference).heightUnit;if(!i&&a!==n.heightUnit){const l=new T("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${a})`,{horizontalUnit:a});return new T("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:n,error:l})}}if(!Wh(t)||o===j.Unsupported)return new T("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:n});switch(o){case j.Units:{const a=n?.heightUnit||"unknown",l=s?.heightUnit||"unknown",c=new T("layerview:incompatible-height-unit",`The vertical units of the layer (${a}) must match the vertical units of the scene (${l})`,{layerUnit:a,sceneUnit:l});return new T("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:n,sceneHeightModelInfo:s,error:c})}case j.HeightModel:{const a=n?.heightModel||"unknown",l=s?.heightModel||"unknown",c=new T("layerview:incompatible-height-model",`The height model of the layer (${a}) must match the height model of the scene (${l})`,{layerHeightModel:a,sceneHeightModel:l});return new T("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:n,sceneHeightModelInfo:s,error:c})}case j.CRS:{const a=n?.vertCRS||"unknown",l=s?.vertCRS||"unknown",c=new T("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${a}) must match the vertical datum of the scene (${l})`,{layerDatum:a,sceneDatum:l});return new T("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:n,sceneHeightModelInfo:s,error:c})}}return null}function Gh(t,e,i){if(!Is(t)||!Is(e))return j.Unsupported;if(t==null||e==null)return j.Ok;if(!i&&t.heightUnit!==e.heightUnit)return j.Units;if(t.heightModel!==e.heightModel)return j.HeightModel;switch(t.heightModel){case"gravity-related-height":return j.Ok;case"ellipsoidal":return t.vertCRS===e.vertCRS?j.Ok:j.CRS;default:return j.Unsupported}}var j;function Is(t){return t==null||t.heightModel!=null&&t.heightUnit!=null}function Wh(t){return"heightModelInfo"in t&&t.heightModelInfo!=null||t.spatialReference!=null||!aa(t)}function na(t){if(t.type==="integrated-mesh-3dtiles")return null;const e=t.url?Cr(t.url):void 0;return!(t.spatialReference?.vcsWkid==null&&e!=null&&e.serverType==="ImageServer")&&sa(t)&&t.heightModelInfo?t.heightModelInfo:aa(t)?Ci.deriveUnitFromSR(jh,t.spatialReference):null}function sa(t){return"heightModelInfo"in t}function oa(t){if(t.type==="unknown"||!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function aa(t){return oa(t)?!!(t.capabilities&&t.capabilities.data&&t.capabilities.data.supportsZ):ra(t)}function Uh(t){return t.layers!=null||ra(t)||oa(t)||sa(t)}function ra(t){switch(t.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"parquet":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"viewshed":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(t){t[t.Ok=0]="Ok",t[t.Units=1]="Units",t[t.HeightModel=2]="HeightModel",t[t.CRS=3]="CRS",t[t.Unsupported=4]="Unsupported"})(j||(j={}));const jh=new Ci({heightModel:"gravity-related-height"});let mn,ji=null;async function Bh(t){ji||(ji=M(()=>import("./f2dYmovg.js"),__vite__mapDeps([175,2,3,43,8,1,4,12,13,17,11,16,176,35,36,18,102,106]),import.meta.url).then((e=>mn=e))),await ji,ze(t)}async function la(t,e,i,n){if(!t)return null;const s=t.spatialReference;return In()||Rn(s,e)?zt(t,e):mn?mn.projectGeometry(t,e,i,n):(await Promise.race([Bh(n),Vn(n)]),la(t,e,i,n))}async function Bm(t,e){try{return t?.spatialReference?await Vr(t,e):null}catch{return null}}let $=class extends x{constructor(e){super(e),this.required={extent:!1,heightModelInfo:!1,tileInfo:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=an(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference??this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){const e=this.map?.(),i=[];return this.priorityCollection!=null&&i.push(this.priorityCollection),i.push({parent:e?.basemap,layers:e?.basemap?.baseLayers},{layers:e?.layers},{parent:e?.ground,layers:e?.ground?.layers},{parent:e?.basemap,layers:e?.basemap?.referenceLayers}),i}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};let e;if(this._collectLayers(this.mapCollections,(n=>{const s=this._getSupportedSpatialReferences(n);if(s.length>0){const o=this._narrowDownSpatialReferenceCandidates(e,s);o!=null&&(e=o)}return e?.length===1}))&&e?.length!==1)return{updating:!0};const i=this._pickSpatialReferenceCandidate(e);return{spatialReference:i?.spatialReference??null,viewingMode:i?.viewingMode??null,updating:!1}}get _tileInfoTask(){if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};const e=this.map?.(),i=this.spatialReference;if(!i)return{updating:this._spatialReferenceTask.updating};let n;const s=this._collectLayers([{parent:e?.basemap,layers:e?.basemap?.baseLayers},{layers:e?.layers}],(o=>!(!("tileInfo"in o)||!o.tileInfo?.spatialReference.equals(i))&&(n=o,!0)),(o=>"tileInfo"in o));return n?{tileInfo:n.tileInfo,updating:!1}:{updating:s}}get _heightModelInfoTask(){if(!this.required.heightModelInfo||this.suspended&&this._get("_heightModelInfoTask")?.heightModelInfo)return this._get("_heightModelInfoTask")??{updating:!1};let e={};const i=this._collectLayers(this.mapCollections,(n=>{const s=na(n);return!!s&&(e={heightModelInfo:s,vcsWkid:n.spatialReference?.vcsWkid,latestVcsWkid:n.spatialReference?.latestVcsWkid},!0)}),(n=>Uh(n)));return{...e,updating:i}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=[],i=this._collectLayers(this.mapCollections,(n=>{const s="fullExtents"in n&&n.fullExtents||(n.fullExtent!=null?[n.fullExtent]:[]),o=this.requiresExtentInSpatialReference?null:s[0],a=s.find((l=>l.spatialReference.equals(this.spatialReference)))??o;if(a)return e.push({extent:a,layer:n}),!0;if(this._getSupportedSpatialReferences(n).length>0)for(const l of s)e.push({extent:l,layer:n});return!1}));return{candidates:e,updating:i}}get _extentTask(){const{candidates:e,updating:i}=this._extentCandidatesTask;if(i)return{updating:i};if(e==null||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const n=this._pickExtentCandidate(e),s=this.spatialReference;return n.extent.equals(this._projectExtentTask.input)&&s.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=an(this._projectExtentTask.task)),this._projectExtentTask={input:n.extent.clone(),output:null,spatialReference:s.clone(),task:On((async o=>{try{const a=await la(n.extent,s,"portalItem"in n.layer?n.layer.portalItem:void 0,o);this._projectExtentTask={...this._projectExtentTask,task:null,output:a}}catch{if(br(o))return;this._projectExtentTask={...this._projectExtentTask,task:null}}}))},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,i){if(e==null)return i;const n=new Array;for(const s of e)for(const o of i){if(!s.spatialReference.equals(o.spatialReference))continue;const a=Yh(s.viewingMode,o.viewingMode);if(a!==!1){n.push({spatialReference:s.spatialReference,viewingMode:a});break}}return n.length>0?n:null}_pickSpatialReferenceCandidate(e){const i=this.defaultSpatialReference;return e==null||e.length<1?i?{spatialReference:i,viewingMode:null}:null:(i!=null&&e.length>1&&e.some((({spatialReference:n})=>n.equals(i)))&&(e=e.filter((({spatialReference:n})=>n.equals(i)))),e.length>1&&e.some((({viewingMode:n})=>n!==cs.Local))&&(e=e.filter((({viewingMode:n})=>n!==cs.Local))),e[0])}_getSupportedSpatialReferences(e){const i="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(i.length===0)return[];const n=[];for(const s of i){const o=this.getSpatialReferenceSupport(s,e);if(o!=null){const a=o.constraints??[{spatialReference:s,viewingMode:null}];for(const{spatialReference:l,viewingMode:c}of a)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!l.equals(this.userSpatialReference)||n.push({spatialReference:l,viewingMode:c})}}return n}_pickExtentCandidate(e){const i=this.spatialReference;return e.find((({extent:n})=>i.equals(n.spatialReference)))||e[0]}_collectLayers(e,i,n=()=>!0){switch(this._loadMaybe(this.map?.())){case"loading":return!0;case"failed":return!1}const s=new Kh(n,i);for(const o of e)if(this._collectCollection(o,s),s.done||s.preloading===this.sourcePreloadCount)break;return s.updating}_collectCollection(e,i){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return i.updating=!0,void++i.preloading;case"failed":return}for(const n of e.layers)if(i.layerFilter(n)){switch(this._loadMaybe(n)){case"failed":continue;case"loading":i.updating=!0,++i.preloading;break;case"loaded":if(i.updating||(i.done=i.pushLayer(n)),i.done||i.preloading===this.sourcePreloadCount)break;"layers"in n&&this._collectCollection({layers:n.layers},i)}if(i.done||i.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&e.loadStatus!=null?e.loadStatus==="not-loaded"?(e.load().catch((i=>{rn(i)})),"loading"):e.loadStatus:"loaded"}};r([h()],$.prototype,"required",void 0),r([h({constructOnly:!0})],$.prototype,"map",void 0),r([h({constructOnly:!0})],$.prototype,"getSpatialReferenceSupport",void 0),r([h()],$.prototype,"defaultSpatialReference",void 0),r([h()],$.prototype,"userSpatialReference",void 0),r([h()],$.prototype,"sourcePreloadCount",void 0),r([h()],$.prototype,"priorityCollection",void 0),r([h()],$.prototype,"requiresExtentInSpatialReference",void 0),r([h()],$.prototype,"suspended",void 0),r([h({readOnly:!0})],$.prototype,"ready",null),r([h({readOnly:!0})],$.prototype,"heightModelInfoReady",null),r([h({readOnly:!0})],$.prototype,"spatialReference",null),r([h({readOnly:!0})],$.prototype,"extent",null),r([h({readOnly:!0})],$.prototype,"heightModelInfo",null),r([h({readOnly:!0})],$.prototype,"vcsWkid",null),r([h({readOnly:!0})],$.prototype,"latestVcsWkid",null),r([h({readOnly:!0})],$.prototype,"viewingMode",null),r([h({readOnly:!0})],$.prototype,"tileInfo",null),r([h({readOnly:!0})],$.prototype,"mapCollections",null),r([h({readOnly:!0})],$.prototype,"_spatialReferenceTask",null),r([h({readOnly:!0})],$.prototype,"_tileInfoTask",null),r([h({readOnly:!0})],$.prototype,"_heightModelInfoTask",null),r([h({readOnly:!0})],$.prototype,"_extentCandidatesTask",null),r([h()],$.prototype,"_extentTask",null),r([h()],$.prototype,"_projectExtentTask",void 0),$=r([_("esri.views.support.DefaultsFromMap")],$);let Kh=class{constructor(e,i){this.layerFilter=e,this.pushLayer=i,this.preloading=-1,this.updating=!1,this.done=!1}};function Yh(t,e){return t!=null?e!=null?t===e&&t:t:e}function Jh(t){return"tryRecycleWith"in t}let Qh=class{constructor(e,i,n){this.layer=e,this.view=i,this.layerViewImporter=n,this._controller=new AbortController,this._deferred=xi(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,ts(this._controller.signal,(()=>{this._recycleController?.abort();const s=new T("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(s)}))}tryRecycle(e){if(!this.done||!this.layerView||!Jh(this.layerView))return null;this._recycleController?.abort(),this._recycleController=new AbortController;const i=this.layer.type,n=this._recycleController.signal;for(let s=0;s<e.length;s++){const o=e[s];if(o.type!==i)continue;const a=this.layerView.tryRecycleWith(o,{signal:n});if(a){e.splice(s,1),this.layer=o;const l=this.layerView,c=l.view;return this.promise=a.then((()=>(ze(n),o.emit("layerview-destroy",{view:c,layerView:l}),c.emit("layerview-destroy",{view:c,layerView:l}),o.emit("layerview-create",{view:c,layerView:l}),c.emit("layerview-create",{view:c,layerView:l}),l))),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(e){const{layer:i,view:n}=this;i.emit("layerview-destroy",{view:n,layerView:e}),n.emit("layerview-destroy",{layer:i,layerView:e})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null,this.promise=null,this._deferred=null}async start(){const{view:e}=this;if(this._started||!e.map)return;this._started=!0;const{_controller:{signal:i},layer:n}=this;this._map=e.map;try{let s,o;if(await n.load({signal:i}),n.prefetchResources&&await n.prefetchResources({signal:i}),Xh(n))s=await n.createLayerView(e,{signal:i});else{if(!this.layerViewImporter.hasLayerViewModule(n))throw new T("layer:view-not-supported","No layerview implementation was found");const c=await this.layerViewImporter.importLayerView(n);ze(i),s="default"in c?new c.default({layer:n,view:e}):new c({layer:n,view:e})}const a=()=>{o=he(o),s.destroyed||s.destroy(),s.layer=null,s.parent=null,s.view=null,this.done=!0};o=ts(i,a),ze(i);try{await s.when()}catch(c){throw a(),c}if(!this._map?.allLayers?.includes(n))return a(),void this._deferred.reject(new T("view:no-layerview-for-layer","The layer has been removed from the map",{layer:n}));this.layerView=s,n.emit("layerview-create",{view:e,layerView:s}),e.emit("layerview-create",{layer:n,layerView:s}),this.done=!0,this._deferred.resolve(s)}catch(s){n.emit("layerview-create-error",{view:e,error:s}),e.emit("layerview-create-error",{layer:n,error:s}),this.done=!0,this._deferred.reject(new T("layerview:create-error","layerview creation failed",{layer:n,error:s}))}}};function Xh(t){return t.createLayerView!==el.prototype.createLayerView}function ec(t){return t!=null&&typeof t=="object"&&"layerViews"in t}let Q=class extends x{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new Si,this.supportsGround=!0,this._preloadLayerViewModules=()=>{const i=this.view.map?.allLayers;if(i)for(const n of i)this.layerViewFilter?.(n)!==!1&&this.layerViewImporter.hasLayerViewModule(n)&&this.layerViewImporter.importLayerView(n)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=xi(),this._workPromise.promise.catch((()=>{}))),this.removeHandles("reschedule"),this.addHandles(Mr(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{const i=this.view.map;if(this.destroyed||!i)return void this.clear();if(this._map!==i&&(this.clear(),this._map=i),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const n=new Set,s=[],o=this.view.ready,a=p=>{if(p!=null){for(const m of p)if(m){if(this.layerViewFilter?.(m)===!1)continue;n.add(m);const d=this._layerLayerViewInfoMap.get(m);d&&o?d.start():d||this._recyclingInfoMap.has(m)||s.push(m),"layers"in m&&m.layers&&a(m.layers)}}};for(const p of this._rootCollectionNames)a(Gt(this,p));const l=new Array,c=p=>{const m=p.tryRecycle(s);m?(this._recyclingInfoMap.set(p.layer,p),this.notifyChange("updating"),m.then((()=>{this._recyclingInfoMap.delete(p.layer),this._layerLayerViewInfoMap.set(p.layer,p),this._reschedule(),this.notifyChange("updating")})).catch((d=>{rn(d)||(this._recyclingInfoMap.delete(p.layer),p.destroy(),this._reschedule(),this.notifyChange("updating"))}))):l.push(p)};for(const p of this._layerLayerViewInfoMap.values())n.has(p.layer)||(this._layerLayerViewInfoMap.delete(p.layer),c(p));for(const p of this._recyclingInfoMap.values())n.has(p.layer)||(this._recyclingInfoMap.delete(p.layer),c(p));for(const p of s)this._createLayerView(p);this._refreshCollections(),l.forEach((p=>p.destroy()));const u=[i?.ground?.layers,i?.basemap?.baseLayers,i?.basemap?.referenceLayers,i?.layers].filter((p=>!!p));n.forEach((p=>"layers"in p&&u.push(p.layers))),this.addHandles(u.map((p=>this._watchUpdatingTracking.addOnCollectionChange((()=>p),this._reschedule))),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.addHandles([Ti((()=>this.view?.map?.allLayers),"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),w((()=>{const e=this.view,i=e?.map;return[i?.basemap,i?.ground,i?.layers,e?.ready]}),(()=>this._reschedule()),ie)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),zi(this._recyclingInfoMap),zi(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(xr()),this._workPromise=null)}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||lr(this._layerLayerViewInfoMap,(e=>!e.done))||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(const i of this._layerLayerViewInfoMap.values())i.done||++e;return e}clear(){this.destroyed||(this._clearCollections(),zi(this._layerLayerViewInfoMap))}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e)){if(this._recyclingInfoMap.has(e))return this._recyclingInfoMap.get(e).promise;throw new T("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e})}return this._layerLayerViewInfoMap.get(e).promise}isCreatingLayerViewsForLayer(e,i){this.commitProperty("updatingRemaining");const n=this._layerLayerViewInfoMap.get(e);if(!n?.done)return!0;const s=n.layerView;return!(!s||!i||s.parent===i)||!!(n.done&&s&&"layers"in e&&e.layers?.length)&&e.layers.some((o=>this.isCreatingLayerViewsForLayer(o,s)))}_refreshCollections(){for(const[e,i]of this._layersToLayerViews)this._populateLayerViewsOwners(Gt(this,e),Gt(this,i),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_clearCollections(){for(const e of this._layersToLayerViews.values())Gt(this,e)?.removeAll()}_populateLayerViewsOwners(e,i,n){if(!e||!i)return void i?.removeAll();let s=0;for(const o of e){const a=this._layerLayerViewInfoMap.get(o);if(!a?.layerView)continue;const l=a.layerView;l.layer=o,l.parent=n,i.at(s)!==l&&i.splice(s,0,l),"layers"in o&&ec(l)&&this._populateLayerViewsOwners(o.layers,l.layerViews,l),s+=1}s<i.length&&i.splice(s)}_createLayerView(e){e.load().catch((()=>{})),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const i=new Qh(e,this.view,this.layerViewImporter);i.promise.then((()=>this._refreshCollections()),(n=>{n&&(rn(n)||n.name==="cancelled:layerview-create")||k.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:n}),this._refreshCollections()})),this._layerLayerViewInfoMap.set(e,i),this.view.ready&&i.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};r([h()],Q.prototype,"_workPromise",void 0),r([h({readOnly:!0})],Q.prototype,"_watchUpdatingTracking",void 0),r([h({readOnly:!0})],Q.prototype,"_layersToLayerViews",null),r([h({readOnly:!0})],Q.prototype,"_rootCollectionNames",null),r([h({constructOnly:!0})],Q.prototype,"layerViewFilter",void 0),r([h()],Q.prototype,"layerViewImporter",void 0),r([h()],Q.prototype,"supportsGround",void 0),r([h({readOnly:!0})],Q.prototype,"updating",null),r([h({readOnly:!0})],Q.prototype,"updatingRemaining",null),r([h({constructOnly:!0})],Q.prototype,"view",void 0),Q=r([_("esri.views.support.LayerViewManager")],Q);const tc=Q;let lt=class extends x{constructor(e){super(e),this.featureTitleFields=!1,this.utilityNetworkFields=!1,this.globalIdField=!1}};r([h()],lt.prototype,"featureTitleFields",void 0),r([h()],lt.prototype,"utilityNetworkFields",void 0),r([h()],lt.prototype,"globalIdField",void 0),lt=r([_("esri.views.support.RequiredFieldsOptions")],lt);const ic=lt;var $t,Ke;let y=(Ke=class extends Ft.EventedMixin(Vo.EsriPromiseMixin(x)){constructor(e){super(e),this._userSpatialReference=null,this._cursor=null,this.handles=new Po,this.updatingHandles=new Si,this.allLayerViews=new $o({getCollections:()=>[this.basemapView?.baseLayerViews,this.groundView?.layerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:sc}),this.analyses=new ui,this.basemapView=null,this.displayFilterEnabled=!0,this.fatalError=null,this.graphics=new Do,this.groundView=null,this.typeSpecificPreconditionsReady=!0,this.layerViews=new I,this.magnifier=new Wo,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this._readyStateWaitingTask=null,this.supportsGround=!0,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new qh,this.navigation=new Vi,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new Ko(this),this.persistableViewModels=new I,this.requiredFieldsOptions=new ic,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this._userTimeExtent=null,this._lockedTimeExtent=null,this.theme=null,this.handles.add(w((()=>this.preconditionsReady),(i=>{const n=this.ready;if(i?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,this._lockedTimeExtent=this.timeExtent,$t.views.add(this)):(this._lockedSpatialReference=null,$t.views.remove(this)),this.notifyChange("spatialReference"),!i&&n)this.toolViewManager?.detach(),this.analysisViewManager!=null&&this.analysisViewManager.detach(),this.layerViewManager?.clear(),this._teardown();else if(i&&!n){try{this._startup()}catch(s){return void queueMicrotask((()=>{this.fatalError=new T("view:startup-error","View._startup failed",s)}))}this.analysisViewManager!=null&&this.analysisViewManager.attach(),this.toolViewManager.attach()}}),Rt))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this.validate()]).then((()=>(this._isValid=!0,Cn((()=>this.ready)))))),this.basemapView=new oh({view:this}),this.layerViewManager=new tc({view:this,layerViewFilter:e=>this.layerViewFilter?.(e)??!0,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},supportsGround:this.supportsGround}),this.toolViewManager=new de({view:this}),this.selectionManager=new lh({view:this}),this.addHandles([Je((()=>this.readyState==="map-content-error"&&!this.spatialReference),(()=>{k.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")})),w((()=>this.initialExtentRequired),(e=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:e}),ie),w((()=>this.ready),(e=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=e,this.defaultsFromMap.userSpatialReference=e?this.spatialReference:this._userSpatialReference)}),Rt),w((()=>this._userSpatialReference),(e=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=e)}),ie)])}destroy(){this.destroyed||($t.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=le(this.graphics),this.analyses=le(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),le(this.analysisViewManager),this.toolViewManager=le(this.toolViewManager),this.layerViewManager=le(this.layerViewManager),this.selectionManager=le(this.selectionManager),this.basemapView=le(this.basemapView),this.groundView?.destroy(),this.layerViews?.forEach((e=>e.destroy())),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.destroy(),this.map=le(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return k.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){return this.toolViewManager?.activeTool}set activeTool(e){this.toolViewManager&&(this.toolViewManager.activeTool=e)}get animation(){return this._get("animation")}set animation(e){this._set("animation",e)}get center(){return null}get defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new $({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:(e,i)=>this.getSpatialReferenceSupport(e,i),...this.defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(e){this._set("extent",e)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get highlights(){return this._get("highlights")??Fh()}set highlights(e){this._set("highlights",Ro(e,this._get("highlights"),I.ofType(Fe)))}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){return!this.destroying&&!this.destroyed&&!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||rs.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!this.defaultsFromMap?.ready||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(e){e!==this._get("map")&&(e?.destroyed&&(k.getLogger(this).warn("#map","The provided map is already destroyed",{map:e}),e=null),rs.isLoadable(e)&&e.load().catch((()=>{})),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",e))}get readyState(){if(this.destroyed)return this._get("readyState");if(!this.map)return"missing-map";if("container"in this&&!this.container)return"missing-container";if(this.fatalError)return"rendering-error";if((this.defaultsFromMap?.ready??!1)&&!this.spatialReference){const e=!("loaded"in this.map)||this.map.loaded,i=this.map.ground.loaded,n=this.map.basemap?.loaded??!0;return e&&n&&i&&!this.map?.allLayers.length?"empty-map":(this._readyStateWaitingTask||(this._readyStateWaitingTask=On((s=>Tr(z("view-readyState-waiting-delay"),null,s))),this.addHandles(this._readyStateWaitingTask),this.addHandles(this._readyStateWaitingTask,"ready-state-task")),this._readyStateWaitingTask?.finished?"map-content-error":"loading")}return this._readyStateWaitingTask=an(this._readyStateWaitingTask),this.removeHandles("ready-state-task"),this.ready?"ready":"loading"}get spatialReference(){const e=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(e&&this.defaultsFromMap?.required?.heightModelInfo){const i=e.clone();return i.vcsWkid=this.defaultsFromMap.vcsWkid,i.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,i}return e}set spatialReference(e){const i=!ki(e,this._get("spatialReference"));this._set("_userSpatialReference",e),i&&(this._set("spatialReference",e),this._spatialReferenceChanged(e))}_spatialReferenceChanged(e){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeExtent(){return this._userTimeExtent??this._lockedTimeExtent??this.getDefaultTimeExtent()??null}set timeExtent(e){this._userTimeExtent=e}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??Wr}set timeZone(e){this._userTimeZone=e,il(e)||k.getLogger(this).warn("#timeZone",`the parsed value '${e}' may not be a valid IANA time zone`)}get tools(){return this.toolViewManager?.tools}get initialExtent(){return this.defaultsFromMap?.extent}get cursor(){return this.toolViewManager?.cursor??this._cursor??"default"}set cursor(e){this._cursor=e,this.notifyChange("cursor")}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new cn}whenLayerView(e){return this.layerViewManager?.whenLayerView(e)??Promise.reject()}getDefaultSpatialReference(){return this.defaultsFromMap?.spatialReference}getDefaultHeightModelInfo(){return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??this.defaultsFromMap?.heightModelInfo??null}getDefaultTimeZone(){return null}getDefaultTimeExtent(){return null}importLayerView(e){throw new T("view:importLayerView-missing","importLayerView() not implemented")}hasLayerViewModule(e){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(e){return this.getSpatialReferenceSupport(e)!=null}when(e,i){return this.isResolved()&&!this.ready&&k.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(e,i)}forceReadyCycle(){this.ready&&(Je((()=>this.destroyed||this.preconditionsReady===!1),(()=>this._readyCycleForced=!1),{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(e){this.toolViewManager.tools.add(e),this.activeTool=e}tryFatalErrorRecovery(){this.fatalError=null}},$t=Ke,Ke.views=new I,Ke);r([h()],y.prototype,"_userSpatialReference",void 0),r([h()],y.prototype,"activeTool",null),r([h({readOnly:!0})],y.prototype,"allLayerViews",void 0),r([h(ls(ui,"analyses"))],y.prototype,"analyses",void 0),r([h()],y.prototype,"animation",null),r([h()],y.prototype,"basemapView",void 0),r([h()],y.prototype,"center",null),r([h()],y.prototype,"defaultsFromMapSettings",null),r([h()],y.prototype,"defaultsFromMap",null),r([h()],y.prototype,"displayFilterEnabled",void 0),r([h({type:Qe})],y.prototype,"extent",null),r([h()],y.prototype,"fatalError",void 0),r([h(ls(Do,"graphics"))],y.prototype,"graphics",void 0),r([h()],y.prototype,"groundView",void 0),r([h({readOnly:!0,type:Ci})],y.prototype,"heightModelInfo",null),r([h({type:I.ofType(Fe)})],y.prototype,"highlights",null),r([h({readOnly:!0})],y.prototype,"interacting",null),r([h({constructOnly:!0})],y.prototype,"layerViewFilter",void 0),r([h({readOnly:!0})],y.prototype,"navigating",null),r([h({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],y.prototype,"preconditionsReady",null),r([h({readOnly:!0})],y.prototype,"typeSpecificPreconditionsReady",void 0),r([h({type:I,readOnly:!0})],y.prototype,"layerViews",void 0),r([h()],y.prototype,"resolution",null),r([h({type:Wo})],y.prototype,"magnifier",void 0),r([h({value:null,type:Gr})],y.prototype,"map",null),r([h()],y.prototype,"padding",void 0),r([h({readOnly:!0})],y.prototype,"ready",void 0),r([h()],y.prototype,"_readyStateWaitingTask",void 0),r([h({readOnly:!0})],y.prototype,"readyState",null),r([h({type:ci})],y.prototype,"spatialReference",null),r([h()],y.prototype,"stationary",null),r([h({readOnly:!0})],y.prototype,"supportsGround",void 0),r([h({type:tl})],y.prototype,"timeExtent",null),r([h({type:String,nonNullable:!0})],y.prototype,"timeZone",null),r([h()],y.prototype,"tools",null),r([h()],y.prototype,"toolViewManager",void 0),r([h({readOnly:!0})],y.prototype,"type",void 0),r([h({type:Number})],y.prototype,"scale",void 0),r([h({readOnly:!0})],y.prototype,"updating",void 0),r([h({readOnly:!0})],y.prototype,"initialExtentRequired",void 0),r([h({readOnly:!0})],y.prototype,"initialExtent",null),r([h()],y.prototype,"cursor",null),r([h({readOnly:!0})],y.prototype,"input",void 0),r([h({type:Vi,nonNullable:!0})],y.prototype,"navigation",void 0),r([h()],y.prototype,"layerViewManager",void 0),r([h()],y.prototype,"analysisViewManager",void 0),r([h()],y.prototype,"selectionManager",void 0),r([h()],y.prototype,"width",void 0),r([h()],y.prototype,"height",void 0),r([h({readOnly:!0})],y.prototype,"resizing",void 0),r([h({value:null,readOnly:!0})],y.prototype,"size",null),r([h({readOnly:!0})],y.prototype,"suspended",void 0),r([h({readOnly:!0})],y.prototype,"viewEvents",void 0),r([h({readOnly:!0})],y.prototype,"persistableViewModels",void 0),r([h()],y.prototype,"_isValid",void 0),r([h()],y.prototype,"_readyCycleForced",void 0),r([h()],y.prototype,"_lockedSpatialReference",void 0),r([h()],y.prototype,"_userTimeZone",void 0),r([h()],y.prototype,"_lockedTimeZone",void 0),r([h()],y.prototype,"_userTimeExtent",void 0),r([h()],y.prototype,"_lockedTimeExtent",void 0),r([h({type:cn})],y.prototype,"theme",void 0),r([h({readOnly:!0,type:cn})],y.prototype,"effectiveTheme",null),y=$t=r([_("esri.views.View")],y);const Bi=globalThis.$arcgis;Bi&&!Bi.views&&Object.defineProperty(Bi,"views",{configurable:!1,enumerable:!0,writable:!1,value:y.views});const nc=y;function sc(t){return t.layerViews}function ye(){return[1,0,0,1,0,0]}function oc(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function ac(t,e,i,n,s,o){return[t,e,i,n,s,o]}const rc=ye();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:rc,clone:oc,create:ye,fromValues:ac},Symbol.toStringTag,{value:"Module"}));const ha=96,ca=39.37,lc=180/Math.PI;function ua(t){return t.wkid?t:t.spatialReference||ci.WGS84}function Zn(t,e){return e.type?A(t,e.x,e.y):Et(t,e)}function pa(t){return Lo(t)}function Di(t,e,i=0){let n=t.width,s=t.height;if(i!==0){const l=Ei(i),c=Math.abs(Math.cos(l)),u=Math.abs(Math.sin(l));n=t.width*c+t.height*u,s=t.width*u+t.height*c}const o=Math.max(1,e[0]),a=Math.max(1,e[1]);return Math.max(n/o,s/a)*fc(t.spatialReference)}async function St(t,e,i,n){let s,o;if(!t||Array.isArray(t)&&!t.length)return null;if(I.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&typeof t[0]=="object"){const l=t.every((p=>"attributes"in p)),c=t.some((p=>!p.geometry));let u=t;if(l&&c&&e&&e.allLayerViews){const p=new Map;for(const v of t){const f=v.layer,R=p.get(f)||[],P=v.attributes[f.objectIdField];P!=null&&R.push(P),p.set(f,R)}const m=[];p.forEach(((v,f)=>{const R=e.allLayerViews?.find((P=>P.layer.id===f.id));if(R&&"queryFeatures"in R){const P=f.createQuery();P.objectIds=v,P.returnGeometry=!0,m.push(R.queryFeatures(P))}}));const d=await Promise.all(m),g=[];for(const v of d)if(v&&v.features&&v.features.length)for(const f of v.features)f.geometry!=null&&g.push(f.geometry);u=g}for(const p of u)n=await St(p,e,i,n);return n}if(Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number")s=new L(t);else if(t instanceof Ao)s=t;else if("geometry"in t){if(t.geometry)s=t.geometry;else if(t.layer){const l=t.layer,c=e.allLayerViews?.find((u=>u.layer.id===l.id));if(c&&"queryFeatures"in c){const u=l.createQuery();u.objectIds=[t.attributes[l.objectIdField]],u.returnGeometry=!0,s=(await c.queryFeatures(u))?.features?.[0]?.geometry}}}if(s==null)return null;switch(s.type){case"point":o=new Qe({xmin:s.x,ymin:s.y,xmax:s.x,ymax:s.y,spatialReference:s.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":o=fl(s);break;default:o=s.extent}if(!o)return null;In()||Rn(o.spatialReference,i)||await Vn();const a=zt(o,i);if(!a)return null;if(n){const l=a.center,c=l.clone();c.x=zn(l.x,n.center.x,i),c.x!==l.x&&a.centerAt(c),n=n.union(a)}else n=a;return n}function hc(t){if(t&&(!Array.isArray(t)||typeof t[0]!="number")&&(typeof t=="object"||Array.isArray(t)&&typeof t[0]=="object")){if("layer"in t&&t.layer?.minScale!=null&&t.layer.maxScale!=null){const e=t.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every((e=>"layer"in e))){let e=0,i=0;for(const n of t){const s=n.layer;s?.minScale&&s.maxScale&&(e=s.minScale<e?s.minScale:e,i=s.maxScale>i?s.maxScale:i)}return e&&i?{min:e,max:i}:null}}}function Rs(t,e){const i=ua(t);return ki(i,e)||i.imageCoordinateSystem||e.imageCoordinateSystem?t:zt(t,e)}async function cc(t,e){if(!t||!e)return new ne({targetGeometry:new L,scale:0,rotation:0});let i=e.spatialReference;const{constraints:n,padding:s,viewpoint:o,size:a}=e,l=[s?a[0]-s.left-s.right:a[0],s?a[1]-s.top-s.bottom:a[1]];let c=null;t instanceof ne?c=t:t.viewpoint?c=t.viewpoint:t.target&&t.target.declaredClass==="esri.Viewpoint"&&(c=t.target);let u=null;c?.targetGeometry?u=c.targetGeometry:t instanceof Qe?u=t:t instanceof Ao?u=await St(t,e,i):t&&(u=await St(t.center,e,i)||await St(t.target,e,i)||await St(t,e,i)),!u&&o?.targetGeometry?u=o.targetGeometry:!u&&e.extent&&(u=e.extent),i||(i=ua(e.spatialReference||e.extent||u)),In()||ki(u.spatialReference,i)||Rn(u.spatialReference,i)||await Vn();const p=Rs(u,i),m="center"in p?p.center:p;e.pickClosestTarget!==!1&&m.type==="point"&&o.targetGeometry?.type==="point"&&(m.x=zn(m.x,o.targetGeometry.x,m.spatialReference));let d=0;c?d=c.rotation:t.hasOwnProperty("rotation")?d=t.rotation:o&&(d=o.rotation);let g=0;g=c?.targetGeometry!=null&&c.targetGeometry.type==="point"?c.scale:"scale"in t&&t.scale?t.scale:"zoom"in t&&t.zoom!==-1&&n&&n.effectiveLODs?n.zoomToScale(t.zoom):Array.isArray(u)||u.type==="point"||u.type==="extent"&&u.width===0&&u.height===0?o.scale:Di(Rs(u.extent,i),l,d);const v=hc(t.target??t);v&&(v.min&&v.min<g?g=v.min:v.max&&v.max>g&&(g=v.max));let f=new ne({targetGeometry:m,scale:g,rotation:d});return n&&(f=n.fit(f),n.constrainByGeometry(f),n.rotationEnabled||(f.rotation=o.rotation)),f}function Z(t,e){const i=t.targetGeometry,n=e.targetGeometry;return i.x=n.x,i.y=n.y,i.spatialReference=n.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function uc(t,e,i){return i?A(t,.5*(e[0]-i.right+i.left),.5*(e[1]-i.bottom+i.top)):Ii(t,e,.5)}const pc=(function(){const t=D();return function(e,i,n){const s=i.targetGeometry;Zn(t,s);const o=.5*yt(i);return e.xmin=t[0]-o*n[0],e.ymin=t[1]-o*n[1],e.xmax=t[0]+o*n[0],e.ymax=t[1]+o*n[1],e.spatialReference=s.spatialReference,e}})();function dc(t,e,i,n,s){return gn(t,e,i.center),t.scale=Di(i,n),s?.constraints?.constrain(t),t}function mc(t,e,i,n){return Wn(t,e,i,n),qo(t,t)}const da=(function(){const t=D();return function(e,i,n){return No(e,yc(e,i),uc(t,i,n))}})(),gc=(function(){const t=ye(),e=D();return function(i,n,s,o){const a=yt(n),l=qn(n);return A(e,a,a),dl(t,e),Ri(t,t,l),Vt(t,t,da(e,s,o)),Vt(t,t,[0,o.top-o.bottom]),A(i,t[4],t[5])}})();function yt(t){return t.scale*ma(t.targetGeometry?.spatialReference)}function ma(t){return Oo(t)?1/(pa(t)*ca*ha):1}function qn(t){return Ho(t.rotation)||0}function fc(t){return Oo(t)?pa(t)*ca*ha:1}function yc(t,e){return Ii(t,e,.5)}const Gn=(function(){const t=D(),e=D(),i=D();return function(n,s,o,a,l,c){return hl(t,s),Ii(e,o,.5*c),A(i,1/a*c,-1/a*c),Zo(n,e),l&&Ri(n,n,l),An(n,n,i),Vt(n,n,t),n}})(),Wn=(function(){const t=D();return function(e,i,n,s){const o=yt(i),a=qn(i);return Zn(t,i.targetGeometry),Gn(e,t,n,o,a,s)}})(),_c=(function(){const t=D();return function(e,i,n,s){const o=yt(i);return Zn(t,i.targetGeometry),Gn(e,t,n,o,0,s)}})();function ga(t){const e=zo(t);return e?e.valid[1]-e.valid[0]:0}function vc(t,e){return Math.round(ga(t)/e)}const wc=(function(){const t=D(),e=D(),i=[0,0,0];return function(n,s,o){hn(t,n,s),us(t,t),hn(e,n,o),us(e,e),rl(i,t,e);let a=Math.acos(ll(t,e)/(ps(t)*ps(e)))*lc;return i[2]<0&&(a=-a),isNaN(a)&&(a=0),a}})(),bc=(function(){const t=D();return function(e,i,n,s){const o=e.targetGeometry;return Z(e,i),gc(t,i,n,s),o.x+=t[0],o.y+=t[1],e}})(),gn=function(t,e,i){Z(t,e);const n=t.targetGeometry;return n.x=i.x,n.y=i.y,n.spatialReference=i.spatialReference,t},Mc=(function(){const t=D();return function(e,i,n,s,o){o||(o="center"),No(t,n,s),Ii(t,t,.5);const a=t[0],l=t[1];switch(o){case"center":A(t,0,0);break;case"left":A(t,-a,0);break;case"top":A(t,0,l);break;case"right":A(t,a,0);break;case"bottom":A(t,0,-l);break;case"top-left":A(t,-a,l);break;case"bottom-left":A(t,-a,-l);break;case"top-right":A(t,a,l);break;case"bottom-right":A(t,a,-l)}return Oi(e,i,t),e}})();function eg(t,e,i){return Z(t,e),t.rotation+=i,t}function xc(t,e,i){return Z(t,e),t.rotation=i,t}const Tc=(function(){const t=D();return function(e,i,n,s,o){return Z(e,i),isNaN(n)||n===0||(ya(t,s,i,o),e.scale=i.scale*n,_a(t,t,e,o),Oi(e,e,A(t,t[0]-s[0],s[1]-t[1]))),e}})();function Vs(t,e,i){return Z(t,e),t.scale=i,t}const fa=(function(){const t=D();return function(e,i,n,s,o,a){return Z(e,i),isNaN(n)||n===0||(ya(t,o,i,a),e.scale=i.scale*n,e.rotation+=s,_a(t,t,e,a),Oi(e,e,A(t,t[0]-o[0],o[1]-t[1]))),e}})(),tg=(function(){const t=D(),e=D();return function(i,n,s,o,a,l,c){return da(e,l,c),al(t,a,e),o?fa(i,n,s,o,t,l):Tc(i,n,s,t,l)}})(),ya=(function(){const t=ye();return function(e,i,n,s){return Pe(e,i,mc(t,n,s,1))}})(),_a=(function(){const t=ye();return function(e,i,n,s){return Pe(e,i,Wn(t,n,s,1))}})(),Oi=(function(){const t=D(),e=ye();return function(i,n,s){Z(i,n);const o=yt(n),a=i.targetGeometry;return pl(e,qn(n)),An(e,e,ul(o,o)),Pe(t,s,e),a.x+=t[0],a.y+=t[1],i}})();function ni(){const t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}function Pc(t){const e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function $c(t,e,i,n,s,o,a,l,c){const u=new Float32Array(9);return u[0]=t,u[1]=e,u[2]=i,u[3]=n,u[4]=s,u[5]=o,u[6]=a,u[7]=l,u[8]=c,u}Object.freeze(Object.defineProperty({__proto__:null,clone:Pc,create:ni,fromValues:$c},Symbol.toStringTag,{value:"Module"}));function Sc(t){return t instanceof Float32Array&&t.length>=2}function kc(t){return Array.isArray(t)&&t.length>=2}function Ki(t){return Sc(t)||kc(t)}var fn;const _e=[0,0];let be=fn=class extends yl{constructor(t){super(t),this._viewpoint2D={center:D(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new Qe,this.id=0,this.inverseTransform=ye(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=ye(),this.transformNoRotation=ye(),this.displayMat3=ni(),this.displayViewMat3=ni(),this.viewMat3=ni(),this.viewMat2d=ml(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(t){this._set("pixelRatio",t),this._update()}set size(t){this._set("size",t),this._update()}set viewpoint(t){if(t){const e=this._viewpoint2D,i=t.targetGeometry;e.center[0]=i.x,e.center[1]=i.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=i.spatialReference}this._update()}get visibleArea(){const[t,e]=this.size;return[this.toMap([0,0],0,0),this.toMap([0,0],0,e),this.toMap([0,0],t,e),this.toMap([0,0],t,0)]}copy(t){const e=this.size,i=this.viewpoint;return i&&e?(this.viewpoint=Z(i,t.viewpoint),this._set("size",Et(e,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new fn({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,e,i){return Ki(e)?Pe(t,e,this.inverseTransform):(_e[0]=e,_e[1]=i,Pe(t,_e,this.inverseTransform))}toScreen(t,e,i){return Ki(e)?Pe(t,e,this.transform):(_e[0]=e,_e[1]=i,Pe(t,_e,this.transform))}toScreenNoRotation(t,e,i){return Ki(e)?Pe(t,e,this.transformNoRotation):(_e[0]=e,_e[1]=i,Pe(t,_e,this.transformNoRotation))}wrapMapCoordinate(t,e){Et(t,e);const[i]=e,[n]=this.center,{extent:s,spatialReference:o}=this;let{xmin:a,xmax:l}=s;if(o.isWrappable){const c=ga(o)/2;a=Math.max(a,n-c),l=Math.min(l,n+c)}return(i<a||i>l)&&(t[0]=zn(i,n,o)),t}getScreenTransform(t,e){const{center:i}=this._viewpoint2D,n=this._get("pixelRatio")||1,s=this._get("size");return Gn(t,i,s,e,0,n),t}_update(){const{center:t,spatialReference:e,scale:i,rotation:n}=this._viewpoint2D,s=this._get("pixelRatio")||1,o=this._get("size"),a=new ne({targetGeometry:new L(t[0],t[1],e),scale:i,rotation:n});if(this._set("viewpoint",a),!o||!e||!i)return;this.resolution=yt(a),this.rotation=n,this.scale=i,this.spatialReference=e,Et(this.center,t);const l=o[0]!==0?2/o[0]:0,c=o[1]!==0?-2/o[1]:0;_l(this.displayMat3,l,0,0,0,c,0,-1,1,1);const u=vl(this.viewMat3),p=ms(o[0]/2,o[1]/2),m=ms(-o[0]/2,-o[1]/2),d=Ho(n);ds(u,u,p),wl(u,u,d),ds(u,u,m),bl(this.displayViewMat3,this.displayMat3,u);const g=Zo(this.viewMat2d,p);return Ri(g,g,d),Vt(g,g,m),pc(this.extent,a,o),Wn(this.transform,a,o,s),qo(this.inverseTransform,this.transform),_c(this.transformNoRotation,a,o,s),this.worldScreenWidth=vc(this.spatialReference,this.resolution),this._set("id",this.id+1),this.notifyChange("visibleArea"),this}};r([h({readOnly:!0})],be.prototype,"id",void 0),r([h({value:1,json:{write:!0}})],be.prototype,"pixelRatio",null),r([h({json:{write:!0}})],be.prototype,"size",null),r([h()],be.prototype,"spatialReference",void 0),r([h({type:ne,json:{write:!0}})],be.prototype,"viewpoint",null),r([h({readOnly:!0})],be.prototype,"visibleArea",null),be=fn=r([_("esri.views.2d.ViewState")],be);const Ds=be;var yn,_n;let $e=yn=class extends x{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new yn({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};r([h()],$e.prototype,"left",void 0),r([h()],$e.prototype,"top",void 0),r([h()],$e.prototype,"right",void 0),r([h()],$e.prototype,"bottom",void 0),$e=yn=r([_("esri.views.2d.PaddedViewState.Padding")],$e);let ht=_n=class extends Ds{constructor(...t){super(...t),this.paddedViewState=new Ds,this._updateContent=(()=>{const e=D();return()=>{const i=this._get("size"),n=this._get("padding");if(!i||!n)return;const s=this.paddedViewState;A(e,n.left+n.right,n.top+n.bottom),hn(e,i,e),Et(s.size,e);const o=s.viewpoint;o&&(this.viewpoint=o)}})(),this.addHandles(w((()=>[this.size,this.padding]),(()=>this._updateContent()),Rt)),this.padding=new $e,this.size=[0,0]}set padding(t){this._set("padding",t||new $e)}set viewpoint(t){if(t){this.paddedViewState.viewpoint=t;let e=t;const i=this._get("padding");i&&(e=bc(t.clone(),t,this._get("size"),i));const{targetGeometry:n,rotation:s,scale:o}=e,{x:a,y:l,spatialReference:c}=n,u=this._viewpoint2D;u.center[0]=a,u.center[1]=l,u.rotation=s,u.scale=o,u.spatialReference=c,this._update()}}clone(){return new _n({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};r([h()],ht.prototype,"paddedViewState",void 0),r([h({type:$e})],ht.prototype,"padding",null),r([h()],ht.prototype,"viewpoint",null),ht=_n=r([_("esri.views.2d.PaddedViewState")],ht);const Un=ht;let Cc=class{constructor(e){this.view=e,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this._scheduler=Ml(),this._schedulerHandle=Je((()=>this._scheduler.updating),(()=>this.requestFrame())),this.stationary=!0,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions,this._updateParameters.targetState.copy(this.view.state),this.view.animation?.target==null||Co(this.view.animation.target)||(this._updateParameters.targetState.viewpoint=this.view.animation.target))},this.update=i=>{if(this._updateRequested=!1,this.view?.destroyed)return;const{allLayerViews:n,graphicsView:s,labelManager:o,state:{id:a}}=this.view;n?.forEach(this._updateLayerView,this),o!=null&&(o.lastUpdateId!==a&&(o.viewChange(),o.lastUpdateId=a),o.updateRequested&&o.processUpdate(this._updateParameters)),s!=null&&(s.lastUpdateId!==a&&(s.viewChange(),s.lastUpdateId=a),s.updateRequested&&s.processUpdate(this._updateParameters)),this.view.graphicsTileStore?.setViewState(this._updateParameters.state),this.view.animation?this._scheduler.state=jt.ANIMATING:this.view.interacting?this._scheduler.state=jt.INTERACTING:this._scheduler.state=jt.IDLE,this._scheduler.frame(i)||this._updateRequested||this._scheduler.state!==jt.IDLE||this._frameTaskHandle?.pause()}}destroy(){this.stop(),this._schedulerHandle.remove(),this._scheduler.destroy()}get scheduler(){return this._scheduler}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,targetState:new Un,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=w((()=>e.stationary),(i=>{this.stationary=i,this.requestFrame()})),this._frameTaskHandle=ft(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle?.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){if(!e.attached)return void this.requestUpdate();const i=this.view.state,n=e.lastUpdateId;n!=null&&(this.stationary||e.moving)||(e.moving=!0),n!==i.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=i.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews?.forEach(this._updateLayerView,this)}};function Ec(t,e){const{spatialReference:i}=e,n=[e.x,e.y];let s,o,a,l;const c=[0,0],u=Ic(t);for(let d=0;d<u.length;d++){const g=u[d];for(let v=0;v<g.length-1;v++){Er(c,n,g,v);const f=cl(n,c);(s==null||f<s)&&(s=f,o=[...c],a=d,l=v)}}if(s==null||!o||a==null||l==null)throw new T("nearest-coordinate:failed","Failed to find the nearest coordinate");const[p,m]=o;return{coordinate:new L({x:p,y:m,spatialReference:i}),distance:s}}function Ic(t){switch(t.type){case"extent":return[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]];case"polygon":return t.rings;case"polyline":return t.paths}}var vn;let je=vn=class extends Fn.NumericIdentifiableMixin(x){constructor(t){super(t),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return zt(this.geometry,this.spatialReference)}catch(t){return k.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:t}),null}return this.geometry}constrain(t,e){if(this.normalizedGeometry==null)return t;const i=t.targetGeometry;if(this.normalizedGeometry.type==="extent"?Ln(this.normalizedGeometry,i):Fo(this.normalizedGeometry,i))return t;const{coordinate:n}=Ec(this.normalizedGeometry,i);return n&&(t.targetGeometry=n),t}clone(){return new vn({geometry:this.geometry?.clone(),spatialReference:this.spatialReference?.clone()})}};r([h({constructOnly:!0})],je.prototype,"geometry",void 0),r([h({readOnly:!0})],je.prototype,"normalizedGeometry",null),r([h({constructOnly:!0})],je.prototype,"spatialReference",void 0),je=vn=r([_("esri.views.2d.constraints.GeometryConstraint")],je);var wn;let kt=wn=class extends Fn.NumericIdentifiableMixin(x){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(t,e){return this.enabled&&e&&(this.rotationEnabled||(t.rotation=e.rotation)),t}clone(){return new wn({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};r([h()],kt.prototype,"enabled",void 0),r([h()],kt.prototype,"rotationEnabled",void 0),kt=wn=r([_("esri.views.2d.constraints.RotationConstraint")],kt);const va=kt;var bn;let U=bn=class extends Fn.NumericIdentifiableMixin(x){constructor(t){super(t),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let t,{lods:e,minScale:i,maxScale:n,minZoom:s,maxZoom:o}=this,a=-1,l=-1,c=!1,u=!1;if(i!==0&&n!==0&&i<n&&([i,n]=[n,i]),!e?.length)return this._set("effectiveMinScale",i),void this._set("effectiveMaxScale",n);e=e.map((p=>p.clone())),e.sort(((p,m)=>m.scale-p.scale)),e.forEach(((p,m)=>p.level=m));for(const p of e)!c&&i>0&&i>=p.scale&&(a=p.level,c=!0),!u&&n>0&&n>=p.scale&&(l=t?t.level:-1,u=!0),t=p;s===-1&&(s=i===0?0:a),o===-1&&(o=n===0?e.length-1:l),s=Math.max(s,0),s=Math.min(s,e.length-1),o=Math.max(o,0),o=Math.min(o,e.length-1),s>o&&([s,o]=[o,s]),i=e[s].scale,n=e[o].scale,e.splice(0,s),e.splice(o-s+1),e.forEach(((p,m)=>{this._lodByScale[p.scale]=p,this._scales[m]=p.scale})),this._set("effectiveLODs",e),this._set("effectiveMinZoom",s),this._set("effectiveMaxZoom",o),this._set("effectiveMinScale",i),this._set("effectiveMaxScale",n)}constrain(t,e){if(e&&t.scale===e.scale)return t;const i=this.effectiveMinScale,n=this.effectiveMaxScale,s=t.targetGeometry,o=e&&e.targetGeometry,a=n!==0&&t.scale<n,l=i!==0&&t.scale>i;if(a||l){const c=l?i:n;if(e&&o){const u=(c-e.scale)/(t.scale-e.scale);s.x=o.x+(s.x-o.x)*u,s.y=o.y+(s.y-o.y)*u}t.scale=c}return this.snapToZoom&&this.effectiveLODs&&(t.scale=this._getClosestScale(t.scale)),t}fit(t){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(t,null);const e=this.scaleToZoom(t.scale),i=Math.abs(e-Math.floor(e));return t.scale=this.zoomToScale(i>.99?Math.round(e):Math.floor(e)),t}zoomToScale(t){if(!this.effectiveLODs)return 0;t-=this.effectiveMinZoom,t=Math.max(0,t);const e=this._scales;if(t<=0)return e[0];if(t>=e.length)return e[e.length-1];const i=Math.floor(t),n=Math.ceil(t);return e[i]+(t-i)*(e[n]-e[i])}scaleToZoom(t){if(!this.effectiveLODs)return-1;const e=this._scales;let i,n;if(t>=e[0])return this.effectiveMinZoom;if(t<=e[e.length-1])return this.effectiveMaxZoom;for(let s=0;s<e.length-1;s++){if(i=e[s],n=e[s+1],n===t)return s+this.effectiveMinZoom+1;if(i>t&&n<t)return s+this.effectiveMinZoom+1-(t-n)/(i-n)}return-1}snapToClosestScale(t){if(!this.effectiveLODs)return t;const e=this.scaleToZoom(t);return this.zoomToScale(Math.round(e))}snapToNextScale(t,e=.5){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i+1)}snapToPreviousScale(t,e=2){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i-1)}clone(){return new bn({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(t){return this._lodByScale[t]||(t=this._scales.reduce(((e,i)=>Math.abs(i-t)<=Math.abs(e-t)?i:e),this._scales[0])),this._lodByScale[t].scale}};r([h({readOnly:!0})],U.prototype,"effectiveLODs",void 0),r([h({readOnly:!0})],U.prototype,"effectiveMinZoom",void 0),r([h({readOnly:!0})],U.prototype,"effectiveMaxZoom",void 0),r([h({readOnly:!0})],U.prototype,"effectiveMinScale",void 0),r([h({readOnly:!0})],U.prototype,"effectiveMaxScale",void 0),r([h()],U.prototype,"lods",void 0),r([h()],U.prototype,"minZoom",void 0),r([h()],U.prototype,"maxZoom",void 0),r([h()],U.prototype,"minScale",void 0),r([h()],U.prototype,"maxScale",void 0),r([h()],U.prototype,"snapToZoom",void 0),U=bn=r([_("esri.views.2d.constraints.ZoomConstraint")],U);const wa=U,Rc={base:null,key:"type",typeMap:{extent:Qe,polygon:Eo}};let V=class extends x{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new I}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){return`${this._zoom?.uid}/${this._rotation?.uid}/${this._geometry?.uid}`}get _geometry(){const e=this._get("_geometry");return e&&this.geometry===e.geometry&&this.view?.constraintsInfo.spatialReference===e.spatialReference?e:new je({geometry:this.geometry,spatialReference:this.view?.constraintsInfo.spatialReference})}get _rotation(){return new va({rotationEnabled:this.rotationEnabled})}get _zoom(){const e=this._get("_zoom"),i=this.lods||this.view?.constraintsInfo.lods,n=this.minZoom,s=this.maxZoom,o=this.minScale,a=this.maxScale,l=this.snapToZoom;return e&&e.lods===i&&e.minZoom===n&&e.maxZoom===s&&e.minScale===o&&e.maxScale===a&&e.snapToZoom===l?e:new wa({lods:i,minZoom:n,maxZoom:s,minScale:o,maxScale:a,snapToZoom:l})}canZoomInTo(e){const i=this.effectiveMaxScale;return i===0||e>=i}canZoomOutTo(e){const i=this.effectiveMinScale;return i===0||e<=i}constrain(e,i){return this._zoom.constrain(e,i),this._rotation.constrain(e,i),this._geometry.constrain(e,i),this.customConstraints.forEach((n=>n.constrain(e,i))),e}constrainByGeometry(e){return this._geometry.constrain(e),this.customConstraints.forEach((i=>i.applyPanConstraint?.(e))),e}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};r([h({readOnly:!0})],V.prototype,"effectiveLODs",null),r([h({readOnly:!0})],V.prototype,"effectiveMinScale",null),r([h({readOnly:!0})],V.prototype,"effectiveMaxScale",null),r([h({readOnly:!0})],V.prototype,"effectiveMinZoom",null),r([h({readOnly:!0})],V.prototype,"effectiveMaxZoom",null),r([h({types:Rc,value:null})],V.prototype,"geometry",null),r([h({type:[Or]})],V.prototype,"lods",void 0),r([h()],V.prototype,"minScale",void 0),r([h()],V.prototype,"maxScale",void 0),r([h()],V.prototype,"minZoom",void 0),r([h()],V.prototype,"maxZoom",void 0),r([h()],V.prototype,"rotationEnabled",void 0),r([h()],V.prototype,"snapToZoom",void 0),r([h({type:I})],V.prototype,"customConstraints",void 0),r([h()],V.prototype,"view",void 0),r([h({readOnly:!0})],V.prototype,"version",null),r([h({type:je,readOnly:!0})],V.prototype,"_geometry",null),r([h({type:va})],V.prototype,"_rotation",null),r([h({readOnly:!0,type:wa})],V.prototype,"_zoom",null),V=r([_("esri.views.2d.MapViewConstraints")],V);const Os=V;let H=class extends x{constructor(e){super(e),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([w((()=>this.constraints?.version),(i=>{this.constraints&&i&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))}),Rt)])}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:i}=this.state.paddedViewState;return this.state.commitProperty("id"),new L({x:e[0],y:e[1],spatialReference:i})}set center(e){if(e==null)return;if(!this.ready)return void this._set("center",e);let i;try{i=this._project(e,this.state.spatialReference)}catch(s){return void k.getLogger(this).error(new T("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:s}))}const n=this.viewpoint;gn(n,n,i),this.viewpoint=n}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void k.getLogger(this).error(new T("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let i;try{i=this._project(e,this.state.spatialReference)}catch(s){return void k.getLogger(this).error(new T("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:s}))}const n=this.viewpoint;dc(n,n,i,this.state.size,{constraints:this.constraints}),this.viewpoint=n}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const i=this.viewpoint;xc(i,i,e),this.viewpoint=i}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",void 0);const n=this._get("extent");return void(n&&(this._set("extent",void 0),this._set("center",n.center)))}const i=this.viewpoint;Vs(i,i,e),this.viewpoint=i}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(e){if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let i,n;try{i=this._project(e,this.state.spatialReference),!e.scale||isNaN(e.scale)?n=new T("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):e.targetGeometry==null&&(n=new T("mapview:invalid-viewpoint","geometry not defined"))}catch(o){n=new T("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:o})}if(n)return void k.getLogger(this).error(n);this._scaleBeforeChangingSpatialReference=null;const s=new ne({targetGeometry:new L,scale:0,rotation:0});Z(s,i),this.constraints?.constrain(s,this.state.paddedViewState.viewpoint),this.state.viewpoint=s,this._set("viewpoint",s)}get visibleArea(){return this.ready?this.state.visibleArea:null}get zoom(){return this.ready?this.constraints?.scaleToZoom(this.scale)??-1:this._get("zoom")}set zoom(e){if(!(e>=0))return;if(!this.ready){this._set("zoom",e),this._set("scale",void 0);const s=this._get("extent");return void(s&&(this._set("extent",void 0),this._set("center",s.center)))}const i=this.constraints?.zoomToScale(e)??0;if(!i)return void this._set("zoom",-1);const n=this.viewpoint;Vs(n,n,i),this.viewpoint=n,this._set("zoom",this.constraints?.scaleToZoom(this.scale)??-1)}getUserStartupOptions(e){if(!e[0]&&!e[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:i,constraints:n}=this,s=this._get("center"),o=this._get("extent"),a=this._get("scale"),l=this._get("rotation"),c=this._get("viewpoint"),u=this._get("zoom"),p=u!=null&&n!=null&&n.zoomToScale(u)||void 0;let m,d,g;const v=c?.rotation,f=c?.targetGeometry;f?.type==="extent"?m=f:f?.type==="point"&&(d=f,g=c?.scale);const R=o??m;return{center:s??d??R?.center,rotation:l??v,scale:(a??p??g??(R&&Di(R,[e[0]-i.left-i.right,e[1]-i.top-i.bottom])))||void 0}}startup(e,i,n,s){const o=e.targetGeometry;try{this._project(e,n)}catch(a){k.getLogger(this).warn(new Jn("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:o.toJSON(),spatialReference:n,error:a})),e.targetGeometry=s||new L({x:0,y:0,spatialReference:n})}this.constraints?.fit(e),this._set("state",new Un({padding:this.padding,size:i,viewpoint:e})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[e,i],spatialReference:n,rotation:s,scale:o}=this.state.paddedViewState,a=new L({x:e,y:i,spatialReference:n});this._set("viewpoint",null),this._set("extent",null),this._set("center",a),this._set("zoom",-1),this._set("rotation",s),this._set("scale",o),this._set("state",null)}changeSpatialReference(e){const i=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=i.scale;else{const c=i.viewpoint.clone();c.scale=this._scaleBeforeChangingSpatialReference,i.viewpoint=c}const n=i.clone(),[s,o]=i.center;let a=null;try{a=this._project(new L({x:s,y:o,spatialReference:i.spatialReference}),e)}catch(c){Kr()||k.getLogger(this).warn(new Jn("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:a?.toJSON(),spatialReference:e,error:c}))}a||(a=new L({x:0,y:0,spatialReference:e}));const l=gn(new ne({targetGeometry:new L,scale:0,rotation:0}),i.viewpoint,a);n.viewpoint=l;try{const u=[i.size[0]/2,i.size[1]/2],p=[u[0]+20,u[1]],m=i.toMap([0,0],p),{x:d,y:g}=this._project(new L({x:m[0],y:m[1],spatialReference:i.spatialReference}),e);m[0]=d,m[1]=g,n.toScreen(m,m);const v=wc(u,m,p),f=Math.hypot(m[0]-u[0],m[1]-u[1])/20;!Number.isFinite(f)||Math.abs(f)>4?(l.rotation=0,l.targetGeometry=new L({x:0,y:0,spatialReference:e})):(l.scale*=f,l.scale>z("mapview-srswitch-adjust-rotation-scale-threshold")?l.rotation=0:l.rotation+=Number.isFinite(v)?v:0)}catch{}this._get("constraints")?.constrain(l,void 0),this._get("state").viewpoint=l}resize(e,i){if(!this.ready)return;const n=this.state;let s=this.state.paddedViewState.viewpoint;const o=this.state.paddedViewState.size.slice();n.size=[e,i],Mc(s,s,o,this.state.paddedViewState.size,this.resizeAlign),s=this.constraints?.constrain(s,void 0)??s,this.state.viewpoint=s}toMap(e){if(!this.ready)return null;const i=[0,0],[n,s]=this.state.toMap(i,[e.x,e.y]),o=this.state.spatialReference;return new L({x:n,y:s,spatialReference:o})}toScreen(e,i){if(!this.ready)return null;const n=this._project(e,this.state.spatialReference),s=[n.x,n.y];return i?.pickClosestTarget===!1||this.state.paddedViewState.wrapMapCoordinate(s,s),this.state.toScreen(s,s),F(s[0],s[1])}_project(e,i){const n=e?.targetGeometry||e;if(!i)return e;if(!n)return null;if(i.imageCoordinateSystem||n.spatialReference?.imageCoordinateSystem||ki(i,n.spatialReference))return e;const s=zt(n,i);if(!s)throw new T("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:n,spatialReference:i});return Vc(e)?(e.targetGeometry=s,e):s}};function Vc(t){return t?.declaredClass==="esri.Viewpoint"}r([h({type:L})],H.prototype,"center",null),r([h()],H.prototype,"constraints",void 0),r([h({type:Qe})],H.prototype,"extent",null),r([h({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],H.prototype,"padding",null),r([h()],H.prototype,"ready",void 0),r([h()],H.prototype,"resizeAlign",void 0),r([h({readOnly:!0})],H.prototype,"resolution",null),r([h({type:Number})],H.prototype,"rotation",null),r([h({type:Number})],H.prototype,"scale",null),r([h({readOnly:!0})],H.prototype,"state",void 0),r([h({type:ne})],H.prototype,"viewpoint",null),r([h({readOnly:!0})],H.prototype,"visibleArea",null),r([h()],H.prototype,"zoom",null),H=r([_("esri.views.2d.ViewStateManager")],H);const Ls=160;let Ct=class extends x{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),this._timer==null&&(this._timer=setInterval((()=>{performance.now()-this._timestamp>=Ls&&this.clear()}),Ls))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};r([h()],Ct.prototype,"_timer",void 0),r([h()],Ct.prototype,"stationary",null),Ct=r([_("esri.views.2d.support.StationaryManager")],Ct);const Dc=t=>{let e=class extends t{constructor(...i){super(...i),this.fullOpacity=1,this.stateManager=new H({constraints:new Os({view:this})}),this.stationaryManager=new Ct,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!1,labelsAnimationTime:0,labelCollisionsEnabled:!1},this.frameTask=new Cc(this),this.viewEvents=new Ko(this),this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([w((()=>this.viewpoint),(()=>this.stationaryManager.flip()),Rt)])}get constraintsInfo(){return{lods:null,spatialReference:null}}get extent(){return this.stateManager?.extent??null}set extent(i){this.stateManager.extent=i}get state(){return this.stateManager.state}get interacting(){return!1}get stationary(){return!this.animation&&this.stationaryManager.stationary}set animation(i){const n=this._get("animation");if(i===n)return;if(n&&n.stop(),i!==this.animationManager.animation&&this.animationManager.stop(),!i||i.isFulfilled())return void this._set("animation",null);this._set("animation",i);const s=()=>{this.destroyed||i===this._get("animation")&&(this._set("animation",null),this.frameTask?.requestFrame())};i.when(s,s)}get constraints(){return this.stateManager?.constraints}set constraints(i){i.view=this;const n=this.stateManager.constraints;this.stateManager.constraints=i,n?.destroy()}get padding(){return this.stateManager?.padding}set padding(i){this.stateManager&&(this.stateManager.padding=i)}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(i){this.stateManager.resizeAlign=i}get rotation(){return this.stateManager.rotation??0}set rotation(i){const{rotationEnabled:n}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=i,this.constraints.rotationEnabled=n}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(i){this.stateManager.viewpoint=i,this.frameTask.requestFrame()}};return r([h({readOnly:!0})],e.prototype,"animationManager",void 0),r([h({readOnly:!0})],e.prototype,"fullOpacity",void 0),r([h()],e.prototype,"stateManager",void 0),r([h()],e.prototype,"constraintsInfo",null),r([h()],e.prototype,"extent",null),r([h({readOnly:!0})],e.prototype,"state",null),r([h({readOnly:!0})],e.prototype,"mapViewNavigation",void 0),r([h()],e.prototype,"renderingOptions",void 0),r([h({readOnly:!0})],e.prototype,"interacting",null),r([h()],e.prototype,"stationary",null),r([h()],e.prototype,"animation",null),r([h({type:Os})],e.prototype,"constraints",null),r([h()],e.prototype,"padding",null),r([h()],e.prototype,"resizeAlign",null),r([h()],e.prototype,"rotation",null),r([h({readOnly:!0})],e.prototype,"viewEvents",void 0),r([h({type:ne})],e.prototype,"viewpoint",null),e=r([_("esri.views.Viewport2DBaseMixin")],e),e};let Oe=class extends Vo{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=xi(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),this._resolver?.reject(new T("view:animation-stopped","ViewAnimation stopped")))}finish(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),this._resolver?.resolve())}update(e,i){i||(i=Co(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",i)}};r([h({readOnly:!0})],Oe.prototype,"done",null),r([h({readOnly:!0,type:String})],Oe.prototype,"state",void 0),r([h()],Oe.prototype,"target",void 0),Oe=r([_("esri.views.ViewAnimation")],Oe),(function(t){t.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}})(Oe||(Oe={}));const Mn=Oe;let si=class extends x{constructor(e){super(e),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(e,i){if(!e)return void k.getLogger(this).error("#goTo()","target cannot be null or undefined");const n=new Mn;this.view.animation=n,await Cn((()=>this.view.ready),i);const s={...i,animate:i?.animate??!ta(),animationMode:i?.animationMode??"auto"},{extent:o,spatialReference:a,size:l,viewpoint:c,constraints:u,padding:p,allLayerViews:m}=this.view,d=cc(e,{extent:o,spatialReference:a,size:l,viewpoint:c,constraints:u,padding:p,allLayerViews:m,pickClosestTarget:i?.pickClosestTarget??!0});return n?.update(d),this._gotoTask={},s.animate?this._gotoAnimated(d,s):this._gotoImmediate(d,s)}_gotoImmediate(e,i){const n=this._gotoTask,s=this.view.animation,o=e.then((a=>{if(ze(i),n!==this._gotoTask)throw new T("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=s.target=a,s.finish()}));return this._cancellableGoTo(n,s,o,i)}_gotoAnimated(e,i){const n=this._gotoTask,s=this.view.animation;if(!s)return Promise.resolve();const o=e.then((a=>{if(ze(i),n!==this._gotoTask)throw new T("view:goto-interrupted","Goto was interrupted");return s.update(a),this.view.animationManager.animate(s,this.view.viewpoint,i),s.when().then((()=>{}),(()=>{}))}));return this._cancellableGoTo(n,s,o,i)}_cancellableGoTo(e,i,n,s){const o=()=>e===this._gotoTask;return Pr(n,s).finally((()=>{o()&&(i.done||i.stop())}))}};r([h({constructOnly:!0})],si.prototype,"view",void 0),si=r([_("esri.views.2d.GoToManager")],si);function ba(t,e){switch(e){case"primary":return t.pointerType==="touch"||t.button===0;case"secondary":return t.pointerType!=="touch"&&t.button===2;case"tertiary":return t.pointerType!=="touch"&&t.button===1}}function Ma(t,e){return e.some((i=>ba(t,i)))}function As(t,{dragPrimary:e,dragSecondary:i,dragTertiary:n}){return[{key:"primary",value:e},{key:"secondary",value:i},{key:"tertiary",value:n}].filter((s=>s.value===t)).map((s=>s.key))}let zs=class extends O{constructor(e,i){super(!0),this._view=e,this.registerIncoming("double-click",i,(n=>this._handleDoubleClick(n,i)))}_handleDoubleClick(e,i){ba(e.data,"primary")&&(e.stopPropagation(),i?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},Oc=class extends O{constructor(e,i,n){super(!0),this.view=e,this.pointerType=i,this.registerIncoming("double-tap-drag",n,(s=>this._handleDoubleTapDrag(s)))}_handleDoubleTapDrag(e){const{data:i}=e,{pointerType:n}=i;if(n!==this.pointerType)return;e.stopPropagation();const{action:s,delta:o}=i,{view:a}=this,{mapViewNavigation:l}=a;switch(s){case"begin":{const{scale:c}=a;this._startScale=c,this._currentScale=c,this._previousDelta=o,l.begin();break}case"update":{if(this._previousDelta.y===o.y)return;this._previousDelta=o;const c=1.015**o.y,u=this._startScale*c,p=u/this._currentScale;l.setViewpointImmediate(p),this._currentScale=u;break}case"end":{const{constraints:c}=a,{effectiveLODs:u,snapToZoom:p}=c;if(!p||!u)return void l.end();const m=c.snapScale(this._currentScale),d=(o.y>0?Math.max(m,c.snapToPreviousScale(this._startScale)):Math.min(m,c.snapToNextScale(this._startScale)))/this._currentScale;l.zoom(d).then((()=>{l.end()}));break}}}},Li=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const i=e.data,n=i.pointers.size;switch(i.action){case"start":this._currentCount=n,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=n,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=n,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){this._startEvent=e,this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},Lc=class extends O{constructor(e,i,n){super(!0),this.view=e,this.pointerActions=i,this.registerIncoming("drag",n,(s=>this._handleDrag(s))),this.registerIncoming("pointer-down",(()=>this.stopMomentumNavigation()))}onInstall(e){super.onInstall(e),this._dragEventSeparator=new Li({start:(i,n)=>{this.view.mapViewNavigation.pan.begin(this.view,n.data),n.stopPropagation()},update:(i,n)=>{this.view.mapViewNavigation.pan.update(this.view,n.data),n.stopPropagation()},end:(i,n)=>{this.view.mapViewNavigation.pan.end(this.view,n.data),n.stopPropagation()},condition:(i,n)=>i===1&&Ma(n.data,this.pointerActions)})}_handleDrag(e){const i=this.view.mapViewNavigation;i.pinch.zoomMomentum||i.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},Ac=class extends O{constructor(e,i,n){super(!0),this._view=e,this.pointerActions=i;const s=this._view.mapViewNavigation;this._dragEventSeparator=new Li({start:(o,a)=>{s.rotate.begin(this._view,a.data),a.stopPropagation()},update:(o,a)=>{s.rotate.update(this._view,a.data),a.stopPropagation()},end:(o,a)=>{s.rotate.end(),a.stopPropagation()},condition:(o,a)=>o===1&&Ma(a.data,this.pointerActions)}),this.registerIncoming("drag",n,(o=>this._dragEventSeparator.handle(o)))}};function re(t){let e=t*t;return t<0&&(e*=-1),e}function zc(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function Fc(t,e,i){const n=i,s=t.state,o=t.device,a=e.tiltDirection==="forward-down"?1:-1,l=1;return o.deviceType==="standard"?(n.translation[0]=re(s.axes[0]),n.translation[1]=re(s.axes[1]),n.translation[2]=re(s.buttons[7])-re(s.buttons[6]),n.heading=re(s.axes[2]),n.tilt=re(s.axes[3])):o.deviceType==="spacemouse"&&(n.translation[0]=1.2*re(s.axes[0]),n.translation[1]=1.2*re(s.axes[1]),n.translation[2]=2*-re(s.axes[2]),n.heading=1.2*re(s.axes[5]),n.tilt=1.2*re(s.axes[3])),n.tilt*=a,xl(n.translation,n.translation,l),n}function Nc(t){return t.translation[0]===0&&t.translation[1]===0&&t.translation[2]===0&&t.heading===0&&t.tilt===0&&t.zoom===0}let Hc=class extends O{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new Po,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",(i=>this._handleGamePadEvent(i))),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([w((()=>this._view.navigation.gamepad?.enabled),(i=>{i?(this._handle.resume(),this._frameTask||(this._frameTask=ft({update:n=>this._frameUpdate(n.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))}),G)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const i=this._view.navigation.gamepad.device;i&&e.data.device!==i||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,zc(this._transformation)):(this._currentDevice=e.data.device,Fc(e.data,this._view.navigation.gamepad,this._transformation)),this._frameTask?.resume())}_frameUpdate(e){const i=this._transformation;if(Nc(i))return void this._frameTask?.pause();const n=this._view.viewpoint.clone(),s=this._view.navigation.gamepad.velocityFactor,o=qc*s*e;Oi(n,n,[i.translation[0]*o,-i.translation[1]*o]);const a=1+i.translation[2]*Gc*e,l=this._view.constraints.rotationEnabled?-i.heading*Zc*e:0,c=this._view.size,u=[c[0]/2,c[1]];fa(n,n,a,l,u,c);const p=this._view.constraints.constrain(n,this._view.viewpoint);this._view.viewpoint=p}};const Zc=.06,qc=.7,Gc=6e-4;function xa(t){const e=()=>t(document.visibilityState==="visible");return document.addEventListener("visibilitychange",e),Lt((()=>document.removeEventListener("visibilitychange",e)))}let Wc=class extends O{constructor(e,i,n){super(!0),this.view=e,this.keys=i,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=s=>{const o=this._keyMap[s.data.key];if(s.modifiers.has("Meta")||s.modifiers.has("Control"))return void this._stopMovement();if(o==null)return;s.stopPropagation(),s.preventDefault();const a=s.type==="key-down";if(this._pressedKeys[a?"add":"delete"](o),a){if(this._direction===o)return;this._direction=o,this._isSticky=!1,this._setTimeout((()=>{this._isSticky&&this._handlePopKey()}))}else{const l=this._timeout===void 0,c=this._pressedKeys.size>0;l||c?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),this._direction==null&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[i.left]:"left",[i.right]:"right",[i.up]:"up",[i.down]:"down"},this.registerIncoming("key-down",n,this._handleKey),this.registerIncoming("key-up",n,this._handleKey),this.registerIncoming("blur",n,this._stopMovement),this._visibilityHandle=xa((s=>s?null:this._stopMovement()))}onUninstall(){this._stopMovement(),this._visibilityHandle?.remove()}get _direction(){return this._currentDirection}set _direction(e){const i=this._currentDirection!=null;if(e!=null){if(i||this.view.mapViewNavigation.begin(),this._currentDirection!==e)switch(e){case"left":this.view.mapViewNavigation.continuousPanLeft();break;case"right":this.view.mapViewNavigation.continuousPanRight();break;case"up":this.view.mapViewNavigation.continuousPanUp();break;case"down":this.view.mapViewNavigation.continuousPanDown()}}else i&&this.view.mapViewNavigation.stop();this._currentDirection=e}_setTimeout(e){clearTimeout(this._timeout),this._timeout=e===void 0?void 0:setTimeout((()=>{this._timeout=void 0,e()}),this._stickyKeyDuration)}},Uc=class extends O{constructor(e,i,n){super(!0),this.view=e,this.keys=i,this._keyToDirection=new Map,this._pressed=!1,this._addKeysMapping(i),this.registerIncoming("key-down",n,(s=>this._handleKeyDown(s))),this.registerIncoming("key-up",n,(s=>this._handleKeyUp(s))),this.registerIncoming("blur",n,(()=>this._handleStop())),this._visibilityHandle=xa((s=>s?null:this._handleStop()))}onUninstall(){this._visibilityHandle?.remove(),this._handleStop()}_addKeysMapping(e){this._addKeyMapping(e.clockwise,"clockwise"),this._addKeyMapping(e.counterClockwise,"counterClockwise"),this._addKeyMapping(e.reset,"reset")}_addKeyMapping(e,i){for(const n of e)this._keyToDirection.set(n,i)}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,i){const n=e.modifiers;if(n.size>0&&!n.has("Shift")||!this.view.constraints.rotationEnabled)return;const s=this._keyToDirection.get(e.data.key);if(this._pressed=s!=null,this._pressed){if(e.preventDefault(),i)switch(this.view.mapViewNavigation.begin(),s){case"clockwise":this.view.mapViewNavigation.continuousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continuousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}};var mt;(function(t){t[t.IN=0]="IN",t[t.OUT=1]="OUT"})(mt||(mt={}));let jc=class extends O{constructor(e,i,n){super(!0),this.view=e,this.keys=i,this._keysToZoomAction={},this.registerIncoming("key-down",n,(s=>this._handleKeyDown(s))),i.zoomIn.forEach((s=>this._keysToZoomAction[s]=mt.IN)),i.zoomOut.forEach((s=>this._keysToZoomAction[s]=mt.OUT))}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const i=e.modifiers;if(i.size>0&&!i.has("Shift"))return;const{key:n}=e.data;if(!(n in this._keysToZoomAction))return;const s=this._keysToZoomAction[n],{mapViewNavigation:o}=this.view;let a=null;switch(s){case mt.IN:a=o.zoomIn();break;case mt.OUT:a=o.zoomOut();break;default:return}o.begin(),a.then((()=>o.end())),e.stopPropagation()}};const Bc=.6;let Kc=class extends O{constructor(e,i){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",i,(n=>this._handleMouseWheel(n)))}_handleMouseWheel(e){if(this._view.navigation.actionMap.mouseWheel!=="zoom"||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const i=this._view.mapViewNavigation,{x:n,y:s,deltaY:o}=e.data,a=1/Bc**(1/60*o),l=i.zoom(a,[n,s]);l&&(this._canZoom=!1,l.catch((()=>{})).then((()=>{this._canZoom=!0,i.end()})))}},Yc=class extends O{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",(n=>this._handleDrag(n))),this.registerIncoming("pointer-down",(()=>this._stopMomentumNavigation()));const i=this.view.mapViewNavigation;this._dragEventSeparator=new Li({start:(n,s)=>{i.pinch.begin(this.view,s.data),s.stopPropagation()},update:(n,s)=>{i.pinch.update(this.view,s.data),s.stopPropagation()},end:(n,s)=>{i.pinch.end(this.view),s.stopPropagation()},condition:n=>n>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function Fs(t){const e=t.native;return e?{buttons:e.buttons.map((i=>i.pressed?i.value||1:0)),axes:e.axes.map((i=>Xc(i,t.axisThreshold)))}:{buttons:[],axes:[]}}function Jc(t,e){if(t.axes.length!==e.axes.length||t.buttons.length!==e.buttons.length)return!1;for(let i=0;i<t.axes.length;i++)if(t.axes[i]!==e.axes[i])return!1;for(let i=0;i<t.buttons.length;i++)if(t.buttons[i]!==e.buttons[i])return!1;return!0}function Qc(t){for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==0)return!1;for(let e=0;e<t.buttons.length;e++)if(t.buttons[e]!==0)return!1;return!0}function Xc(t,e){const i=Math.abs(t);return i<e?0:Math.sign(t)*(i-e)/(1-e)}let eu=class{constructor(e,i){this._element=e,this._input=i,this._hasEventListeners=!1,this._onConnectGamepad=o=>{this._connectGamepad(o.gamepad)},this._onDisconnectGamepad=o=>{const a=o.gamepad,l=a.index,c=this._inputDevices[l];c&&(this._emitGamepadEvent(a,Fs(c),!1),this._inputDevices.splice(l,1),this._latestUpdate.splice(l,1),this._input.gamepad.devices.remove(c),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const n="getGamepads"in window.navigator,s=window.isSecureContext;this.supported=n&&s,this.supported&&(Ns((o=>this._connectGamepad(o))),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const i=new Nn(e);i.deviceType!=="unknown"&&(this._inputDevices[e.index]=i,this._input.gamepad.devices.add(i)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=ft({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),i=this._element.contains(document.activeElement),n=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!i;Ns((s=>{const o=this._inputDevices[s.index];if(!o)return;const a=this._latestUpdate[s.index],l=Fs(o),c=n||Qc(l);a&&(a.timestamp===s.timestamp||!a.active&&c||Jc(a.state,l))||this._emitGamepadEvent(s,l,!c)}))}_emitGamepadEvent(e,i,n){const s=this._latestUpdate[e.index],o=s&&s.active;if(!o&&!n)return;const a=!o&&n?"start":o&&n?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:i,active:n},this._callback&&this._callback({device:this._inputDevices[e.index],state:i,action:a})}};function tu(t){if(!t||!t.connected)return!1;for(let e=0;e<t.axes.length;e++)if(isNaN(t.axes[e]))return!1;return!0}function Ns(t){for(const e of navigator.getGamepads())tu(e)&&t(e)}const Hs=z("edge"),iu=z("chrome"),nu=z("ff"),su=z("safari"),Zs="esri-view-surface",nt={touchNone:`${Zs}--touch-none`,touchPan:`${Zs}--touch-pan`};var Ye;let ou=(Ye=class{constructor(e,i){this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new eu(e,i),this._gamepadSource.onEvent=n=>this._callback("gamepad",n)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach((e=>this._releasePointerCaptureSafe(e))),this._activePointerCaptures.clear(),this._gamepadSource=le(this._gamepadSource),this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const i in this._active)if(!e||!e.has(i)){const n=this._active[i];this._element.removeEventListener(Yi[i],n),delete this._active[i]}e&&e.forEach((i=>{if(!this._active[i]&&Yi[i]){const n=(this._eventHandlers[i]||this._handleDefault).bind(this,i);this._element.addEventListener(Yi[i],n),this._active[i]=n}})),this._gamepadSource&&(this._gamepadSource.hasEventListeners=e?.has("gamepad")??!1)}setPointerCapture(e,i){i?this._setPointerCaptureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?nt.touchNone:nt.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?nt.touchPan:nt.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(nt.touchNone),this._element.classList.remove(nt.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCaptureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,i){const n=Jo(this._element,e);return Ye.test.disableSubpixelCoordinates&&(n.x=Math.round(n.x),n.y=Math.round(n.y)),i.x=n.x,i.y=n.y,i}_handleKey(e,i){const{key:n}=i;n&&e==="key-up"&&this._keyDownState.delete(n);const s={native:i,key:n,repeat:!!n&&this._keyDownState.has(n)};n&&e==="key-down"&&this._keyDownState.add(s.key),this._callback(e,s)}_handlePointer(e,i){const n=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});this._callback(e,n)}_handlePointerPreventDefault(e,i){const n=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});i.preventDefault(),this._callback(e,n)}_getDeltaFromTrackpadOrMouseWheel(e){return e.shiftKey&&z("mac")&&e.deltaY===0?e.deltaX:e.deltaY}_handleMouseWheel(e,i){let n=this._getDeltaFromTrackpadOrMouseWheel(i);switch(i.deltaMode){case 0:Hs&&(n=n/document.documentElement.clientHeight*600);break;case 1:n*=30;break;case 2:n*=900}Hs?n*=.7:iu||su?n*=.6:nu&&(n*=1.375);const s=100,o=Math.abs(n);o>s&&(n=n/o*200/(1+Math.exp(-.02*(o-s))));const a=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,deltaY:n});this._callback(e,a)}_handlePointerCaptureLost(e,i){this._activePointerCaptures.delete(i.pointerId),this._handleDefault(e,i)}_handleDefault(e,i){const n={native:i};i.preventDefault(),this._callback(e,n)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}},Ye.test={disableSubpixelCoordinates:!1},Ye);const Yi={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let au=class extends O{constructor(){super(!0),this.registerIncoming("context-menu",(e=>e.data.native.preventDefault()))}};const Ta=()=>({maximumClickDelay:300}),ru=(t={})=>({...Ta(),movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,...t}),jn=(t={})=>({...Ta(),maximumDoubleClickDistance:10,maximumDoubleTouchDistance:35,maximumDoubleClickDelay:250,maximumDoubleTouchDelay:350,...t});function pi(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function lu(t,e){const i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)}function hu(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:F()},t.length===0)return e;if(t.length===1)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(t.length===2){const[S,N]=t,[C,K]=[N.x-S.x,N.y-S.y];return e.radius=Math.sqrt(C*C+K*K)/2,e.center.x=(S.x+N.x)/2,e.center.y=(S.y+N.y)/2,e}let i=0,n=0;for(let S=0;S<t.length;S++)i+=t[S].x,n+=t[S].y;i/=t.length,n/=t.length;const s=t.map((S=>S.x-i)),o=t.map((S=>S.y-n));let a=0,l=0,c=0,u=0,p=0,m=0,d=0;for(let S=0;S<s.length;S++){const N=s[S],C=o[S],K=N*N,ue=C*C;a+=K,l+=ue,c+=N*C,u+=K*N,p+=ue*C,m+=N*ue,d+=C*K}const g=.5*(u+m),v=.5*(p+d),f=a*l-c*c,R=(g*l-v*c)/f,P=(a*v-c*g)/f,ce=F(R+i,P+n);return{radius:Math.sqrt(R*R+P*P+(a+l)/t.length),center:ce}}function Be(t){const{native:e}=t,{pointerId:i,button:n,pointerType:s}=e;return s==="mouse"?`${i}:${n}`:`${s}`}let cu=class extends O{constructor(e={},i=At){super(!1),this._clock=i,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=F(0,0),this._pointerState=new Map,this._parameters=jn(e),this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new Li({start:(n,s)=>this._dragStart(n,s),update:(n,s)=>this._dragUpdate(s),end:(n,s)=>this._dragEnd(s)}),this.registerIncoming("drag",(n=>this._dragEventSeparator.handle(n))),this.registerIncoming("pointer-down",(n=>this._handlePointerDown(n))),this.registerIncoming("pointer-up",(()=>this._handlePointerUp()))}onUninstall(){this._pointerState.forEach((e=>{e.doubleTapTimeout=he(e.doubleTapTimeout)}))}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleTapTimeout!=null)return!0;return!1}_clearPointerDown(e){const i=this._pointerState.get(e);i&&(i.doubleTapTimeout=he(i.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_dragStart(e,i){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:n,modifiers:s}=i,{center:o}=n;this._dragStartCenter=o;const a=Ji("begin",F(0,0),n);this._doubleTapDrag.emit(a,void 0,s),i.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:i,modifiers:n}=e,{center:s}=i,o=Ji("update",F(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),i);this._doubleTapDrag.emit(o,void 0,n),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:i,modifiers:n}=e,{center:s}=i,o=Ji("end",F(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),i);this._doubleTapDrag.emit(o,void 0,n),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:i}=e,n=Be(i),s=this._pointerState.get(n),{pointerType:o}=i.native;if(s){const a=o==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;this._clearPointerDown(n),pi(s.event.data,i)>a?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:i}=e,{pointerType:n}=i.native,s=Be(i),o=n==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,a=this._clock.setTimeout((()=>this._clearPointerDown(s)),o);this._pointerState.set(s,{event:e,doubleTapTimeout:a}),this.refreshHasPendingInputs()}};function Ji(t,e,i){const{button:n,buttons:s,pointer:o,pointers:a,pointerType:l,timestamp:c}=i;return{action:t,delta:e,button:n,buttons:s,pointer:o,pointers:a,pointerType:l,timestamp:c}}let uu=class extends O{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,i,n,s){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:i.buttons,timestamp:s,pointers:pu(this._activePointerMap),pointer:i,angle:n.angle,radius:n.radius,center:n.center}}_addPointer(e){const i=e.native.pointerId,n=Yt(this._activePointerMap).angle,s={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(i,s);const o=oi(s,Pa(this._activePointerMap));s.initialAngle=o,s.lastAngle=o,this._updatePointerAngles(n)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const i=e.native.pointerId,n=this._activePointerMap.get(i);n?n.event=e:this._addPointer(e)}_removePointer(e){const i=Yt(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(i)}_updatePointerAngles(e){const i=Yt(this._activePointerMap);this._activePointerMap.forEach((n=>{n.initialAngle=oi(n,i)-e,n.lastAngle=oi(n,i)-e}))}_emitEvent(e,i,n){const s=Yt(this._activePointerMap);this._drag.emit(this._createPayload(e,i,s,n),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const i=e.data.native.pointerId,n=se(e.timestamp);this._activePointerMap.get(i)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,n),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(i)):(this._removePointer(i),this._emitEvent("removed",e.data,se(e.timestamp))))}_handlePointerDrag(e){const i=e.data,n=i.currentEvent,s=se(e.timestamp);switch(i.action){case"start":case"update":this._isDragging?this._activePointerMap.has(n.native.pointerId)?(this._updatePointer(n),!this._isCurrentDragSuppressed&&this._emitEvent("update",n,s)):(this._addPointer(n),this._emitEvent("added",n,s),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(n),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",n,s))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function Pa(t){const e=[];return t.forEach((i=>{e.push(F(i.event.x,i.event.y))})),hu(e)}function Yt(t){const e=Pa(t);let i=0;return t.forEach((n=>{let s=oi(n,e),o=s-n.lastAngle;for(;o>Math.PI;)o-=2*Math.PI;for(;o<-Math.PI;)o+=2*Math.PI;s=n.lastAngle+o,n.lastAngle=s;const a=s-n.initialAngle;i+=a})),i/=t.size||1,{angle:i,radius:e.radius,center:e.center}}function pu(t){const e=new Map;return t.forEach(((i,n)=>e.set(n,i.event))),e}function oi(t,e){const i=t.event,n=i.x-e.center.x,s=i.y-e.center.y;return Math.atan2(s,n)}var qs;(function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined"})(qs||(qs={}));let du=class extends O{constructor(e={},i=At){super(!1),this._clock=i,this._pointerState=new Map,this._parameters=jn(e),this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach((e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()})),super.onUninstall()}_handlePointerDown(e){const i=e.data,n=Be(i);if(!this._pointerState.has(n)){const s={downButton:i.native.button,x:i.x,y:i.y,immediateDoubleClick:null};this._pointerState.set(n,s),this.startCapturingPointer(i.native)}}_handlePointerUp(e){const i=e.data,n=Be(i),s=this._pointerState.get(n);if(s&&s.downButton===i.native.button){const o=s.immediateDoubleClick,a=e.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;o?(o.timeoutHandle.remove(),pi(o,e.data)>a?this._startImmediateDoubleClick(e,s):(this._immediateDoubleClick.emit(e.data,void 0,o.modifiers),this._removeState(i))):pi(s,e.data)>a?this._removeState(i):this._startImmediateDoubleClick(e,s)}}_startImmediateDoubleClick(e,i){const n=e.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay;i.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout((()=>this._removeState(e.data)),n)}}_removeState(e){const i=Be(e);this._pointerState.delete(i),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}},mu=class extends O{constructor(e={},i=At){super(!1),this._clock=i,this._pointerState=new Map,this._parameters=ru(e),this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",(n=>this._handlePointerDown(n))),this.registerIncoming("pointer-up",(n=>this._handlePointerLoss(n,"pointer-up"))),this.registerIncoming("pointer-capture-lost",(n=>this._handlePointerLoss(n,"pointer-capture-lost"))),this.registerIncoming("pointer-cancel",(n=>this._handlePointerLoss(n,"pointer-cancel"))),this._moveHandle=this.registerIncoming("pointer-move",(n=>this._handlePointerMove(n))),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach((e=>{e.holdTimeout=he(e.holdTimeout)})),super.onUninstall()}_handlePointerDown(e){const i=e.data,n=i.native.pointerId;let s=null;this._pointerState.size===0&&(s=this._clock.setTimeout((()=>{const a=this._pointerState.get(n);if(a){if(!a.isDragging){const l=a.previousEvent;this._pointerHold.emit(l,void 0,e.modifiers),a.holdEmitted=!0}a.holdTimeout=null}}),this._parameters.holdDelay));const o={startEvent:i,previousEvent:i,startTimestamp:e.timestamp,isDragging:!1,downButton:i.native.button,holdTimeout:s,modifiers:new Set};this._pointerState.set(n,o),this.startCapturingPointer(i.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_handlePointerMove(e){const i=e.data,n=i.native.pointerId,s=this._pointerState.get(n);s&&(s.isDragging?this._pointerDrag.emit(Jt("update",s,i),void 0,s.modifiers):lu(i,s.startEvent)>this._getDragThreshold(i.native.pointerType)&&this._startDragging(e),s.previousEvent=i)}_getDragThreshold(e){switch(e){case"touch":return this._parameters.movementUntilTouchDrag;case"pen":return this._parameters.movementUntilPenDrag;default:return this._parameters.movementUntilMouseDrag}}_startDragging(e){const i=e.data,n=i.native.pointerId;this._pointerState.forEach((s=>{s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging||(s.modifiers=e.modifiers,s.isDragging=!0,n===s.startEvent.native.pointerId?this._pointerDrag.emit(Jt("start",s,i)):this._pointerDrag.emit(Jt("start",s,s.previousEvent),e.timestamp))}))}_handlePointerLoss(e,i){const n=e.data,s=n.native.pointerId,o=this._pointerState.get(s);o&&(o.holdTimeout!=null&&(o.holdTimeout.remove(),o.holdTimeout=null),o.isDragging?this._pointerDrag.emit(Jt("end",o,i==="pointer-up"?n:o.previousEvent),void 0,o.modifiers):i==="pointer-up"&&o.downButton===n.native.button&&e.timestamp-o.startTimestamp<=this._parameters.maximumClickDelay&&!o.holdEmitted&&this._immediateClick.emit(n),this._pointerState.delete(s),this.stopCapturingPointer(n.native),this._pointerState.size===0&&this._moveHandle.pause())}};function Jt(t,e,i){return{action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:i}}let gu=class extends O{constructor(e={},i=At){super(!1),this._clock=i,this._pointerState=new Map,this._parameters=jn(e),this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",(n=>this._handleImmediateClick(n))),this.registerIncoming("pointer-down",(n=>this._handlePointerDown(n)))}onUninstall(){this._pointerState.forEach((e=>e.doubleClickTimer=he(e.doubleClickTimer)))}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleClickTimer!=null)return!0;return!1}_clearDoubleClickTimer(e,i){const n=this._pointerState.get(e);n&&(n.doubleClickTimer=he(n.doubleClickTimer),i&&this._click.emit(n.event.data,void 0,n.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const i=this._pointerState.get(e);i.pointerDownCount===1&&this._click.emit(i.event.data,void 0,i.event.modifiers),i.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_handleImmediateClick(e){const i=e.data,{pointerType:n}=i.native,s=fu(i);if(!this._pointerState.has(s))return void this._startClick(e);const o=this._pointerState.get(s),{data:a,modifiers:l}=o.event,c=n==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;pi(a,i)>c?(this._clearDoubleClickTimer(s,!0),this._startClick(e)):(this._clearDoubleClickTimer(s,!1),o.pointerDownCount===2&&this._doubleClick.emit(a,void 0,l))}_handlePointerDown(e){const i=Be(e.data),n=this._pointerState.get(i);n&&(n.pointerDownCount+=1)}_startClick(e){const{data:i}=e,{native:{pointerType:n}}=i,s=Be(i),o=n==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,a=this._clock.setTimeout((()=>this._doubleClickTimeoutExceeded(s)),o);this._pointerState.set(s,{event:e,doubleClickTimer:a,pointerDownCount:1}),this.refreshHasPendingInputs()}};function fu(t){const{pointerId:e,pointerType:i,button:n}=t.native;return i==="mouse"?`${e}:${n}`:`${i}`}const Qt={counter:"Control",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwise:["a","A"],counterClockwise:["d","D"],reset:["n","N"]}},Gs=Symbol("handles");let qe=class extends x{initialize(){const e=()=>this.view?.ready;this.addHandles([Je((()=>!e()),(()=>this._disconnect())),Je(e,(()=>this._connect()))])}destroy(){this._disconnect()}get latestPointerType(){return this._inputManager?.latestPointerType}get latestPointerLocation(){return this._inputManager?.latestPointerLocation}get multiTouchActive(){return this._inputManager?.multiTouchActive??!1}isModifierKeyDown(e){return this._inputManager?.isModifierKeyDown(e)??!1}_disconnect(){this.view.viewEvents.disconnect(),this.removeHandles(Gs),this._inputManager=le(this._inputManager)}_connect(){const e=this.view.surface,i=new ou(e,this.view.input),n=[new du,new mu,new gu,new uu(this.view.navigation),new cu],s=new ee({eventSource:i,recognizers:n}),o=new Lc(this.view,["primary"]),a=new Ac(this.view,["secondary"]);s.installHandlers("prevent-context-menu",[new au],Se.INTERNAL),s.installHandlers("navigation",[new Yc(this.view),new Hc(this.view),new Kc(this.view),new zs(this.view),new zs(this.view,[Qt.counter]),o,new Wc(this.view,Qt.pan),new jc(this.view,Qt.zoom),new Uc(this.view,Qt.rotate),a,new Oc(this.view,"touch")],Se.INTERNAL),this.view.viewEvents.connect(s),this._source=i,this._inputManager=s,this.addHandles([w((()=>this.view?.navigation?.browserTouchPanEnabled),(l=>{this._source&&(this._source.browserTouchPanningEnabled=!l)}),G),w((()=>{const{actionMap:l}=this.view.navigation;return{panActions:As("pan",l),rotateActions:As("rotate",l)}}),(({panActions:l,rotateActions:c})=>{o.pointerActions=l,a.pointerActions=c}),ie)],Gs)}get test(){}};r([h()],qe.prototype,"view",void 0),r([h()],qe.prototype,"latestPointerType",null),r([h()],qe.prototype,"latestPointerLocation",null),r([h()],qe.prototype,"multiTouchActive",null),qe=r([_("esri.views.2d.input.MapViewInputManager")],qe);const yu=qe,_u=t=>{let e=class extends t{constructor(...i){super(...i),this.goToManager=new si({view:this}),this.inputManager=new yu({view:this}),this.addHandles([this.on("resize",(n=>this.stateManager.resize(n.width,n.height)))])}get interacting(){return this.navigating}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}on(i,n,s,o){return this.inputManager&&this.viewEvents.on(i,n,s,o)||super.on(i,n)}hasEventListener(i){return super.hasEventListener(i)||this.viewEvents.hasHandler(i)}goTo(i,n){return this.goToManager.goTo(i,n)}toMap(i){if(!this.ready)return null;const n=Xo(i)?Qo(this,i):i;return this.stateManager.toMap(n)}};return r([h()],e.prototype,"goToManager",void 0),r([h({readOnly:!0})],e.prototype,"interacting",null),r([h()],e.prototype,"stationary",null),r([h({readOnly:!0})],e.prototype,"inputManager",void 0),e=r([_("esri.views.Viewport2DMixin")],e),e};let Ws=class{constructor(e){this._view=e,this.viewpoint=new ne({targetGeometry:new L,scale:0,rotation:0})}get view(){return this._view}get size(){const[e,i]=this._view.size;return Math.sqrt(e*e+i*i)}get scale(){return this.viewpoint.scale}get rotation(){return this.viewpoint.rotation}get center(){return this.viewpoint.targetGeometry}get scaleToResolutionFactor(){return ma(this.center.spatialReference)}pixelsPerPanAtZoom(e){return 1/(e*this.scaleToResolutionFactor)}zoomAtPixelsPerPan(e){return 1/(e*this.scaleToResolutionFactor)}pixelsPerRotate(){return this.size/2}compareTo(e,i){i.pan=Yr(this.center,e.center);let n=Math.abs(e.rotation-this.rotation);n=n>=180?360-n:n,i.rotate=Ei(n),i.sourceZoom=this.scale,i.targetZoom=e.scale}interpolate(e,i,n){const{pan:s,rotate:o,zoom:a,zoomOffset:l}=n,{center:c}=this;c.spatialReference=e.center.spatialReference,c.x=Ut(e.center.x,i.center.x,s),c.y=Ut(e.center.y,i.center.y,s),this.viewpoint.scale=Ut(e.scale,i.scale+l,a);let u=e.rotation;const p=i.rotation;Math.abs(p-u)>=180&&(u+=360*(u<p?1:-1)),this.viewpoint.rotation=Ut(u,p,o)}copyFrom(e){Z(this.viewpoint,e.viewpoint),this._view=e.view}};const vu=t=>t,Ot=t=>t*t,di=t=>1-Ot(1-t),Us=t=>t<.5?Ot(2*t)/2:(di(2*(t-.5))+1)/2,mi=t=>t*t*t,xn=t=>1-mi(1-t),js=t=>t<.5?mi(2*t)/2:(xn(2*(t-.5))+1)/2,gi=t=>t*t*t*t,Tn=t=>1-gi(1-t),Bs=t=>t<.5?gi(2*t)/2:(Tn(2*(t-.5))+1)/2,fi=t=>t*t*t*t*t,Pn=t=>1-fi(1-t),Ks=t=>t<.5?fi(2*t)/2:(Pn(2*(t-.5))+1)/2,yi=t=>1-Math.cos(t*Math.PI/2),$n=t=>1-yi(1-t),Ys=t=>t<.5?yi(2*t)/2:($n(2*(t-.5))+1)/2,_i=t=>2**(10*(t-1)),vi=t=>1-_i(1-t),Js=t=>t<.5?_i(2*t)/2:(vi(2*(t-.5))+1)/2,wi=t=>-(Math.sqrt(1-t*t)-1),Sn=t=>1-wi(1-t),Qs=t=>t<.5?wi(2*t)/2:(Sn(2*(t-.5))+1)/2;function oe(t){const e=2*(t-Math.sqrt((t-1)*t)),i=e/2/t;return n=>n<i?t*n*n:e*n-e+1}function ae(t,e){return(i,n)=>i<e?e*t(i/e,n):1-t((1-i)/(1-e),n)*(1-e)}const Xs=ae(oe(1),1),eo=ae(oe(1),0),bi=ae(oe(1),.5),to=ae(oe(2),1),io=ae(oe(2),0),no=ae(oe(2),.5),so=ae(oe(3),1),oo=ae(oe(3),0),ao=ae(oe(3),.5),ro=ae(oe(4),1),lo=ae(oe(4),0),ho=ae(oe(4),.5),co={linear:vu,"in-quad":Ot,"out-quad":di,"in-out-quad":Us,"in-coast-quad":Xs,"out-coast-quad":eo,"in-out-coast-quad":bi,"in-cubic":mi,"out-cubic":xn,"in-out-cubic":js,"in-coast-cubic":to,"out-coast-cubic":io,"in-out-coast-cubic":no,"in-quart":gi,"out-quart":Tn,"in-out-quart":Bs,"in-coast-quart":so,"out-coast-quart":oo,"in-out-coast-quart":ao,"in-quint":fi,"out-quint":Pn,"in-out-quint":Ks,"in-coast-quint":ro,"out-coast-quint":lo,"in-out-coast-quint":ho,"in-sine":yi,"out-sine":$n,"in-out-sine":Ys,"in-expo":_i,"out-expo":vi,"in-out-expo":Js,"in-circ":wi,"out-circ":Sn,"in-out-circ":Qs,"quad-in":Ot,"quad-out":di,"quad-in-out":Us,"quad-in-coast":Xs,"quad-out-coast":eo,"quad-in-out-coast":bi,"cubic-in":mi,"cubic-out":xn,"cubic-in-out":js,"cubic-in-coast":to,"cubic-out-coast":io,"cubic-in-out-coast":no,"quart-in":gi,"quart-out":Tn,"quart-in-out":Bs,"quart-in-coast":so,"quart-out-coast":oo,"quart-in-out-coast":ao,"quint-in":fi,"quint-out":Pn,"quint-in-out":Ks,"quint-in-coast":ro,"quint-out-coast":lo,"quint-in-out-coast":ho,"sine-in":yi,"sine-out":$n,"sine-in-out":Ys,"expo-in":_i,"expo-out":vi,"expo-in-out":Js,"circ-in":wi,"circ-out":Sn,"circ-in-out":Qs,ease:t=>Bt.ease(t),"ease-in":t=>Bt.easeIn(t),"ease-out":t=>Bt.easeOut(t),"ease-in-out":t=>Bt.easeInOut(t)};let wu=class{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}};const Mi={desiredScreenFlow:2,minDuration:se(500),maxDuration:se(8e3)},$a={maxDuration:se(4e3)};let bu=class Sa{constructor(e){this._createCamera=e,this.compared=new wu,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:Mi.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const e=new Sa(this._createCamera);return e.copyFrom(this),e}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,i,n){this.source!==e&&this.source.copyFrom(e),this.target!==i&&this.target.copyFrom(i),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=n.desiredScreenFlow??Mi.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const i=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/i}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>Fi()}get hasFov(){return Math.abs(this.compared.fov)>Fi()}get hasRotate(){return this.compared.rotate>Fi()}},Mu=class{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}},xu=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce(((e,i)=>X(e+i.time)),X(0))}interpolateComponentsAt(e,i){e=Math.min(Math.max(e,0),1),e*=this.time;let n=0,s=0;const o=this.definition,a=this.segments.reduce(((l,c)=>l||c.definition.hasZoom),!1);for(let l=0;l<this.segments.length;l++){const c=this.segments[l],u=c.definition;if(e<=c.time||l===this.segments.length-1){if(this.segmentInterpolateComponentsAt(c,c.time===0?0:e/c.time,i),o.hasPan&&!isNaN(i.pan)&&isFinite(o.compared.pan)?i.pan=(n+u.compared.pan*i.pan)/o.compared.pan:i.pan=1,o.hasRotate&&!isNaN(i.rotate)&&isFinite(o.compared.rotate)?i.rotate=(s+u.compared.rotate*i.rotate)/o.compared.rotate:i.rotate=1,a&&!isNaN(i.zoom)&&isFinite(u.compared.targetZoom)){const{sourceZoom:p,targetZoom:m}=u.compared,d=i.zoom*(m-p)+p,g=this.segments[0].definition.compared.sourceZoom,v=this.segments[this.segments.length-1].definition.compared.targetZoom,f=Math.abs(m-g)>Math.abs(p-g)?m:p;i.zoomOffset=f-v,i.zoom=(d-g)/(f-g)}else i.zoom=1;return i}e-=c.time,n+=u.compared.pan,s+=u.compared.rotate}}segmentInterpolateComponentsAt(e,i,n){e.interpolateComponentsAt(i,n)}},Qi=class{get time(){return this._time}constructor(e){e&&this.update(e)}update(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const e=this.definition,i=e.compared,n=i.sourceZoom,s=i.targetZoom;this._zoomSign=n>s?1:-1,this._panPixelsAtSource=i.pan*e.source.pixelsPerPanAtZoom(n);const o=(e.source.pixelsPerRotate()+e.target.pixelsPerRotate())/2;this._rotatePixels=i.rotate*o}_updatePixelFlow(){const e=this.definition.compared.sourceZoom,i=this.definition.compared.targetZoom,{hasZoom:n,hasPan:s,hasRotate:o}=this.definition;let a=0,l=0;n&&(s&&(a=(i/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),o&&(l=this._zoomSign*(Math.log(e/i)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const c=this.definition.desiredPixelFlow;if(n&&s&&o){const u=a+l+a*l;this._zoomPixelFlow=a*l/u*c,this._panPixelFlow=l/u*c,this._rotatePixelFlow=a/u*c}else if(n&&s){const u=1+a;this._zoomPixelFlow=a/u*c,this._panPixelFlow=1/u*c}else if(n&&o){const u=1+l;this._zoomPixelFlow=l/u*c,this._rotatePixelFlow=1/u*c}else if(s&&o){const u=this._panPixelsAtSource/this._rotatePixels,p=1+u;this._panPixelFlow=u/p*c,this._rotatePixelFlow=1/p*c}else s?this._panPixelFlow=c:n?this._zoomPixelFlow=c:o&&(this._rotatePixelFlow=c);if(this._time=X(Math.max(this.rotateTime,this.zoomTime,this.panTime)),this.fovTime>this._time){const u=this.fovTime/this._time;this._time=this.fovTime,this._zoomPixelFlow/=u,this._panPixelFlow/=u,this._rotatePixelFlow/=u}}get rotateTime(){return this.definition.hasRotate?X(this._rotatePixels/this._rotatePixelFlow):X(0)}get zoomTime(){return this.definition.hasZoom?X(this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow):X(0)}get fovTime(){return this.definition.hasFov?X(Math.abs(this.definition.compared.fov)/Tu):X(0)}get panTime(){if(!this.definition.hasPan)return X(0);if(this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,i=e*this._panPixelsAtSource;return X(Math.log(i*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow))}return X(this._panPixelsAtSource/this._panPixelFlow)}_interpolateComponentsZoom(e){if(e===0||e===1)return e;if(this.definition.hasZoom){const i=this.definition.compared.sourceZoom,n=this.definition.compared.targetZoom;return(i*(i/n)**-e-i)/(n-i)}return e}_interpolateComponentsFov(e){if(e===0)return this.definition.segmentStart;if(e===1)return this.definition.segmentEnd;if(this.definition.hasFov){const{segmentStart:i,segmentEnd:n}=this.definition;return i+e*(n-i)}return this.definition.segmentStart}_interpolateComponentsPan(e){if(e===0||e===1)return e;if(this.definition.hasPan&&this.definition.hasZoom){const i=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(i*e*this._time)-1))/(i*Math.LN2)}return e}_interpolateComponentsRotate(e){return e}interpolateComponentsAt(e,i){e=Math.min(Math.max(e,0),1),i.zoom=this._interpolateComponentsZoom(e),i.pan=this._interpolateComponentsPan(e),i.rotate=this._interpolateComponentsRotate(e),i.zoomOffset=0,i.fov=this._interpolateComponentsFov(e)}};const Tu=Ei(45);function Pu(t,e,i){const n=e-t.compared.sourceZoom,s=t.halfWindowPanAtZoom(n);return-t.halfWindowSize*(i.ascensionFactor*Math.LN2*t.compared.pan+s)*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2*s)}function $u(t,e,i){const n=1/e,s=Math.log(t.compared.sourceZoom*n),o=1/t.desiredPixelFlow,a=1/Math.LN2,l=e-t.compared.sourceZoom,c=1/l,u=(i.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(l))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*n*o*a*c*u-t.halfWindowSize*s*o*a*c+t.halfWindowSize*s*o*a*u/(l*l)}function Su(t,e,i){const n=e-t.compared.sourceZoom,s=1/n,o=1/e,a=Math.log(t.compared.sourceZoom*o),l=(i.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(n))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*s*(-2*s*o*l+2*s*a+2*o-2*a*l/(n*n)-l/(e*e))/(t.desiredPixelFlow*Math.LN2)}function ku(t,e){return-t.halfWindowSize*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2)}function Cu(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function Eu(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function Iu(t,e,i){return-t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e))}function Ru(t,e,i){return t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e))}function Vu(t,e,i){return-2*t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e*e))}function Du(t,e,i){return t.halfWindowSize*(-t.halfWindowPanAtZoom(e)-i.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*t.halfWindowPanAtZoom(-e+t.compared.targetZoom))}function Ou(t,e,i){const n=Math.log(e/t.compared.targetZoom),s=1/t.desiredPixelFlow,o=1/Math.LN2,a=-e+t.compared.targetZoom,l=1/a,c=(-t.halfWindowPanAtZoom(e)-i.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return-t.halfWindowSize*n*s*o*l+t.halfWindowSize*n*s*o*c/(a*a)+t.halfWindowSize*s*o*l*c/e}function Lu(t,e,i){const n=e-t.compared.targetZoom,s=1/n,o=1/e,a=Math.log(e/t.compared.targetZoom),l=(t.halfWindowPanAtZoom(e)+i.descensionFactor*Math.LN2*t.compared.pan-t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*s*(-2*s*o*l-2*s*a+2*o+2*a*l/(n*n)-l/(e*e))/(t.desiredPixelFlow*Math.LN2)}function Au(t,e){return t.halfWindowSize*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2)}function zu(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function Fu(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function Nu(t){const e=t.compared.sourceZoom-t.compared.targetZoom;if(e===0)return t.compared.pan*t.halfWindowSize/(t.desiredPixelFlow*t.halfWindowPanAtZoom(t.compared.sourceZoom));const i=Math.LN2*t.compared.pan,n=e,s=t.halfWindowPanAtZoom(n),o=t.halfWindowSize*Math.log(t.compared.sourceZoom/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*s);return t.compared.sourceZoom<=t.compared.targetZoom?o*(i-s):o*(i+s)}function Hu(t,e){let i=Zu(t,e);const n={ascensionFactor:e.ascensionFactor!=null?e.ascensionFactor:.5,descensionFactor:e.descensionFactor!=null?e.descensionFactor:.5},s=n.ascensionFactor===0,o=n.descensionFactor===0,a=s?ku:Pu,l=s?Cu:$u,c=s?Eu:Su,u=o?Au:Du,p=o?zu:Ou,m=o?Fu:Lu,d=C=>a(t,C,n)+Iu(t,C,n)+u(t,C,n),g=C=>l(t,C,n)+Ru(t,C,n)+p(t,C,n),v=C=>c(t,C,n)+Vu(t,C,n)+m(t,C,n);let f=d(i);const R=Nu(t);let P;const ce=e.maximumIterations||20,S=e.maximumDistance!=null?e.maximumDistance:1/0;for(P=0;P<ce;P++){const C=e.desiredSlope??1e-6;let K=g(i);Math.abs(K)>C&&(K+=C);const ue=K/v(i);if(isNaN(ue)||i>=S&&ue<0){if(!isFinite(S))return null;i=S,f=d(i);break}if(i-=ue,i<=t.compared.sourceZoom||i<=t.compared.targetZoom)return null;const _t=d(i);if(Math.abs(_t-f)/f<=.005)break;f=_t}return isNaN(f)||f>R*(1-.3)||i<=t.compared.sourceZoom||i<=t.compared.targetZoom?null:i}function Zu(t,e){const i=Math.max(t.compared.sourceZoom,t.compared.targetZoom),n=t.source.zoomAtPixelsPerPan(t.desiredPixelFlow/t.compared.pan)/2;return n<i?e.maximumDistance!=null?i+(e.maximumDistance-i)/2:1.5*i:e.maximumDistance?Math.min(e.maximumDistance,n):n}let qu=class extends xu{constructor(e,i){super(),this._preallocSegments=[new Qi,new Qi,new Qi],this._ascensionSegment=null,this._descensionSegment=null,this.update(e,i)}update(e,i){if(!e)return;this.definition?this.definition.copyFrom(e):this.definition=e.clone();const n=i?.apex?Hu(e,i.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,n?this._updateWithApex(n,i?.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(e,i,n){e.interpolateComponentsAt(i,n),e===this._ascensionSegment?n.zoom=di(n.zoom):e===this._descensionSegment&&(n.zoom=Ot(n.zoom))}_updateWithApex(e,i){const[n,s,o]=this._preallocSegments,a=i?.ascensionFactor??.5,l=Math.min(1-a,i?.ascensionFactor!=null&&i.descensionFactor!=null?i.descensionFactor:.5),c=1-a-l;n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.compared.targetZoom=e,n.definition.compared.pan=this.definition.compared.pan*a,n.definition.compared.rotate=this.definition.compared.rotate*a,n.definition.segmentEnd=a,n.update(),this._ascensionSegment=n,this.segments.push(n),c>0&&(s.definition?s.definition.copyFrom(this.definition):s.definition=this.definition.clone(),s.definition.copyFrom(this.definition),s.definition.compared.sourceZoom=e,s.definition.compared.targetZoom=e,s.definition.compared.pan=this.definition.compared.pan*c,s.definition.compared.rotate=this.definition.compared.rotate*c,s.definition.segmentStart=n.definition.segmentEnd,s.definition.segmentEnd=n.definition.segmentEnd+c,s.update(),this.segments.push(s)),o.definition?o.definition.copyFrom(this.definition):o.definition=this.definition.clone(),o.definition.compared.sourceZoom=e,o.definition.compared.pan=this.definition.compared.pan*l,o.definition.compared.rotate=this.definition.compared.rotate*l,o.definition.segmentStart=a+c,o.update(),this._descensionSegment=o,this.segments.push(o)}_updateWithoutApex(){const[e]=this._preallocSegments;e.update(this.definition),this.segments.push(e)}};const Gu=new Mu;let Wu=class{get time(){return this._time}get isLinear(){return this.path.segments.length===1}constructor(e){this._time=se(0),this._easing=bi,this.definition=new bu(e),this.path=new qu}update(e,i,n){this.definition.update(e,i,n),this.path.update(this.definition,n),this._time=this._applyTimeSettings($r(isFinite(this.path.time)?this.path.time:X(0)),n),this._easing=n.easing??(this._time>=1e3?bi:vi)}cameraAt(e,i){e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);const n=this.path.interpolateComponentsAt(e,Gu);i.interpolate(this.definition.source,this.definition.target,n)}_normalizedEasing(e){const i=this._easing(0,this._time),n=this._easing(1,this._time);return(this._easing(e,this._time)-i)/(n-i)}_applyTimeSettings(e,i){const n=i.speedFactor!=null?i.speedFactor:1,s=i.minDuration??Mi.minDuration/n,o=i.maxDuration??Mi.maxDuration/n;return e=i.duration!=null?se(i.duration):se(Math.min(Math.max(e/n,s),o))}};const Uu=2e3,ju=64;let Bu=class{constructor(e){this._view=e,this._animation=new Wu((()=>new Ws(this._view))),this._current=new Ws(this._view)}get _source(){return this._animation.definition.source}get _target(){return this._animation.definition.target}get duration(){return this._animation.time}get animation(){return this._animation}update(e,i,n={}){Z(this._current.viewpoint,e),Z(this._source.viewpoint,e),Z(this._target.viewpoint,i),this._animation.update(this._source,this._target,n)}applyRatio(e,i){this._animation.cameraAt(i,this._current),Z(e,this._current.viewpoint)}},ct=class extends x{constructor(e){super(e),this._animation=null,this._destinationViewState=new Un,this.updateFunction=null,this.easing=co.ease,this.viewpoint=new ne({targetGeometry:new L,scale:0,rotation:0}),this._updateTask=ft({postRender:this._postRender.bind(this)}),this._updateTask.pause(),this._transition=new Bu(e.view)}destroy(){this._updateTask=he(this._updateTask)}get animation(){return this._animation}set animation(e){this._animation=e,this.view.animation=e}animate(e,i,n){this.stop();const s=this.viewpoint;Z(s,i);const o=e.target;this._transition.update(this.viewpoint,o,{apex:{maximumDistance:Math.min(Math.min(i.scale,o.scale)*ju,this.view.constraints.effectiveMinScale),desiredSlope:5e-8},duration:n?.duration,maxDuration:n?.animationMode==="auto"?se(1/0):n?.maxDuration??$a.maxDuration,speedFactor:n?.speedFactor,easing:(typeof n?.easing=="string"?co[n.easing]:n?.easing)||this.easing}),n?.animationMode==="auto"&&(this._destinationViewState.copy(this.view.state),this._destinationViewState.viewpoint=o,Ku(this._transition.animation,n,this.view.state,this._destinationViewState)||this._transition.update(this.viewpoint,o,{duration:se(0)}));const a=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this._transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(a,a),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinuous(e,i){this.stop(),this.updateFunction=i,this.viewpoint=e;const n=new Mn({target:e.clone()}),s=()=>{this.animation===n&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return n.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=n,n}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){const i=this.animation;if(i&&i.state!==Mn.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime),this.animation?.update(this.viewpoint);else{const n=performance.now()-this._startTime,s=this._transition.duration,o=s>0?n/s:1,a=o>=1;this._transition.applyRatio(this.viewpoint,o),a&&this.animation?.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};function Ku(t,e,i,n){if(e?.duration!=null)return!0;const{time:s,isLinear:o}=t,a=e?.speedFactor||1;if(s>(e?.maxDuration??$a.maxDuration/a))return!1;if(o){const c=D(),u=F(...n.toScreen(c,...i.center)),p=F(...i.toScreen(c,...n.center)),m=p!=null&&p.x>-1*i.size[0]&&p.x<(1.5+.5)*i.size[0]&&p.y>-1*i.size[1]&&p.y<(1.5+.5)*i.size[1],d=u!=null&&u.x>-1*n.size[0]&&u.x<(1.5+.5)*n.size[0]&&u.y>-1*n.size[1]&&u.y<(1.5+.5)*n.size[1];if(s>Uu/a&&!m&&!d)return!1}return!0}r([h()],ct.prototype,"easing",void 0),r([h()],ct.prototype,"view",void 0),r([h()],ct.prototype,"viewpoint",void 0),ct=r([_("esri.views.2d.AnimationManager")],ct);const Yu=ct;function E(){return Promise.all([M(()=>import("./DUHXxiGY.js"),__vite__mapDeps([177,178,2,3,179,4,180,181,109,182,183]),import.meta.url),M(()=>import("./CnatBA7k.js"),__vite__mapDeps([184,8,3,2,4,185,15,1,170,33,34,18,95,76,96,186,41,187,188,189,36,17,16,12,13,45,32,40,35,110,109,190,93,91,92,191,192,193,171,194,195,196,197,64,47,65,198,199,132,166,200,54,37,52,53,30,55,10,11,7,43,56,201,202,179,180,181,182,178,203,204,205,5,206,207,208,209,210,211,212,213,214,215,216,99,74,75,217,218,219,220,221,44,111,112,38,62,222,223,224,225,226,227,228,86,87,31,77,88,89,90,229,230,177,183,231,232,233,234,235,26,85,236,237,238,239,240,241,108,242,9,71,67,14,243,114,115,104,105,102,106,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,50,51,259,139,260,261]),import.meta.url)])}const bt=()=>E().then((()=>M(()=>import("./Cak8Lj4v.js"),__vite__mapDeps([262,1,2,3,4,16,17,8,12,13,263,28,29,30,14,10,11,15,31,32,33,34,18,6,7,5,35,36,37,38,39,40,41,42,43,44,45,46,47,170,95,76,96,92,93,193,191,205,166,206,190,188,189,186,110,109,91,192,171,194,195,196,197,64,65,228,86,87,77,88,89,90,229,216,99,74,75,215,198,199,132,185,200,54,52,53,55,56,211,212,180,181,210,178,179,209,213,214,217,218,219,220,221,111,112,230,231,202,182,203,204,207,208,232,233,234,235,26,85,108,201,187,62,222,223,224,226,227,237,238,239,251,242,9,71,67,243,114,115,104,105,102,106,244,245,252,253,254,50,51,264,265,266,258,267,268,174,269,256,257,270,271,272,139,273,274,275,276,277]),import.meta.url))),Ne=()=>E().then((()=>M(()=>import("./CIirV6xJ.js").then(t=>t.F),__vite__mapDeps([278,1,2,3,4,28,29,30,14,10,11,15,13,17,12,8,31,32,33,34,18,6,7,5,35,16,36,37,38,39,40,41,42,43,44,45,46,47,206,216,99,74,75,76,221,111,109,110,112,144,54,52,53,55,56,49,50,51,21,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,279,235,26,85,116,280,281,243,114,115,104,105,102,106,244,282,77,267,268,215,166,174,257,191,205,212,180,198,199,194,132,185,200,197,195,181,210,182,178,179,258,211,171,209,213,214,217,93,218,219,220,187,188,189,186,190,91,92,192,193,196,201,202,203,204,207,208,222,223,224,232,131,9,283,150,94,95,96,225,284,285,140,143,98,273,286,276,270,271]),import.meta.url))),uo={"base-dynamic":()=>E().then((()=>M(()=>import("./Do64kM6O.js"),__vite__mapDeps([287,1,2,3,4,288,198,16,17,8,12,13,199,194,76,132,15,166,185,36,18,200,54,32,35,37,52,53,30,55,10,11,7,43,56,211,212,180,191,197,195,181,210,178,179,109,171,209,213,214,215,216,99,34,41,74,75,217,93,218,5,219,220,221,44,111,110,112,38,265,202,182,203,204,201,266,267,14,42,268,174,289,290,291,270,206,271]),import.meta.url))),"base-tile":bt,"bing-maps":bt,catalog:()=>E().then((()=>M(()=>import("./CkizjfpQ.js"),__vite__mapDeps([292,1,2,3,4,14,10,11,15,13,267,42,5,268,215,216,99,34,41,74,75,36,17,16,8,12,18,76,166,35,174,270,7,206]),import.meta.url))),"catalog-dynamic-group":()=>E().then((()=>M(()=>import("./CMy4LKPw.js"),__vite__mapDeps([293,1,2,3,4,14,10,11,15,13,267,42,5,268,215,216,99,34,41,74,75,36,17,16,8,12,18,76,166,35,174,31,270,7,206]),import.meta.url))),"catalog-footprint":()=>E().then((()=>M(()=>import("./BNXDv57V.js"),__vite__mapDeps([294,1,2,3,4,278,28,29,30,14,10,11,15,13,17,12,8,31,32,33,34,18,6,7,5,35,16,36,37,38,39,40,41,42,43,44,45,46,47,206,216,99,74,75,76,221,111,109,110,112,144,54,52,53,55,56,49,50,51,21,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,279,235,26,85,116,280,281,243,114,115,104,105,102,106,244,282,77,267,268,215,166,174,257,191,205,212,180,198,199,194,132,185,200,197,195,181,210,182,178,179,258,211,171,209,213,214,217,93,218,219,220,187,188,189,186,190,91,92,192,193,196,201,202,203,204,207,208,222,223,224,232,131,9,283,150,94,95,96,225,284,285,140,143,98,273,286,276,270,271]),import.meta.url))),csv:Ne,"geo-rss":()=>E().then((()=>M(()=>import("./V7VkGHts.js"),__vite__mapDeps([295,1,2,3,4,29,30,14,10,11,15,13,17,12,8,31,32,33,34,18,6,7,5,57,58,59,60,41,61,28,35,16,36,37,38,39,40,42,43,44,45,46,47,62,63,50,51,64,65,147,80,81,68,82,83,84,85,86,87,77,88,89,90,91,92,93,94,95,76,96,66,67,69,116,52,53,267,268,215,216,99,74,75,166,174,255,198,199,194,132,185,200,54,55,56,256,257,191,205,206,212,180,197,195,181,210,182,178,179,109,258,211,171,209,213,214,217,218,219,220,221,111,110,112,187,188,189,186,190,192,193,196,201,202,203,204,207,208,222,223,224,104,105,102,106,251,228,170,229,242,9,71,243,114,115,244,245,252,253,254,270]),import.meta.url))),feature:Ne,geojson:Ne,parquet:Ne,graphics:()=>E().then((()=>M(()=>import("./B7q0pfTH.js"),__vite__mapDeps([296,1,2,3,4,28,29,30,14,10,11,15,13,17,12,8,31,32,33,34,18,6,7,5,35,16,36,37,38,39,40,41,42,43,44,45,46,47,267,268,215,216,99,74,75,76,166,174,255,198,199,194,132,185,200,54,52,53,55,56,256,257,191,205,206,212,180,197,195,181,210,182,178,179,109,258,211,171,209,213,214,217,93,218,219,220,221,111,110,112,187,188,189,186,190,91,92,192,193,196,64,65,201,202,203,204,207,208,62,222,223,224,104,105,102,106,251,86,87,77,228,170,95,96,88,89,90,229,242,9,71,67,243,114,115,244,245,252,253,254,270]),import.meta.url))),group:()=>E().then((()=>M(()=>import("./DVBYqTnk.js"),__vite__mapDeps([297,1,2,3,4,267,14,10,11,15,13,42,5,268,215,216,99,34,41,74,75,36,17,16,8,12,18,76,166,35,174,270,7,206]),import.meta.url))),imagery:()=>E().then((()=>M(()=>import("./CrZ-CRp6.js"),__vite__mapDeps([298,1,2,3,4,28,29,30,14,10,11,15,13,17,12,8,31,32,33,34,18,6,7,5,35,16,36,37,38,39,40,41,42,43,44,45,46,47,263,299,209,76,178,179,180,181,109,210,300,301,211,212,191,198,199,194,132,166,185,200,54,52,53,55,56,197,195,171,213,214,215,216,99,74,75,217,93,218,219,220,221,111,110,112,267,268,174,251,86,87,77,188,189,186,190,91,92,192,193,196,64,65,228,170,95,96,88,89,90,229,242,205,206,9,71,67,208,243,114,115,104,105,102,106,244,245,187,201,202,182,203,204,207,62,222,223,224,252,253,254,269,256,257,258,288,265,266,289,290,291,302,279,235,26,85,276,270,271]),import.meta.url))),"imagery-tile":()=>E().then((()=>M(()=>import("./CIykmxdL.js"),__vite__mapDeps([303,1,2,3,4,5,304,52,17,32,53,299,28,29,30,14,10,11,15,13,12,8,31,33,34,18,6,7,35,16,36,37,38,39,40,41,42,43,44,45,46,47,209,76,178,179,180,181,109,210,300,301,211,212,191,198,199,194,132,166,185,200,54,55,56,197,195,171,213,214,215,216,99,74,75,217,93,218,219,220,221,111,110,112,267,268,174,305,306,258,202,182,203,204,201,266,207,208,206,290,291,307,302,114,115,277,223,279,235,26,85,276,270,271]),import.meta.url))),kml:()=>E().then((()=>M(()=>import("./CoKEmfr_.js"),__vite__mapDeps([308,1,2,3,4,12,8,13,14,10,11,15,5,16,17,114,36,18,115,309,29,30,31,32,33,34,6,7,44,147,80,81,58,59,60,41,61,28,35,37,38,39,40,42,43,45,46,47,62,63,50,51,64,65,68,82,83,84,85,86,87,77,88,89,90,91,92,93,94,95,76,96,57,66,67,69,116,52,53,102,263,265,209,195,215,216,99,74,75,180,179,181,191,202,198,199,194,132,166,185,200,54,55,56,182,178,109,203,204,201,266,288,211,212,197,210,171,213,214,217,218,219,220,221,111,110,112,267,268,174,255,256,257,205,206,258,187,188,189,186,190,192,193,196,207,208,222,223,224,104,105,106,251,228,170,229,242,9,71,243,244,245,252,253,254,270,249,250,302,236,177,183,237,238,239,233,306]),import.meta.url))),"knowledge-graph":()=>E().then((()=>M(()=>import("./E4MMgZee.js"),__vite__mapDeps([310,1,2,3,4,14,10,11,15,13,42,267,5,268,215,216,99,34,41,74,75,36,17,16,8,12,18,76,166,35,174,270,7,206]),import.meta.url))),"link-chart":()=>E().then((()=>M(()=>import("./E4MMgZee.js"),__vite__mapDeps([310,1,2,3,4,14,10,11,15,13,42,267,5,268,215,216,99,34,41,74,75,36,17,16,8,12,18,76,166,35,174,270,7,206]),import.meta.url))),"knowledge-graph-sublayer":Ne,"map-image":()=>E().then((()=>M(()=>import("./C9AedJs5.js"),__vite__mapDeps([311,1,2,3,4,5,263,28,29,30,14,10,11,15,13,17,12,8,31,32,33,34,18,6,7,35,16,36,37,38,39,40,41,42,43,44,45,46,47,288,198,199,194,76,132,166,185,200,54,52,53,55,56,211,212,180,191,197,195,181,210,178,179,109,171,209,213,214,215,216,99,74,75,217,93,218,219,220,221,111,110,112,265,202,182,203,204,201,266,267,268,174,251,86,87,77,188,189,186,190,91,92,192,193,196,64,65,228,170,95,96,88,89,90,229,242,205,206,9,71,67,208,243,114,115,104,105,102,106,244,245,187,207,62,222,223,224,252,253,254,269,256,257,258,289,290,291,270,312,139,273,275,279,235,26,85,271,272,274,276]),import.meta.url))),"map-notes":()=>E().then((()=>M(()=>import("./DXnwvFFu.js"),__vite__mapDeps([313,1,2,3,4,28,29,30,14,10,11,15,13,17,12,8,31,32,33,34,18,6,7,5,35,16,36,37,38,39,40,41,42,43,44,45,46,47,267,268,215,216,99,74,75,76,166,174,255,198,199,194,132,185,200,54,52,53,55,56,256,257,191,205,206,212,180,197,195,181,210,182,178,179,109,258,211,171,209,213,214,217,93,218,219,220,221,111,110,112,187,188,189,186,190,91,92,192,193,196,64,65,201,202,203,204,207,208,62,222,223,224,104,105,102,106,251,86,87,77,228,170,95,96,88,89,90,229,242,9,71,67,243,114,115,244,245,252,253,254,270]),import.meta.url))),media:()=>E().then((()=>M(()=>import("./D2pOvxEz.js"),__vite__mapDeps([314,8,1,2,3,4,28,29,30,14,10,11,15,13,17,12,31,32,33,34,18,6,7,5,35,16,36,37,38,39,40,41,42,43,44,45,46,47,315,209,76,253,194,213,114,115,252,105,57,58,59,60,61,62,63,50,51,64,65,170,95,96,92,93,193,191,205,166,206,190,188,189,186,110,109,91,192,171,195,196,197,228,86,87,77,88,89,90,229,216,99,74,75,215,198,199,132,185,200,54,52,53,55,56,211,212,180,181,210,178,179,214,217,218,219,220,221,111,112,230,231,202,182,203,204,207,208,232,233,234,235,26,85,108,201,187,222,223,224,226,227,237,238,239,251,242,9,71,67,243,104,102,106,244,245,254,246,316,247,267,268,174,270,277]),import.meta.url))),"ogc-feature":()=>E().then((()=>M(()=>import("./DyJRGuTv.js"),__vite__mapDeps([317,1,2,3,4,278,28,29,30,14,10,11,15,13,17,12,8,31,32,33,34,18,6,7,5,35,16,36,37,38,39,40,41,42,43,44,45,46,47,206,216,99,74,75,76,221,111,109,110,112,144,54,52,53,55,56,49,50,51,21,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,279,235,26,85,116,280,281,243,114,115,104,105,102,106,244,282,77,267,268,215,166,174,257,191,205,212,180,198,199,194,132,185,200,197,195,181,210,182,178,179,258,211,171,209,213,214,217,93,218,219,220,187,188,189,186,190,91,92,192,193,196,201,202,203,204,207,208,222,223,224,232,131,9,283,150,94,95,96,225,284,285,140,143,98,273,286,276,270,271]),import.meta.url))),"open-street-map":bt,"oriented-imagery":Ne,route:()=>E().then((()=>M(()=>import("./C3Q9h1Ku.js"),__vite__mapDeps([318,8,1,2,3,4,14,10,11,15,13,319,5,320,28,29,30,17,12,31,32,33,34,18,6,7,35,16,36,37,38,39,40,41,42,43,44,45,46,47,321,267,268,215,216,99,74,75,76,166,174,255,198,199,194,132,185,200,54,52,53,55,56,256,257,191,205,206,212,180,197,195,181,210,182,178,179,109,258,211,171,209,213,214,217,93,218,219,220,221,111,110,112,187,188,189,186,190,91,92,192,193,196,64,65,201,202,203,204,207,208,62,222,223,224,104,105,102,106,251,86,87,77,228,170,95,96,88,89,90,229,242,9,71,67,243,114,115,244,245,252,253,254,270]),import.meta.url))),stream:()=>E().then((()=>M(()=>import("./CHH1BaTn.js"),__vite__mapDeps([322,1,2,3,4,5,116,28,29,30,14,10,11,15,13,17,12,8,31,32,33,34,18,6,7,35,16,36,37,38,39,40,41,42,43,44,45,46,47,52,53,278,206,216,99,74,75,76,221,111,109,110,112,144,54,55,56,49,50,51,21,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,279,235,26,85,280,281,243,114,115,104,105,102,106,244,282,77,267,268,215,166,174,257,191,205,212,180,198,199,194,132,185,200,197,195,181,210,182,178,179,258,211,171,209,213,214,217,93,218,219,220,187,188,189,186,190,91,92,192,193,196,201,202,203,204,207,208,222,223,224,232,131,9,283,150,94,95,96,225,284,285,140,143,98,273,286,276,270,271]),import.meta.url))),"subtype-group":()=>E().then((()=>M(()=>import("./DnUthFrH.js"),__vite__mapDeps([323,1,2,3,4,5,278,28,29,30,14,10,11,15,13,17,12,8,31,32,33,34,18,6,7,35,16,36,37,38,39,40,41,42,43,44,45,46,47,206,216,99,74,75,76,221,111,109,110,112,144,54,52,53,55,56,49,50,51,21,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,279,235,26,85,116,280,281,243,114,115,104,105,102,106,244,282,77,267,268,215,166,174,257,191,205,212,180,198,199,194,132,185,200,197,195,181,210,182,178,179,258,211,171,209,213,214,217,93,218,219,220,187,188,189,186,190,91,92,192,193,196,201,202,203,204,207,208,222,223,224,232,131,9,283,150,94,95,96,225,284,285,140,143,98,273,286,276,270,271]),import.meta.url))),tile:bt,"vector-tile":()=>E().then((()=>M(()=>import("./x3lVDv0R.js"),__vite__mapDeps([324,1,2,3,4,67,14,10,11,15,13,16,17,8,12,36,18,230,131,132,9,196,180,179,181,108,109,192,193,92,93,191,199,82,83,198,194,76,166,185,200,54,32,35,37,52,53,30,55,7,43,56,234,218,190,217,209,178,211,212,197,195,210,171,213,214,215,216,99,34,41,74,75,5,219,220,221,44,111,110,112,38,290,291,258,28,29,31,33,6,39,40,42,45,46,47,325,326,327,170,95,96,328,267,268,174,270,206,271,277]),import.meta.url))),video:()=>E().then((()=>M(()=>import("./DmHbg0Z1.js"),__vite__mapDeps([329,1,2,3,4,33,34,18,28,29,30,14,10,11,15,13,17,12,8,31,32,6,7,5,35,16,36,37,38,39,40,41,42,43,44,45,46,47,330,263,55,56,136,121,98,99,74,75,76,154,125,62,331,100,91,92,93,97,50,51,82,83,316,209,195,214,104,105,102,106,198,199,194,132,166,185,200,54,52,53,211,212,180,191,197,181,210,178,179,109,171,213,215,216,217,218,219,220,221,111,110,112,187,188,189,186,190,192,193,196,64,65,201,202,182,203,204,205,206,207,208,222,223,224,247,114,115,267,268,174,255,256,257,258,251,86,87,77,228,170,95,96,88,89,90,229,242,9,71,67,243,244,245,252,253,254,270]),import.meta.url))),wcs:()=>E().then((()=>M(()=>import("./CIykmxdL.js"),__vite__mapDeps([303,1,2,3,4,5,304,52,17,32,53,299,28,29,30,14,10,11,15,13,12,8,31,33,34,18,6,7,35,16,36,37,38,39,40,41,42,43,44,45,46,47,209,76,178,179,180,181,109,210,300,301,211,212,191,198,199,194,132,166,185,200,54,55,56,197,195,171,213,214,215,216,99,74,75,217,93,218,219,220,221,111,110,112,267,268,174,305,306,258,202,182,203,204,201,266,207,208,206,290,291,307,302,114,115,277,223,279,235,26,85,276,270,271]),import.meta.url))),"web-tile":bt,wfs:Ne,wms:()=>E().then((()=>M(()=>import("./C6Di7ImA.js"),__vite__mapDeps([332,1,2,3,4,5,16,17,8,12,13,288,198,199,194,76,132,15,166,185,36,18,200,54,32,35,37,52,53,30,55,10,11,7,43,56,211,212,180,191,197,195,181,210,178,179,109,171,209,213,214,215,216,99,34,41,74,75,217,93,218,219,220,221,44,111,110,112,38,265,202,182,203,204,201,266,267,14,42,268,174,289,290,291,270,206,271,333,279,235,26,33,85]),import.meta.url))),wmts:()=>E().then((()=>M(()=>import("./D0VRMz_k.js"),__vite__mapDeps([334,1,2,3,4,16,17,8,12,13,264,36,18,265,209,76,195,215,15,216,99,34,41,74,75,10,11,180,179,181,191,202,198,199,194,132,166,185,200,54,32,35,37,52,53,30,55,7,43,56,182,178,109,203,204,201,266,211,212,197,210,171,213,214,217,93,218,5,219,220,221,44,111,110,112,38,258,267,14,42,268,174,270,206,271,277]),import.meta.url))),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"integrated-mesh-3dtiles":null,"point-cloud":null,viewshed:null,voxel:null,scene:null,unknown:null,unsupported:null};function Ju(t){const e=t.declaredClass?t.declaredClass.slice(t.declaredClass.lastIndexOf(".")+1):"Unknown",i=e.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new T(`${i}:view-not-supported`,`${e} is not supported in 2D`)}const po={hasLayerViewModule:t=>uo[t.type]!=null,importLayerView:t=>{const e=uo[t.type];if(e==null)throw Ju(t);return e(t)}};let Qu=class{constructor(e,i={}){this.events=new Ft,this._hasMajorPerformanceCaveat=!1,this._lastRenderFrameCounter=0,e!=null?(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("style","width: 100%; height:100%; display:block; willChange:transform"),e.contains(this._canvas)||e.appendChild(this._canvas)):i.canvas!=null&&(this._canvas=i.canvas);const n={failIfMajorPerformanceCaveat:!0,alpha:!0,antialias:!1,depth:!0,stencil:!0,powerPreference:"high-performance"};let s=this._canvas.getContext("webgl2",n);s||(s=this._canvas.getContext("webgl2",{...n,failIfMajorPerformanceCaveat:!1}),this._hasMajorPerformanceCaveat=!0),this._gl=s,this._handles=ko([So(this._canvas,"webglcontextlost",(o=>this.events.emit("webgl-context-lost",o)))])}destroy(){this._canvas.remove(),this._canvas=null,this._handles.remove(),this._gl=null}get gl(){return this._gl}get canvas(){return this._canvas}render(e,i){if(this._hasMajorPerformanceCaveat||z("esri-force-performance-mode")){if(++this._lastRenderFrameCounter>=z("esri-performance-mode-frames-between-render")&&(i(),this._lastRenderViewState=e.state.clone(),this._lastRenderFrameCounter=0),this._lastRenderViewState){const[n,s,o,a,l,c]=this._computeViewTransform(this._lastRenderViewState,e.state);this._canvas.style.transform=`matrix(${n}, ${s}, ${o}, ${a}, ${l}, ${c})`}}else i()}resize(e){const i=this._canvas,n=i.style,{state:{size:s},pixelRatio:o}=e,a=s[0],l=s[1],c=Math.round(a*o),u=Math.round(l*o);i.width===c&&i.height===u||(i.width=c,i.height=u),n.width=a+"px",n.height=l+"px"}_computeViewTransform(e,i){const[n,s]=e.center,[o,a]=i.center,[l,c]=e.toScreen([0,0],o,a),[u,p]=e.toScreen([0,0],n,s),m=u-l,d=p-c,g=e.scale/i.scale,v=i.rotation-e.rotation,f=ye();return gl(f),An(f,f,[g,g]),Ri(f,f,Ei(v)),Vt(f,f,[m,d]),f}};const He={added:[],removed:[]},Xi=new Set,Xu=new Sl(0,0,0,0);function ep(t,e){const i=zo(e);if(!i)return null;const[n,s]=i.valid;return t[2]>s?[Wt([t[0],t[1],s,t[3]]),Wt([n,t[1],n+t[2]-s,t[3]])]:t[0]<n?[Wt([n,t[1],t[2],t[3]]),Wt([s-(n-t[0]),t[1],s,t[3]])]:null}let tp=class extends Ft{constructor(e){super(),this._tiles=new Map,this._index=Tl(9,z("esri-csp-restrictions")?i=>({minX:i.bounds[0],minY:i.bounds[1],maxX:i.bounds[2],maxY:i.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=e}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(e){return this._tiles.has(e)}get(e){return this._tiles.get(e)}getIntersectingTiles(e){if(!e||Ir(e)===0||Rr(e)===0)return[];const i=ep(e,this.tileScheme.spatialReference);return i!=null?[...new Set([...this.boundsIntersections(i[0]),...this.boundsIntersections(i[1])])]:this.boundsIntersections(e)}boundsIntersections(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})}updateTiles(e){const i={added:[],removed:[]};for(const n of e.added)if(!this.has(n)){const s=new gs(this.tileScheme,n);this._tiles.set(n,s),this._index.insert(s),i.added.push(s)}for(const n of e.removed)if(this.has(n)){const s=this.get(n);this._tiles.delete(n),this._index.remove(s),i.removed.push(s)}this.tiles.length=0,this._tiles.forEach((n=>this.tiles.push(n))),(i.added.length||i.removed.length)&&this.emit("update",i)}setViewState(e){const i=this.tileScheme.getTileCoverage(e,0);if(!i)return;const{spans:n,lodInfo:s}=i,{level:o}=s;if(n.length>0)for(const{row:a,colFrom:l,colTo:c}of n)for(let u=l;u<=c;u++){const p=Xu.set(o,a,s.normalizeCol(u),s.getWorldForColumn(u)).id;if(Xi.add(p),!this.has(p)){const m=new gs(this.tileScheme,p);this._tiles.set(p,m),this._index.insert(m),this.tiles.push(m),He.added.push(m)}}for(let a=this.tiles.length-1;a>=0;a--){const l=this.tiles[a];Xi.has(l.id)||(this._tiles.delete(l.id),this.tiles.splice(a,1),this._index.remove(l),He.removed.push(l))}(He.added.length||He.removed.length)&&this.emit("update",He),Pl.pool.release(i),Xi.clear(),He.added.length=0,He.removed.length=0}};const ip=1,zg=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],Fg=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Mt=256,en=()=>k.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");function np(t,e){e.fillColor[0]=t.color.r/255,e.fillColor[1]=t.color.g/255,e.fillColor[2]=t.color.b/255,e.fillColor[3]=t.color.a,t.haloColor?(e.outlineColor[0]=t.haloColor.r/255,e.outlineColor[1]=t.haloColor.g/255,e.outlineColor[2]=t.haloColor.b/255,e.outlineColor[3]=t.haloColor.a):(e.outlineColor[0]=e.fillColor[0],e.outlineColor[1]=e.fillColor[1],e.outlineColor[2]=e.fillColor[2],e.outlineColor[3]=e.fillColor[3]),e.fillColor[3]*=t.fillOpacity,e.outlineColor[3]*=t.haloOpacity,e.fillColor[0]*=e.fillColor[3],e.fillColor[1]*=e.fillColor[3],e.fillColor[2]*=e.fillColor[3],e.outlineColor[0]*=e.outlineColor[3],e.outlineColor[1]*=e.outlineColor[3],e.outlineColor[2]*=e.outlineColor[3],e.outlineWidth=(1-t.haloBlur)*t.haloWidth,e.outerHaloWidth=t.haloBlur*t.haloWidth/2,e.innerHaloWidth=t.haloBlur*t.haloWidth/2,e.outlinePosition=0}const sp=[0,0,0,0];let ka=class{constructor(){this.type="single",this._highlightOptions=new Fe,this._convertedHighlightOptions={fillColor:[0,0,0,0],outlineColor:[0,0,0,0],outlinePosition:0,outlineWidth:0,innerHaloWidth:0,outerHaloWidth:0},this._optionsShadeTexKey="",this._texelData=new Uint8Array(4*Mt),this._minMaxDistance=[0,0]}setHighlightOptions(e){this._highlightOptions=e}applyHighlightOptions(e,i){this._updateGradientTexture(e),e.bindTexture(this._shadeTex,kl),i.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){this._shadeTex?.dispose(),this._shadeTex=null}getReasonsWithGradients(){return[{activeReasons:(1<<Cl)-1,activeGradient:this}]}_updateGradientTexture(e){const i=op(this._highlightOptions);if(i===this._optionsShadeTexKey)return;this._optionsShadeTexKey=i,np(this._highlightOptions,this._convertedHighlightOptions);const n=this._convertedHighlightOptions,s=n.outlinePosition-n.outlineWidth/2-n.outerHaloWidth,o=n.outlinePosition-n.outlineWidth/2,a=n.outlinePosition+n.outlineWidth/2,l=n.outlinePosition+n.outlineWidth/2+n.innerHaloWidth,c=Math.sqrt(Math.PI/2)*ip,u=Math.abs(s)>c?Math.round(10*(Math.abs(s)-c))/10:0,p=Math.abs(l)>c?Math.round(10*(Math.abs(l)-c))/10:0;let m;u&&!p?en().error("The outer rim of the highlight is "+u+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!u&&p?en().error("The inner rim of the highlight is "+p+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):u&&p&&en().error("The highlight is "+Math.max(u,p)+"px away from the edge of the feature; consider reducing some width values.");const d=[void 0,void 0,void 0,void 0];function g(f,R,P){d[0]=(1-P)*f[0]+P*R[0],d[1]=(1-P)*f[1]+P*R[1],d[2]=(1-P)*f[2]+P*R[2],d[3]=(1-P)*f[3]+P*R[3]}const{_texelData:v}=this;for(let f=0;f<Mt;++f)m=s+f/(Mt-1)*(l-s),m<s?(d[0]=0,d[1]=0,d[2]=0,d[3]=0):m<o?g(sp,n.outlineColor,(m-s)/(o-s)):m<a?[d[0],d[1],d[2],d[3]]=n.outlineColor:m<l?g(n.outlineColor,n.fillColor,(m-a)/(l-a)):[d[0],d[1],d[2],d[3]]=n.fillColor,v[4*f]=255*d[0],v[4*f+1]=255*d[1],v[4*f+2]=255*d[2],v[4*f+3]=255*d[3];if(this._minMaxDistance[0]=s,this._minMaxDistance[1]=l,!this._shadeTex){const f=new Rl;f.wrapMode=El.CLAMP_TO_EDGE,f.width=Mt,f.height=1,this._shadeTex=new Vl(e,f)}this._shadeTex.updateData(0,0,0,Mt,1,this._texelData)}};function op(t){return`${t.color};${t.haloColor};${t.haloOpacity};${t.fillOpacity};${t.haloWidth};${t.haloBlur}`}let ap=class{constructor(){this.type="multi",this.gradients=[]}setHighlightOptions(e){for(let i=0;i<e.length;i++)this.gradients[i]||(this.gradients[i]=new ka),this.gradients[i].setHighlightOptions(e[i]);for(let i=e.length+1;i<this.gradients.length;i++)this.gradients[i].destroy();this.gradients.length=e.length}destroy(){for(const e of this.gradients)e.destroy()}getReasonsWithGradients(){let e=1;const i=[];for(let n=0;n<this.gradients.length;n++){const s=this.gradients[n];i.push({activeReasons:e,activeGradient:s}),e<<=1}return i}};const Ca={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{ref:t=>t.stencilRef,compare:Il.EQUAL,mask:255,op:{fail:Ni.KEEP,zFail:Ni.KEEP,zPass:Ni.REPLACE}}}},rp={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},lp={...Ca,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function hp({pixelRatio:t,state:e,displayLevel:i,requiredLevel:n},s){const o=1/2**(i-s.key.level),a=1/2**(n-s.key.level);return{displayMat3:e.displayMat3,displayViewMat3:e.displayViewMat3,displayViewScreenMat3:s.transforms.displayViewScreenMat3,viewMat3:e.viewMat3,tileMat3:s.transforms.tileMat3,displayZoomFactor:o,requiredZoomFactor:a,tileOffset:[s.x,s.y],currentScale:e.scale,currentZoom:i,metersPerSRUnit:Lo(e.spatialReference),rotation:e.rotation,pixelRatio:t}}function Ea(t){return t.passOptions?.type==="highlight"}function Ia(t){return t.passOptions?.type==="hittest"}function cp(t){if(!Ia(t))return null;const{position:e,distance:i,smallSymbolDistance:n,smallSymbolSizeThreshold:s}=t.passOptions;return{position:e,distance:i,smallSymbolDistance:n,smallSymbolSizeThreshold:s}}function up(t){if(!Ea(t))return null;const{activeReasons:e,highlightAll:i}=t.passOptions;return{activeReasons:e,highlightAll:i?1:0}}function Zg(t,e,i){const n={};for(const s in i)typeof i[s]!="function"?n[s]=i[s]:n[s]=i[s](t,e);return n}function qg(t,e){const{attributeView:i,context:n}=t;return{storage:i.getUniforms(n),view:hp(t,e),hittestRequest:cp(t),highlight:up(t)}}function Gg(t){return{inside:t.selection===fs.InsideEffect,outside:t.selection===fs.OutsideEffect}}function pp(t){return Ia(t)?rp:Ea(t)&&t.passOptions.stepType==="clear"?lp:Ca}function Wg(t){const{row:e,col:i}=t.key,n=i*ys,s=e*ys;return{tileOffsetFromLocalOrigin:[n%Kt,s%Kt],maxIntsToLocalOrigin:[Math.floor(n/Kt),Math.floor(s/Kt)]}}const dp=new hr({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function Ug(t){return dp.toJSON(t)}function jg(t){const{bandCount:e,attributeTable:i,colormap:n,pixelType:s}=t.raster.rasterInfo;return e===1&&(i!=null||n!=null||s==="u8"||s==="s8")}function mp(t,e){return e==null?(t?.destroy(),null):(t?.type==="single"&&Array.isArray(e)&&(t.destroy(),t=null),t?.type!=="multi"||Array.isArray(e)||(t.destroy(),t=null),t||(t=Array.isArray(e)?new ap:new ka),Array.isArray(e)?t.type==="multi"&&t.setHighlightOptions(e):t.type==="single"&&t.setHighlightOptions(e),t)}function Bg(t,e,i,n){const{painter:s,highlightGradient:o}=t,{highlight:a}=s.effects;if(!o)return;const l=t.passOptions,c=o.getReasonsWithGradients();for(let u=0;u<c.length;u++){const p={...t,passOptions:{type:"highlight",activeGradient:c[u].activeGradient,activeReasons:c[u].activeReasons,stepType:"burn",highlightAll:e}};if(a.bind(p),i(p),u<c.length-1){let d=0;for(let g=u+1;g<c.length;g++)d|=c[g].activeReasons;i({...t,passOptions:{type:"highlight",activeGradient:c[u].activeGradient,activeReasons:d,stepType:"clear",highlightAll:e}})}const m={...t,passOptions:{type:"highlight",activeGradient:c[u].activeGradient,activeReasons:c[u].activeReasons,stepType:"draw",highlightAll:e}};s.setPipelineState(pp(t)),s.updatePipelineState(t.context),a.draw(m),a.unbind()}t.passOptions=l}const Xt=t=>parseFloat(t)/100;function gp(t,e,i){const n=typeof t.left=="string"?Xt(t.left)*e:t.left,s=typeof t.right=="string"?Xt(t.right)*e:t.right,o=typeof t.top=="string"?Xt(t.top)*i:t.top,a=typeof t.bottom=="string"?Xt(t.bottom)*i:t.bottom,l=o;return{xmin:n,xmax:Math.max(e-s,n),ymin:l,ymax:Math.max(i-a,o)}}function Ra(t,e,i,n){switch(e.type){case"rect":{const{width:s,height:o}=t,{xmin:a,xmax:l,ymin:c,ymax:u}=gp(e,s,o),{x:p,y:m}=i;return p>a&&p<l&&m>c&&m<u}case"path":return e.path.length===0||!Array.isArray(e.path[0][0])||Jr(e.path,[i.x,i.y]);case"geometry":return e.geometry==null||(e.geometry.type==="polygon"?Fo(e.geometry,n):Ln(e.geometry,n))}}function fp(t){if(!t.highlights)return null;const e=t.highlights.findIndex((i=>i.name==="default"));return e===-1?null:t.highlights.items[e]}function yp(t,e){if(!t.highlights){if(!e)return;t.highlights=new I([new Fe])}const i=t.highlights.findIndex((n=>n.name==="default"));e?t.highlights.items[i].assignFrom(e):(t.highlights.removeAt(i),t.highlights.length===0&&(t.highlights=null))}async function _p(t,e,i){const n=Xo(e)?Qo(t,e):e;if(!t.ready||isNaN(n.x)||isNaN(n.y))return{screenPoint:n,results:[]};let s=new Set;const o=new Set;let a=!1,l=null,c=null;i?.include?go(i.include,mo(t,(d=>{s.add(d),tn(d,(g=>o.add(g)))}),((d,g)=>{o.add(d),s.add(g)}),(d=>{l||(l=new Set),l.add(d)}),(d=>s.add(d)),(()=>a=!0))):(a=!0,s=new Set(t.allLayerViews),s.forEach((d=>{tn(d,(g=>o.add(g)))}))),i?.exclude&&go(i.exclude,mo(t,(d=>{s.delete(d),tn(d,(g=>o.delete(g)))}),(d=>o.delete(d)),(d=>{c||(c=new Set),c.add(d)})));const u=t.toMap(n),p=t.allLayerViews.filter((d=>!d.suspended&&s.has(d)&&d.clips.every((g=>Ra(t,g,n,u))))).reverse();let m=[...a?t.graphicsView.hitTest(u).map((d=>({type:"graphic",graphic:d,layer:null,mapPoint:u}))):[],...await Promise.all(p.map((d=>d.hitTest(u,n))).toArray())].filter(It).flat().filter(It);return m=m.filter((d=>d.type!=="graphic"||d.layer?.type!=="subtype-group"||o.has(d.graphic.layer))),l&&(m=m.filter((d=>!("graphic"in d)||!d.graphic||l?.has(kn(d.graphic))))),c&&(m=m.filter((d=>!("graphic"in d)||!d.graphic||!c?.has(kn(d.graphic))))),{screenPoint:n,results:m}}function mo(t,e,i,n,s,o){return a=>{if(a instanceof Dl){if(a.layer===t)o?.();else{const l=t.allLayerViews.find((c=>c.layer===a.layer));l&&s?.(l)}n(kn(a))}else if(!("layer"in a&&"element"in a))if(a.type==="subtype-sublayer"){const l=t.allLayerViews.find((c=>c.layer===a.parent));l&&i(a,l)}else{const l=t.allLayerViews.find((c=>c.layer===a));l&&e(l)}}}function go(t,e){if(t)if(Qn(t))for(const i of t)if(Qn(i))for(const n of i)e(n);else e(i);else e(t)}function kn(t){const e=t.getObjectId();return e?`${t.layer?.uid??t.sourceLayer?.uid??"MapView"}/${e}`:`"MapView/${t.uid}`}function tn({layer:t},e){t?.type==="subtype-group"&&t.sublayers.forEach((i=>{e(i)}))}function Va(t,e,i){const{ctx:n,canvas:s}=Oa(t,i),o=n.getImageData(0,0,t.width,t.height),a=Aa(s,e);return La(s),{dataUrl:a,data:o}}function Da(t,e){const{ctx:i,canvas:n}=Oa(t,e),s=i.getImageData(0,0,t.width,t.height);return La(n),s}function Oa(t,e){const i=vp();e.premultipliedAlpha&&xp(t),i.width=t.width,i.height=t.height;const n=i.getContext("2d",{willReadFrequently:!0});return n.putImageData(t,0,0),e.flipY&&Mp(n),{ctx:n,canvas:i}}function La(t){t.width=0,t.height=0}function vp(){return nn==null&&(nn=document.createElement("canvas")),nn}let nn=null;function Aa(t,e){const i=Tp[e.format],n=e.quality/100;return t.toDataURL(i,n)}function za(t,e){const i=bp(t),n=$p[i];return{format:i,quality:ln(e??n,0,100)}}function Fa(t,e){return e/Math.max(t[0],t[1])}function wp(t,e,i,n=0,s=0,o=t.width-n,a=t.height-s,l=!1){const{data:c}=t,{width:u,height:p,data:m}=e,d=o/u,g=a/p,v=Math.ceil(d/2),f=Math.ceil(g/2),R=t.width;for(let P=0;P<p;P++)for(let ce=0;ce<u;ce++){const S=4*(ce+(l?p-P-1:P)*u);let N=0,C=0,K=0,ue=0,_t=0,Bn=0;const nr=(P+.5)*g;for(let Ht=Math.floor(P*g);Ht<(P+1)*g;Ht++){const Kn=Math.abs(nr-(Ht+.5))/f,sr=(ce+.5)*d,or=Kn*Kn;for(let Zt=Math.floor(ce*d);Zt<(ce+1)*d;Zt++){const Yn=Math.abs(sr-(Zt+.5))/v,Xe=Math.sqrt(or+Yn*Yn);if(Xe>=1)continue;let ke=2*Xe*Xe*Xe-3*Xe*Xe+1;const et=4*(n+Zt+(s+Ht)*R);Bn+=ke*c[et+3],C+=ke,!i&&c[et+3]<255&&(ke=ke*c[et+3]/255),K+=ke*c[et],ue+=ke*c[et+1],_t+=ke*c[et+2],N+=ke}}m[S]=K/N,m[S+1]=ue/N,m[S+2]=_t/N,m[S+3]=Bn/C}return e}function bp(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return Pp}}function Mp(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}function xp(t){const e=t.data,i=e.length;for(let n=0;n<i;n+=4){const s=e[n+3];if(s!==255&&s>0){const o=255/s;e[n]=e[n]*o,e[n+1]=e[n+1]*o,e[n+2]=e[n+2]*o}}}const Tp={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},fo=98,Pp="png",$p={png:100,jpg:fo,jpeg:fo},Kg=Object.freeze(Object.defineProperty({__proto__:null,createEmptyImageData:Ol,encode:Va,encodeData:Da,getFormatAndQuality:za,getMaximumResolutionScale:Fa,resampleHermite:wp,toDataUrl:Aa},Symbol.toStringTag,{value:"Module"})),Na={flipY:!0,premultipliedAlpha:!0};async function Sp(t,e){const i=await Ha(t,e),{format:n,quality:s}=za(e?.format,e?.quality);return Va(i,{format:n,quality:s},Na)}async function kp(t,e){const i=await Ha(t,e);return Da(i,Na)}function Ha(t,e){const i=Ip(e||{},Ep(t.stage,t.size),t.size,t.padding),n=Cp(e,t.allLayerViews);return t.stage.takeScreenshot(i,n,t.backgroundColor,e?.rotation)}function Cp(t={},e){if(!t.layers)return;const i=[];return t.layers.forEach((n=>{const s=e.find((o=>o.layer.id===n.id));s?.container&&i.push(s.container)})),i}function Ep(t,e){return Math.min(4,Fa(e,Math.min(4096,t.context.parameters.maxTextureSize)))}function Ip(t,e,i,n){t.ignorePadding&&(n={left:0,right:0,top:0,bottom:0});let s=null;t.width!=null&&t.height!=null?s=[t.width,t.height]:t.width==null&&t.height!=null?s=[t.height,t.height]:t.width!=null&&t.height==null?s=[t.width,t.width]:t.width==null&&t.height==null&&(s=null);const o=i[0]-(n.left+n.right),a=i[1]-(n.top+n.bottom);let l,c,u=t.area||{x:0,y:0,width:o,height:a};if(s){const p=o/a,m=s[0]/s[1];if(m>p){const d=u.width/m;u={x:u.x,y:Math.round(u.y+(u.height-d)/2),width:u.width,height:Math.round(d)}}else{const d=u.height*m;u={x:Math.round(u.x+(u.width-d)/2),y:u.y,width:Math.round(d),height:u.height}}}else s=[u.width,u.height];return s[0]>u.width?(l=Math.min(s[0]/u.width,e),c=s[0]/u.width/l):(l=1,c=s[0]/u.width),{cropArea:{x:Math.round((u.x+n.left)*l),y:Math.round((u.y+n.top)*l),width:Math.round(u.width*l),height:Math.round(u.height*l)},outputScale:c,resolutionScale:l}}const Rp=t=>t.includes("Brush");let Za=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),Rp(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};function Vp(t){const e=Ll();return e.available?t==="3d"&&e.majorPerformanceCaveat?new T("webgl:major-performance-caveat-detected",`Your WebGL implementation (${e.unmaskedRenderer}) doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.`):e.supportsHighPrecisionFragment?e.supportsVertexShaderSamplers?null:new T("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new T("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new T("webgl:required","WebGL2 is required but not supported.",new Error().stack)}function Dp(t){return t&&"nodeType"in t}function Op(t){return t&&typeof t.render=="function"}const yo={component:"esri-component"};let Ge=class extends x{constructor(){super(...arguments),this.widget=null}destroy(){this.node=null,this.widget?.destroy()}get id(){return this._get("id")??this.widget?.id??this.node?.id}set id(e){this._set("id",e)}set node(e){const i=this._get("node");e!==i&&(e&&e.classList.add(yo.component),i&&i.classList.remove(yo.component),this._set("node",e))}castNode(e){return this.widget?.destroy(),e?typeof e=="string"||Dp(e)?(this._set("widget",null),Io(e)):(Op(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};r([h()],Ge.prototype,"id",null),r([h()],Ge.prototype,"node",null),r([En("node")],Ge.prototype,"castNode",null),r([h({readOnly:!0})],Ge.prototype,"widget",void 0),Ge=r([_("esri.views.ui.Component")],Ge);const ai=Ge,Lp={left:0,top:0,bottom:0,right:0},qa={bottom:30,top:15,right:15,left:15},ve="esri-ui",W={ui:ve,corner:`${ve}-corner`,innerContainer:`${ve}-inner-container`,manualContainer:`${ve}-manual-container`,cornerContainer:`${ve}-corner-container`,topLeft:`${ve}-top-left`,topRight:`${ve}-top-right`,bottomLeft:`${ve}-bottom-left`,bottomRight:`${ve}-bottom-right`};function Ap(t){return t&&!t._started&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}function ei(t){return t===0?"0":`${t}px`}function sn(t){const e=typeof t=="object"&&t!==null&&Object.getPrototypeOf(t);return(e===null||e===Object.prototype)&&("component"in t||"index"in t||"position"in t)?t:null}function on(t,{top:e,bottom:i,left:n,right:s}){t.style.top=e,t.style.bottom=i,t.style.left=n,t.style.right=s}let me=class extends Ft.EventedAccessor{constructor(t){super(t),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=Ur(),this.view=null,this._applyViewPadding=()=>{const e=this.container;e&&on(e,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const e=this._innerContainer;e&&on(e,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([w((()=>[this.view?.padding,this.container]),this._applyViewPadding,G),w((()=>this.padding),this._applyUIPadding,G),w((()=>[this.container,this._locale]),(([t,e])=>{t&&t.setAttribute("lang",e)}),G),jr((t=>{this._locale=t}))])}destroy(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._componentMap.clear()}set container(t){const e=this._get("container");t!==e&&(t&&(t.classList.add(W.ui),Al(t),this._attachContainers(t)),e&&(e.classList.remove(W.ui),on(e,{top:"",bottom:"",left:"",right:""}),e.textContent=""),this._set("container",t))}get height(){const t=this.view?.height??0;if(t===0)return t;const e=this._getViewPadding(),{top:i,bottom:n}=e;return Math.max(t-i-n,0)}get padding(){return this._get("padding")}set padding(t){this._overrideIfSome("padding",t)}castPadding(t){return typeof t=="number"?{bottom:t,top:t,right:t,left:t}:{...qa,...t}}get width(){const t=this.view?.width??0;if(t===0)return t;const e=this._getViewPadding(),{left:i,right:n}=e;return Math.max(t-i-n,0)}add(t,e){let i,n,s;if(Array.isArray(t))return void t.forEach((a=>this.add(a,e)));const o=sn(t);o&&({index:i,position:e,component:t,key:n}=o),e&&typeof e=="object"&&({index:i,key:n,position:e,internal:s}=e),!t||e&&!this._isValidPosition(e)||this._add(t,e,i??this._getNumComponentsAtPosition(e),n,s)}remove(t,e){if(!t)return;if(Array.isArray(t))return t.map((n=>this.remove(n,e)));const i=this._find(t);if(i){const n=this._componentMap.get(i);if(!n||n.key!==e)return;const s=this._components.indexOf(i);return i.node.parentNode?.removeChild(i.node),this._componentMap.delete(i),i.widget?.removeHandlesReference(this._removeWidgetHandleKey),this._components.forEach((a=>{const l=this._componentMap.get(a);l&&l.position===n.position&&l.index>n.index&&l.index--})),this._components.splice(s,1)[0]}}empty(t,e={removeInternal:!1}){if(Array.isArray(t)){for(const s of t)this.empty(s,e);return}const i=this._positionNameToContainerLookup[t??"manual"],n=Array.prototype.slice.call(i.children).map((s=>this._findByNode(s))).filter((s=>s==null?!1:!(this._componentMap.get(s)?.internal??!1)||e.removeInternal));for(const s of n)this.remove(s)}move(t,e){if(Array.isArray(t)&&t.forEach((o=>this.move(o,e))),!t)return;let i;const n=sn(t)||sn(e);if(n&&(i=n.index,e=n.position,t=n.component||t),e&&!this._isValidPosition(e))return;const s=this.remove(t);s&&this.add(s,{position:e,index:i})}find(t){if(!t)return null;const e=this._findById(t);return e&&(e.widget||e.node)}getComponents(t,e={includeInternal:!1}){return t?Array.isArray(t)?t.flatMap((i=>this._getComponentsAtPosition(i,e))):this._getComponentsAtPosition(t,e):this._components.filter((i=>e.includeInternal||!this._componentMap.get(i)?.internal)).map((({widget:i,node:n})=>i??n))}getPosition(t){for(const e in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[e].contains(t))return e;return null}_add(t,e,i,n,s){t instanceof ai||(t=new ai({node:t}));const{widget:o}=t;o!=null&&o instanceof x&&o.addHandles(Lt((()=>{queueMicrotask((()=>this.remove(t)))})),this._removeWidgetHandleKey),this._components.some((a=>this._componentMap.get(a)?.position===e&&this._componentMap.get(a)?.index===i))&&this._components.forEach((a=>{const l=this._componentMap.get(a);l&&l.position===e&&l.index>=i&&l.index++})),this._place({component:t,position:e,index:i}),this._components.push(t),this._componentMap.set(t,{key:n,position:e,internal:s,index:i})}_find(t){return t?t instanceof ai?this._findByComponent(t):typeof t=="string"?this._findById(t):"domNode"in t?this._findByNode(t.domNode):this._findByNode(t):null}_getViewPadding(){return this.view?.padding??Lp}_attachContainers(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer)}_initContainers(){const t=document.createElement("div");t.classList.add(W.innerContainer,W.cornerContainer);const e=document.createElement("div");e.classList.add(W.innerContainer,W.manualContainer);const i=document.createElement("div");i.classList.add(W.topLeft,W.corner),t.appendChild(i);const n=document.createElement("div");n.classList.add(W.topRight,W.corner),t.appendChild(n);const s=document.createElement("div");s.classList.add(W.bottomLeft,W.corner),t.appendChild(s);const o=document.createElement("div");o.classList.add(W.bottomRight,W.corner),t.appendChild(o),this._innerContainer=t,this._manualContainer=e;const a=Ar();this._cornerNameToContainerLookup={"top-left":i,"top-right":n,"bottom-left":s,"bottom-right":o,"top-leading":a?n:i,"top-trailing":a?i:n,"bottom-leading":a?o:s,"bottom-trailing":a?s:o},this._positionNameToContainerLookup={manual:e,...this._cornerNameToContainerLookup}}_isValidPosition(t){return!!this._positionNameToContainerLookup[t]}_place(t){const e=t.position??"manual",{component:i,index:n}=t,s=this._positionNameToContainerLookup[e],o=n!=null&&n>-1;if(Ap(i.widget)&&i.widget.startup(),!o)return void s.appendChild(i.node);const a=Array.from(s.children);if(a.length!==0){for(const l of a){const c=this._findByNode(l);if(c&&n<(this._componentMap.get(c)?.index??0))return void l.parentNode?.insertBefore(i.node,l)}s.appendChild(i.node)}else s.appendChild(i.node)}_toPixelPosition(t){return{top:ei(t.top),left:ei(t.left),right:ei(t.right),bottom:ei(t.bottom)}}_findByComponent(t){return this._components.find((e=>e===t))??null}_findById(t){return this._components.find((({id:e})=>e===t))??null}_findByNode(t){return t?this._components.find((({node:e})=>e===t)):null}_getComponentsAtPosition(t,e){const i=this._positionNameToContainerLookup[t];return Array.prototype.slice.call(i.children).map((n=>this._findByNode(n))).filter(It).filter((n=>e.includeInternal||!this._componentMap.get(n)?.internal)).map((({widget:n,node:s})=>n??s))}_getNumComponentsAtPosition(t){return this._positionNameToContainerLookup[t]?.children.length??0}};r([h()],me.prototype,"_locale",void 0),r([h()],me.prototype,"container",null),r([h()],me.prototype,"height",null),r([h({value:qa})],me.prototype,"padding",null),r([En("padding")],me.prototype,"castPadding",null),r([h()],me.prototype,"view",void 0),r([h()],me.prototype,"width",null),me=r([_("esri.views.ui.UI")],me);const zp=me,Fp=new Map;function Np(t){return Fp.get(t)}function _o(t,e){return t&&"copyright"in t&&(!e||typeof t.originOf=="function"&&t.originOf("copyright")==="user")}function Hp(t,e){return t.length!==e.length||t.some(((i,n)=>i.text!==e[n].text))}function xt(t,e,i){!i||!e||t.find((n=>n.layerView===e&&n.text===i))||t.push({text:i,layerView:e})}function Zp(t){return t.type==="bing-maps"}const we=[];let ut=class extends x{constructor(t){super(t),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new I,this.view=null,this._allLayerViewsChange=e=>{this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const i=this.view?.allLayerViews;i&&(this.addHandles(i.map((n=>w((()=>[n.suspended,n.layer?.attributionVisible]),(()=>this._updateAttributionItems())))).toArray(),"suspension"),i.forEach((n=>{n.declaredClass==="esri.views.3d.layers.Tiles3DLayerView3D"&&this.addHandles(n.on("visible-geometry-changed",(()=>this._updateAttributionItems())),"visible-geometry-changed")}))),e?.removed&&e.removed.forEach((n=>{this._pendingAttributions.delete(n),this._fetchedAttributionData.delete(n)})),this._updateAttributionItems()},this.addHandles([Ti((()=>this.view?.allLayerViews),"change",(e=>this._allLayerViewsChange(e)),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),Je((()=>this.view?.stationary===!0),(()=>this._updateAttributionItems()))])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.view?.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const t=this.view,e=t?.allLayerViews;if(we.length=0,!t||!e)return void this._clear();e.forEach((n=>{if(n.suspended||!n.layer?.attributionVisible)return;const s=n.layer;if(_o(s,"user"))return void xt(we,n,s.copyright);if(s.hasAttributionData){if(this._fetchedAttributionData.has(n)){const a=this._fetchedAttributionData.get(n);return void(a?xt(we,n,this._getDynamicAttribution(a,t,s)):_o(s)&&xt(we,n,s.copyright))}return void this._fetchAttributionData(n)}const o="portalItem"in s?s.portalItem?.accessInformation:void 0;xt(we,n,o||s.copyright)}));const i=e.find((n=>n.layer?.type==="integrated-mesh-3dtiles"));if(this.view&&i){const n=Np(this.view);if(n){const s=n.getAttributionText();for(let o=0;o<s.length;++o)xt(we,i,s[o])}}Hp(this.items,we)&&(this.items.removeAll(),this.items.addMany(we)),we.length=0,this.notifyChange("state")}async _fetchAttributionData(t){if(this._pendingAttributions.has(t))return;this._pendingAttributions.add(t);const e=await Zr(t.layer.fetchAttributionData());if(this._pendingAttributions.has(t)){const i=e.ok?this._createContributionIndex(e.value,Zp(t.layer)):null;this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,i)}this._updateAttributionItems()}_createContributionIndex(t,e){const i=t.contributors,n={};if(!i)return n;for(let s=0;s<i.length;s++){const o=i[s],a=o.coverageAreas;if(!a)return;for(const l of a){const c=l.bbox,u=l.zoomMin-(e&&l.zoomMin?1:0),p=l.zoomMax-(e&&l.zoomMax?1:0),m=new Qe({xmin:c[1],ymin:c[0],xmax:c[3],ymax:c[2],spatialReference:ci.WGS84}),d={extent:Qr(m),attribution:o.attribution||"",score:l.score!=null?l.score:100,id:s};for(let g=u;g<=p;g++)n[g]??=[],n[g].push(d)}}return n.maxKey=Math.max.apply(null,Object.keys(n)),n}_getDynamicAttribution(t,e,i){const{extent:n,scale:s}=e;let o=i.tileInfo?.scaleToZoom(s)??0;if(o=Math.min(t.maxKey??0,Math.round(o)),!n||o==null||o<=-1)return"";const a=t[o],l=Xr(n.center.clone().normalize(),ci.WebMercator),c=new Set;return a?a.filter((u=>{const p=u.id,m=!c.has(p)&&l&&u.extent&&Ln(u.extent,l);return m&&c.add(p),m})).sort(((u,p)=>p.score-u.score||u.objectId-p.objectId)).map((u=>u.attribution)).join(", "):""}};r([h({readOnly:!0,type:I})],ut.prototype,"items",void 0),r([h({readOnly:!0})],ut.prototype,"state",null),r([h()],ut.prototype,"view",void 0),ut=r([_("esri.widgets.Attribution.AttributionViewModel")],ut);const Ga=ut;function qp(){return function(t,e){if(!t[e])throw new TypeError(`Cannot auto bind undefined function '${String(e)}'`);return{value:Wp(t[e])}}}function Gp(t){const e=t?.type;return t instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function Wp(t){return function(e,...i){Gp(e)?zr(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):t.call(this,e,...i)}}const st="esri-attribution",ot={base:st,poweredBy:`${st}__powered-by`,sources:`${st}__sources`,open:`${st}--open`,sourcesOpen:`${st}__sources--open`,link:`${st}__link`};let q=class extends Pi{constructor(e,i){super(e,i),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver((n=>n.forEach((({target:s})=>this._checkSourceTextOverflow(s))))),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new Ga}initialize(){this.addHandles(Ti((()=>this.viewModel?.items),"change",(()=>this.scheduleRender())))}destroy(){this._resizeObserver?.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce(((e,i)=>(e.includes(i.text)||e.push(i.text),e)),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[ot.open]:this._isOpen};return B("div",{bind:this,class:this.classes(ot.base,fe.widget,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return B("div",{class:ot.poweredBy},"Powered by"," ",B("a",{class:ot.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const e=this._isOpen,i=this._isInteractive,n=i?0:void 0,{attributionText:s}=this,o={[ot.sourcesOpen]:e,[fe.interactive]:i};return B("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(ot.sources,o),innerHTML:s,tabIndex:n})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let i=!1;const{clientHeight:n,clientWidth:s,scrollWidth:o}=e,a=o>s,l=this._attributionTextOverflowed!==a;if(this._attributionTextOverflowed=a,l&&(i=!0),this._isOpen){const c=n<this._prevSourceNodeHeight;this._prevSourceNodeHeight=n,c&&(this._isOpen=!1,i=!0)}i&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};r([h()],q.prototype,"_isOpen",void 0),r([h()],q.prototype,"_isInteractive",null),r([h()],q.prototype,"_attributionTextOverflowed",void 0),r([h()],q.prototype,"_prevSourceNodeHeight",void 0),r([h({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],q.prototype,"attributionText",null),r([h()],q.prototype,"icon",null),r([h()],q.prototype,"itemDelimiter",void 0),r([h()],q.prototype,"label",null),r([h(),$i("esri/widgets/Attribution/t9n/Attribution")],q.prototype,"messages",void 0),r([h()],q.prototype,"view",null),r([h({type:Ga})],q.prototype,"viewModel",void 0),r([qp()],q.prototype,"_toggleState",null),q=r([_("esri.widgets.Attribution")],q);const Up=q;function jp(){const t=z("mapview-essential-goto-duration");return t==null?t:se(t)}function Bp(t){return t?.spatialReference?.isWebMercator||t?.spatialReference?.isGeographic||!1}function Kp(t,e,i){return t.goTo(e,i)}const Yp=t=>{let e=class extends t{constructor(...i){super(...i),this.goToOverride=null,this.view=null}callGoTo(i){const{view:n}=this;return Sr(n),this.goToOverride?this.goToOverride(n,i):Kp(n,i.target,i.options)}};return r([h()],e.prototype,"goToOverride",void 0),r([h()],e.prototype,"view",void 0),e=r([_("esri.widgets.support.GoTo")],e),e};let We=class extends Yp(x){constructor(e){super(e),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._watchForView(G)}destroy(){this.view=null}get canShowNorth(){return Bp(this.view)}get state(){return!this.view?.ready||this.view.type==="2d"&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){this.view?.ready&&(this.view?.type==="2d"?this.callGoTo({target:{rotation:0},options:{animationMode:"always",duration:jp()}}):this.callGoTo({target:{heading:0}}))}_updateForRotation(e){e!=null&&this._set("orientation",{z:e})}_updateForCamera(e){if(!e)return;const i=-e.heading;this._set("orientation",{x:0,y:0,z:i})}_updateRotationWatcher(e){this.removeAllHandles(),this._watchForView(),e&&this.addHandles(e.type==="2d"?w((()=>e?.rotation),this._updateForRotation,G):w((()=>e?.camera),this._updateForCamera,G))}_watchForView(e){this.addHandles(w((()=>this.view),this._updateRotationWatcher,e))}};r([h({readOnly:!0})],We.prototype,"canShowNorth",null),r([h({readOnly:!0})],We.prototype,"orientation",void 0),r([h({readOnly:!0})],We.prototype,"state",null),r([h()],We.prototype,"view",void 0),We=r([_("esri.widgets.Compass.CompassViewModel")],We);const Wa=We,vo="esri-compass",wo={base:vo,iconContainer:`${vo}__icon-container`};let Me=class extends Pi{constructor(e,i){super(e,i),this.messages=null,this.viewModel=new Wa,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=n=>({transform:`rotateZ(${n.z}deg)`})}loadDependencies(){return Dn({button:()=>M(()=>import("./SudRs-ni.js"),__vite__mapDeps([335,336,20,1,2,3,4,9,10,11,12,8,13,5,21,22,337,338,339,340,341,342,343,344,345,346,347]),import.meta.url),icon:()=>M(()=>import("./COvnNhxK.js").then(e=>e.i),__vite__mapDeps([339,20,1,2,3,4,9,10,11,12,8,13,5,21,22,340,341]),import.meta.url)})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return this.viewModel.state==="rotation"?"arrow-up":"compass-needle"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:i}=this.viewModel,{messages:n}=this;return B("div",{class:this.classes(wo.base,fe.widget)},B("calcite-button",{class:fe.widgetButton,disabled:i==="disabled",kind:"neutral",label:n.reset,onclick:this._reset,round:!0,scale:"s",title:n.reset},B("div",{"aria-hidden":"true",class:wo.iconContainer,title:n.reset},B("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(e)}))))}};r([h()],Me.prototype,"goToOverride",null),r([h()],Me.prototype,"icon",null),r([h()],Me.prototype,"label",null),r([h(),$i("esri/widgets/Compass/t9n/Compass")],Me.prototype,"messages",void 0),r([h()],Me.prototype,"view",null),r([h({type:Wa})],Me.prototype,"viewModel",void 0),Me=r([_("esri.widgets.Compass")],Me);const Jp=Me,bo="esri-navigation-toggle",Mo={base:bo,isLayoutHorizontal:`${bo}--horizontal`};let pt=class extends x{constructor(t){super(t),this._navigationMode="pan",this.view=null,t?.isDefaultViewModel||cr(k.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.33"})}normalizeCtorArgs(t={}){const{isDefaultViewModel:e,...i}=t;return i}initialize(){this.addHandles(Je((()=>this.view?.navigation?.actionMap),(()=>this._updateNavigationActionMap())))}destroy(){this.view=null}get state(){return this.view?.ready&&this.view?.type==="3d"?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(t){this._navigationMode=t,this._updateNavigationActionMap()}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate")}_updateNavigationActionMap(){const t=this.view?.navigation?.actionMap;if(!t)return;const e=this._navigationMode==="pan";t.dragPrimary=e?"pan":"rotate",t.dragSecondary=e?"rotate":"pan"}};r([h({readOnly:!0})],pt.prototype,"state",null),r([h()],pt.prototype,"_navigationMode",void 0),r([h()],pt.prototype,"view",void 0),pt=r([_("esri.widgets.NavigationToggle.NavigationToggleViewModel")],pt);const Ua=pt;let xe=class extends Pi{constructor(e,i){super(e,i),this.messages=null,this.viewModel=new Ua({isDefaultViewModel:!0}),this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{const n=this.viewModel?.navigationMode==="pan"?this._rotateButton:this._panButton;Fr(n),this.toggle()},e?.isDefaultUI||ur(k.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.32"})}normalizeCtorArgs(e={}){const{isDefaultUI:i,...n}=e;return n}loadDependencies(){return Dn({button:()=>M(()=>import("./SudRs-ni.js"),__vite__mapDeps([335,336,20,1,2,3,4,9,10,11,12,8,13,5,21,22,337,338,339,340,341,342,343,344,345,346,347]),import.meta.url)})}get icon(){return"move"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e=this.viewModel?.state==="disabled",i=this.viewModel?.navigationMode==="pan",n=this.messages.toggle;return B("div",{class:this.classes(Mo.base,fe.widget,{[Mo.isLayoutHorizontal]:this.layout==="horizontal"})},B("calcite-button",{afterCreate:s=>{this._panButton=s},appearance:i?"outline-fill":"solid",class:fe.widgetButton,disabled:e,iconStart:"move",kind:"neutral",label:n,onclick:this._toggle,tabIndex:i?void 0:-1,title:n}),B("calcite-button",{afterCreate:s=>{this._rotateButton=s},appearance:i?"solid":"outline-fill",class:fe.widgetButton,disabled:e,iconStart:"rotate",kind:"neutral",label:n,onclick:this._toggle,tabIndex:i?-1:void 0,title:n}))}};r([h()],xe.prototype,"icon",null),r([h()],xe.prototype,"label",null),r([h({value:"vertical"})],xe.prototype,"layout",null),r([h(),$i("esri/widgets/NavigationToggle/t9n/NavigationToggle")],xe.prototype,"messages",void 0),r([h()],xe.prototype,"view",null),r([h({type:Ua})],xe.prototype,"viewModel",void 0),xe=r([_("esri.widgets.NavigationToggle")],xe);const Qp=xe;let Ue=class extends x{get canZoomIn(){if(!this.view?.ready)return!1;const e=this.view?.constraints?.effectiveMaxScale;return e===0||this._scale>e}get canZoomOut(){const{view:t}=this;if(!t?.ready)return!1;const i=t.constraints?.effectiveMinScale;return i===0||this._scale<i}get _scale(){const t=this.view?.animation?.target;return(t&&"then"in t?void 0:t?.scale)??this.view?.scale??0}};r([h({readOnly:!0})],Ue.prototype,"canZoomIn",null),r([h({readOnly:!0})],Ue.prototype,"canZoomOut",null),r([h()],Ue.prototype,"view",void 0),r([h()],Ue.prototype,"_scale",null),Ue=r([_("esri.widgets.Zoom.ZoomConditions2D")],Ue);const Xp=Ue;let dt=class extends x{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};r([h({readOnly:!0})],dt.prototype,"canZoomIn",null),r([h({readOnly:!0})],dt.prototype,"canZoomOut",null),r([h()],dt.prototype,"view",void 0),dt=r([_("esri.widgets.Zoom.ZoomConditions3D")],dt);const ed=dt;let Le=class extends x{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){return this._zoomConditions!=null&&this._zoomConditions?.canZoomOut}get state(){return this.view?.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new Xp({view:e}):e.type==="3d"&&(this._zoomConditions=new ed({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){const e=this.view;this.canZoomIn&&e&&(e.type==="2d"?e.mapViewNavigation.zoomIn():is(e.goTo({zoomFactor:2})))}zoomOut(){const e=this.view;this.canZoomOut&&e&&(e.type==="2d"?e.mapViewNavigation.zoomOut():is(e.goTo({zoomFactor:.5})))}};r([h()],Le.prototype,"_zoomConditions",void 0),r([h()],Le.prototype,"canZoomIn",null),r([h()],Le.prototype,"canZoomOut",null),r([h({readOnly:!0})],Le.prototype,"state",null),r([h()],Le.prototype,"view",null),Le=r([_("esri.widgets.Zoom.ZoomViewModel")],Le);const ja=Le,xo={base:"esri-zoom",horizontalLayout:"esri-zoom--horizontal"};let Te=class extends Pi{constructor(e,i){super(e,i),this.messages=null,this.viewModel=new ja,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return Dn({button:()=>M(()=>import("./SudRs-ni.js"),__vite__mapDeps([335,336,20,1,2,3,4,9,10,11,12,8,13,5,21,22,337,338,339,340,341,342,343,344,345,346,347]),import.meta.url)})}get icon(){return"magnifying-glass-plus"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e={[xo.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:i,canZoomOut:n}=this.viewModel,{zoomIn:s,zoomOut:o}=this.messages;return B("div",{class:this.classes(xo.base,fe.widget,e)},B("calcite-button",{class:fe.widgetButton,disabled:!i,iconStart:"plus",kind:"neutral",label:s,onclick:this.zoomIn,title:s}),B("calcite-button",{class:fe.widgetButton,disabled:!n,iconStart:"minus",kind:"neutral",label:o,onclick:this.zoomOut,title:o}))}};r([h()],Te.prototype,"icon",null),r([h()],Te.prototype,"label",null),r([h({value:"vertical"})],Te.prototype,"layout",null),r([h(),$i("esri/widgets/Zoom/t9n/Zoom")],Te.prototype,"messages",void 0),r([h()],Te.prototype,"view",null),r([h({type:ja})],Te.prototype,"viewModel",void 0),Te=r([_("esri.widgets.Zoom")],Te);const td=Te;function id(t){return t?.view!==void 0}let ri=class extends zp{constructor(t){super(t),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=e=>{this.components.forEach((i=>{const n=this._find(i),s=n?.widget;id(s)&&(s.view=e)}))},this._componentsWatcher=(e,i)=>{this._removeComponents(i),this._addComponents(e),this._adjustPadding(e)}}initialize(){this.addHandles([w((()=>this.components),this._componentsWatcher,G),w((()=>this.view),this._updateViewAwareWidgets,G)])}_add(t,e,i,n,s){let o=t;if(typeof t=="string"&&this._defaultPositionLookup[t]){if(this._find(t))return;o=this._createComponent(t)}super._add(o,e,i,n,s)}_removeComponents(t){t.forEach((e=>{const i=this._find(e);i&&(this.remove(i),i.destroy())}))}_adjustPadding(t){if(!t.includes("attribution")&&!this._isOverridden("padding")){const{top:e}=this.padding;this.padding=e}}_addComponents(t){this.constructed&&t.forEach((e=>this.add(this._createComponent(e),this._defaultPositionLookup[e])))}_createComponent(t){const e=this._createWidget(t);return new ai({id:t,node:e})}_createWidget(t){const e=this.view;switch(t){case"attribution":return new Up({view:e});case"compass":return new Jp({view:e});case"navigation-toggle":return new Qp({view:e,isDefaultUI:!0});case"zoom":return new td({view:e})}}};r([h()],ri.prototype,"components",void 0),ri=r([_("esri.views.ui.DefaultUI")],ri);const Ba=ri;let li=class extends Ba{constructor(t){super(t),this.components=["attribution","zoom"]}};r([h()],li.prototype,"components",void 0),li=r([_("esri.views.ui.2d.DefaultUI2D")],li);const Ka=li;let Ya,Ja,Qa,Xa,er,tr,ir;async function nd(){const[,{GraphicsView2D:t,GraphicContainer:e,LabelManager:i,MapViewNavigation:n,MagnifierView2D:s,GridView2D:o,Stage:a}]=await Promise.all([M(()=>import("./DUHXxiGY.js"),__vite__mapDeps([177,178,2,3,179,4,180,181,109,182,183]),import.meta.url),M(()=>import("./CnatBA7k.js"),__vite__mapDeps([184,8,3,2,4,185,15,1,170,33,34,18,95,76,96,186,41,187,188,189,36,17,16,12,13,45,32,40,35,110,109,190,93,91,92,191,192,193,171,194,195,196,197,64,47,65,198,199,132,166,200,54,37,52,53,30,55,10,11,7,43,56,201,202,179,180,181,182,178,203,204,205,5,206,207,208,209,210,211,212,213,214,215,216,99,74,75,217,218,219,220,221,44,111,112,38,62,222,223,224,225,226,227,228,86,87,31,77,88,89,90,229,230,177,183,231,232,233,234,235,26,85,236,237,238,239,240,241,108,242,9,71,67,14,243,114,115,104,105,102,106,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,50,51,259,139,260,261]),import.meta.url)]);Ja=t,Qa=e,Xa=i,er=n,tr=s,ir=o,Ya=a}var gt;let b=(gt=class extends _u(Dc(Fl(ih(Gl(nc))))){constructor(e){super(e),this._magnifierView=null,this._gridView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new $o({getCollections:()=>[this.basemapView?.baseLayerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.graphicsView=null,this.labelManager=null,this.navigation=new Vi({actionMap:new Hn({dragTertiary:"none"})}),this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this.floors=new I,this.grid=null,this.map=null,this.spatialReferenceLocked=!1,this.timeline=new Za,this.type="2d",this.view2dType=null,this.ui=new Ka,this.test={takeScreenshot:async i=>kp(this._getScreenshotView(i),i)},this.padding={top:0,right:0,bottom:0,left:0},kr()}destroy(){this.layerViewManager.clear(),this._set("preconditionsReady",!1),this.frameTask=le(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new tp(this.featuresTilingScheme)}get constraintsInfo(){const e=this.defaultsFromMap?.tileInfo,i=this.spatialReference;return{lods:e?.spatialReference?.equals(i)?e.lods:null,spatialReference:i}}get initialExtentRequired(){if(!this.stateManager)return!1;const{scale:e,constraints:i,center:n,viewpoint:s,extent:o}=this;let a=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties?.viewpoint)&&!o&&(i?.effectiveLODs||(a=-1),(!n||e===0&&a===-1)&&(s?.targetGeometry==null||s.targetGeometry.type!=="extent"&&!s.scale))}get defaultsFromMapSettings(){return{required:{extent:!1,heightModelInfo:!1,tileInfo:!0},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get scheduler(){return this.frameTask.scheduler}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const i=e.targetGeometry,n=this.spatialReference;return Dr(i.spatialReference,n)}get background(){return Ai(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){return this.stateManager?.center??null}set center(e){this.stateManager.center=e}get highlightOptions(){return fp(this)}set highlightOptions(e){yp(this,e)}get padding(){return this.stateManager?.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get rendering(){return this.stage?.renderRequested??!1}get resolution(){return this.stateManager.resolution??0}get scale(){return this.stateManager?.scale??0}set scale(e){this.stateManager&&(this.stateManager.scale=e)}get tileInfo(){return this.featuresTilingScheme?.tileInfo}get updating(){const e=!(!this.magnifier.visible||this.magnifier.position===null||!this._magnifierView?.updatingHandles.updating),i=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some((n=>!n.destroyed&&!("layerViews"in n)&&n.updating===!0))||e);if(z("esri-2d-log-updating")){const n=this.allLayerViews.reduce(((s,o)=>({...s,[`${o.layer.id}(${o.layer.type})`]:!o.destroyed&&!("layerViews"in o)&&o.updating})),{});console.log(`Updating MapView: ${i}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${this.layerViewManager?.updating}
-> labelManager.updating: ${this.labelManager?.updating}
-> graphicsView.updating: ${this.graphicsView?.updating}
-> allLayerViews: ${JSON.stringify(n)}
-> updatingMagnifier: ${e}
`)}return i}get visibleArea(){const e=this.stateManager.visibleArea;return e&&new Eo({rings:[e.map((i=>[i[0],i[1]]))],spatialReference:this.spatialReference})}get zoom(){return this.stateManager.zoom??-1}set zoom(e){this.stateManager.zoom=e}get navigating(){return this.mapViewNavigation?.interacting??!1}async hitTest(e,i){return _p(this,e,i)}async takeScreenshot(e){return Sp(this._getScreenshotView(e),e)}toScreen(e,i){return this.stateManager.toScreen(e,i)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise((e=>{this.ready?e(this):this._resolveWhenReady.push(e)}))}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){return this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties.spatialReference||this.defaultsFromMap?.spatialReference||null}getDefaultTimeZone(){return Ai(this.map)?this.map.initialViewProperties.timeZone:null}getDefaultTimeExtent(){return Ai(this.map)?this.map.initialViewProperties.timeExtent:null}hasLayerViewModule(e){return po.hasLayerViewModule(e)}importLayerView(e){return po.importLayerView(e)}pixelSizeAt(){return this.ready?this.resolution:(k.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(e){const i=this.toMap(e),n=await this.hitTest(e),s=this.allLayerViews.toArray().filter((u=>u.clips.every((p=>Ra(this,p,e,i))))).reverse(),o=new globalThis.Map(s.map((u=>[u.layer.uid,u]))),a=[];let l=0,c=0;for(;l<n.results.length||c<s.length;){const u=n.results.at(l);if(u&&u.type!=="graphic"){++l;continue}const p=o.get((u?.layer??u?.graphic.layer)?.uid);if((!u||p)&&c<s.length&&s.at(c)!==p){const m=s.at(c);"fetchPopupFeaturesAtLocation"in m&&a.push({mapPoint:i,layerView:m}),++c}else u&&(a.push({graphic:u.graphic,layerView:p}),++l)}return{hits:a,location:i}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let e=Vp(this.type);if(z("safari")&&z("safari")<9&&(e=new T("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:z("safari")})),e!=null){k.getLogger(this).warn("#validate()",e.message);const i=document.createElement("div");i.setAttribute("style","display: flex; flex-direction: column; gap: 8px; padding: 20px; height: 100%; justify-content: center; color: black; background: white; font-family: sans-serif;");const n=document.createElement("div");n.innerHTML="Unable to display map. WebGL2 support is required.",n.setAttribute("style","font-size: 24px; font-weight: bold;");const s=document.createElement("div");s.innerHTML="Ensure that your browser and hardware meet the minimum requirements.",s.setAttribute("style","font-size: 18px;");const o=document.createElement("a");throw o.innerHTML="https://esriurl.com/systemRequirements",o.target="_blank",o.setAttribute("style","font-size: 18px;"),o.href="https://esriurl.com/systemRequirements",i.appendChild(n),i.appendChild(s),i.appendChild(o),this.surface.appendChild(i),e}}loadAsyncDependencies(){return nd()}_getDefaultViewpoint(){const{constraints:e,initialExtent:i,map:n,padding:s,size:o}=this;if(!e)return null;const a=n&&"initialViewProperties"in n?n.initialViewProperties:void 0,l=this.stateManager.getUserStartupOptions(this.size),c=a?.viewpoint,u=c?.targetGeometry?.extent??i,p=u?.center,m=c?.rotation??0,d=c?.scale||u&&Di(u,[o[0]-s.left-s.right,o[1]-s.top-s.bottom]),g=l.center??p,v=l.rotation??m,f=l.scale??d;return g&&f?new ne({targetGeometry:g,scale:f,rotation:v}):null}_startup(){this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint();this.stateManager.startup(e,this.size,this.spatialReference,this.defaultsFromMap.extent?.center),this.graphics.owner=this;const i=new Qu(this.surface),n=new Ya(this.surface,{canvas:this.renderCanvas,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline},i);this.stage=n,this._magnifierView=new tr,this._magnifierView.magnifier=this.magnifier,this._gridView=new ir;const s=new Xa({view:this});this._set("labelManager",s);const o=new Yu({view:this});this._set("animationManager",o);const a=new er({view:this,animationManager:o});this._set("mapViewNavigation",a),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",(()=>this._updateStageChildren())),n.on("webgl-error",(c=>this.fatalError=c.error)),w((()=>this.stationary),(c=>n.stationary=c),ie),w((()=>this.background),(c=>{n.backgroundColor=c?.color,this._magnifierView.backgroundColor=c?.color}),ie),w((()=>this.magnifier),(c=>this._magnifierView.magnifier=c),ie),w((()=>this.grid),(c=>this._gridView.grid=c),ie),w((()=>this.renderingOptions),(c=>n.renderingOptions=c),ie),w((()=>this.highlights.items.map((c=>({name:c.name,options:{fillColor:c.color,haloColor:c.haloColor,fillOpacity:c.fillOpacity,haloOpacity:c.haloOpacity,haloWidth:c.haloWidth,haloBlur:c.haloBlur}})))),(()=>{n.highlightGradient=mp(n.highlightGradient,this.highlights.items)}),ie),w((()=>this.state.id),(()=>n.state=this.state),ie)],"map-view"),this._updateStageChildren();const l=this._resolveWhenReady;this._resolveWhenReady=[],l.forEach((c=>c(this))),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._gridView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._gridView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach((i=>{this.stage.addChild(i.container)}));const e=this.graphicsView;this.stage.addChild(e.container),this.stage.addChild(this._magnifierView),this.stage.addChild(this._gridView)}_setupSpatialReferenceDependentProperties(){const e=new $l(Lr.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const i=new Ja({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new Qa(e)});this._set("graphicsView",i)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),e.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(e){const{allLayerViews:i,padding:n,size:s,stage:o}=this;return{allLayerViews:i,backgroundColor:e?.ignoreBackground?null:this.background?.color,padding:n,size:s,stage:o}}_spatialReferenceChanged(e){if(this.ready){this.frameTask.stop();for(const i of this.allLayerViews)i.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(e),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const i of this.allLayerViews)i.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}},gt.type="2d",gt);r([h({constructOnly:!0})],b.prototype,"deactivatedWebGLExtensions",void 0),r([h({constructOnly:!0})],b.prototype,"debugWebGLExtensions",void 0),r([h({readOnly:!0})],b.prototype,"featuresTilingScheme",void 0),r([h({readOnly:!0})],b.prototype,"graphicsTileStore",null),r([h()],b.prototype,"graphicsView",void 0),r([h()],b.prototype,"constraintsInfo",null),r([h()],b.prototype,"initialExtentRequired",null),r([h()],b.prototype,"labelManager",void 0),r([h({type:Vi,nonNullable:!0})],b.prototype,"navigation",void 0),r([h({constructOnly:!0})],b.prototype,"renderCanvas",void 0),r([h()],b.prototype,"renderingOptions",void 0),r([h({constructOnly:!0})],b.prototype,"supersampleScreenshotsEnabled",void 0),r([h({readOnly:!0})],b.prototype,"supportsGround",void 0),r([h()],b.prototype,"defaultsFromMapSettings",null),r([h({readOnly:!0})],b.prototype,"typeSpecificPreconditionsReady",null),r([h({type:gr})],b.prototype,"background",null),r([h()],b.prototype,"center",null),r([h({type:I})],b.prototype,"floors",void 0),r([h()],b.prototype,"grid",void 0),r([h({type:Fe})],b.prototype,"highlightOptions",null),r([h()],b.prototype,"map",void 0),r([h()],b.prototype,"padding",null),r([h({readOnly:!0})],b.prototype,"rendering",null),r([h({readOnly:!0})],b.prototype,"resolution",null),r([h()],b.prototype,"scale",null),r([h({constructOnly:!0})],b.prototype,"spatialReferenceLocked",void 0),r([h({readOnly:!0})],b.prototype,"tileInfo",null),r([h({type:Za,readOnly:!0})],b.prototype,"timeline",void 0),r([h({readOnly:!0})],b.prototype,"type",void 0),r([h({readOnly:!0})],b.prototype,"updating",null),r([h({readOnly:!0})],b.prototype,"view2dType",void 0),r([h({readOnly:!0})],b.prototype,"visibleArea",null),r([h()],b.prototype,"zoom",null),r([h({readOnly:!0})],b.prototype,"navigating",null),r([h(),En((t=>t instanceof Ba?t:pr(Ka,t)))],b.prototype,"ui",void 0),b=r([_("esri.views.View2D")],b);const sd=b;let hi=class extends sd{constructor(t){super(t),this.view2dType="map"}};r([h({readOnly:!0})],hi.prototype,"view2dType",void 0),hi=r([_("esri.views.MapView")],hi);const od=hi,of=Object.freeze(Object.defineProperty({__proto__:null,default:od},Symbol.toStringTag,{value:"Module"}));export{uc as $,Dm as A,ta as B,Ug as C,zg as D,Fg as E,ip as F,fa as G,Za as H,Qu as I,Yp as J,Nm as K,jg as L,Gg as M,Wg as N,qg as O,Zg as P,pp as Q,tg as R,Ea as S,hp as T,Uh as U,jm as V,Ql as W,Bm as X,$s as Y,Ps as Z,Se as _,Rm as a,Ts as a0,Kg as a1,of as a2,mp as b,ea as c,Pc as d,ni as e,Go as f,yp as g,Bg as h,Om as i,ma as j,Oi as k,da as l,ga as m,pe as n,eg as o,wc as p,Vm as q,jp as r,Ia as s,fp as t,Fe as u,gp as v,ye as w,oc as x,Lm as y,Dt as z};
