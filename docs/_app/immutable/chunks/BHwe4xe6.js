import{b as Pt,a as Vt,f as Mt,S as et,r as nt,T as Rt,V as ut,c as Ut}from"./BFGjv385.js";import{s as ct,i as Lt}from"./DSdBzmdi.js";function Ye(e,t){for(const n of e.values())if(t(n))return!0;return!1}function Ge(e,t){for(const n of e.values())if(!t(n))return!1;return!0}function We(e,t){for(const n of e.values())if(t(n))return n;return null}function Be(e,t,n){const s=e.get(t);if(s!==void 0)return s;const r=n();return e.set(t,r),r}function He(e){const t=new Map;return n=>(t.has(n)||t.set(n,e(n)),t.get(n))}const Yt={remove:()=>{}};function c(e){return e?{remove(){e&&(e(),e=void 0)}}:Yt}function ht(e){e.forEach(t=>t?.remove())}function Ze(e){ht(e),e.length=0}function Gt(e){return c(()=>ht(e))}function Je(e){return c(()=>e()?.remove())}function Ke(e){return c(()=>e?.abort())}function Qe(e){return c(e!=null?()=>e.destroy():void 0)}function Wt(e){return typeof e=="object"&&!!e&&"remove"in e&&typeof e.remove=="function"}function Xe(e){Wt(e)&&e.remove()}function tn(e){return{[Symbol.dispose](){e.remove()}}}function Bt(e){return{setTimeout:(t,n)=>{const s=e.setTimeout(t,n);return c(()=>e.clearTimeout(s))}}}const Ht=Bt(globalThis);function ft(e){return Zt(e)||dt(e)}function Zt(e){return e!=null&&typeof e=="object"&&"on"in e&&typeof e.on=="function"}function dt(e){return e!=null&&typeof e=="object"&&"addEventListener"in e&&typeof e.addEventListener=="function"}function Jt(e,t,n){if(!ft(e))throw new TypeError("target is not a Evented or EventTarget object");return dt(e)?Kt(e,t,n):e.on(t,n)}function Kt(e,t,n,s){if(Array.isArray(t)){const r=t.slice();for(const i of r)e.addEventListener(i,n,s);return c(()=>{for(const i of r)e.removeEventListener(i,n,s)})}return e.addEventListener(t,n,s),c(()=>e.removeEventListener(t,n,s))}function pt(e,t,n){if(!ft(e))throw new TypeError("target is not a Evented or EventTarget object");if("once"in e)return e.once(t,n);const s=Jt(e,t,r=>{s.remove(),n.call(e,r)});return s}function en(e,t){if(e==null)throw new Error(t??"value is None")}function nn(e){return e?.destroy(),null}function sn(e){return e?.dispose(),null}function Qt(e){return e?.remove(),null}function rn(e){return e?.abort(),null}function an(e){return e?.release(),null}function on(e,t,n){return e!=null&&t!=null?n!=null?n(e,t):e.equals(t):e===t}function ln(e,t){let n;return e.some((s,r)=>(n=t(s,r),n!=null)),n??void 0}function v(e="Aborted"){return new ct("AbortError",e)}function mt(e,t="Aborted"){if(gt(e))throw v(t)}function M(e){return e instanceof AbortSignal?e:e?.signal??void 0}function gt(e){const t=M(e);return t!=null&&t.aborted}function un(e){if(J(e))throw e}function cn(e){if(!J(e))throw e}function I(e,t){const n=M(e);if(n!=null){if(!n.aborted)return pt(n,"abort",()=>t());t()}}function hn(e,t){const n=M(e);if(n!=null)return mt(n),pt(n,"abort",()=>t(v()))}function fn(e,t){return M(t)==null?e:new Promise((n,s)=>{let r=I(t,()=>s(v()));const i=()=>{r=Qt(r)};e.then(i,i),e.then(n,s)})}function J(e){return e?.name==="AbortError"}async function dn(e){try{return await e}catch(t){if(!J(t))throw t;return}}async function Xt(e){if(!e)return;if(typeof e.forEach!="function"){const n=Object.keys(e),s=n.map(a=>e[a]),r=await Xt(s),i={};return n.map((a,o)=>i[a]=r[o]),i}const t=e;return Promise.allSettled(t).then(n=>Array.from(t,(s,r)=>{const i=n[r];return i.status==="fulfilled"?{promise:s,value:i.value}:{promise:s,error:i.reason}}))}async function pn(e){return(await Promise.allSettled(e)).filter(t=>t.status==="fulfilled").map(t=>t.value)}async function mn(e){return(await Promise.allSettled(e)).filter(t=>t.status==="rejected").map(t=>t.reason)}function te(e,t=void 0,n){const s=new AbortController;return I(n,()=>s.abort()),new Promise((r,i)=>{let a=setTimeout(()=>{a=0,r(t)},e);I(s,()=>{a&&(clearTimeout(a),i(v()))})})}function gn(e,t,n,s){const r=n&&"abort"in n?n:null;s!=null||r||(s=n);let i=setTimeout(()=>{i=0,r?.abort()},t);const a=()=>s||new ct("promiseUtils:timeout","The wrapped promise did not resolve within "+t+" ms");return e.then(o=>{if(i===0)throw a();return clearTimeout(i),o},o=>{throw clearTimeout(i),i===0?a():o})}function $n(e,t){const n=new AbortController,s=setTimeout(()=>n.abort(),t);return I(e,()=>{n.abort(),clearTimeout(s)}),{...e,signal:n.signal}}function ee(e){return e&&typeof e.then=="function"}function st(e){return ee(e)?e:Promise.resolve(e)}function _n(e,t=-1){let n,s,r,i,a=null;const o=(...l)=>{if(n){s=l,i&&i.reject(v()),i=G();const d=i.promise;if(a){const U=a;a=null,U.abort()}return d}if(r=i||G(),i=null,t>0){const d=new AbortController;n=st(e(...l,d.signal));const U=n;te(t).then(()=>{n===U&&(i?d.abort():a=d)})}else n=1,n=st(e(...l));const u=()=>{const d=s;s=r=n=a=null,d!=null&&o(...d)},h=n,y=r;return h.then(u,u),h.then(y.resolve,y.reject),y.promise};return o}function G(){let e,t;const n=new Promise((r,i)=>{e=r,t=i}),s=r=>{e(r)};return s.resolve=r=>e(r),s.reject=r=>t(r),s.timeout=(r,i)=>Ht.setTimeout(()=>s.reject(i),r),s.promise=n,s}function vn(e,t){t.then(e.resolve,e.reject)}async function yn(e){await Promise.resolve(),mt(e)}function ne(e){return e?.release&&typeof e.release=="function"}function se(e){return e?.acquire&&typeof e.acquire=="function"}var p;let $t=(p=class{constructor(t,n,s,r=1,i=0){this._creator=t,this._acquireFunction=n,this._releaseFunction=s,this.allocationSize=r,this._pool=new Array(i),this._initialSize=i;for(let a=0;a<i;a++)this._pool[a]=this._creator();this.allocationSize=Math.max(r,1)}destroy(){this.prune(0)}acquire(...t){let n;if(p.test.disabled)n=this._creator();else{if(this._pool.length===0){const s=this.allocationSize;for(let r=0;r<s;r++)this._pool[r]=this._creator()}n=this._pool.pop()}return this._acquireFunction?this._acquireFunction(n,...t):se(n)&&n.acquire(...t),n}release(t){t&&!p.test.disabled&&(this._releaseFunction?this._releaseFunction(t):ne(t)&&t.release(),this._pool.push(t))}prune(t=this._initialSize){if(!(t>=this._pool.length)){for(let n=t;n<this._pool.length;++n){const s=this._pool[n];this._dispose(s)}this._pool.length=t}}_dispose(t){t.dispose&&typeof t.dispose=="function"&&t.dispose()}},p.test={disabled:!!Pt("esri-tests-disable-memory-pools")},p);function re(e){e.length=0}let _t=class{constructor(t=50,n=50){this._pool=new $t(()=>[],void 0,re,n,t)}acquire(){return this._pool.acquire()}release(t){this._pool.release(t)}prune(){this._pool.prune(0)}static acquire(){return L.acquire()}static release(t){return L.release(t)}static prune(){L.prune()}};const L=new _t(100);function vt(e){return e.__accessor__??null}function ie(e,t){return e?.metadata?.[t]!=null}function bn(e,t,n){return n?F(e,t,{policy:n,path:""}):F(e,t,null)}function F(e,t,n){return t?Object.keys(t).reduce((s,r)=>{const i=r;if(i==="__proto__")return s;let a=null,o="merge";if(n&&(a=n.path?`${n.path}.${r}`:r,o=n.policy(a)),o==="replace"||o==="replace-arrays"&&Array.isArray(s[i]))return s[i]=t[i],s;if(s[i]===void 0)return s[i]=Vt(t[i]),s;let l=s[i],u=t[i];if(l===u)return s;if(Array.isArray(u)||Array.isArray(s))l=l?Array.isArray(l)?s[i]=l.slice():s[i]=[l]:s[i]=[],u&&(Array.isArray(u)||(u=[u]),u.forEach(h=>{l.includes(h)||l.push(h)}));else if(u&&typeof u=="object")if(n){const h=n.path;n.path=a,s[i]=F(l,u,n),n.path=h}else s[i]=F(l,u,null);else s.hasOwnProperty(r)&&!t.hasOwnProperty(r)||(s[i]=u);return s},e||{}):e}function yt(e){return Array.isArray(e)?e:e.split(".")}function rt(e){return e.includes(",")?e.split(",").map(t=>t.trim()):[e.trim()]}function ae(e){if(Array.isArray(e)){const t=[];for(const n of e)t.push(...rt(n));return t}return rt(e)}function wt(e,t,n,s){const r=ae(t);if(r.length!==1){const i=r.map(a=>s(e,a,n));return Gt(i)}return s(e,r[0],n)}function bt(e,t){const n=e.endsWith("?")?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const r=parseInt(n,10);if(!isNaN(r))return Array.isArray(t)?t[r]:t.at(r)}const s=vt(t);return ie(s,n)?s.get(n):t[n]}function At(e,t,n){if(e==null)return e;const s=bt(t[n],e);return!s&&n<t.length-1?void 0:n===t.length-1?s:At(s,t,n+1)}function R(e,t,n=0){return typeof t!="string"||t.includes(".")?At(e,yt(t),n):bt(t,e)}function An(e,t){return R(e,t)}function kn(e,t){return R(t,e)!==void 0}const K={INITIALIZING:0,CONSTRUCTING:1,CONSTRUCTED:2,DESTROYING:3,DESTROYED:4},A={Dirty:1,Overridden:2,Computing:4,NonNullable:8,HasDefaultValue:16,DepTrackingInitialized:32,AutoTracked:64,ExplicitlyTracking:128};let kt=class{constructor(t){this.accessed=void 0,this._handles=void 0,this._observer=t}destroy(){this.accessed?.clear(),this.clear()}onAccessed(t){this._observer!=null&&t!==this._observer&&(this.accessed==null&&(this.accessed=new Set),this.accessed.add(t))}onTrackingEnd(){this._observer!=null&&(this.clear(),this.accessed!=null&&(this._handles==null&&(this._handles=[]),this.accessed.forEach(t=>{this._handles.push(t.observe(this._observer))}),this.accessed.clear()))}clear(){if(this._handles!=null){for(let t=0;t<this._handles.length;++t)this._handles[t].remove();this._handles.length=0}}};const z=new kt,b=[];let k=z;function oe(e){k.onAccessed(e)}let S=!1,D=!1;function _(e,t,n){if(S)return Q(e,t,n);let s=null;return Tt(e),s=t.call(n),Et(),s}function En(e,t){return _(z,e,t)}function Q(e,t,n){const s=S;S=!0,Tt(e);let r=null;try{r=t.call(n)}catch(i){D&&Lt.getLogger("esri.core.accessorSupport.tracking").error(i)}return Et(),S=s,r}function Tt(e){k=e,b.push(e)}function Et(){const e=b.length;if(e>1){const t=b.pop();k=b[e-2],t.onTrackingEnd()}else if(e===1){const t=b.pop();k=z,t.onTrackingEnd()}else k=z}function le(e,t){if(t.flags&A.DepTrackingInitialized)return;t.flags|=A.DepTrackingInitialized;const n=D;D=!1,t.flags&A.AutoTracked?Q(t.trackingTarget,t.metadata.get,e):ce(e,t),D=n}const ue=[];function ce(e,t){t.flags&A.ExplicitlyTracking||(t.flags|=A.ExplicitlyTracking,Q(t.trackingTarget,()=>{const n=t.metadata.dependsOn||ue;for(const s of n)if(typeof s!="string"||s.includes(".")){const r=yt(s);for(let i=0,a=e;i<r.length&&a!=null&&typeof a=="object";++i)a=it(a,r[i],i!==r.length-1)}else it(e,s,!1)}),t.flags&=-129)}function it(e,t,n){const s=t.endsWith("?")?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const i=parseInt(s,10);if(!isNaN(i))return Array.isArray(e)?e[i]:e.at(i)}const r=vt(e);if(r){const i=r.propertiesByName.get(s);i&&(oe(i),le(e,i))}return n?e[s]:void 0}let he=class extends $t{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...t){const n=super.acquire(...t);return this._set.delete(n),n}release(t){t&&!this._set.has(t)&&(super.release(t),this._set.add(t))}_dispose(t){this._set.delete(t),super._dispose(t)}};const E=[];function qt(e){E.push(e),E.length===1&&queueMicrotask(()=>{const t=E.slice();E.length=0;for(const n of t)n()})}let St=class{constructor(t,n=30){this.name=t,this._counter=0,this._samples=new Array(n)}push(t){t!=null&&(this._samples[++this._counter%this._samples.length]=t)}set(t){t!=null&&(this._samples[this._counter%this._samples.length]=t)}get median(){return this._samples.slice().sort((t,n)=>t-n)[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce((t,n)=>t+n,0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};const O=(e,t,n,s)=>{let r=t,i=t;const a=n>>>1,o=e[r-1];for(;i<=a;){i=r<<1,i<n&&s(e[i-1],e[i])<0&&++i;const l=e[i-1];if(s(l,o)<=0)break;e[r-1]=l,r=i}e[r-1]=o},Dt=(e,t)=>e<t?-1:e>t?1:0;function fe(e,t,n,s){n===void 0&&(n=e.length),s===void 0&&(s=Dt);for(let i=n>>>1;i>t;i--)O(e,i,n,s);const r=t+1;for(let i=n-1;i>t;i--){const a=e[t];e[t]=e[i],e[i]=a,O(e,r,i,s)}}function*de(e,t,n,s){n===void 0&&(n=e.length),s===void 0&&(s=Dt);for(let i=n>>>1;i>t;i--)O(e,i,n,s),yield;const r=t+1;for(let i=n-1;i>t;i--){const a=e[t];e[t]=e[i],e[i]=a,O(e,r,i,s),yield}}const pe=1.5,me=1.1;let jt=class{constructor(t){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new Mt,t&&(t.initialSize&&(this.data=new Array(t.initialSize)),t.allocator&&(this._allocator=t.allocator),t.deallocator!==void 0&&(this._deallocator=t.deallocator),t.shrink&&(this._shrink=()=>at(this)))}toArray(){return this.data.slice(0,this.length)}filter(t){const n=new Array;for(let s=0;s<this._length;s++){const r=this.data[s];t(r)&&n.push(r)}return n}at(t){if((t=Math.trunc(t)||0)<0&&(t+=this._length),!(t<0||t>=this._length))return this.data[t]}includes(t,n){const s=this.data.indexOf(t,n);return s!==-1&&s<this.length}get length(){return this._length}set length(t){if(t>this._length){if(this._allocator){for(;this._length<t;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=t}else{if(this._deallocator)for(let n=t;n<this._length;++n)this.data[n]=this._deallocator(this.data[n]);this._length=t,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(t){this.data[this._length++]=t}pushArray(t,n=t.length){for(let s=0;s<n;s++)this.data[this._length++]=t[s]}fill(t,n){for(let s=0;s<n;s++)this.data[this._length++]=t}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const t=this.data[this._length];return++this._length,t}unshift(t){this.data.unshift(t),this._length++,at(this)}pop(){if(this.length===0)return;const t=this.data[this.length-1];return this.length=this.length-1,this._shrink(),t}remove(t){const n=et(this.data,nt(t),this.length,this._hint);if(n!==-1)return this.data.splice(n,1),this.length=this.length-1,t}removeUnordered(t){return this.removeUnorderedIndex(et(this.data,nt(t),this.length,this._hint))}removeUnorderedIndex(t){if(!(t>=this.length||t<0))return this.swapElements(t,this.length-1),this.pop()}removeUnorderedMany(t,n=t.length,s){this.length=Rt(this.data,t,this.length,n,this._hint,s),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(t,n){if(t>=this.length||n>=this.length||t===n)return;const s=this.data[t];this.data[t]=this.data[n],this.data[n]=s}sort(t){fe(this.data,0,this.length,t)}iterableSort(t){return de(this.data,0,this.length,t)}some(t,n){for(let s=0;s<this.length;++s)if(t.call(n,this.data[s],s,this.data))return!0;return!1}find(t,n){const{data:s,length:r}=this;for(let i=0;i<r;++i)if(t.call(n,s[i]))return s[i]}filterInPlace(t,n){let s=0;for(let r=0;r<this._length;++r){const i=this.data[r];t.call(n,i,r,this.data)&&(this.data[r]=this.data[s],this.data[s]=i,s++)}if(this._deallocator)for(let r=s;r<this._length;r++)this.data[r]=this._deallocator(this.data[r]);return this._length=s,this._shrink(),this}forAll(t,n){const{data:s,length:r}=this;for(let i=0;i<r;++i)t.call(n,s[i],i,s)}forEach(t,n){this.data.slice(0,this.length).forEach(t,n)}map(t,n){const s=new Array(this.length);for(let r=0;r<this.length;++r)s[r]=t.call(n,this.data[r],r,this.data);return s}reduce(t,n){let s=n;for(let r=0;r<this.length;++r)s=t(s,this.data[r],r,this.data);return s}has(t){const n=this.length,s=this.data;for(let r=0;r<n;++r)if(s[r]===t)return!0;return!1}*[Symbol.iterator](){for(let t=0;t<this.length;t++)yield this.data[t]}};function at(e){e.data.length>pe*e.length&&(e.data.length=Math.floor(e.length*me))}function jn(e){return e}function In(e){return 1e3*e}function Fn(e){return e}function zn(e){return .001*e}let ge=class{constructor(t){this.phases=t,this.paused=!1,this.ticks=-1,this.removed=!1}},$e=class{constructor(t){this.callback=t,this.isActive=!0}remove(){this.isActive=!1}},W=0;const w={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},B=["prepare","preRender","render","postRender","update","finish"],H=[],g=new jt;class _e{constructor(t){this._task=t}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1,It()}}function ve(){m!=null&&(cancelAnimationFrame(m),m=requestAnimationFrame(X))}function It(){m==null&&(W=performance.now(),m=requestAnimationFrame(X))}const C={frameTasks:g,willDispatch:!1,clearFrameTasks:we,dispatch:zt,executeFrameTasks:be,reschedule:ve};function ye(e){const t=new $e(e);return H.push(t),C.willDispatch||(C.willDispatch=!0,qt(zt)),t}function Nn(e){const t=new ge(e);return g.push(t),It(),new _e(t)}let m=null;function we(e=!1){g.forAll(t=>{t.removed=!0}),e&&Ft()}function X(){const e=performance.now();m=null,m=g.some(n=>!n.paused&&!n.removed)?requestAnimationFrame(X):null,C.executeFrameTasks(e)}function be(e){const t=e-W;W=e;const n=1e3/60,s=Math.max(0,t-n);w.time=e,w.frameDuration=n-s;for(let r=0;r<B.length;r++){const i=performance.now(),a=B[r];g.forAll(o=>{o.paused||o.removed||(r===0&&o.ticks++,o.phases[a]&&(w.elapsedFrameTime=performance.now()-e,w.deltaTime=o.ticks===0?0:t,o.phases[a]?.call(o,w)))}),Te[r].push(performance.now()-i)}Ft(),Ee.push(performance.now()-e)}const q=new jt;function Ft(){g.forAll(e=>{e.removed&&q.push(e)}),g.removeUnorderedMany(q.data,q.length),q.clear()}function zt(){for(;H.length;){const e=H.shift();e.isActive&&e.callback()}C.willDispatch=!1}function Ae(e=1,t){const n=G(),s=()=>{gt(t)?n.reject(v()):e===0?n():(--e,qt(()=>s()))};return s(),n.promise}function ke(e){return Ae(1,e)}async function xn(e){await ke(e),await new Promise(t=>requestAnimationFrame(()=>{e?.aborted||t()}))}const Te=B.map(e=>new St(e)),Ee=new St("total");function qe(e,t){for(const n of e.values())if(t(n))return!0;return!1}function ot(e,t){if(!t)return e;for(const n of t)n!=null&&e.add(n);return e}function Pn(e,t){return t!=null&&e.add(t),e}function Se(e,t){const n=new Set;return ot(n,e),ot(n,t),n}function De(e,t){const n=new Set;for(const s of t)e.has(s)&&n.add(s);return n}function Vn(e,t){if(!e||!t)return!1;if(e===t)return!0;for(const n of e)if(!t.has(n))return!1;return!0}function Mn(e,t){if(e==null&&t==null)return!0;if(e==null||t==null||e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function je(e,t){const n=new Set(e);for(const s of t)n.delete(s);return n}function Rn(e,t){return je(Se(e,t),De(e,t))}let Ie=0;function Y(){return++Ie}class tt extends kt{constructor(t){super(new Fe(t)),this._observer&&lt.register(this,new WeakRef(this._observer),this)}destroy(){this._observer&&lt.unregister(this._observer),this.accessed?.clear(),this.clear(),this._observer?.destroy()}}let Fe=class{constructor(t){this._notify=t,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const t=this._invalidCount;if(t===1)return this._invalidCount=0,void this._notify();this._invalidCount=t>0?t-1:0}destroy(){this.destroyed=!0,this._notify=ze}};const lt=new FinalizationRegistry(e=>{e.deref()?.destroy()});function ze(){}let $=!1;const N=[];function Ot(e,t){let n=new tt(i),s=null,r=!1;function i(){if(!n||r)return;if($)return void Nt(i);const o=s;n.clear(),$=!0,r=!0,s=_(n,e),r=!1,$=!1,t(s,o),xt()}function a(){n&&(n.destroy(),n=null,s=null)}return r=!0,s=_(n,e),r=!1,c(a)}function Ct(e,t){let n=new tt(r),s=null;function r(){t(s,a)}function i(){n&&(n.destroy(),n=null),s=null}function a(){return n?(n.clear(),s=_(n,e),s):null}return a(),c(i)}function Ln(e,t){let n=!1,s=!1;const r=!!t?.sync;let i=new tt(()=>{n||s||(s=!0,r?a():queueMicrotask(a))});function a(){s=!1,i&&!n&&($?Nt(a):(i.clear(),$=!0,n=!0,_(i,e),n=!1,$=!1,xt()))}function o(){i&&(i.destroy(),i=null)}return n=!0,_(i,e),n=!1,c(o)}function Nt(e){N.includes(e)||N.unshift(e)}function xt(){for(;N.length;)N.pop()()}const V=class V{constructor(){this.uid=Y(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(t,n,s,r,i){return this.pool.acquire(0,t,n,s,r,i,ut)}static acquireTracked(t,n,s,r){return this.pool.acquire(1,t,n,s,null,null,r)}notify(t,n){this.type===0?this.callback.call(this.target,t,n,this.path,this.target):this.callback.call(null,t,n,void 0,void 0)}acquire(t,n,s,r,i,a,o){this.uid=Y(),this.removed=!1,this.type=t,this.oldValue=n,this.callback=s,this.getValue=r,this.target=i,this.path=a,this.equals=o}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=Y(),this.removed=!0}};V.pool=new he(()=>new V);let T=V;const j=new _t,f=new Set;let x;function P(e){f.delete(e),f.add(e),Oe()}function Oe(){x||(x=ye(Ne))}function Ce(e){if(e.removed)return;const t=e.oldValue,n=e.getValue();e.equals(t,n)||(e.oldValue=n,e.notify(n,t))}function Yn(e){for(const t of f.values())t.target===e&&(t.removed=!0)}function Ne(){let e=10;for(;x&&e--;){x=null;const t=xe(),n=j.acquire();for(const s of t){const r=s.uid;Ce(s),r===s.uid&&s.removed&&n.push(s)}for(const s of f)s.removed&&(n.push(s),f.delete(s));for(const s of n)T.pool.release(s);j.release(n),j.release(t),Z.forEach(s=>s())}}function xe(){const e=j.acquire();e.length=f.size;let t=0;for(const n of f)e[t]=n,++t;return f.clear(),e}const Z=new Set;function Gn(e){return Z.add(e),c(()=>Z.delete(e))}function Pe(e,t,n){let s=wt(e,t,n,(r,i,a)=>{let o,l,u=Ct(()=>R(r,i),(h,y)=>{r.__accessor__?.lifecycle===K.DESTROYED||o&&o.uid!==l?s.remove():(o||(o=T.acquireUntracked(h,a,y,r,i),l=o.uid),P(o))});return c(()=>{u.remove(),o&&(o.uid!==l||o.removed||(o.removed=!0,P(o)),o=null),s=u=null})});return s}function Ve(e,t,n){const s=wt(e,t,n,(r,i,a)=>{let o=!1;return Ot(()=>R(r,i),(l,u)=>{r.__accessor__.lifecycle!==K.DESTROYED?o||(o=!0,ut(u,l)||a.call(r,l,u,i,r),o=!1):s.remove()})});return s}function Wn(e,t,n,s=!1){return e.__accessor__&&e.__accessor__.lifecycle!==K.DESTROYED?s?Ve(e,t,n):Pe(e,t,n):c()}function Me(e,t,n){let s,r,i=Ct(e,(a,o)=>{s&&s.uid!==r?i.remove():(s||(s=T.acquireTracked(a,t,o,n),r=s.uid),P(s))});return c(()=>{i.remove(),s&&(s.uid!==r||s.removed||(s.removed=!0,P(s)),s=null),i=null})}function Re(e,t,n){let s=!1;return Ot(e,(r,i)=>{s||(s=!0,n(i,r)||t(r,i),s=!1)})}function Bn(e,t,n=!1,s=Ut){return n?Re(e,t,s):Me(e,t,s)}function Hn(e){return qe(f,t=>t.oldValue===e)}export{G as $,ye as A,dn as B,ee as C,vn as D,Qe as E,Ke as F,fn as G,pn as H,_t as I,Y as J,An as K,_n as L,on as M,an as N,yn as O,mn as P,Ae as Q,qt as R,st as S,te as T,Bn as U,St as V,cn as W,In as X,Fn as Y,Se as Z,Mn as _,c as a,Vn as a0,je as a1,De as a2,tt as a3,_ as a4,Ye as a5,Pn as a6,M as a7,ln as a8,qe as a9,$n as aA,Rn as aB,Ht as aC,We as aD,Je as aE,gn as aa,He as ab,ke as ac,tn as ad,xn as ae,zn as af,Ze as ag,bn as ah,kt as ai,A as aj,ce as ak,En as al,K as am,le as an,Yn as ao,Wn as ap,R as aq,kn as ar,ht as as,ot as at,Nn as au,Ge as av,he as aw,Gn as ax,Hn as ay,Oe as az,gt as b,v as c,J as d,rn as e,un as f,Be as g,hn as h,Ln as i,vt as j,oe as k,Qt as l,$t as m,ft as n,Jt as o,en as p,Xt as q,jt as r,mt as s,Gt as t,nn as u,pt as v,I as w,sn as x,jn as y,Xe as z};
