const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DjMrVzVv.js","./Y_0EfhRu.js","./DwWpeHsS.js","./bnayRBMH.js","./DnPXeCyQ.js","./BVgVoZ7V.js","./DFoMxmW4.js","./CeRhhlE3.js","./PPVm8Dsz.js","./DRAy6pQp.js","./TaFUw3Kk.js","./CAYuU9oo.js","./CFn2K6-l.js","./6W6J17CP.js","./v5xyD8FI.js","./DdbdneQ1.js","./CUKvHaKn.js","./GnozomzB.js","./BQME-Dbz.js","./CGdpgIRD.js","./qyF9FwQ9.js","./XI-Li77m.js","./C0C4qpaj.js","./Br1Hzhym.js"])))=>i.map(i=>d[i]);
import{n as j,_ as i,m as o,a as S,bl as ie,g as x,B as ge,b as p,o as be,c as ve,r as z,s as we,a9 as xe,N as Se,b9 as Ie,H as $e}from"./DwWpeHsS.js";import{a8 as re,H as oe}from"./CeRhhlE3.js";import{r as M,u as b}from"./Y_0EfhRu.js";import{aM as Ve,n as W,aH as B,aN as P,v as _e,ad as X,G as ne}from"./6W6J17CP.js";import{m as Ee,v as O,a as E,n as le,y as ke,f as je,h as Be,V as Fe,j as Ne}from"./gul0yLcR.js";import{d as ae,$ as ue}from"./C4m88JEB.js";import{_ as Te}from"./PPVm8Dsz.js";import{e as Ce}from"./BmgeYasw.js";import{r as De}from"./CUKvHaKn.js";import{Z as Y}from"./DRAy6pQp.js";import{m as Me,f as Oe,_ as ze}from"./BQME-Dbz.js";import{H as Pe}from"./qyF9FwQ9.js";import{m as Z,a as Re,o as pe}from"./DdbdneQ1.js";import{l as K}from"./v5xyD8FI.js";import{a as Le,e as qe,c as He}from"./C7Pxb65r.js";import{p as ce}from"./DfYjIaZP.js";var R;let w=R=class extends j{constructor(e){super(e),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new R({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?.clone()??null})}getMeshHash(){const e=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${e}`}};i([o({type:String,json:{write:!0}})],w.prototype,"description",void 0),i([o({type:String,json:{write:!0}})],w.prototype,"label",void 0),i([o({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],w.prototype,"minValue",void 0),i([o({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],w.prototype,"maxValue",void 0),i([o(Ee)],w.prototype,"symbol",void 0),w=R=i([S("esri.renderers.support.ClassBreakInfo")],w);var L;const de="log",T="percent-of-total",C="field",N=new be({esriNormalizeByLog:de,esriNormalizeByPercentOfTotal:T,esriNormalizeByField:C}),Ae=ge(w);let y=L=class extends O(E){constructor(e){super(e),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(e,t,s){if(!Array.isArray(e))return;let r=t.minValue;return e.map(n=>{const l=new w;return l.read(n,s),l.minValue==null&&(l.minValue=r),l.maxValue==null&&(l.maxValue=l.minValue),r=l.maxValue,l})}writeClassBreakInfos(e,t,s,r){const n=e.map(l=>l.write({},r));this._areClassBreaksConsecutive()&&n.forEach(l=>delete l.classMinValue),t[s]=n}castField(e){return e==null?e:typeof e=="function"?(x.getLogger(this).error(".field: field must be a string value"),null):ie(e)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let e=this._get("normalizationType");const t=!!this.normalizationField,s=this.normalizationTotal!=null;return t||s?(e=t&&C||s&&T||null,t&&s&&x.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):e!==C&&e!==T||(e=null),e}set normalizationType(e){this._set("normalizationType",e)}addClassBreakInfo(e,t,s){let r=null;r=typeof e=="number"?new w({minValue:e,maxValue:t,symbol:Ve(s)}):Ae(p(e)),this.classBreakInfos.push(r),this.classBreakInfos.length===1&&this.notifyChange("minValue")}removeClassBreakInfo(e,t){const s=this.classBreakInfos.length;for(let r=0;r<s;r++){const n=[this.classBreakInfos[r].minValue,this.classBreakInfos[r].maxValue];if(n[0]===e&&n[1]===t){this.classBreakInfos.splice(r,1);break}}}getBreakIndex(e,t){return this.valueExpression&&t?.arcade==null&&x.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(e,t):this._getBreakIndexForField(e)}async getClassBreakInfo(e,t){let s=t;this.valueExpression&&t?.arcade==null&&(s={...s,arcade:await W()});const r=this.getBreakIndex(e,s);return r!==-1?this.classBreakInfos[r]:null}getSymbol(e,t){if(this.valueExpression&&t?.arcade==null)return void x.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const s=this.getBreakIndex(e,t);return s>-1?this.classBreakInfos[s].symbol:this.defaultSymbol}async getSymbolAsync(e,t){let s=t;if(this.valueExpression&&t?.arcade==null){const n=await W(),{arcadeUtils:l}=n;l.hasGeometryOperations(this.valueExpression)&&await l.enableGeometryOperations(),s={...s,arcade:n}}const r=this.getBreakIndex(e,s);return r>-1?this.classBreakInfos[r].symbol:this.defaultSymbol}get symbols(){const e=[];return this.classBreakInfos.forEach(t=>{t.symbol&&e.push(t.symbol)}),this.defaultSymbol&&e.push(this.defaultSymbol),e}getAttributeHash(){return this.visualVariables?.reduce((e,t)=>e+t.getAttributeHash(),"")??""}getMeshHash(){const e=JSON.stringify(this.backgroundFillSymbol),t=JSON.stringify(this.defaultSymbol),s=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${e}.${t}.${this.classBreakInfos.reduce((r,n)=>r+n.getMeshHash(),"")}.${s}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){return new L({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol?.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol?.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:p(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:p(this.visualVariables),legendOptions:p(this.legendOptions),authoringInfo:p(this.authoringInfo)})}async collectRequiredFields(e,t){const s=[this.collectVVRequiredFields(e,t),this.collectSymbolFields(e,t)];await Promise.all(s)}async collectSymbolFields(e,t){const s=[...this.symbols.map(r=>r.collectRequiredFields(e,t)),B(e,t,null,this.valueExpression)];P(e,t,this.field),P(e,t,this.normalizationField),await Promise.all(s)}_getBreakIndexForExpression(e,t){const{viewingMode:s,scale:r,spatialReference:n,arcade:l,timeZone:a}=t??{},{valueExpression:d}=this;let c=this._compiledValueExpression.valueExpression===d?this._compiledValueExpression.compiledFunction:null;const u=l.arcadeUtils;if(!c){const m=u.createSyntaxTree(d);c=u.createFunction(m),this._compiledValueExpression.compiledFunction=c}this._compiledValueExpression.valueExpression=d;const I=u.executeFunction(c,u.createExecContext(e,u.getViewInfo({viewingMode:s,scale:r,spatialReference:n}),a));return this._getBreakIndexfromInfos(I)}_getBreakIndexForField(e){const t=this.field,s=e.attributes,r=this.normalizationType;let n=parseFloat(s[t]);if(r){const l=this.normalizationTotal,a=parseFloat(this.normalizationField?s[this.normalizationField]:void 0);if(r===de)n=Math.log(n)*Math.LOG10E;else if(r!==T||l==null||isNaN(l)){if(r===C&&!isNaN(a)){if(isNaN(n)||isNaN(a))return-1;n/=a}}else n=n/l*100}return this._getBreakIndexfromInfos(n)}_getBreakIndexfromInfos(e){const t=this.isMaxInclusive;if(e!=null&&typeof e=="number"&&!isNaN(e))for(let s=0;s<this.classBreakInfos.length;s++){const r=[this.classBreakInfos[s].minValue,this.classBreakInfos[s].maxValue];if(r[0]<=e&&(t?e<=r[1]:e<r[1]))return s}return-1}_areClassBreaksConsecutive(){const e=this.classBreakInfos,t=e.length;for(let s=1;s<t;s++)if(e[s-1].maxValue!==e[s].minValue)return!1;return!0}};i([o(le)],y.prototype,"backgroundFillSymbol",void 0),i([o({type:[w],json:{write:{isRequired:!0}}})],y.prototype,"classBreakInfos",void 0),i([ve("classBreakInfos")],y.prototype,"readClassBreakInfos",null),i([z("classBreakInfos")],y.prototype,"writeClassBreakInfos",null),i([o({type:String,json:{write:!0}})],y.prototype,"defaultLabel",void 0),i([o(ke)],y.prototype,"defaultSymbol",void 0),i([o({type:String,json:{write:!0}})],y.prototype,"field",void 0),i([re("field")],y.prototype,"castField",null),i([o({type:Boolean})],y.prototype,"isMaxInclusive",void 0),i([o({type:ae,json:{write:!0}})],y.prototype,"legendOptions",void 0),i([o({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return this.classBreakInfos.length!==0&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],y.prototype,"minValue",null),i([o({type:String,json:{write:!0}})],y.prototype,"normalizationField",void 0),i([o({type:Number,json:{write:!0}})],y.prototype,"normalizationTotal",void 0),i([o({type:N.apiValues,value:null,json:{type:N.jsonValues,read:N.read,write:N.write}})],y.prototype,"normalizationType",null),i([M({classBreaks:"class-breaks"})],y.prototype,"type",void 0),i([o({type:String,json:{write:!0}})],y.prototype,"valueExpression",void 0),i([o({type:String,json:{write:!0}})],y.prototype,"valueExpressionTitle",void 0),y=L=i([S("esri.renderers.ClassBreaksRenderer")],y);let ee=class ye{static parse(t,s,r){const n=[],l=[],a=t.split(";");for(let d=0;d<a.length;d++){const c=a[d];if(c){if(c.includes("po:")){const u=c.slice(3).split("|");if(u.length===3){const[I,m,F]=u,Q=Ge(I,m,F);Q&&l.push(Q)}continue}if(c.includes("|")){for(const u of c.split("|"))if(s.has(u)){n.push(u);break}}else if(s.has(c))n.push(c);else if(d===0){n.length=0,n.push(Ue(r));break}}}return new ye(n,l)}constructor(t,s){this.partNames=t,this.overrides=s}};function Je(e,t){if(e==="DashTemplate")return t.split(" ").map(s=>Number(s));if(e==="Color"){const s=new b(t).toRgba();return[s[0],s[1],s[2],255*s[3]]}return Number(t)}function Ge(e,t,s){return{primitiveName:e,propertyName:t,value:Je(t,s),defaultValue:null}}function Ue(e){switch(e){case"esriGeometryPolyline":return"Invalid_L";case"esriGeometryPolygon":return"Invalid_A";default:return"Invalid_P"}}let Ze=class he{static async from(t,s,r){const n=t.dictionary_version?De.parse(t.dictionary_version):null,l=new Set(t.itemsNames),a={};if(s)for(const m in s)a[m]=s[m];if(t.authoringInfo.configuration)for(const m of t.authoringInfo.configuration)a.hasOwnProperty(m.name)||(a[m.name]=m.value);const d=new Set(t.authoringInfo.symbol);for(const m of Object.keys(r))d.delete(m);d.size&&x.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("missing-fields: fieldMap entries for the following symbol fields are missing",{symbolFields:d});const c=await Me(t.expression,null,a);if(!c)throw new we("dictionary-renderer:expression-error","Unable to create dictionary renderer expression");const u=!n||!n.greaterEqual(4,0);u&&x.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("Dictionary script does not support native field types. Applying fallback",{version:n});const I=new Ke(r,u);return new he(u,l,c,I)}constructor(t,s,r,n){this._requiresFieldCoercionToString=t,this._itemNames=s,this._compiled=r,this._reader=n}get itemNames(){return this._itemNames}evaluate(t,s,r,n){try{return this._reader.bind(t,r,n),this._compiled.evaluate(this._reader,{$view:{scale:s}})}catch(l){x.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("arcade: dictionary script evaluation failed",{error:l})}return null}createDictionaryFieldsIndex(t){if(!this._requiresFieldCoercionToString)return new Y(t);const s=t.map(r=>({...r,type:"esriFieldTypeString"}));return new Y(s)}};class Ke extends Oe{constructor(t,s){super(),this._fieldMap=t,this._requiresFieldCoercionToString=s}_getField(t){const s=this._fieldMap[t]??t;return this._boundSchema.fieldsIndex.get(s)}field(t){if(!this._requiresFieldCoercionToString)return super.field(t,!1);const s=this._getField(t);return s==null||this._boundTarget.attributes[s.name]==null?"":""+this._boundTarget.attributes[s.name]}}const Qe={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};let me=class{constructor(t,s,r,n){this.url=t,this.fieldMap=r,this.dictionaryInfo=n,this._symbolPartCache=new Ce(100);const l=async()=>Ze.from(await n,s,r);this._evaluator=l()}async getSymbolAsync(t,s,r=!0){const n=await this._evaluator,l=s?.fields??ze(t.attributes),a=n.createDictionaryFieldsIndex(l),d=n.evaluate(t,s?.scale??0,a,s?.spatialReference);if(d==null)return null;const c=_e(t.geometry),u=ee.parse(d,n.itemNames,c),I=c==="esriGeometryPoint"&&!t.geometry?.hasZ;return await this._cimPartsToCIMSymbol(t,u.partNames,u.overrides,I,s,r,a)}async getSymbolForControlString(t,s,r){const n=await this._evaluator,l=ee.parse(t,n.itemNames,s),a=s==="esriGeometryPoint"&&!r,d=te(await Promise.all(l.partNames.map(c=>this._getSymbolPart(c))),l.overrides,a);return new X({data:d})}async _cimPartsToCIMSymbol(t,s,r,n,l,a,d){const c=s.map(m=>this._getSymbolPart(m,l));let u=await Promise.all(c);if(a&&this.fieldMap&&u.length>0){const{OverrideHelper:m}=await Te(()=>import("./DjMrVzVv.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]),import.meta.url);u=p(u);for(const F of u)m.applyDictionaryTextOverrides(F,t,this.fieldMap,d,Pe(F))}const I=te(u,r,n);return new X({data:I})}async _fetchSymbolPart(t,s){const r=await this.dictionaryInfo,n=(this.url+"/"+r.cimRefTemplateUrl).replaceAll(/\{itemName\}/gi,t),{data:l}=await oe(n,{responseType:"json",query:{f:"json"},...s});return l}async _getSymbolPart(t,s){let r=this._symbolPartCache.get(t);return r||(r=this._fetchSymbolPart(t,s),this._symbolPartCache.put(t,r)),r}};function te(e,t,s){if(!e||e.length===0)return null;const r={...e[0]};if(e.length>1){r.effects=null,r.symbolLayers=[];for(const n of e){const l=n;if(l.effects!=null)for(const a of l.symbolLayers)a.effects==null?a.effects=l.effects:a.effects.unshift(...l.effects);r.symbolLayers.unshift(...l.symbolLayers)}}return s&&(r.callout=Qe),{type:"CIMSymbolReference",symbol:r,primitiveOverrides:t}}var q;let v=q=class extends O(E){constructor(e){super(e),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){const e=this.getDictionaryInfo();return new me(this.url,this.config,this.fieldMap??{},e)}writeData(e,t){e&&(t.scalingExpressionInfo={expression:e,returnType:"number"})}writeVisualVariables(e,t,s,r){r?.origin||super.writeVisualVariables(e,t,s,r)}clone(){return new q({config:p(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:p(this.fieldMap),url:p(this.url),visualVariables:p(this.visualVariables)})}async getSymbolAsync(e,t,s=!0){return this._loader.getSymbolAsync(e,t,s)}async getSymbolForControlString(e,t,s){return this._loader.getSymbolForControlString(e,t,s)}getDictionaryInfo(){return this._dictionaryInfoPromise||(this._dictionaryInfoPromise=this._fetchDictionaryInfo()),this._dictionaryInfoPromise}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t),this.scaleExpression&&await B(e,t,null,this.scaleExpression);for(const s in this.fieldMap){const r=this.fieldMap[s];t.has(r)&&e.add(r)}}get arcadeRequired(){return!0}getSymbol(){return null}get symbols(){return[]}getAttributeHash(){return this.visualVariables?.reduce((e,t)=>e+t.getAttributeHash(),"")??""}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}async _fetchDictionaryInfo(){const{data:e}=await oe(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"}});return e}};i([o({type:me})],v.prototype,"_loader",null),i([o({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],v.prototype,"config",void 0),i([o({type:Object,json:{write:!0}})],v.prototype,"fieldMap",void 0),i([o({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],v.prototype,"scaleExpression",void 0),i([z("scaleExpression")],v.prototype,"writeData",null),i([o({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(e){return{enabled:!!e&&!!this.scaleExpression}}}}})],v.prototype,"scaleExpressionTitle",void 0),i([o({type:String,json:{write:!0}})],v.prototype,"url",void 0),i([z("visualVariables")],v.prototype,"writeVisualVariables",null),v=q=i([S("esri.renderers.DictionaryRenderer")],v);var H;let $=H=class extends j{constructor(e){super(e),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(e){return e==null?e:typeof e=="function"?(x.getLogger(this).error(".field: field must be a string value"),null):ie(e)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){return new H({color:this.color?.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};i([o({type:b,json:{type:[Number],write:!0}})],$.prototype,"color",void 0),i([o({type:String,json:{write:!0}})],$.prototype,"field",void 0),i([re("field")],$.prototype,"castField",null),i([o({type:String,json:{write:!0}})],$.prototype,"label",void 0),i([o({type:String,json:{write:!0}})],$.prototype,"valueExpression",void 0),i([o({type:String,json:{write:!0}})],$.prototype,"valueExpressionTitle",void 0),$=H=i([S("esri.renderers.support.AttributeColorInfo")],$);const fe=$;var A;let D=A=class extends j{constructor(){super(...arguments),this.unit=null}clone(){return new A({unit:this.unit})}};i([o({type:String,json:{write:!0}})],D.prototype,"unit",void 0),D=A=i([S("esri.renderers.support.DotDensityLegendOptions")],D);const We=D;var J;let f=J=class extends O(E){constructor(e){super(e),this.attributes=null,this.backgroundColor=new b([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new Z,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}set visualVariables(e){super.visualVariables=e}calculateDotValue(e){if(this.referenceScale==null)return this.dotValue;const t=e/this.referenceScale*this.dotValue;return t<1?1:t}getSymbol(){return new Re({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol()]}getAttributeHash(){return this.attributes?.reduce((e,t)=>e+t.getAttributeHash(),"")??""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new J({attributes:p(this.attributes),backgroundColor:p(this.backgroundColor),dotBlendingEnabled:p(this.dotBlendingEnabled),dotShape:p(this.dotShape),dotSize:p(this.dotSize),dotValue:p(this.dotValue),legendOptions:p(this.legendOptions),outline:p(this.outline),referenceScale:p(this.referenceScale),seed:p(this.seed),visualVariables:p(this.visualVariables),authoringInfo:p(this.authoringInfo)})}getControllerHash(){return`${this.attributes?.map(t=>t.field||t.valueExpression||"")}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t);for(const s of this.attributes??[])s.valueExpression&&await B(e,t,null,s.valueExpression),s.field&&e.add(s.field)}};i([o({type:[fe],json:{write:!0}})],f.prototype,"attributes",void 0),i([o({type:b,json:{write:!0}})],f.prototype,"backgroundColor",void 0),i([o({type:Boolean,json:{write:!0}})],f.prototype,"dotBlendingEnabled",void 0),i([o({type:String,json:{write:!1}})],f.prototype,"dotShape",void 0),i([o({type:Number,json:{write:!0}})],f.prototype,"dotSize",void 0),i([o({type:We,json:{write:!0}})],f.prototype,"legendOptions",void 0),i([o({type:Z,json:{default:null,write:!0}})],f.prototype,"outline",void 0),i([o({type:Number,json:{write:!0}})],f.prototype,"dotValue",void 0),i([o({type:Number,json:{write:!0}})],f.prototype,"referenceScale",void 0),i([o({type:Number,json:{write:!0}})],f.prototype,"seed",void 0),i([M({dotDensity:"dot-density"})],f.prototype,"type",void 0),f=J=i([S("esri.renderers.DotDensityRenderer")],f);var G;let V=G=class extends j{constructor(e){super(e),this.color=null,this.ratio=null}clone(){return new G({color:this.color&&this.color.clone(),ratio:this.ratio})}};i([o({type:b,json:{type:[xe],default:null,write:{isRequired:!0}}})],V.prototype,"color",void 0),i([o({type:Number,json:{write:{isRequired:!0}}})],V.prototype,"ratio",void 0),V=G=i([S("esri.renderers.support.HeatmapColorStop")],V);let k=class extends K(j){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};i([o({type:String,json:{write:!0}})],k.prototype,"minLabel",void 0),i([o({type:String,json:{write:!0}})],k.prototype,"maxLabel",void 0),i([o({type:String,json:{write:!0}})],k.prototype,"title",void 0),k=i([S("esri.renderers.support.HeatmapLegendOptions")],k);var U;function se(e){if(e!=null){const{maxDensity:t,minDensity:s,radius:r}=e;if(t!=null||s!=null||r!=null){const{blurRadius:n,maxPixelIntensity:l,minPixelIntensity:a,...d}=e;return d}}return e}let h=U=class extends E{constructor(e){super(e),this.authoringInfo=null,this.colorStops=[new V({ratio:0,color:new b("rgba(255, 140, 0, 0)")}),new V({ratio:.75,color:new b("rgba(255, 140, 0, 1)")}),new V({ratio:.9,color:new b("rgba(255, 0,   0, 1)")})],this.field=null,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null}normalizeCtorArgs(e){return se(e)}get blurRadius(){return Le(this.radius)}set blurRadius(e){const t=this.maxPixelIntensity,s=this.minPixelIntensity;this._set("radius",qe(e)),this._set("maxDensity",t*this._pixelIntensityToDensity),this._set("minDensity",s*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(e){this._set("maxDensity",e*this._pixelIntensityToDensity)}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(e){this._set("minDensity",e*this._pixelIntensityToDensity)}get _pixelIntensityToDensity(){return 24/(He**2*this.blurRadius**4)}read(e,t){e=se(e),super.read(e,t)}getSymbol(){return new ne}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol()]}async collectRequiredFields(e,t){const s=this.field,r=this.valueExpression;s&&typeof s=="string"&&P(e,t,s),r&&typeof r=="string"&&await B(e,t,null,r)}getAttributeHash(){return""}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new U({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:p(this.colorStops),field:this.field,legendOptions:p(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};i([o({type:je,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],h.prototype,"authoringInfo",void 0),i([o({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],h.prototype,"blurRadius",null),i([o({type:[V],json:{write:{isRequired:!0}}})],h.prototype,"colorStops",void 0),i([o({type:String,json:{write:!0}})],h.prototype,"field",void 0),i([o({type:k,json:{write:!0}})],h.prototype,"legendOptions",void 0),i([o({type:Number,json:{write:!0}})],h.prototype,"maxDensity",void 0),i([o({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],h.prototype,"maxPixelIntensity",null),i([o({type:Number,json:{write:!0}})],h.prototype,"minDensity",void 0),i([o({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],h.prototype,"minPixelIntensity",null),i([o({type:Number,cast:pe,json:{write:!0}})],h.prototype,"radius",void 0),i([o({type:Number,range:{min:0},json:{default:0,write:!0}})],h.prototype,"referenceScale",void 0),i([M({heatmap:"heatmap"})],h.prototype,"type",void 0),i([o({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],h.prototype,"valueExpression",void 0),i([o({type:String})],h.prototype,"valueExpressionTitle",void 0),i([o({readOnly:!0})],h.prototype,"_pixelIntensityToDensity",null),h=U=i([S("esri.renderers.HeatmapRenderer")],h);let _=class extends K(j){constructor(){super(...arguments),this.color=new b([0,0,0,0]),this.label=null,this.threshold=0}};i([o({type:b,json:{write:!0}})],_.prototype,"color",void 0),i([o({type:String,json:{write:!0}})],_.prototype,"label",void 0),i([o({type:Number,range:{min:0,max:1},json:{write:!0}})],_.prototype,"threshold",void 0),_=i([S("esri.renderers.support.OthersCategory")],_);const Xe={base:Ne,key:"type",typeMap:{size:Fe,opacity:Be}};let g=class extends O(K(E)){constructor(e){super(e),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new b([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new _,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart",this.visualVariables=null}getSymbol(){return new ne({size:this.size?this.size/2+(this.outline?.width||0):0})}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(Se)}getAttributeHash(){return this.visualVariables?.reduce((e,t)=>e+t.getAttributeHash(),"")??""}getMeshHash(){return this.symbols.reduce((e,t)=>e+JSON.stringify(t),"")}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t);for(const s of this.attributes)s.valueExpression&&await B(e,t,null,s.valueExpression),s.field&&e.add(s.field)}};i([o({type:[fe],json:{write:!0}})],g.prototype,"attributes",void 0),i([o(le)],g.prototype,"backgroundFillSymbol",void 0),i([o({type:b,json:{write:!0}})],g.prototype,"defaultColor",void 0),i([o({type:String,json:{write:!0}})],g.prototype,"defaultLabel",void 0),i([o({type:Number,range:{min:0,max:1},json:{write:!0}})],g.prototype,"holePercentage",void 0),i([o({type:_,json:{write:!0}})],g.prototype,"othersCategory",void 0),i([o({type:ae,json:{write:!0}})],g.prototype,"legendOptions",void 0),i([o({type:Z,json:{default:null,write:!0}})],g.prototype,"outline",void 0),i([o({type:Number,cast:pe,json:{write:!0}})],g.prototype,"size",void 0),i([M({pieChart:"pie-chart"})],g.prototype,"type",void 0),i([o({types:[Xe]})],g.prototype,"visualVariables",void 0),g=i([S("esri.renderers.PieChartRenderer")],g);const Ye={key:"type",base:E,typeMap:{heatmap:h,simple:ce,"unique-value":ue,"class-breaks":y,"dot-density":f,dictionary:v,"pie-chart":g},errorContext:"renderer"},It={key:"type",base:E,typeMap:{simple:ce,"unique-value":ue,"class-breaks":y,heatmap:h},errorContext:"renderer",validate:et};function et(e){switch(e.type){case"simple":return tt(e);case"unique-value":return st(e);case"class-breaks":return it(e);case"heatmap":return e}}function tt(e){if(e.symbol)return e;x.getLogger("esri.renderers.support.types").error("Removed invalid 'simple' renderer without a symbol from web scene.")}function st(e){const t=e.uniqueValueInfos,s=t?.filter(({symbol:r,label:n},l)=>(r||x.getLogger("esri.renderers.support.types").error(`Removed invalid unique value info ([${l}] ${n}) without a symbol from web scene.`),!!r));return s?.length!==t?.length&&(e.uniqueValueInfos=s),e}function it(e){const t=e.classBreakInfos,s=t?.filter(({symbol:r,label:n},l)=>(r||x.getLogger("esri.renderers.support.types").error(`Removed invalid class break info ([${l}] ${n}) without a symbol from web scene.`),!!r));return s?.length!==t?.length&&(e.classBreakInfos=s),e}function $t(e,t){return ot(e,null,t)}const rt=Ie({types:Ye});function ot(e,t,s){return e?e&&(e.styleName||e.styleUrl)&&e.type!=="uniqueValue"?(s?.messages&&s.messages.push(new $e("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+e.type+"'",{definition:e,context:s})),null):rt(e,t,s):null}export{V as c,y as j,w as l,Ye as m,ot as o,Ze as s,$t as t,It as u};
