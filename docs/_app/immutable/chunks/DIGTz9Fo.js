const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DJDJWXnA.js","./CN9sEZ07.js","./Aa_nm3Tf.js","./BFGjv385.js","./DSdBzmdi.js","./BHwe4xe6.js","./Drf0nZ94.js","./BJhaCM43.js","./PPVm8Dsz.js","./DzPnzJx5.js","./BAwhstd8.js","./CvJVpgMV.js","./BvZ8mO3n.js","./BnL9dRiP.js","./PJA-oSZG.js","./D5lfJVJF.js","./CLUeyY5c.js","./DYspwNLv.js","./XqQYA9Kc.js","./8d4XiCAe.js","./CEYpN6bs.js","./DsdqSOQR.js","./DPysyl42.js","./LLVnLkr1.js","./CEIvA_E-.js","./DkGd4JTu.js","./Dwqd1w08.js","./bnayRBMH.js","./CttKhsFI.js","./CxGYwNrO.js","./CZOf2dfc.js","./CUMKnN8C.js","./XtBlFJXO.js","./B2LbUStN.js","./ClQdDAtr.js","./DWuFonT6.js","./B1tp3gsa.js","./CPEQ0D6q.js","./BCuEZSJJ.js","./B9XxWJav.js","./DhX8NJRU.js"])))=>i.map(i=>d[i]);
import{_ as o,m as a,a as y,n as M,g as E,x as A,w as B}from"./Aa_nm3Tf.js";import{a as x,F as f}from"./D9LecJbg.js";import{_ as L}from"./PPVm8Dsz.js";import{u as D}from"./CH2voQe_.js";import{O as v}from"./BAwhstd8.js";import{l as T}from"./BurgD2W6.js";import{n as z}from"./Bola1Gyj.js";import{P as V,a as N}from"./BFGjv385.js";import{i as w,s as k}from"./DSdBzmdi.js";import{u as W}from"./XqQYA9Kc.js";import{l as K}from"./DVdhdsPf.js";import{d as Q,u as j,s as I}from"./BHwe4xe6.js";import{r as X}from"./LLVnLkr1.js";import{r as Y}from"./Dp7EIoZF.js";import{r as Z,n as ee,l as te,f as J}from"./BEpFWXkz.js";import{l as re}from"./CvJVpgMV.js";import{when as oe}from"./D5lfJVJF.js";import{s as G}from"./CEIvA_E-.js";import{d as se,H as ae,x as ie}from"./BJhaCM43.js";import{n as ne}from"./Oe6SV2kF.js";import{o as le}from"./CEYpN6bs.js";import{j as pe}from"./DTbXJ_Dm.js";import{l as h}from"./VzQSUR_q.js";import{o as ue}from"./PJA-oSZG.js";import{G as de,$ as ye}from"./CN9sEZ07.js";import"./DzPnzJx5.js";import"./Djp3mnm5.js";import"./C9j04UTW.js";import{n as ce,a as me,t as he}from"./DGlNuEmX.js";var C;let g=C=class extends M{constructor(e){super(e),this.type="none"}clone(){return new C({type:this.type})}};o([Y({none:"none",stayAbove:"stay-above"}),a({json:{write:{isRequired:!0}}})],g.prototype,"type",void 0),g=C=o([y("esri.ground.NavigationConstraint")],g);const U=Symbol("GroundInstance");function et(e){return e!=null&&typeof e=="object"&&U in e}var F,O,q;let n=O=(q=class extends E(W){constructor(e){super(e),this[F]=!0,this.parent=null,this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new v;const t=s=>{const{parent:i}=s;i&&i!==this&&"remove"in i&&i.remove?.(s),s.parent=this,s.type!=="elevation"&&s.type!=="base-elevation"&&w.getLogger(this).error(`Layer '${s.title}, id:${s.id}' of type '${s.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},r=s=>{s.parent=null};this.addHandles([this.layers.on("after-add",s=>t(s.item)),this.layers.on("after-remove",s=>r(s.item))]),this.allLayers=new T({getCollections:()=>[this.layers,this.parent?.basemap?.groundLayers]})}removeChildLayer(e){this.layers.remove(e)}initialize(){this.when().catch(e=>{Q(e)||w.getLogger(this).error("#load()","Failed to load ground",e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}get integratedMeshGround(){const e=this.parent?.basemap?.groundLayers.at(0);return e?.replacesTerrain?e:null}destroy(){const e=this.layers.removeAll();for(const t of e)j(t);this.layers.destroy()}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}get loaded(){return super.loaded}get layers(){return this._get("layers")}set layers(e){this._set("layers",z(e,this._get("layers")))}writeLayers(e,t,r,s){const i=[];e&&(s={...s,layerContainerType:"ground"},e.forEach(p=>{if("write"in p){const d={};V(p)().write(d,s)&&i.push(d)}else s?.messages&&s.messages.push(new k("layer:unsupported",`Layers (${p.title}, ${p.id}) of type '${p.declaredClass}' cannot be persisted in the ground`,{layer:p}))})),t.layers=i}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return K(this,e=>{e(this.layers)})}async queryElevation(e,t){await this.load({signal:t?.signal});const{queryAll:r}=await L(()=>import("./DJDJWXnA.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]),import.meta.url);return I(t),r(this.layers.filter(P).toArray(),e,t)}async createElevationSampler(e,t){await this.load({signal:t?.signal});const{createSampler:r}=await L(()=>import("./DJDJWXnA.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]),import.meta.url);return I(t),r(this.layers.filter(P).toArray(),e,t)}clone(){const e={opacity:this.opacity,surfaceColor:N(this.surfaceColor),navigationConstraint:N(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(e.loadStatus="loaded"),new O({resourceInfo:this.resourceInfo}).set(e)}read(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),super.read(e,t)}_loadFromSource(e){const t=this.resourceInfo;return t?this._loadLayersFromJSON(t.data,t.context,e):Promise.resolve()}async _loadLayersFromJSON(e,t,r){const s=t?.origin||"web-scene",i=t?.portal||null,p=t?.url||null,{populateOperationalLayers:d}=await L(async()=>{const{populateOperationalLayers:_}=await import("./CUMKnN8C.js");return{populateOperationalLayers:_}},__vite__mapDeps([31,10,2,3,4,5,6,11,12,13,9,32,33,1,7,8,14,15,16,17,18,19,20,21,22,23,24,34,35,36,37,38,39,25,26,27,28,40]),import.meta.url);I(r);const c=[];if(e.layers&&Array.isArray(e.layers)){const _={context:{origin:s,url:p,portal:i,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};c.push(d(this.layers,e.layers,_))}await Promise.allSettled(c)}},F=U,q);function P(e){return e&&"createElevationSampler"in e}o([a()],n.prototype,"parent",void 0),o([a()],n.prototype,"integratedMeshGround",null),o([a({json:{read:!1,write:{isRequired:!0}}})],n.prototype,"layers",null),o([a()],n.prototype,"allLayers",void 0),o([X("layers")],n.prototype,"writeLayers",null),o([a({readOnly:!0})],n.prototype,"resourceInfo",void 0),o([a({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:A,read:{reader:Z,source:"transparency"},write:{writer:(e,t)=>{t.transparency=ee(e)},target:"transparency"}}})],n.prototype,"opacity",void 0),o([a({type:D,json:{type:[A],write:(e,t)=>{t.surfaceColor=e.toJSON().slice(0,3)}}})],n.prototype,"surfaceColor",void 0),o([a({type:g,json:{write:!0}})],n.prototype,"navigationConstraint",void 0),n=O=o([y("esri.Ground")],n);const $=n;let b=class extends te(M){constructor(e){super(e),this.color=null}};o([a({type:D,json:{type:[A],write:!0}})],b.prototype,"color",void 0),b=o([y("esri.effects.FocusAreaOutline")],b);const fe=b;let u=class extends E(J){constructor(e){super(e),this.id=`focusarea-${ne()}`,this.title=null,this.enabled=!0,this.outline=null,this.geometries=new h}readGeometries(e,t,r){Array.isArray(e)?this.geometries=h.fromJSON(e,r):r.origin!=="web-scene"&&r.origin!=="portal-item"||r.hooks?.onAfterLoad?.(()=>this._loadGeometries(se(e,r),r))}async _loadGeometries(e,t){const r=await ae(e,{responseType:"json"});this.geometries=h.fromJSON(r.data,t)}};o([a({type:String,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}}),a()],u.prototype,"id",void 0),o([a({type:String,json:{write:!0}})],u.prototype,"title",void 0),o([a({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],u.prototype,"enabled",void 0),o([a({type:fe,json:{write:!0}})],u.prototype,"outline",void 0),o([a({type:h,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}},clonable:e=>new h(e.items.map(t=>t.clone()))}),pe({origins:["web-scene","portal-item"],type:"resource",prefix:"geometries",contentAddressed:!0})],u.prototype,"geometries",void 0),o([le(["web-scene","portal-item","service"],"geometries")],u.prototype,"readGeometries",null),u=o([y("esri.effects.FocusArea")],u);const ge=u;let m=class extends E(J){constructor(t){super(t),this.areas=new v,this.style="bright"}};o([a({type:v.ofType(ge),nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}},clonable:e=>new v(e.items.map(t=>t.clone()))})],m.prototype,"areas",void 0),o([a({type:["bright","dark"],nonNullable:!0,json:{write:!0}})],m.prototype,"style",void 0),m=o([y("esri.effects.FocusAreas")],m);const H=m;function be(e){return typeof e=="object"&&e!=null&&"loaded"in e&&e.loaded===!0&&"type"in e}function ve(e){return!(!be(e)||!de(e)?.operations?.supportsEditing||"editingEnabled"in e&&!ye(e)||ue(e))}const S=()=>w.getLogger("esri.support.basemapUtils");function we(){return{}}function $e(e){for(const t in e){const r=e[t];r&&!r.destroyed&&r.destroy(),delete e[t]}}function _e(e,t){let r;if(typeof e=="string"){const s=e in x,i=!s&&e.includes("/");if(!s&&!i){if(ie())S().warn(`Unable to find basemap definition for: ${e}. See available styles at https://developers.arcgis.com/rest/basemap-styles/`);else{const p=Object.entries(x).filter(([d,c])=>c.classic||c.is3d).map(([d])=>`"${d}"`).sort().join(", ");S().warn(`Unable to find basemap definition for: ${e}. Try one of these: ${p}`)}return null}t&&(r=t[e]),r||(r=s?f.fromId(e):new f({style:{id:e}}),t&&(t[e]=r))}else r=B(f,e);return r?.destroyed&&(S().warn("The provided basemap is already destroyed",{basemap:r}),r=null),r}const R={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function Le(e){let t=null;if(typeof e=="string")if(e in R){const r=R[e];t=new $({resourceInfo:{data:{layers:[r]}}})}else w.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${e}. Try "world-elevation"`);else t=B($,e);return t}let l=class extends ce(me(re)){constructor(e){super(e),this.allLayers=new T({getCollections:()=>[this.basemap?.baseLayers,this.basemap?.groundLayers,this.ground?.layers,this.layers,this.basemap?.referenceLayers],getChildrenFunction:t=>"layers"in t?t.layers:null}),this.focusAreas=new H,this.allTables=he(this),this.basemap=null,this.editableLayers=new T({getCollections:()=>[this.allLayers],itemFilterFunction:ve}),this.ground=new $,this._basemapCache=we(),this.addHandles(oe(()=>this.ground,(t,r)=>{r?.parent===this&&(r.parent=null),t.parent=this},{sync:!0}))}destroy(){$e(this._basemapCache),this._basemapCache=null,this.focusAreas.destroy(),this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=j(this.basemap),j(this.ground),this._set("ground",null)}castBasemap(e){return _e(e,this._basemapCache)}castGround(e){return Le(e)??this._get("ground")}findLayerById(e){return this.allLayers.find(t=>t.id===e)}findTableById(e){return this.allTables.find(t=>t.id===e)}};o([a({readOnly:!0,dependsOn:[]})],l.prototype,"allLayers",void 0),o([a({type:H,nonNullable:!0,json:{write:{overridePolicy:e=>({enabled:e.areas.length>0,ignoreOrigin:!0})}}})],l.prototype,"focusAreas",void 0),o([a({readOnly:!0})],l.prototype,"allTables",void 0),o([a({type:f,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],l.prototype,"basemap",void 0),o([G("basemap")],l.prototype,"castBasemap",null),o([a({readOnly:!0})],l.prototype,"editableLayers",void 0),o([a({type:$,nonNullable:!0})],l.prototype,"ground",void 0),o([G("ground")],l.prototype,"castGround",null),o([a()],l.prototype,"undoRedo",void 0),l=o([y("esri.Map")],l);const Ie=l,rt=Object.freeze(Object.defineProperty({__proto__:null,default:Ie},Symbol.toStringTag,{value:"Module"}));export{Ie as L,rt as M,ve as e,et as o};
