import{r as L}from"./bnayRBMH.js";import{o as p,r as D,P as f,u as C,g as y,I as N,_ as z,A as H,H as k,c as l}from"./YTLdojGG.js";import{n as s}from"./DFoMxmW4.js";import"./BVgVoZ7V.js";import{r as O,c as a,f as w}from"./CLcGMPRo.js";function ut(r){const t=r[0]*r[0]+r[4]*r[4]+r[8]*r[8],n=r[1]*r[1]+r[5]*r[5]+r[9]*r[9],u=r[2]*r[2]+r[6]*r[6]+r[10]*r[10];return Math.sqrt(Math.max(t,n,u))}function ot(r,t){const n=Math.sqrt(t[0]*t[0]+t[4]*t[4]+t[8]*t[8]),u=Math.sqrt(t[1]*t[1]+t[5]*t[5]+t[9]*t[9]),o=Math.sqrt(t[2]*t[2]+t[6]*t[6]+t[10]*t[10]);return p(r,n,u,o),r}function Q(r,t,n){Math.abs(r[0])>Math.abs(r[1])?p(t,0,1,0):p(t,1,0,0),z(n,r,t),z(t,n,r),H(n,n),H(t,t)}function ct(r,t,n,u=s()){const o=D(r),i=D(t),e=f(r,t)/(o*i);if(e<.9999999999999999){const c=Math.acos(e),h=((1-n)*o+n*i)/Math.sin(c),$=h/o*Math.sin((1-n)*c),M=h/i*Math.sin(n*c);return y(E,r,$),y(F,t,M),C(u,E,F)}return N(u,r,t,n)}const E=s(),F=s();function G(r=b){return[r[0],r[1],r[2],r[3]]}function et(r=b[0],t=b[1],n=b[2],u=b[3]){return J(r,t,n,u,O.get())}function R(r,t){return J(t[0],t[1],t[2],t[3],r)}function it(r){return r}function J(r,t,n,u,o=G()){return o[0]=r,o[1]=t,o[2]=n,o[3]=u,o}function S(r,t,n){const u=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],o=Math.abs(u-1)>1e-5&&u>1e-12?1/Math.sqrt(u):1;return n[0]=t[0]*o,n[1]=t[1]*o,n[2]=t[2]*o,n[3]=-(n[0]*r[0]+n[1]*r[1]+n[2]*r[2]),n}function T(r,t,n,u=G()){const o=n[0]-t[0],i=n[1]-t[1],e=n[2]-t[2],c=r[0]-t[0],h=r[1]-t[1],$=r[2]-t[2],M=i*$-e*h,_=e*c-o*$,j=o*h-i*c,v=M*M+_*_+j*j,B=Math.abs(v-1)>1e-5&&v>1e-12?1/Math.sqrt(v):1;return u[0]=M*B,u[1]=_*B,u[2]=j*B,u[3]=-(u[0]*r[0]+u[1]*r[1]+u[2]*r[2]),u}function K(r,t,n,u=0,o=Math.floor(n*(1/3)),i=Math.floor(n*(2/3))){if(n<3)return!1;t(q,u);let e=o,c=!1;for(;e<n-1&&!c;)t(m,e),e++,c=!k(q,m);if(!c)return!1;for(e=Math.max(e,i),c=!1;e<n&&!c;)t(g,e),e++,l(A,q,m),H(A,A),l(x,m,g),H(x,x),c=!k(q,g)&&!k(m,g)&&Math.abs(f(A,x))<U;return c?(T(q,m,g,r),!0):(u!==0||o!==1||i!==2)&&K(r,t,n,0,1,2)}function at(r,t,n=!0){const u=t.length/3;return K(r,(o,i)=>p(o,t[3*i+0],t[3*i+1],t[3*i+2]),n?u-1:u)}const U=.99619469809,q=s(),m=s(),g=s(),A=s(),x=s();function ft(r,t,n){return t!==r&&R(r,t),r[3]=-f(r,n),r}function st(r,t){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=-r[3],t}function ht(r,t,n,u){return z(g,t,r),S(n,g,u)}function Mt(r,t,n,u){return I(P(r,t,l(a.get(),n,t),W,u))}function gt(r,t,n){return t!=null&&I(P(r,t.origin,t.direction,X,n))}function $t(r,t,n){return I(P(r,t.origin,t.vector,0,n))}function mt(r,t,n){return I(P(r,t.origin,t.vector,1,n))}function lt(r,t){return d(r,t)>=0}function qt(r,t){const n=f(r,t.ray.direction),u=-d(r,t.ray.origin);if(u<0&&n>=0)return!1;if(n>-1e-6&&n<1e-6)return u>0;if((u<0||n<0)&&!(u<0&&n<0))return!0;const o=u/n;return n>0?o<t.c1&&(t.c1=o):o>t.c0&&(t.c0=o),t.c0<=t.c1}function bt(r,t){const n=f(r,t.ray.direction),u=-d(r,t.ray.origin);if(n>-1e-6&&n<1e-6)return u>0;const o=u/n;return n>0?o<t.c1&&(t.c1=o):o>t.c0&&(t.c0=o),t.c0<=t.c1}function pt(r,t,n){const u=y(a.get(),r,-r[3]),o=V(r,l(a.get(),t,u),a.get());return C(n,o,u),n}function yt(r,t,n,u){const o=r,i=a.get(),e=a.get();Q(o,i,e);const c=l(a.get(),n,t),h=w(i,c),$=w(e,c),M=w(o,c);return p(u,h,$,M)}function V(r,t,n){const u=y(a.get(),r,f(r,t));return l(n,t,u),n}function dt(r,t){return Math.abs(d(r,t))}function d(r,t){return f(r,t)+r[3]}function I(r){return r===0||r===1}function P(r,t,n,u,o){const i=f(r,n),e=d(r,t);if(i===0)return e>=0?2:3;let c=-e/i;return 1&u&&(c=L(c,0,1)),!(4&u)&&c<0||!(8&u)&&c>1?e>=0?2:3:(C(o,t,y(o,n,c)),e>=0?0:1)}const b=[0,0,1,0],W=12,X=8;export{ft as G,st as H,ht as I,Mt as J,gt as K,$t as L,mt as N,lt as O,qt as P,bt as Q,pt as R,K as S,yt as T,S as U,dt as W,d as X,P as Z,Q as a,ct as b,et as d,ot as g,G as j,it as k,ut as m,J as q,T as w,R as y,at as z};
