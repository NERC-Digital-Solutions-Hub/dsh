import{r as a,m as o,a as b,b as g,ao as h,O as m,N as v,K as p,g as w,t as _}from"./20z1kPdE.js";import{H as $,a as j}from"./BUXna_JK.js";import{V as C}from"./DN9kDbX2.js";import"./PYsgr6Cv.js";import{l as k,w as H}from"./DMvchwLT.js";function T(e,t,n){return p(e.map(((r,u)=>t.apply(n,[r,u]))))}async function z(e,t,n){return(await p(e.map(((r,u)=>t.apply(n,[r,u]))))).map((r=>r.value))}function l(e){return{ok:!0,value:e}}function c(e){return{ok:!1,error:e}}function E(e){return e!=null&&e.ok===!0?e.value:null}function L(e){return e!=null&&e.ok===!1?e.error:null}async function D(e){if(e==null)return{ok:!1,error:new Error("no promise provided")};try{return l(await e)}catch(t){return c(t)}}async function N(e){try{return l(await e)}catch(t){return w(t),c(t)}}function V(e,t){return new s(e,t)}let s=class extends g{get value(){return E(this._result)}get error(){return L(this._result)}get finished(){return this._result!=null}constructor(e,t){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=h(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:n}=this._abortController;this.promise=e(n),this.promise.then((r=>{this._result=l(r),this._cleanup()}),(r=>{this._result=c(r),this._cleanup()})),this._abortHandle=m(t,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=v(this._abortHandle),this._abortController=null}};a([o()],s.prototype,"value",null),a([o()],s.prototype,"error",null),a([o()],s.prototype,"finished",null),a([o()],s.prototype,"promise",void 0),a([o()],s.prototype,"_result",void 0),s=a([b("esri.core.asyncUtils.ReactiveTask")],s);const i=new WeakMap;function f(e){return!e.destroyed&&(i.has(e)||e.addHandles([k((()=>{const t=e.parent;return!(!t||!("type"in t))&&(t.type==="catalog-dynamic-group"||f(t))}),(t=>i.set(e,t)),H),_((()=>i.delete(e)))]),i.get(e))}function q(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="feature"}function F(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="graphics"}function G(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="map-image"}function J(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="knowledge-graph"&&"layers"in e}function K(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="knowledge-graph-sublayer"}function R(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="subtype-group"&&"sublayers"in e}function W(e){return e?.type==="subtype-sublayer"}const Q={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function X(e){const t=e?.type;return t==="building-scene"||t==="integrated-mesh"||t==="point-cloud"||t==="scene"}function Y(e){return e==="integrated-mesh"||e==="integrated-mesh-3dtiles"}function Z(e){return e?.type==="feature"&&!e.url&&e.source?.type==="memory"}function ee(e){const t=e?.type;return(t==="feature"||t==="subtype-group"||t==="oriented-imagery")&&e?.source?.type==="feature-layer"}async function te(e,t){const n=j?.findServerInfo(e);if(n?.currentVersion!=null)return n.owningSystemUrl||null;const r=e.toLowerCase().indexOf("/rest/services");if(r===-1)return null;const u=`${e.slice(0,r)}/rest/info`,y=t!=null?t.signal:null,{data:d}=await $(u,{query:{f:"json"},responseType:"json",signal:y});return d?.owningSystemUrl||null}function S(e){if(!("capabilities"in e))return!1;switch(e.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"sublayer":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function ne(e){return S(e)?"effectiveCapabilities"in e?e.effectiveCapabilities:e.capabilities:null}function x(e){if(!("editingEnabled"in e))return!1;switch(e.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":return!0;default:return!1}}function re(e){return!!x(e)&&("effectiveEditingEnabled"in e?e.effectiveEditingEnabled:e.editingEnabled)}function se(e){const t=new C;for(const n of e.allLayers.concat(e.allTables))n.type==="csv"||f(n)||("charts"in n&&t.push(n),n.type==="subtype-group"&&t.push(...n.sublayers));return t}function P(e,t){return null}function ae(e){return null}function U(e){return!e||e.type==="Feature Service"&&!e.sourceUrl}function ue(e,t){!t||!U(e)||P(e.url)}export{se as $,ae as A,te as B,ne as D,U as G,ue as H,re as N,S as P,D as _,T as a,R as b,N as c,V as d,f as e,J as f,W as g,Q as h,X as j,Z as k,K as l,F as o,z as p,G as s,q as u,Y as w,ee as x,P as z};
