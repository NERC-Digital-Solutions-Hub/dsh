const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CX4mr_7m.js","./PPVm8Dsz.js","./Cad-p0g1.js","./CDGqq53N.js","./BzZgUCJc.js","./C9_KfL0q.js","./COT3swUQ.js","./CyyW12qt.js","./Dpaauiqf.js","./Bcsiu1z4.js","./bnayRBMH.js","./CPwmGbun.js","./NEmuse4e.js","./D1sKJjB8.js","./C3oh_tnt.js","./CicY3o9G.js","./clW6bTka.js"])))=>i.map(i=>d[i]);
import{_ as z}from"./PPVm8Dsz.js";import{u as m}from"./CicY3o9G.js";import{a as S}from"./fh0BQpDQ.js";import"./BzZgUCJc.js";import{u,e as _}from"./clW6bTka.js";import{_ as E}from"./Bcsiu1z4.js";import{i as R}from"./BobhZSEo.js";import{u as g,S as A}from"./CYsY5VfR.js";import{Y as O,H as C}from"./Cad-p0g1.js";import{e as D}from"./CyyW12qt.js";import{Z as h,af as p,ag as H}from"./CPwmGbun.js";const k="picture-fill",$="simple-fill",M="simple-line",x="simple-marker",N="text",P="cim",b=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),w=new D(1e3);function ut(t){const r=t.style;let n=null;if(t)switch(t.type){case x:r!=="cross"&&r!=="x"&&(n=t.color);break;case $:r&&r!=="solid"?r!=="none"&&(n={type:"pattern",x:0,y:0,src:O(`esri/symbols/patterns/${r}.png`),width:5,height:5}):n=t.color;break;case k:n={type:"pattern",src:t.url,width:u(t.width)*t.xscale,height:u(t.height)*t.yscale,x:u(t.xoffset),y:u(t.yoffset)};break;case N:n=t.color;break;case P:n=g(t)}return n}function ft(t,r){const n=t+"-"+r,o=w.get(n);return o!=null?Promise.resolve(o):C(t,{responseType:"image"}).then(l=>{const e=l.data,i=e.naturalWidth,a=e.naturalHeight,s=document.createElement("canvas");s.width=i,s.height=a;const c=s.getContext("2d");c.fillStyle=r,c.fillRect(0,0,i,a),c.globalCompositeOperation="destination-in",c.drawImage(e,0,0);const y=s.toDataURL();return w.put(n,y),y})}function L(t){if(!t)return null;let r=null;switch(t.type){case $:case k:case x:r=L(t.outline);break;case M:{const n=u(t.width);t.style!=null&&t.style!=="none"&&n!==0&&(r={color:t.color,style:J(t.style),width:n,cap:t.cap,join:t.join==="miter"?u(t.miterLimit):t.join},r.dashArray=I(r).join(",")||"none");break}default:r=null}return r}function I(t){if(!t?.style)return[];const{dashArray:r,style:n,width:o}=t;if(typeof r=="string"&&r!=="none")return r.split(",").map(i=>Number(i));const l=o??0,e=b.has(n)?b.get(n).map(i=>i*l):[];if(t.cap!=="butt")for(const[i,a]of e.entries())e[i]=i%2==1?a+l:Math.max(a-l,1);return e}const J=(()=>{const t={};return r=>{if(t[r])return t[r];const n=r.replaceAll("-","");return t[r]=n,n}})(),mt=new m([128,128,128]);function T(t){const r=t.symbolLayers?.at(-1);if(r&&"outline"in r)return r?.outline?.size}function dt(t){if(!t)return 0;if(h(t)){const r=T(t);return r??0}return _(L(t)?.width)}function ht(t){if(t==null||!("symbolLayers"in t)||t.symbolLayers==null)return!1;switch(t.type){case"point-3d":return t.symbolLayers.some(r=>r.type==="object");case"line-3d":return t.symbolLayers.some(r=>r.type==="path");case"polygon-3d":return t.symbolLayers.some(r=>r.type==="object"||r.type==="extrude");default:return!1}}function pt(t){return t.resource?.href??""}function yt(t,r){if(!t)return null;let n=null;return h(t)?n=U(t):p(t)&&(n=t.type==="cim"?g(t):t.color?new m(t.color):null),n?f(n,r):null}function U(t){const r=t.symbolLayers;if(!r)return null;let n=null;return r.forEach(o=>{o.type==="object"&&o.resource?.href||(n=o.type==="water"?o.color:o.material?o.material.color:null)}),n?new m(n):null}function f(t,r){if(r==null||t==null)return t;const n=t.toRgba();return n[3]=n[3]*r,new m(n)}function q(t,r,n){const o=t.symbolLayers;if(!o)return;const l=(e,i=!1)=>{let a=r??e??null;return n?.override!=null&&(!a&&i&&(a=new m([255,255,255])),a&&(a.a=n.override)),f(a,n?.add)};o.forEach(e=>{if(e.type==="water")return void(e.color=f(e.color,n?.add));const i=e.material!=null?e.material.color:null,a=l(i,e.type==="icon"&&e.resource?.href!=null);e.material==null?e.material=new H({color:a}):e.material.color=a,"outline"in e&&e.outline?.color&&n?.add!=null&&(e.outline.color=f(e.outline.color,n.add)),"marker"in e&&e.marker!=null&&(e.marker.color=l(e.marker.color))})}function V(t,r,n){r=r??t.color,n?.override!=null&&r&&(r.a=n.override),r&&(t.color=f(r,n?.add)),"outline"in t&&t.outline?.color&&(t.outline.color=f(t.outline.color,n?.add))}function bt(t,r,n){t&&(r||n!=null)&&(r&&(r=new m(r)),h(t)?q(t,r,n):p(t)&&V(t,r,n))}async function W(t,r){const n=t.symbolLayers;n&&await S(n,async o=>Y(o,r))}async function Y(t,r){switch(t.type){case"extrude":B(t,r);break;case"icon":case"line":case"text":Z(t,r);break;case"path":G(t,r);break;case"object":await F(t,r)}}function Z(t,r){const n=v(r);n!=null&&(t.size=n)}function v(t){for(const r of t)if(typeof r=="number")return r;return null}function B(t,r){const n=r[2];typeof n=="number"&&(t.size=n)}async function F(t,r){const{resourceSize:n,symbolSize:o}=await K(t),l=j(r,n,o);l!=null&&(t.width=d(r[0],o[0],n[0],l),t.depth=d(r[1],o[1],n[1],l),t.height=d(r[2],o[2],n[2],l))}function G(t,r){const n=j(r,E,[t.width,void 0,t.height]);n!=null&&(t.width=d(r[0],t.width,1,n),t.height=d(r[2],t.height,1,n))}function j(t,r,n){for(let o=0;o<3;o++){const l=t[o];switch(l){case"symbol-value":{const e=n[o];return e!=null?e/r[o]:1}case"proportional":break;default:if(l&&r[o])return l/r[o]}}return null}async function K(t){const{computeObjectLayerResourceSize:r}=await z(()=>import("./CX4mr_7m.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),import.meta.url),n=await r(t,10),{width:o,height:l,depth:e}=t,i=[o,e,l];let a=1;for(let s=0;s<3;s++){const c=i[s];if(c!=null){a=c/n[s];break}}for(let s=0;s<3;s++)i[s]==null&&(i[s]=n[s]*a);return{resourceSize:n,symbolSize:i}}function d(t,r,n,o){switch(t){case"proportional":return n*o;case"symbol-value":return r??n;default:return t}}function Q(t,r){const n=v(r);if(n!=null)switch(t.type){case"simple-marker":t.size=n;break;case"picture-marker":{const o=t.width/t.height;o>1?(t.width=n,t.height=n*o):(t.width=n*o,t.height=n);break}case"simple-line":t.width=n;break;case"text":t.font.size=n}}async function wt(t,r){if(t&&r)return h(t)?W(t,r):void(p(t)&&Q(t,r))}function gt(t,r,n){if(t&&r!=null){if(h(t)){const o=t.symbolLayers;o&&o.forEach(l=>{if(l.type==="object")switch(n){case"tilt":l.tilt=(l.tilt??0)+r;break;case"roll":l.roll=(l.roll??0)+r;break;default:l.heading=(l.heading??0)+r}l.type==="icon"&&(l.angle+=r)})}else if(p(t))switch(t.type){case"simple-marker":case"picture-marker":case"text":t.angle+=r;break;case"cim":A(t,r,!0)}}}function kt(t,r){if(!t)return null;const n=t.effects.map(o=>o.toJSON());return R(n)}function $t(t){return t!=null&&t.type==="polygon-3d"&&t.symbolLayers.some(r=>r.type==="extrude")}export{$t as A,bt as L,wt as M,gt as N,yt as a,mt as b,pt as d,ft as f,I as g,ht as h,dt as m,kt as q,ut as u,J as w,L as y};
