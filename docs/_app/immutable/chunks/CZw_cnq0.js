const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BA8mPeve.js","./BEA_VxVb.js","./Ci6C1k20.js","./bnayRBMH.js","./DUlE1Kon.js","./BFGjv385.js","./DSdBzmdi.js","./DxH_hBwP.js","./BJXfqnjN.js","./D14Jvju_.js","./CD2g8Juu.js","./BzQhUrN8.js","./Cc17QD5h.js","./uh6gjmpK.js","./Cd67kGb1.js","./DfRz3K_A.js","./CdqyOKuv.js","./PPVm8Dsz.js","./D-57UJtx.js","./BXAeIeBi.js","./CAPEj8Cx.js","./zBqsFMnn.js","./D2Yxuq6P.js","./CEVkfTgd.js","./J6jWJpvs.js","./DD9DYTwn.js","./CVwTD0fV.js","./D0NQgKcK.js","./b_fk785i.js","./DPJXGPFY.js","./Bu8LbX79.js","./CaqnSMi6.js","./C-CJOyzY.js","./BP4OB8lT.js","./q_b6UJoq.js","./sjfz1WYE.js","./CQ1KD0MB.js","./D5jpRriJ.js","./C3-hxTuw.js"])))=>i.map(i=>d[i]);
import{_ as g}from"./PPVm8Dsz.js";import{u as f}from"./BEA_VxVb.js";import{N as F}from"./BFGjv385.js";import{c as b,s as V,l as E}from"./BI67_pHU.js";import{r as N}from"./BBa5Ksby.js";import{i as x,m as R}from"./D14Jvju_.js";import{I as U}from"./B8nonhNC.js";import{x as O}from"./D71z0FvY.js";import{m as T}from"./b_fk785i.js";import{c as M}from"./BaN4dDqR.js";import{r as _}from"./bnayRBMH.js";import{e as B}from"./D-YQ4CHs.js";import{n as Q,H as S}from"./BT212Icy.js";const L=/^-?(\d+)(\.(\d+))?$/i;function k(t,n){return t-n}function q(t,n){let e,o;return e=Number(t.toFixed(n)),e<t?o=e+1/10**n:(o=e,e-=1/10**n),e=Number(e.toFixed(n)),o=Number(o.toFixed(n)),[e,o]}function D(t,n,e,o,r){const l=j(t,n,e,o),i=l.previous==null||l.previous<=r,a=l.next==null||l.next<=r;return i&&a||l.previous+l.next<=2*r}function y(t){const n=String(t),e=n.match(L);if(e?.[1])return{integer:e[1].split("").length,fractional:e[3]?e[3].split("").length:0};if(n.toLowerCase().includes("e")){const o=n.split("e"),r=o[0],l=o[1];if(r&&l){const i=Number(r);let a=Number(l);const s=a>0;s||(a=Math.abs(a));const u=y(i);return s?(u.integer+=a,a>u.fractional?u.fractional=0:u.fractional-=a):(u.fractional+=a,a>u.integer?u.integer=1:u.integer-=a),u}}return{integer:0,fractional:0}}function j(t,n,e,o){const r={previous:null,next:null};if(e!=null){const l=t-e,i=n-e-l;r.previous=Math.floor(Math.abs(100*i/l))}if(o!=null){const l=o-t,i=o-n-l;r.next=Math.floor(Math.abs(100*i/l))}return r}function wt(t,n={}){const e=t.slice(),{tolerance:o=2,strictBounds:r=!1,indexes:l=e.map((i,a)=>a)}=n;l.sort(k);for(let i=0;i<l.length;i++){const a=l[i],s=e[a],u=a===0?null:e[a-1],c=a===e.length-1?null:e[a+1],A=y(s).fractional;if(A){let m,p=0,d=!1;for(;p<=A&&!d;){const w=q(s,p);m=r&&i===0?w[1]:w[0],d=D(s,m,u,c,o),p++}d&&(e[a]=m)}}return e}const K={maximumFractionDigits:20};function W(t){return b(t,K)}const Z="<",G=">";function H(t,n,e,o){let r="";n===0?r=`${Z} `:n===e&&(r=`${G} `);const l=z(t,o);return l==null?"":r+l}function P(t){const{format:n,fieldFormat:e}=t||{};return e?.type==="number"||!!n&&n.dateFormat==null&&(n.places!=null||n.digitSeparator!=null)}function z(t,n){if(t==null)return t;const{fieldType:e,format:o,fieldFormat:r,timeZoneOptions:l}=n||{};if(h(e))return O(t,{fieldType:e,format:o?.dateFormat,fieldFormat:r?.type==="date-time"?r:void 0,timeZoneOptions:l});if(typeof t=="string"&&P(n)){const a=Number(t);isNaN(a)||(t=a)}if(typeof t=="string")return t;const i=r?.type==="number"?V(r):o?E(o):void 0;return i?b(t,i):W(t)}const vt=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function X(t){if(!("visualVariables"in t)||!t.visualVariables)return null;const n=t.visualVariables.find(i=>i.type==="color");if(!n)return null;let e=null,o=null;if(n.stops){if(n.stops.length===1)return n.stops[0].color;e=n.stops[0].value,o=n.stops[n.stops.length-1].value}const r=e!=null&&o!=null?e+(o-e)/2:0,{getColor:l}=await g(async()=>{const{getColor:i}=await import("./BA8mPeve.js").then(a=>a.v);return{getColor:i}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38]),import.meta.url);return l(n,r)??null}async function bt(t,n){const e=t.trailCap,o=t.trailWidth||1,r=n||await X(t)||t.color;return new T({cap:e,color:r,width:o})}function Y(t,n){if(!n)return null;if("featureReduction"in t)switch(t.featureReduction?.type){case"cluster":case"binning":{const e=t.featureReduction.fields.find(({name:o})=>o.toLowerCase()===n.toLowerCase());return e&&"getField"in t?t.getField(e.onStatisticField):null}}return"getField"in t?t.getField?.(n):null}function J(t,n){const e="popupTemplate"in t?t.popupTemplate?.fieldInfos:null;if(e?.length&&n)return e.find(o=>o.fieldName?.toLowerCase()===n.toLowerCase())}function v(t){let n=0,e=0;return t.stops?(n=t.stops?.at(0)?.value??n,e=t.stops?.at(-1)?.value??e):"minDataValue"in t&&"maxDataValue"in t&&(n=t.minDataValue??n,e=t.maxDataValue??e),e-n>2*N.days?"short-date":"short-date-short-time"}function h(t){return["date","date-only","time-only","timestamp-offset"].includes(t||"")}function I(t){return U(t)&&!("featureReduction"in t&&t.featureReduction)}function yt(t,n,e){const o=tt(t,n.field,e);return o?(h(o.fieldType)&&(I(t)?o.fieldFormat??=new x({dateStyle:"short",timeStyle:v(n)==="short-date-short-time"?"short":null}):o.format??=new R({dateFormat:v(n)})),o):null}function tt(t,n,e){const o=Y(t,n),r=o?.name;if(!r)return null;const l=o?.type,i=I(t);return{fieldType:l,format:i?null:J(t,r)?.format,fieldFormat:i?t.getFieldConfiguration(r)?.fieldFormat:null,timeZoneOptions:h(l)?{layerTimeZone:"preferredTimeZone"in t?t.preferredTimeZone:null,viewTimeZone:e,datesInUnknownTimezone:"datesInUnknownTimezone"in t&&t.datesInUnknownTimezone}:null}}function It(t,n){if("authoringInfo"in t)return t.authoringInfo?.visualVariables?.find(({theme:e})=>e===n)}function Ct(t,n){let e=t??"";return n!=null&&n&&(e=e?"("+e+") AND ("+n+")":n),e}const nt=new f([64,64,64]);function C(t,n){const e=[],o=t.length-1;return t.length===5?e.push(0,2,4):e.push(0,o),t.map((r,l)=>e.includes(l)?H(r,l,o,n):null)}async function $t(t,n,e){let o=!1,r=[],l=[];if(t.stops){const u=t.stops;r=u.map(c=>c.value),o=u.some(c=>!!c.label),o&&(l=u.map(c=>c.label))}const i=r[0],a=r[r.length-1];if(i==null&&a==null)return null;const s=o?null:C(r,e);return(await Promise.all(r.map(async(u,c)=>{const A=t.type==="opacity"?await et(u,t,n):(await g(async()=>{const{getColor:p}=await import("./BA8mPeve.js").then(d=>d.v);return{getColor:p}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38]),import.meta.url)).getColor(t,u),m=o?l[c]:s?.[c]??"";return A==null?null:{value:u,color:A,label:m}}))).filter(F).reverse()}async function et(t,n,e){const o=new f(e??nt),r=(await g(async()=>{const{getOpacity:l}=await import("./BA8mPeve.js").then(i=>i.v);return{getOpacity:l}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38]),import.meta.url)).getOpacity(n,t);return r!=null&&(o.a=r),o}function Ft(t){let n=!1,e=[],o=[];e=t.map(a=>a.value),n=t.some(a=>!!a.label),n&&(o=t.map(a=>a.label??""));const r=e[0],l=e[e.length-1];if(r==null&&l==null)return null;const i=n?null:C(e);return e.map((a,s)=>({value:a,color:ot(a,t),label:n?o[s]:i?.[s]??""})).reverse()}function ot(t,n){const{startIndex:e,endIndex:o,weight:r}=rt(t,n);if(e===o)return n[e].color;const l=f.blendColors(n[e].color,n[o].color,r);return new f(l)}function rt(t,n){let e=0,o=n.length-1;return n.some((r,l)=>t<r.value?(o=l,!0):(e=l,!1)),{startIndex:e,endIndex:o,weight:(t-n[e].value)/(n[o].value-n[e].value)}}function Vt(t,n){let e=[];if(t&&t.type==="multipart")t.colorRamps.reverse().forEach((o,r)=>{r===0?e.push({value:n.max,color:new f(o.toColor),label:"high"}):e.push({value:null,color:new f(o.toColor),label:""}),r===t.colorRamps.length-1?e.push({value:n.min,color:new f(o.fromColor),label:"low"}):e.push({value:null,color:new f(o.fromColor),label:""})});else{let o,r;t&&t.type==="algorithmic"?(o=t.fromColor,r=t.toColor):(o=[0,0,0,1],r=[255,255,255,1]),e=[{value:n.max,color:new f(r),label:"high"},{value:n.min,color:new f(o),label:"low"}]}return e}function Et(t){if(!t.colorStops)return[];const n=[...t.colorStops].filter(o=>o.color?.a>0);let e=n.length-1;if(n&&n[0]){const o=n[e];o&&o.ratio!==1&&(n.push(new M({ratio:1,color:o.color})),e++)}return n.map((o,r)=>{let l="";return r===0?l=t.legendOptions?.minLabel||"low":r===e&&(l=t.legendOptions?.maxLabel||"high"),{color:o.color,label:l,ratio:o.ratio}}).reverse()}function Nt({level:t,class:n,...e},o){const r=$(t);return Q(`h${r}`,{...e,"aria-level":String(r),class:S(B.heading,n),role:"heading"},o)}function $(t){return _(Math.ceil(t),1,6)}function xt(t,n=1){return $(t+n)}export{It as C,yt as V,Z as a,Ft as b,Ct as c,z as d,Vt as e,G as f,X as g,vt as h,y as i,tt as j,Nt as k,j as l,H as m,xt as n,Et as r,ot as s,$t as t,wt as u,bt as w};
