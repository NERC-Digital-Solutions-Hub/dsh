const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Cl8hT7Dy.js","./CumW50Sh.js","./Ci6C1k20.js","./bnayRBMH.js","./BW0zoJTm.js","./CEBETtrS.js","./CaNW5Bx0.js","./BwN_j92a.js","./Bde99gqs.js","./TW8D_o5j.js","./CVQPxYbx.js","./DwerzRSF.js","./y1GB1Svy.js","./PPVm8Dsz.js","./BUsxo-Ec.js","./D0nkGZIM.js","./AlyPEkJM.js","./C7fxqwFZ.js","./B0gOzRRh.js","./C3_gy5al.js","./BYduSOTS.js","./PJHcqbvL.js","./CfBiQUdY.js","./CVwTD0fV.js","./9eAP65Ji.js","./mOc398RU.js","./DPJXGPFY.js","./DFYTeVXP.js","./B8cN3yAo.js","./BIj_QgNJ.js","./q_b6UJoq.js","./CYI1luaL.js","./DTEZVyiP.js","./BCTmL8G8.js","./BARRAGjD.js"])))=>i.map(i=>d[i]);
import{_ as g}from"./PPVm8Dsz.js";import{u as A}from"./CumW50Sh.js";import{N as F}from"./CEBETtrS.js";import{c as b,s as V,l as E}from"./jYVHtrPb.js";import{I as N,r as x}from"./BTNr9f9k.js";import{i as R,m as $}from"./Bde99gqs.js";import{x as U}from"./CXu_ESHL.js";import{m as O}from"./mOc398RU.js";import{c as T}from"./B2om5830.js";const _=/^-?(\d+)(\.(\d+))?$/i;function M(t,e){return t-e}function B(t,e){let n,o;return n=Number(t.toFixed(e)),n<t?o=n+1/10**e:(o=n,n-=1/10**e),n=Number(n.toFixed(e)),o=Number(o.toFixed(e)),[n,o]}function Q(t,e,n,o,r){const l=L(t,e,n,o),a=l.previous==null||l.previous<=r,i=l.next==null||l.next<=r;return a&&i||l.previous+l.next<=2*r}function y(t){const e=String(t),n=e.match(_);if(n?.[1])return{integer:n[1].split("").length,fractional:n[3]?n[3].split("").length:0};if(e.toLowerCase().includes("e")){const o=e.split("e"),r=o[0],l=o[1];if(r&&l){const a=Number(r);let i=Number(l);const s=i>0;s||(i=Math.abs(i));const u=y(a);return s?(u.integer+=i,i>u.fractional?u.fractional=0:u.fractional-=i):(u.fractional+=i,i>u.integer?u.integer=1:u.integer-=i),u}}return{integer:0,fractional:0}}function L(t,e,n,o){const r={previous:null,next:null};if(n!=null){const l=t-n,a=e-n-l;r.previous=Math.floor(Math.abs(100*a/l))}if(o!=null){const l=o-t,a=o-e-l;r.next=Math.floor(Math.abs(100*a/l))}return r}function st(t,e={}){const n=t.slice(),{tolerance:o=2,strictBounds:r=!1,indexes:l=n.map((a,i)=>i)}=e;l.sort(M);for(let a=0;a<l.length;a++){const i=l[a],s=n[i],u=i===0?null:n[i-1],c=i===n.length-1?null:n[i+1],f=y(s).fractional;if(f){let m,p=0,d=!1;for(;p<=f&&!d;){const w=B(s,p);m=r&&a===0?w[1]:w[0],d=Q(s,m,u,c,o),p++}d&&(n[i]=m)}}return n}const S={maximumFractionDigits:20};function q(t){return b(t,S)}const D="<",k=">";function j(t,e,n,o){let r="";e===0?r=`${D} `:e===n&&(r=`${k} `);const l=W(t,o);return l==null?"":r+l}function K(t){const{format:e,fieldFormat:n}=t||{};return n?.type==="number"||!!e&&e.dateFormat==null&&(e.places!=null||e.digitSeparator!=null)}function W(t,e){if(t==null)return t;const{fieldType:n,format:o,fieldFormat:r,timeZoneOptions:l}=e||{};if(h(n))return U(t,{fieldType:n,format:o?.dateFormat,fieldFormat:r?.type==="date-time"?r:void 0,timeZoneOptions:l});if(typeof t=="string"&&K(e)){const i=Number(t);isNaN(i)||(t=i)}if(typeof t=="string")return t;const a=r?.type==="number"?V(r):o?E(o):void 0;return a?b(t,a):q(t)}const ct=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function Z(t){if(!("visualVariables"in t)||!t.visualVariables)return null;const e=t.visualVariables.find(a=>a.type==="color");if(!e)return null;let n=null,o=null;if(e.stops){if(e.stops.length===1)return e.stops[0].color;n=e.stops[0].value,o=e.stops[e.stops.length-1].value}const r=n!=null&&o!=null?n+(o-n)/2:0,{getColor:l}=await g(async()=>{const{getColor:a}=await import("./Cl8hT7Dy.js").then(i=>i.v);return{getColor:a}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34]),import.meta.url);return l(e,r)??null}async function At(t,e){const n=t.trailCap,o=t.trailWidth||1,r=e||await Z(t)||t.color;return new O({cap:n,color:r,width:o})}function G(t,e){if(!e)return null;if("featureReduction"in t)switch(t.featureReduction?.type){case"cluster":case"binning":{const n=t.featureReduction.fields.find(({name:o})=>o.toLowerCase()===e.toLowerCase());return n&&"getField"in t?t.getField(n.onStatisticField):null}}return"getField"in t?t.getField?.(e):null}function P(t,e){const n="popupTemplate"in t?t.popupTemplate?.fieldInfos:null;if(n?.length&&e)return n.find(o=>o.fieldName?.toLowerCase()===e.toLowerCase())}function v(t){let e=0,n=0;return t.stops?(e=t.stops?.at(0)?.value??e,n=t.stops?.at(-1)?.value??n):"minDataValue"in t&&"maxDataValue"in t&&(e=t.minDataValue??e,n=t.maxDataValue??n),n-e>2*x.days?"short-date":"short-date-short-time"}function h(t){return["date","date-only","time-only","timestamp-offset"].includes(t||"")}function I(t){return N(t)&&!("featureReduction"in t&&t.featureReduction)}function ft(t,e,n){const o=H(t,e.field,n);return o?(h(o.fieldType)&&(I(t)?o.fieldFormat??=new R({dateStyle:"short",timeStyle:v(e)==="short-date-short-time"?"short":null}):o.format??=new $({dateFormat:v(e)})),o):null}function H(t,e,n){const o=G(t,e),r=o?.name;if(!r)return null;const l=o?.type,a=I(t);return{fieldType:l,format:a?null:P(t,r)?.format,fieldFormat:a?t.getFieldConfiguration(r)?.fieldFormat:null,timeZoneOptions:h(l)?{layerTimeZone:"preferredTimeZone"in t?t.preferredTimeZone:null,viewTimeZone:n,datesInUnknownTimezone:"datesInUnknownTimezone"in t&&t.datesInUnknownTimezone}:null}}function mt(t,e){if("authoringInfo"in t)return t.authoringInfo?.visualVariables?.find(({theme:n})=>n===e)}function pt(t,e){let n=t??"";return e!=null&&e&&(n=n?"("+n+") AND ("+e+")":e),n}const z=new A([64,64,64]);function C(t,e){const n=[],o=t.length-1;return t.length===5?n.push(0,2,4):n.push(0,o),t.map((r,l)=>n.includes(l)?j(r,l,o,e):null)}async function dt(t,e,n){let o=!1,r=[],l=[];if(t.stops){const u=t.stops;r=u.map(c=>c.value),o=u.some(c=>!!c.label),o&&(l=u.map(c=>c.label))}const a=r[0],i=r[r.length-1];if(a==null&&i==null)return null;const s=o?null:C(r,n);return(await Promise.all(r.map(async(u,c)=>{const f=t.type==="opacity"?await X(u,t,e):(await g(async()=>{const{getColor:p}=await import("./Cl8hT7Dy.js").then(d=>d.v);return{getColor:p}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34]),import.meta.url)).getColor(t,u),m=o?l[c]:s?.[c]??"";return f==null?null:{value:u,color:f,label:m}}))).filter(F).reverse()}async function X(t,e,n){const o=new A(n??z),r=(await g(async()=>{const{getOpacity:l}=await import("./Cl8hT7Dy.js").then(a=>a.v);return{getOpacity:l}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34]),import.meta.url)).getOpacity(e,t);return r!=null&&(o.a=r),o}function gt(t){let e=!1,n=[],o=[];n=t.map(i=>i.value),e=t.some(i=>!!i.label),e&&(o=t.map(i=>i.label??""));const r=n[0],l=n[n.length-1];if(r==null&&l==null)return null;const a=e?null:C(n);return n.map((i,s)=>({value:i,color:Y(i,t),label:e?o[s]:a?.[s]??""})).reverse()}function Y(t,e){const{startIndex:n,endIndex:o,weight:r}=J(t,e);if(n===o)return e[n].color;const l=A.blendColors(e[n].color,e[o].color,r);return new A(l)}function J(t,e){let n=0,o=e.length-1;return e.some((r,l)=>t<r.value?(o=l,!0):(n=l,!1)),{startIndex:n,endIndex:o,weight:(t-e[n].value)/(e[o].value-e[n].value)}}function ht(t,e){let n=[];if(t&&t.type==="multipart")t.colorRamps.reverse().forEach((o,r)=>{r===0?n.push({value:e.max,color:new A(o.toColor),label:"high"}):n.push({value:null,color:new A(o.toColor),label:""}),r===t.colorRamps.length-1?n.push({value:e.min,color:new A(o.fromColor),label:"low"}):n.push({value:null,color:new A(o.fromColor),label:""})});else{let o,r;t&&t.type==="algorithmic"?(o=t.fromColor,r=t.toColor):(o=[0,0,0,1],r=[255,255,255,1]),n=[{value:e.max,color:new A(r),label:"high"},{value:e.min,color:new A(o),label:"low"}]}return n}function wt(t){if(!t.colorStops)return[];const e=[...t.colorStops].filter(o=>o.color?.a>0);let n=e.length-1;if(e&&e[0]){const o=e[n];o&&o.ratio!==1&&(e.push(new T({ratio:1,color:o.color})),n++)}return e.map((o,r)=>{let l="";return r===0?l=t.legendOptions?.minLabel||"low":r===n&&(l=t.legendOptions?.maxLabel||"high"),{color:o.color,label:l,ratio:o.ratio}}).reverse()}export{mt as C,ft as V,D as a,gt as b,pt as c,W as d,ht as e,k as f,Z as g,ct as h,y as i,H as j,L as l,j as m,wt as r,Y as s,dt as t,st as u,At as w};
