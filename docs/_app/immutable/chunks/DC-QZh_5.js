import{n as u,_ as r,m as o,a as l,o as zt,x as w,b as At,c as ve,i as ge,r as M,S as xe}from"./DUlE1Kon.js";import{l as $}from"./CD2g8Juu.js";import{O as L}from"./BLSZFbqy.js";import{a as R}from"./BFGjv385.js";import{i as Fe}from"./DSdBzmdi.js";import{C as $e}from"./DxH_hBwP.js";import{aa as Ie}from"./CQL0hffV.js";import{g as je,I as be,d as Se,x as Ne,w as Re,D as _e,y as Ce,z as Oe}from"./BeSfGlfk.js";import{r as Mt}from"./BXAeIeBi.js";import{M as Te}from"./Cc17QD5h.js";import{u as Ae}from"./BEA_VxVb.js";import{a as Me,c as Ee,p as ke}from"./CiqIKsqy.js";let et=class extends u{constructor(e){super(e),this.type=null}};r([o({type:["attachments","custom","fields","media","text","expression","relationship","utility-network-associations"],readOnly:!0,json:{read:!1,write:!0}})],et.prototype,"type",void 0),et=r([l("esri.popup.content.Content")],et);const I=et,tt=new zt({asc:"ascending",desc:"descending"});let D=class extends $(u){constructor(e){super(e),this.field=null,this.order="ascending"}};r([o({type:String,json:{write:!0}})],D.prototype,"field",void 0),r([o({type:tt.apiValues,json:{type:tt.jsonValues,read:tt.read,write:tt.write}})],D.prototype,"order",void 0),D=r([l("esri.popup.support.AttachmentsOrderByInfo")],D);const Be=D;let m=class extends $(I){constructor(e){super(e),this.attachmentKeywords=null,this.attachmentTypes=null,this.description=null,this.displayType="auto",this.orderByFields=null,this.title=null,this.type="attachments"}};r([o({type:[String],json:{write:!0}})],m.prototype,"attachmentKeywords",void 0),r([o({type:[["application","audio","image","model","text","video"]],json:{write:!0}})],m.prototype,"attachmentTypes",void 0),r([o({type:String,json:{write:!0}})],m.prototype,"description",void 0),r([o({type:["auto","preview","list"],json:{write:!0}})],m.prototype,"displayType",void 0),r([o({type:[Be],json:{write:!0}})],m.prototype,"orderByFields",void 0),r([o({type:String,json:{write:!0}})],m.prototype,"title",void 0),r([o({type:["attachments"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],m.prototype,"type",void 0),m=r([l("esri.popup.content.AttachmentsContent")],m);const H=m;var ht;let _=ht=class extends I{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new ht({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?R(this.outFields):null})}};r([o()],_.prototype,"creator",void 0),r([o()],_.prototype,"destroyer",void 0),r([o()],_.prototype,"outFields",void 0),r([o({type:["custom"],readOnly:!0})],_.prototype,"type",void 0),_=ht=r([l("esri.popup.content.CustomContent")],_);const Je=_;var mt;let E=mt=class extends u{constructor(t){super(t),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new mt({title:this.title,expression:this.expression})}};r([o({type:String,json:{write:!0}})],E.prototype,"title",void 0),r([o({type:String,json:{write:!0}})],E.prototype,"expression",void 0),r([o({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],E.prototype,"returnType",void 0),E=mt=r([l("esri.popup.ElementExpressionInfo")],E);const qe=E;var ft;let W=ft=class extends I{constructor(t){super(t),this.expressionInfo=null,this.type="expression"}clone(){return new ft({expressionInfo:this.expressionInfo?.clone()})}};r([o({type:qe,json:{write:!0}})],W.prototype,"expressionInfo",void 0),r([o({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],W.prototype,"type",void 0),W=ft=r([l("esri.popup.content.ExpressionContent")],W);const pt=W;let rt=class extends $(u){constructor(e){super(e),this.type=null}};r([o({type:["date-time","number"],nonNullable:!0,readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],rt.prototype,"type",void 0),rt=r([l("esri.layers.support.FieldFormat")],rt);const Et=rt,Vt="auto";let x=class extends Et{constructor(e){super(e),this.dateStyle=null,this.hour12=Vt,this.month=null,this.timeStyle=null,this.type="date-time",this.year=null}};r([o({type:["full","long","medium","short"],json:{write:!0}})],x.prototype,"dateStyle",void 0),r([o({type:["always","auto","never"],nonNullable:!0,json:{default:Vt,write:!0}})],x.prototype,"hour12",void 0),r([o({type:["long","short"],json:{write:!0}})],x.prototype,"month",void 0),r([o({type:["full","long","medium","short"],json:{write:!0}})],x.prototype,"timeStyle",void 0),r([o({type:["date-time"]})],x.prototype,"type",void 0),r([o({type:["numeric"],json:{write:!0}})],x.prototype,"year",void 0),x=r([l("esri.layers.support.DateTimeFieldFormat")],x);const A=x,qt={min:0,max:20},Kt=2,Ht=0,Qt="decimal",Xt="auto";let j=class extends Et{constructor(e){super(e),this.maximumFractionDigits=Kt,this.minimumFractionDigits=Ht,this.style=Qt,this.type="number",this.useGrouping=Xt}};r([o({type:w,nonNullable:!0,range:qt,json:{default:Kt,write:!0}})],j.prototype,"maximumFractionDigits",void 0),r([o({type:w,nonNullable:!0,range:qt,json:{default:Ht,write:!0}})],j.prototype,"minimumFractionDigits",void 0),r([o({type:["decimal"],nonNullable:!0,json:{default:Qt,write:!0}})],j.prototype,"style",void 0),r([o({type:["number"]})],j.prototype,"type",void 0),r([o({type:["always","auto","never"],nonNullable:!0,json:{default:Xt,write:!0}})],j.prototype,"useGrouping",void 0),j=r([l("esri.layers.support.NumberFieldFormat")],j);const at=j;let k=class extends $(u){constructor(e){super(e),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};r([Mt(Te)],k.prototype,"dateFormat",void 0),r([o({type:Boolean,json:{write:!0}})],k.prototype,"digitSeparator",void 0),r([o({type:w,json:{write:!0}})],k.prototype,"places",void 0),k=r([l("esri.popup.support.FieldInfoFormat")],k);const J=k,Le={base:Et,key:"type",errorContext:"field-configuration-field-format",typeMap:{"date-time":A,number:at}};function Ir(t,e){const{format:i}=t;return e&&ut(e)?i?Yt(i,e):ot(e,{hour12:"always",useGrouping:"always"}):null}function Yt(t,e){const{dateFormat:i}=t;if(!e)return i?Dt(t):Lt(t);if(!ut(e))return;const s={hour12:"always"};switch(e.type){case"integer":case"small-integer":case"big-integer":case"long":return Zt(t);case"single":case"double":return Lt(t);case"date":case"timestamp-offset":return i?Dt(t):ot(e,s);case"date-only":return i?De(t):ot(e);case"time-only":return i?We(t):ot(e,s)}}function ut(t){return je(t)||be(t)||Se(t)||Ne(t)||Re(t)}function Zt(t){return new at({useGrouping:t.digitSeparator?"always":"never"})}function Lt(t){const e=Zt(t),{places:i}=t;return e.minimumFractionDigits=i??0,e.maximumFractionDigits=i??2,e}function Dt(t){return new A({dateStyle:te(t),year:ie(t),month:re(t),timeStyle:oe(t),hour12:ee(t)})}function De(t){return new A({dateStyle:te(t),year:ie(t),month:re(t)})}function We(t){return new A({timeStyle:oe(t),hour12:ee(t)})}function te(t){const{dateFormat:e}=t;return e?e.startsWith("short-date")?"short":e.startsWith("day-short-month-year")?"medium":e.startsWith("long-month-day-year")?"long":e.startsWith("long-date")?"full":null:null}function ee(t){return t.dateFormat?.endsWith("-24")?"never":"always"}function re(t){switch(t.dateFormat){case"short-month-year":return"short";case"long-month-year":return"long";default:return null}}function oe(t){const{dateFormat:e}=t;return e?e.includes("short-time")?"short":e.includes("long-time")?"medium":null:null}function ie(t){switch(t.dateFormat){case"short-month-year":case"long-month-year":case"year":return"numeric";default:return null}}function Ge(t,e){const i=t.type==="number",s=t.type==="date-time";if(!e)return i?Wt(t):s?Gt(t):null;if(ut(e))switch(e.type){case"integer":case"small-integer":case"big-integer":case"long":return i?se(t):null;case"single":case"double":return i?Wt(t):null;case"date":case"timestamp-offset":return s?Gt(t):null;case"date-only":return s?Pe(t):null;case"time-only":return s?Ue(t):null}}function se(t){return new J({digitSeparator:t.useGrouping!=="never"})}function Wt(t){const e=se(t);return e.places=t.maximumFractionDigits,e}function Gt(t){let e;const i=ne(t),s=le(t),n=t.hour12==="never"?"24":null,a=t.year==="numeric"?"year":null,c=ae(t);return i&&s&&n?e=`${i}-${s}-${n}`:i&&s?e=`${i}-${s}`:i?e=i:a&&c?e=`${c}-${a}`:a&&(e=a),e?new J({dateFormat:e}):null}function Pe(t){let e;const i=ne(t),s=t.year==="numeric"?"year":null,n=ae(t);return i?e=i:s&&n?e=`${n}-${s}`:s&&(e=s),e?new J({dateFormat:e}):null}function Ue(t){let e;const i=le(t),s=t.hour12==="never"?"24":null;return i&&s?e=`short-date-${i}-${s}`:i&&(e=`short-date-${i}`),e?new J({dateFormat:e}):null}function ne(t){switch(t.dateStyle){case"short":return"short-date";case"medium":return"day-short-month-year";case"long":return"long-month-day-year";case"full":return"long-date";default:return}}function le(t){return t.timeStyle&&(t.timeStyle==="short"?"short-time":"long-time")}function ae(t){switch(t.month){case"short":return"short-month";case"long":return"long-month";default:return}}function ot(t,e){if(!ut(t))return;const i=e?.useGrouping??"auto",s=e?.hour12??"auto";switch(t.type){case"integer":case"small-integer":case"big-integer":case"long":return new at({minimumFractionDigits:0,maximumFractionDigits:0,useGrouping:i});case"single":case"double":return new at({minimumFractionDigits:0,maximumFractionDigits:2,useGrouping:i});case"date":case"timestamp-offset":return new A({dateStyle:"short",timeStyle:"short",hour12:s});case"date-only":return new A({dateStyle:"short"});case"time-only":return new A({timeStyle:"short",hour12:s})}}let d=class extends $(u){constructor(e){super(e),this.fieldName=null,this.isEditable=!0,this.label=null,this.statisticType=null,this.stringFieldOption="text-box",this.tooltip=null,this.visible=!0}set fieldFormat(e){this._set("fieldFormat",e),this._set("format",e?Ge(e):null)}set format(e){this._set("format",e),this._set("fieldFormat",e?Yt(e):null)}readFormat(e,i){if(!i.fieldFormat)return e?J.fromJSON(e):null}clone(){const e=super.clone();return e._set("format",this.format?.clone()),e._set("fieldFormat",this.fieldFormat?.clone()),e}};r([o({value:null,clonable:!1,types:Le,json:{write:{overridePolicy(t,e,i){const{fieldName:s}=this;return{enabled:!!s&&!s.startsWith("expression/")&&!s.startsWith("relationships/")&&!!i?.writeFieldFormat}}}}})],d.prototype,"fieldFormat",null),r([o({type:String,json:{write:!0}})],d.prototype,"fieldName",void 0),r([o({value:null,clonable:!1,type:J,json:{write:!0}})],d.prototype,"format",null),r([At("format")],d.prototype,"readFormat",null),r([o({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],d.prototype,"isEditable",void 0),r([o({type:String,json:{write:!0}})],d.prototype,"label",void 0),r([o({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],d.prototype,"statisticType",void 0),r([Mt(new zt({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],d.prototype,"stringFieldOption",void 0),r([o({type:String,json:{write:!0}})],d.prototype,"tooltip",void 0),r([o({type:Boolean,json:{write:!0}})],d.prototype,"visible",void 0),d=r([l("esri.popup.FieldInfo")],d);const pe=d;var wt;let b=wt=class extends I{constructor(t){super(t),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}clone(){return new wt(R({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};r([o({type:Object,json:{write:!0}})],b.prototype,"attributes",void 0),r([o({type:String,json:{write:!0}})],b.prototype,"description",void 0),r([o({type:[pe],json:{write:!0}})],b.prototype,"fieldInfos",void 0),r([o({type:String,json:{write:!0}})],b.prototype,"title",void 0),r([o({type:["fields"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],b.prototype,"type",void 0),b=wt=r([l("esri.popup.content.FieldsContent")],b);const Q=b;let C=class extends u{constructor(e){super(e),this.altText=null,this.caption="",this.title="",this.type=null}};r([o({type:String,json:{write:!0}})],C.prototype,"altText",void 0),r([o({type:String,json:{write:!0}})],C.prototype,"caption",void 0),r([o({type:String,json:{write:!0}})],C.prototype,"title",void 0),r([o({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],C.prototype,"type",void 0),C=r([l("esri.popup.content.mixins.MediaInfo")],C);const kt=C;var vt;let O=vt=class extends ve{constructor(t){super(t),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){return new vt({color:this.color?.clone(),fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};r([o()],O.prototype,"color",void 0),r([o()],O.prototype,"fieldName",void 0),r([o()],O.prototype,"tooltip",void 0),r([o()],O.prototype,"value",void 0),O=vt=r([l("esri.popup.content.support.ChartMediaInfoValueSeries")],O);const ze=O;var gt;let S=gt=class extends u{constructor(t){super(t),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new gt({colors:R(this.colors),fields:R(this.fields),normalizeField:this.normalizeField,series:R(this.series),tooltipField:this.tooltipField})}};r([o({type:[Ae],json:{type:[[w]],write:!0}})],S.prototype,"colors",void 0),r([o({type:[String],json:{write:{isRequired:!0}}})],S.prototype,"fields",void 0),r([o({type:String,json:{write:!0}})],S.prototype,"normalizeField",void 0),r([o({type:[ze],json:{read:!1}})],S.prototype,"series",void 0),r([o({type:String,json:{write:!0}})],S.prototype,"tooltipField",void 0),S=gt=r([l("esri.popup.content.support.ChartMediaInfoValue")],S);const Ve=S;let G=class extends kt{constructor(e){super(e),this.type=null,this.value=void 0}};r([o({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],G.prototype,"type",void 0),r([o({type:Ve,json:{write:{isRequired:!0}}})],G.prototype,"value",void 0),G=r([l("esri.popup.content.mixins.ChartMediaInfo")],G);const dt=G,ct=ge()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var xt;let it=xt=class extends dt{constructor(t){super(t),this.type="bar-chart"}clone(){return new xt({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};r([o({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:{writer:ct.write,isRequired:!0}}})],it.prototype,"type",void 0),it=xt=r([l("esri.popup.content.BarChartMediaInfo")],it);const ue=it;var Ft;let st=Ft=class extends dt{constructor(t){super(t),this.type="column-chart"}clone(){return new Ft({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};r([o({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:{writer:ct.write,isRequired:!0}}})],st.prototype,"type",void 0),st=Ft=r([l("esri.popup.content.ColumnChartMediaInfo")],st);const de=st;var $t;let P=$t=class extends u{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new $t({linkURL:this.linkURL,sourceURL:this.sourceURL})}};r([o({type:String,json:{write:!0}})],P.prototype,"linkURL",void 0),r([o({type:String,json:{write:{isRequired:!0}}})],P.prototype,"sourceURL",void 0),P=$t=r([l("esri.popup.content.support.ImageMediaInfoValue")],P);const Ke=P;var It;let B=It=class extends kt{constructor(t){super(t),this.refreshInterval=0,this.type="image",this.value=void 0}clone(){return new It({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?.clone()})}};r([o({type:Number,json:{write:!0}})],B.prototype,"refreshInterval",void 0),r([o({type:["image"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],B.prototype,"type",void 0),r([o({type:Ke,json:{write:{isRequired:!0}}})],B.prototype,"value",void 0),B=It=r([l("esri.popup.content.ImageMediaInfo")],B);const ce=B;var jt;let nt=jt=class extends dt{constructor(t){super(t),this.type="line-chart"}clone(){return new jt({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};r([o({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:{writer:ct.write,isRequired:!0}}})],nt.prototype,"type",void 0),nt=jt=r([l("esri.popup.content.LineChartMediaInfo")],nt);const ye=nt;var bt;let lt=bt=class extends dt{constructor(t){super(t),this.type="pie-chart"}clone(){return new bt({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};r([o({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:{writer:ct.write,isRequired:!0}}})],lt.prototype,"type",void 0),lt=bt=r([l("esri.popup.content.PieChartMediaInfo")],lt);const he=lt,St={base:kt,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":ue,"column-chart":de,"line-chart":ye,"pie-chart":he,image:ce}};var Nt;let y=Nt=class extends I{constructor(t){super(t),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map(e=>e.type==="image"?ce.fromJSON(e):e.type==="barchart"?ue.fromJSON(e):e.type==="columnchart"?de.fromJSON(e):e.type==="linechart"?ye.fromJSON(e):e.type==="piechart"?he.fromJSON(e):void 0).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map(i=>i.toJSON())}clone(){return new Nt(R({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};r([o()],y.prototype,"activeMediaInfoIndex",void 0),r([o({type:Object,json:{write:!0}})],y.prototype,"attributes",void 0),r([o({type:String,json:{write:!0}})],y.prototype,"description",void 0),r([o({types:[St]})],y.prototype,"mediaInfos",void 0),r([At("mediaInfos")],y.prototype,"readMediaInfos",null),r([M("mediaInfos")],y.prototype,"writeMediaInfos",null),r([o({type:String,json:{write:!0}})],y.prototype,"title",void 0),r([o({type:["media"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],y.prototype,"type",void 0),y=Nt=r([l("esri.popup.content.MediaContent")],y);const X=y;var Rt;let U=Rt=class extends u{constructor(t){super(t),this.field=null,this.order=null}clone(){return new Rt({field:this.field,order:this.order})}};r([o({type:String,json:{write:!0}})],U.prototype,"field",void 0),r([o({type:["asc","desc"],json:{write:!0}})],U.prototype,"order",void 0),U=Rt=r([l("esri.popup.support.RelatedRecordsInfoFieldOrder")],U);const me=U;let f=class extends $(I){constructor(e){super(e),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};r([o({type:String,json:{write:!0}})],f.prototype,"description",void 0),r([o({type:Number,json:{type:w,write:!0}})],f.prototype,"displayCount",void 0),r([o({type:["list"],json:{write:{isRequired:!0}}})],f.prototype,"displayType",void 0),r([o({type:[me],json:{write:!0}})],f.prototype,"orderByFields",void 0),r([o({type:Number,json:{type:w,write:{isRequired:!0}}})],f.prototype,"relationshipId",void 0),r([o({type:String,json:{write:!0}})],f.prototype,"title",void 0),r([o({type:["relationship"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],f.prototype,"type",void 0),f=r([l("esri.popup.content.RelationshipContent")],f);const Y=f;var _t;let z=_t=class extends I{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new _t({text:this.text})}};r([o({type:String,json:{write:!0}})],z.prototype,"text",void 0),r([o({type:["text"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],z.prototype,"type",void 0),z=_t=r([l("esri.popup.content.TextContent")],z);const Z=z;let F=class extends $(u){constructor(e){super(e),this.title=null,this.description=null,this.type=null,this.associatedNetworkSourceId=null,this.associatedAssetGroup=null,this.associatedAssetType=null}};r([o({type:String,json:{write:!0}})],F.prototype,"title",void 0),r([o({type:String,json:{write:!0}})],F.prototype,"description",void 0),r([o({type:["attachment","connectivity","container","content","structure"],json:{write:!0}})],F.prototype,"type",void 0),r([o({type:Number,json:{type:w,write:!0}})],F.prototype,"associatedNetworkSourceId",void 0),r([o({type:Number,json:{type:w,write:!0}})],F.prototype,"associatedAssetGroup",void 0),r([o({type:Number,json:{type:w,write:!0}})],F.prototype,"associatedAssetType",void 0),F=r([l("esri.popup.support.UtilityNetworkAssociationType")],F);const He=F;let N=class extends $(I){constructor(e){super(e),this.description=null,this.displayCount=null,this.title=null,this.associationTypes=[],this.type="utility-network-associations"}};r([o({type:String,json:{write:!0}})],N.prototype,"description",void 0),r([o({type:Number,json:{type:w,write:!0}})],N.prototype,"displayCount",void 0),r([o({type:String,json:{write:!0}})],N.prototype,"title",void 0),r([o({type:[He],json:{write:!0}})],N.prototype,"associationTypes",void 0),r([Mt({utilityNetworkAssociations:"utility-network-associations"})],N.prototype,"type",void 0),N=r([l("esri.popup.content.UtilityNetworkAssociationsContent")],N);const Bt=N,Qe={base:null,key:"type",typeMap:{attachment:H,media:X,text:Z,expression:pt,field:Q,relationship:Y,utilityNetworkAssociations:Bt}},Xe={base:null,key:"type",typeMap:{attachment:H,media:X,text:Z,expression:pt,field:Q,relationship:Y}};var Ct;let T=Ct=class extends u{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new Ct({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};r([o({type:String,json:{write:!0}})],T.prototype,"name",void 0),r([o({type:String,json:{write:!0}})],T.prototype,"title",void 0),r([o({type:String,json:{write:!0}})],T.prototype,"expression",void 0),r([o({type:["string","number"],json:{write:!0}})],T.prototype,"returnType",void 0),T=Ct=r([l("esri.popup.ExpressionInfo")],T);const Ye=T;var Ot;let V=Ot=class extends u{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new Ot({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};r([o({type:Boolean,json:{write:!0}})],V.prototype,"returnTopmostRaster",void 0),r([o({type:Boolean,json:{write:!0}})],V.prototype,"showNoDataRecords",void 0),V=Ot=r([l("esri.popup.LayerOptions")],V);const Ze=V;var Tt;let K=Tt=class extends u{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new Tt({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?R(this.orderByFields):null})}};r([o({type:Boolean,json:{write:!0}})],K.prototype,"showRelatedRecords",void 0),r([o({type:[me],json:{write:!0}})],K.prototype,"orderByFields",void 0),K=Tt=r([l("esri.popup.RelatedRecordsInfo")],K);const Pt=K,q="relationships/",Ut="expression/",tr=L.ofType({key:"type",defaultKeyValue:"button",base:ke,typeMap:{button:Ee,toggle:Me}}),er={base:I,key:"type",typeMap:{media:X,custom:Je,text:Z,attachments:H,fields:Q,expression:pt,relationship:Y,utilityNetworkAssociations:Bt}},fe=new Set(["attachments","fields","media","text","expression","relationship"]),rr=new Set([...fe,"utility-network-associations"]);let p=class extends $(u){constructor(t){super(t),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(t){return Array.isArray(t)?t.map(e=>xe(er,e)):typeof t=="string"||typeof t=="function"||t instanceof HTMLElement||$e(t)?t:(Fe.getLogger(this).error("content error","unsupported content value",{value:t}),null)}readContent(t,e){const{popupElements:i}=e;return Array.isArray(i)&&i.length>0?this._readPopupInfoElements(e.description,e.mediaInfos,i):this._readPopupInfo(e)}writeWebSceneContent(t,e,i,s){this._writePopupTemplateContent(t,e,s)}writeWebMapContent(t,e,i,s){this._writePopupTemplateContent(t,e,s)}writeFieldInfos(t,e,i,s){const{content:n}=this,a=Array.isArray(n)?n:null,{writeFieldFormat:c,...v}=s||{};if(t){const h=a?a.filter(g=>g.type==="fields"):[],yt=h.length&&h.every(g=>g.fieldInfos?.length);e.fieldInfos=t.filter(Boolean).map(g=>{const Jt=g.toJSON(v);return yt&&(Jt.visible=!1),Jt})}if(a)for(const h of a)h.type==="fields"&&this._writeFieldsContent(h,e,v)}writeLayerOptions(t,e,i,s){e[i]=!t||t.showNoDataRecords===null&&t.returnTopmostRaster===null?null:t.toJSON(s)}writeTitle(t,e){e.title=t||""}async collectRequiredFields(t,e,i){const s=this.expressionInfos||[];await this._collectExpressionInfoFields(t,e,i,[...s,...this._getContentExpressionInfos(this.content,s)]),_e(t,e,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(t,e){const i=new Set;return await this.collectRequiredFields(i,t,e),[...i].sort()}_writePopupTemplateContent(t,e,i){typeof t!="string"?Array.isArray(t)&&(e.popupElements=t.filter(s=>i?.origin==="web-scene"?fe.has(s.type):rr.has(s.type)).map(s=>s?.toJSON(i)),e.popupElements.forEach(s=>{s.type==="attachments"?this._writeAttachmentContent(e):s.type==="media"?this._writeMediaContent(s,e):s.type==="text"?this._writeTextContent(s,e):s.type==="relationship"&&this._writeRelationshipContent(s,e)})):e.description=t}_writeFieldsContent(t,e,i){const s=t.fieldInfos;if(!Array.isArray(s)||!s.length)return;const n=e.fieldInfos;if(Array.isArray(n))for(const a of s){const c=n.find(v=>v.fieldName?.toLowerCase()===a.fieldName?.toLowerCase());c?c.visible=!0:n.push(a.toJSON(i))}else e.fieldInfos=s.map(a=>a.toJSON(i))}_writeAttachmentContent(t){t.showAttachments||(t.showAttachments=!0)}_writeRelationshipContent(t,e){const i=t.orderByFields?.map(n=>this._toFieldOrderJSON(n,t.relationshipId))||[],s=[...e.relatedRecordsInfo?.orderByFields||[],...i];e.relatedRecordsInfo={showRelatedRecords:!0,...s?.length&&{orderByFields:s}}}_writeTextContent(t,e){!e.description&&t.text&&(e.description=t.text)}_writeMediaContent(t,e){if(!Array.isArray(t.mediaInfos)||!t.mediaInfos.length)return;const i=R(t.mediaInfos);Array.isArray(e.mediaInfos)?e.mediaInfos=[...e.mediaInfos,...i]:e.mediaInfos=i}_readPopupInfoElements(t,e,i){const s={description:!1,mediaInfos:!1};return i.map(n=>n.type==="media"?(n.mediaInfos||!e||s.mediaInfos||(n.mediaInfos=e,s.mediaInfos=!0),X.fromJSON(n)):n.type==="text"?(n.text||!t||s.description||(n.text=t,s.description=!0),Z.fromJSON(n)):n.type==="attachments"?H.fromJSON(n):n.type==="fields"?Q.fromJSON(n):n.type==="expression"?pt.fromJSON(n):n.type==="relationship"?Y.fromJSON(n):n.type==="utilityNetworkAssociations"?Bt.fromJSON(n):void 0).filter(Boolean)}_toRelationshipContent(t){const{field:e,order:i}=t;if(!e?.startsWith(q))return null;const s=e.replace(q,"").split("/");if(s.length!==2)return null;const n=parseInt(s[0],10),a=s[1];return!Number.isNaN(n)&&a?Y.fromJSON({relationshipId:n,orderByFields:[{field:a,order:i}]}):null}_toFieldOrderJSON(t,e){const{order:i,field:s}=t;return{field:`${q}${e}/${s}`,order:i}}_readPopupInfo({description:t,mediaInfos:e,showAttachments:i,relatedRecordsInfo:s={showRelatedRecords:!1}}){const n=[];t?n.push(new Z({text:t})):n.push(new Q),Array.isArray(e)&&e.length&&n.push(X.fromJSON({mediaInfos:e})),i&&n.push(H.fromJSON({displayType:"auto"}));const{showRelatedRecords:a,orderByFields:c}=s;return a&&c?.length&&c.forEach(v=>{const h=this._toRelationshipContent(v);h&&n.push(h)}),n.length?n:t}_getContentElementFields(t){const e=t?.type;if(e==="attachments")return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description)];if(e==="custom")return t.outFields||[];if(e==="fields")return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description),...this._getFieldInfoFields(t.fieldInfos??this.fieldInfos)];if(e==="media"){const i=t.mediaInfos||[];return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description),...i.reduce((s,n)=>[...s,...this._getMediaInfoFields(n)],[])]}return e==="text"?this._extractFieldNames(t.text):e==="relationship"||e==="utility-network-associations"?[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description)]:[]}_getMediaInfoFields(t){const{caption:e,title:i,value:s}=t,n=s||{},{fields:a,normalizeField:c,tooltipField:v,sourceURL:h,linkURL:yt}=n,g=[...this._extractFieldNames(i),...this._extractFieldNames(e),...this._extractFieldNames(h),...this._extractFieldNames(yt),...a??[]];return c&&g.push(c),v&&g.push(v),g}_getContentExpressionInfos(t,e){return Array.isArray(t)?t.reduce((i,s)=>[...i,...s.type==="expression"&&s.expressionInfo?[s.expressionInfo]:[]],e):[]}_getContentFields(t){return typeof t=="string"?this._extractFieldNames(t):Array.isArray(t)?t.reduce((e,i)=>[...e,...this._getContentElementFields(i)],[]):[]}async _collectExpressionInfoFields(t,e,i,s){s&&await Promise.all(s.map(n=>Ce(t,e,i,n.expression)))}_getFieldInfoFields(t){return t?t.filter(({fieldName:e,visible:i})=>!(i!==void 0&&!i||!e||e.startsWith(q)||e.startsWith(Ut))).map(e=>e.fieldName):[]}_getActionsFields(t){return t?t.toArray().reduce((e,i)=>[...e,...this._getActionFields(i)],[]):[]}_getActionFields(t){const{className:e,title:i,type:s}=t,n=s==="button"||s==="toggle"?t.image:"";return[...this._extractFieldNames(i),...this._extractFieldNames(e),...this._extractFieldNames(n)]}_getTitleFields(t){return typeof t=="string"?this._extractFieldNames(t):[]}_extractFieldNames(t){return Oe(t).filter(e=>!(e.startsWith(q)||e.startsWith(Ut)))}};r([o({type:tr})],p.prototype,"actions",void 0),r([o()],p.prototype,"content",void 0),r([Ie("content")],p.prototype,"castContent",null),r([At("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],p.prototype,"readContent",null),r([M("web-scene","content",{popupElements:{type:L.ofType(Xe)},showAttachments:{type:Boolean},mediaInfos:{type:L.ofType(St)},description:{type:String},relatedRecordsInfo:{type:Pt}})],p.prototype,"writeWebSceneContent",null),r([M("content",{popupElements:{type:L.ofType(Qe)},showAttachments:{type:Boolean},mediaInfos:{type:L.ofType(St)},description:{type:String},relatedRecordsInfo:{type:Pt}})],p.prototype,"writeWebMapContent",null),r([o({type:[Ye],json:{write:!0}})],p.prototype,"expressionInfos",void 0),r([o({type:[pe]})],p.prototype,"fieldInfos",void 0),r([M("fieldInfos")],p.prototype,"writeFieldInfos",null),r([o({type:Ze})],p.prototype,"layerOptions",void 0),r([M("layerOptions")],p.prototype,"writeLayerOptions",null),r([o({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],p.prototype,"lastEditInfoEnabled",void 0),r([o()],p.prototype,"outFields",void 0),r([o()],p.prototype,"overwriteActions",void 0),r([o()],p.prototype,"returnGeometry",void 0),r([o({json:{type:String}})],p.prototype,"title",void 0),r([M("title")],p.prototype,"writeTitle",null),p=r([l("esri.PopupTemplate")],p);const Cr=p,we=Symbol("popupProvider");function Or(t){return typeof t=="object"&&t!==null&&"popupEnabled"in t&&"popupTemplate"in t}function or(t){return!!t&&we in t}function Tr(t){return or(t)?t[we]:null}export{Ge as D,X as I,ot as M,we as a,Le as b,Ir as c,Ye as d,me as e,pe as f,He as g,ut as h,A as i,Be as j,Z as k,Q as l,J as m,H as n,qe as o,ze as p,Cr as q,Or as r,Tr as t};
