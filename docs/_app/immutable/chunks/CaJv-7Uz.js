import{r as s,m as u,a as d,b as g,ap as h,Q as m,O as v,M as p,g as w,t as $}from"./oKHlAiyk.js";import{H as _,a as j}from"./BxFa---M.js";import{V as C}from"./EnYQAt9i.js";import"./BU-dfLkt.js";import{l as k,w as L}from"./B-7eUg25.js";function D(e,t,n){return p(e.map(((r,i)=>t.apply(n,[r,i]))))}async function V(e,t,n){return(await p(e.map(((r,i)=>t.apply(n,[r,i]))))).map((r=>r.value))}function l(e){return{ok:!0,value:e}}function c(e){return{ok:!1,error:e}}function S(e){return e!=null&&e.ok===!0?e.value:null}function H(e){return e!=null&&e.ok===!1?e.error:null}async function q(e){if(e==null)return{ok:!1,error:new Error("no promise provided")};try{return l(await e)}catch(t){return c(t)}}async function F(e){try{return l(await e)}catch(t){return w(t),c(t)}}function G(e,t){return new a(e,t)}let a=class extends g{get value(){return S(this._result)}get error(){return H(this._result)}get finished(){return this._result!=null}constructor(e,t){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=h(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:n}=this._abortController;this.promise=e(n),this.promise.then((r=>{this._result=l(r),this._cleanup()}),(r=>{this._result=c(r),this._cleanup()})),this._abortHandle=m(t,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=v(this._abortHandle),this._abortController=null}};s([u()],a.prototype,"value",null),s([u()],a.prototype,"error",null),s([u()],a.prototype,"finished",null),s([u()],a.prototype,"promise",void 0),s([u()],a.prototype,"_result",void 0),a=s([d("esri.core.asyncUtils.ReactiveTask")],a);const o=new WeakMap;function f(e){return!e.destroyed&&(o.has(e)||e.addHandles([k((()=>{const t=e.parent;return!(!t||!("type"in t))&&(t.type==="catalog-dynamic-group"||f(t))}),(t=>o.set(e,t)),L),$((()=>o.delete(e)))]),o.get(e))}function J(e){return x(e)||E(e)}function N(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="feature"}function Q(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="graphics"}function R(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="map-image"}function W(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="knowledge-graph"&&"layers"in e}function K(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="knowledge-graph-sublayer"}function E(e){return e?.type==="scene"}function X(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="subtype-group"&&"sublayers"in e}function Y(e){return e?.type==="subtype-sublayer"}function x(e){const t=e?.type;return t==="imagery-tile"||t==="tile"||t==="open-street-map"||t==="vector-tile"||t==="web-tile"||t==="wmts"}function Z(e){const t=e?.type;return t==="base-tile"||t==="tile"||t==="elevation"||t==="imagery-tile"||t==="base-elevation"||t==="open-street-map"||t==="wcs"||t==="web-tile"||t==="wmts"||t==="vector-tile"}const ee={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function te(e){const t=e?.type;return t==="building-scene"||t==="integrated-mesh"||t==="point-cloud"||t==="scene"}function ne(e){return e==="integrated-mesh"||e==="integrated-mesh-3dtiles"}function re(e){return e?.type==="feature"&&!e.url&&e.source?.type==="memory"}function ae(e){const t=e?.type;return(t==="feature"||t==="subtype-group"||t==="oriented-imagery")&&e?.source?.type==="feature-layer"}function se(e){if(e.activeLayer){const t=e.activeLayer.tileMatrixSet;if(t)return t;const n=e.activeLayer.tileMatrixSets;if(n)return n}return null}async function ie(e,t){const n=j?.findServerInfo(e);if(n?.currentVersion!=null)return n.owningSystemUrl||null;const r=e.toLowerCase().indexOf("/rest/services");if(r===-1)return null;const i=`${e.slice(0,r)}/rest/info`,y=t!=null?t.signal:null,{data:b}=await _(i,{query:{f:"json"},responseType:"json",signal:y});return b?.owningSystemUrl||null}function M(e){if(!("capabilities"in e))return!1;switch(e.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"sublayer":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function ue(e){return M(e)?"effectiveCapabilities"in e?e.effectiveCapabilities:e.capabilities:null}function O(e){if(!("editingEnabled"in e))return!1;switch(e.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":return!0;default:return!1}}function oe(e){return!!O(e)&&("effectiveEditingEnabled"in e?e.effectiveEditingEnabled:e.editingEnabled)}function le(e){const t=new C;for(const n of e.allLayers.concat(e.allTables))n.type==="csv"||f(n)||("charts"in n&&t.push(n),n.type==="subtype-group"&&t.push(...n.sublayers));return t}function P(e,t){return null}function ce(e){return null}function U(e){return!e||e.type==="Feature Service"&&!e.sourceUrl}function pe(e,t){!t||!U(e)||P(e.url)}export{le as $,ce as A,ie as B,ue as D,U as G,pe as H,oe as N,se as O,M as P,q as _,D as a,X as b,F as c,G as d,f as e,Z as f,Y as g,ee as h,J as i,te as j,re as k,K as l,x as m,W as n,Q as o,V as p,R as s,N as u,ne as w,ae as x,P as z};
