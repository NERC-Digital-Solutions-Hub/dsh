const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CfYA-Zey.js","./Df8z3OOU.js","./Ci6C1k20.js","./bnayRBMH.js","./ChMEnlEh.js","./DUQhet5j.js","./BbNfuhIx.js","./B2reeZpr.js","./Ckkezzl2.js","./D8DYOP_H.js","./Br6uo848.js","./l4Mq69oL.js","./Dg3eUHMe.js","./HP4IdprE.js","./e8yrlcGX.js","./Ospc2ekY.js","./PPVm8Dsz.js","./VsVV2Qu9.js","./DMOtirar.js","./C44l9BTJ.js","./DPb6J-GU.js","./Bx_SOnnc.js","./B_1xfw7E.js","./Bql3rzlF.js","./B7QA-6tf.js","./JYIJenmP.js","./BId0ggrP.js","./BrHs9PI0.js","./DMg1ora8.js","./CmrKWzcE.js","./ZccEQU0c.js","./CTeuBEij.js","./qyF9FwQ9.js","./XI-Li77m.js","./BKojvrsN.js","./BQijcg-y.js"])))=>i.map(i=>d[i]);
import{i as V}from"./BbNfuhIx.js";import{j as U}from"./DbJ2Hhg-.js";import{_ as r,m as s,a as v,n as _,u as te,x as re}from"./ChMEnlEh.js";import{H as Z}from"./DMOtirar.js";import{a as u,N as ie}from"./DUQhet5j.js";import{r as z}from"./Ospc2ekY.js";import{y as N,A as se}from"./JYIJenmP.js";import{v as q,a as j,c as oe,n as ne,d as le,V as ae,u as ue}from"./BxHLGPTf.js";import{_ as pe}from"./PPVm8Dsz.js";import{e as ye}from"./DAgR0H0w.js";import{v as ce}from"./ZccEQU0c.js";import{u as f}from"./Df8z3OOU.js";import{s as de}from"./CrN1D2UE.js";import{_ as he}from"./BrHs9PI0.js";import{n as B}from"./C_7wlWh7.js";import{H as me}from"./qyF9FwQ9.js";import{r as A}from"./DocasDeo.js";import{s as fe}from"./VsVV2Qu9.js";import{m as H,a as ge}from"./N26hZKzP.js";import{o as K}from"./DPJXGPFY.js";import{l as k}from"./qprIf_nJ.js";import{a as be,e as ve,c as we}from"./BVywCBWf.js";import{u as Q}from"./CthN89Dj.js";import{d as xe}from"./gCAS-84N.js";import{p as W}from"./BilUgk_g.js";import{$ as X}from"./GEtRefTy.js";class P{static parse(t,i,o){const n=[],l=[],p=t.split(";");for(let m=0;m<p.length;m++){const y=p[m];if(y){if(y.includes("po:")){const c=y.slice(3).split("|");if(c.length===3){const[I,$,E]=c,F=je(I,$,E);F&&l.push(F)}continue}if(y.includes("|")){for(const c of y.split("|"))if(i.has(c)){n.push(c);break}}else if(i.has(y))n.push(y);else if(m===0){n.length=0,n.push(Ie(o));break}}}return new P(n,l)}constructor(t,i){this.partNames=t,this.overrides=i}}function Se(e,t){if(e==="DashTemplate")return t.split(" ").map(i=>Number(i));if(e==="Color"){const i=new f(t).toRgba();return[i[0],i[1],i[2],255*i[3]]}return Number(t)}function je(e,t,i){return{primitiveName:e,propertyName:t,value:Se(t,i),defaultValue:null}}function Ie(e){switch(e){case"esriGeometryPolyline":return"Invalid_L";case"esriGeometryPolygon":return"Invalid_A";default:return"Invalid_P"}}const $e={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};let Y=class{constructor(t,i,o,n){this.url=t,this.fieldMap=o,this.dictionaryInfo=n,this._symbolPartCache=new ye(100);const l=async()=>de.from(await n,i,o);this._evaluator=l()}async getSymbolAsync(t,i,o=!0){const n=await this._evaluator,l=i?.fields??he(t.attributes),p=n.createDictionaryFieldsIndex(l),m=n.evaluate(t,i?.scale??0,p,i?.spatialReference);if(m==null)return null;const y=ce(t.geometry),c=P.parse(m,n.itemNames,y),I=y==="esriGeometryPoint"&&!t.geometry?.hasZ;return await this._cimPartsToCIMSymbol(t,c.partNames,c.overrides,I,i,o,p)}async getSymbolForControlString(t,i,o){const n=await this._evaluator,l=P.parse(t,n.itemNames,i),p=i==="esriGeometryPoint"&&!o,m=J(await Promise.all(l.partNames.map(y=>this._getSymbolPart(y))),l.overrides,p);return new B({data:m})}async _cimPartsToCIMSymbol(t,i,o,n,l,p,m){const y=i.map($=>this._getSymbolPart($,l));let c=await Promise.all(y);if(p&&this.fieldMap&&c.length>0){const{OverrideHelper:$}=await pe(()=>import("./CfYA-Zey.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35]),import.meta.url);c=u(c);for(const E of c)$.applyDictionaryTextOverrides(E,t,this.fieldMap,m,me(E))}const I=J(c,o,n);return new B({data:I})}async _fetchSymbolPart(t,i){const o=await this.dictionaryInfo,n=(this.url+"/"+o.cimRefTemplateUrl).replaceAll(/\{itemName\}/gi,t),{data:l}=await Z(n,{responseType:"json",query:{f:"json"},...i});return l}async _getSymbolPart(t,i){let o=this._symbolPartCache.get(t);return o||(o=this._fetchSymbolPart(t,i),this._symbolPartCache.put(t,o)),o}};function J(e,t,i){if(!e||e.length===0)return null;const o={...e[0]};if(e.length>1){o.effects=null,o.symbolLayers=[];for(const n of e){const l=n;if(l.effects!=null)for(const p of l.symbolLayers)p.effects==null?p.effects=l.effects:p.effects.unshift(...l.effects);o.symbolLayers.unshift(...l.symbolLayers)}}return i&&(o.callout=$e),{type:"CIMSymbolReference",symbol:o,primitiveOverrides:t}}var C;let g=C=class extends q(j){constructor(e){super(e),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){const e=this.getDictionaryInfo();return new Y(this.url,this.config,this.fieldMap??{},e)}writeData(e,t){e&&(t.scalingExpressionInfo={expression:e,returnType:"number"})}writeVisualVariables(e,t,i,o){o?.origin||super.writeVisualVariables(e,t,i,o)}clone(){return new C({config:u(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:u(this.fieldMap),url:u(this.url),visualVariables:u(this.visualVariables)})}async getSymbolAsync(e,t,i=!0){return this._loader.getSymbolAsync(e,t,i)}async getSymbolForControlString(e,t,i){return this._loader.getSymbolForControlString(e,t,i)}getDictionaryInfo(){return this._dictionaryInfoPromise||(this._dictionaryInfoPromise=this._fetchDictionaryInfo()),this._dictionaryInfoPromise}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t),this.scaleExpression&&await N(e,t,null,this.scaleExpression);for(const i in this.fieldMap){const o=this.fieldMap[i];t.has(o)&&e.add(o)}}get arcadeRequired(){return!0}getSymbol(){return null}get symbols(){return[]}getAttributeHash(){return this.visualVariables?.reduce((e,t)=>e+t.getAttributeHash(),"")??""}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}async _fetchDictionaryInfo(){const{data:e}=await Z(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"}});return e}};r([s({type:Y})],g.prototype,"_loader",null),r([s({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],g.prototype,"config",void 0),r([s({type:Object,json:{write:!0}})],g.prototype,"fieldMap",void 0),r([s({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],g.prototype,"scaleExpression",void 0),r([z("scaleExpression")],g.prototype,"writeData",null),r([s({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(e){return{enabled:!!e&&!!this.scaleExpression}}}}})],g.prototype,"scaleExpressionTitle",void 0),r([s({type:String,json:{write:!0}})],g.prototype,"url",void 0),r([z("visualVariables")],g.prototype,"writeVisualVariables",null),g=C=r([v("esri.renderers.DictionaryRenderer")],g);var R;let b=R=class extends _{constructor(e){super(e),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(e){return e==null?e:typeof e=="function"?(V.getLogger(this).error(".field: field must be a string value"),null):te(e)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){return new R({color:this.color?.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};r([s({type:f,json:{type:[Number],write:!0}})],b.prototype,"color",void 0),r([s({type:String,json:{write:!0}})],b.prototype,"field",void 0),r([fe("field")],b.prototype,"castField",null),r([s({type:String,json:{write:!0}})],b.prototype,"label",void 0),r([s({type:String,json:{write:!0}})],b.prototype,"valueExpression",void 0),r([s({type:String,json:{write:!0}})],b.prototype,"valueExpressionTitle",void 0),b=R=r([v("esri.renderers.support.AttributeColorInfo")],b);const ee=b;var T;let D=T=class extends _{constructor(){super(...arguments),this.unit=null}clone(){return new T({unit:this.unit})}};r([s({type:String,json:{write:!0}})],D.prototype,"unit",void 0),D=T=r([v("esri.renderers.support.DotDensityLegendOptions")],D);const _e=D;var O;let d=O=class extends q(j){constructor(e){super(e),this.attributes=null,this.backgroundColor=new f([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new H,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}set visualVariables(e){super.visualVariables=e}calculateDotValue(e){if(this.referenceScale==null)return this.dotValue;const t=e/this.referenceScale*this.dotValue;return t<1?1:t}getSymbol(){return new ge({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol()]}getAttributeHash(){return this.attributes?.reduce((e,t)=>e+t.getAttributeHash(),"")??""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new O({attributes:u(this.attributes),backgroundColor:u(this.backgroundColor),dotBlendingEnabled:u(this.dotBlendingEnabled),dotShape:u(this.dotShape),dotSize:u(this.dotSize),dotValue:u(this.dotValue),legendOptions:u(this.legendOptions),outline:u(this.outline),referenceScale:u(this.referenceScale),seed:u(this.seed),visualVariables:u(this.visualVariables),authoringInfo:u(this.authoringInfo)})}getControllerHash(){return`${this.attributes?.map(t=>t.field||t.valueExpression||"")}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t);for(const i of this.attributes??[])i.valueExpression&&await N(e,t,null,i.valueExpression),i.field&&e.add(i.field)}};r([s({type:[ee],json:{write:!0}})],d.prototype,"attributes",void 0),r([s({type:f,json:{write:!0}})],d.prototype,"backgroundColor",void 0),r([s({type:Boolean,json:{write:!0}})],d.prototype,"dotBlendingEnabled",void 0),r([s({type:String,json:{write:!1}})],d.prototype,"dotShape",void 0),r([s({type:Number,json:{write:!0}})],d.prototype,"dotSize",void 0),r([s({type:_e,json:{write:!0}})],d.prototype,"legendOptions",void 0),r([s({type:H,json:{default:null,write:!0}})],d.prototype,"outline",void 0),r([s({type:Number,json:{write:!0}})],d.prototype,"dotValue",void 0),r([s({type:Number,json:{write:!0}})],d.prototype,"referenceScale",void 0),r([s({type:Number,json:{write:!0}})],d.prototype,"seed",void 0),r([A({dotDensity:"dot-density"})],d.prototype,"type",void 0),d=O=r([v("esri.renderers.DotDensityRenderer")],d);var M;let w=M=class extends _{constructor(e){super(e),this.color=null,this.ratio=null}clone(){return new M({color:this.color&&this.color.clone(),ratio:this.ratio})}};r([s({type:f,json:{type:[re],default:null,write:{isRequired:!0}}})],w.prototype,"color",void 0),r([s({type:Number,json:{write:{isRequired:!0}}})],w.prototype,"ratio",void 0),w=M=r([v("esri.renderers.support.HeatmapColorStop")],w);let S=class extends k(_){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};r([s({type:String,json:{write:!0}})],S.prototype,"minLabel",void 0),r([s({type:String,json:{write:!0}})],S.prototype,"maxLabel",void 0),r([s({type:String,json:{write:!0}})],S.prototype,"title",void 0),S=r([v("esri.renderers.support.HeatmapLegendOptions")],S);var L;function G(e){if(e!=null){const{maxDensity:t,minDensity:i,radius:o}=e;if(t!=null||i!=null||o!=null){const{blurRadius:n,maxPixelIntensity:l,minPixelIntensity:p,...m}=e;return m}}return e}let a=L=class extends j{constructor(e){super(e),this.authoringInfo=null,this.colorStops=[new w({ratio:0,color:new f("rgba(255, 140, 0, 0)")}),new w({ratio:.75,color:new f("rgba(255, 140, 0, 1)")}),new w({ratio:.9,color:new f("rgba(255, 0,   0, 1)")})],this.field=null,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null}normalizeCtorArgs(e){return G(e)}get blurRadius(){return be(this.radius)}set blurRadius(e){const t=this.maxPixelIntensity,i=this.minPixelIntensity;this._set("radius",ve(e)),this._set("maxDensity",t*this._pixelIntensityToDensity),this._set("minDensity",i*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(e){this._set("maxDensity",e*this._pixelIntensityToDensity)}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(e){this._set("minDensity",e*this._pixelIntensityToDensity)}get _pixelIntensityToDensity(){return 24/(we**2*this.blurRadius**4)}read(e,t){e=G(e),super.read(e,t)}getSymbol(){return new Q}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol()]}async collectRequiredFields(e,t){const i=this.field,o=this.valueExpression;i&&typeof i=="string"&&se(e,t,i),o&&typeof o=="string"&&await N(e,t,null,o)}getAttributeHash(){return""}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new L({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:u(this.colorStops),field:this.field,legendOptions:u(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};r([s({type:oe,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],a.prototype,"authoringInfo",void 0),r([s({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],a.prototype,"blurRadius",null),r([s({type:[w],json:{write:{isRequired:!0}}})],a.prototype,"colorStops",void 0),r([s({type:String,json:{write:!0}})],a.prototype,"field",void 0),r([s({type:S,json:{write:!0}})],a.prototype,"legendOptions",void 0),r([s({type:Number,json:{write:!0}})],a.prototype,"maxDensity",void 0),r([s({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],a.prototype,"maxPixelIntensity",null),r([s({type:Number,json:{write:!0}})],a.prototype,"minDensity",void 0),r([s({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],a.prototype,"minPixelIntensity",null),r([s({type:Number,cast:K,json:{write:!0}})],a.prototype,"radius",void 0),r([s({type:Number,range:{min:0},json:{default:0,write:!0}})],a.prototype,"referenceScale",void 0),r([A({heatmap:"heatmap"})],a.prototype,"type",void 0),r([s({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],a.prototype,"valueExpression",void 0),r([s({type:String})],a.prototype,"valueExpressionTitle",void 0),r([s({readOnly:!0})],a.prototype,"_pixelIntensityToDensity",null),a=L=r([v("esri.renderers.HeatmapRenderer")],a);let x=class extends k(_){constructor(){super(...arguments),this.color=new f([0,0,0,0]),this.label=null,this.threshold=0}};r([s({type:f,json:{write:!0}})],x.prototype,"color",void 0),r([s({type:String,json:{write:!0}})],x.prototype,"label",void 0),r([s({type:Number,range:{min:0,max:1},json:{write:!0}})],x.prototype,"threshold",void 0),x=r([v("esri.renderers.support.OthersCategory")],x);const Ee={base:ue,key:"type",typeMap:{size:ae,opacity:le}};let h=class extends q(k(j)){constructor(e){super(e),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new f([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new x,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart",this.visualVariables=null}getSymbol(){return new Q({size:this.size?this.size/2+(this.outline?.width||0):0})}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(ie)}getAttributeHash(){return this.visualVariables?.reduce((e,t)=>e+t.getAttributeHash(),"")??""}getMeshHash(){return this.symbols.reduce((e,t)=>e+JSON.stringify(t),"")}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t);for(const i of this.attributes)i.valueExpression&&await N(e,t,null,i.valueExpression),i.field&&e.add(i.field)}};r([s({type:[ee],json:{write:!0}})],h.prototype,"attributes",void 0),r([s(ne)],h.prototype,"backgroundFillSymbol",void 0),r([s({type:f,json:{write:!0}})],h.prototype,"defaultColor",void 0),r([s({type:String,json:{write:!0}})],h.prototype,"defaultLabel",void 0),r([s({type:Number,range:{min:0,max:1},json:{write:!0}})],h.prototype,"holePercentage",void 0),r([s({type:x,json:{write:!0}})],h.prototype,"othersCategory",void 0),r([s({type:xe,json:{write:!0}})],h.prototype,"legendOptions",void 0),r([s({type:H,json:{default:null,write:!0}})],h.prototype,"outline",void 0),r([s({type:Number,cast:K,json:{write:!0}})],h.prototype,"size",void 0),r([A({pieChart:"pie-chart"})],h.prototype,"type",void 0),r([s({types:[Ee]})],h.prototype,"visualVariables",void 0),h=r([v("esri.renderers.PieChartRenderer")],h);const ot={key:"type",base:j,typeMap:{heatmap:a,simple:W,"unique-value":X,"class-breaks":U,"dot-density":d,dictionary:g,"pie-chart":h},errorContext:"renderer"},nt={key:"type",base:j,typeMap:{simple:W,"unique-value":X,"class-breaks":U,heatmap:a},errorContext:"renderer",validate:De};function De(e){switch(e.type){case"simple":return Pe(e);case"unique-value":return Ve(e);case"class-breaks":return Ne(e);case"heatmap":return e}}function Pe(e){if(e.symbol)return e;V.getLogger("esri.renderers.support.types").error("Removed invalid 'simple' renderer without a symbol from web scene.")}function Ve(e){const t=e.uniqueValueInfos,i=t?.filter(({symbol:o,label:n},l)=>(o||V.getLogger("esri.renderers.support.types").error(`Removed invalid unique value info ([${l}] ${n}) without a symbol from web scene.`),!!o));return i?.length!==t?.length&&(e.uniqueValueInfos=i),e}function Ne(e){const t=e.classBreakInfos,i=t?.filter(({symbol:o,label:n},l)=>(o||V.getLogger("esri.renderers.support.types").error(`Removed invalid class break info ([${l}] ${n}) without a symbol from web scene.`),!!o));return i?.length!==t?.length&&(e.classBreakInfos=i),e}export{w as c,ot as m,nt as u};
