import{a as Pt,w as Rt,y as nt,r as st,P as Vt,Q as ht,c as Mt}from"./CnfuZz2S.js";import{s as ft,i as Lt}from"./BYatcg2i.js";const Yt={remove:()=>{}};function h(e){return e?{remove(){e&&(e(),e=void 0)}}:Yt}function dt(e){e.forEach((t=>t?.remove()))}function Ve(e){dt(e),e.length=0}function Gt(e){return h((()=>dt(e)))}function Me(e){return h((()=>e()?.remove()))}function Le(e){return h((()=>e?.abort()))}function Ye(e){return h(e!=null?()=>e.destroy():void 0)}function Bt(e){return typeof e=="object"&&!!e&&"remove"in e&&typeof e.remove=="function"}function Ge(e){Bt(e)&&e.remove()}function Be(e){return{[Symbol.dispose](){e.remove()}}}function Ht(e){return{setTimeout:(t,n)=>{const s=e.setTimeout(t,n);return h((()=>e.clearTimeout(s)))}}}const Qt=Ht(globalThis);function pt(e){return Wt(e)||mt(e)}function Wt(e){return e!=null&&typeof e=="object"&&"on"in e&&typeof e.on=="function"}function mt(e){return e!=null&&typeof e=="object"&&"addEventListener"in e&&typeof e.addEventListener=="function"}function Zt(e,t,n){if(!pt(e))throw new TypeError("target is not a Evented or EventTarget object");return mt(e)?Jt(e,t,n):e.on(t,n)}function Jt(e,t,n,s){if(Array.isArray(t)){const i=t.slice();for(const r of i)e.addEventListener(r,n,s);return h((()=>{for(const r of i)e.removeEventListener(r,n,s)}))}return e.addEventListener(t,n,s),h((()=>e.removeEventListener(t,n,s)))}function gt(e,t,n){if(!pt(e))throw new TypeError("target is not a Evented or EventTarget object");if("once"in e)return e.once(t,n);const s=Zt(e,t,(i=>{s.remove(),n.call(e,i)}));return s}function He(e,t){if(e==null)throw new Error(t??"value is None")}function Qe(e){return e?.destroy(),null}function We(e){return e?.dispose(),null}function Kt(e){return e?.remove(),null}function Ze(e){return e?.abort(),null}function Je(e){return e?.release(),null}function Ke(e,t,n){return e!=null&&t!=null?n!=null?n(e,t):e.equals(t):e===t}function Xe(e,t){let n;return e.some(((s,i)=>(n=t(s,i),n!=null))),n??void 0}function w(e="Aborted"){return new ft("AbortError",e)}function _t(e,t="Aborted"){if($t(e))throw w(t)}function V(e){return e instanceof AbortSignal?e:e?.signal??void 0}function $t(e){const t=V(e);return t!=null&&t.aborted}function tn(e){if(J(e))throw e}function en(e){if(!J(e))throw e}function U(e,t){const n=V(e);if(n!=null){if(!n.aborted)return gt(n,"abort",(()=>t()));t()}}function nn(e,t){const n=V(e);if(n!=null)return _t(n),gt(n,"abort",(()=>t(w())))}function sn(e,t){return V(t)==null?e:new Promise(((n,s)=>{let i=U(t,(()=>s(w())));const r=()=>{i=Kt(i)};e.then(r,r),e.then(n,s)}))}function J(e){return e?.name==="AbortError"}async function rn(e){try{return await e}catch(t){if(!J(t))throw t;return}}async function Xt(e){if(!e)return;if(typeof e.forEach!="function"){const n=Object.keys(e),s=n.map((a=>e[a])),i=await Xt(s),r={};return n.map(((a,o)=>r[a]=i[o])),r}const t=e;return Promise.allSettled(t).then((n=>Array.from(t,((s,i)=>{const r=n[i];return r.status==="fulfilled"?{promise:s,value:r.value}:{promise:s,error:r.reason}}))))}async function an(e){return(await Promise.allSettled(e)).filter((t=>t.status==="fulfilled")).map((t=>t.value))}async function on(e){return(await Promise.allSettled(e)).filter((t=>t.status==="rejected")).map((t=>t.reason))}function te(e,t=void 0,n){const s=new AbortController;return U(n,(()=>s.abort())),new Promise(((i,r)=>{let a=setTimeout((()=>{a=0,i(t)}),e);U(s,(()=>{a&&(clearTimeout(a),r(w()))}))}))}function ln(e,t,n,s){const i=n&&"abort"in n?n:null;s!=null||i||(s=n);let r=setTimeout((()=>{r=0,i?.abort()}),t);const a=()=>s||new ft("promiseUtils:timeout","The wrapped promise did not resolve within "+t+" ms");return e.then((o=>{if(r===0)throw a();return clearTimeout(r),o}),(o=>{throw clearTimeout(r),r===0?a():o}))}function un(e,t){const n=new AbortController,s=setTimeout((()=>n.abort()),t);return U(e,(()=>{n.abort(),clearTimeout(s)})),{...e,signal:n.signal}}function ee(e){return e&&typeof e.then=="function"}function rt(e){return ee(e)?e:Promise.resolve(e)}function cn(e,t=-1){let n,s,i,r,a=null;const o=(...u)=>{if(n){s=u,r&&r.reject(w()),r=G();const d=r.promise;if(a){const $=a;a=null,$.abort()}return d}if(i=r||G(),r=null,t>0){const d=new AbortController;n=rt(e(...u,d.signal));const $=n;te(t).then((()=>{n===$&&(r?d.abort():a=d)}))}else n=1,n=rt(e(...u));const c=()=>{const d=s;s=i=n=a=null,d!=null&&o(...d)},l=n,f=i;return l.then(c,c),l.then(f.resolve,f.reject),f.promise};return o}function G(){let e,t;const n=new Promise(((i,r)=>{e=i,t=r})),s=i=>{e(i)};return s.resolve=i=>e(i),s.reject=i=>t(i),s.timeout=(i,r)=>Qt.setTimeout((()=>s.reject(r)),i),s.promise=n,s}function hn(e,t){t.then(e.resolve,e.reject)}async function fn(e){await Promise.resolve(),_t(e)}function ne(e){return e?.release&&typeof e.release=="function"}function se(e){return e?.acquire&&typeof e.acquire=="function"}var m;let vt=(m=class{constructor(t,n,s,i=1,r=0){this._ctor=t,this._acquireFunction=n,this._releaseFunction=s,this.allocationSize=i,this._pool=new Array(r),this._initialSize=r;for(let a=0;a<r;a++)this._pool[a]=new this._ctor;this.allocationSize=Math.max(i,1)}destroy(){this.prune(0)}acquire(...t){let n;if(m.test.disabled)n=new this._ctor;else{if(this._pool.length===0){const s=this.allocationSize;for(let i=0;i<s;i++)this._pool[i]=new this._ctor}n=this._pool.pop()}return this._acquireFunction?this._acquireFunction(n,...t):se(n)&&n.acquire(...t),n}release(t){t&&!m.test.disabled&&(this._releaseFunction?this._releaseFunction(t):ne(t)&&t.release(),this._pool.push(t))}prune(t=this._initialSize){if(!(t>=this._pool.length)){for(let n=t;n<this._pool.length;++n){const s=this._pool[n];this._dispose(s)}this._pool.length=t}}_dispose(t){t.dispose&&typeof t.dispose=="function"&&t.dispose()}},m.test={disabled:!1},m);function re(e){e.length=0}let yt=class{constructor(t=50,n=50){this._pool=new vt(Array,void 0,re,n,t)}acquire(){return this._pool.acquire()}release(t){this._pool.release(t)}prune(){this._pool.prune(0)}static acquire(){return L.acquire()}static release(t){return L.release(t)}static prune(){L.prune()}};const L=new yt(100);function wt(e){return e.__accessor__??null}function ie(e,t){return e?.metadata?.[t]!=null}function pn(e,t,n){return n?C(e,t,{policy:n,path:""}):C(e,t,null)}function C(e,t,n){return t?Object.keys(t).reduce(((s,i)=>{const r=i;if(r==="__proto__")return s;let a=null,o="merge";if(n&&(a=n.path?`${n.path}.${i}`:i,o=n.policy(a)),o==="replace"||o==="replace-arrays"&&Array.isArray(s[r]))return s[r]=t[r],s;if(s[r]===void 0)return s[r]=Pt(t[r]),s;let u=s[r],c=t[r];if(u===c)return s;if(Array.isArray(c)||Array.isArray(s))u=u?Array.isArray(u)?s[r]=u.slice():s[r]=[u]:s[r]=[],c&&(Array.isArray(c)||(c=[c]),c.forEach((l=>{u.includes(l)||u.push(l)})));else if(c&&typeof c=="object")if(n){const l=n.path;n.path=a,s[r]=C(u,c,n),n.path=l}else s[r]=C(u,c,null);else s.hasOwnProperty(i)&&!t.hasOwnProperty(i)||(s[r]=c);return s}),e||{}):e}function bt(e){return Array.isArray(e)?e:e.split(".")}function it(e){return e.includes(",")?e.split(",").map((t=>t.trim())):[e.trim()]}function ae(e){if(Array.isArray(e)){const t=[];for(const n of e)t.push(...it(n));return t}return it(e)}function kt(e,t,n,s){const i=ae(t);if(i.length!==1){const r=i.map((a=>s(e,a,n)));return Gt(r)}return s(e,i[0],n)}function At(e,t){const n=e[e.length-1]==="?"?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const i=parseInt(n,10);if(!isNaN(i))return Array.isArray(t)?t[i]:t.at(i)}const s=wt(t);return ie(s,n)?s.get(n):t[n]}function Tt(e,t,n){if(e==null)return e;const s=At(t[n],e);return!s&&n<t.length-1?void 0:n===t.length-1?s:Tt(s,t,n+1)}function M(e,t,n=0){return typeof t!="string"||t.includes(".")?Tt(e,bt(t),n):At(t,e)}function mn(e,t){return M(e,t)}function gn(e,t){return M(t,e)!==void 0}const K={INITIALIZING:0,CONSTRUCTING:1,CONSTRUCTED:2,DESTROYING:3,DESTROYED:4},A={Dirty:1,Overridden:2,Computing:4,NonNullable:8,HasDefaultValue:16,DepTrackingInitialized:32,AutoTracked:64,ExplicitlyTracking:128};let Et=class{constructor(t){this.accessed=void 0,this._handles=void 0,this._observer=t}destroy(){this.accessed?.clear(),this.clear()}onAccessed(t){this._observer!=null&&t!==this._observer&&(this.accessed==null&&(this.accessed=new Set),this.accessed.add(t))}onTrackingEnd(){this._observer!=null&&(this.clear(),this.accessed!=null&&(this._handles==null&&(this._handles=[]),this.accessed.forEach((t=>{this._handles.push(t.observe(this._observer))})),this.accessed.clear()))}clear(){if(this._handles!=null){for(let t=0;t<this._handles.length;++t)this._handles[t].remove();this._handles.length=0}}};const N=new Et,k=[];let T=N;function oe(e){T.onAccessed(e)}let j=!1,I=!1;function y(e,t,n){if(j)return X(e,t,n);let s=null;return qt(e),s=t.call(n),St(),s}function $n(e,t){return y(N,e,t)}function X(e,t,n){const s=j;j=!0,qt(e);let i=null;try{i=t.call(n)}catch(r){I&&Lt.getLogger("esri.core.accessorSupport.tracking").error(r)}return St(),j=s,i}function qt(e){T=e,k.push(e)}function St(){const e=k.length;if(e>1){const t=k.pop();T=k[e-2],t.onTrackingEnd()}else if(e===1){const t=k.pop();T=N,t.onTrackingEnd()}else T=N}function le(e,t){if(t.flags&A.DepTrackingInitialized)return;t.flags|=A.DepTrackingInitialized;const n=I;I=!1,t.flags&A.AutoTracked?X(t.trackingTarget,t.metadata.get,e):ce(e,t),I=n}const ue=[];function ce(e,t){t.flags&A.ExplicitlyTracking||(t.flags|=A.ExplicitlyTracking,X(t.trackingTarget,(()=>{const n=t.metadata.dependsOn||ue;for(const s of n)if(typeof s!="string"||s.includes(".")){const i=bt(s);for(let r=0,a=e;r<i.length&&a!=null&&typeof a=="object";++r)a=at(a,i[r],r!==i.length-1)}else at(e,s,!1)})),t.flags&=-129)}function at(e,t,n){const s=t[t.length-1]==="?"?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const r=parseInt(s,10);if(!isNaN(r))return Array.isArray(e)?e[r]:e.at(r)}const i=wt(e);if(i){const r=i.propertiesByName.get(s);r&&(oe(r),le(e,r))}return n?e[s]:void 0}let he=class extends vt{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...t){const n=super.acquire(...t);return this._set.delete(n),n}release(t){t&&!this._set.has(t)&&(super.release(t),this._set.add(t))}_dispose(t){this._set.delete(t),super._dispose(t)}};const S=[];function Dt(e){S.push(e),S.length===1&&queueMicrotask((()=>{const t=S.slice();S.length=0;for(const n of t)n()}))}let jt=class{constructor(t,n=30){this.name=t,this._counter=0,this._samples=new Array(n)}push(t){t!=null&&(this._samples[++this._counter%this._samples.length]=t)}set(t){t!=null&&(this._samples[this._counter%this._samples.length]=t)}get median(){return this._samples.slice().sort(((t,n)=>t-n))[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce(((t,n)=>t+n),0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};var B;(function(e){const t=(r,a,o,u)=>{let c=a,l=a;const f=o>>>1,d=r[c-1];for(;l<=f;){l=c<<1,l<o&&u(r[l-1],r[l])<0&&++l;const $=r[l-1];if(u($,d)<=0)break;r[c-1]=$,c=l}r[c-1]=d},n=(r,a)=>r<a?-1:r>a?1:0;function s(r,a,o,u){a===void 0&&(a=0),o===void 0&&(o=r.length),u===void 0&&(u=n);for(let l=o>>>1;l>a;l--)t(r,l,o,u);const c=a+1;for(let l=o-1;l>a;l--){const f=r[a];r[a]=r[l],r[l]=f,t(r,c,l,u)}}function*i(r,a,o,u){a===void 0&&(a=0),o===void 0&&(o=r.length),u===void 0&&(u=n);for(let l=o>>>1;l>a;l--)t(r,l,o,u),yield;const c=a+1;for(let l=o-1;l>a;l--){const f=r[a];r[a]=r[l],r[l]=f,t(r,c,l,u),yield}}e.sort=s,e.iterableSort=i})(B||(B={}));const ot=B,fe=1.5,de=1.1;let It=class{constructor(t){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new Rt,t&&(t.initialSize&&(this.data=new Array(t.initialSize)),t.allocator&&(this._allocator=t.allocator),t.deallocator!==void 0&&(this._deallocator=t.deallocator),t.shrink&&(this._shrink=()=>lt(this)))}toArray(){return this.data.slice(0,this.length)}filter(t){const n=new Array;for(let s=0;s<this._length;s++){const i=this.data[s];t(i)&&n.push(i)}return n}at(t){if((t=Math.trunc(t)||0)<0&&(t+=this._length),!(t<0||t>=this._length))return this.data[t]}includes(t,n){const s=this.data.indexOf(t,n);return s!==-1&&s<this.length}get length(){return this._length}set length(t){if(t>this._length){if(this._allocator){for(;this._length<t;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=t}else{if(this._deallocator)for(let n=t;n<this._length;++n)this.data[n]=this._deallocator(this.data[n]);this._length=t,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(t){this.data[this._length++]=t}pushArray(t,n=t.length){for(let s=0;s<n;s++)this.data[this._length++]=t[s]}fill(t,n){for(let s=0;s<n;s++)this.data[this._length++]=t}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const t=this.data[this._length];return++this._length,t}unshift(t){this.data.unshift(t),this._length++,lt(this)}pop(){if(this.length===0)return;const t=this.data[this.length-1];return this.length=this.length-1,this._shrink(),t}remove(t){const n=nt(this.data,st(t),this.length,this._hint);if(n!==-1)return this.data.splice(n,1),this.length=this.length-1,t}removeUnordered(t){return this.removeUnorderedIndex(nt(this.data,st(t),this.length,this._hint))}removeUnorderedIndex(t){if(!(t>=this.length||t<0))return this.swapElements(t,this.length-1),this.pop()}removeUnorderedMany(t,n=t.length,s){this.length=Vt(this.data,t,this.length,n,this._hint,s),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(t,n){if(t>=this.length||n>=this.length||t===n)return;const s=this.data[t];this.data[t]=this.data[n],this.data[n]=s}sort(t){ot.sort(this.data,0,this.length,t)}iterableSort(t){return ot.iterableSort(this.data,0,this.length,t)}some(t,n){for(let s=0;s<this.length;++s)if(t.call(n,this.data[s],s,this.data))return!0;return!1}find(t,n){const{data:s,length:i}=this;for(let r=0;r<i;++r)if(t.call(n,s[r]))return s[r]}filterInPlace(t,n){let s=0;for(let i=0;i<this._length;++i){const r=this.data[i];t.call(n,r,i,this.data)&&(this.data[i]=this.data[s],this.data[s]=r,s++)}if(this._deallocator)for(let i=s;i<this._length;i++)this.data[i]=this._deallocator(this.data[i]);return this._length=s,this._shrink(),this}forAll(t,n){const{data:s,length:i}=this;for(let r=0;r<i;++r)t.call(n,s[r],r,s)}forEach(t,n){this.data.slice(0,this.length).forEach(t,n)}map(t,n){const s=new Array(this.length);for(let i=0;i<this.length;++i)s[i]=t.call(n,this.data[i],i,this.data);return s}reduce(t,n){let s=n;for(let i=0;i<this.length;++i)s=t(s,this.data[i],i,this.data);return s}has(t){const n=this.length,s=this.data;for(let i=0;i<n;++i)if(s[i]===t)return!0;return!1}*[Symbol.iterator](){for(let t=0;t<this.length;t++)yield this.data[t]}};function lt(e){e.data.length>fe*e.length&&(e.data.length=Math.floor(e.length*de))}function bn(e){return e}function kn(e){return 1e3*e}function An(e){return e}function Tn(e){return .001*e}let pe=class{constructor(t){this.phases=t,this.paused=!1,this.ticks=-1,this.removed=!1}},me=class{constructor(t){this.callback=t,this.isActive=!0}remove(){this.isActive=!1}},H=0;const b={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},Q=["prepare","preRender","render","postRender","update","finish"],W=[],_=new It;class ge{constructor(t){this._task=t}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1,Ft()}}function _e(){g!=null&&(cancelAnimationFrame(g),g=requestAnimationFrame(tt))}function Ft(){g==null&&(H=performance.now(),g=requestAnimationFrame(tt))}const O={frameTasks:_,willDispatch:!1,clearFrameTasks:ve,dispatch:Ct,executeFrameTasks:ye,reschedule:_e};function $e(e){const t=new me(e);return W.push(t),O.willDispatch||(O.willDispatch=!0,Dt(Ct)),t}function Sn(e){const t=new pe(e);return _.push(t),Ft(),new ge(t)}let g=null;function ve(e=!1){_.forAll((t=>{t.removed=!0})),e&&Ut()}function tt(){const e=performance.now();g=null,g=_.some((n=>!n.paused&&!n.removed))?requestAnimationFrame(tt):null,O.executeFrameTasks(e)}function ye(e){const t=e-H;H=e;const n=1e3/60,s=Math.max(0,t-n);b.time=e,b.frameDuration=n-s;for(let i=0;i<Q.length;i++){const r=performance.now(),a=Q[i];_.forAll((o=>{o.paused||o.removed||(i===0&&o.ticks++,o.phases[a]&&(b.elapsedFrameTime=performance.now()-e,b.deltaTime=o.ticks===0?0:t,o.phases[a]?.call(o,b)))})),ke[i].push(performance.now()-r)}Ut(),Ae.push(performance.now()-e)}const D=new It;function Ut(){_.forAll((e=>{e.removed&&D.push(e)})),_.removeUnorderedMany(D.data,D.length),D.clear()}function Ct(){for(;W.length;){const e=W.shift();e.isActive&&e.callback()}O.willDispatch=!1}function we(e=1,t){const n=G(),s=()=>{$t(t)?n.reject(w()):e===0?n():(--e,Dt((()=>s())))};return s(),n.promise}function be(e){return we(1,e)}async function Dn(e){await be(e),await new Promise((t=>requestAnimationFrame((()=>{e?.aborted||t()}))))}const ke=Q.map((e=>new jt(e))),Ae=new jt("total");function Te(e,t){for(const n of e.values())if(t(n))return!0;return!1}function ut(e,t){if(!t)return e;for(const n of t)n!=null&&e.add(n);return e}function jn(e,t){return t!=null&&e.add(t),e}function Ee(e,t){const n=new Set;return ut(n,e),ut(n,t),n}function qe(e,t){const n=new Set;for(const s of t)e.has(s)&&n.add(s);return n}function In(e,t){if(!e||!t)return!1;if(e===t)return!0;for(const n of e)if(!t.has(n))return!1;return!0}function Fn(e,t){if(e==null&&t==null)return!0;if(e==null||t==null||e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Se(e,t){const n=new Set(e);for(const s of t)n.delete(s);return n}function Un(e,t){return Se(Ee(e,t),qe(e,t))}let De=0;function Y(){return++De}class et extends Et{constructor(t){super(new je(t)),this._observer&&ct.register(this,new WeakRef(this._observer),this)}destroy(){this._observer&&ct.unregister(this._observer),this.accessed?.clear(),this.clear(),this._observer?.destroy()}}let je=class{constructor(t){this._notify=t,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const t=this._invalidCount;if(t===1)return this._invalidCount=0,void this._notify();this._invalidCount=t>0?t-1:0}destroy(){this.destroyed=!0,this._notify=Ie}};const ct=new FinalizationRegistry((e=>{e.deref()?.destroy()}));function Ie(){}let v=!1;const x=[];function Nt(e,t){let n=new et(r),s=null,i=!1;function r(){if(!n||i)return;if(v)return void xt(r);const o=s;n.clear(),v=!0,i=!0,s=y(n,e),i=!1,v=!1,t(s,o),zt()}function a(){n&&(n.destroy(),n=null,s=null)}return i=!0,s=y(n,e),i=!1,h(a)}function Ot(e,t){let n=new et(i),s=null;function i(){t(s,a)}function r(){n&&(n.destroy(),n=null),s=null}function a(){return n?(n.clear(),s=y(n,e),s):null}return a(),h(r)}function Nn(e,t){let n=!1,s=!1;const i=!!t?.sync;let r=new et((()=>{n||s||(s=!0,i?a():queueMicrotask(a))}));function a(){s=!1,r&&!n&&(v?xt(a):(r.clear(),v=!0,n=!0,y(r,e),n=!1,v=!1,zt()))}function o(){r&&(r.destroy(),r=null)}return n=!0,y(r,e),n=!1,h(o)}function xt(e){x.includes(e)||x.unshift(e)}function zt(){for(;x.length;)x.pop()()}var E;(function(e){e[e.Untracked=0]="Untracked",e[e.Tracked=1]="Tracked"})(E||(E={}));const R=class R{constructor(){this.uid=Y(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(t,n,s,i,r){return this.pool.acquire(E.Untracked,t,n,s,i,r,ht)}static acquireTracked(t,n,s,i){return this.pool.acquire(E.Tracked,t,n,s,null,null,i)}notify(t,n){this.type===E.Untracked?this.callback.call(this.target,t,n,this.path,this.target):this.callback.call(null,t,n,void 0,void 0)}acquire(t,n,s,i,r,a,o){this.uid=Y(),this.removed=!1,this.type=t,this.oldValue=n,this.callback=s,this.getValue=i,this.target=r,this.path=a,this.equals=o}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=Y(),this.removed=!0}};R.pool=new he(R);let q=R;const F=new yt,p=new Set;let z;function P(e){p.delete(e),p.add(e),z||(z=$e(Ue))}function Fe(e){if(e.removed)return;const t=e.oldValue,n=e.getValue();e.equals(t,n)||(e.oldValue=n,e.notify(n,t))}function On(e){for(const t of p.values())t.target===e&&(t.removed=!0)}function Ue(){let e=10;for(;z&&e--;){z=null;const t=Ce(),n=F.acquire();for(const s of t){const i=s.uid;Fe(s),i===s.uid&&s.removed&&n.push(s)}for(const s of p)s.removed&&(n.push(s),p.delete(s));for(const s of n)q.pool.release(s);F.release(n),F.release(t),Z.forEach((s=>s()))}}function Ce(){const e=F.acquire();e.length=p.size;let t=0;for(const n of p)e[t]=n,++t;return p.clear(),e}const Z=new Set;function xn(e){return Z.add(e),h((()=>Z.delete(e)))}function Ne(e,t,n){let s=kt(e,t,n,((i,r,a)=>{let o,u,c=Ot((()=>M(i,r)),((l,f)=>{i.__accessor__?.lifecycle===K.DESTROYED||o&&o.uid!==u?s.remove():(o||(o=q.acquireUntracked(l,a,f,i,r),u=o.uid),P(o))}));return h((()=>{c.remove(),o&&(o.uid!==u||o.removed||(o.removed=!0,P(o)),o=null),s=c=null}))}));return s}function Oe(e,t,n){const s=kt(e,t,n,((i,r,a)=>{let o=!1;return Nt((()=>M(i,r)),((u,c)=>{i.__accessor__.lifecycle!==K.DESTROYED?o||(o=!0,ht(c,u)||a.call(i,u,c,r,i),o=!1):s.remove()}))}));return s}function zn(e,t,n,s=!1){return e.__accessor__&&e.__accessor__.lifecycle!==K.DESTROYED?s?Oe(e,t,n):Ne(e,t,n):h()}function xe(e,t,n){let s,i,r=Ot(e,((a,o)=>{s&&s.uid!==i?r.remove():(s||(s=q.acquireTracked(a,t,o,n),i=s.uid),P(s))}));return h((()=>{r.remove(),s&&(s.uid!==i||s.removed||(s.removed=!0,P(s)),s=null),r=null}))}function ze(e,t,n){let s=!1;return Nt(e,((i,r)=>{s||(s=!0,n(r,i)||t(i,r),s=!1)}))}function Pn(e,t,n=!1,s=Mt){return n?ze(e,t,s):xe(e,t,s)}function Rn(e){return Te(p,(t=>t.oldValue===e))}export{Ee as $,$e as A,gt as B,bn as C,fn as D,Ye as E,Le as F,sn as G,an as H,rn as I,Ze as J,We as K,G as L,yt as M,mn as N,Ke as O,on as P,Je as Q,we as R,ee as S,Dt as T,Ge as U,en as V,kn as W,An as X,jn as Y,jt as Z,rt as _,w as a,Fn as a0,In as a1,Se as a2,qe as a3,Xe as a4,M as a5,gn as a6,pn as a7,Te as a8,ln as a9,be as aa,Be as ab,Et as ac,A as ad,y as ae,ce as af,$n as ag,K as ah,le as ai,On as aj,zn as ak,Ve as al,Dn as am,et as an,ut as ao,Sn as ap,he as aq,xn as ar,Rn as as,un as at,Un as au,Qt as av,Tn as aw,dt as ax,Me as ay,J as b,$t as c,tn as d,h as e,Y as f,wt as g,oe as h,Nn as i,vt as j,cn as k,Kt as l,U as m,pt as n,Zt as o,te as p,He as q,nn as r,_t as s,Gt as t,Qe as u,V as v,Pn as w,hn as x,Xt as y,It as z};
