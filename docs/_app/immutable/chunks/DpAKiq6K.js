const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BPD7IP9o.js","./CVQPxYbx.js","./BW0zoJTm.js","./CEBETtrS.js","./CaNW5Bx0.js","./DwerzRSF.js","./y1GB1Svy.js","./PPVm8Dsz.js","./BUsxo-Ec.js","./D0nkGZIM.js","./AlyPEkJM.js","./fk_randw.js","./CUR0of9e.js","./BTNr9f9k.js","./D7IjRheC.js","./EmFT8XhJ.js","./BSxrG6gF.js","./f-FxpFa8.js","./BVFIxAn9.js","./DS2ZxNQA.js","./PJHcqbvL.js","./bnayRBMH.js","./BYduSOTS.js","./BqUxlKJa.js","./BeVvvKpn.js","./DCBLidga.js","./C3_gy5al.js","./B934cuUn.js","./C1gSvD9v.js","./BrtHPiJb.js","./XEmGDYB_.js","./ClciE7fF.js","./C0wm8_Yw.js","./CglP3OMz.js","./CRQkeITi.js","./Djp3mnm5.js","./DjNaDsmS.js","./jYVHtrPb.js","./Cio74hNV.js","./Oe6SV2kF.js","./BB8FxsSd.js","./CX7Ly1s1.js","./hrtaopRk.js","./gS8sOOux.js","./DxKdWlFG.js","./Cpt7A2bI.js","./C2FvnhIN.js","./B0DG5wVw.js","./f__iu-I6.js","./DhMSIuCj.js","./Bde99gqs.js","./TW8D_o5j.js","./C7fxqwFZ.js","./B0gOzRRh.js","./CumW50Sh.js","./Ci6C1k20.js","./CSXZNpHb.js","./xXH_AyYh.js","./CTnd5cvu.js","./PWd9QCpP.js","./BwN_j92a.js","./CfBiQUdY.js","./CVwTD0fV.js","./9eAP65Ji.js","./mOc398RU.js","./DPJXGPFY.js","./DFYTeVXP.js","./B8cN3yAo.js","./BIj_QgNJ.js","./q_b6UJoq.js","./CYI1luaL.js","./DTEZVyiP.js","./BCTmL8G8.js","./CHAiFIco.js","./Dj-cqQsY.js","./B128_oTY.js","./6Jo1niE7.js","./DjNuiUVf.js","./CpqG7TFG.js","./D_dxbuU-.js","./jQbrml54.js","./uHWM1awI.js","./CYEJx0Wq.js","./BteoTDFn.js","./B7Ex7sMf.js","./DocBEfKB.js","./B2jVc7id.js","./Da4sQo3R.js","./CAGdFHZB.js","./DzvuCIKa.js","./Bu0Dv00G.js","./Bo5l4fk8.js","./48RKFPo7.js","./TEMnSu_8.js","./Ch4klalT.js","./CQmZIYPi.js","./DsEHuRPb.js","./BARRAGjD.js","./0N6-HNAU.js","./DwIB5gq4.js","./BjGHVp5Q.js","./lEIzcqu9.js","./CtIxBnU3.js","./gJDQstGQ.js","./Cl8hT7Dy.js","./hngUoOdp.js","./BlT3hoGo.js","./DZpEp5b3.js","./GKolV7NZ.js","./PiqJyY-Z.js","./CWQ4Sji6.js","./Cc8znHts.js","./C9Yzh9th.js","./CMFr2xVw.js","./B8kDL1f4.js","./Bo-exx2O.js","./BFHafdW6.js","./D5cGnOsZ.js","./CCtOv0E5.js","./DhzudQro.js","./Qzt__3Yd.js","./mx71iuXv.js","./E5yhiq2t.js","./B2om5830.js","./CrUuvTSr.js","./DNQVkPqp.js","./WCLBMBm-.js","./BveQ3Yw2.js","./BABeDC_w.js","./EGFv0f86.js","./BDRaqLVR.js","./BlaSF0Se.js","./mBdPBegd.js","./Cu3emot3.js","./qyF9FwQ9.js","./XI-Li77m.js","./DS8kW6UP.js","./1BM1gK8E.js","./DPb6J-GU.js","./MtSiOt06.js","./BxTLSXBH.js","./BGyY2giR.js","./D28RTRrm.js","./C65Zrur8.js","./DwnB9djr.js","./CUTkbj50.js","./CAO_3SU9.js","./DE7psHTV.js","./Fla_WrMr.js","./CVRs03iK.js","./g8mGjH5g.js","./D1UBzOg5.js","./DvKU1K2H.js","./C8HgMPMV.js","./CzWdKr8p.js","./DA3FuPmn.js","./DGbyUckK.js","./CvWhF_20.js","./C7f3YWDt.js","./C9pSZhGI.js","./W3jjMA9o.js","./C83SMLgt.js","./CedduHNK.js"])))=>i.map(i=>d[i]);
import{_ as r,m as o,a as u,n as c,o as Fe,x as ge,aR as tr,b as E,r as _,F as Er,e as rr,L as Ar,u as Lr,aS as xr,i as ir,K as or,d as Or,C as Rr,p as Ur}from"./BW0zoJTm.js";import{_ as T}from"./PPVm8Dsz.js";import{ad as Vr,aa as Pr,f as Ye,aC as Fr,H as fe,p as zt,z as Cr}from"./BUsxo-Ec.js";import{L as Mr}from"./BEZFO2vt.js";import{m as be,a as Ft,s as Ze,n as sr}from"./D9kT-sgB.js";import{a as Z,e as gt,N as nr,J as Br}from"./CEBETtrS.js";import{O as wt,s as Dr}from"./CVQPxYbx.js";import{s as R,i as H}from"./CaNW5Bx0.js";import{M as Gr,d as qr,a as Jr,b as ar}from"./y1GB1Svy.js";import{l as lr}from"./Cn9cIaVC.js";import{l as ur,m as zr}from"./XEmGDYB_.js";import{e as Wr,j as Hr,l as pr,h as Zr}from"./DwerzRSF.js";import{m as Kr,d as dr,S as Yr,o as Qr,I as Xr}from"./D0nkGZIM.js";import Ke from"./EmFT8XhJ.js";import{E as ei}from"./BVFIxAn9.js";import{m as z,h as cr,e as ti}from"./BTNr9f9k.js";import{e as ri,c as yr}from"./CAO_3SU9.js";import{e as ii}from"./CglP3OMz.js";import{p as oi,n as si}from"./DCBLidga.js";import{y as ni}from"./BAWfW4Tu.js";import{r as W}from"./B0gOzRRh.js";import{i as mr}from"./PWd9QCpP.js";import{l as $}from"./TW8D_o5j.js";import{_ as hr}from"./BwN_j92a.js";import St from"./DhMSIuCj.js";import{e as ai}from"./DwIB5gq4.js";import{f as wr}from"./C3_gy5al.js";import{g as Wt,c as ft,l as li,h as ui,t as Ht,i as Zt,a as Kt}from"./CAGdFHZB.js";import{b as pi}from"./48RKFPo7.js";import"./CpqG7TFG.js";import{m as gr,O as di,l as bt,r as Yt}from"./C7fxqwFZ.js";import{c as Qe,s as ve,e as Xe,o as vt,i as le,t as It,b as ci,a as yi,r as mi}from"./C2FvnhIN.js";import{t as hi}from"./CaYZrGFV.js";import{y as Ct,m as wi,P as gi}from"./BYduSOTS.js";import{s as fr}from"./B0DG5wVw.js";import{l as fi}from"./CfBiQUdY.js";let oe=class extends c{constructor(e){super(e),this.facilityIdField=null,this.layerId=null,this.nameField=null,this.siteIdField=null,this.sublayerId=null}};r([o({type:String,json:{write:{isRequired:!0}}})],oe.prototype,"facilityIdField",void 0),r([o({type:String,json:{write:{isRequired:!0}}})],oe.prototype,"layerId",void 0),r([o({type:String,json:{write:{isRequired:!0}}})],oe.prototype,"nameField",void 0),r([o({type:String,json:{write:!0}})],oe.prototype,"siteIdField",void 0),r([o({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],oe.prototype,"sublayerId",void 0),oe=r([u("esri.layers.support.FacilityLayerInfo")],oe);const bi=oe;let F=class extends c{constructor(e){super(e),this.facilityIdField=null,this.layerId=null,this.levelIdField=null,this.levelNumberField=null,this.longNameField=null,this.shortNameField=null,this.sublayerId=null,this.verticalOrderField=null}};r([o({type:String,json:{write:{isRequired:!0}}})],F.prototype,"facilityIdField",void 0),r([o({type:String,json:{write:{isRequired:!0}}})],F.prototype,"layerId",void 0),r([o({type:String,json:{write:{isRequired:!0}}})],F.prototype,"levelIdField",void 0),r([o({type:String,json:{write:{isRequired:!0}}})],F.prototype,"levelNumberField",void 0),r([o({type:String,json:{write:{isRequired:!0}}})],F.prototype,"longNameField",void 0),r([o({type:String,json:{write:{isRequired:!0}}})],F.prototype,"shortNameField",void 0),r([o({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],F.prototype,"sublayerId",void 0),r([o({type:String,json:{write:{isRequired:!0}}})],F.prototype,"verticalOrderField",void 0),F=r([u("esri.layers.support.LevelLayerInfo")],F);const vi=F;let de=class extends c{constructor(e){super(e),this.layerId=null,this.nameField=null,this.siteIdField=null,this.sublayerId=null}};r([o({type:String,json:{write:{isRequired:!0}}})],de.prototype,"layerId",void 0),r([o({type:String,json:{write:{isRequired:!0}}})],de.prototype,"nameField",void 0),r([o({type:String,json:{write:{isRequired:!0}}})],de.prototype,"siteIdField",void 0),r([o({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],de.prototype,"sublayerId",void 0),de=r([u("esri.layers.support.SiteLayerInfo")],de);const Ii=de;let Se=class extends c{constructor(e){super(e),this.levelLayer=null,this.facilityLayer=null,this.siteLayer=null}};r([o({type:vi,json:{write:{isRequired:!0}}})],Se.prototype,"levelLayer",void 0),r([o({type:bi,json:{write:{isRequired:!0}}})],Se.prototype,"facilityLayer",void 0),r([o({type:Ii,json:{write:!0}})],Se.prototype,"siteLayer",void 0),Se=r([u("esri.support.MapFloorInfo")],Se);const Si=Se;var Tt;let Te=Tt=class extends c{constructor(t){super(t),this.activeRange=null,this.currentRangeExtent=null,this.fullRangeExtent=null}clone(){return new Tt(Z({activeRange:this.activeRange,currentRangeExtent:this.currentRangeExtent,fullRangeExtent:this.fullRangeExtent}))}};r([o({type:String,nonNullable:!0,json:{read:{source:"activeRangeName"},write:{target:"activeRangeName",isRequired:!0}}})],Te.prototype,"activeRange",void 0),r([o({type:[Number],json:{write:!0}})],Te.prototype,"currentRangeExtent",void 0),r([o({type:[Number],json:{write:!0}})],Te.prototype,"fullRangeExtent",void 0),Te=Tt=r([u("esri.webdoc.RangeInfo")],Te);const Mt=Te;var jt;let D=jt=class extends c{constructor(t){super(t),this.enabled=!1,this.longNames=!1,this.minimized=!1,this.pinnedLevels=!1,this.site=null,this.facility=null,this.level=null}clone(){return new jt(Z({enabled:this.enabled,longNames:this.longNames,minimized:this.minimized,pinnedLevels:this.pinnedLevels,site:this.site,facility:this.facility,level:this.level}))}};r([o({type:Boolean,json:{read:{source:"enabled"},write:{target:"enabled"}}})],D.prototype,"enabled",void 0),r([o({type:Boolean,json:{read:{source:"longNames"},write:{target:"longNames"}}})],D.prototype,"longNames",void 0),r([o({type:Boolean,json:{read:{source:"minimized"},write:{target:"minimized"}}})],D.prototype,"minimized",void 0),r([o({type:Boolean,json:{read:{source:"pinnedLevels"},write:{target:"pinnedLevels"}}})],D.prototype,"pinnedLevels",void 0),r([o({type:String,json:{read:{source:"site"},write:{target:"site"}}})],D.prototype,"site",void 0),r([o({type:String,json:{read:{source:"facility"},write:{target:"facility"}}})],D.prototype,"facility",void 0),r([o({type:String,json:{read:{source:"level"},write:{target:"level"}}})],D.prototype,"level",void 0),D=jt=r([u("esri.webdoc.widgets.FloorFilter")],D);const Ti=D;var Nt;const et=new Fe({slider:"slider",picker:"picker"});let je=Nt=class extends c{constructor(t){super(t),this.interactionMode=null,this.numStops=null,this.stopInterval=null}clone(){return new Nt({interactionMode:this.interactionMode,numStops:this.numStops,stopInterval:this.stopInterval})}};r([o({type:et.apiValues,nonNullable:!0,json:{type:et.jsonValues,default:null,read:{reader:et.read},write:{isRequired:!0,writer:et.write}}})],je.prototype,"interactionMode",void 0),r([o({type:ge,json:{read:{source:"numberOfStops"},write:{target:"numberOfStops",overridePolicy(){const t=this.stopInterval!=null;return{enabled:!t,isRequired:!t}}}}})],je.prototype,"numStops",void 0),r([o({type:Number,json:{write:{overridePolicy(){return{isRequired:this.numStops==null}}}}})],je.prototype,"stopInterval",void 0),je=Nt=r([u("esri.webdoc.widgets.Range")],je);const ji=je;var _t;let j=_t=class extends c{constructor(t){super(t),this.currentTimeExtent=null,this.fullTimeExtent=null,this.loop=!1,this.numStops=null,this.numThumbs=null,this.stopDelay=null,this.stopInterval=null,this.stops=null}readCurrentTimeExtent(t){return t?z.fromArray(t):void 0}writeCurrentTimeExtent(t,e,i){t&&gt(i,t.toArray(),e)}readFullTimeExtent(t,e){const i=e.properties;if(!i)return;const s=i.endTime!=null?new Date(i.endTime):null,n=i.startTime!=null?new Date(i.startTime):null;return new z({start:n,end:s})}writeFullTimeExtent(t,e){if(!t)return;const i=e.properties=e.properties||{},s=t.end,n=t.start;s&&(i.endTime=s!=null?s.getTime():null),n&&(i.startTime=n!=null?n.getTime():null)}readStopInterval(t,e,i){return t?yr.fromJSON({value:t.interval,unit:t.units},i):null}writeStopInterval(t,e,i,s){if(!t)return;const n=t.toJSON(s);gt("properties.timeStopInterval",{interval:n.value,units:n.unit},e)}readStops(t){return t?.length?t.map(e=>new Date(e)):null}writeStops(t,e,i){t?.length&&gt(i,t.map(s=>s.getTime()),e)}clone(){return new _t(Z({currentTimeExtent:this.currentTimeExtent,fullTimeExtent:this.fullTimeExtent,loop:this.loop,numStops:this.numStops,numThumbs:this.numThumbs,stopDelay:this.stopDelay,stopInterval:this.stopInterval,stops:this.stops}))}};r([o({type:z,json:{type:[[ge,tr]],read:{source:"properties.currentTimeExtent"},write:{target:"properties.currentTimeExtent"}}})],j.prototype,"currentTimeExtent",void 0),r([E("currentTimeExtent")],j.prototype,"readCurrentTimeExtent",null),r([_("currentTimeExtent")],j.prototype,"writeCurrentTimeExtent",null),r([o({type:z,json:{read:{source:["properties.endTime","properties.startTime"]},write:{target:{"properties.endTime":{type:Number},"properties.startTime":{type:Number}}}}})],j.prototype,"fullTimeExtent",void 0),r([E("fullTimeExtent")],j.prototype,"readFullTimeExtent",null),r([_("fullTimeExtent")],j.prototype,"writeFullTimeExtent",null),r([o({type:Boolean,nonNullable:!0,json:{default:!1,read:{source:"properties.loop"},write:{target:"properties.loop"}}})],j.prototype,"loop",void 0),r([o({type:ge,json:{read:{source:"properties.numberOfStops"},write:{target:"properties.numberOfStops",overridePolicy(){const t=!!this.stopInterval,e=!!this.stops?.length,i=!(t||e);return{enabled:i,isRequired:i}}}}})],j.prototype,"numStops",void 0),r([o({type:[1,2],nonNullable:!0,json:{type:ge,read:{source:"properties.thumbCount"},write:{target:"properties.thumbCount",isRequired:!0}}})],j.prototype,"numThumbs",void 0),r([o({type:Number,nonNullable:!0,json:{read:{source:"properties.thumbMovingRate"},write:{target:"properties.thumbMovingRate",isRequired:!0}}})],j.prototype,"stopDelay",void 0),r([o({type:yr,json:{read:{source:"properties.timeStopInterval"},write:{target:{"properties.timeStopInterval.interval":{type:Number},"properties.timeStopInterval.units":{type:ri.jsonValues.filter(t=>t!=="esriTimeUnitsUnknown")}},overridePolicy(){const t=this.numStops!=null,e=!!this.stops?.length;return{enabled:!e,isRequired:!(t||e)}}}}})],j.prototype,"stopInterval",void 0),r([E("stopInterval")],j.prototype,"readStopInterval",null),r([_("stopInterval")],j.prototype,"writeStopInterval",null),r([o({type:[Date],json:{type:[ge],read:{source:"properties.stops"},write:{target:"properties.stops",overridePolicy(){return{isRequired:this.numStops==null&&!this.stopInterval}}}}})],j.prototype,"stops",void 0),r([E("stops")],j.prototype,"readStops",null),r([_("stops")],j.prototype,"writeStops",null),j=_t=r([u("esri.webdoc.widgets.TimeSlider")],j);const Ni=j;var kt;let Ne=kt=class extends c{constructor(t){super(t),this.range=null,this.timeSlider=null,this.floorFilter=null}clone(){return new kt(Z({range:this.range,timeSlider:this.timeSlider,floorFilter:this.floorFilter}))}};r([o({type:ji,json:{write:!0}})],Ne.prototype,"range",void 0),r([o({type:Ni,json:{write:!0}})],Ne.prototype,"timeSlider",void 0),r([o({type:Ti,json:{write:!0}})],Ne.prototype,"floorFilter",void 0),Ne=kt=r([u("esri.webdoc.Widgets")],Ne);const _i=Ne,ki={width:600,height:400},tt=1.5;function $i(t,e){e=e||ki;let{width:i,height:s}=e;const n=i/s;return n<tt?s=i/tt:n>tt&&(i=s*tt),i>t.width&&(s*=t.width/i,i=t.width),s>t.height&&(i*=t.height/s,s=t.height),{width:Math.round(i),height:Math.round(s)}}function Ei(t,e){return e.resourceInfo?br(e,e.resourceInfo,{origin:t.origin}):e.portalItem?.id?Ai(t,e,e.portalItem):Promise.resolve()}function br(t,e,i){const s={context:{...i,layerContainerType:"operational-layers"}};return t.portalItem&&(s.context.portal=t.portalItem.portal||Gr.getDefault()),T(async()=>{const{populateOperationalLayers:n}=await import("./BPD7IP9o.js");return{populateOperationalLayers:n}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]),import.meta.url).then(({populateOperationalLayers:n})=>{const a=[],l=e.operationalLayers;l?.length&&a.push(n(t.layers,l,s));const d={...s,context:{...s.context,layerContainerType:"tables"},defaultLayerType:"ArcGISFeatureLayer"},p=e.tables;return p?.length&&a.push(n(t.tables,p,d)),Promise.allSettled(a).then(()=>{})})}async function Ai(t,e,i){if(await i.load().catch(l=>{throw new R(`${t.name}:load-portal-item`,"Failed to load portal item",{error:l})}),i.type!==t.itemType)throw new R(`${t.name}:invalid-portal-item`,`Invalid portal item type '${i.type}', expected '${t.itemType}'`,{type:i.type});const s=await i.fetchData();e.resourceInfo=s;const n=ii(i,t.origin);await Li(t,e,s,n),e.resourceReferences={portalItem:i,paths:n.readResourcePaths};const a=await Oi(e.initialViewProperties,i,H.getLogger(e));if(a){const l=e.initialViewProperties?.clone()??t.createInitialViewProperties();l.viewpoint=a,e.initialViewProperties=l}}function Li(t,e,i,s){const n=xi(t,i);return e.read(n,s),br(e,n,s)}function xi(t,e){const i=t.parseVersion(e.version||"",t.name);return t.currentVersion.validate(i),e.version=`${i.major}.${i.minor}`,e}async function Oi(t,e,i){if(t?.viewpoint?.targetGeometry)return null;const n=await Ri(t,e,i);return n?new be({targetGeometry:n}):null}async function Ri(t,e,i){const s=t?.spatialReference,n=e?.extent;if(!s||!n)return null;if(s.isWGS84)return n.clone();if(s.isWebMercator)return Vr(n);const{getGeometryServiceURL:a}=await T(()=>import("./BeVvvKpn.js"),__vite__mapDeps([24,3,4,6,7,2,8,9,25,26,22,20,21,27,28]),import.meta.url);try{const l=await a(e),d=new oi({geometries:[n],outSpatialReference:s});return(await si(l,d))[0]}catch(l){i.error("Error projecting item's extent:",l)}return null}function Qt(t){return{enabled:!!t?.length}}var $t;let _e=$t=class extends c{constructor(t){super(t),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new $t({exactMatch:this.exactMatch,type:this.type,name:this.name})}};r([o({type:Boolean,json:{write:!0}})],_e.prototype,"exactMatch",void 0),r([o({type:String,json:{write:!0}})],_e.prototype,"name",void 0),r([W(mr)],_e.prototype,"type",void 0),_e=$t=r([u("esri.webdoc.applicationProperties.SearchLayerField")],_e);const Ui=_e;var Et;let ke=Et=class extends c{constructor(t){super(t),this.field=null,this.id=null,this.subLayer=null}clone(){return new Et(Z({field:this.field,id:this.id,subLayer:this.subLayer}))}};r([o({type:Ui,json:{write:{isRequired:!0}}})],ke.prototype,"field",void 0),r([o({type:String,json:{write:{isRequired:!0}}})],ke.prototype,"id",void 0),r([o({type:ge,json:{write:!0}})],ke.prototype,"subLayer",void 0),ke=Et=r([u("esri.webdoc.applicationProperties.SearchLayer")],ke);const Vi=ke;var At;let $e=At=class extends c{constructor(t){super(t),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new At({exactMatch:this.exactMatch,type:this.type,name:this.name})}};r([o({type:Boolean,json:{write:!0}})],$e.prototype,"exactMatch",void 0),r([o({type:String,json:{write:!0}})],$e.prototype,"name",void 0),r([W(mr)],$e.prototype,"type",void 0),$e=At=r([u("esri.webdoc.applicationProperties.SearchTableField")],$e);const Pi=$e;var Lt;let Ge=Lt=class extends c{constructor(t){super(t),this.field=null,this.id=null}clone(){return new Lt(Z({field:this.field,id:this.id}))}};r([o({type:Pi,json:{write:{isRequired:!0}}})],Ge.prototype,"field",void 0),r([o({type:String,json:{write:{isRequired:!0}}})],Ge.prototype,"id",void 0),Ge=Lt=r([u("esri.webdoc.applicationProperties.SearchTable")],Ge);const Fi=Ge;var xt;const vr=wt.ofType(Vi),Ir=wt.ofType(Fi);let G=xt=class extends c{constructor(t){super(t),this.addressSearchEnabled=!0,this.enabled=!0,this.hintText=null,this.layers=new vr,this.tables=new Ir}readAddressSearchEnabled(t){return!t}writeAddressSearchEnabled(t,e,i){e[i]=!t}clone(){return new xt(Z({addressSearchEnabled:this.addressSearchEnabled,enabled:this.enabled,hintText:this.hintText,layers:this.layers,tables:this.tables}))}};r([o({type:Boolean,nonNullable:!0,json:{read:{source:"disablePlaceFinder"},write:{target:"disablePlaceFinder",isRequired:!0},origins:{"web-scene":{read:!1,write:!1}}}})],G.prototype,"addressSearchEnabled",void 0),r([E("addressSearchEnabled")],G.prototype,"readAddressSearchEnabled",null),r([_("addressSearchEnabled")],G.prototype,"writeAddressSearchEnabled",null),r([o({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-map":{write:{isRequired:!0}},"web-scene":{default:!0,write:!0}}}})],G.prototype,"enabled",void 0),r([o({type:String,json:{write:!0}})],G.prototype,"hintText",void 0),r([o({type:vr,json:{write:{overridePolicy:Qt},origins:{"web-scene":{write:{isRequired:!0}}}}})],G.prototype,"layers",void 0),r([o({type:Ir,json:{read:!0,write:{overridePolicy:Qt}}})],G.prototype,"tables",void 0),G=xt=r([u("esri.webdoc.applicationProperties.Search")],G);const Ci=G;var Ot;let at=Ot=class extends c{constructor(t){super(t),this.search=null}clone(){return new Ot(Z({search:this.search}))}};r([o({type:Ci,json:{write:!0}})],at.prototype,"search",void 0),at=Ot=r([u("esri.webdoc.applicationProperties.Viewing")],at);const Mi=at;var Rt;let Ee=Rt=class extends c{constructor(t){super(t),this.editing=null,this.offline=null,this.viewing=null}clone(){return new Rt(Z({editing:this.editing,offline:this.offline,viewing:this.viewing}))}};r([o({json:{write:!0}})],Ee.prototype,"editing",void 0),r([o({json:{write:!0}})],Ee.prototype,"offline",void 0),r([o({type:Mi,json:{write:!0}})],Ee.prototype,"viewing",void 0),Ee=Rt=r([u("esri.webmap.ApplicationProperties")],Ee);const Bi=Ee;var Ut;let re=Ut=class extends c{constructor(){super(...arguments),this.url=""}destroy(){this.url=""}get isSecureUrl(){return Kr(this.url)}get isDataURI(){return dr(this.url)}clone(){return new Ut({url:this.url})}};r([o({type:String,json:{write:{isRequired:!0}}})],re.prototype,"url",void 0),r([o()],re.prototype,"isSecureUrl",null),r([o()],re.prototype,"isDataURI",null),re=Ut=r([u("esri.webdoc.support.SlideThumbnail")],re);const Di={type:z,json:{read:{source:"timeExtent",reader:t=>t?Array.isArray(t)?z.fromArray(t):z.fromJSON(t):null},write:{writer:(t,e,i,s)=>{t&&(t.isEmpty?s?.messages&&s.messages.push(new R("invalid-timeExtent","TimeExtent cannot be empty")):e[i]=t.toArray())},target:{timeExtent:{type:[[ge,tr]]}}}}};var Vt;let q=Vt=class extends Dr(c){constructor(t){super(t),this.name=null,this.thumbnail=new re,this.timeExtent=null}castThumbnail(t){return typeof t=="string"?new re({url:t}):Er(re,t)}set viewpoint(t){const{targetGeometry:e,scale:i}=t;e!=null&&e.type==="point"&&i==null&&H.getLogger(this).warn("Bookmark.viewpoint should include 'scale' when its targetGeometry is a point.",t),this._set("viewpoint",t)}readViewpoint(t,e){const{extent:i,viewpoint:s}=e;return be.fromJSON(s||{targetGeometry:i})}writeViewpoint(t,e,i,s){if(!t)return;const{targetGeometry:n}=t;if(n!=null&&n.type!=="extent"){const a="Bookmark.viewpoint cannot be written to JSON when the viewpoint's targetGeometry is not an extent.";return void(s?.messages?s.messages.push(new R("property:unsupported",a)):H.getLogger(this).error(a))}n!=null&&(e.extent=n.toJSON()),e[i]=t.toJSON()}clone(){return new Vt(Z({name:this.name,thumbnail:this.thumbnail,timeExtent:this.timeExtent,viewpoint:this.viewpoint}))}};r([o({type:String,nonNullable:!0,json:{write:{isRequired:!0}}})],q.prototype,"name",void 0),r([o({type:re,json:{write:{overridePolicy:t=>({enabled:!(!t||!t.url)})}}})],q.prototype,"thumbnail",void 0),r([Pr("thumbnail")],q.prototype,"castThumbnail",null),r([o(Di)],q.prototype,"timeExtent",void 0),r([o({type:be,nonNullable:!0,json:{write:!0}})],q.prototype,"viewpoint",null),r([E("viewpoint",["extent","viewpoint"])],q.prototype,"readViewpoint",null),r([_("viewpoint")],q.prototype,"writeViewpoint",null),q=Vt=r([u("esri.webmap.Bookmark")],q);const Gi=q;let K=class extends $(rr){constructor(e){super(e),this.background=null,this.rangeInfo=null,this.spatialReference=null,this.timeExtent=null,this.timeZone=Wr,this.viewpoint=null}};r([o({type:Ft})],K.prototype,"background",void 0),r([o({type:Mt})],K.prototype,"rangeInfo",void 0),r([o({type:Ye})],K.prototype,"spatialReference",void 0),r([o({type:z})],K.prototype,"timeExtent",void 0),r([o({nonNullable:!0})],K.prototype,"timeZone",void 0),r([o({type:be})],K.prototype,"viewpoint",void 0),K=r([u("esri.webmap.InitialViewProperties")],K);const yt=K,Sr=wt.ofType(Gi),qi=new Map([["image/jpeg","jpeg"],["image/jpg","jpg"],["image/png","png"],["image/gif","gif"]]),Ji="ArcGIS Pro",zi=ei.JSAPI;let w=class extends ur(qr(Jr(Mr))){constructor(t){super(t),this._isAuthoringAppSetByUser=!1,this._isAuthoringAppVersionSetByUser=!1,this._thumbnailFilename=null,this._updateFromPromise=null,this.resourceReferences={portalItem:null,paths:[]},this.applicationProperties=null,this.bookmarks=new Sr,this.floorInfo=null,this.initialViewProperties=new yt,this.portalItem=null,this.sourceVersion=null,this.widgets=null,this._debouncedSaveOperations=Ar(async(e,i,s)=>{const{save:n,saveAs:a}=await T(()=>import("./BrtHPiJb.js"),__vite__mapDeps([29,7,4,3,30,2,5,6,8,9,31,32,13,1,10,15,33,18,19,20,21,22,25,26,27,28,34,35,36,37,38,39,40,41]),import.meta.url);switch(e){case 0:return n(this.context,this,i);case 1:return a(this.context,this,s,i)}}),this.authoringApp=this.authoringAppVersion=null,this._isAuthoringAppSetByUser=this._isAuthoringAppVersionSetByUser=!1}destroy(){this.portalItem=Lr(this.portalItem)}initialize(){if(this.when().catch(t=>{H.getLogger(this).error("#load()","Failed to load web map",t)}),this.resourceInfo){let t;try{t=this._validateJSON(this.resourceInfo)}catch(e){return void this.addResolvingPromise(Promise.reject(e))}this.read(t)}}set authoringApp(t){this._isAuthoringAppSetByUser=!0,this._set("authoringApp",t)}writeAuthoringApp(t,e){t&&this._isAuthoringAppSetByUser?e.authoringApp=t:e.authoringApp=zi}set authoringAppVersion(t){this._isAuthoringAppVersionSetByUser=!0,this._set("authoringAppVersion",t)}writeAuthoringAppVersion(t,e){t&&this._isAuthoringAppVersionSetByUser?e.authoringAppVersion=t:e.authoringAppVersion=Fr}readInitialViewProperties(t,e){const i=new yt;e.background&&(i.background=Ft.fromJSON(e.background));const s=e.initialState?.timeExtent;s&&(i.timeExtent=z.fromArray(s));const n=e.initialState?.viewpoint;return n&&(n.rotation&&Ze.parse(e.version||"","webmap").lessThan(2,20)&&e.authoringApp===Ji&&(n.rotation*=-1),i.viewpoint=be.fromJSON(n)),e.mapRangeInfo&&(i.rangeInfo=Mt.fromJSON(e.mapRangeInfo)),e.spatialReference&&(i.spatialReference=Ye.fromJSON(e.spatialReference)),e.timeZone&&(i.timeZone=e.timeZone),i}writeInitialViewProperties(t,e,i,s){if(!t)return;t.background?.color&&(e.background=t.background.write({},s));const{timeExtent:n,viewpoint:a}=t;if(a||n){const l={};a&&(l.viewpoint=a.write({},s)),n&&(l.timeExtent=n.toArray()),e.initialState=l}t.rangeInfo&&(e.mapRangeInfo=t.rangeInfo.toJSON(s)),t.spatialReference&&(e.spatialReference=t.spatialReference.write({},s)),e.timeZone=t.timeZone}writeLayers(t,e,i,s){e[i]=this._writeLayers(t,s,"operational-layers")}get loaded(){return super.loaded}readSourceVersion(t,e){const[i,s]=e.version.split(".");return new Ze(parseInt(i,10),parseInt(s,10))}writeSourceVersion(t,e,i){e[i]=`${this.context.currentVersion.major}.${this.context.currentVersion.minor}`}writeTables(t,e,i,s){const n=this._writeLayers(t,s,"tables");n.length&&(e[i]=n)}get thumbnailUrl(){return this.portalItem?.thumbnailUrl||null}set thumbnailUrl(t){t?(this._override("thumbnailUrl",t),this._thumbnailFilename=this._generateCustomThumbnailFilename(t)):this._clearThumbnailOverride()}get updatingFromView(){return!!this._updateFromPromise}load(t){return this.addResolvingPromise(Ei(this.context,this)),Promise.resolve(this)}loadAll(){return lr(this,t=>{t(this.ground,this.basemap,this.layers,this.tables)})}read(t,e){e={...e,origin:this.context.origin};const i=this._getAuthoringPropsState();xr(this,t,s=>super.read(t,s),e),this._restoreAuthoringPropsFromState(i)}write(t,e){if(this.loadStatus!=="loaded"){const i=new R("webmap:not-loaded","Web map must be loaded before it can be serialized");throw H.getLogger(this).error("#toJSON()","Web map must be loaded before it can be serialized",this.loadError||this.loadStatus),i}return this._removeDanglingLayerRefs(),e={...e,origin:this.context.origin,restrictedWebMapWriting:!0,webmap:this},super.write(t,e)}async save(t){return this._debouncedSaveOperations(0,t)}async saveAs(t,e){return this._debouncedSaveOperations(1,e,t)}async updateFrom(t,e){const i=this._updateFromInternal(t,e);this._updateFromPromise=i,await i,i===this._updateFromPromise&&(this._updateFromPromise=null)}getLayerJSONFromResourceInfo(t){const e=this.resourceInfo;return this._collectAllLayersJSON([...e?.baseMap?.baseMapLayers||[],...e?.operationalLayers||[],...this.basemap?.resourceInfo?.data?.baseMapLayers||[]]).find(i=>i.id===t.id)}async updateItemThumbnail(){this.thumbnailUrl&&this._isOverridden("thumbnailUrl")&&(await this.portalItem?.updateThumbnail({thumbnail:this.thumbnailUrl,filename:this._thumbnailFilename}),this._clearThumbnailOverride())}getThumbnailState(){let t=this.thumbnailUrl;return t&&(t=this._isOverridden("thumbnailUrl")?t:Yr(t,"w","8192")),{thumbnailUrl:t,filename:this._thumbnailFilename}}restoreThumbnailFromState(t){this.thumbnailUrl=t.thumbnailUrl,this._thumbnailFilename=t.filename}_collectAllLayersJSON(t){return t.reduce((e,i)=>(e.push(i),i.layerType==="GroupLayer"&&(e=e.concat(this._collectAllLayersJSON(i.layers||[]))),e),[])}_writeLayers(t,e,i){return e={...e,layerContainerType:i},t.map(s=>ni(s,i==="tables"?null:this.getLayerJSONFromResourceInfo(s),e)).filter(nr).toArray()}_validateJSON(t){const e=Ze.parse(t.version||"","webmap");return this.context.currentVersion.validate(e),t.version=`${e.major}.${e.minor}`,t}_removeDanglingLayerRefs(){const t=this.applicationProperties,e=t?.viewing?.search,i=a=>this.allLayers.some(l=>l.id===a);if(e?.layers&&(e.layers=e.layers.filter(a=>i(a.id))),e?.tables&&(e.tables=e.tables.filter(a=>this.tables.some(l=>l.id===a.id))),t){const a=t.editing?.locationTracking;a?.info&&!i(a.info.layerId)&&(t.editing=null)}const s="presentation"in this?this.presentation:null,n=s?.slides;n&&n.forEach(a=>{a.visibleLayers&&(a.visibleLayers=a.visibleLayers.filter(l=>i(l.id)))})}async _updateFromInternal(t,e){if(e??={},await Hr(()=>t.ready),this._updateInitialViewProperties(t,e),t.map===this)for(const i of t.allLayerViews)"visible"in i&&"visible"in i.layer&&i._isOverridden("visible")&&(i.layer.visible=i.visible),"featureEffect"in i&&"featureEffect"in i.layer&&i._isOverridden("featureEffect")&&(i.layer.featureEffect=i.featureEffect);await this._updateThumbnailUrl(t,e)}_updateInitialViewProperties(t,e){if(e.backgroundExcluded||(this.initialViewProperties.background=t.background?.clone()),this.initialViewProperties.spatialReference=t.spatialReference?.clone(),this.initialViewProperties.timeZone=t.timeZone,e.viewpointExcluded||(this.initialViewProperties.viewpoint=new be({rotation:t.rotation,scale:e.scalePreserved?t.scale:null,targetGeometry:this._getViewExtent(t)})),!e.widgetsExcluded)for(const i of t.persistableViewModels)i.updateWebDocument(this)}_getViewExtent(t){const e=t.center.clone().normalize(),i=t.extent.clone(),s=i.width/2;return i.xmin=e.x-s,i.xmax=e.x+s,i}async _updateThumbnailUrl(t,e){if(e.thumbnailExcluded)return;const i=$i(t,e.thumbnailSize),s=await t.takeScreenshot({format:"png",width:i.width,height:i.height});this._setAutoGeneratedThumbnail(s.dataUrl)}_setAutoGeneratedThumbnail(t){this.thumbnailUrl=t,this._thumbnailFilename=null}_clearThumbnailOverride(){this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"),this._thumbnailFilename=null}_generateCustomThumbnailFilename(t){if(dr(t)){const e=Qr(t),i=e?.mediaType,s=i&&qi.get(i.toLowerCase())||null,n=`thumbnail${Date.now()}`;return s?`${n}.${s}`:n}return null}_getAuthoringPropsState(){return{authoringApp:this.authoringApp,authoringAppVersion:this.authoringAppVersion,isAuthoringAppSetByUser:this._isAuthoringAppSetByUser,isAuthoringAppVersionSetByUser:this._isAuthoringAppVersionSetByUser}}_restoreAuthoringPropsFromState(t){t.isAuthoringAppSetByUser?this.authoringApp=t.authoringApp:this._isAuthoringAppSetByUser=!1,t.isAuthoringAppVersionSetByUser?this.authoringAppVersion=t.authoringAppVersion:this._isAuthoringAppVersionSetByUser=!1}};r([o()],w.prototype,"_updateFromPromise",void 0),r([o({type:Bi,json:{write:!0}})],w.prototype,"applicationProperties",void 0),r([o({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],w.prototype,"authoringApp",null),r([_("authoringApp")],w.prototype,"writeAuthoringApp",null),r([o({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],w.prototype,"authoringAppVersion",null),r([_("authoringAppVersion")],w.prototype,"writeAuthoringAppVersion",null),r([o({type:Sr,json:{write:{overridePolicy:t=>({enabled:!!(t&&t.length>0),ignoreOrigin:!0})}}})],w.prototype,"bookmarks",void 0),r([o({type:Si,json:{name:"mapFloorInfo",write:!0}})],w.prototype,"floorInfo",void 0),r([o({type:yt,nonNullable:!0,json:{read:{source:["background","initialState.timeExtent","initialState.viewpoint","mapRangeInfo","spatialReference","timeZone"]},write:{ignoreOrigin:!0,target:{background:{type:Ft},"initialState.timeExtent":{type:z},"initialState.viewpoint":{type:be},mapRangeInfo:{type:Mt},spatialReference:{type:Ye},"timeZone:":{type:String}}}}})],w.prototype,"initialViewProperties",void 0),r([E("initialViewProperties")],w.prototype,"readInitialViewProperties",null),r([_("initialViewProperties")],w.prototype,"writeInitialViewProperties",null),r([o({json:{read:!1,write:{target:"operationalLayers",ignoreOrigin:!0}}})],w.prototype,"layers",void 0),r([_("layers")],w.prototype,"writeLayers",null),r([o({type:Ke})],w.prototype,"portalItem",void 0),r([o()],w.prototype,"resourceInfo",void 0),r([o({readOnly:!0,type:Ze,json:{read:{source:"version"},write:{allowNull:!0,ignoreOrigin:!0,target:"version",isRequired:!0}}})],w.prototype,"sourceVersion",void 0),r([E("sourceVersion")],w.prototype,"readSourceVersion",null),r([_("sourceVersion")],w.prototype,"writeSourceVersion",null),r([o({json:{read:!1,write:{ignoreOrigin:!0}}})],w.prototype,"tables",void 0),r([_("tables")],w.prototype,"writeTables",null),r([o()],w.prototype,"thumbnailUrl",null),r([o()],w.prototype,"updatingFromView",null),r([o({type:_i,json:{write:!0}})],w.prototype,"widgets",void 0),w=r([u("esri.WebDocument2D")],w);const Wi=w;let Y=class extends c{constructor(e){super(e),this.moment=null,this.fullUpdate=!1,this.validateErrorsCreated=!1,this.exceededTransferLimit=null,this.serviceEdits=null,this.discoveredSubnetworks=null}};r([o({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.moment=t?t.getTime():null}}}})],Y.prototype,"moment",void 0),r([o({type:Boolean,json:{write:!0}})],Y.prototype,"fullUpdate",void 0),r([o({type:Boolean,json:{write:!0}})],Y.prototype,"validateErrorsCreated",void 0),r([o({type:Boolean,json:{write:!0}})],Y.prototype,"exceededTransferLimit",void 0),r([o({type:[Object],json:{write:!0}})],Y.prototype,"serviceEdits",void 0),r([o({type:[Object],json:{write:!0}})],Y.prototype,"discoveredSubnetworks",void 0),Y=r([u("esri.rest.networks.support.ValidateNetworkTopologyResult")],Y);const Hi=Y,Zi=ir()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let se=class extends Hi{constructor(e){super(e),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(e){const i={...e,query:{f:"json"}},{data:s}=await fe(this.statusUrl,i);return this.read(s),this.editsResolver&&this.editsResolver.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],exceededTransferLimit:!0,historicMoment:null}),this}async waitForJobCompletion(e={}){const{interval:i=1e3,statusCallback:s}=e;return new Promise((n,a)=>{this._clearTimer();const l=setInterval(()=>{this._timer||a(or()),this.checkJobStatus().then(d=>{const{status:p}=d;switch(this.status=p,p){case"job-succeeded":this._clearTimer(),n(this);break;case"job-waiting":case"job-executing":s&&s(this)}},d=>{this._clearTimer(),a(d)})},i);this._timer=l})}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};r([o()],se.prototype,"editsResolver",void 0),r([o({type:String,json:{write:!0}})],se.prototype,"statusUrl",void 0),r([W(Zi)],se.prototype,"status",void 0),r([o({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.submissionTime=t?t.getTime():null}}}})],se.prototype,"submissionTime",void 0),r([o({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.lastUpdatedTime=t?t.getTime():null}}}})],se.prototype,"lastUpdatedTime",void 0),se=r([u("esri.networks.support.TopologyValidationJobInfo")],se);const Ki=se;function Yi(t,e,i="from"){const{fromRuleElement:s,viaRuleElement:n,toRuleElement:a}=Tr(t),l=[];switch(t.ruleType){case 2:case 3:i==="from"&&B(e,s,!1)?l.push(a):i==="to"&&B(e,a,!1)&&l.push(s);break;case 4:case 1:B(e,s,!0)?l.push(a):B(e,a,!0)&&l.push(s);break;case 5:n&&(B(e,n,!0)?(l.push(s),l.push(a)):(B(e,s,!0)||B(e,a,!0))&&l.push(n));break;default:return[]}return l}function qe(t,e,i){const{fromRuleElement:s,viaRuleElement:n,toRuleElement:a}=Tr(t);switch(t.ruleType){case 2:case 3:return rt(e,i,s,a,!1,!1);case 4:case 1:return rt(e,i,s,a,!0,!0);case 5:return rt(e,i,s,n,!0,!0)||rt(e,i,a,n,!0,!0);default:return!1}}function rt(t,e,i,s,n,a){if(!i||!s)return!1;const l=B(t,i,a),d=B(e,s,a);if(n){const p=B(t,s,a),y=B(e,i,a);return l&&d||p&&y}return l&&d}function Qi(t,e){const i=t.terminal?.terminalId,s=e.terminalId;return i==null&&s==null||(i===1?s==null||s===1:i===s)}function B(t,e,i){const{assetGroupCode:s,assetTypeCode:n}=t;return("layerId"in t?t.layerId===e.networkSource?.layerId:t.networkSourceId===e.networkSource?.sourceId)&&(s==null||s===e.assetGroup?.assetGroupCode)&&(n==null||n===e.assetType?.assetTypeCode)&&(!i||!("terminalId"in t)||Qi(e,t))}function Tr(t){return{fromRuleElement:{networkSource:t.fromNetworkSource,assetGroup:t.fromAssetGroup,assetType:t.fromAssetType,terminal:t.fromTerminal},viaRuleElement:t.viaNetworkSource?{networkSource:t.viaNetworkSource,assetGroup:t.viaAssetGroup,assetType:t.viaAssetType,terminal:t.viaTerminal}:void 0,toRuleElement:{networkSource:t.toNetworkSource,assetGroup:t.toAssetGroup,assetType:t.toAssetType,terminal:t.toTerminal}}}function Ie(t){let e=null,i=null,s=null;if(gr(t))e=Pt(t),[i,s]=Xi(t);else if(cr(t)){e=t.parent?.layerId??null;const[n]=mt(t);n===t.subtypeField&&(i=t.subtypeCode)}else e=t.layerId??null;return{layerId:e,assetGroupCode:i,assetTypeCode:s}}function Pt(t){const{sourceLayer:e}=t;let i;return ti(e)?i=e.layerId:cr(e)&&(i=e.parent?.layerId),i??null}function Xi(t){const[e,i]=mt(t.sourceLayer);return[e?t.attributes[e]:null,i?t.attributes[i]:null]}function mt(t){return!t||!("fieldsIndex"in t)?[null,null]:[t.fieldsIndex.normalizeFieldName("assetGroup")??null,t.fieldsIndex.normalizeFieldName("assetType")??null]}async function Xt(t,e){if(t==="Utility Network Layer"){const{default:i}=await T(()=>Promise.resolve().then(()=>po),void 0,import.meta.url);return new i({layerUrl:e})}return null}async function eo(t){let e="portalItem"in t?t:{portalItem:t};!e.portalItem||e.portalItem instanceof Ke||(e={...e,portalItem:new Ke(e.portalItem)});const i=e.portalItem;if(await i.load(),i.type!=="Feature Service")throw new R("portal:unknown-item-type","Unknown item type '${type}'",{type:i.type});const s=i.url,n=await fe(s,{responseType:"json",query:{f:"json"}}),a="Network Layer";if(n.data.type?.includes(a))return Xt(n.data.type,s);if(n.data.layers){const l=n.data.layers.find(d=>d.type.includes(a));if(l){const d=`${s}/${l.id}`;return Xt(l.type,d)}}return null}let v=class extends ur(ar){static fromPortalItem(t){return eo(t)}constructor(t){super(t),this.id=null,this.title=null,this.layerUrl=null,this.dataElement=null,this.fullExtent=null,this.spatialReference=null,this.type=null,this.sourceJSON=null,this._historicMoment=null,this._gdbVersion=null,this._sourceIdByLayerId=new Map,this._layerIdBySourceId=new Map,this._applyEditsHandler=e=>{const{serviceUrl:i,gdbVersion:s,result:n}=e,a=i===this.featureServiceUrl,l=Wt(i,s,this.gdbVersion);a&&l&&n.then(d=>{ft(i,s)&&(this.historicMoment=d.historicMoment)})},this._updateMomentHandler=e=>{const{serviceUrl:i,gdbVersion:s,moment:n}=e,a=i===this.featureServiceUrl,l=Wt(i,s,this.gdbVersion);a&&l&&(this.historicMoment=n)},this.when().then(()=>{this.addHandles([li(this._applyEditsHandler),ui(this._updateMomentHandler)])},()=>{})}initialize(){this.when().catch(t=>{Or(t)||H.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:t})})}get loaded(){return super.loaded}get datasetName(){return this.dataElement?.name??null}get owner(){return this.dataElement?.userIdentity??null}get schemaGeneration(){return this.dataElement?.schemaGeneration??null}get parsedUrl(){return Xr(this.layerUrl)}get featureServiceUrl(){return zt(this.parsedUrl.path).url.path}get networkServiceUrl(){return this.featureServiceUrl.replace(/\/FeatureServer/i,"/UtilityNetworkServer")}get layerId(){return zt(this.parsedUrl.path).sublayer}get networkSystemLayers(){return null}get gdbVersion(){return this._gdbVersion}set gdbVersion(t){this._gdbVersion=t}get historicMoment(){return this._historicMoment}set historicMoment(t){this._historicMoment=t}async load(t){return this.addResolvingPromise(this._load(t)),this}async _load(t){await Promise.all([this._fetchDataElement(this.featureServiceUrl,this.layerId.toString(),t),this._fetchLayerMetaData(this.layerUrl,t)])}getLayerIdBySourceId(t){if(!this.dataElement)return null;const e=this._layerIdBySourceId.get(t);if(e!=null)return e;const i=this.dataElement.domainNetworks,s=this._traverseNetworkSources(i,this._layerIdBySourceId,"sourceId","layerId",t);return s>=0?s:null}getSourceIdByLayerId(t){if(!this.dataElement)return null;const e=this._sourceIdByLayerId.get(t);if(e!=null)return e;const i=this.dataElement.domainNetworks,s=this._traverseNetworkSources(i,this._sourceIdByLayerId,"layerId","sourceId",t);return s>=0?s:null}getObjectIdsFromElements(t){const e=[],i=new Map;for(const n of t){const a=this.getLayerIdBySourceId(n.networkSourceId);if(a==null)continue;let l=i.get(a);l===void 0&&(l=[]),l.push(n.objectId),i.set(a,l)}const s=this.featureServiceUrl;return i.forEach((n,a)=>e.push({layerUrl:`${s}/${a}`,objectIds:n})),e}async queryNamedTraceConfigurations(t,e){const[{queryNamedTraceConfigurations:i},{default:s}]=await Promise.all([T(()=>import("./hrtaopRk.js"),__vite__mapDeps([42,8,2,3,4,7,9,27]),import.meta.url),T(()=>import("./gS8sOOux.js"),__vite__mapDeps([43,2,3,4]),import.meta.url)]),n=this.networkServiceUrl,a=s.from(t);return(await i(n,a,{...e}))?.namedTraceConfigurations}async validateTopology(t,e){if(!t.validateArea)throw new R("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");const[{validateNetworkTopology:i},{default:s}]=await Promise.all([T(()=>import("./DxKdWlFG.js"),__vite__mapDeps([44,8,2,3,4,7,9,27]),import.meta.url),T(()=>import("./Cpt7A2bI.js"),__vite__mapDeps([45,2,3,4,8,7,9,46,47]),import.meta.url)]),n=s.from(t);ft(this.featureServiceUrl,this.gdbVersion||null)?(n.sessionID=Ht,await Zt(this.featureServiceUrl,this.gdbVersion,!0)):n.sessionID=null,n.gdbVersion=this.gdbVersion;const a=this.networkServiceUrl,l=this.featureServiceUrl,d=Kt(l,null,this.gdbVersion,!0),p=await i(a,n,{...e});if(p?.serviceEdits){const y=[];for(const m of p.serviceEdits){const{editedFeatures:g}=m,N=g?.spatialReference?new Ye(g.spatialReference):null;y.push({layerId:m.layerId,editedFeatures:{adds:g?.adds?.map(I=>it(I,N))||[],updates:g?.updates?.map(I=>({original:it(I[0],N),current:it(I[1],N)}))||[],deletes:g?.deletes?.map(I=>it(I,N))||[],spatialReference:N}})}d.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],editedFeatures:y,exceededTransferLimit:!1,historicMoment:p.moment})}return p}async submitTopologyValidationJob(t,e){let i=null;if(!t.validateArea)throw new R("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");if(!this.gdbVersion){const y=this.layerUrl.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");i=(await fe(y,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}const[{submitValidateNetworkTopologyJob:s},{default:n}]=await Promise.all([T(()=>import("./DxKdWlFG.js"),__vite__mapDeps([44,8,2,3,4,7,9,27]),import.meta.url),T(()=>import("./Cpt7A2bI.js"),__vite__mapDeps([45,2,3,4,8,7,9,46,47]),import.meta.url)]),a=n.from(t);ft(this.featureServiceUrl,this.gdbVersion||null)?(a.sessionID=Ht,await Zt(this.featureServiceUrl,this.gdbVersion,!0)):a.sessionID=null,a.gdbVersion=this.gdbVersion||i;const l=this.networkServiceUrl,d=this.featureServiceUrl?Kt(this.featureServiceUrl,null,this.gdbVersion,!0):void 0,p=await s(l,a,{...e});return new Ki({statusUrl:p,editsResolver:d})}getSourceTypeById(t){if(!this.dataElement)return null;for(const e of this.dataElement.domainNetworks)for(const i of[e.edgeSources??[],e.junctionSources??[]])for(const s of i)if(s.sourceId===t)return i===e.edgeSources?"edge":"junction";return null}_traverseNetworkSources(t,e,i,s,n){for(const a of t)for(const l of[a.edgeSources??[],a.junctionSources??[]])for(const d of l)if(d[i]===n)return e.set(n,d[s]),d[s];return-1}async _fetchLayerMetaData(t,e){const i=await fe(t,{responseType:"json",query:{f:"json"},...e});this.sourceJSON=i.data,this.read(i.data,{origin:"service"})}async _fetchDataElement(t,e,i){if(this.dataElement)return;const s=await fe(`${t}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([e]),f:"json"},...i}).then(n=>n.data.layerDataElements?.[0]);s&&this.read(s,{origin:"service"})}};function it(t,e){return new hr({attributes:t.attributes,geometry:wr({...t.geometry,spatialReference:e})})}r([o({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:!0}},read:!1}})],v.prototype,"id",void 0),r([o({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:{source:"name"}}},read:!1}})],v.prototype,"title",void 0),r([o({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"url"},write:{target:"url",isRequired:!0}}},read:!1}})],v.prototype,"layerUrl",void 0),r([o({type:Object,json:{origins:{service:{read:!0}},read:!1}})],v.prototype,"dataElement",void 0),r([o({type:Cr,json:{origins:{service:{read:{source:"extent"}}},read:!1}})],v.prototype,"fullExtent",void 0),r([o({type:Ye,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:!1}})],v.prototype,"spatialReference",void 0),r([o({type:["utility","trace"],readOnly:!0,json:{read:!1,write:!1}})],v.prototype,"type",void 0),r([o({readOnly:!0})],v.prototype,"datasetName",null),r([o({readOnly:!0})],v.prototype,"owner",null),r([o({readOnly:!0})],v.prototype,"schemaGeneration",null),r([o({readOnly:!0})],v.prototype,"parsedUrl",null),r([o({readOnly:!0})],v.prototype,"featureServiceUrl",null),r([o({readOnly:!0})],v.prototype,"networkServiceUrl",null),r([o({readOnly:!0})],v.prototype,"layerId",null),r([o()],v.prototype,"sourceJSON",void 0),r([o({readOnly:!0})],v.prototype,"networkSystemLayers",null),r([o({type:String})],v.prototype,"gdbVersion",null),r([o({type:Date})],v.prototype,"historicMoment",null),r([o()],v.prototype,"_historicMoment",void 0),r([o()],v.prototype,"_gdbVersion",void 0),v=r([u("esri.networks.Network")],v);const to=v;let ne=class extends Rr(ar){constructor(e){super(e),this.rulesCategorized={attachment:[],containment:[],connectivity:[]},this.request=fe}initialize(){}async load(e){const i=this.rulesLayer.load(e).then(()=>this._initializeRulesTable());return this.addResolvingPromise(i),this}getFeaturesCanAssociateWithClause(e,i,s){const n=new Map,[a,l]=mt(e.sourceLayer);if(!a||!l)return"";const d=Ie(e),p=Ie(i);s.forEach(m=>{const{type:g,direction:N}=m;this._getRulesForAssociationType(g).forEach(I=>{Yi(I,d,N).filter(U=>U.networkSource?.layerId===p.layerId).forEach(U=>{const k=U.assetGroup?.assetGroupCode,f=U.assetType?.assetTypeCode;if(k!=null&&f!=null){const A=n.get(k)??new Set;A.add(f),n.set(k,A)}})})});let y=[];return this._mergeAssetCodes(n).forEach((m,g)=>{const N=`${a} IN (${g})`,I=di(l,[...m]);N&&I&&y.push(bt(N,I))}),y.length>1&&(y=y.map(m=>`(${m})`)),y.join(" OR ")}getFeaturesCanAssociateWith(e,i,s){return Pt(e)==null?[]:i.filter(n=>this.canAssociateFeatures(e,n,s))}canAssociateFeatures(e,i,s){if(!this._canSupportAssociations([e,i]))return!1;const n=Ie(e),a=Ie(i);return s.some(l=>{const{type:d,direction:p}=l;return this._getRulesForAssociationType(d).some(y=>p==="to"?qe(y,a,n):qe(y,n,a))})}getLayersCanAssociateWith(e,i,s){return Pt(e)==null?[]:i.filter(n=>this.canAssociateFeatureToLayer(e,n,s))}canAssociateFeatureToLayer(e,i,s){if(!this._canSupportAssociations([e,i]))return!1;const n=Ie(e),a=Ie(i);return s.some(l=>{const{type:d,direction:p}=l;return this._getRulesForAssociationType(d).some(y=>p==="to"?qe(y,a,n):qe(y,n,a))})}getFeatureSQL(e,i){const s=e.layerId.toString(),n=e.fieldsIndex?.normalizeFieldName("assetGroup"),a=e.fieldsIndex?.normalizeFieldName("assetType"),l=n?i.attributes[n]:null,d=a?i.attributes[a]:null,p=this.rulesHash[s];if(p){const y=p.assetGroupHash[l];if(y)return y.assetTypeHash[d]||null}return null}_initializeRulesTable(){const e={},i=[{networkSourceId:"fromNetworkSource",assetGroupId:"fromAssetGroup",assetTypeId:"fromAssetType"},{networkSourceId:"toNetworkSource",assetGroupId:"toAssetGroup",assetTypeId:"toAssetType"},{networkSourceId:"viaNetworkSource",assetGroupId:"viaAssetGroup",assetTypeId:"viaAssetType"}];this.rulesCategorized={attachment:[],containment:[],connectivity:[]};for(const s of this.rules){if(s.ruleType===3){this.rulesCategorized.attachment.push(s);continue}if(s.ruleType===2){this.rulesCategorized.containment.push(s);continue}if(s.ruleType===1){this.rulesCategorized.connectivity.push(s);continue}this.rulesCategorized.connectivity.push(s);let n=[[0,1],[1,0]];s.ruleType===5&&(n=[[0,2],[2,0],[1,2],[2,1]]);for(const a of n){const l=a.shift(),d=a.shift();let p=!1;switch(s.ruleType){case 5:p=l===0||l===1;break;case 4:p=l===1}const y=i[l],m=s[y.networkSourceId]?.layerId.toString()??"",g=s[y.assetGroupId]?.assetGroupCode?.toString(),N=s[y.assetTypeId],I=N?.assetTypeCode?.toString(),U=i[d],k=s[U.networkSourceId]?.layerId.toString()??"",f=s[U.assetGroupId]?.assetGroupCode?.toString(),A=s[U.assetTypeId],Ce=A?.assetTypeCode?.toString(),Me=e[m]??{assetGroupHash:{}};if(!(g&&I&&f&&Ce))continue;const Be=Me.assetGroupHash[g]??{assetTypeHash:{}},b=Be.assetTypeHash[I]??{};if(b[k]=b[k]??{},p){b[m]=b[m]??{};const ue=bt(`assetgroup = ${g}`,`assettype = ${I}`);A?.connectivityPolicy==="esriNECPEndVertex"?b[m].endVertex=b[m]?.endVertex?`${b[m].endVertex}`:`(${ue})`:b[m].anyVertex=b[m].anyVertex?`${b[m].anyVertex}`:`(${ue})`}const ie=bt(`assetgroup = ${f}`,`assettype = ${Ce}`);A?.connectivityPolicy==="esriNECPEndVertex"?b[k].endVertex=b[k]?.endVertex?Yt(b[k].endVertex,ie):`(${ie})`:b[k].anyVertex=b[k]?.anyVertex?Yt(b[k].anyVertex,ie):`(${ie})`,Be.assetTypeHash[I]=b,Me.assetGroupHash[g]=Be,e[m]=Me}}this._set("rulesHash",e)}_getRulesForAssociationType(e){const{rulesCategorized:i}=this;switch(e){case"attachment":return i.attachment;case"containment":return i.containment;case"connectivity":case"junction-junction-connectivity":return i.connectivity.filter(s=>s.ruleType===1);case"junction-edge-from-connectivity":case"junction-edge-midspan-connectivity":case"junction-edge-to-connectivity":return i.connectivity.filter(s=>s.ruleType===4||s.ruleType===5);default:return[]}}_areSetsEqual(e,i){if(e.size!==i.size)return!1;for(const s of e)if(!i.has(s))return!1;return!0}_mergeAssetCodes(e){const i=new Map,s=new Set;for(const[n,a]of e){const l=new Set([n]);for(const[p,y]of e)n!==p&&!s.has(p)&&this._areSetsEqual(a,y)&&(l.add(p),s.add(p));const d=Array.from(l).sort().join(",");i.set(d,a)}return i}_canSupportAssociations(e){return e.every(i=>{const s=gr(i)?i.sourceLayer:i,[n,a]=mt(s);return n!=null&&a!=null})}};r([o({constructOnly:!0})],ne.prototype,"rulesLayer",void 0),r([o({constructOnly:!0})],ne.prototype,"rules",void 0),r([o({readOnly:!0})],ne.prototype,"rulesHash",void 0),r([o()],ne.prototype,"rulesCategorized",void 0),r([o({constructOnly:!0})],ne.prototype,"request",void 0),ne=r([u("esri.networks.RulesTable")],ne);let V=class extends c{constructor(e){super(e),this.conditionBarriers=[],this.outputConditions=[],this.functions=[],this.functionBarriers=[],this.traversabilityScope=null,this.shortestPathNetworkAttributeName=null,this.includeBarriers=null,this.validateConsistency=null,this.ignoreBarriersAtStartingPoints=null}};r([o({type:[Object],json:{write:!0}})],V.prototype,"conditionBarriers",void 0),r([o({type:[Object],json:{write:!0}})],V.prototype,"outputConditions",void 0),r([o({type:[Object],json:{write:!0}})],V.prototype,"functions",void 0),r([o({type:[Object],json:{write:!0}})],V.prototype,"functionBarriers",void 0),r([o({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],V.prototype,"traversabilityScope",void 0),r([o({type:String,json:{write:!0}})],V.prototype,"shortestPathNetworkAttributeName",void 0),r([o({type:Boolean,json:{write:!0}})],V.prototype,"includeBarriers",void 0),r([o({type:Boolean,json:{write:!0}})],V.prototype,"validateConsistency",void 0),r([o({type:Boolean,json:{write:!0}})],V.prototype,"ignoreBarriersAtStartingPoints",void 0),V=r([u("esri.networks.support.TraceConfiguration")],V);const Bt=V;let h=class extends Bt{constructor(e){super(e),this.filterBarriers=[],this.arcadeExpressionBarrier=null,this.circuitName=null,this.domainNetworkName=null,this.filterBitsetNetworkAttributeName=null,this.filterFunctionBarriers=[],this.filterScope=null,this.includeContainers=null,this.includeContent=null,this.includeIsolated=null,this.includeStructures=null,this.allowIndeterminateFlow=null,this.includeUpToFirstSpatialContainer=null,this.inferConnectivity=null,this.maxHops=null,this.nearestNeighbor=null,this.numPaths=null,this.outputFilterCategories=[],this.outputFilters=[],this.propagators=[],this.subnetworkName=null,this.targetTierName=null,this.diagramTemplateName=null,this.tierName=null,this.validateLocatability=null}};r([o({type:[Object],json:{write:!0}})],h.prototype,"filterBarriers",void 0),r([o({type:String,json:{write:!0}})],h.prototype,"arcadeExpressionBarrier",void 0),r([o({type:String,json:{write:!0}})],h.prototype,"circuitName",void 0),r([o({type:String,json:{write:!0}})],h.prototype,"domainNetworkName",void 0),r([o({type:String,json:{write:!0}})],h.prototype,"filterBitsetNetworkAttributeName",void 0),r([o({type:[Object],json:{write:!0}})],h.prototype,"filterFunctionBarriers",void 0),r([o({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],h.prototype,"filterScope",void 0),r([o({type:Boolean,json:{write:!0}})],h.prototype,"includeContainers",void 0),r([o({type:Boolean,json:{write:!0}})],h.prototype,"includeContent",void 0),r([o({type:Boolean,json:{write:!0}})],h.prototype,"includeIsolated",void 0),r([o({type:Boolean,json:{write:!0}})],h.prototype,"includeStructures",void 0),r([o({type:Boolean,json:{write:!0}})],h.prototype,"allowIndeterminateFlow",void 0),r([o({type:Boolean,json:{write:!0}})],h.prototype,"includeUpToFirstSpatialContainer",void 0),r([o({type:Boolean,json:{write:!0}})],h.prototype,"inferConnectivity",void 0),r([o({type:Number,json:{write:!0}})],h.prototype,"maxHops",void 0),r([o({type:Object,json:{write:!0}})],h.prototype,"nearestNeighbor",void 0),r([o({type:Number,json:{write:!0}})],h.prototype,"numPaths",void 0),r([o({type:[Object],json:{write:!0}})],h.prototype,"outputFilterCategories",void 0),r([o({type:[Object],json:{write:!0}})],h.prototype,"outputFilters",void 0),r([o({type:[Object],json:{write:!0}})],h.prototype,"propagators",void 0),r([o({type:String,json:{write:!0}})],h.prototype,"subnetworkName",void 0),r([o({type:String,json:{write:!0}})],h.prototype,"targetTierName",void 0),r([o({type:String,json:{write:!0}})],h.prototype,"diagramTemplateName",void 0),r([o({type:String,json:{write:!0}})],h.prototype,"tierName",void 0),r([o({type:Boolean,json:{write:!0}})],h.prototype,"validateLocatability",void 0),h=r([u("esri.networks.support.UNTraceConfiguration")],h);const ro=h;let L=class extends zr{constructor(e){super(e),this.globalId=null,this.title=null,this.traceConfiguration=null,this.creationDate=null,this.creator=null,this.description=null,this.minStartingPoints=null,this.resultTypes=[],this.tags=[],this.traceType=null}readTraceConfiguration(e,i){return e.tierName!==void 0?ro.fromJSON(e):Bt.fromJSON(e)}};r([o({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"id"},write:{target:"id",isRequired:!0}},service:{read:{source:"globalId"},write:{target:"globalId",isRequired:!0}}},read:!1}})],L.prototype,"globalId",void 0),r([o({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"title"},write:{target:"title",isRequired:!0}},service:{read:{source:"name"},write:{target:"name",isRequired:!0}}},read:!1}})],L.prototype,"title",void 0),r([o({type:Bt,json:{origins:{service:{read:!0,write:!0}},read:!1}})],L.prototype,"traceConfiguration",void 0),r([E("service","traceConfiguration")],L.prototype,"readTraceConfiguration",null),r([o({type:Date,json:{origins:{service:{read:!0,write:!0}},read:!1}})],L.prototype,"creationDate",void 0),r([o({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],L.prototype,"creator",void 0),r([o({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],L.prototype,"description",void 0),r([o({type:["none","one","many"],json:{origins:{service:{read:{source:"minNumStartingPoints"},write:{target:"minNumStartingPoints"}}},read:!1}})],L.prototype,"minStartingPoints",void 0),r([o({json:{origins:{service:{read:!0,write:!0}},read:!1}})],L.prototype,"resultTypes",void 0),r([o({type:[String],json:{origins:{service:{read:!0,write:!0}},read:!1}})],L.prototype,"tags",void 0),r([o({type:Qe.apiValues,json:{type:Qe.jsonValues,origins:{service:{read:Qe.read,write:Qe.write}},read:!1}})],L.prototype,"traceType",void 0),L=r([u("esri.networks.support.NamedTraceConfiguration")],L);const io=L;let x=class extends rr{constructor(e){super(e),this.rulesTableId=null,this.rulesTableUrl=null,this.subnetworksTable=null,this.subnetworksTableId=null,this.subnetworksTableUrl=null,this.dirtyAreasLayerId=null,this.dirtyAreasLayerUrl=null,this.associationsTable=null,this.associationsTableId=null,this.associationsTableUrl=null}destroy(){this.associationsTable?.destroy()}async loadAssociationsTable(e){if(!this.associationsTable){const{associationsTableUrl:i}=this;if(!i)throw new R("utility-network-system-layers:missing-associations-table-url","Unable to load the associations table, as the `associationsTableUrl` is not set.");this.associationsTable=new St({url:i})}return await this.associationsTable.load(e),this.associationsTable}async loadSubnetworksTable(e){if(!this.subnetworksTable){const{subnetworksTableUrl:i}=this;if(!i)throw new R("utility-network-system-layers:missing-subnetworks-table-url","Unable to load the subnetworks table, as the `subnetworksTableUrl` is not set.");this.subnetworksTable=new St({url:i})}return await this.subnetworksTable.load(e),this.subnetworksTable}};r([o({constructOnly:!0})],x.prototype,"rulesTableId",void 0),r([o({constructOnly:!0})],x.prototype,"rulesTableUrl",void 0),r([o()],x.prototype,"subnetworksTable",void 0),r([o({constructOnly:!0})],x.prototype,"subnetworksTableId",void 0),r([o({constructOnly:!0})],x.prototype,"subnetworksTableUrl",void 0),r([o({constructOnly:!0})],x.prototype,"dirtyAreasLayerId",void 0),r([o({constructOnly:!0})],x.prototype,"dirtyAreasLayerUrl",void 0),r([o()],x.prototype,"associationsTable",void 0),r([o({constructOnly:!0})],x.prototype,"associationsTableId",void 0),r([o({constructOnly:!0})],x.prototype,"associationsTableUrl",void 0),x=r([u("esri.networks.support.NetworkSystemLayers")],x);let Ae=class extends c{constructor(e){super(e),this.id=null,this.name=null}};r([o({type:Number,json:{read:{source:"terminalId"},write:{target:"terminalId"}}})],Ae.prototype,"id",void 0),r([o({type:String,json:{read:{source:"terminalName"},write:{target:"terminalName"}}})],Ae.prototype,"name",void 0),r([o({type:Boolean,json:{write:!0}})],Ae.prototype,"isUpstreamTerminal",void 0),Ae=r([u("esri.networks.support.Terminal")],Ae);const oo=Ae,ot=new Fe({esriUNTMBidirectional:"bidirectional",esriUNTMDirectional:"directional"});let te=class extends c{constructor(e){super(e),this.defaultConfiguration=null,this.id=null,this.name=null,this.terminals=[],this.traversabilityModel=null}};r([o({type:String,json:{write:!0}})],te.prototype,"defaultConfiguration",void 0),r([o({type:Number,json:{read:{source:"terminalConfigurationId"},write:{target:"terminalConfigurationId"}}})],te.prototype,"id",void 0),r([o({type:String,json:{read:{source:"terminalConfigurationName"},write:{target:"terminalConfigurationName"}}})],te.prototype,"name",void 0),r([o({type:[oo],json:{write:!0}})],te.prototype,"terminals",void 0),r([o({type:ot.apiValues,json:{type:ot.jsonValues,read:ot.read,write:ot.write}})],te.prototype,"traversabilityModel",void 0),te=r([u("esri.networks.support.TerminalConfiguration")],te);let Q=class extends c{constructor(e){super(e),this.edgeElement=null,this.junctionElement=null}readEdgeElement(e,i){return new ve({networkSourceId:i.edgeNetworkSourceId,globalId:i.edgeGlobalId,objectId:i.edgeObjectId,positionFrom:i.edgePositionFrom,positionTo:i.edgePositionTo,firstUnit:i.edgeFirstUnit,numUnits:i.edgeNumUnits})}writeEdgeElement(e,i){i.edgeNetworkSourceId=e.networkSourceId,i.edgeGlobalId=e.globalId,i.edgeObjectId=e.objectId,i.edgePositionFrom=e.positionFrom,i.edgePositionTo=e.positionTo,i.edgeFirstUnit=e.firstUnit,i.edgeNumUnits=e.numUnits}readJunctionElement(e,i){return new ve({networkSourceId:i.junctionNetworkSourceId,globalId:i.junctionGlobalId,objectId:i.junctionObjectId,terminalId:i.junctionTerminalId,firstUnit:i.junctionFirstUnit,numUnits:i.junctionNumUnits})}writeJunctionElement(e,i){i.junctionNetworkSourceId=e.networkSourceId,i.junctionGlobalId=e.globalId,i.junctionObjectId=e.objectId,i.junctionTerminalId=e.terminalId,i.junctionFirstUnit=e.firstUnit,i.junctionNumUnits=e.numUnits}};r([o({type:ve,json:{read:{source:["edgeNetworkSourceId","edgeGlobalId","edgeObjectId","edgePositionFrom","edgePositionTo","edgeFirstUnit","edgeNumUnits"]},write:!0}})],Q.prototype,"edgeElement",void 0),r([E("edgeElement")],Q.prototype,"readEdgeElement",null),r([_("edgeElement")],Q.prototype,"writeEdgeElement",null),r([o({type:ve,json:{read:{source:["junctionNetworkSourceId","junctionGlobalId","junctionObjectId","junctionTerminalId","junctionFirstUnit","junctionNumUnits"]},write:!0}})],Q.prototype,"junctionElement",void 0),r([E("junctionElement")],Q.prototype,"readJunctionElement",null),r([_("junctionElement")],Q.prototype,"writeJunctionElement",null),Q=r([u("esri.networks.support.CircuitPathConnectivityElement")],Q);const so=Q;let C=class extends c{constructor(e){super(e),this.globalId=null,this.isFilterBarrier=!1,this.percentAlong=null,this.terminalId=null,this.type=null,this.firstUnit=null,this.numUnits=null,this.networkSourceId=null}};r([o({type:String,json:{write:!0}})],C.prototype,"globalId",void 0),r([o({type:Boolean,json:{write:!0}})],C.prototype,"isFilterBarrier",void 0),r([o({type:Number,json:{write:!0}})],C.prototype,"percentAlong",void 0),r([o({type:Number,json:{write:!0}})],C.prototype,"terminalId",void 0),r([o({type:Xe.apiValues,json:{type:Xe.jsonValues,read:{reader:Xe.read,source:"traceLocationType"},write:{writer:Xe.write,target:"traceLocationType"}}})],C.prototype,"type",void 0),r([o({type:Number,json:{write:!0}})],C.prototype,"firstUnit",void 0),r([o({type:Number,json:{write:!0}})],C.prototype,"numUnits",void 0),r([o({type:Number})],C.prototype,"networkSourceId",void 0),C=r([u("esri.rest.networks.support.TraceLocation")],C);const er=C;let X=class extends c{constructor(e){super(e),this.pathId=null,this.order=null,this.startingPoint=null,this.stoppingPoint=null,this.pathConnectivity=[],this.geometry=null}};r([o({type:Number,json:{write:!0}})],X.prototype,"pathId",void 0),r([o({type:Number,json:{write:!0}})],X.prototype,"order",void 0),r([o({type:er,json:{write:!0}})],X.prototype,"startingPoint",void 0),r([o({type:er,json:{write:!0}})],X.prototype,"stoppingPoint",void 0),r([o({type:[so],json:{write:!0}})],X.prototype,"pathConnectivity",void 0),r([o({type:Ct,json:{write:!0}})],X.prototype,"geometry",void 0),X=r([u("esri.networks.support.CircuitPath")],X);const Dt=X;let ae=class extends c{constructor(e){super(e),this.sourceId=null,this.globalId=null,this.terminalId=1,this.firstUnit=1,this.numUnits=1}};r([o({type:Number,json:{write:!0}})],ae.prototype,"sourceId",void 0),r([o({type:String,json:{write:!0}})],ae.prototype,"globalId",void 0),r([o({type:Number,json:{write:!0}})],ae.prototype,"terminalId",void 0),r([o({type:Number,json:{write:!0}})],ae.prototype,"firstUnit",void 0),r([o({type:Number,json:{write:!0}})],ae.prototype,"numUnits",void 0),ae=r([u("esri.networks.support.CircuitLocation")],ae);const ht=ae;let ee=class extends c{constructor(e){super(e),this.name=null,this.globalId=null,this.providerId=null,this.consumerId=null,this.isReserved=!1,this.attributes=null}getAttribute(e){return this.attributes?.[e]}setAttribute(e,i){this.attributes?this.attributes[e]=i:this.attributes={[e]:i}}};r([o({type:String,json:{write:!0}})],ee.prototype,"name",void 0),r([o({type:String,json:{write:!0}})],ee.prototype,"globalId",void 0),r([o({type:String})],ee.prototype,"providerId",void 0),r([o({type:String})],ee.prototype,"consumerId",void 0),r([o({type:Boolean,json:{write:!0}})],ee.prototype,"isReserved",void 0),r([o({json:{write:{allowNull:!0,writer:(t,e)=>e.attributes=t??{}}}})],ee.prototype,"attributes",void 0),ee=r([u("esri.networks.support.Subcircuit")],ee);const jr=ee;let J=class extends c{constructor(e){super(e),this.sectionId=null,this.role="start-and-end",this.sectionType="physical",this.startLocation=null,this.stopLocation=null,this.subcircuit=null,this.path=null}normalizeCtorArgs(e){if(e===void 0)return e;const{sectionId:i,startLocation:s,stopLocation:n,subcircuit:a}=e;return(s||n)&&a?(delete e.startLocation,delete e.stopLocation,H.getLogger(this).warn("Cannot instantiate CircuitSection with both start/stop locations and subcircuit.",`CircuitSection with ID '${i}' was defaulted to having a subcircuit only.`)):(s&&!n||!s&&n)&&!a&&H.getLogger(this).warn(`CircuitSection with ID '${i}' must have both start and stop locations.`,"Create/alter operations involving this section will fail unless both are populated."),e}setStartStopLocations(e,i){this.startLocation=e,this.stopLocation=i,this.subcircuit=null}setSubcircuit(e){this.subcircuit=e,this.startLocation=null,this.stopLocation=null}};r([o({type:Number,json:{write:!0}})],J.prototype,"sectionId",void 0),r([o({type:vt.apiValues,json:{type:vt.jsonValues,read:vt.read},readOnly:!0})],J.prototype,"role",void 0),r([o({type:le.apiValues,json:{type:le.jsonValues,read:le.read,write:le.write}})],J.prototype,"sectionType",void 0),r([o({type:ht,json:{write:!0}})],J.prototype,"startLocation",void 0),r([o({type:ht,json:{write:!0}})],J.prototype,"stopLocation",void 0),r([o({type:jr,json:{write:!0}})],J.prototype,"subcircuit",void 0),r([o({type:Dt,readOnly:!0})],J.prototype,"path",void 0),J=r([u("esri.networks.support.CircuitSection")],J);let S=class extends c{constructor(e){super(e),this._sectionIdLookup=new Map,this.attributes=null,this.circuitManager=null,this.circuitType="physical",this.globalId=null,this.isDeleted=!1,this.lastExportedTime=null,this.lastVerifiedTime=null,this.name=null,this.sections=null,this.startLocation=null,this.status="dirty",this.stopLocation=null,this.subcircuits=[]}initialize(){this.addHandles([pr(()=>this.sections,e=>{this._sectionIdLookup.clear(),e!=null&&Array.from(e.keys()).forEach(i=>this._sectionIdLookup.set(i.sectionId,i))},Zr)])}normalizeCtorArgs(e){if(e===void 0)return e;const{name:i,startLocation:s,stopLocation:n,sections:a}=e;return(s||n)&&a?(delete e.startLocation,delete e.stopLocation,H.getLogger(this).warn("Cannot instantiate Circuit with both start/stop locations and sections.",`Circuit '${i}' was defaulted to having sections only.`)):(s&&!n||!s&&n)&&!a&&H.getLogger(this).warn(`Non-sectioned circuit '${i}' must have both start and stop locations.`,"Create/alter operations involving this circuit will fail unless both are populated."),e}get isSectioned(){return this.startLocation==null&&this.stopLocation==null&&this.sections!=null}readSections(e,i){const{sectionOrder:s,sections:n}=i,a=new Map;if(n==null)return null;if(this._sectionIdLookup.clear(),n.forEach(l=>this._sectionIdLookup.set(l.sectionId,J.fromJSON(l))),s==null)return Array.from(this._sectionIdLookup.values()).forEach(l=>a.set(l,[])),a;for(const[l,d]of Object.entries(s)){const p=Number(l),y=this._sectionIdLookup.get(p);if(y==null)continue;const m=d.map(g=>this._sectionIdLookup.get(g)).filter(nr);a.set(y,m)}return a}writeSections(e,i){const s={},n=[];e?.forEach((a,l)=>{const d=l.sectionId.toString(),p=a.map(y=>y.sectionId);s[d]=p,n.push(l.toJSON())}),i.sectionOrder=s,i.sections=n}getSectionById(e){return this._sectionIdLookup.get(e)??null}setStartStopLocations(e,i){this.startLocation=e,this.stopLocation=i,this.sections=null}setSections(e){this.sections=e,this.startLocation=null,this.stopLocation=null}getAttribute(e){return this.attributes?.[e]}setAttribute(e,i){this.attributes?this.attributes[e]=i:this.attributes={[e]:i}}};r([o({json:{write:{allowNull:!0,writer:(t,e)=>e.attributes=t??{}}}})],S.prototype,"attributes",void 0),r([o()],S.prototype,"circuitManager",void 0),r([o({type:le.apiValues,json:{type:le.jsonValues,read:le.read,write:le.write}})],S.prototype,"circuitType",void 0),r([o({type:String,json:{write:!0}})],S.prototype,"globalId",void 0),r([o({type:Boolean,readOnly:!0})],S.prototype,"isDeleted",void 0),r([o({type:Boolean,json:{write:!0},readOnly:!0})],S.prototype,"isSectioned",null),r([o({type:Date,json:{read:{reader:t=>typeof t=="number"?new Date(t):null}},readOnly:!0})],S.prototype,"lastExportedTime",void 0),r([o({type:Date,json:{read:{reader:t=>typeof t=="number"?new Date(t):null}},readOnly:!0})],S.prototype,"lastVerifiedTime",void 0),r([o({type:String,json:{write:!0}})],S.prototype,"name",void 0),r([o({json:{read:{source:["sectionOrder","sections"]},write:!0}})],S.prototype,"sections",void 0),r([E("sections")],S.prototype,"readSections",null),r([_("sections")],S.prototype,"writeSections",null),r([o({type:ht,json:{write:!0}})],S.prototype,"startLocation",void 0),r([o({type:It.apiValues,json:{type:It.jsonValues,read:It.read}})],S.prototype,"status",void 0),r([o({type:ht,json:{write:!0}})],S.prototype,"stopLocation",void 0),r([o({type:[jr],json:{write:!0}})],S.prototype,"subcircuits",void 0),S=r([u("esri.networks.support.Circuit")],S);let ce=class extends c{constructor(e){super(e),this.circuit=null,this.geometry=null,this.path=null}readCircuit(e,i){return S.fromJSON(i)}};r([o({type:S,json:{write:!0,read:{source:["name","globalId","isSectioned","sectionOrder","startLocation","stopLocation","sections","subcircuits","lastVerifiedTime","lastExportedTime","circuitType","status"]}}})],ce.prototype,"circuit",void 0),r([E("circuit")],ce.prototype,"readCircuit",null),r([o({type:Ct,json:{write:!0}})],ce.prototype,"geometry",void 0),r([o({type:Dt,json:{write:!0}})],ce.prototype,"path",void 0),ce=r([u("esri.rest.networks.circuits.support.CircuitTraceResult")],ce);const no=ce;let Le=class extends c{constructor(e){super(e),this.line=null,this.multipoint=null,this.polygon=null}};r([o({type:Ct,json:{write:!0},readOnly:!0})],Le.prototype,"line",void 0),r([o({type:wi,json:{read:{source:"point"},write:{target:"point"}},readOnly:!0})],Le.prototype,"multipoint",void 0),r([o({type:gi,json:{write:!0},readOnly:!0})],Le.prototype,"polygon",void 0),Le=r([u("esri.rest.networks.support.AggregatedGeometry")],Le);const ao=Le;let xe=class extends c{constructor(t){super(t),this.functionType=null,this.networkAttributeName=null,this.result=null}};r([o({type:["add","subtract","average","count","min","max"],json:{write:!0},readOnly:!0})],xe.prototype,"functionType",void 0),r([o({type:String,json:{write:!0},readOnly:!0})],xe.prototype,"networkAttributeName",void 0),r([o({type:Number,json:{write:!0},readOnly:!0})],xe.prototype,"result",void 0),xe=r([u("esri.rest.networks.support.FunctionResult")],xe);const lo=xe;let O=class extends c{constructor(e){super(e),this.aggregatedGeometry=null,this.circuits=null,this.elements=null,this.globalFunctionResults=null,this.kFeaturesForKNNFound=!1,this.paths=null,this.startingPointsIgnored=!1,this.warnings=null}readNetworkElements(e,i){return i.elements!=null&&Array.isArray(i.elements)?i.elements.map(s=>"firstUnit"in s&&"numUnits"in s?new ve({...s}):new fr({...s})):[]}writeNetworkElements(e,i){i.elements=e.map(s=>s.toJSON())}};r([o({type:ao,json:{write:!0},readOnly:!0})],O.prototype,"aggregatedGeometry",void 0),r([o({type:[no],json:{write:!0},readOnly:!0})],O.prototype,"circuits",void 0),r([o({type:[fr],json:{write:!0},readOnly:!0})],O.prototype,"elements",void 0),r([E("elements")],O.prototype,"readNetworkElements",null),r([_("elements")],O.prototype,"writeNetworkElements",null),r([o({type:[lo],json:{write:!0},readOnly:!0})],O.prototype,"globalFunctionResults",void 0),r([o({type:Boolean,json:{write:!0},readOnly:!0})],O.prototype,"kFeaturesForKNNFound",void 0),r([o({type:[Dt],json:{write:!0},readOnly:!0})],O.prototype,"paths",void 0),r([o({type:Boolean,json:{write:!0},readOnly:!0})],O.prototype,"startingPointsIgnored",void 0),r([o({type:[String],json:{write:!0},readOnly:!0})],O.prototype,"warnings",void 0),O=r([u("esri.rest.networks.support.TraceResult")],O);const uo=ir()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let ye=class extends O{constructor(e){super(e),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(e){const i={...e,query:{f:"json"}},{data:s}=await fe(this.statusUrl,i),n=s.traceResults?{...s.traceResults,...s}:s;return this.read(n),this}async waitForJobCompletion(e={}){const{interval:i=1e3,statusCallback:s}=e;return new Promise((n,a)=>{this._clearTimer();const l=setInterval(()=>{this._timer||a(or()),this.checkJobStatus().then(d=>{const{status:p}=d;switch(this.status=p,p){case"job-succeeded":this._clearTimer(),n(this);break;case"job-waiting":case"job-executing":s&&s(this)}},d=>{this._clearTimer(),a(d)})},i);this._timer=l})}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};r([o({type:String,json:{write:!0}})],ye.prototype,"statusUrl",void 0),r([W(uo)],ye.prototype,"status",void 0),r([o({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.submissionTime=t?t.getTime():null}}}})],ye.prototype,"submissionTime",void 0),r([o({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.lastUpdatedTime=t?t.getTime():null}}}})],ye.prototype,"lastUpdatedTime",void 0),ye=r([u("esri.networks.support.TraceJobInfo")],ye);let P=class extends to{constructor(t){super(t),this.sharedNamedTraceConfigurations=[],this.type="utility",this._circuitManagerMap=new Map,this._terminalById=new Map,this._unitIdentifierManager=null}initialize(){this.addHandles(pr(()=>[this.gdbVersion,this.historicMoment],()=>{this.networkSystemLayers.associationsTable&&(this.networkSystemLayers.associationsTable.gdbVersion!==this.gdbVersion&&(this.networkSystemLayers.associationsTable.gdbVersion=this.gdbVersion),this.networkSystemLayers.associationsTable.historicMoment!==this.historicMoment&&(this.networkSystemLayers.associationsTable.historicMoment=this.historicMoment))}))}get _rulesLayer(){const{gdbVersion:t,historicMoment:e}=this,i=this.networkSystemLayers.rulesTableUrl;return new St({url:i,gdbVersion:t,historicMoment:e})}get _utilityLayerList(){const t=new Set;return this.dataElement?.domainNetworks?.map(e=>{e?.edgeSources?.map(({layerId:i,sourceId:s})=>{this._layerIdBySourceId.set(s,i),this._sourceIdByLayerId.set(i,s),t.add(i)}),e?.junctionSources?.map(({layerId:i,sourceId:s})=>{this._layerIdBySourceId.set(s,i),this._sourceIdByLayerId.set(i,s),t.add(i)})}),t}get serviceTerritoryFeatureLayerId(){return this.dataElement?.serviceTerritoryFeatureLayerId??null}get networkSystemLayers(){return new x({rulesTableId:this.sourceJSON?.systemLayers.rulesTableId,rulesTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.rulesTableId}`:null,subnetworksTableId:this.sourceJSON?.systemLayers.subnetworksTableId,subnetworksTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.subnetworksTableId}`:null,dirtyAreasLayerId:this.sourceJSON?.systemLayers.dirtyAreasLayerId,dirtyAreasLayerUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.dirtyAreasLayerId}`:null,associationsTableId:this.sourceJSON?.systemLayers.associationsTableId,associationsTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.associationsTableId}`:null})}get terminalConfigurations(){return this.dataElement?.terminalConfigurations.map(t=>te.fromJSON(t))||[]}get domainNetworkNames(){return this.dataElement?.domainNetworks.map(t=>t.domainNetworkName)||[]}get hasTelecomNetwork(){return this.dataElement?.domainNetworks.some(t=>t.isTelecomNetwork)??!1}get associationsTable(){return this.networkSystemLayers.associationsTable}async load(t){return this.addResolvingPromise(this._load(t)),this}async _load(t){await super._load(t),await Promise.all([this._loadNamedTraceConfigurationsFromNetwork(t),this.networkSystemLayers.loadAssociationsTable(t)])}getTerminalConfiguration(t){let e=null,i=null;const s=t.sourceLayer;let n=null;if(s?.type==="feature"){if(n=s.layerId,n===null)return null}else if(s?.type!=="subtype-sublayer"||(n=s?.parent?.layerId??null,n===null))return null;const a=t.attributes;if(a==null)return null;for(const p of Object.keys(a))p.toUpperCase()==="ASSETGROUP"&&(e=t.getAttribute(p)),p.toUpperCase()==="ASSETTYPE"&&(i=t.getAttribute(p));if(!this.dataElement)return null;let l=null;const d=this.dataElement.domainNetworks;for(const p of d){const y=p.junctionSources?.find(m=>m.layerId===n);if(y){const m=y.assetGroups?.find(g=>g.assetGroupCode===e);if(m){const g=m.assetTypes?.find(N=>N.assetTypeCode===i);if(g?.isTerminalConfigurationSupported){l=g.terminalConfigurationId;break}}}}if(l!=null){const p=this.dataElement.terminalConfigurations,y=p?.find(m=>m.terminalConfigurationId===l);return y?te.fromJSON(y):null}return null}getTierNames(t){return this.dataElement?.domainNetworks.find(i=>i.domainNetworkName===t)?.tiers?.map(i=>i.name)||[]}async getRulesTable(){const t=this._rulesLayer;t.loaded||await t.load();const e=this.dataElement?.domainNetworks;if(!e)return null;const i=e.flatMap(n=>[...n.edgeSources||[],...n.junctionSources||[]]),s=(await this._queryRulesTable(t)).map(n=>this._hydrateRuleInfo(t,i,n));return new ne({rulesLayer:t,rules:s})}async getCircuitManager(t){if(!this.hasTelecomNetwork)return null;const e=this.dataElement?.domainNetworks.find(s=>s.domainNetworkName===t&&s.isTelecomNetwork);if(!e)return null;const{default:i}=await T(()=>import("./f__iu-I6.js"),__vite__mapDeps([48,7,2,3,4,5,6,8,9,49,50,51,1,10,52,53,54,55,21,30,56,57,58,59,60,26,22,20,61,62,63,64,65,66,67,68,69,70,71,72,73,13,74,75,37,76,77,19,78,79,80,81,82,83,35,36,84,85,86,39,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,18,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,15,143,144,145,146,147,148,149,150,151,152,153,23,154]),import.meta.url);return Ur(this._circuitManagerMap,t,()=>new i({utilityNetwork:this,telecomDomainNetwork:e}))}async getUnitIdentifierManager(){if(!this.hasTelecomNetwork)return null;if(this._unitIdentifierManager)return this._unitIdentifierManager;const{default:t}=await T(()=>import("./DA3FuPmn.js"),__vite__mapDeps([155,7,2,3,4,88,5,6,8,9,39]),import.meta.url);return this._unitIdentifierManager=new t({utilityNetwork:this}),this._unitIdentifierManager}getTerminalById(t){if(!this.dataElement||t==null)return null;const e=this._terminalById.get(t);return e??(this.terminalConfigurations.forEach(i=>{i.terminals.forEach(s=>{this._terminalById.set(s.id,s)})}),this._terminalById.get(t))}isUtilityLayer(t){return"layerId"in t?t.layerId!=null&&this._utilityLayerList.has(t.layerId)&&(t.url?.startsWith(this.featureServiceUrl)??!1):!(t.type!=="subtype-sublayer"||!t.parent)&&this._utilityLayerList.has(t.parent.layerId)&&(t.parent.url?.startsWith(this.featureServiceUrl)??!1)}async queryAssociations(t,e){const[{queryAssociations:i},{default:s}]=await Promise.all([T(()=>import("./DGbyUckK.js"),__vite__mapDeps([156,8,2,3,4,7,9,46,47,27,157,22,20,21]),import.meta.url),T(()=>import("./C7f3YWDt.js"),__vite__mapDeps([158,2,3,4,46,47]),import.meta.url)]),n=s.from(t);return n.gdbVersion=this.gdbVersion,n.moment=this.historicMoment,(await i(this.networkServiceUrl,n,e)).associations}async synthesizeAssociationGeometries(t){const[{synthesizeAssociationGeometries:e},{default:i}]=await Promise.all([T(()=>import("./C9pSZhGI.js"),__vite__mapDeps([159,8,2,3,4,7,9,27,157,22,20,21,46,47]),import.meta.url),T(()=>import("./W3jjMA9o.js"),__vite__mapDeps([160,2,3,4,8,7,9]),import.meta.url)]),s=i.from(t);return s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment,e(this.networkServiceUrl,s)}async trace(t){const[{trace:e},{default:i}]=await Promise.all([T(()=>import("./C83SMLgt.js"),__vite__mapDeps([161,8,2,3,4,7,9,27]),import.meta.url),T(()=>import("./CedduHNK.js"),__vite__mapDeps([162,2,3,4,8,7,9,46,47]),import.meta.url)]),s=i.from(t);return s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment,e(this.networkServiceUrl,s)}async submitTraceJob(t){const[{submitTraceJob:e},{default:i}]=await Promise.all([T(()=>import("./C83SMLgt.js"),__vite__mapDeps([161,8,2,3,4,7,9,27]),import.meta.url),T(()=>import("./CedduHNK.js"),__vite__mapDeps([162,2,3,4,8,7,9,46,47]),import.meta.url)]),s=i.from(t);s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment;const n=await e(this.networkServiceUrl,s);return new ye({statusUrl:n})}async canAddAssociation(t){const e=await this.getRulesTable();if(!e)return!1;const{fromNetworkElement:i,toNetworkElement:s}=t;if(!i||!s)return!1;await e.load();let n=null;switch(t.associationType){case"containment":n=e.rulesCategorized.containment;break;case"attachment":n=e.rulesCategorized.attachment;break;default:n=e.rulesCategorized.connectivity}return n.some(a=>qe(a,i,s))}generateAddAssociations(t){const{associationsTable:e}=this.networkSystemLayers,{fromNetworkSourceId:i,fromGlobalId:s,fromTerminalId:n,fromFirstUnit:a,fromNumUnits:l,toNetworkSourceId:d,toGlobalId:p,toTerminalId:y,toFirstUnit:m,toNumUnits:g,associationType:N,isContentVisible:I,percentAlong:U,globalId:k}=hi(e);return{addFeatures:t.map(f=>{const A=new hr({attributes:{[i]:f.fromNetworkElement?.networkSourceId,[s]:f.fromNetworkElement?.globalId,[n]:f.fromNetworkElement?.terminalId,[d]:f.toNetworkElement?.networkSourceId,[p]:f.toNetworkElement?.globalId,[y]:f.toNetworkElement?.terminalId,[N]:ci[f.associationType],[I]:f.isContentVisible==null?void 0:f.isContentVisible?1:0,[U]:f.percentAlong,[k]:f.globalId}});return f.fromNetworkElement instanceof ve&&(A.attributes[a]=f.fromNetworkElement?.firstUnit,A.attributes[l]=f.fromNetworkElement?.numUnits),f.toNetworkElement instanceof ve&&(A.attributes[m]=f.toNetworkElement?.firstUnit,A.attributes[g]=f.toNetworkElement?.numUnits),A}),id:this.networkSystemLayers.associationsTableId,identifierFields:{globalIdField:e?.globalIdField??"globalid",objectIdField:e?.objectIdField??"objectid"}}}generateDeleteAssociations(t){const{associationsTable:e,associationsTableId:i}=this.networkSystemLayers,s={id:i,identifierFields:{globalIdField:e?.globalIdField??"globalid",objectIdField:e?.objectIdField??"objectid"}};if(this.dataElement?.schemaGeneration===-8){const a=this._generateDeleteTelecomAssociationPayload(t);return{...s,deleteAssociations:a}}const n=t.map(a=>({globalId:a.globalId}));return{...s,deleteFeatures:n}}generateCombineNetworkElements(t){return{id:this._ensureSingleSourceIdAsValidLayerId(t),combineGroupedObjects:[{globalIds:t.map(e=>e.globalId)}]}}generateDivideNetworkElements(t,e){return{id:this._ensureSingleSourceIdAsValidLayerId([t]),divideGroupedObjects:[{globalId:t.globalId,numUnits:e}]}}async loadAssociationsTable(){return this.networkSystemLayers.loadAssociationsTable()}async loadSubnetworksTable(){return this.networkSystemLayers.loadSubnetworksTable()}async _loadNamedTraceConfigurationsFromNetwork(t){if(this.sharedNamedTraceConfigurations?.length===0)return;const e=this.sharedNamedTraceConfigurations.map(s=>s.globalId),i=await this.queryNamedTraceConfigurations({globalIds:e},t);for(const s of this.sharedNamedTraceConfigurations){const n=i?.find(a=>a.globalId===s.globalId);if(n){const a=n.write({},{origin:"service"});s.read(a,{origin:"service"})}}}_hydrateRuleInfo(t,e,i){const s=t.fieldsIndex,n=s.get("RULETYPE"),a=s.get("CREATIONDATE"),l=s.get("FROMNETWORKSOURCEID"),d=s.get("FROMASSETGROUP"),p=s.get("FROMASSETTYPE"),y=s.get("FROMTERMINALID"),m=s.get("TONETWORKSOURCEID"),g=s.get("TOASSETGROUP"),N=s.get("TOASSETTYPE"),I=s.get("TOTERMINALID"),U=s.get("VIANETWORKSOURCEID"),k=s.get("VIAASSETGROUP"),f=s.get("VIAASSETTYPE"),A=s.get("VIATERMINALID"),Ce=i.attributes[n.name],Me=new Date(i.attributes[a.name]),Be=[{networkSourceId:i.attributes[l.name],assetGroupId:i.attributes[d.name],assetTypeId:i.attributes[p.name],terminalId:i.attributes[y.name]},{networkSourceId:i.attributes[m.name],assetGroupId:i.attributes[g.name],assetTypeId:i.attributes[N.name],terminalId:i.attributes[I.name]},{networkSourceId:i.attributes[U.name],assetGroupId:i.attributes[k.name],assetTypeId:i.attributes[f.name],terminalId:i.attributes[A.name]}],b={ruleType:Ce,creationDate:Me};for(const ie of[0,1,2]){if(Ce!==5&&ie===2)continue;const ue=Be[ie],Gt=e.find(De=>De.sourceId===ue.networkSourceId),qt=Gt?.assetGroups.find(De=>De.assetGroupCode===ue.assetGroupId),Jt=qt?.assetTypes.find(De=>De.assetTypeCode===ue.assetTypeId),$r=this._getTerminal(Jt,ue);let pe="";switch(ie){case 0:pe="from";break;case 1:pe="to";break;case 2:pe="via"}b[`${pe}NetworkSource`]=Gt,b[`${pe}AssetGroup`]=qt,b[`${pe}AssetType`]=Jt,b[`${pe}Terminal`]=$r?.toJSON()}return b}_getTerminal(t,e){const i=t?.terminalConfigurationId;return this.terminalConfigurations?.find(n=>n.id===i)?.terminals?.find(n=>n.id===e.terminalId)??null}async _queryRulesTable(t){const{gdbVersion:e,historicMoment:i}=this,s=new pi({where:"1=1",outFields:["*"],gdbVersion:e,historicMoment:i});return(await ai(t,s)).features}_generateDeleteTelecomAssociationPayload(t){return t.map(e=>({globalId:e.globalId??mi,associationType:yi.toJSON(e.associationType),fromSourceId:e.fromNetworkElement.networkSourceId,fromGlobalId:e.fromNetworkElement.globalId,fromTerminalId:e.fromNetworkElement.terminalId,toSourceId:e.toNetworkElement.networkSourceId,toGlobalId:e.toNetworkElement.globalId,toTerminalId:e.toNetworkElement.terminalId}))}_ensureSingleSourceIdAsValidLayerId(t){const e=Br(t.map(n=>n.networkSourceId));if(e.length>1)throw new R("utility-network:invalid-source-id","'networkSourceId' is not valid. Ensure that all network elements have the same 'networkSourceId' and that it corresponds to a valid layer in the utility network.");const i=e[0],s=this.getLayerIdBySourceId(i);if(s==null)throw new R("utility-network:invalid-source-id","'networkSourceId' is not valid. Ensure that all network elements have the same 'networkSourceId' and that it corresponds to a valid layer in the utility network.");return s}};r([o({readOnly:!0})],P.prototype,"_rulesLayer",null),r([o({type:[io],json:{origins:{"web-map":{read:{source:"traceConfigurations"},write:{target:"traceConfigurations"}},service:{read:{source:"traceConfigurations"}}},read:!1}})],P.prototype,"sharedNamedTraceConfigurations",void 0),r([o({type:["utility"],readOnly:!0,json:{read:!1,write:!1}})],P.prototype,"type",void 0),r([o({readOnly:!0})],P.prototype,"serviceTerritoryFeatureLayerId",null),r([o({readOnly:!0})],P.prototype,"networkSystemLayers",null),r([o({readOnly:!0})],P.prototype,"terminalConfigurations",null),r([o({readOnly:!0})],P.prototype,"domainNetworkNames",null),r([o({readOnly:!0})],P.prototype,"hasTelecomNetwork",null),r([o({readOnly:!0,json:{read:!1}})],P.prototype,"associationsTable",null),P=r([u("esri.networks.UtilityNetwork")],P);const Nr=P,po=Object.freeze(Object.defineProperty({__proto__:null,default:Nr},Symbol.toStringTag,{value:"Module"}));let Oe=class extends $(c){constructor(e){super(e),this.expression=null,this.returnType="string",this.title=null}};r([o({type:String,json:{write:{isRequired:!0}}})],Oe.prototype,"expression",void 0),r([o({type:["number","string"],json:{write:!0}})],Oe.prototype,"returnType",void 0),r([o({type:String,json:{write:!0}})],Oe.prototype,"title",void 0),Oe=r([u("esri.webdoc.geotriggersInfo.ExpressionInfo")],Oe);const _r=Oe,st=new Fe({deviceLocation:"device-location"});let Je=class extends $(c){constructor(e){super(e),this.filterExpression=null,this.type="device-location"}};r([o({type:_r,json:{write:!0}})],Je.prototype,"filterExpression",void 0),r([o({type:st.apiValues,readOnly:!0,json:{type:st.jsonValues,read:st.read,write:st.write}})],Je.prototype,"type",void 0),Je=r([u("esri.webdoc.geotriggersInfo.DeviceLocationFeed")],Je);const co=Je;let ze=class extends $(c){constructor(e){super(e),this.geometry=null,this.where=null}};r([o({types:fi,json:{read:wr,write:!0}})],ze.prototype,"geometry",void 0),r([o({type:String,json:{write:!0}})],ze.prototype,"where",void 0),ze=r([u("esri.webdoc.geotriggersInfo.FeatureFilter")],ze);const yo=ze;let Re=class extends $(c){constructor(e){super(e),this.layerId=null,this.layerUrl=null,this.type="feature-layer"}};r([o({type:String,json:{write:{overridePolicy(){return{isRequired:this.layerUrl===null}}}}})],Re.prototype,"layerId",void 0),r([o({type:String,json:{write:{overridePolicy(){return{isRequired:this.layerId===null}}}}})],Re.prototype,"layerUrl",void 0),r([W({featureLayer:"feature-layer"},{readOnly:!0})],Re.prototype,"type",void 0),Re=r([u("esri.webdoc.geotriggersInfo.FeatureLayerSource")],Re);const mo=Re;let me=class extends $(c){constructor(e){super(e),this.fenceSource=null,this.filter=null,this.bufferDistance=null,this.type="features"}};r([o({type:mo,json:{write:{isRequired:!0}}})],me.prototype,"fenceSource",void 0),r([o({type:yo,json:{write:!0}})],me.prototype,"filter",void 0),r([o({type:Number,json:{write:!0}})],me.prototype,"bufferDistance",void 0),r([W({features:"features"},{readOnly:!0})],me.prototype,"type",void 0),me=r([u("esri.webdoc.geotriggersInfo.FeatureFenceParameters")],me);const ho=me;let lt=class extends $(c){constructor(e){super(e),this.type="fence"}};r([W({fence:"fence"},{readOnly:!0})],lt.prototype,"type",void 0),lt=r([u("esri.webdoc.geotriggersInfo.Geotrigger")],lt);const kr=lt;let We=class extends $(c){constructor(e){super(e),this.expressionInfo=null,this.requestedActions=null}};r([o({type:_r,json:{write:!0}})],We.prototype,"expressionInfo",void 0),r([o({type:[String],json:{write:!0}})],We.prototype,"requestedActions",void 0),We=r([u("esri.webdoc.geotriggersInfo.GeotriggerNotificationOptions")],We);const wo=We,go=new Fe({enterContainsAndExitDoesNotContain:"enter-contains-and-exit-does-not-contain",enterContainsAndExitDoesNotIntersect:"enter-contains-and-exit-does-not-intersect",enterIntersectsAndExitDoesNotIntersect:"enter-intersects-and-exit-does-not-intersect"}),fo=new Fe({useGeometry:"use-geometry",useGeometryWithAccuracy:"use-geometry-with-accuracy"}),nt=new Fe({enter:"enter",enterOrExit:"enter-or-exit",exit:"exit"});let M=class extends kr{constructor(t){super(t),this.enterExitRule="enter-contains-and-exit-does-not-intersect",this.feed=null,this.feedAccuracyMode="use-geometry",this.fenceNotificationRule=null,this.fenceParameters=null,this.name=null,this.notificationOptions=null,this.type="fence"}};r([W(go)],M.prototype,"enterExitRule",void 0),r([o({type:co,json:{write:{isRequired:!0}}})],M.prototype,"feed",void 0),r([W(fo)],M.prototype,"feedAccuracyMode",void 0),r([o({type:nt.apiValues,json:{type:nt.jsonValues,read:nt.read,write:{writer:nt.write,isRequired:!0}}})],M.prototype,"fenceNotificationRule",void 0),r([o({type:ho,json:{write:{isRequired:!0}}})],M.prototype,"fenceParameters",void 0),r([o({type:String,json:{write:!0}})],M.prototype,"name",void 0),r([o({type:wo,json:{write:!0}})],M.prototype,"notificationOptions",void 0),r([W({fence:"fence"},{readOnly:!0})],M.prototype,"type",void 0),M=r([u("esri.webdoc.geotriggersInfo.FenceGeotrigger")],M);const bo=M,vo={base:kr,key:"type",typeMap:{fence:bo}};let ut=class extends $(c){constructor(e){super(e),this.geotriggers=null}};r([o({types:[vo],json:{write:{isRequired:!0}}})],ut.prototype,"geotriggers",void 0),ut=r([u("esri.webdoc.GeotriggersInfo")],ut);const Io=ut;let pt=class extends $(c){constructor(e){super(e),this.enabled=!0}};r([o({type:Boolean,nonNullable:!0,json:{write:!0}})],pt.prototype,"enabled",void 0),pt=r([u("esri.webdoc.ips.AppleIPSProperties")],pt);const So=pt;let dt=class extends $(c){constructor(e){super(e),this.enabled=!0}};r([o({type:Boolean,nonNullable:!0,json:{write:!0}})],dt.prototype,"enabled",void 0),dt=r([u("esri.webdoc.ips.GNSSProperties")],dt);const To=dt;let Ue=class extends $(c){constructor(e){super(e),this.enabled=!0,this.distance=5,this.units="meter"}};r([o({type:Boolean,nonNullable:!0,json:{write:!0}})],Ue.prototype,"enabled",void 0),r([o({type:Number,nonNullable:!0,json:{write:!0}})],Ue.prototype,"distance",void 0),r([o({type:["feet","meter"],nonNullable:!0,json:{write:!0}})],Ue.prototype,"units",void 0),Ue=r([u("esri.webdoc.ips.PathSnappingProperties")],Ue);const jo=Ue;let ct=class extends $(c){constructor(t){super(t),this.enabled=!0}};r([o({type:Boolean,nonNullable:!0,json:{write:!0}})],ct.prototype,"enabled",void 0),ct=r([u("esri.webdoc.ips.SmoothingProperties")],ct);const No=ct;let he=class extends $(c){constructor(e){super(e),this.appleIPS=null,this.gnss=null,this.smoothing=null,this.pathSnapping=null}};r([o({type:So,json:{name:"AppleIPS",write:!0}})],he.prototype,"appleIPS",void 0),r([o({type:To,json:{name:"GNSS",write:!0}})],he.prototype,"gnss",void 0),r([o({type:No,json:{write:!0}})],he.prototype,"smoothing",void 0),r([o({type:jo,json:{write:!0}})],he.prototype,"pathSnapping",void 0),he=r([u("esri.webdoc.ips.Configuration")],he);const _o=he;let Ve=class extends $(c){constructor(t){super(t),this.portalItem=null}readPortalItem(t,e,i){const{itemId:s}=e;if(s)return new Ke({id:s,portal:i?.portal})}writePortalItem(t,e){t?.id&&(e.itemId=t.id)}};r([o({type:Ke,json:{write:{isRequired:!0}}})],Ve.prototype,"portalItem",void 0),r([E("portalItem",["itemId"])],Ve.prototype,"readPortalItem",null),r([_("portalItem",{itemId:{type:String}})],Ve.prototype,"writePortalItem",null),Ve=r([u("esri.webdoc.ips.PositioningService")],Ve);const ko=Ve;let He=class extends $(c){constructor(t){super(t),this.positioningService=null,this.configuration=null}};r([o({type:ko,json:{write:{isRequired:!0}}})],He.prototype,"positioningService",void 0),r([o({type:_o,json:{write:!0}})],He.prototype,"configuration",void 0),He=r([u("esri.webdoc.IPSInfo")],He);const $o=He,Eo={currentVersion:sr,createInitialViewProperties:()=>new yt,parseVersion:Ze.parse,itemType:"Web Map",name:"webmap",origin:"web-map"},Ao=wt.ofType(Nr);var Pe;let we=(Pe=class extends Wi{constructor(e){super(e),this.geotriggersInfo=null,this.ipsInfo=null,this.presentation=null,this.utilityNetworks=null}destroy(){if(this.utilityNetworks){const e=this.utilityNetworks.removeAll();for(const i of e)i.destroy();this.utilityNetworks.destroy()}}get context(){return Eo}loadAll(){return lr(this,e=>{e(this.ground,this.basemap,this.layers,this.tables,this.ipsInfo?.positioningService?.portalItem)})}static fromJSON(e){if(e)return new this({resourceInfo:e});throw new R("webmap:empty-resource","Expected a JSON resource but got nothing")}},Pe.VERSION=sr,Pe);r([o({type:Io,json:{write:!0}})],we.prototype,"geotriggersInfo",void 0),r([o({type:$o,json:{write:!0,name:"mapIPSInfo"}})],we.prototype,"ipsInfo",void 0),r([o({json:{write:!0}})],we.prototype,"presentation",void 0),r([o({type:Ao,json:{read:!0,write:!0}})],we.prototype,"utilityNetworks",void 0),we=r([u("esri.WebMap")],we);const Lo=we,Ys=Object.freeze(Object.defineProperty({__proto__:null,default:Lo},Symbol.toStringTag,{value:"Module"}));export{Nr as N,Ys as W,ht as a,Lo as b,O as c,io as d,Hi as i,S as m,ro as n,er as p};
