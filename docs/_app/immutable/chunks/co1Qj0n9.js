import{i as Se,r as je,l as qe,t as Me}from"./D6wORzA5.js";import{s as v}from"./2eEJBHPf.js";import{t as ze,e as Ie,c as Oe,d as ke,a as Ne,m as Te,f as De,p as Le}from"./gU8z3wlr.js";class dt extends SyntaxError{constructor(o,e,h,A){super(o),this.expected=e,this.found=h,this.location=A,this.name="SyntaxError"}format(o){let e="Error: "+this.message;if(this.location){let h=null;const A=o.find((R=>R.source===this.location.source));A&&(h=A.text.split(/\r\n|\n|\r/g));const b=this.location.start,P=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(b):b,S=this.location.source+":"+P.line+":"+P.column;if(h){const R=this.location.end,I="".padEnd(P.line.toString().length," "),O=h[b.line-1],k=(b.line===R.line?R.column:O.length+1)-b.column||1;e+=`
 --> `+S+`
`+I+` |
`+P.line+" | "+O+`
`+I+" | "+"".padEnd(b.column-1," ")+"".padEnd(k,"^")}else e+=`
 at `+S}return e}static buildMessage(o,e){function h(p){return p.codePointAt(0).toString(16).toUpperCase()}const A=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function b(p){return A?p.replace(A,(i=>"\\u{"+h(i)+"}")):p}function P(p){return b(p.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(i=>"\\x0"+h(i))).replace(/[\x10-\x1F\x7F-\x9F]/g,(i=>"\\x"+h(i))))}function S(p){return b(p.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(i=>"\\x0"+h(i))).replace(/[\x10-\x1F\x7F-\x9F]/g,(i=>"\\x"+h(i))))}const R={literal:p=>'"'+P(p.text)+'"',class(p){const i=p.parts.map((F=>Array.isArray(F)?S(F[0])+"-"+S(F[1]):S(F)));return"["+(p.inverted?"^":"")+i.join("")+"]"+(p.unicode?"u":"")},any:()=>"any character",end:()=>"end of input",other:p=>p.description};function I(p){return R[p.type](p)}function O(p){const i=p.map(I);if(i.sort(),i.length>0){let F=1;for(let j=1;j<i.length;j++)i[j-1]!==i[j]&&(i[F]=i[j],F++);i.length=F}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}function k(p){return p?'"'+P(p)+'"':"end of input"}return"Expected "+O(o)+" but "+k(e)+" found."}}function Ue(n,o){const e={},h=(o=o!==void 0?o:{}).grammarSource,A={start:ht};let b=ht;const P="none",S=")",R=",",I="(",O="%",k="px",p="cm",i="mm",F="in",j="pt",Y="pc",Z="deg",_="rad",tt="grad",et="turn",xt="#",vt=".",At="e",nt=/^[ \t\n\r]/,rt=/^[a-z\-]/,ut=/^[0-9a-fA-F]/,at=/^[+\-]/,q=/^[0-9]/,bt=z("none"),$t=y("none",!1),Ft=y(")",!1),ot=y(",",!1),lt=L([" ","	",`
`,"\r"],!1,!1,!1),Et=z("function"),Ct=y("(",!1),Pt=z("identifier"),ct=L([["a","z"],"-"],!1,!1,!1),Rt=z("percentage"),St=y("%",!1),jt=z("length"),qt=y("px",!1),Mt=y("cm",!1),zt=y("mm",!1),It=y("in",!1),Ot=y("pt",!1),kt=y("pc",!1),Nt=z("angle"),Tt=y("deg",!1),Dt=y("rad",!1),Lt=y("grad",!1),Ut=y("turn",!1),Bt=z("number"),Gt=z("color"),Ht=y("#",!1),st=L([["0","9"],["a","f"],["A","F"]],!1,!1,!1),it=L(["+","-"],!1,!1,!1),M=L([["0","9"]],!1,!1,!1),Jt=y(".",!1),Kt=y("e",!1);function Qt(){return[]}function Vt(t,r){return{type:"function",name:t,parameters:r||[]}}function Wt(t,r){return r.length>0?Re(t,r,3):[t]}function Xt(t){return{type:"quantity",value:t.value,unit:t.unit}}function Yt(t){return{type:"color",colorType:t.type,value:t.value}}function an(t){return t}function Zt(){return G()}function _t(t){return{value:t,unit:"%"}}function te(t){return{value:t,unit:"px"}}function ee(t){return{value:t,unit:"cm"}}function ne(t){return{value:t,unit:"mm"}}function re(t){return{value:t,unit:"in"}}function ue(t){return{value:t,unit:"pt"}}function ae(t){return{value:t,unit:"pc"}}function oe(t){return{value:t,unit:"deg"}}function le(t){return{value:t,unit:"rad"}}function ce(t){return{value:t,unit:"grad"}}function se(t){return{value:t,unit:"turn"}}function ie(t){return{value:t,unit:null}}function fe(){return{type:"hex",value:G()}}function pe(t){return{type:"function",value:t}}function he(){return{type:"named",value:G()}}function me(){return parseFloat(G())}let u=0|o.peg$currPos,m=u;const N=[{line:1,column:1}];let D,E=u,B=o.peg$maxFailExpected||[],l=0|o.peg$silentFails;if(o.startRule){if(!(o.startRule in A))throw new Error(`Can't start parsing from rule "`+o.startRule+'".');b=A[o.startRule]}function G(){return n.substring(m,u)}function ge(t=u){const r=n.codePointAt(t);return r===void 0?"":String.fromCodePoint(r)}function y(t,r){return{type:"literal",text:t,ignoreCase:r}}function L(t,r,a,c){return{type:"class",parts:t,inverted:r,ignoreCase:a,unicode:c}}function de(){return{type:"end"}}function z(t){return{type:"other",description:t}}function ft(t){let r,a=N[t];if(a)return a;if(t>=N.length)r=N.length-1;else for(r=t;!N[--r];);for(a=N[r],a={line:a.line,column:a.column};r<t;)n.charCodeAt(r)===10?(a.line++,a.column=1):a.column++,r++;return N[t]=a,a}function pt(t,r,a){const c=ft(t),f=ft(r);return{source:h,start:{offset:t,line:c.line,column:c.column},end:{offset:r,line:f.line,column:f.column}}}function s(t){u<E||(u>E&&(E=u,B=[]),B.push(t))}function ye(t,r,a){return new dt(dt.buildMessage(t,r),t,r,a)}function ht(){let t;return t=we(),t===e&&(t=xe()),t}function we(){let t,r;return l++,t=u,w(),n.substr(u,4)===P?(r=P,u+=4):(r=e,l===0&&s($t)),r!==e?(w(),m=t,t=Qt()):(u=t,t=e),l--,t===e&&l===0&&s(bt),t}function xe(){let t,r;if(t=[],r=J(),r!==e)for(;r!==e;)t.push(r),r=J();else t=e;return t}function J(){let t,r,a,c;return t=u,w(),r=Ae(),r!==e?(w(),a=ve(),a===e&&(a=null),w(),n.charCodeAt(u)===41?(c=S,u++):(c=e,l===0&&s(Ft)),c!==e?(w(),m=t,t=Vt(r,a)):(u=t,t=e)):(u=t,t=e),t}function ve(){let t,r,a,c,f,g,d,x;if(t=u,r=K(),r!==e){for(a=[],c=u,f=w(),n.charCodeAt(u)===44?(g=R,u++):(g=e,l===0&&s(ot)),g===e&&(g=null),d=w(),x=K(),x!==e?(f=[f,g,d,x],c=f):(u=c,c=e);c!==e;)a.push(c),c=u,f=w(),n.charCodeAt(u)===44?(g=R,u++):(g=e,l===0&&s(ot)),g===e&&(g=null),d=w(),x=K(),x!==e?(f=[f,g,d,x],c=f):(u=c,c=e);m=t,t=Wt(r,a)}else u=t,t=e;return t}function K(){let t,r;return t=u,r=be(),r===e&&(r=$e(),r===e&&(r=Fe(),r===e&&(r=Ee()))),r!==e&&(m=t,r=Xt(r)),t=r,t===e&&(t=u,r=Ce(),r!==e&&(m=t,r=Yt(r)),t=r),t}function w(){let t,r;for(l++,t=[],r=n.charAt(u),nt.test(r)?u++:(r=e,l===0&&s(lt));r!==e;)t.push(r),r=n.charAt(u),nt.test(r)?u++:(r=e,l===0&&s(lt));return l--,t}function Ae(){let t,r,a;return l++,t=u,r=mt(),r!==e?(n.charCodeAt(u)===40?(a=I,u++):(a=e,l===0&&s(Ct)),a!==e?(m=t,t=r):(u=t,t=e)):(u=t,t=e),l--,t===e&&(r=e,l===0&&s(Et)),t}function mt(){let t,r,a;if(l++,t=u,r=[],a=n.charAt(u),rt.test(a)?u++:(a=e,l===0&&s(ct)),a!==e)for(;a!==e;)r.push(a),a=n.charAt(u),rt.test(a)?u++:(a=e,l===0&&s(ct));else r=e;return r!==e&&(m=t,r=Zt()),t=r,l--,t===e&&(r=e,l===0&&s(Pt)),t}function be(){let t,r,a;return l++,t=u,w(),r=$(),r!==e?(n.charCodeAt(u)===37?(a=O,u++):(a=e,l===0&&s(St)),a!==e?(m=t,t=_t(r)):(u=t,t=e)):(u=t,t=e),l--,t===e&&l===0&&s(Rt),t}function $e(){let t,r,a;return l++,t=u,w(),r=$(),r!==e?(n.substr(u,2)===k?(a=k,u+=2):(a=e,l===0&&s(qt)),a!==e?(m=t,t=te(r)):(u=t,t=e)):(u=t,t=e),t===e&&(t=u,w(),r=$(),r!==e?(n.substr(u,2)===p?(a=p,u+=2):(a=e,l===0&&s(Mt)),a!==e?(m=t,t=ee(r)):(u=t,t=e)):(u=t,t=e),t===e&&(t=u,w(),r=$(),r!==e?(n.substr(u,2)===i?(a=i,u+=2):(a=e,l===0&&s(zt)),a!==e?(m=t,t=ne(r)):(u=t,t=e)):(u=t,t=e),t===e&&(t=u,w(),r=$(),r!==e?(n.substr(u,2)===F?(a=F,u+=2):(a=e,l===0&&s(It)),a!==e?(m=t,t=re(r)):(u=t,t=e)):(u=t,t=e),t===e&&(t=u,w(),r=$(),r!==e?(n.substr(u,2)===j?(a=j,u+=2):(a=e,l===0&&s(Ot)),a!==e?(m=t,t=ue(r)):(u=t,t=e)):(u=t,t=e),t===e&&(t=u,w(),r=$(),r!==e?(n.substr(u,2)===Y?(a=Y,u+=2):(a=e,l===0&&s(kt)),a!==e?(m=t,t=ae(r)):(u=t,t=e)):(u=t,t=e)))))),l--,t===e&&l===0&&s(jt),t}function Fe(){let t,r,a;return l++,t=u,r=$(),r!==e?(n.substr(u,3)===Z?(a=Z,u+=3):(a=e,l===0&&s(Tt)),a!==e?(m=t,t=oe(r)):(u=t,t=e)):(u=t,t=e),t===e&&(t=u,r=$(),r!==e?(n.substr(u,3)===_?(a=_,u+=3):(a=e,l===0&&s(Dt)),a!==e?(m=t,t=le(r)):(u=t,t=e)):(u=t,t=e),t===e&&(t=u,r=$(),r!==e?(n.substr(u,4)===tt?(a=tt,u+=4):(a=e,l===0&&s(Lt)),a!==e?(m=t,t=ce(r)):(u=t,t=e)):(u=t,t=e),t===e&&(t=u,r=$(),r!==e?(n.substr(u,4)===et?(a=et,u+=4):(a=e,l===0&&s(Ut)),a!==e?(m=t,t=se(r)):(u=t,t=e)):(u=t,t=e)))),l--,t===e&&(r=e,l===0&&s(Nt)),t}function Ee(){let t,r;return l++,t=u,w(),r=$(),r!==e?(m=t,t=ie(r)):(u=t,t=e),l--,t===e&&l===0&&s(Bt),t}function Ce(){let t,r,a,c;if(l++,t=u,n.charCodeAt(u)===35?(r=xt,u++):(r=e,l===0&&s(Ht)),r!==e){if(a=[],c=n.charAt(u),ut.test(c)?u++:(c=e,l===0&&s(st)),c!==e)for(;c!==e;)a.push(c),c=n.charAt(u),ut.test(c)?u++:(c=e,l===0&&s(st));else a=e;a!==e?(m=t,t=fe()):(u=t,t=e)}else u=t,t=e;return t===e&&(t=u,r=J(),r!==e&&(m=t,r=pe(r)),t=r,t===e&&(t=u,r=mt(),r!==e&&(m=t,r=he()),t=r)),l--,t===e&&(r=e,l===0&&s(Gt)),t}function $(){let t,r,a,c,f,g,d,x;for(t=u,r=n.charAt(u),at.test(r)?u++:(r=e,l===0&&s(it)),r===e&&(r=null),a=u,c=[],f=n.charAt(u),q.test(f)?u++:(f=e,l===0&&s(M));f!==e;)c.push(f),f=n.charAt(u),q.test(f)?u++:(f=e,l===0&&s(M));if(n.charCodeAt(u)===46?(f=vt,u++):(f=e,l===0&&s(Jt)),f!==e){if(g=[],d=n.charAt(u),q.test(d)?u++:(d=e,l===0&&s(M)),d!==e)for(;d!==e;)g.push(d),d=n.charAt(u),q.test(d)?u++:(d=e,l===0&&s(M));else g=e;g!==e?(c=[c,f,g],a=c):(u=a,a=e)}else u=a,a=e;if(a===e)if(a=[],c=n.charAt(u),q.test(c)?u++:(c=e,l===0&&s(M)),c!==e)for(;c!==e;)a.push(c),c=n.charAt(u),q.test(c)?u++:(c=e,l===0&&s(M));else a=e;if(a!==e){if(c=u,n.charCodeAt(u)===101?(f=At,u++):(f=e,l===0&&s(Kt)),f!==e){if(g=n.charAt(u),at.test(g)?u++:(g=e,l===0&&s(it)),g===e&&(g=null),d=[],x=n.charAt(u),q.test(x)?u++:(x=e,l===0&&s(M)),x!==e)for(;x!==e;)d.push(x),x=n.charAt(u),q.test(x)?u++:(x=e,l===0&&s(M));else d=e;d!==e?(f=[f,g,d],c=f):(u=c,c=e)}else u=c,c=e;c===e&&(c=null),m=t,t=me()}else u=t,t=e;return t}function Pe(t,r){return t.map((function(a){return a[r]}))}function Re(t,r,a){return[t].concat(Pe(r,a))}D=b();const Q=D!==e&&u===n.length;function gt(){throw D!==e&&u<n.length&&s(de()),ye(B,E<n.length?ge(E):null,E<n.length?pt(E,E+1):pt(E,E))}return o.peg$library?{peg$result:D,peg$currPos:u,peg$FAILED:e,peg$maxFailExpected:B,peg$maxFailPos:E,peg$success:Q,peg$throw:Q?void 0:gt}:Q?D:void gt()}function sn(n){if(!n||n.length===0)return null;if(typeof n=="string"){const e=yt(n);return e&&e.length!==0?e:null}const o=n.map((e=>{if(!Number.isFinite(e.scale)||e.scale<=0)throw new v("effect:invalid-scale","scale must be finite and greater than 0",{stop:e});return{scale:e.scale,effects:yt(e.value)}}));o.sort(((e,h)=>h.effects.length-e.effects.length));for(let e=0;e<o.length-1;e++){if(!ze(o[e].effects,o[e+1].effects))throw new v("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:o[e].effects,b:o[e+1].effects});Ie(o[e].effects,o[e+1].effects)}return o.sort(((e,h)=>h.scale-e.scale)),o}function yt(n){let o;if(!n)return[];try{o=Ue(n)}catch(e){throw new v("effect:invalid-syntax","Invalid effect syntax",{value:n,error:e})}return o.map((e=>Be(e)))}function Be(n){try{switch(n.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return Ge(n);case"opacity":return He(n);case"hue-rotate":return Je(n);case"blur":return Ke(n);case"drop-shadow":return Qe(n);case"bloom":return Ve(n)}}catch(o){throw o.details.filter=n,o}throw new v("effect:unknown-effect",`Effect '${n.name}' is not supported`,{effect:n})}function Ge(n){let o=1;return T(n.parameters,1),n.parameters.length===1&&(o=C(n.parameters[0])),new Le(n.name,o)}function He(n){let o=1;return T(n.parameters,1),n.parameters.length===1&&(o=C(n.parameters[0])),new De(o)}function Je(n){let o=0;return T(n.parameters,1),n.parameters.length===1&&(o=tn(n.parameters[0])),new Te(o)}function Ke(n){let o=0;return T(n.parameters,1),n.parameters.length===1&&(o=X(n.parameters[0]),U(o,n.parameters[0])),new Ne(o)}function Qe(n){const o=[];let e=null;for(const h of n.parameters)if(h.type==="color"){if(o.length&&Object.freeze(o),e)throw new v("effect:type-error","Accepts only one color",{});e=en(h)}else{const A=X(h);if(Object.isFrozen(o))throw new v("effect:type-error","<length> parameters not consecutive",{lengths:o});o.push(A),o.length===3&&U(A,h)}if(o.length<2||o.length>3)throw new v("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${o.length}}`,{lengths:o});return new ke(o[0],o[1],o[2]||0,e||wt("black"))}function Ve(n){let o=1,e=0,h=0;return T(n.parameters,3),n.parameters[0]&&(o=C(n.parameters[0])),n.parameters[1]&&(e=X(n.parameters[1]),U(e,n.parameters[1])),n.parameters[2]&&(h=C(n.parameters[2])),new Oe(o,e,h)}function T(n,o){if(n.length>o)throw new v("effect:type-error",`Function supports up to ${o} parameters, Actual: ${n.length}`,{parameters:n})}function H(n){if(n.type==="color")return"<color>";if(n.unit){if(n.unit in W)return"<length>";if(n.unit in V)return"<angle>";if(n.unit==="%")return"<percentage>"}return"<double>"}function U(n,o){if(n<0)throw new v("effect:type-error",`Negative values are not allowed, Actual: ${n}`,{term:o})}function We(n){if(n.type!=="quantity"||n.unit!==null)throw new v("effect:type-error",`Expected <double>, Actual: ${H(n)}`,{term:n})}function Xe(n){if(n.type!=="quantity"||n.unit!==null&&n.unit!=="%")throw new v("effect:type-error",`Expected <double> or <percentage>, Actual: ${H(n)}`,{term:n})}const V={deg:1,grad:.9,rad:180/Math.PI,turn:360};function Ye(n){if(n.type!=="quantity"||!(n.value===0&&n.unit===null||n.unit&&V[n.unit]!=null))throw new v("effect:type-error",`Expected <angle>, Actual: ${H(n)}`,{term:n})}const W={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function Ze(n){if(n.type!=="quantity"||!(n.value===0&&n.unit===null||n.unit&&W[n.unit]!=null))throw new v("effect:type-error",`Expected <length>, Actual: ${H(n)}`,{term:n})}function C(n){Xe(n);const o=n.value;return U(o,n),n.unit==="%"?.01*o:o}function _e(n){return We(n),U(n.value,n),n.value}function tn(n){return Ye(n),n.value*V[n.unit]||0}function X(n){return Ze(n),n.value*W[n.unit]||0}function en(n){switch(n.colorType){case"hex":return Se(n.value);case"named":return wt(n.value);case"function":return un(n.value)}}function wt(n){if(!je(n))throw new v("effect:unknown-color",`color '${n}' isn't valid`,{namedColor:n});return qe(n)}const nn=/^rgba?/i,rn=/^hsla?/i;function un(n){if(T(n.parameters,4),nn.test(n.name))return[C(n.parameters[0]),C(n.parameters[1]),C(n.parameters[2]),n.parameters[3]?C(n.parameters[3]):1];if(rn.test(n.name))return Me(_e(n.parameters[0]),C(n.parameters[1]),C(n.parameters[2]),n.parameters[3]?C(n.parameters[3]):1);throw new v("effect:syntax-error",`Invalid color function '${n.name}'`,{colorFunction:n})}export{sn as g};
